(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[63277,34604,3177,34215,64853,35992,38357,84029,4304,85455,79836,54281,91877,53617,32637,87127,81854,14563,94795,13469,73715,34698,4033,68981,45623,24194,19453,4516,93669,38140,84101,84234,18319,81627,4982,18555,11008,87048,43887,52946,61959,35829,59958,11228,42098,28022,53197,63347,267,91288,757],{16282:(e,t)=>{"use strict";function i(e){if(void 0===e)throw new Error("Value is undefined");return e}function r(e){if(null===e)throw new Error("Value is null");return e}Object.defineProperty(t,"__esModule",{value:!0}),t.ensureNever=t.ensure=t.ensureNotNull=t.ensureDefined=t.assert=void 0,t.assert=function(e,t){if(!e)throw new Error("Assertion failed"+(t?": "+t:""))},t.ensureDefined=i,t.ensureNotNull=r,t.ensure=function(e){return r(i(e))},t.ensureNever=function(e){}},72218:(e,t)=>{"use strict";t.CircularBuffer=void 0;var i=function(){function e(e){this._start=0,this._size=0,this._buffer=new Array(e)}return e.prototype.size=function(){return this._size},e.prototype.capacity=function(){return this._buffer.length},e.prototype.enqueue=function(e){this._size<this._buffer.length?this._size++:this._start=(this._start+1)%this._buffer.length;var t=(this._start+this._size-1)%this._buffer.length;this._buffer[t]=e},e.prototype.dequeue=function(){if(0===this._size)throw new Error("Buffer is empty");var e=this._buffer[this._start];return this._buffer[this._start]=void 0,this._start=(this._start+1)%this._buffer.length,this._size--,e},e.prototype.get=function(e){if(e>=this._size)throw new Error("Index is out of range");var t=(this._start+e)%this._buffer.length;return this._buffer[t]},e.prototype.forEach=function(e,t){for(var i=0;i<this._size;i++){var r=(this._start+i)%this._buffer.length;e.call(t,this._buffer[r],r,this)}},e.prototype.clear=function(){for(var e=this._buffer.length,t=0;t<e;t++)this._buffer[t]=void 0;this._start=0,this._size=0},e}();t.CircularBuffer=i},75496:(e,t)=>{"use strict";function i(e){return Math.round(1e10*e)/1e10}Object.defineProperty(t,"__esModule",{value:!0}),t.alignTo=t.fixComputationError=t.isNaN=t.isInteger=t.isNumber=void 0,t.isNumber=function(e){return"number"==typeof e&&isFinite(e)},t.isInteger=function(e){return"number"==typeof e&&e%1==0},t.isNaN=function(e){return!(e<=0||e>0)},t.fixComputationError=i,t.alignTo=function(e,t){var r=e/t,s=Math.floor(r),n=r-s;return n>2e-10?i(n>.5?(s+1)*t:s*t):e}},73211:(e,t)=>{"use strict";t.hasProperty=t.isObject=void 0,t.isObject=function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)},t.hasProperty=function(e,t){return t in e}},71044:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pointInCircle=t.pointInPolygon=t.pointInBox=t.pointInTriangle=t.pointInHalfplane=void 0;var r=i(95196);t.pointInHalfplane=function(e,t){var i=t.edge;return i.A*e.x+i.B*e.y+i.C>0===t.isPositive},t.pointInTriangle=function(e,t,i,s){var n=t.add(i).scaled(.5).add(s).scaled(.5),o=r.intersectLineSegments(t,i,n,e)
;return null===o&&(null===(o=r.intersectLineSegments(i,s,n,e))&&null===(o=r.intersectLineSegments(s,t,n,e)))},t.pointInBox=function(e,t){return e.x>=t.min.x&&e.x<=t.max.x&&e.y>=t.min.y&&e.y<=t.max.y},t.pointInPolygon=function(e,t){for(var i=t.length-1,r=!1,s=e.x,n=e.y,o=0;o<t.length;o++){var a=t[o],l=t[i];(a.y<n&&l.y>=n||l.y<n&&a.y>=n)&&a.x+(n-a.y)/(l.y-a.y)*(l.x-a.x)<s&&(r=!r),i=o}return r},t.pointInCircle=function(e,t,i){return(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)<=i*i}},89684:(e,t)=>{"use strict";function i(e,t,i){var r=t.subtract(e),s=i.subtract(e).dotProduct(r)/r.dotProduct(r);return{coeff:s,distance:e.addScaled(r,s).subtract(i).length()}}Object.defineProperty(t,"__esModule",{value:!0}),t.distanceToSegment=t.distanceToLine=void 0,t.distanceToLine=i,t.distanceToSegment=function(e,t,r){var s=i(e,t,r);if(0<=s.coeff&&s.coeff<=1)return s;var n=e.subtract(r).length(),o=t.subtract(r).length();return n<o?{coeff:0,distance:n}:{coeff:1,distance:o}}},95196:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.intersectPolygons=t.intersectPolygonAndHalfplane=t.intersectRayAndBox=t.intersectLineAndBox=t.intersectLineSegments=t.intersectLines=t.intersectLineSegmentAndBox=void 0;var r=i(16282),s=i(72927),n=i(89684),o=i(71044);function a(e,t){var i=e.A,r=t.A,n=e.B,o=t.B,a=e.C,l=t.C,c=i*o-r*n;if(Math.abs(c)<1e-6)return null;var u=(n*l-o*a)/c,d=(r*a-i*l)/c;return new s.Point(u,d)}function l(e,t,i,r){var s=function(e,t,i,r){var s=t.subtract(e),n=r.subtract(i),o=s.x*n.y-s.y*n.x;if(Math.abs(o)<1e-6)return null;var a=e.subtract(i);return(a.y*n.x-a.x*n.y)/o}(e,t,i,r);if(null===s)return null;var o=t.subtract(e).scaled(s).add(e),a=n.distanceToSegment(i,r,o);return Math.abs(a.distance)<1e-6?s:null}function c(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(s.equalPoints(n,t))return!1}return e.push(t),!0}function u(e,t){return!(e.length>0&&(s.equalPoints(e[e.length-1],t)||s.equalPoints(e[0],t)))&&(e.push(t),!0)}function d(e,t){for(var i=[],r=0;r<e.length;++r){var n=e[r],l=e[(r+1)%e.length],c=s.lineThroughPoints(n,l);if(o.pointInHalfplane(n,t)){if(u(i,n),!o.pointInHalfplane(l,t))null!==(d=a(c,t.edge))&&u(i,d)}else if(o.pointInHalfplane(l,t)){var d;null!==(d=a(c,t.edge))&&u(i,d)}}return i.length>=3?i:null}t.intersectLineSegmentAndBox=function(e,t){var i=e[0].x,r=e[0].y,n=e[1].x,o=e[1].y,a=t.min.x,l=t.min.y,c=t.max.x,u=t.max.y;function d(e,t,i,r,s,n){var o=0;return e<i?o|=1:e>s&&(o|=2),t<r?o|=4:t>n&&(o|=8),o}for(var h=d(i,r,a,l,c,u),p=d(n,o,a,l,c,u),_=!1,m=0;;){if(m>1e3)throw new Error("Cohen - Sutherland algorithm: infinity loop");if(m++,!(h|p)){_=!0;break}if(h&p)break;var f=h||p,g=void 0,v=void 0;8&f?(g=i+(n-i)*(u-r)/(o-r),v=u):4&f?(g=i+(n-i)*(l-r)/(o-r),v=l):2&f?(v=r+(o-r)*(c-i)/(n-i),g=c):(v=r+(o-r)*(a-i)/(n-i),g=a),f===h?h=d(i=g,r=v,a,l,c,u):p=d(n=g,o=v,a,l,c,u)}return _?s.equalPoints(s.point(i,r),s.point(n,o))?s.point(i,r):s.lineSegment(s.point(i,r),s.point(n,o)):null},t.intersectLines=a,t.intersectLineSegments=l,t.intersectLineAndBox=function(e,t){var i=t.min.x,n=t.min.y,o=t.max.x,a=t.max.y;if(0===e.A){
var l=-e.C/e.B;return n<=l&&l<=a?s.lineSegment(s.point(i,l),s.point(o,l)):null}if(0===e.B){var u=-e.C/e.A;return i<=u&&u<=o?s.lineSegment(s.point(u,n),s.point(u,a)):null}var d=[],h=function(t){var i=function(e,t){return-(e.C+e.A*t)/e.B}(e,t);n<=i&&i<=a&&c(d,new s.Point(t,i))},p=function(t){var r=function(e,t){return-(e.C+e.B*t)/e.A}(e,t);i<=r&&r<=o&&c(d,new s.Point(r,t))};switch(h(i),p(n),h(o),p(a),d.length){case 0:return null;case 1:return d[0];case 2:return s.equalPoints(d[0],d[1])?d[0]:s.lineSegment(d[0],d[1])}return r.assert(!1,"We should have at most two intersection points"),null},t.intersectRayAndBox=function(e,t,i){var r=l(e,t,i.min,new s.Point(i.max.x,i.min.y)),n=l(e,t,new s.Point(i.max.x,i.min.y),i.max),a=l(e,t,i.max,new s.Point(i.min.x,i.max.y)),c=l(e,t,new s.Point(i.min.x,i.max.y),i.min),u=[];if(null!==r&&r>=0&&u.push(r),null!==n&&n>=0&&u.push(n),null!==a&&a>=0&&u.push(a),null!==c&&c>=0&&u.push(c),0===u.length)return null;u.sort((function(e,t){return e-t}));var d=o.pointInBox(e,i)?u[0]:u[u.length-1];return e.addScaled(t.subtract(e),d)},t.intersectPolygonAndHalfplane=d,t.intersectPolygons=function(e,t){for(var i=e,r=0;r<t.length&&null!==i;++r){var n=t[r],o=t[(r+1)%t.length],a=t[(r+2)%t.length],l=s.lineThroughPoints(n,o);i=d(i,s.halfplaneThroughPoint(l,a))}return i}},72927:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.equalBoxes=t.box=t.halfplaneThroughPoint=t.halfplane=t.lineSegment=t.lineThroughPoints=t.line=t.equalPoints=t.point=t.Point=void 0;var i=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.addScaled=function(t,i){return new e(this.x+i*t.x,this.y+i*t.y)},e.prototype.subtract=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.dotProduct=function(e){return this.x*e.x+this.y*e.y},e.prototype.crossProduct=function(e){return this.x*e.y-this.y*e.x},e.prototype.signedAngle=function(e){return Math.atan2(this.crossProduct(e),this.dotProduct(e))},e.prototype.angle=function(e){return Math.acos(this.dotProduct(e)/(this.length()*e.length()))},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.scaled=function(t){return new e(this.x*t,this.y*t)},e.prototype.normalized=function(){return this.scaled(1/this.length())},e.prototype.transposed=function(){return new e(-this.y,this.x)},e.prototype.clone=function(){return new e(this.x,this.y)},e}();function r(e,t){return new i(e,t)}function s(e,t){return e.x===t.x&&e.y===t.y}function n(e,t,i){if(0===e&&0===t)throw new Error("A and B can not be both equal to zero.");return{A:e,B:t,C:i}}function o(e,t){return{edge:e,isPositive:t}}t.Point=i,t.point=r,t.equalPoints=s,t.line=n,t.lineThroughPoints=function(e,t){if(s(e,t))throw new Error("Points should be distinct");return n(e.y-t.y,t.x-e.x,e.x*t.y-t.x*e.y)},t.lineSegment=function(e,t){if(s(e,t))throw new Error("Points of a segment should be distinct");return[e,t]},t.halfplane=o,t.halfplaneThroughPoint=function(e,t){return o(e,e.A*t.x+e.B*t.y+e.C>0)},t.box=function(e,t){
return{min:r(Math.min(e.x,t.x),Math.min(e.y,t.y)),max:r(Math.max(e.x,t.x),Math.max(e.y,t.y))}},t.equalBoxes=function(e,t){return s(e.min,t.min)&&s(e.max,t.max)}},51102:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformPoint=t.translationMatrix=t.scalingMatrix=t.rotationMatrix=t.multiplyMatrices=t.identityMatrix=void 0;var r=i(72927);t.identityMatrix=function(){return[[1,0,0],[0,1,0],[0,0,1]]},t.multiplyMatrices=function(e,t){for(var i=[[0,0,0],[0,0,0],[0,0,0]],r=0;r<3;r++)for(var s=0;s<3;s++)for(var n=0;n<3;n++)i[r][s]+=e[r][n]*t[n][s];return i},t.rotationMatrix=function(e){var t=Math.cos(e),i=Math.sin(e);return[[t,-i,0],[i,t,0],[0,0,1]]},t.scalingMatrix=function(e,t){return[[e,0,0],[0,t,0],[0,0,1]]},t.translationMatrix=function(e,t){return[[1,0,e],[0,1,t],[0,0,1]]},t.transformPoint=function(e,t){for(var i=[t.x,t.y,1],s=[0,0,0],n=0;n<3;n++)for(var o=0;o<3;o++)s[n]+=i[o]*e[n][o];return new r.Point(s[0],s[1])}},14563:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(75496);function s(e,t,i){return r.isNaN(t)||t<e?e:t>i?i:Math.round(t)}function n(e,t,i){return r.isNaN(t)||t<e?e:t>i?i:Math.round(1e4*t)/1e4}function o(e){return s(0,e,255)}function a(e){return s(0,e,255)}function l(e){return s(0,e,255)}function c(e){return n(0,e,1)}function u(e){return n(0,e,1)}function d(e){return n(0,e,1)}function h(e){return n(0,e,1)}function p(e){return n(0,e,1)}function _(e){return n(0,e,1)}function m(e){var t=e[0]/255,i=e[1]/255,r=e[2]/255,s=Math.min(t,i,r),n=Math.max(t,i,r),o=0,a=0,l=(s+n)/2;if(s===n)o=0,a=0;else{var c=n-s;switch(a=l>.5?c/(2-n-s):c/(n+s),n){case t:o=((i-r)/c+(i<r?6:0))/6;break;case i:o=((r-t)/c+2)/6;break;case r:o=((t-i)/c+4)/6}}return[o,a,l]}function f(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function g(e){var t,i,r,s=e[0],n=e[1],c=e[2];if(0===n)t=i=r=c;else{var u=c<.5?c*(1+n):c+n-c*n,d=2*c-u;t=f(d,u,s+1/3),i=f(d,u,s),r=f(d,u,s-1/3)}return[o(255*t),a(255*i),l(255*r)]}t.normalizeRedComponent=o,t.normalizeGreenComponent=a,t.normalizeBlueComponent=l,t.normalizeAlphaComponent=c,t.rgb=function(e,t,i){return[o(e),a(t),l(i)]},t.areEqualRgb=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.rgba=function(e,t,i,r){if(Array.isArray(e)){var s=e;return r=t,[s[0],s[1],s[2],c(r)]}var n=t;return i=i||0,r=r||0,[o(e),a(n),l(i),c(r)]},t.areEqualRgba=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.normalizeHue=u,t.normalizeHslSaturation=d,t.normalizeHsvSaturation=h,t.normalizeLightness=p,t.normalizeValue=_,t.hsl=function(e,t,i){return[u(e),d(t),p(i)]},t.areEqualHsl=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.hsv=function(e,t,i){return[u(e),h(t),_(i)]},t.areEqualHsv=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.rgbToHsl=m,t.hslToRgb=g,t.rgbToHsv=function(e){var t=e[0],i=e[1],r=e[2],s=t/255,n=i/255,o=r/255,a=Math.min(s,n,o),l=Math.max(s,n,o),c=l-a,u=0,d=0===l?0:c/l,h=l;if(l===a)u=0;else switch(l){case t:u=((n-o)/c+(n<o?6:0))/6;break;case i:u=((o-s)/c+2)/6
;break;case r:u=((s-n)/c+4)/6}return[u,d,h]},t.hsvToRgb=function(e){var t=e[0],i=e[1],r=e[2],s=Math.floor(6*t),n=6*t-s,c=r*(1-i),u=r*(1-n*i),d=r*(1-(1-n)*i),h=0,p=0,_=0;switch(s%6){case 0:h=r,p=d,_=c;break;case 1:h=u,p=r,_=c;break;case 2:h=c,p=r,_=d;break;case 3:h=c,p=u,_=r;break;case 4:h=d,p=c,_=r;break;case 5:h=r,p=c,_=u}return[o(255*h),a(255*p),l(255*_)]};var v=[.199,.687,.114];function S(e){return v[0]*e[0]+v[1]*e[1]+v[2]*e[2]}function y(e,t,i){void 0===i&&(i=.05);var r=m(e),s=r[0]+t*i;return r[0]=u(s-Math.floor(s)),g(r)}function b(e,t,i){void 0===i&&(i=.05);var r=e[0],s=e[1],n=e[2],o=e[3],a=y([r,s,n],t,i);return[a[0],a[1],a[2],o]}t.rgbToGrayscale=S,t.distanceRgb=function(e,t){var i=e[0],r=e[1],s=e[2],n=t[0]-i,o=t[1]-r,a=t[2]-s;return Math.sqrt(n*n+o*o+a*a)},t.invertRgb=function(e){return[255-e[0],255-e[1],255-e[2]]},t.darkenRgb=function(e,t){var i=m(e);return g([i[0],i[1],p(i[2]-t/100)])},t.blendRgba=function(e,t){var i=e[0],r=e[1],s=e[2],n=e[3],u=t[0],d=t[1],h=t[2],p=t[3],_=c(1-(1-p)*(1-n));return[o(u*p/_+i*n*(1-p)/_),a(d*p/_+r*n*(1-p)/_),l(h*p/_+s*n*(1-p)/_),_]},t.shiftRgb=y,t.shiftRgba=b,t.shiftColor=function(e,t,i){return void 0===i&&(i=.05),k(b(N(e),t,i))};var w,P,C,T,x={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",
mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function I(e,t){return t in e}function L(e){var t=w.re.exec(e);return null!==t?w.parse(t):null}function M(e){var t=P.re.exec(e);return null!==t?P.parse(t):null}function E(e){var t=C.re.exec(e);return null!==t?C.parse(t):null}function A(e){var t=T.re.exec(e);return null!==t?T.parse(t):null}function k(e){return"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function D(e){if(e=e.toLowerCase(),I(x,e)){var t=M(x[e]);if(null!==t)return t;throw new Error("Invalid named color definition")}var i=L(e);if(null!==i)return i;var r=M(e);if(null!==r)return r;var s=E(e);if(null!==s)return s;var n=A(e);return null!==n?[n[0],n[1],n[2]]:null}function R(e){if(e=e.toLowerCase(),I(x,e)){var t=M(x[e]);if(null!==t)return[t[0],t[1],t[2],1];throw new Error("Invalid named color definition")}var i=L(e);if(null!==i)return[i[0],i[1],i[2],1];var r=M(e);if(null!==r)return[r[0],r[1],r[2],1];var s=E(e);if(null!==s)return[s[0],s[1],s[2],1];var n=A(e);return null!==n?n:null}function N(e){var t=R(e);if(null!==t)return t;throw new Error("Passed color string does not match any of the known color representations")}!function(e){e.re=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,e.parse=function(e){return[o(parseInt(e[1],10)),a(parseInt(e[2],10)),l(parseInt(e[3],10))]}}(w||(w={})),t.rgbToString=function(e){return"rgb("+e[0]+", "+e[1]+", "+e[2]+")"},function(e){e.re=/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,e.parse=function(e){return[o(parseInt(e[1],16)),a(parseInt(e[2],16)),l(parseInt(e[3],16))]}}(P||(P={})),t.rgbToHexString=function(e){var t=e[0],i=e[1],r=e[2],s=t.toString(16),n=i.toString(16),o=r.toString(16);return"#"+(1===s.length?"0":"")+s+(1===n.length?"0":"")+n+(1===o.length?"0":"")+o},function(e){e.re=/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/,e.parse=function(e){return[o(parseInt(e[1]+e[1],16)),a(parseInt(e[2]+e[2],16)),l(parseInt(e[3]+e[3],16))]}}(C||(C={})),function(e){e.re=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/,e.parse=function(e){
return[o(parseInt(e[1],10)),a(parseInt(e[2],10)),l(parseInt(e[3],10)),c(parseFloat(e[4]))]}}(T||(T={})),t.rgbaToString=k,t.rgbToBlackWhiteString=function(e,t){if(t<0||t>255)throw new Error("invalid threshold value, valid values are [0, 255]");return S(e)>=t?"white":"black"},t.tryParseRgb=D,t.parseRgb=function(e){var t=D(e);if(null!==t)return t;throw new Error("Passed color string does not match any of the known color representations")},t.tryParseRgba=R,t.parseRgba=N},90010:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},41227:(e,t,i)=>{var r=i(25192)("unscopables"),s=Array.prototype;null==s[r]&&i(10785)(s,r,{}),e.exports=function(e){s[r][e]=!0}},85223:e=>{e.exports=function(e,t,i,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(i+": incorrect invocation!");return e}},83965:(e,t,i)=>{var r=i(42338);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},74097:(e,t,i)=>{"use strict";var r=i(49628),s=i(7128),n=i(13044);e.exports=function(e){for(var t=r(this),i=n(t.length),o=arguments.length,a=s(o>1?arguments[1]:void 0,i),l=o>2?arguments[2]:void 0,c=void 0===l?i:s(l,i);c>a;)t[a++]=e;return t}},26539:(e,t,i)=>{var r=i(91358),s=i(13044),n=i(7128);e.exports=function(e){return function(t,i,o){var a,l=r(t),c=s(l.length),u=n(o,c);if(e&&i!=i){for(;c>u;)if((a=l[u++])!=a)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===i)return e||u||0;return!e&&-1}}},52527:(e,t,i)=>{var r=i(97653),s=i(12140),n=i(49628),o=i(13044),a=i(86046);e.exports=function(e,t){var i=1==e,l=2==e,c=3==e,u=4==e,d=6==e,h=5==e||d,p=t||a;return function(t,a,_){for(var m,f,g=n(t),v=s(g),S=r(a,_,3),y=o(v.length),b=0,w=i?p(t,y):l?p(t,0):void 0;y>b;b++)if((h||b in v)&&(f=S(m=v[b],b,g),e))if(i)w[b]=f;else if(f)switch(e){case 3:return!0;case 5:return m;case 6:return b;case 2:w.push(m)}else if(u)return!1;return d?-1:c||u?u:w}}},26077:(e,t,i)=>{var r=i(42338),s=i(35688),n=i(25192)("species");e.exports=function(e){var t;return s(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!s(t.prototype)||(t=void 0),r(t)&&null===(t=t[n])&&(t=void 0)),void 0===t?Array:t}},86046:(e,t,i)=>{var r=i(26077);e.exports=function(e,t){return new(r(e))(t)}},32154:(e,t,i)=>{var r=i(45528),s=i(25192)("toStringTag"),n="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,i,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),s))?i:n?r(t):"Object"==(o=r(t))&&"function"==typeof t.callee?"Arguments":o}},45528:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},33659:(e,t,i)=>{"use strict";var r=i(93427).f,s=i(86093),n=i(35112),o=i(97653),a=i(85223),l=i(93949),c=i(41091),u=i(1148),d=i(55082),h=i(83572),p=i(76813).fastKey,_=i(16488),m=h?"_s":"size",f=function(e,t){var i,r=p(t);if("F"!==r)return e._i[r];for(i=e._f;i;i=i.n)if(i.k==t)return i};e.exports={getConstructor:function(e,t,i,c){var u=e((function(e,r){a(e,u,t,"_i"),e._t=t,e._i=s(null),e._f=void 0,e._l=void 0,e[m]=0,null!=r&&l(r,i,e[c],e)}))
;return n(u.prototype,{clear:function(){for(var e=_(this,t),i=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete i[r.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var i=_(this,t),r=f(i,e);if(r){var s=r.n,n=r.p;delete i._i[r.i],r.r=!0,n&&(n.n=s),s&&(s.p=n),i._f==r&&(i._f=s),i._l==r&&(i._l=n),i[m]--}return!!r},forEach:function(e){_(this,t);for(var i,r=o(e,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(r(i.v,i.k,this);i&&i.r;)i=i.p},has:function(e){return!!f(_(this,t),e)}}),h&&r(u.prototype,"size",{get:function(){return _(this,t)[m]}}),u},def:function(e,t,i){var r,s,n=f(e,t);return n?n.v=i:(e._l=n={i:s=p(t,!0),k:t,v:i,p:r=e._l,n:void 0,r:!1},e._f||(e._f=n),r&&(r.n=n),e[m]++,"F"!==s&&(e._i[s]=n)),e},getEntry:f,setStrong:function(e,t,i){c(e,t,(function(e,i){this._t=_(e,t),this._k=i,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))}),i?"entries":"values",!i,!0),d(t)}}},41895:(e,t,i)=>{"use strict";var r=i(89659),s=i(43498),n=i(91402),o=i(35112),a=i(76813),l=i(93949),c=i(85223),u=i(42338),d=i(45718),h=i(80530),p=i(94147),_=i(91616);e.exports=function(e,t,i,m,f,g){var v=r[e],S=v,y=f?"set":"add",b=S&&S.prototype,w={},P=function(e){var t=b[e];n(b,e,"delete"==e||"has"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,i){return t.call(this,0===e?0:e,i),this})};if("function"==typeof S&&(g||b.forEach&&!d((function(){(new S).entries().next()})))){var C=new S,T=C[y](g?{}:-0,1)!=C,x=d((function(){C.has(1)})),I=h((function(e){new S(e)})),L=!g&&d((function(){for(var e=new S,t=5;t--;)e[y](t,t);return!e.has(-0)}));I||((S=t((function(t,i){c(t,S,e);var r=_(new v,t,S);return null!=i&&l(i,f,r[y],r),r}))).prototype=b,b.constructor=S),(x||L)&&(P("delete"),P("has"),f&&P("get")),(L||T)&&P(y),g&&b.clear&&delete b.clear}else S=m.getConstructor(t,e,f,y),o(S.prototype,i),a.NEED=!0;return p(S,e),w[e]=S,s(s.G+s.W+s.F*(S!=v),w),g||m.setStrong(S,e,f),S}},68138:e=>{var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)},86386:(e,t,i)=>{"use strict";var r=i(93427),s=i(71255);e.exports=function(e,t,i){t in e?r.f(e,t,s(0,i)):e[t]=i}},97653:(e,t,i)=>{var r=i(90010);e.exports=function(e,t,i){if(r(e),void 0===t)return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,r){return e.call(t,i,r)};case 3:return function(i,r,s){return e.call(t,i,r,s)}}return function(){return e.apply(t,arguments)}}},9976:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},83572:(e,t,i)=>{e.exports=!i(45718)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},93279:(e,t,i)=>{var r=i(42338),s=i(89659).document,n=r(s)&&r(s.createElement);e.exports=function(e){return n?s.createElement(e):{}}},22393:e=>{
e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},61e3:(e,t,i)=>{var r=i(68558),s=i(51765),n=i(33655);e.exports=function(e){var t=r(e),i=s.f;if(i)for(var o,a=i(e),l=n.f,c=0;a.length>c;)l.call(e,o=a[c++])&&t.push(o);return t}},43498:(e,t,i)=>{var r=i(89659),s=i(68138),n=i(10785),o=i(91402),a=i(97653),l=function(e,t,i){var c,u,d,h,p=e&l.F,_=e&l.G,m=e&l.S,f=e&l.P,g=e&l.B,v=_?r:m?r[t]||(r[t]={}):(r[t]||{}).prototype,S=_?s:s[t]||(s[t]={}),y=S.prototype||(S.prototype={});for(c in _&&(i=t),i)d=((u=!p&&v&&void 0!==v[c])?v:i)[c],h=g&&u?a(d,r):f&&"function"==typeof d?a(Function.call,d):d,v&&o(v,c,d,e&l.U),S[c]!=d&&n(S,c,h),f&&y[c]!=d&&(y[c]=d)};r.core=s,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},70436:(e,t,i)=>{var r=i(25192)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(i){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},45718:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},93949:(e,t,i)=>{var r=i(97653),s=i(44590),n=i(60668),o=i(83965),a=i(13044),l=i(62469),c={},u={},d=e.exports=function(e,t,i,d,h){var p,_,m,f,g=h?function(){return e}:l(e),v=r(i,d,t?2:1),S=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(n(g)){for(p=a(e.length);p>S;S++)if((f=t?v(o(_=e[S])[0],_[1]):v(e[S]))===c||f===u)return f}else for(m=g.call(e);!(_=m.next()).done;)if((f=s(m,v,_.value,t))===c||f===u)return f};d.BREAK=c,d.RETURN=u},56636:(e,t,i)=>{e.exports=i(29115)("native-function-to-string",Function.toString)},89659:e=>{var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},75650:e=>{var t={}.hasOwnProperty;e.exports=function(e,i){return t.call(e,i)}},10785:(e,t,i)=>{var r=i(93427),s=i(71255);e.exports=i(83572)?function(e,t,i){return r.f(e,t,s(1,i))}:function(e,t,i){return e[t]=i,e}},22608:(e,t,i)=>{var r=i(89659).document;e.exports=r&&r.documentElement},28379:(e,t,i)=>{e.exports=!i(83572)&&!i(45718)((function(){return 7!=Object.defineProperty(i(93279)("div"),"a",{get:function(){return 7}}).a}))},91616:(e,t,i)=>{var r=i(42338),s=i(81022).set;e.exports=function(e,t,i){var n,o=t.constructor;return o!==i&&"function"==typeof o&&(n=o.prototype)!==i.prototype&&r(n)&&s&&s(e,n),e}},32230:e=>{e.exports=function(e,t,i){var r=void 0===i;switch(t.length){case 0:return r?e():e.call(i);case 1:return r?e(t[0]):e.call(i,t[0]);case 2:return r?e(t[0],t[1]):e.call(i,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(i,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(i,t[0],t[1],t[2],t[3])}return e.apply(i,t)}},12140:(e,t,i)=>{var r=i(45528);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},60668:(e,t,i)=>{var r=i(69819),s=i(25192)("iterator"),n=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||n[s]===e)}},35688:(e,t,i)=>{var r=i(45528);e.exports=Array.isArray||function(e){return"Array"==r(e)}},44707:(e,t,i)=>{
var r=i(42338),s=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&s(e)===e}},42338:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},79878:(e,t,i)=>{var r=i(42338),s=i(45528),n=i(25192)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[n])?!!t:"RegExp"==s(e))}},44590:(e,t,i)=>{var r=i(83965);e.exports=function(e,t,i,s){try{return s?t(r(i)[0],i[1]):t(i)}catch(t){var n=e.return;throw void 0!==n&&r(n.call(e)),t}}},95964:(e,t,i)=>{"use strict";var r=i(86093),s=i(71255),n=i(94147),o={};i(10785)(o,i(25192)("iterator"),(function(){return this})),e.exports=function(e,t,i){e.prototype=r(o,{next:s(1,i)}),n(e,t+" Iterator")}},41091:(e,t,i)=>{"use strict";var r=i(2557),s=i(43498),n=i(91402),o=i(10785),a=i(69819),l=i(95964),c=i(94147),u=i(32396),d=i(25192)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,i,_,m,f,g){l(i,t,_);var v,S,y,b=function(e){if(!h&&e in T)return T[e];switch(e){case"keys":case"values":return function(){return new i(this,e)}}return function(){return new i(this,e)}},w=t+" Iterator",P="values"==m,C=!1,T=e.prototype,x=T[d]||T["@@iterator"]||m&&T[m],I=x||b(m),L=m?P?b("entries"):I:void 0,M="Array"==t&&T.entries||x;if(M&&(y=u(M.call(new e)))!==Object.prototype&&y.next&&(c(y,w,!0),r||"function"==typeof y[d]||o(y,d,p)),P&&x&&"values"!==x.name&&(C=!0,I=function(){return x.call(this)}),r&&!g||!h&&!C&&T[d]||o(T,d,I),a[t]=I,a[w]=p,m)if(v={values:P?I:b("values"),keys:f?I:b("keys"),entries:L},g)for(S in v)S in T||n(T,S,v[S]);else s(s.P+s.F*(h||C),t,v);return v}},80530:(e,t,i)=>{var r=i(25192)("iterator"),s=!1;try{var n=[7][r]();n.return=function(){s=!0},Array.from(n,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!s)return!1;var i=!1;try{var n=[7],o=n[r]();o.next=function(){return{done:i=!0}},n[r]=function(){return o},e(n)}catch(e){}return i}},1148:e=>{e.exports=function(e,t){return{value:t,done:!!e}}},69819:e=>{e.exports={}},2557:e=>{e.exports=!1},61638:e=>{e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},76813:(e,t,i)=>{var r=i(56052)("meta"),s=i(42338),n=i(75650),o=i(93427).f,a=0,l=Object.isExtensible||function(){return!0},c=!i(45718)((function(){return l(Object.preventExtensions({}))})),u=function(e){o(e,r,{value:{i:"O"+ ++a,w:{}}})},d=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!n(e,r)){if(!l(e))return"F";if(!t)return"E";u(e)}return e[r].i},getWeak:function(e,t){if(!n(e,r)){if(!l(e))return!0;if(!t)return!1;u(e)}return e[r].w},onFreeze:function(e){return c&&d.NEED&&l(e)&&!n(e,r)&&u(e),e}}},29301:(e,t,i)=>{var r=i(89659),s=i(99770).set,n=r.MutationObserver||r.WebKitMutationObserver,o=r.process,a=r.Promise,l="process"==i(45528)(o);e.exports=function(){var e,t,i,c=function(){var r,s;for(l&&(r=o.domain)&&r.exit();e;){s=e.fn,e=e.next;try{s()}catch(r){throw e?i():t=void 0,r}}t=void 0,r&&r.enter()};if(l)i=function(){o.nextTick(c)};else if(!n||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var u=a.resolve(void 0)
;i=function(){u.then(c)}}else i=function(){s.call(r,c)};else{var d=!0,h=document.createTextNode("");new n(c).observe(h,{characterData:!0}),i=function(){h.data=d=!d}}return function(r){var s={fn:r,next:void 0};t&&(t.next=s),e||(e=s,i()),t=s}}},80590:(e,t,i)=>{"use strict";var r=i(90010);function s(e){var t,i;this.promise=new e((function(e,r){if(void 0!==t||void 0!==i)throw TypeError("Bad Promise constructor");t=e,i=r})),this.resolve=r(t),this.reject=r(i)}e.exports.f=function(e){return new s(e)}},65999:(e,t,i)=>{"use strict";var r=i(68558),s=i(51765),n=i(33655),o=i(49628),a=i(12140),l=Object.assign;e.exports=!l||i(45718)((function(){var e={},t={},i=Symbol(),r="abcdefghijklmnopqrst";return e[i]=7,r.split("").forEach((function(e){t[e]=e})),7!=l({},e)[i]||Object.keys(l({},t)).join("")!=r}))?function(e,t){for(var i=o(e),l=arguments.length,c=1,u=s.f,d=n.f;l>c;)for(var h,p=a(arguments[c++]),_=u?r(p).concat(u(p)):r(p),m=_.length,f=0;m>f;)d.call(p,h=_[f++])&&(i[h]=p[h]);return i}:l},86093:(e,t,i)=>{var r=i(83965),s=i(80444),n=i(22393),o=i(87453)("IE_PROTO"),a=function(){},l=function(){var e,t=i(93279)("iframe"),r=n.length;for(t.style.display="none",i(22608).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;r--;)delete l.prototype[n[r]];return l()};e.exports=Object.create||function(e,t){var i;return null!==e?(a.prototype=r(e),i=new a,a.prototype=null,i[o]=e):i=l(),void 0===t?i:s(i,t)}},93427:(e,t,i)=>{var r=i(83965),s=i(28379),n=i(66895),o=Object.defineProperty;t.f=i(83572)?Object.defineProperty:function(e,t,i){if(r(e),t=n(t,!0),r(i),s)try{return o(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(e[t]=i.value),e}},80444:(e,t,i)=>{var r=i(93427),s=i(83965),n=i(68558);e.exports=i(83572)?Object.defineProperties:function(e,t){s(e);for(var i,o=n(t),a=o.length,l=0;a>l;)r.f(e,i=o[l++],t[i]);return e}},61734:(e,t,i)=>{var r=i(33655),s=i(71255),n=i(91358),o=i(66895),a=i(75650),l=i(28379),c=Object.getOwnPropertyDescriptor;t.f=i(83572)?c:function(e,t){if(e=n(e),t=o(t,!0),l)try{return c(e,t)}catch(e){}if(a(e,t))return s(!r.f.call(e,t),e[t])}},33868:(e,t,i)=>{var r=i(91358),s=i(83457).f,n={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==n.call(e)?function(e){try{return s(e)}catch(e){return o.slice()}}(e):s(r(e))}},83457:(e,t,i)=>{var r=i(55959),s=i(22393).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,s)}},51765:(e,t)=>{t.f=Object.getOwnPropertySymbols},32396:(e,t,i)=>{var r=i(75650),s=i(49628),n=i(87453)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=s(e),r(e,n)?e[n]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},55959:(e,t,i)=>{var r=i(75650),s=i(91358),n=i(26539)(!1),o=i(87453)("IE_PROTO");e.exports=function(e,t){var i,a=s(e),l=0,c=[]
;for(i in a)i!=o&&r(a,i)&&c.push(i);for(;t.length>l;)r(a,i=t[l++])&&(~n(c,i)||c.push(i));return c}},68558:(e,t,i)=>{var r=i(55959),s=i(22393);e.exports=Object.keys||function(e){return r(e,s)}},33655:(e,t)=>{t.f={}.propertyIsEnumerable},62946:(e,t,i)=>{var r=i(68558),s=i(91358),n=i(33655).f;e.exports=function(e){return function(t){for(var i,o=s(t),a=r(o),l=a.length,c=0,u=[];l>c;)n.call(o,i=a[c++])&&u.push(e?[i,o[i]]:o[i]);return u}}},53713:(e,t,i)=>{var r=i(89659).parseFloat,s=i(11113).trim;e.exports=1/r(i(59121)+"-0")!=-1/0?function(e){var t=s(String(e),3),i=r(t);return 0===i&&"-"==t.charAt(0)?-0:i}:r},21362:(e,t,i)=>{var r=i(89659).parseInt,s=i(11113).trim,n=i(59121),o=/^[-+]?0[xX]/;e.exports=8!==r(n+"08")||22!==r(n+"0x16")?function(e,t){var i=s(String(e),3);return r(i,t>>>0||(o.test(i)?16:10))}:r},95147:e=>{e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},53042:(e,t,i)=>{var r=i(83965),s=i(42338),n=i(80590);e.exports=function(e,t){if(r(e),s(t)&&t.constructor===e)return t;var i=n.f(e);return(0,i.resolve)(t),i.promise}},71255:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},35112:(e,t,i)=>{var r=i(91402);e.exports=function(e,t,i){for(var s in t)r(e,s,t[s],i);return e}},91402:(e,t,i)=>{var r=i(89659),s=i(10785),n=i(75650),o=i(56052)("src"),a=i(56636),l=(""+a).split("toString");i(68138).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,i,a){var c="function"==typeof i;c&&(n(i,"name")||s(i,"name",t)),e[t]!==i&&(c&&(n(i,o)||s(i,o,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=i:a?e[t]?e[t]=i:s(e,t,i):(delete e[t],s(e,t,i)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[o]||a.call(this)}))},81022:(e,t,i)=>{var r=i(42338),s=i(83965),n=function(e,t){if(s(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=i(97653)(Function.call,i(61734).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,i){return n(e,i),t?e.__proto__=i:r(e,i),e}}({},!1):void 0),check:n}},55082:(e,t,i)=>{"use strict";var r=i(89659),s=i(93427),n=i(83572),o=i(25192)("species");e.exports=function(e){var t=r[e];n&&t&&!t[o]&&s.f(t,o,{configurable:!0,get:function(){return this}})}},94147:(e,t,i)=>{var r=i(93427).f,s=i(75650),n=i(25192)("toStringTag");e.exports=function(e,t,i){e&&!s(e=i?e:e.prototype,n)&&r(e,n,{configurable:!0,value:t})}},87453:(e,t,i)=>{var r=i(29115)("keys"),s=i(56052);e.exports=function(e){return r[e]||(r[e]=s(e))}},29115:(e,t,i)=>{var r=i(68138),s=i(89659),n=s["__core-js_shared__"]||(s["__core-js_shared__"]={});(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:i(2557)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},52844:(e,t,i)=>{var r=i(83965),s=i(90010),n=i(25192)("species");e.exports=function(e,t){var i,o=r(e).constructor;return void 0===o||null==(i=r(o)[n])?t:s(i)}},66205:(e,t,i)=>{
var r=i(44573),s=i(9976);e.exports=function(e){return function(t,i){var n,o,a=String(s(t)),l=r(i),c=a.length;return l<0||l>=c?e?"":void 0:(n=a.charCodeAt(l))<55296||n>56319||l+1===c||(o=a.charCodeAt(l+1))<56320||o>57343?e?a.charAt(l):n:e?a.slice(l,l+2):o-56320+(n-55296<<10)+65536}}},19537:(e,t,i)=>{var r=i(79878),s=i(9976);e.exports=function(e,t,i){if(r(t))throw TypeError("String#"+i+" doesn't accept regex!");return String(s(e))}},57153:(e,t,i)=>{var r=i(13044),s=i(88832),n=i(9976);e.exports=function(e,t,i,o){var a=String(n(e)),l=a.length,c=void 0===i?" ":String(i),u=r(t);if(u<=l||""==c)return a;var d=u-l,h=s.call(c,Math.ceil(d/c.length));return h.length>d&&(h=h.slice(0,d)),o?h+a:a+h}},88832:(e,t,i)=>{"use strict";var r=i(44573),s=i(9976);e.exports=function(e){var t=String(s(this)),i="",n=r(e);if(n<0||n==1/0)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(i+=t);return i}},11113:(e,t,i)=>{var r=i(43498),s=i(9976),n=i(45718),o=i(59121),a="["+o+"]",l=RegExp("^"+a+a+"*"),c=RegExp(a+a+"*$"),u=function(e,t,i){var s={},a=n((function(){return!!o[e]()||"​"!="​"[e]()})),l=s[e]=a?t(d):o[e];i&&(s[i]=l),r(r.P+r.F*a,"String",s)},d=u.trim=function(e,t){return e=String(s(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(c,"")),e};e.exports=u},59121:e=>{e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},99770:(e,t,i)=>{var r,s,n,o=i(97653),a=i(32230),l=i(22608),c=i(93279),u=i(89659),d=u.process,h=u.setImmediate,p=u.clearImmediate,_=u.MessageChannel,m=u.Dispatch,f=0,g={},v=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},S=function(e){v.call(e.data)};h&&p||(h=function(e){for(var t=[],i=1;arguments.length>i;)t.push(arguments[i++]);return g[++f]=function(){a("function"==typeof e?e:Function(e),t)},r(f),f},p=function(e){delete g[e]},"process"==i(45528)(d)?r=function(e){d.nextTick(o(v,e,1))}:m&&m.now?r=function(e){m.now(o(v,e,1))}:_?(n=(s=new _).port2,s.port1.onmessage=S,r=o(n.postMessage,n,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(r=function(e){u.postMessage(e+"","*")},u.addEventListener("message",S,!1)):r="onreadystatechange"in c("script")?function(e){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),v.call(e)}}:function(e){setTimeout(o(v,e,1),0)}),e.exports={set:h,clear:p}},7128:(e,t,i)=>{var r=i(44573),s=Math.max,n=Math.min;e.exports=function(e,t){return(e=r(e))<0?s(e+t,0):n(e,t)}},44573:e=>{var t=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:t)(e)}},91358:(e,t,i)=>{var r=i(12140),s=i(9976);e.exports=function(e){return r(s(e))}},13044:(e,t,i)=>{var r=i(44573),s=Math.min;e.exports=function(e){return e>0?s(r(e),9007199254740991):0}},49628:(e,t,i)=>{var r=i(9976);e.exports=function(e){return Object(r(e))}},66895:(e,t,i)=>{var r=i(42338);e.exports=function(e,t){if(!r(e))return e;var i,s;if(t&&"function"==typeof(i=e.toString)&&!r(s=i.call(e)))return s;if("function"==typeof(i=e.valueOf)&&!r(s=i.call(e)))return s;if(!t&&"function"==typeof(i=e.toString)&&!r(s=i.call(e)))return s
;throw TypeError("Can't convert object to primitive value")}},56052:e=>{var t=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+i).toString(36))}},75798:(e,t,i)=>{var r=i(89659).navigator;e.exports=r&&r.userAgent||""},16488:(e,t,i)=>{var r=i(42338);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},44259:(e,t,i)=>{var r=i(89659),s=i(68138),n=i(2557),o=i(41355),a=i(93427).f;e.exports=function(e){var t=s.Symbol||(s.Symbol=n?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:o.f(e)})}},41355:(e,t,i)=>{t.f=i(25192)},25192:(e,t,i)=>{var r=i(29115)("wks"),s=i(56052),n=i(89659).Symbol,o="function"==typeof n;(e.exports=function(e){return r[e]||(r[e]=o&&n[e]||(o?n:s)("Symbol."+e))}).store=r},62469:(e,t,i)=>{var r=i(32154),s=i(25192)("iterator"),n=i(69819);e.exports=i(68138).getIteratorMethod=function(e){if(null!=e)return e[s]||e["@@iterator"]||n[r(e)]}},21915:(e,t,i)=>{var r=i(43498);r(r.P,"Array",{fill:i(74097)}),i(41227)("fill")},25429:(e,t,i)=>{"use strict";var r=i(43498),s=i(52527)(6),n="findIndex",o=!0;n in[]&&Array(1)[n]((function(){o=!1})),r(r.P+r.F*o,"Array",{findIndex:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),i(41227)(n)},35038:(e,t,i)=>{"use strict";var r=i(43498),s=i(52527)(5),n=!0;"find"in[]&&Array(1).find((function(){n=!1})),r(r.P+r.F*n,"Array",{find:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),i(41227)("find")},83251:(e,t,i)=>{"use strict";var r=i(97653),s=i(43498),n=i(49628),o=i(44590),a=i(60668),l=i(13044),c=i(86386),u=i(62469);s(s.S+s.F*!i(80530)((function(e){Array.from(e)})),"Array",{from:function(e){var t,i,s,d,h=n(e),p="function"==typeof this?this:Array,_=arguments.length,m=_>1?arguments[1]:void 0,f=void 0!==m,g=0,v=u(h);if(f&&(m=r(m,_>2?arguments[2]:void 0,2)),null==v||p==Array&&a(v))for(i=new p(t=l(h.length));t>g;g++)c(i,g,f?m(h[g],g):h[g]);else for(d=v.call(h),i=new p;!(s=d.next()).done;g++)c(i,g,f?o(d,m,[s.value,g],!0):s.value);return i.length=g,i}})},18126:(e,t,i)=>{"use strict";var r=i(41227),s=i(1148),n=i(69819),o=i(91358);e.exports=i(41091)(Array,"Array",(function(e,t){this._t=o(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,i=this._i++;return!e||i>=e.length?(this._t=void 0,s(1)):s(0,"keys"==t?i:"values"==t?e[i]:[i,e[i]])}),"values"),n.Arguments=n.Array,r("keys"),r("values"),r("entries")},66013:(e,t,i)=>{var r=Date.prototype,s=r.toString,n=r.getTime;new Date(NaN)+""!="Invalid Date"&&i(91402)(r,"toString",(function(){var e=n.call(this);return e==e?s.call(this):"Invalid Date"}))},59899:(e,t,i)=>{"use strict";var r=i(33659),s=i(16488);e.exports=i(41895)("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=r.getEntry(s(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(s(this,"Map"),0===e?0:e,t)}},r,!0)},74678:(e,t,i)=>{var r=i(43498);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},90915:(e,t,i)=>{var r=i(43498);r(r.S,"Math",{sign:i(61638)
})},86651:(e,t,i)=>{var r=i(43498);r(r.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},89247:(e,t,i)=>{var r=i(43498),s=i(89659).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&s(e)}})},98398:(e,t,i)=>{var r=i(43498);r(r.S,"Number",{isInteger:i(44707)})},35695:(e,t,i)=>{var r=i(43498);r(r.S,"Number",{isNaN:function(e){return e!=e}})},4674:(e,t,i)=>{var r=i(43498),s=i(44707),n=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return s(e)&&n(e)<=9007199254740991}})},35918:(e,t,i)=>{var r=i(43498);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},349:(e,t,i)=>{var r=i(43498);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},19673:(e,t,i)=>{var r=i(43498),s=i(53713);r(r.S+r.F*(Number.parseFloat!=s),"Number",{parseFloat:s})},48725:(e,t,i)=>{var r=i(43498),s=i(21362);r(r.S+r.F*(Number.parseInt!=s),"Number",{parseInt:s})},35076:(e,t,i)=>{var r=i(43498);r(r.S+r.F,"Object",{assign:i(65999)})},57475:(e,t,i)=>{"use strict";var r,s,n,o,a=i(2557),l=i(89659),c=i(97653),u=i(32154),d=i(43498),h=i(42338),p=i(90010),_=i(85223),m=i(93949),f=i(52844),g=i(99770).set,v=i(29301)(),S=i(80590),y=i(95147),b=i(75798),w=i(53042),P=l.TypeError,C=l.process,T=C&&C.versions,x=T&&T.v8||"",I=l.Promise,L="process"==u(C),M=function(){},E=s=S.f,A=!!function(){try{var e=I.resolve(1),t=(e.constructor={})[i(25192)("species")]=function(e){e(M,M)};return(L||"function"==typeof PromiseRejectionEvent)&&e.then(M)instanceof t&&0!==x.indexOf("6.6")&&-1===b.indexOf("Chrome/66")}catch(e){}}(),k=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},D=function(e,t){if(!e._n){e._n=!0;var i=e._c;v((function(){for(var r=e._v,s=1==e._s,n=0,o=function(t){var i,n,o,a=s?t.ok:t.fail,l=t.resolve,c=t.reject,u=t.domain;try{a?(s||(2==e._h&&O(e),e._h=1),!0===a?i=r:(u&&u.enter(),i=a(r),u&&(u.exit(),o=!0)),i===t.promise?c(P("Promise-chain cycle")):(n=k(i))?n.call(i,l,c):l(i)):c(r)}catch(e){u&&!o&&u.exit(),c(e)}};i.length>n;)o(i[n++]);e._c=[],e._n=!1,t&&!e._h&&R(e)}))}},R=function(e){g.call(l,(function(){var t,i,r,s=e._v,n=N(e);if(n&&(t=y((function(){L?C.emit("unhandledRejection",s,e):(i=l.onunhandledrejection)?i({promise:e,reason:s}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",s)})),e._h=L||N(e)?2:1),e._a=void 0,n&&t.e)throw t.v}))},N=function(e){return 1!==e._h&&0===(e._a||e._c).length},O=function(e){g.call(l,(function(){var t;L?C.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})}))},V=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),D(t,!0))},B=function(e){var t,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===e)throw P("Promise can't be resolved itself");(t=k(e))?v((function(){var r={_w:i,_d:!1};try{t.call(e,c(B,r,1),c(V,r,1))}catch(e){V.call(r,e)}})):(i._v=e,i._s=1,D(i,!1))}catch(e){V.call({_w:i,_d:!1},e)}}};A||(I=function(e){_(this,I,"Promise","_h"),p(e),r.call(this);try{e(c(B,this,1),c(V,this,1))}catch(e){V.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1
}).prototype=i(35112)(I.prototype,{then:function(e,t){var i=E(f(this,I));return i.ok="function"!=typeof e||e,i.fail="function"==typeof t&&t,i.domain=L?C.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&D(this,!1),i.promise},catch:function(e){return this.then(void 0,e)}}),n=function(){var e=new r;this.promise=e,this.resolve=c(B,e,1),this.reject=c(V,e,1)},S.f=E=function(e){return e===I||e===o?new n(e):s(e)}),d(d.G+d.W+d.F*!A,{Promise:I}),i(94147)(I,"Promise"),i(55082)("Promise"),o=i(68138).Promise,d(d.S+d.F*!A,"Promise",{reject:function(e){var t=E(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(a||!A),"Promise",{resolve:function(e){return w(a&&this===o?I:this,e)}}),d(d.S+d.F*!(A&&i(80530)((function(e){I.all(e).catch(M)}))),"Promise",{all:function(e){var t=this,i=E(t),r=i.resolve,s=i.reject,n=y((function(){var i=[],n=0,o=1;m(e,!1,(function(e){var a=n++,l=!1;i.push(void 0),o++,t.resolve(e).then((function(e){l||(l=!0,i[a]=e,--o||r(i))}),s)})),--o||r(i)}));return n.e&&s(n.v),i.promise},race:function(e){var t=this,i=E(t),r=i.reject,s=y((function(){m(e,!1,(function(e){t.resolve(e).then(i.resolve,r)}))}));return s.e&&r(s.v),i.promise}})},85433:(e,t,i)=>{"use strict";var r=i(33659),s=i(16488);e.exports=i(41895)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(s(this,"Set"),e=0===e?0:e,e)}},r)},24738:(e,t,i)=>{"use strict";var r=i(43498),s=i(66205)(!1);r(r.P,"String",{codePointAt:function(e){return s(this,e)}})},53094:(e,t,i)=>{"use strict";var r=i(43498),s=i(13044),n=i(19537),o="".endsWith;r(r.P+r.F*i(70436)("endsWith"),"String",{endsWith:function(e){var t=n(this,e,"endsWith"),i=arguments.length>1?arguments[1]:void 0,r=s(t.length),a=void 0===i?r:Math.min(s(i),r),l=String(e);return o?o.call(t,l,a):t.slice(a-l.length,a)===l}})},28100:(e,t,i)=>{var r=i(43498),s=i(7128),n=String.fromCharCode,o=String.fromCodePoint;r(r.S+r.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(e){for(var t,i=[],r=arguments.length,o=0;r>o;){if(t=+arguments[o++],s(t,1114111)!==t)throw RangeError(t+" is not a valid code point");i.push(t<65536?n(t):n(55296+((t-=65536)>>10),t%1024+56320))}return i.join("")}})},77094:(e,t,i)=>{"use strict";var r=i(43498),s=i(19537);r(r.P+r.F*i(70436)("includes"),"String",{includes:function(e){return!!~s(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},96575:(e,t,i)=>{var r=i(43498);r(r.P,"String",{repeat:i(88832)})},67002:(e,t,i)=>{"use strict";var r=i(43498),s=i(13044),n=i(19537),o="".startsWith;r(r.P+r.F*i(70436)("startsWith"),"String",{startsWith:function(e){var t=n(this,e,"startsWith"),i=s(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return o?o.call(t,r,i):t.slice(i,i+r.length)===r}})},74104:(e,t,i)=>{"use strict"
;var r=i(89659),s=i(75650),n=i(83572),o=i(43498),a=i(91402),l=i(76813).KEY,c=i(45718),u=i(29115),d=i(94147),h=i(56052),p=i(25192),_=i(41355),m=i(44259),f=i(61e3),g=i(35688),v=i(83965),S=i(42338),y=i(91358),b=i(66895),w=i(71255),P=i(86093),C=i(33868),T=i(61734),x=i(93427),I=i(68558),L=T.f,M=x.f,E=C.f,A=r.Symbol,k=r.JSON,D=k&&k.stringify,R=p("_hidden"),N=p("toPrimitive"),O={}.propertyIsEnumerable,V=u("symbol-registry"),B=u("symbols"),F=u("op-symbols"),W=Object.prototype,U="function"==typeof A,H=r.QObject,z=!H||!H.prototype||!H.prototype.findChild,j=n&&c((function(){return 7!=P(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a}))?function(e,t,i){var r=L(W,t);r&&delete W[t],M(e,t,i),r&&e!==W&&M(W,t,r)}:M,Y=function(e){var t=B[e]=P(A.prototype);return t._k=e,t},G=U&&"symbol"==typeof A.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof A},q=function(e,t,i){return e===W&&q(F,t,i),v(e),t=b(t,!0),v(i),s(B,t)?(i.enumerable?(s(e,R)&&e[R][t]&&(e[R][t]=!1),i=P(i,{enumerable:w(0,!1)})):(s(e,R)||M(e,R,w(1,{})),e[R][t]=!0),j(e,t,i)):M(e,t,i)},X=function(e,t){v(e);for(var i,r=f(t=y(t)),s=0,n=r.length;n>s;)q(e,i=r[s++],t[i]);return e},$=function(e){var t=O.call(this,e=b(e,!0));return!(this===W&&s(B,e)&&!s(F,e))&&(!(t||!s(this,e)||!s(B,e)||s(this,R)&&this[R][e])||t)},K=function(e,t){if(e=y(e),t=b(t,!0),e!==W||!s(B,t)||s(F,t)){var i=L(e,t);return!i||!s(B,t)||s(e,R)&&e[R][t]||(i.enumerable=!0),i}},J=function(e){for(var t,i=E(y(e)),r=[],n=0;i.length>n;)s(B,t=i[n++])||t==R||t==l||r.push(t);return r},Z=function(e){for(var t,i=e===W,r=E(i?F:y(e)),n=[],o=0;r.length>o;)!s(B,t=r[o++])||i&&!s(W,t)||n.push(B[t]);return n};U||(a((A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(i){this===W&&t.call(F,i),s(this,R)&&s(this[R],e)&&(this[R][e]=!1),j(this,e,w(1,i))};return n&&z&&j(W,e,{configurable:!0,set:t}),Y(e)}).prototype,"toString",(function(){return this._k})),T.f=K,x.f=q,i(83457).f=C.f=J,i(33655).f=$,i(51765).f=Z,n&&!i(2557)&&a(W,"propertyIsEnumerable",$,!0),_.f=function(e){return Y(p(e))}),o(o.G+o.W+o.F*!U,{Symbol:A});for(var Q="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;Q.length>ee;)p(Q[ee++]);for(var te=I(p.store),ie=0;te.length>ie;)m(te[ie++]);o(o.S+o.F*!U,"Symbol",{for:function(e){return s(V,e+="")?V[e]:V[e]=A(e)},keyFor:function(e){if(!G(e))throw TypeError(e+" is not a symbol!");for(var t in V)if(V[t]===e)return t},useSetter:function(){z=!0},useSimple:function(){z=!1}}),o(o.S+o.F*!U,"Object",{create:function(e,t){return void 0===t?P(e):X(P(e),t)},defineProperty:q,defineProperties:X,getOwnPropertyDescriptor:K,getOwnPropertyNames:J,getOwnPropertySymbols:Z}),k&&o(o.S+o.F*(!U||c((function(){var e=A();return"[null]"!=D([e])||"{}"!=D({a:e})||"{}"!=D(Object(e))}))),"JSON",{stringify:function(e){for(var t,i,r=[e],s=1;arguments.length>s;)r.push(arguments[s++]);if(i=t=r[1],(S(t)||void 0!==e)&&!G(e))return g(t)||(t=function(e,t){
if("function"==typeof i&&(t=i.call(this,e,t)),!G(t))return t}),r[1]=t,D.apply(k,r)}}),A.prototype[N]||i(10785)(A.prototype,N,A.prototype.valueOf),d(A,"Symbol"),d(Math,"Math",!0),d(r.JSON,"JSON",!0)},66414:(e,t,i)=>{"use strict";var r=i(43498),s=i(26539)(!0);r(r.P,"Array",{includes:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),i(41227)("includes")},15670:(e,t,i)=>{var r=i(43498),s=i(62946)(!0);r(r.S,"Object",{entries:function(e){return s(e)}})},99346:(e,t,i)=>{var r=i(43498),s=i(62946)(!1);r(r.S,"Object",{values:function(e){return s(e)}})},49839:(e,t,i)=>{"use strict";var r=i(43498),s=i(57153),n=i(75798),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n);r(r.P+r.F*o,"String",{padEnd:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},35518:(e,t,i)=>{"use strict";var r=i(43498),s=i(57153),n=i(75798),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n);r(r.P+r.F*o,"String",{padStart:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},23673:(e,t,i)=>{"use strict";if(window._babelPolyfill)throw new Error("only one instance of babel/polyfill is allowed");window._babelPolyfill=!0,i(74104),i(35076),i(89247),i(98398),i(35695),i(4674),i(35918),i(349),i(19673),i(48725),i(74678),i(90915),i(86651),i(28100),i(24738),i(53094),i(77094),i(96575),i(67002),i(66013),i(83251),i(21915),i(35038),i(25429),i(18126),i(57475),i(59899),i(85433),i(66414),i(99346),i(15670),i(35518),i(49839)},18152:e=>{e.exports=[{value:"",name:"All Exchanges",desc:window.t("All Exchanges"),flag:"",country:"",group:"AllExchanges",providerId:""},{value:"ASCENDEX",name:"AscendEX",desc:window.t("AscendEX"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"ascendex"},{value:"BITHUMB",name:"Bithumb",desc:window.t("Bithumb"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bithumb"},{value:"BITKUB",name:"BITKUB",desc:window.t("BITKUB"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitkub"},{value:"796",name:"796",desc:window.t("796"),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"COINFLOOR",name:"Coinfloor",desc:window.t("Coinfloor"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"coinfloor"},{value:"DERIBIT",name:"Deribit",desc:window.t("Deribit"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"deribit"},{value:"CURRENCYCOM",name:"Currencycom",desc:window.t("Currencycom"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"currencycom"},{value:"GLASSNODE",name:"Glassnode",desc:window.t("Glassnode"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"glassnode"},{value:"OKEX",name:"OKEx",desc:window.t("OKEx"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"okex"},{value:"PANGOLIN",name:"Pangolin",desc:window.t("Pangolin"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"pangolin"},{value:"SPOOKYSWAP",name:"SpookySwap",desc:window.t("SpookySwap"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"spookyswap"},{value:"DFM",
name:"DFM",desc:window.t("DFM — Dubai Financial Market"),flag:"ae",group:"Middle East / Africa",country:"ae",providerId:""},{value:"LSE",name:"LSE",desc:window.t("LSE — London Stock Exchange (UK Companies)"),flag:"uk",group:"Europe",country:"uk",providerId:""},{value:"LSIN",name:"LSIN",desc:window.t("LSIN — London Stock Exchange (International Companies)"),flag:"uk",group:"Europe",country:"uk",providerId:""},{value:"EUREX",name:"EUREX",desc:window.t("EUREX — Eurex Exchange"),flag:"europe",group:"Europe",country:"eu",providerId:""},{value:"MGEX",name:"MGEX",desc:window.t("MGEX — Futures"),flag:"usa",hideInSymbolSearch:!0,group:"North America",country:"us",providerId:""},{value:"NASDAQ",name:"NASDAQ",desc:window.t("NASDAQ — NASDAQ Stock Market"),flag:"usa",group:"North America",country:"us",priorityInGroup:1,providerId:""},{value:"NYSE",name:"NYSE",desc:window.t("NYSE — New York Stock Exchange"),flag:"usa",group:"North America",country:"us",priorityInGroup:2,providerId:""},{value:"AMEX",name:"Arca",desc:window.t("Arca — NYSE Arca"),flag:"usa",group:"North America",country:"us",priorityInGroup:3,providerId:""},{value:"OTC",name:"OTC",desc:window.t("OTC — OTC Markets"),flag:"usa",group:"North America",country:"us",priorityInGroup:4,providerId:""},{value:"DJ",name:"DJ",desc:window.t("DJ — Dow Jones Indices"),flag:"usa",group:"North America",country:"us",priorityInGroup:5,providerId:""},{value:"SP",name:"SP",desc:window.t("SP — S&P Indices"),flag:"usa",group:"North America",country:"us",priorityInGroup:6,providerId:""},{value:"CBOE",name:"CBOE",desc:window.t("CBOE — Chicago Board Options Exchange"),flag:"usa",group:"North America",country:"us",priorityInGroup:7,providerId:""},{value:"CBOEEU",name:"CBOE EU",desc:window.t("CBOE EU — European Union Indices"),flag:"europe",group:"Europe",country:"eu",providerId:""},{value:"CBOT",name:"CBOT",desc:window.t("CBOT — Chicago Board of Trade"),flag:"usa",group:"North America",country:"us",priorityInGroup:8,providerId:""},{value:"CME",name:"CME GLOBEX",desc:window.t("CME GLOBEX — Chicago Mercantile Exchange Globex"),flag:"usa",group:"North America",country:"us",priorityInGroup:9,providerId:""},{value:"COMEX",name:"COMEX",desc:window.t("COMEX — Commodity Exchange"),flag:"usa",group:"North America",country:"us",priorityInGroup:10,providerId:""},{value:"NYMEX",name:"NYMEX",desc:window.t("NYMEX — New York Mercantile Exchange"),flag:"usa",group:"North America",country:"us",priorityInGroup:11,providerId:""},{value:"ICEUS",name:"ICEUS",desc:window.t("ICEUS — ICE Futures U.S."),flag:"usa",group:"North America",country:"us",priorityInGroup:12,providerId:""},{value:"FAIRX",name:"FairX",desc:window.t("FairX"),flag:"usa",group:"North America",country:"us",priorityInGroup:13,providerId:""},{value:"CSE",name:"CSE",desc:window.t("CSE — Canadian Securities Exchange"),flag:"canada",group:"North America",country:"ca",priorityInGroup:13,providerId:""},{value:"NEO",name:"NEO",desc:window.t("NEO — NEO Exchange"),flag:"canada",group:"North America",country:"ca",priorityInGroup:14,providerId:""},{
value:"TSX",name:"TSX",desc:window.t("TSX — Toronto Stock Exchange"),flag:"canada",group:"North America",country:"ca",priorityInGroup:15,providerId:""},{value:"TSXV",name:"TSXV",desc:window.t("TSXV — TSX Venture Exchange"),flag:"canada",group:"North America",country:"ca",priorityInGroup:16,providerId:""},{value:"MOEX",name:"MOEX",desc:window.t("MOEX — Moscow Exchange"),flag:"russia",group:"Europe",country:"ru",providerId:""},{value:"MYX",name:"MYX",desc:window.t("MYX — Bursa Malaysia Berhad"),flag:"malaysia",group:"Asia / Pacific",country:"my",providerId:""},{value:"FTSEMYX",name:"FTSE",desc:window.t("FTSE — FTSE Indices"),flag:"malaysia",group:"Asia / Pacific",country:"my",providerId:""},{value:"HOSE",name:"HOSE",desc:window.t("HOSE — Ho Chi Minh City Stock Exchange"),flag:"vietnam",group:"Asia / Pacific",country:"vn",providerId:""},{value:"HNX",name:"HNX",desc:window.t("HNX — Hanoi Stock Exchange"),flag:"vietnam",group:"Asia / Pacific",country:"vn"},{value:"UPCOM",name:"HNX",desc:window.t("HNX — Hanoi Stock Exchange (UPCoM)"),flag:"vietnam",group:"Asia / Pacific",country:"vn"},{value:"BITSTAMP",name:"Bitstamp",desc:window.t("Bitstamp"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitstamp"},{value:"BLACKBULL",name:"BlackBull Markets",desc:window.t("BlackBull Markets"),flag:"forex",group:"Forex",country:"",providerId:"blackbullmarkets"},{value:"FX",name:"FXCM",desc:window.t("FXCM"),flag:"forex",group:"Forex",country:"",providerId:"fxcm"},{value:"FXOPEN",name:"FXOpen",desc:window.t("FXOpen"),flag:"forex",group:"Forex",country:"",providerId:"fxopen"},{value:"EIGHTCAP",name:"Eightcap",desc:window.t("Eightcap"),flag:"forex",group:"Forex",country:"",providerId:"eightcap"},{value:"MERCADO",name:"Mercado",desc:window.t("Mercado"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"mercado"},{value:"BTCE",name:"BTC-e",desc:window.t("BTC-E"),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"BTCYOU",name:"BTCYou",desc:window.t("BTCYou"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"btcyou"},{value:"HONEYSWAP",name:"Honeyswap",desc:window.t("Honeyswap"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"honeyswap"},{value:"BSE",name:"BSE",desc:window.t("BSE — Bombay Stock Exchange"),flag:"india",group:"Asia / Pacific",country:"in",providerId:""},{value:"NYMEX_MINI",name:"NYMEX E-mini",desc:window.t("NYMEX E-mini — New York Mercantile Exchange"),flag:"usa",group:"North America",hideInSymbolSearch:!0,country:"us",providerId:""},{value:"COMEX_MINI",name:"COMEX E-mini",desc:window.t("COMEX E-mini — Commodity Exchange"),flag:"usa",group:"North America",hideInSymbolSearch:!0,country:"us",providerId:""},{value:"ICEEUR",name:"ICEEUR",desc:window.t("ICEEUR — ICE Futures Europe"),flag:"europe",group:"Europe",country:"eu",providerId:""},{value:"NSE",name:"NSE",desc:window.t("NSE — National Stock Exchange of India"),flag:"india",group:"Asia / Pacific",country:"in",providerId:""},{value:"MCX",name:"MCX",
desc:window.t("MCX — Multi Commodity Exchange"),flag:"india",group:"Asia / Pacific",country:"in",providerId:""},{value:"KCBT",name:"KCBT",desc:window.t("KCBT Futures"),flag:"usa",hideInSymbolSearch:!0,group:"North America",country:"us",providerId:""},{value:"OKCOIN",name:"OKCoin",desc:window.t("OKCoin"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"okcoin"},{value:"CBOT_MINI",name:"CBOT E-mini",desc:window.t("CBOT E-mini — Chicago Board of Trade"),flag:"usa",group:"North America",hideInSymbolSearch:!0,country:"us",providerId:""},{value:"KRAKEN",name:"Kraken",desc:window.t("Kraken"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"kraken"},{value:"KUCOIN",name:"KuCoin",desc:window.t("KuCoin"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"kucoin"},{value:"CME_MINI",name:"CME E-mini",desc:window.t("CME GLOBEX E-mini — Chicago Mercantile Exchange Globex"),flag:"usa",group:"North America",hideInSymbolSearch:!0,country:"us",providerId:""},{value:"DJ",name:"DJ",desc:window.t("DJ — Dow Jones Indexes"),flag:"usa",hideInSymbolSearch:!0,group:"North America",country:"us",providerId:""},{value:"SP",name:"SP",desc:window.t("SP — S&P Indexes"),flag:"usa",hideInSymbolSearch:!0,group:"North America",country:"us",providerId:""},{value:"BTCCHINA",name:"BTC China",desc:window.t("BTC China"),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"HUOBI",name:"Huobi",desc:window.t("Huobi"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"huobi"},{value:"KORBIT",name:"Korbit",desc:window.t("Korbit"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"korbit"},{value:"THEROCKTRADING",name:"The Rock Trading",desc:window.t("The Rock Trading"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"therocktrading"},{value:"TIMEX",name:"TimeX",desc:window.t("TimeX"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"timex"},{value:"ANX",name:"ANX",desc:window.t("ANX"),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"MEXBT",name:"meXBT",desc:window.t("meXBT"),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"FTX",name:"FTX",desc:window.t("FTX"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"ftx"},{value:"GEMINI",name:"Gemini",desc:window.t("Gemini"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"gemini"},{value:"BITVC",name:"BitVC",desc:window.t("BitVC"),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"BITYES",name:"BitYes",desc:window.t("BitYes"),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"BNC",name:"BNC",desc:window.t("BNC"),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"BITFLYER",name:"bitFlyer",desc:window.t("bitFlyer"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitflyer"},{value:"BYBIT",name:"Bybit",desc:window.t("Bybit"),flag:"bitcoin",
group:"Cryptocurrency",country:"",providerId:"bybit"},{value:"BITMEX",name:"BitMEX",desc:window.t("BitMEX"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitmex"},{value:"BITPANDAPRO",name:"Bitpanda Pro",desc:window.t("Bitpanda Pro"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitpanda"},{value:"CAPITALCOM",name:"Capital.com",desc:window.t("Capital.com"),flag:"forex",group:"Forex",country:"",providerId:"capitalcom"},{value:"COINEX",name:"CoinEx",desc:window.t("CoinEx"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"coinex"},{value:"EXMO",name:"EXMO",desc:window.t("EXMO"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"exmo2"},{value:"EASYMARKETS",name:"easyMarkets",desc:window.t("easyMarkets"),flag:"forex",group:"Forex",country:"",providerId:"easymarkets"},{value:"FOREXCOM",name:"FOREX.com",desc:window.t("FOREX.com"),flag:"forex",group:"Forex",country:"",providerId:"gain"},{value:"FX_IDC",name:"ICE",desc:window.t("ICE Data Services"),flag:"forex",group:"Forex",country:"",providerId:"ice"},{value:"GLOBALPRIME",name:"GLOBALPRIME",desc:window.t("Global Prime"),flag:"forex",group:"Forex",country:"",providerId:"globalprime"},{value:"IBROKER",name:"iBroker",desc:window.t("iBroker"),flag:"forex",group:"Forex",country:"",providerId:"ibroker"},{value:"CEXIO",name:"CEX.IO",desc:window.t("CEX.IO"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"cexio"},{value:"BITSO",name:"Bitso",desc:window.t("Bitso"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitso"},{value:"BITFINEX",name:"Bitfinex",desc:window.t("Bitfinex"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitfinex"},{value:"MTGOX",name:"Mt.Gox",desc:window.t("Mt.Gox"),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:"mtgox"},{value:"PHEMEX",name:"Phemex",desc:window.t("Phemex"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"phemex"},{value:"POLONIEX",name:"Poloniex",desc:window.t("Poloniex"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"poloniex"},{value:"SUSHISWAP",name:"SushiSwap",desc:window.t("SushiSwap"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"sushiswap"},{value:"TRADERJOE",name:"Trader Joe",desc:window.t("Trader Joe"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"traderjoe"},{value:"TRADESTATION",name:"TradeStation",desc:window.t("TradeStation"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"tradestation"},{value:"UNISWAP",name:"Uniswap",desc:window.t("Uniswap"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"uniswap"},{value:"UPBIT",name:"UpBit",desc:window.t("UpBit"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"upbit"},{value:"BINGX",name:"BingX",desc:window.t("BingX"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bingx"},{value:"BTSE",name:"BTSE",desc:window.t("BTSE"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"btse"},{value:"BITCOKE",name:"BitCoke",desc:window.t("BitCoke"),flag:"bitcoin",
group:"Cryptocurrency",country:"",providerId:"bitcoke"},{value:"BITTREX",name:"Bittrex",desc:window.t("Bittrex"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bittrex"},{value:"BINANCE",name:"Binance",desc:window.t("Binance"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"binance"},{value:"BITGET",name:"Bitget",desc:window.t("Bitget"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitget"},{value:"BINANCEUS",name:"Binance US",desc:window.t("Binance US"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"binance"},{value:"DELTA",name:"Delta",desc:window.t("Delta"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"delta"},{value:"BCBA",name:"BYMA",desc:window.t("BYMA — Argentine Stock Exchanges and Markets"),flag:"argentina",group:"Mexico and South America",country:"ar",providerId:""},{value:"MATBAROFEX",name:"ROFEX",desc:window.t("ROFEX — MATBA ROFEX"),flag:"argentina",group:"Mexico and South America",country:"ar",providerId:""},{value:"BMFBOVESPA",name:"B3",desc:window.t("B3 — Brasil Bolsa Balcao S.A."),flag:"brasil",group:"Mexico and South America",country:"br",providerId:""},{value:"BMV",name:"BMV",desc:window.t("BMV — Mexican Stock Exchange"),flag:"mexico",group:"Mexico and South America",country:"mx",providerId:""},{value:"BVL",name:"BVL",desc:window.t("BVL — Bolsa de Valores de Lima"),flag:"peru",group:"Mexico and South America",country:"pe",providerId:""},{value:"BCS",name:"SSE",desc:window.t("SSE — Santiago Stock Exchange"),flag:"chile",group:"Mexico and South America",country:"cl",providerId:""},{value:"BVC",name:"BVC",desc:window.t("BVC — Bolsa de Valores de Colombia"),flag:"colombia",group:"Mexico and South America",country:"co",providerId:""},{value:"NAG",name:"NSE",desc:window.t("NSE — Nagoya Stock Exchange"),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:""},{value:"TSE",name:"TSE",desc:window.t("TSE — Tokyo Stock Exchange"),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:""},{value:"TFEX",name:"TFEX",desc:window.t("TFEX — Thailand Futures Exchange"),flag:"thailand",group:"Asia / Pacific",country:"th",providerId:""},{value:"TFX",name:"TFX",desc:window.t("TFX — Tokyo Financial Exchange"),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:""},{value:"TOCOM",name:"TOCOM",desc:window.t("TOCOM — Tokyo Commodity Exchange"),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:""},{value:"OSE",name:"OSE",desc:window.t("OSE — Osaka Exchange"),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:""},{value:"SGX",name:"SGX",desc:window.t("SGX — Singapore Stock Exchange"),flag:"singapore",group:"Asia / Pacific",country:"sg",providerId:""},{value:"ICESG",name:"ICE Futures Singapore",desc:window.t("ICE Futures Singapore"),flag:"singapore",group:"Asia / Pacific",country:"sg",providerId:""},{value:"SAPSE",name:"SSE",desc:window.t("SSE — Sapporo Securities Exchange"),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:""},{value:"FSE",name:"FSE",desc:window.t("FSE — Fukuoka Stock Exchange"),
flag:"japan",group:"Asia / Pacific",country:"jp",providerId:""},{value:"TPEX",name:"TPEx",desc:window.t("TPEx — Taipei Exchange"),flag:"taiwan",group:"Asia / Pacific",country:"tw",providerId:""},{value:"TWSE",name:"TWSE",desc:window.t("TWSE — Taiwan Stock Exchange"),flag:"taiwan",group:"Asia / Pacific",country:"tw",providerId:""},{value:"SET",name:"SET",desc:window.t("SET — Stock Exchange of Thailand"),flag:"thailand",group:"Asia / Pacific",country:"th",providerId:""},{value:"KRX",name:"KRX",desc:window.t("KRX — Korea Stock Exchange"),flag:"south_korea",group:"Asia / Pacific",country:"kr",providerId:""},{value:"BAHRAIN",name:"BSE",desc:window.t("BSE — Bahrain Stock Exchange"),flag:"bahrain",group:"Middle East / Africa",country:"bh",providerId:""},{value:"ATHEX",name:"ATHEX",desc:window.t("ATHEX — Athens Stock Exchange"),flag:"greece",group:"Europe",country:"gr",providerId:""},{value:"BELEX",name:"BELEX",desc:window.t("BELEX — Belgrade Stock Exchange"),flag:"serbia",group:"Europe",country:"rs",providerId:""},{value:"EGX",name:"EGX",desc:window.t("EGX — Egyptian Exchange"),flag:"egypt",group:"Middle East / Africa",country:"eg",providerId:""},{value:"TADAWUL",name:"Tadawul",desc:window.t("Tadawul — Saudi Stock Exchange"),flag:"saudi_arabia",group:"Middle East / Africa",country:"sa",providerId:""},{value:"IDX",name:"IDX",desc:window.t("IDX — Indonesia Stock Exchange"),flag:"indonesia",group:"Asia / Pacific",country:"id",providerId:""},{value:"HSI",name:"HSI",desc:window.t("HSI — Hang Seng Indices"),flag:"hong_kong",group:"Asia / Pacific",country:"hk",providerId:""},{value:"QSE",name:"QSE",desc:window.t("QSE — Qatar Stock Exchange"),flag:"qatar",group:"Middle East / Africa",country:"qa",providerId:""},{value:"OANDA",name:"OANDA",desc:window.t("OANDA"),flag:"forex",group:"Forex",country:"",providerId:"oanda"},{value:"SAXO",name:"Saxo",desc:window.t("Saxo"),flag:"forex",group:"Forex",country:"",providerId:"saxobank"},{value:"PEPPERSTONE",name:"Pepperstone",desc:window.t("Pepperstone"),flag:"forex",group:"Forex",country:"",providerId:"pepperstone"},{value:"SKILLING",name:"SKILLING",desc:window.t("SKILLING"),flag:"forex",group:"Forex",country:"",providerId:"skilling"},{value:"EURONEXT",name:"Euronext",desc:window.t("Euronext — Euronext NV"),flag:"europe",group:"Europe",country:"eu",providerId:""},{value:"EURONEXTAMS",name:"EURONEXTAMS",desc:window.t("Euronext — Euronext Amsterdam"),flag:"netherlands",group:"Europe",country:"nl",providerId:""},{value:"EURONEXTBRU",name:"EURONEXTBRU",desc:window.t("Euronext — Euronext Brussels"),flag:"belgium",group:"Europe",country:"be",providerId:""},{value:"EURONEXTLIS",name:"EURONEXTLIS",desc:window.t("Euronext — Euronext Lisbon"),flag:"portugal",group:"Europe",country:"pt",providerId:""},{value:"EURONEXTPAR",name:"EURONEXTPAR",desc:window.t("Euronext — Euronext Paris"),flag:"france",group:"Europe",country:"fr",providerId:""},{value:"OSL",name:"EURONEXTOSE",desc:window.t("Euronext — Euronext Oslo"),flag:"norway",group:"Europe",country:"no",providerId:""},{value:"OMX",name:"OMX",
desc:window.t("OMX — Nasdaq OMX Group"),flag:"europe",group:"Europe",country:"eu",providerId:""},{value:"FWB",name:"FWB",desc:window.t("FWB — Frankfurt Stock Exchange"),flag:"germany",group:"Europe",country:"de",providerId:""},{value:"FRA",name:"FRA",desc:window.t("FRA — Frankfurt Stock Exchange"),flag:"germany",hideInSymbolSearch:!0,group:"Europe",country:"de",providerId:""},{value:"SWB",name:"SWB",desc:window.t("SWB — Stuttgart Stock Exchange"),flag:"germany",group:"Europe",country:"de",providerId:""},{value:"XETR",name:"XETR",desc:window.t("XETR — Xetra"),flag:"germany",group:"Europe",country:"de",providerId:""},{value:"BME",name:"BME",desc:window.t("BME — Bolsa de Madrid"),flag:"spain",group:"Europe",country:"es",providerId:""},{value:"GPW",name:"GPW",desc:window.t("GPW — Warsaw Stock Exchange"),flag:"poland",group:"Europe",country:"pl",providerId:""},{value:"NEWCONNECT",name:"GPW — NewConnect",desc:window.t(" GPW — NewConnect"),flag:"poland",group:"Europe",country:"pl"},{value:"LUXSE",name:"LUXSE",desc:window.t("LuxSE — Luxembourg Stock Exchange"),flag:"luxembourg",group:"Europe",country:"lu",providerId:""},{value:"MIL",name:"MIL",desc:window.t("MIL — Milan Stock Exchange"),flag:"italy",group:"Europe",country:"it",providerId:""},{value:"NGM",name:"NGM",desc:window.t("NGM — Nordic Growth Market"),flag:"sweden",group:"Europe",country:"se",providerId:""},{value:"BER",name:"BER",desc:window.t("BER — Berlin Stock Exchange"),flag:"germany",group:"Europe",country:"de",providerId:""},{value:"DUS",name:"DUS",desc:window.t("DUS — Dusseldorf Stock Exchange"),flag:"germany",group:"Europe",country:"de",providerId:""},{value:"HAM",name:"HAM",desc:window.t("HAM — Hamburg Stock Exchange"),flag:"germany",group:"Europe",country:"de",providerId:""},{value:"HAN",name:"HAN",desc:window.t("HAN — Hanover Stock Exchange"),flag:"germany",group:"Europe",country:"de",providerId:""},{value:"MUN",name:"MUN",desc:window.t("MUN — Munich Stock Exchange"),flag:"germany",group:"Europe",country:"de",providerId:""},{value:"MILSEDEX",name:"MILSEDEX",desc:window.t("MILSEDEX — Milan Stock Exchange"),flag:"italy",group:"Europe",hideInSymbolSearch:!0,country:"it",providerId:""},{value:"IST",name:"IST",desc:window.t("IST — Istanbul Stock Exchange"),flag:"turkey",hideInSymbolSearch:!0,group:"Europe",country:"tr",providerId:""},{value:"BIST",name:"BIST",desc:window.t("BIST — Borsa Istanbul"),flag:"turkey",group:"Europe",country:"tr",providerId:""},{value:"TASE",name:"TASE",desc:window.t("TASE — Tel Aviv Stock Exchange"),flag:"israel",group:"Middle East / Africa",country:"il",providerId:""},{value:"SIX",name:"SIX",desc:window.t("SIX — Swiss Stock Exchange"),flag:"switzerland",hideInSymbolSearch:!0,group:"Europe",country:"ch",providerId:""},{value:"SIX",name:"SIX",desc:window.t("SIX — SIX Swiss Exchange"),flag:"switzerland",group:"Europe",country:"ch",providerId:""},{value:"ASX",name:"ASX",desc:window.t("ASX — Australian Securities Exchange"),flag:"australia",group:"Asia / Pacific",country:"au",providerId:""},{value:"CHIXAU",name:"Chi-X",
desc:window.t("Chi-X Australia"),flag:"australia",group:"Asia / Pacific",country:"au",providerId:""},{value:"NZX",name:"NZX",desc:window.t("NZX — New Zealand Stock Exchange"),flag:"new_zealand",group:"Asia / Pacific",country:"nz",providerId:""},{value:"SSE",name:"SSE",desc:window.t("SSE — Shanghai Stock Exchange"),flag:"china",group:"Asia / Pacific",country:"cn",providerId:""},{value:"SZSE",name:"SZSE",desc:window.t("SZSE — Shenzhen Stock Exchange"),flag:"china",group:"Asia / Pacific",country:"cn",providerId:""},{value:"HKEX",name:"HKEX",desc:window.t("HKEX — Hong Kong Exchange"),flag:"hong_kong",group:"Asia / Pacific",country:"hk",providerId:""},{value:"PSE",name:"PSE",desc:window.t("PSE — Philippine Stock Exchange"),flag:"philippines",group:"Asia / Pacific",country:"ph",providerId:""},{value:"NSENG",name:"NSE",desc:window.t("NSE — Nigerian Stock Exchange"),flag:"nigeria",group:"Middle East / Africa",country:"ng",providerId:""},{value:"JSE",name:"JSE",desc:window.t("JSE — Johannesburg Stock Exchange"),flag:"south_africa",group:"Middle East / Africa",country:"za",providerId:""},{value:"COINBASE",name:"Coinbase",desc:window.t("Coinbase"),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"coinbase"},{value:"USI",name:"USI",desc:window.t("USI"),flag:"usa",hideInSymbolSearch:!0,group:"North America",country:"us",providerId:""},{value:"OMXHEX",name:"HEX",desc:window.t("HEX — Nasdaq Helsinki"),flag:"finland",group:"Europe",country:"fi",providerId:""},{value:"OMXICE",name:"ICEX",desc:window.t("ICEX — Nasdaq Iceland"),flag:"iceland",group:"Europe",country:"is",providerId:""},{value:"OMXCOP",name:"CSE",desc:window.t("CSE — Nasdaq Copenhagen"),flag:"denmark",group:"Europe",country:"dk",providerId:""},{value:"OMXSTO",name:"STO",desc:window.t("STO — Nasdaq Stockholm"),flag:"sweden",group:"Europe",country:"se",providerId:""},{value:"OMXVSE",name:"VSE",desc:window.t("VSE — Nasdaq Vilnius"),flag:"lithuania",group:"Europe",country:"lt",providerId:""},{value:"OMXTSE",name:"TALSE",desc:window.t("TALSE — Nasdaq Tallinn"),flag:"estonia",group:"Europe",country:"ee",providerId:""},{value:"OMXRSE",name:"OMXR",desc:window.t("OMXR — Nasdaq Riga"),flag:"latvia",group:"Europe",country:"lv",providerId:""},{value:"OMXNORDIC",name:"OMXNORDIC",desc:window.t("OMXNORDIC"),flag:"europe",hideInSymbolSearch:!0,group:"Europe",country:"eu",providerId:""},{value:"OMXBALTIC",name:"OMXBALTIC",desc:window.t("OMXBALTIC"),flag:"europe",hideInSymbolSearch:!0,group:"Europe",country:"eu",providerId:""},{value:"FRED",name:"FRED",desc:window.t("Federal reserve economic data"),flag:"usa",group:"Economy",country:"",providerId:"fred2"},{value:"FRKC",name:"FRKC",desc:window.t("Federal reserve bank of Kansas City"),flag:"usa",group:"Economy",country:"",providerId:"quandl"},{value:"ISM",name:"ISM",desc:window.t("Institute of supply management"),flag:"usa",group:"Economy",country:"",providerId:"quandl"},{value:"FRBNY",name:"FRBNY",desc:window.t("Federal reserve bank of New York"),flag:"usa",group:"Economy",country:"",providerId:"quandl"},{value:"FRBP",
name:"FRBP",desc:window.t("Federal reserve bank of Philadelphia"),flag:"usa",group:"Economy",country:"",providerId:"quandl"},{value:"ECONOMICS",name:"TRADING ECONOMICS",desc:window.t("World economic data"),flag:"usa",group:"Economy",country:"",providerId:"economics"}]},36254:e=>{e.exports=[{name:window.t("All"),value:""},{name:window.t("Stock"),value:"stock"},{name:window.t("Futures"),value:"futures"},{name:window.t("Forex"),value:"forex"},{name:window.t("CFD"),value:"cfd"},{name:window.t("Crypto"),value:"bitcoin,crypto"},{name:window.t("Index"),value:"index"},{name:window.t("Bond"),value:"bond"},{name:window.t("Economy"),value:"economic"}]},72316:(e,t,i)=>{var r,s,n;n="object"==typeof self&&self.self==self&&self||"object"==typeof i.g&&i.g.global==i.g&&i.g,r=[i(13469),i(18184),t],void 0===(s=function(e,t,i){n.Backbone=function(e,t,i,r){var s=e.Backbone,n=[].slice;t.VERSION="1.2.1",t.$=r,t.noConflict=function(){return e.Backbone=s,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=function(e,t,r){i.each(t,(function(t,s){i[s]&&(e.prototype[s]=function(e,t,r){switch(e){case 1:return function(){return i[t](this[r])};case 2:return function(e){return i[t](this[r],e)};case 3:return function(e,s){return i[t](this[r],e,s)};case 4:return function(e,s,n){return i[t](this[r],e,s,n)};default:return function(){var e=n.call(arguments);return e.unshift(this[r]),i[t].apply(i,e)}}}(t,s,r))}))},a=t.Events={},l=/\s+/,c=function(e,t,r,s,n){var o,a=0;if(r&&"object"==typeof r){void 0!==s&&"context"in n&&void 0===n.context&&(n.context=s);for(o=i.keys(r);a<o.length;a++)t=e(t,o[a],r[o[a]],n)}else if(r&&l.test(r))for(o=r.split(l);a<o.length;a++)t=e(t,o[a],s,n);else t=e(t,r,s,n);return t};a.on=function(e,t,i){return u(this,e,t,i)};var u=function(e,t,i,r,s){return e._events=c(d,e._events||{},t,i,{context:r,ctx:e,listening:s}),s&&((e._listeners||(e._listeners={}))[s.id]=s),e};a.listenTo=function(e,t,r){if(!e)return this;var s=e._listenId||(e._listenId=i.uniqueId("l")),n=this._listeningTo||(this._listeningTo={}),o=n[s];if(!o){var a=this._listenId||(this._listenId=i.uniqueId("l"));o=n[s]={obj:e,objId:s,id:a,listeningTo:n,count:0}}return u(e,t,r,this,o),this};var d=function(e,t,i,r){if(i){var s=e[t]||(e[t]=[]),n=r.context,o=r.ctx,a=r.listening;a&&a.count++,s.push({callback:i,context:n,ctx:n||o,listening:a})}return e};a.off=function(e,t,i){return this._events?(this._events=c(h,this._events,e,t,{context:i,listeners:this._listeners}),this):this},a.stopListening=function(e,t,r){var s=this._listeningTo;if(!s)return this;for(var n=e?[e._listenId]:i.keys(s),o=0;o<n.length;o++){var a=s[n[o]];if(!a)break;a.obj.off(t,r,this)}return i.isEmpty(s)&&(this._listeningTo=void 0),this};var h=function(e,t,r,s){if(e){var n,o=0,a=s.context,l=s.listeners;if(t||r||a){for(var c=t?[t]:i.keys(e);o<c.length;o++){var u=e[t=c[o]];if(!u)break;for(var d=[],h=0;h<u.length;h++){var p=u[h];r&&r!==p.callback&&r!==p.callback._callback||a&&a!==p.context?d.push(p):(n=p.listening)&&0==--n.count&&(delete l[n.id],delete n.listeningTo[n.objId])}d.length?e[t]=d:delete e[t]}
return i.size(e)?e:void 0}for(var _=i.keys(l);o<_.length;o++)delete l[(n=l[_[o]]).id],delete n.listeningTo[n.objId]}};a.once=function(e,t,r){var s=c(p,{},e,t,i.bind(this.off,this));return this.on(s,void 0,r)},a.listenToOnce=function(e,t,r){var s=c(p,{},t,r,i.bind(this.stopListening,this,e));return this.listenTo(e,s)};var p=function(e,t,r,s){if(r){var n=e[t]=i.once((function(){s(t,n),r.apply(this,arguments)}));n._callback=r}return e};a.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),i=Array(t),r=0;r<t;r++)i[r]=arguments[r+1];return c(_,this._events,e,void 0,i),this};var _=function(e,t,i,r){if(e){var s=e[t],n=e.all;s&&n&&(n=n.slice()),s&&m(s,r),n&&m(n,[t].concat(r))}return e},m=function(e,t){var i,r=-1,s=e.length,n=t[0],o=t[1],a=t[2];switch(t.length){case 0:for(;++r<s;)(i=e[r]).callback.call(i.ctx);return;case 1:for(;++r<s;)(i=e[r]).callback.call(i.ctx,n);return;case 2:for(;++r<s;)(i=e[r]).callback.call(i.ctx,n,o);return;case 3:for(;++r<s;)(i=e[r]).callback.call(i.ctx,n,o,a);return;default:for(;++r<s;)(i=e[r]).callback.apply(i.ctx,t);return}};a.bind=a.on,a.unbind=a.off,i.extend(t,a);var f=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=i.defaults({},r,i.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(f.prototype,a,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!i.iteratee(e,this)(this.attributes)},set:function(e,t,r){if(null==e)return this;var s;if("object"==typeof e?(s=e,r=t):(s={})[e]=t,r||(r={}),!this._validate(s,r))return!1;var n=r.unset,o=r.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,d=this._previousAttributes;for(var h in this.idAttribute in s&&(this.id=s[this.idAttribute]),s)t=s[h],i.isEqual(c[h],t)||a.push(h),i.isEqual(d[h],t)?delete u[h]:u[h]=t,n?delete c[h]:c[h]=t;if(!o){a.length&&(this._pending=r);for(var p=0;p<a.length;p++)this.trigger("change:"+a[p],this,c[a[p]],r)}if(l)return this;if(!o)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&i.clone(this.changed);var t=this._changing?this._previousAttributes:this.attributes,r={};for(var s in e){var n=e[s]
;i.isEqual(t[s],n)||(r[s]=n)}return!!i.size(r)&&r},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=i.extend({parse:!0},e);var t=this,r=e.success;return e.success=function(i){var s=e.parse?t.parse(i,e):i;if(!t.set(s,e))return!1;r&&r.call(e.context,t,i,e),t.trigger("sync",t,i,e)},R(this,e),this.sync("read",this,e)},save:function(e,t,r){var s;null==e||"object"==typeof e?(s=e,r=t):(s={})[e]=t;var n=(r=i.extend({validate:!0,parse:!0},r)).wait;if(s&&!n){if(!this.set(s,r))return!1}else if(!this._validate(s,r))return!1;var o=this,a=r.success,l=this.attributes;r.success=function(e){o.attributes=l;var t=r.parse?o.parse(e,r):e;if(n&&(t=i.extend({},s,t)),t&&!o.set(t,r))return!1;a&&a.call(r.context,o,e,r),o.trigger("sync",o,e,r)},R(this,r),s&&n&&(this.attributes=i.extend({},l,s));var c=this.isNew()?"create":r.patch?"patch":"update";"patch"!==c||r.attrs||(r.attrs=s);var u=this.sync(c,this,r);return this.attributes=l,u},destroy:function(e){e=e?i.clone(e):{};var t=this,r=e.success,s=e.wait,n=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(i){s&&n(),r&&r.call(e.context,t,i,e),t.isNew()||t.trigger("sync",t,i,e)};var o=!1;return this.isNew()?i.defer(e.success):(R(this,e),o=this.sync("delete",this,e)),s||n(),o},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||D();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.defaults({validate:!0},e))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return!r||(this.trigger("invalid",this,r,i.extend(t,{validationError:r})),!1)}}),o(f,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var g=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},v={add:!0,remove:!0,merge:!0},S={add:!0,remove:!1};i.extend(g.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,S))},remove:function(e,t){t=i.extend({},t);var r=!i.isArray(e);e=r?[e]:i.clone(e);var s=this._removeModels(e,t);return!t.silent&&s&&this.trigger("update",this,t),r?s[0]:s},set:function(e,t){(t=i.defaults({},t,v)).parse&&!this._isModel(e)&&(e=this.parse(e,t));var r,s,n,o,a,l=!i.isArray(e);e=l?e?[e]:[]:e.slice();var c=t.at;null!=c&&(c=+c),c<0&&(c+=this.length+1)
;for(var u=this.comparator&&null==c&&!1!==t.sort,d=i.isString(this.comparator)?this.comparator:null,h=[],p=[],_={},m=t.add,f=t.merge,g=t.remove,S=!(u||!m||!g)&&[],y=!1,b=0;b<e.length;b++){if(n=e[b],o=this.get(n))g&&(_[o.cid]=!0),f&&n!==o&&(n=this._isModel(n)?n.attributes:n,t.parse&&(n=o.parse(n,t)),o.set(n,t),u&&!a&&o.hasChanged(d)&&(a=!0)),e[b]=o;else if(m){if(!(s=e[b]=this._prepareModel(n,t)))continue;h.push(s),this._addReference(s,t)}(s=o||s)&&(r=this.modelId(s.attributes),!S||!s.isNew()&&_[r]||(S.push(s),y=y||!this.models[b]||s.cid!==this.models[b].cid),_[r]=!0)}if(g){for(b=0;b<this.length;b++)_[(s=this.models[b]).cid]||p.push(s);p.length&&this._removeModels(p,t)}if(h.length||y)if(u&&(a=!0),this.length+=h.length,null!=c)for(b=0;b<h.length;b++)this.models.splice(c+b,0,h[b]);else{S&&(this.models.length=0);var w=S||h;for(b=0;b<w.length;b++)this.models.push(w[b])}if(a&&this.sort({silent:!0}),!t.silent){var P=null!=c?i.clone(t):t;for(b=0;b<h.length;b++)null!=c&&(P.index=c+b),(s=h[b]).trigger("add",s,this,P);(a||y)&&this.trigger("sort",this,t),(h.length||p.length)&&this.trigger("update",this,t)}return l?e[0]:e},reset:function(e,t){t=t?i.clone(t):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return n.apply(this.models,arguments)},get:function(e){if(null!=e){var t=this.modelId(this._isModel(e)?e.attributes:e);return this._byId[e]||this._byId[t]||this._byId[e.cid]}},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){var r=i.matches(e);return this[t?"find":"filter"]((function(e){return r(e.attributes)}))},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){var t=(e=i.extend({parse:!0},e)).success,r=this;return e.success=function(i){var s=e.reset?"reset":"set";r[s](i,e),t&&t.call(e.context,r,i,e),r.trigger("sync",r,i,e)},R(this,e),this.sync("read",this,e)},create:function(e,t){var r=(t=t?i.clone(t):{}).wait;if(!(e=this._prepareModel(e,t)))return!1;r||this.add(e,t);var s=this,n=t.success;return t.success=function(e,t,i){r&&s.add(e,i),n&&n.call(i.context,e,t,i)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){
this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;(t=t?i.clone(t):{}).collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_removeModels:function(e,t){for(var i=[],r=0;r<e.length;r++){var s=this.get(e[r]);if(s){var n=this.indexOf(s);this.models.splice(n,1),this.length--,t.silent||(t.index=n,s.trigger("remove",s,this,t)),i.push(s),this._removeReference(s,t)}}return!!i.length&&i},_isModel:function(e){return e instanceof f},_addReference:function(e,t){this._byId[e.cid]=e;var i=this.modelId(e.attributes);null!=i&&(this._byId[i]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var i=this.modelId(e.attributes);null!=i&&delete this._byId[i],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,r){if("add"!==e&&"remove"!==e||i===this){if("destroy"===e&&this.remove(t,r),"change"===e){var s=this.modelId(t.previousAttributes()),n=this.modelId(t.attributes);s!==n&&(null!=s&&delete this._byId[s],null!=n&&(this._byId[n]=t))}this.trigger.apply(this,arguments)}}}),o(g,{forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:2,contains:2,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3},"models"),i.each(["groupBy","countBy","sortBy","indexBy"],(function(e){i[e]&&(g.prototype[e]=function(t,r){var s=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,s,r)})}));var y=t.View=function(e){this.cid=i.uniqueId("view"),i.extend(this,i.pick(e,w)),this._ensureElement(),this.initialize.apply(this,arguments)},b=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];i.extend(y.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=i.result(this,"events")),!e)return this;for(var t in this.undelegateEvents(),e){var r=e[t];if(i.isFunction(r)||(r=this[r]),r){var s=t.match(b);this.delegate(s[1],s[2],i.bind(r,this))}}return this},delegate:function(e,t,i){return this.$el.on(e+".delegateEvents"+this.cid,t,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,i){return this.$el.off(e+".delegateEvents"+this.cid,t,i),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){
if(this.el)this.setElement(i.result(this,"el"));else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,r,s){var n=P[e];i.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:n,dataType:"json"};if(s.url||(o.url=i.result(r,"url")||D()),null!=s.data||!r||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(s.attrs||r.toJSON(s))),s.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),s.emulateHTTP&&("PUT"===n||"DELETE"===n||"PATCH"===n)){o.type="POST",s.emulateJSON&&(o.data._method=n);var a=s.beforeSend;s.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",n),a)return a.apply(this,arguments)}}"GET"===o.type||s.emulateJSON||(o.processData=!1);var l=s.error;s.error=function(e,t,i){s.textStatus=t,s.errorThrown=i,l&&l.call(s.context,e,t,i)};var c=s.xhr=t.ajax(i.extend(o,s));return r.trigger("request",r,c,s),c};var P={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,x=/(\(\?)?:\w+/g,I=/\*\w+/g,L=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(C.prototype,a,{initialize:function(){},route:function(e,r,s){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(r)&&(s=r,r=""),s||(s=this[r]);var n=this;return t.history.route(e,(function(i){var o=n._extractParameters(e,i);!1!==n.execute(s,o,r)&&(n.trigger.apply(n,["route:"+r].concat(o)),n.trigger("route",r,o),t.history.trigger("route",n,r,o))})),this},execute:function(e,t,i){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(L,"\\$&").replace(T,"(?:$1)?").replace(x,(function(e,t){return t?e:"([^/?]+)"})).replace(I,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return i.map(r,(function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null}))}});var M=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},E=/^[#\/]|\s+$/g,A=/^\/+|\/+$/g,k=/#.*$/;M.started=!1,i.extend(M.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){
var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(E,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");if(M.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window,this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(A,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var r=document.body,s=r.insertBefore(this.iframe,r.firstChild).contentWindow;s.document.open(),s.document.close(),s.location.hash="#"+this.fragment}var n=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?n("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?n("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),i.any(this.handlers,(function(t){if(t.route.test(e))return t.callback(e),!0})))},navigate:function(e,t){if(!M.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");var i=this.root;""!==e&&"?"!==e.charAt(0)||(i=i.slice(0,-1)||"/");var r=i+e;if(e=this.decodeFragment(e.replace(k,"")),this.fragment!==e){if(this.fragment=e,
this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var s=this.iframe.contentWindow;t.replace||(s.document.open(),s.document.close()),this._updateHash(s.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new M,f.extend=g.extend=C.extend=y.extend=M.extend=function(e,t){var r,s=this;r=e&&i.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},i.extend(r,s,t);var n=function(){this.constructor=r};return n.prototype=s.prototype,r.prototype=new n,e&&i.extend(r.prototype,e),r.__super__=s.prototype,r};var D=function(){throw new Error('A "url" property or function must be specified')},R=function(e,t){var i=t.error;t.error=function(r){i&&i.call(t.context,e,r,t),e.trigger("error",e,r,t)}};return t}(n,i,e,t)}.apply(t,r))||(e.exports=s)},93302:function(e,t,i){var r;!function(s){"use strict";var n,o="[big.js] ",a=o+"Invalid ",l=a+"decimal places",c={},u=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function d(e,t,i,r){var s=e.c,n=e.e+t+1;if(n<s.length){if(1===i)r=s[n]>=5;else if(2===i)r=s[n]>5||5==s[n]&&(r||n<0||void 0!==s[n+1]||1&s[n-1]);else if(3===i)r=r||!!s[0];else if(r=!1,0!==i)throw Error("[big.js] Invalid rounding mode");if(n<1)s.length=1,r?(e.e=-t,s[0]=1):s[0]=e.e=0;else{if(s.length=n--,r)for(;++s[n]>9;)s[n]=0,n--||(++e.e,s.unshift(1));for(n=s.length;!s[--n];)s.pop()}}else if(i<0||i>3||i!==~~i)throw Error("[big.js] Invalid rounding mode");return e}function h(e,t,i,r){var s,n,o=e.constructor,c=!e.c[0];if(void 0!==i){if(i!==~~i||i<(3==t)||i>1e6)throw Error(3==t?a+"precision":l);for(i=r-(e=new o(e)).e,e.c.length>++r&&d(e,i,o.RM),2==t&&(r=e.e+i+1);e.c.length<r;)e.c.push(0)}if(s=e.e,i=(n=e.c.join("")).length,2!=t&&(1==t||3==t&&r<=s||s<=o.NE||s>=o.PE))n=n.charAt(0)+(i>1?"."+n.slice(1):"")+(s<0?"e":"e+")+s;else if(s<0){for(;++s;)n="0"+n;n="0."+n}else if(s>0)if(++s>i)for(s-=i;s--;)n+="0";else s<i&&(n=n.slice(0,s)+"."+n.slice(s));else i>1&&(n=n.charAt(0)+"."+n.slice(1));return e.s<0&&(!c||4==t)?"-"+n:n}c.abs=function(){var e=new this.constructor(this);return e.s=1,e},c.cmp=function(e){var t,i=this,r=i.c,s=(e=new i.constructor(e)).c,n=i.s,o=e.s,a=i.e,l=e.e;if(!r[0]||!s[0])return r[0]?n:s[0]?-o:0;if(n!=o)return n;if(t=n<0,a!=l)return a>l^t?1:-1;for(o=(a=r.length)<(l=s.length)?a:l,n=-1;++n<o;)if(r[n]!=s[n])return r[n]>s[n]^t?1:-1;return a==l?0:a>l^t?1:-1},c.div=function(e){var t=this,i=t.constructor,r=t.c,s=(e=new i(e)).c,n=t.s==e.s?1:-1,o=i.DP;if(o!==~~o||o<0||o>1e6)throw Error(l);if(!s[0])throw Error("[big.js] Division by zero");if(!r[0])return new i(0*n);var a,c,u,h,p,_=s.slice(),m=a=s.length,f=r.length,g=r.slice(0,a),v=g.length,S=e,y=S.c=[],b=0,w=o+(S.e=t.e-e.e)+1;for(S.s=n,n=w<0?0:w,_.unshift(0);v++<a;)g.push(0);do{for(u=0;u<10;u++){
if(a!=(v=g.length))h=a>v?1:-1;else for(p=-1,h=0;++p<a;)if(s[p]!=g[p]){h=s[p]>g[p]?1:-1;break}if(!(h<0))break;for(c=v==a?s:_;v;){if(g[--v]<c[v]){for(p=v;p&&!g[--p];)g[p]=9;--g[p],g[v]+=10}g[v]-=c[v]}for(;!g[0];)g.shift()}y[b++]=h?u:++u,g[0]&&h?g[v]=r[m]||0:g=[r[m]]}while((m++<f||void 0!==g[0])&&n--);return y[0]||1==b||(y.shift(),S.e--),b>w&&d(S,o,i.RM,void 0!==g[0]),S},c.eq=function(e){return!this.cmp(e)},c.gt=function(e){return this.cmp(e)>0},c.gte=function(e){return this.cmp(e)>-1},c.lt=function(e){return this.cmp(e)<0},c.lte=function(e){return this.cmp(e)<1},c.minus=c.sub=function(e){var t,i,r,s,n=this,o=n.constructor,a=n.s,l=(e=new o(e)).s;if(a!=l)return e.s=-l,n.plus(e);var c=n.c.slice(),u=n.e,d=e.c,h=e.e;if(!c[0]||!d[0])return d[0]?(e.s=-l,e):new o(c[0]?n:0);if(a=u-h){for((s=a<0)?(a=-a,r=c):(h=u,r=d),r.reverse(),l=a;l--;)r.push(0);r.reverse()}else for(i=((s=c.length<d.length)?c:d).length,a=l=0;l<i;l++)if(c[l]!=d[l]){s=c[l]<d[l];break}if(s&&(r=c,c=d,d=r,e.s=-e.s),(l=(i=d.length)-(t=c.length))>0)for(;l--;)c[t++]=0;for(l=t;i>a;){if(c[--i]<d[i]){for(t=i;t&&!c[--t];)c[t]=9;--c[t],c[i]+=10}c[i]-=d[i]}for(;0===c[--l];)c.pop();for(;0===c[0];)c.shift(),--h;return c[0]||(e.s=1,c=[h=0]),e.c=c,e.e=h,e},c.mod=function(e){var t,i=this,r=i.constructor,s=i.s,n=(e=new r(e)).s;if(!e.c[0])throw Error("[big.js] Division by zero");return i.s=e.s=1,t=1==e.cmp(i),i.s=s,e.s=n,t?new r(i):(s=r.DP,n=r.RM,r.DP=r.RM=0,i=i.div(e),r.DP=s,r.RM=n,this.minus(i.times(e)))},c.plus=c.add=function(e){var t,i=this,r=i.constructor,s=i.s,n=(e=new r(e)).s;if(s!=n)return e.s=-n,i.minus(e);var o=i.e,a=i.c,l=e.e,c=e.c;if(!a[0]||!c[0])return c[0]?e:new r(a[0]?i:0*s);if(a=a.slice(),s=o-l){for(s>0?(l=o,t=c):(s=-s,t=a),t.reverse();s--;)t.push(0);t.reverse()}for(a.length-c.length<0&&(t=c,c=a,a=t),s=c.length,n=0;s;a[s]%=10)n=(a[--s]=a[s]+c[s]+n)/10|0;for(n&&(a.unshift(n),++l),s=a.length;0===a[--s];)a.pop();return e.c=a,e.e=l,e},c.pow=function(e){var t=this,i=new t.constructor(1),r=i,s=e<0;if(e!==~~e||e<-1e6||e>1e6)throw Error(a+"exponent");for(s&&(e=-e);1&e&&(r=r.times(t)),e>>=1;)t=t.times(t);return s?i.div(r):r},c.round=function(e,t){var i=this.constructor;if(void 0===e)e=0;else if(e!==~~e||e<-1e6||e>1e6)throw Error(l);return d(new i(this),e,void 0===t?i.RM:t)},c.sqrt=function(){var e,t,i,r=this,s=r.constructor,n=r.s,a=r.e,l=new s(.5);if(!r.c[0])return new s(r);if(n<0)throw Error(o+"No square root");0===(n=Math.sqrt(r+""))||n===1/0?((t=r.c.join("")).length+a&1||(t+="0"),a=((a+1)/2|0)-(a<0||1&a),e=new s(((n=Math.sqrt(t))==1/0?"1e":(n=n.toExponential()).slice(0,n.indexOf("e")+1))+a)):e=new s(n),a=e.e+(s.DP+=4);do{i=e,e=l.times(i.plus(r.div(i)))}while(i.c.slice(0,a).join("")!==e.c.slice(0,a).join(""));return d(e,s.DP-=4,s.RM)},c.times=c.mul=function(e){var t,i=this,r=i.constructor,s=i.c,n=(e=new r(e)).c,o=s.length,a=n.length,l=i.e,c=e.e;if(e.s=i.s==e.s?1:-1,!s[0]||!n[0])return new r(0*e.s);for(e.e=l+c,o<a&&(t=s,s=n,n=t,c=o,o=a,a=c),t=new Array(c=o+a);c--;)t[c]=0;for(l=a;l--;){for(a=0,c=o+l;c>l;)a=t[c]+n[l]*s[c-l-1]+a,t[c--]=a%10,a=a/10|0;t[c]=(t[c]+a)%10}
for(a?++e.e:t.shift(),l=t.length;!t[--l];)t.pop();return e.c=t,e},c.toExponential=function(e){return h(this,1,e,e)},c.toFixed=function(e){return h(this,2,e,this.e+e)},c.toPrecision=function(e){return h(this,3,e,e-1)},c.toString=function(){return h(this)},c.valueOf=c.toJSON=function(){return h(this,4)},(n=function e(){function t(i){var r=this;if(!(r instanceof t))return void 0===i?e():new t(i);i instanceof t?(r.s=i.s,r.e=i.e,r.c=i.c.slice()):function(e,t){var i,r,s;if(0===t&&1/t<0)t="-0";else if(!u.test(t+=""))throw Error(a+"number");e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(i=t.indexOf("."))>-1&&(t=t.replace(".",""));(r=t.search(/e/i))>0?(i<0&&(i=r),i+=+t.slice(r+1),t=t.substring(0,r)):i<0&&(i=t.length);for(s=t.length,r=0;r<s&&"0"==t.charAt(r);)++r;if(r==s)e.c=[e.e=0];else{for(;s>0&&"0"==t.charAt(--s););for(e.e=i-r-1,e.c=[],i=0;r<=s;)e.c[i++]=+t.charAt(r++)}}(r,i),r.constructor=t}return t.prototype=c,t.DP=20,t.RM=1,t.NE=-7,t.PE=21,t.version="5.2.2",t}()).default=n.Big=n,void 0===(r=function(){return n}.call(t,i,t,e))||(e.exports=r)}()},94184:(e,t)=>{var i;!function(){"use strict";var r={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var i=arguments[t];if(i){var n=typeof i;if("string"===n||"number"===n)e.push(i);else if(Array.isArray(i)&&i.length){var o=s.apply(null,i);o&&e.push(o)}else if("object"===n)for(var a in i)r.call(i,a)&&i[a]&&e.push(a)}}return e.join(" ")}e.exports?(s.default=s,e.exports=s):void 0===(i=function(){return s}.apply(t,[]))||(e.exports=i)}()},15365:()=>{!function(){var e,t,i,r,s=window.jQuery,n=s(window),o=s(document),a="http://www.w3.org/2000/svg",l="SVGAngle"in window&&((i=document.createElement("div")).innerHTML="<svg/>",t=(i.firstChild&&i.firstChild.namespaceURI)==a,i.innerHTML="",t),c="transition"in(r=document.createElement("div").style)||"WebkitTransition"in r||"MozTransition"in r||"msTransition"in r||"OTransition"in r,u="ontouchstart"in window,d="mousedown"+(u?" touchstart":""),h="mousemove.clockpicker"+(u?" touchmove.clockpicker":""),p="mouseup.clockpicker"+(u?" touchend.clockpicker":""),_=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null;function m(e){return document.createElementNS(a,e)}function f(e){return(e<10?"0":"")+e}var g=0;var v=c?350:1,S=['<div class="popover clockpicker-popover">','<div class="arrow"></div>','<div class="popover-title">','<span class="clockpicker-span-hours text-primary"></span>'," : ",'<span class="clockpicker-span-minutes"></span>','<span class="clockpicker-span-am-pm"></span>',"</div>",'<div class="popover-content">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>",'<span class="clockpicker-am-pm-block">',"</span>","</div>","</div>"].join("");function y(t,i){
var r,n,a=s(S),c=a.find(".clockpicker-plate"),u=a.find(".clockpicker-hours"),_=a.find(".clockpicker-minutes"),y=a.find(".clockpicker-am-pm-block"),w="INPUT"===t.prop("tagName"),P=w?t:t.find("input"),C=t.find(".input-group-addon"),T=this;if(this.id=(n=++g+"",(r="cp")?r+n:n),this.element=t,this.options=i,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=w,this.input=P,this.addon=C,this.popover=a,this.plate=c,this.hoursView=u,this.minutesView=_,this.amPmBlock=y,this.spanHours=a.find(".clockpicker-span-hours"),this.spanMinutes=a.find(".clockpicker-span-minutes"),this.spanAmPm=a.find(".clockpicker-span-am-pm"),this.amOrPm="PM",i.twelvehour){var x=['<div class="clockpicker-am-pm-block">','<button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-am-button">',"AM</button>",'<button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-pm-button">',"PM</button>","</div>"].join("");s(x);s('<button type="button" class="btn btn-sm btn-default clockpicker-button am-button">AM</button>').on("click",(function(){T.amOrPm="AM",s(".clockpicker-span-am-pm").empty().append("AM")})).appendTo(this.amPmBlock),s('<button type="button" class="btn btn-sm btn-default clockpicker-button pm-button">PM</button>').on("click",(function(){T.amOrPm="PM",s(".clockpicker-span-am-pm").empty().append("PM")})).appendTo(this.amPmBlock)}i.autoclose||s('<button type="button" class="btn btn-sm btn-default btn-block clockpicker-button">'+i.donetext+"</button>").click(s.proxy(this.done,this)).appendTo(a),"top"!==i.placement&&"bottom"!==i.placement||"top"!==i.align&&"bottom"!==i.align||(i.align="left"),"left"!==i.placement&&"right"!==i.placement||"left"!==i.align&&"right"!==i.align||(i.align="top"),a.addClass(i.placement),a.addClass("clockpicker-align-"+i.align),this.spanHours.click(s.proxy(this.toggleView,this,"hours")),this.spanMinutes.click(s.proxy(this.toggleView,this,"minutes")),P.on("focus.clockpicker click.clockpicker",s.proxy(this.show,this)),C.on("click.clockpicker",s.proxy(this.toggle,this));var I,L,M,E,A=s('<div class="clockpicker-tick"></div>');if(i.twelvehour)for(I=1;I<13;I+=1)L=A.clone(),M=I/6*Math.PI,E=80,L.css("font-size","120%"),L.css({left:100+Math.sin(M)*E-13,top:100-Math.cos(M)*E-13}),L.html(0===I?"00":I),u.append(L),L.on(d,D);else for(I=0;I<24;I+=1){L=A.clone(),M=I/6*Math.PI;var k=I>0&&I<13;E=k?54:80,L.css({left:100+Math.sin(M)*E-13,top:100-Math.cos(M)*E-13}),k&&L.css("font-size","120%"),L.html(0===I?"00":I),u.append(L),L.on(d,D)}for(I=0;I<60;I+=5)L=A.clone(),M=I/30*Math.PI,L.css({left:100+80*Math.sin(M)-13,top:100-80*Math.cos(M)-13}),L.css("font-size","120%"),L.html(f(I)),_.append(L),L.on(d,D);function D(t,r){var s=c.offset(),n=/^touch/.test(t.type),a=s.left+100,u=s.top+100,d=(n?t.originalEvent.touches[0]:t).pageX-a,_=(n?t.originalEvent.touches[0]:t).pageY-u,m=Math.sqrt(d*d+_*_),f=!1;if(!r||!(m<67||m>93)){t.preventDefault();var g=setTimeout((function(){e.addClass("clockpicker-moving")}),200);l&&c.append(T.canvas),T.setHand(d,_,!r,!0),o.off(h).on(h,(function(e){
e.preventDefault();var t=/^touch/.test(e.type),i=(t?e.originalEvent.touches[0]:e).pageX-a,r=(t?e.originalEvent.touches[0]:e).pageY-u;(f||i!==d||r!==_)&&(f=!0,T.setHand(i,r,!1,!0))})),o.off(p).on(p,(function(t){o.off(p),t.preventDefault();var s=/^touch/.test(t.type),n=(s?t.originalEvent.changedTouches[0]:t).pageX-a,l=(s?t.originalEvent.changedTouches[0]:t).pageY-u;(r||f)&&n===d&&l===_&&T.setHand(n,l),"hours"===T.currentView?T.toggleView("minutes",v/2):i.autoclose&&(T.minutesView.addClass("clockpicker-dial-out"),setTimeout((function(){T.done()}),v/2)),c.prepend(R),clearTimeout(g),e.removeClass("clockpicker-moving"),o.off(h)}))}}if(c.on(d,(function(e){0===s(e.target).closest(".clockpicker-tick").length&&D(e,!0)})),l){var R=a.find(".clockpicker-canvas"),N=m("svg");N.setAttribute("class","clockpicker-svg"),N.setAttribute("width",200),N.setAttribute("height",200);var O=m("g");O.setAttribute("transform","translate(100,100)");var V=m("circle");V.setAttribute("class","clockpicker-canvas-bearing"),V.setAttribute("cx",0),V.setAttribute("cy",0),V.setAttribute("r",2);var B=m("line");B.setAttribute("x1",0),B.setAttribute("y1",0);var F=m("circle");F.setAttribute("class","clockpicker-canvas-bg"),F.setAttribute("r",13);var W=m("circle");W.setAttribute("class","clockpicker-canvas-fg"),W.setAttribute("r",3.5),O.appendChild(B),O.appendChild(F),O.appendChild(W),O.appendChild(V),N.appendChild(O),R.append(N),this.hand=B,this.bg=F,this.fg=W,this.bearing=V,this.g=O,this.canvas=R}b(this.options.init)}function b(e){e&&"function"==typeof e&&e()}y.DEFAULTS={default:"",fromnow:0,placement:"bottom",align:"left",donetext:"完成",autoclose:!1,twelvehour:!1,vibrate:!0},y.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},y.prototype.locate=function(){var e=this.element,t=this.popover,i=e.offset(),r=e.outerWidth(),s=e.outerHeight(),n=this.options.placement,o=this.options.align,a={};switch(t.show(),n){case"bottom":a.top=i.top+s;break;case"right":a.left=i.left+r;break;case"top":a.top=i.top-t.outerHeight();break;case"left":a.left=i.left-t.outerWidth()}switch(o){case"left":a.left=i.left;break;case"right":a.left=i.left+r-t.outerWidth();break;case"top":a.top=i.top;break;case"bottom":a.top=i.top+s-t.outerHeight()}t.css(a)},y.prototype.show=function(t){if(!this.isShown){b(this.options.beforeShow);var i=this;this.isAppended||(e=s(document.body).append(this.popover),n.on("resize.clockpicker"+this.id,(function(){i.isShown&&i.locate()})),this.isAppended=!0);var r=((this.input.prop("value")||this.options.default||"")+"").split(":");if("now"===r[0]){var a=new Date(+new Date+this.options.fromnow);r=[a.getHours(),a.getMinutes()]}this.hours=+r[0]||0,this.minutes=+r[1]||0,this.spanHours.html(f(this.hours)),this.spanMinutes.html(f(this.minutes)),this.toggleView("hours"),this.locate(),this.isShown=!0,o.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,(function(e){var t=s(e.target);0===t.closest(i.popover).length&&0===t.closest(i.addon).length&&0===t.closest(i.input).length&&i.hide()})),o.on("keyup.clockpicker."+this.id,(function(e){
27===e.keyCode&&i.hide()})),b(this.options.afterShow)}},y.prototype.hide=function(){b(this.options.beforeHide),this.isShown=!1,o.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),o.off("keyup.clockpicker."+this.id),this.popover.hide(),b(this.options.afterHide)},y.prototype.toggleView=function(e,t){var i=!1;"minutes"===e&&"visible"===s(this.hoursView).css("visibility")&&(b(this.options.beforeHourSelect),i=!0);var r="hours"===e,n=r?this.hoursView:this.minutesView,o=r?this.minutesView:this.hoursView;this.currentView=e,this.spanHours.toggleClass("text-primary",r),this.spanMinutes.toggleClass("text-primary",!r),o.addClass("clockpicker-dial-out"),n.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(t),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout((function(){o.css("visibility","hidden")}),v),i&&b(this.options.afterHourSelect)},y.prototype.resetClock=function(e){var t=this.currentView,i=this[t],r="hours"===t,s=i*(Math.PI/(r?6:30)),n=r&&i>0&&i<13?54:80,o=Math.sin(s)*n,a=-Math.cos(s)*n,c=this;l&&e?(c.canvas.addClass("clockpicker-canvas-out"),setTimeout((function(){c.canvas.removeClass("clockpicker-canvas-out"),c.setHand(o,a)}),e)):this.setHand(o,a)},y.prototype.setHand=function(e,t,i,r){var n,o=Math.atan2(e,-t),a="hours"===this.currentView,c=Math.PI/(a||i?6:30),u=Math.sqrt(e*e+t*t),d=this.options,h=a&&u<67,p=h?54:80;if(d.twelvehour&&(p=80),o<0&&(o=2*Math.PI+o),o=(n=Math.round(o/c))*c,d.twelvehour?a?0===n&&(n=12):(i&&(n*=5),60===n&&(n=0)):a?(12===n&&(n=0),n=h?0===n?12:n:0===n?0:n+12):(i&&(n*=5),60===n&&(n=0)),this[this.currentView]!==n&&_&&this.options.vibrate&&(this.vibrateTimer||(navigator[_](10),this.vibrateTimer=setTimeout(s.proxy((function(){this.vibrateTimer=null}),this),100))),this[this.currentView]=n,this[a?"spanHours":"spanMinutes"].html(f(n)),l){r||!a&&n%5?(this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")):(this.g.insertBefore(this.hand,this.bg),this.g.insertBefore(this.fg,this.bg),this.bg.setAttribute("class","clockpicker-canvas-bg"));var m=Math.sin(o)*p,g=-Math.cos(o)*p;this.hand.setAttribute("x2",m),this.hand.setAttribute("y2",g),this.bg.setAttribute("cx",m),this.bg.setAttribute("cy",g),this.fg.setAttribute("cx",m),this.fg.setAttribute("cy",g)}else this[a?"hoursView":"minutesView"].find(".clockpicker-tick").each((function(){var e=s(this);e.toggleClass("active",n===+e.html())}))},y.prototype.done=function(){b(this.options.beforeDone),this.hide();var e=this.input.prop("value"),t=f(this.hours)+":"+f(this.minutes);this.options.twelvehour&&(t+=this.amOrPm),this.input.prop("value",t),t!==e&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change")),this.options.autoclose&&this.input.trigger("blur"),b(this.options.afterDone)},y.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.addon.off("click.clockpicker"),this.isShown&&this.hide(),
this.isAppended&&(n.off("resize.clockpicker"+this.id),this.popover.remove())},s.fn.clockpicker=function(e){var t=Array.prototype.slice.call(arguments,1);return this.each((function(){var i=s(this),r=i.data("clockpicker");if(r)"function"==typeof r[e]&&r[e].apply(r,t);else{var n=s.extend({},y.DEFAULTS,i.data(),"object"==typeof e&&e);i.data("clockpicker",new y(i,n))}}))}}()},62378:e=>{"use strict";e.exports=function(e){for(var t=[],i=e.length,r=0;r<i;r++){var s=e.charCodeAt(r);if(s>=55296&&s<=56319&&i>r+1){var n=e.charCodeAt(r+1);n>=56320&&n<=57343&&(s=1024*(s-55296)+n-56320+65536,r+=1)}s<128?t.push(s):s<2048?(t.push(s>>6|192),t.push(63&s|128)):s<55296||s>=57344&&s<65536?(t.push(s>>12|224),t.push(s>>6&63|128),t.push(63&s|128)):s>=65536&&s<=1114111?(t.push(s>>18|240),t.push(s>>12&63|128),t.push(s>>6&63|128),t.push(63&s|128)):t.push(239,191,189)}return new Uint8Array(t).buffer}},68545:(e,t,i)=>{"use strict";i.d(t,{bindToDevicePixelRatio:()=>s});var r={allowDownsampling:!0};function s(e,t){return void 0===t&&(t=r),new n(e,t)}var n=function(){function e(e,t){var i=this;this._resolutionMediaQueryList=null,this._resolutionListener=function(e){return i._onResolutionChanged()},this._canvasConfiguredListeners=[],this.canvas=e,this._canvasSize={width:this.canvas.clientWidth,height:this.canvas.clientHeight},this._options=t,this._configureCanvas(),this._installResolutionListener()}return e.prototype.destroy=function(){this._canvasConfiguredListeners.length=0,this._uninstallResolutionListener(),this.canvas=null},Object.defineProperty(e.prototype,"canvasSize",{get:function(){return{width:this._canvasSize.width,height:this._canvasSize.height}},enumerable:!0,configurable:!0}),e.prototype.resizeCanvas=function(e){this._canvasSize={width:e.width,height:e.height},this._configureCanvas()},Object.defineProperty(e.prototype,"pixelRatio",{get:function(){var e=this.canvas.ownerDocument.defaultView;if(null==e)throw new Error("No window is associated with the canvas");return e.devicePixelRatio>1||this._options.allowDownsampling?e.devicePixelRatio:1},enumerable:!0,configurable:!0}),e.prototype.subscribeCanvasConfigured=function(e){this._canvasConfiguredListeners.push(e)},e.prototype.unsubscribeCanvasConfigured=function(e){this._canvasConfiguredListeners=this._canvasConfiguredListeners.filter((function(t){return t!=e}))},e.prototype._configureCanvas=function(){var e=this.pixelRatio;this.canvas.style.width=this._canvasSize.width+"px",this.canvas.style.height=this._canvasSize.height+"px",this.canvas.width=this._canvasSize.width*e,this.canvas.height=this._canvasSize.height*e,this._emitCanvasConfigured()},e.prototype._emitCanvasConfigured=function(){var e=this;this._canvasConfiguredListeners.forEach((function(t){return t.call(e)}))},e.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw new Error("Resolution listener is already installed");var e=this.canvas.ownerDocument.defaultView;if(null==e)throw new Error("No window is associated with the canvas");var t=e.devicePixelRatio
;this._resolutionMediaQueryList=e.matchMedia("all and (resolution: "+t+"dppx)"),this._resolutionMediaQueryList.addListener(this._resolutionListener)},e.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},e.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},e.prototype._onResolutionChanged=function(){this._configureCanvas(),this._reinstallResolutionListener()},e}()},48994:(e,t,i)=>{var r=i(55375);e.exports=function(e){return e=r(e^=e>>>16,2246822507),e=r(e^=e>>>13,3266489909),(e^=e>>>16)>>>0}},55375:e=>{"use strict";e.exports=Math.imul||function(e,t){var i=65535&e,r=65535&t;return i*r+((e>>>16&65535)*r+i*(t>>>16&65535)<<16>>>0)|0}},36912:(e,t,i)=>{var r,s;void 0===(s="function"==typeof(r=["jquery","./data","./disable-selection","./focusable","./form","./ie","./keycode","./labels","./jquery-1-7","./plugin","./safe-active-element","./safe-blur","./scroll-parent","./tabbable","./unique-id","./version"])?r.call(t,i,t,e):r)||(e.exports=s)},63762:(e,t,i)=>{var r,s,n;s=[i(18184),i(85592)],void 0===(n="function"==typeof(r=function(e){var t,i=e;return e.effects={effect:{}},function(e,t){var i,r=/^([\-+])=\s*(\d+\.?\d*)/,s=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],n=e.Color=function(t,i,r,s){return new e.Color.fn.parse(t,i,r,s)},o={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},a={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},l=n.support={},c=e("<p>")[0],u=e.each;function d(e,t,i){var r=a[t.type]||{};return null==e?i||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function h(t){var r=n(),a=r._rgba=[];return t=t.toLowerCase(),u(s,(function(e,i){var s,n=i.re.exec(t),l=n&&i.parse(n),c=i.space||"rgba";if(l)return s=r[c](l),r[o[c].cache]=s[o[c].cache],a=r._rgba=s._rgba,!1})),a.length?("0,0,0,0"===a.join()&&e.extend(a,i.transparent),r):i[t]}function p(e,t,i){return 6*(i=(i+1)%1)<1?e+(t-e)*i*6:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}c.style.cssText="background-color:rgba(1,1,1,.5)",
l.rgba=c.style.backgroundColor.indexOf("rgba")>-1,u(o,(function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}})),n.fn=e.extend(n.prototype,{parse:function(t,r,s,a){if(void 0===t)return this._rgba=[null,null,null,null],this;(t.jquery||t.nodeType)&&(t=e(t).css(r),r=void 0);var l=this,c=e.type(t),p=this._rgba=[];return void 0!==r&&(t=[t,r,s,a],c="array"),"string"===c?this.parse(h(t)||i._default):"array"===c?(u(o.rgba.props,(function(e,i){p[i.idx]=d(t[i.idx],i)})),this):"object"===c?(u(o,t instanceof n?function(e,i){t[i.cache]&&(l[i.cache]=t[i.cache].slice())}:function(i,r){var s=r.cache;u(r.props,(function(e,i){if(!l[s]&&r.to){if("alpha"===e||null==t[e])return;l[s]=r.to(l._rgba)}l[s][i.idx]=d(t[e],i,!0)})),l[s]&&e.inArray(null,l[s].slice(0,3))<0&&(l[s][3]=1,r.from&&(l._rgba=r.from(l[s])))}),this):void 0},is:function(e){var t=n(e),i=!0,r=this;return u(o,(function(e,s){var n,o=t[s.cache];return o&&(n=r[s.cache]||s.to&&s.to(r._rgba)||[],u(s.props,(function(e,t){if(null!=o[t.idx])return i=o[t.idx]===n[t.idx]}))),i})),i},_space:function(){var e=[],t=this;return u(o,(function(i,r){t[r.cache]&&e.push(i)})),e.pop()},transition:function(e,t){var i=n(e),r=i._space(),s=o[r],l=0===this.alpha()?n("transparent"):this,c=l[s.cache]||s.to(l._rgba),h=c.slice();return i=i[s.cache],u(s.props,(function(e,r){var s=r.idx,n=c[s],o=i[s],l=a[r.type]||{};null!==o&&(null===n?h[s]=o:(l.mod&&(o-n>l.mod/2?n+=l.mod:n-o>l.mod/2&&(n-=l.mod)),h[s]=d((o-n)*t+n,r)))})),this[r](h)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),r=i.pop(),s=n(t)._rgba;return n(e.map(i,(function(e,t){return(1-r)*s[t]+r*e})))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,(function(e,t){return null==e?t>2?1:0:e}));return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),(function(e,t){return null==e&&(e=t>2?1:0),t&&t<3&&(e=Math.round(100*e)+"%"),e}));return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),r=i.pop();return t&&i.push(~~(255*r)),"#"+e.map(i,(function(e){return 1===(e=(e||0).toString(16)).length?"0"+e:e})).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),n.fn.parse.prototype=n.fn,o.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,r=e[0]/255,s=e[1]/255,n=e[2]/255,o=e[3],a=Math.max(r,s,n),l=Math.min(r,s,n),c=a-l,u=a+l,d=.5*u;return t=l===a?0:r===a?60*(s-n)/c+360:s===a?60*(n-r)/c+120:60*(r-s)/c+240,i=0===c?0:d<=.5?c/u:c/(2-u),[Math.round(t)%360,i,d,null==o?1:o]},o.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],r=e[2],s=e[3],n=r<=.5?r*(1+i):r+i-r*i,o=2*r-n;return[Math.round(255*p(o,n,t+1/3)),Math.round(255*p(o,n,t)),Math.round(255*p(o,n,t-1/3)),s]},u(o,(function(t,i){var s=i.props,o=i.cache,a=i.to,l=i.from;n.fn[t]=function(t){if(a&&!this[o]&&(this[o]=a(this._rgba)),void 0===t)return this[o].slice()
;var i,r=e.type(t),c="array"===r||"object"===r?t:arguments,h=this[o].slice();return u(s,(function(e,t){var i=c["object"===r?e:t.idx];null==i&&(i=h[t.idx]),h[t.idx]=d(i,t)})),l?((i=n(l(h)))[o]=h,i):n(h)},u(s,(function(i,s){n.fn[i]||(n.fn[i]=function(n){var o,a=e.type(n),l="alpha"===i?this._hsla?"hsla":"rgba":t,c=this[l](),u=c[s.idx];return"undefined"===a?u:("function"===a&&(n=n.call(this,u),a=e.type(n)),null==n&&s.empty?this:("string"===a&&(o=r.exec(n))&&(n=u+parseFloat(o[2])*("+"===o[1]?1:-1)),c[s.idx]=n,this[l](c)))})}))})),n.hook=function(t){var i=t.split(" ");u(i,(function(t,i){e.cssHooks[i]={set:function(t,r){var s,o,a="";if("transparent"!==r&&("string"!==e.type(r)||(s=h(r)))){if(r=n(s||r),!l.rgba&&1!==r._rgba[3]){for(o="backgroundColor"===i?t.parentNode:t;(""===a||"transparent"===a)&&o&&o.style;)try{a=e.css(o,"backgroundColor"),o=o.parentNode}catch(e){}r=r.blend(a&&"transparent"!==a?a:"_default")}r=r.toRgbaString()}try{t.style[i]=r}catch(e){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=n(t.elem,i),t.end=n(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}}))},n.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),e.cssHooks.borderColor={expand:function(e){var t={};return u(["Top","Right","Bottom","Left"],(function(i,r){t["border"+r+"Color"]=e})),t}},i=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(i),function(){var t,r=["add","remove","toggle"],s={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function n(t){var i,r,s=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,n={};if(s&&s.length&&s[0]&&s[s[0]])for(r=s.length;r--;)"string"==typeof s[i=s[r]]&&(n[e.camelCase(i)]=s[i]);else for(i in s)"string"==typeof s[i]&&(n[i]=s[i]);return n}e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],(function(t,r){e.fx.step[r]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(i.style(e.elem,r,e.end),e.setAttr=!0)}})),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(t,i,o,a){var l=e.speed(i,o,a);return this.queue((function(){var i,o=e(this),a=o.attr("class")||"",c=l.children?o.find("*").addBack():o;c=c.map((function(){return{el:e(this),start:n(this)}})),(i=function(){e.each(r,(function(e,i){t[i]&&o[i+"Class"](t[i])}))})(),c=c.map((function(){return this.end=n(this.el[0]),this.diff=function(t,i){var r,n,o={};for(r in i)n=i[r],t[r]!==n&&(s[r]||!e.fx.step[r]&&isNaN(parseFloat(n))||(o[r]=n));return o}(this.start,this.end),this})),o.attr("class",a),c=c.map((function(){
var t=this,i=e.Deferred(),r=e.extend({},l,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,r),i.promise()})),e.when.apply(e,c.get()).done((function(){i(),e.each(arguments,(function(){var t=this.el;e.each(this.diff,(function(e){t.css(e,"")}))})),l.complete.call(o[0])}))}))},e.fn.extend({addClass:(t=e.fn.addClass,function(i,r,s,n){return r?e.effects.animateClass.call(this,{add:i},r,s,n):t.apply(this,arguments)}),removeClass:function(t){return function(i,r,s,n){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},r,s,n):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(i,r,s,n,o){return"boolean"==typeof r||void 0===r?s?e.effects.animateClass.call(this,r?{add:i}:{remove:i},s,n,o):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:i},r,s,n)}}(e.fn.toggleClass),switchClass:function(t,i,r,s,n){return e.effects.animateClass.call(this,{add:i,remove:t},r,s,n)}})}(),function(){var t;function i(t,i,r,s){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(s=i,r=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(s=r,r=i,i={}),e.isFunction(r)&&(s=r,r=null),i&&e.extend(t,i),r=r||i.duration,t.duration=e.fx.off?0:"number"==typeof r?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,t.complete=s||i.complete,t}function r(t){return!(t&&"number"!=typeof t&&!e.fx.speeds[t])||"string"==typeof t&&!e.effects.effect[t]||!!e.isFunction(t)||"object"==typeof t&&!t.effect}function s(e,t){var i=t.outerWidth(),r=t.outerHeight(),s=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/.exec(e)||["",0,i,r,0];return{top:parseFloat(s[1])||0,right:"auto"===s[2]?i:parseFloat(s[2]),bottom:"auto"===s[3]?r:parseFloat(s[3]),left:parseFloat(s[4])||0}}e.expr&&e.expr.filters&&e.expr.filters.animated&&(e.expr.filters.animated=(t=e.expr.filters.animated,function(i){return!!e(i).data("ui-effects-animated")||t(i)})),!1!==e.uiBackCompat&&e.extend(e.effects,{save:function(e,t){for(var i=0,r=t.length;i<r;i++)null!==t[i]&&e.data("ui-effects-"+t[i],e[0].style[t[i]])},restore:function(e,t){for(var i,r=0,s=t.length;r<s;r++)null!==t[r]&&(i=e.data("ui-effects-"+t[r]),e.css(t[r],i))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),float:t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),s={width:t.width(),height:t.height()},n=document.activeElement;try{n.id}catch(e){n=document.body}return t.wrap(r),(t[0]===n||e.contains(t[0],n))&&e(n).trigger("focus"),r=t.parent(),"static"===t.css("position")?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],(function(e,r){i[r]=t.css(r),
isNaN(parseInt(i[r],10))&&(i[r]="auto")})),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(s),r.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).trigger("focus")),t}}),e.extend(e.effects,{version:"1.12.1",define:function(t,i,r){return r||(r=i,i="effect"),e.effects.effect[t]=r,e.effects.effect[t].mode=i,r},scaledDimensions:function(e,t,i){if(0===t)return{height:0,width:0,outerHeight:0,outerWidth:0};var r="horizontal"!==i?(t||100)/100:1,s="vertical"!==i?(t||100)/100:1;return{height:e.height()*s,width:e.width()*r,outerHeight:e.outerHeight()*s,outerWidth:e.outerWidth()*r}},clipToBox:function(e){return{width:e.clip.right-e.clip.left,height:e.clip.bottom-e.clip.top,left:e.clip.left,top:e.clip.top}},unshift:function(e,t,i){var r=e.queue();t>1&&r.splice.apply(r,[1,0].concat(r.splice(t,i))),e.dequeue()},saveStyle:function(e){e.data("ui-effects-style",e[0].style.cssText)},restoreStyle:function(e){e[0].style.cssText=e.data("ui-effects-style")||"",e.removeData("ui-effects-style")},mode:function(e,t){var i=e.is(":hidden");return"toggle"===t&&(t=i?"show":"hide"),(i?"hide"===t:"show"===t)&&(t="none"),t},getBaseline:function(e,t){var i,r;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:i}},createPlaceholder:function(t){var i,r=t.css("position"),s=t.position();return t.css({marginTop:t.css("marginTop"),marginBottom:t.css("marginBottom"),marginLeft:t.css("marginLeft"),marginRight:t.css("marginRight")}).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()),/^(static|relative)/.test(r)&&(r="absolute",i=e("<"+t[0].nodeName+">").insertAfter(t).css({display:/^(inline|ruby)/.test(t.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:t.css("marginTop"),marginBottom:t.css("marginBottom"),marginLeft:t.css("marginLeft"),marginRight:t.css("marginRight"),float:t.css("float")}).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).addClass("ui-effects-placeholder"),t.data("ui-effects-placeholder",i)),t.css({position:r,left:s.left,top:s.top}),i},removePlaceholder:function(e){var t="ui-effects-placeholder",i=e.data(t);i&&(i.remove(),e.removeData(t))},cleanUp:function(t){e.effects.restoreStyle(t),e.effects.removePlaceholder(t)},setTransition:function(t,i,r,s){return s=s||{},e.each(i,(function(e,i){var n=t.cssUnit(i);n[0]>0&&(s[i]=n[0]*r+n[1])})),s}}),e.fn.extend({effect:function(){var t=i.apply(this,arguments),r=e.effects.effect[t.effect],s=r.mode,n=t.queue,o=n||"fx",a=t.complete,l=t.mode,c=[],u=function(t){var i=e(this),r=e.effects.mode(i,l)||s;i.data("ui-effects-animated",!0),c.push(r),s&&("show"===r||r===s&&"hide"===r)&&i.show(),s&&"none"===r||e.effects.saveStyle(i),e.isFunction(t)&&t()};if(e.fx.off||!r)return l?this[l](t.duration,a):this.each((function(){a&&a.call(this)}));function d(i){var n=e(this)
;function o(){e.isFunction(a)&&a.call(n[0]),e.isFunction(i)&&i()}t.mode=c.shift(),!1===e.uiBackCompat||s?"none"===t.mode?(n[l](),o()):r.call(n[0],t,(function(){n.removeData("ui-effects-animated"),e.effects.cleanUp(n),"hide"===t.mode&&n.hide(),o()})):(n.is(":hidden")?"hide"===l:"show"===l)?(n[l](),o()):r.call(n[0],t,o)}return!1===n?this.each(u).each(d):this.queue(o,u).queue(o,d)},show:function(e){return function(t){if(r(t))return e.apply(this,arguments);var s=i.apply(this,arguments);return s.mode="show",this.effect.call(this,s)}}(e.fn.show),hide:function(e){return function(t){if(r(t))return e.apply(this,arguments);var s=i.apply(this,arguments);return s.mode="hide",this.effect.call(this,s)}}(e.fn.hide),toggle:function(e){return function(t){if(r(t)||"boolean"==typeof t)return e.apply(this,arguments);var s=i.apply(this,arguments);return s.mode="toggle",this.effect.call(this,s)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),r=[];return e.each(["em","px","%","pt"],(function(e,t){i.indexOf(t)>0&&(r=[parseFloat(i),t])})),r},cssClip:function(e){return e?this.css("clip","rect("+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px)"):s(this.css("clip"),this)},transfer:function(t,i){var r=e(this),s=e(t.to),n="fixed"===s.css("position"),o=e("body"),a=n?o.scrollTop():0,l=n?o.scrollLeft():0,c=s.offset(),u={top:c.top-a,left:c.left-l,height:s.innerHeight(),width:s.innerWidth()},d=r.offset(),h=e("<div class='ui-effects-transfer'></div>").appendTo("body").addClass(t.className).css({top:d.top-a,left:d.left-l,height:r.innerHeight(),width:r.innerWidth(),position:n?"fixed":"absolute"}).animate(u,t.duration,t.easing,(function(){h.remove(),e.isFunction(i)&&i()}))}}),e.fx.step.clip=function(t){t.clipInit||(t.start=e(t.elem).cssClip(),"string"==typeof t.end&&(t.end=s(t.end,t.elem)),t.clipInit=!0),e(t.elem).cssClip({top:t.pos*(t.end.top-t.start.top)+t.start.top,right:t.pos*(t.end.right-t.start.right)+t.start.right,bottom:t.pos*(t.end.bottom-t.start.bottom)+t.start.bottom,left:t.pos*(t.end.left-t.start.left)+t.start.left})}}(),t={},e.each(["Quad","Cubic","Quart","Quint","Expo"],(function(e,i){t[i]=function(t){return Math.pow(t,e+2)}})),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;e<((t=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,(function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return e<.5?i(2*e)/2:1-i(-2*e+2)/2}})),e.effects})?r.apply(t,s):r)||(e.exports=n)},21870:(e,t,i)=>{var r,s,n;s=[i(18184),i(85592)],void 0===(n="function"==typeof(r=function(e){return e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase())})?r.apply(t,s):r)||(e.exports=n)},91822:(e,t,i)=>{var r,s,n;s=[i(18184),i(85592)],void 0===(n="function"==typeof(r=function(e){return function(){
var t,i=Math.max,r=Math.abs,s=/left|center|right/,n=/top|center|bottom/,o=/[\+\-]\d+(\.[\d]+)?%?/,a=/^\w+/,l=/%$/,c=e.fn.position;function u(e,t,i){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?i/100:1)]}function d(t,i){return parseInt(e.css(t,i),10)||0}function h(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.position={scrollbarWidth:function(){if(void 0!==t)return t;var i,r,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),n=s.children()[0];return e("body").append(s),i=n.offsetWidth,s.css("overflow","scroll"),i===(r=n.offsetWidth)&&(r=s[0].clientWidth),s.remove(),t=i-r},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),r=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),s="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth;return{width:"scroll"===r||"auto"===r&&t.height<t.element[0].scrollHeight?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),r=e.isWindow(i[0]),s=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:r,isDocument:s,offset:r||s?{left:0,top:0}:e(t).offset(),scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:i.outerWidth(),height:i.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);t=e.extend({},t);var l,p,_,m,f,g,v=e(t.of),S=e.position.getWithinInfo(t.within),y=e.position.getScrollInfo(S),b=(t.collision||"flip").split(" "),w={};return g=h(v),v[0].preventDefault&&(t.at="left top"),p=g.width,_=g.height,m=g.offset,f=e.extend({},m),e.each(["my","at"],(function(){var e,i,r=(t[this]||"").split(" ");1===r.length&&(r=s.test(r[0])?r.concat(["center"]):n.test(r[0])?["center"].concat(r):["center","center"]),r[0]=s.test(r[0])?r[0]:"center",r[1]=n.test(r[1])?r[1]:"center",e=o.exec(r[0]),i=o.exec(r[1]),w[this]=[e?e[0]:0,i?i[0]:0],t[this]=[a.exec(r[0])[0],a.exec(r[1])[0]]})),1===b.length&&(b[1]=b[0]),"right"===t.at[0]?f.left+=p:"center"===t.at[0]&&(f.left+=p/2),"bottom"===t.at[1]?f.top+=_:"center"===t.at[1]&&(f.top+=_/2),l=u(w.at,p,_),f.left+=l[0],f.top+=l[1],this.each((function(){var s,n,o=e(this),a=o.outerWidth(),c=o.outerHeight(),h=d(this,"marginLeft"),g=d(this,"marginTop"),P=a+h+d(this,"marginRight")+y.width,C=c+g+d(this,"marginBottom")+y.height,T=e.extend({},f),x=u(w.my,o.outerWidth(),o.outerHeight());"right"===t.my[0]?T.left-=a:"center"===t.my[0]&&(T.left-=a/2),"bottom"===t.my[1]?T.top-=c:"center"===t.my[1]&&(T.top-=c/2),T.left+=x[0],T.top+=x[1],s={marginLeft:h,marginTop:g},e.each(["left","top"],(function(i,r){e.ui.position[b[i]]&&e.ui.position[b[i]][r](T,{targetWidth:p,targetHeight:_,elemWidth:a,elemHeight:c,collisionPosition:s,collisionWidth:P,
collisionHeight:C,offset:[l[0]+x[0],l[1]+x[1]],my:t.my,at:t.at,within:S,elem:o})})),t.using&&(n=function(e){var s=m.left-T.left,n=s+p-a,l=m.top-T.top,u=l+_-c,d={target:{element:v,left:m.left,top:m.top,width:p,height:_},element:{element:o,left:T.left,top:T.top,width:a,height:c},horizontal:n<0?"left":s>0?"right":"center",vertical:u<0?"top":l>0?"bottom":"middle"};p<a&&r(s+n)<p&&(d.horizontal="center"),_<c&&r(l+u)<_&&(d.vertical="middle"),i(r(s),r(n))>i(r(l),r(u))?d.important="horizontal":d.important="vertical",t.using.call(this,e,d)}),o.offset(e.extend(T,{using:n}))}))},e.ui.position={fit:{left:function(e,t){var r,s=t.within,n=s.isWindow?s.scrollLeft:s.offset.left,o=s.width,a=e.left-t.collisionPosition.marginLeft,l=n-a,c=a+t.collisionWidth-o-n;t.collisionWidth>o?l>0&&c<=0?(r=e.left+l+t.collisionWidth-o-n,e.left+=l-r):e.left=c>0&&l<=0?n:l>c?n+o-t.collisionWidth:n:l>0?e.left+=l:c>0?e.left-=c:e.left=i(e.left-a,e.left)},top:function(e,t){var r,s=t.within,n=s.isWindow?s.scrollTop:s.offset.top,o=t.within.height,a=e.top-t.collisionPosition.marginTop,l=n-a,c=a+t.collisionHeight-o-n;t.collisionHeight>o?l>0&&c<=0?(r=e.top+l+t.collisionHeight-o-n,e.top+=l-r):e.top=c>0&&l<=0?n:l>c?n+o-t.collisionHeight:n:l>0?e.top+=l:c>0?e.top-=c:e.top=i(e.top-a,e.top)}},flip:{left:function(e,t){var i,s,n=t.within,o=n.offset.left+n.scrollLeft,a=n.width,l=n.isWindow?n.scrollLeft:n.offset.left,c=e.left-t.collisionPosition.marginLeft,u=c-l,d=c+t.collisionWidth-a-l,h="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,_=-2*t.offset[0];u<0?((i=e.left+h+p+_+t.collisionWidth-a-o)<0||i<r(u))&&(e.left+=h+p+_):d>0&&((s=e.left-t.collisionPosition.marginLeft+h+p+_-l)>0||r(s)<d)&&(e.left+=h+p+_)},top:function(e,t){var i,s,n=t.within,o=n.offset.top+n.scrollTop,a=n.height,l=n.isWindow?n.scrollTop:n.offset.top,c=e.top-t.collisionPosition.marginTop,u=c-l,d=c+t.collisionHeight-a-l,h="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,p="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,_=-2*t.offset[1];u<0?((s=e.top+h+p+_+t.collisionHeight-a-o)<0||s<r(u))&&(e.top+=h+p+_):d>0&&((i=e.top-t.collisionPosition.marginTop+h+p+_-l)>0||r(i)<d)&&(e.top+=h+p+_)}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}}}(),e.ui.position})?r.apply(t,s):r)||(e.exports=n)},85592:(e,t,i)=>{var r,s,n;s=[i(18184)],void 0===(n="function"==typeof(r=function(e){return e.ui=e.ui||{},e.ui.version="1.12.1"})?r.apply(t,s):r)||(e.exports=n)},26891:(e,t,i)=>{var r,s,n;s=[i(18184),i(85592)],void 0===(n="function"==typeof(r=function(e){var t,i=0,r=Array.prototype.slice;return e.cleanData=(t=e.cleanData,function(i){var r,s,n;for(n=0;null!=(s=i[n]);n++)try{(r=e._data(s,"events"))&&r.remove&&e(s).triggerHandler("remove")}catch(e){}t(i)}),e.widget=function(t,i,r){var s,n,o,a={},l=t.split(".")[0],c=l+"-"+(t=t.split(".")[1])
;return r||(r=i,i=e.Widget),e.isArray(r)&&(r=e.extend.apply(null,[{}].concat(r))),e.expr[":"][c.toLowerCase()]=function(t){return!!e.data(t,c)},e[l]=e[l]||{},s=e[l][t],n=e[l][t]=function(e,t){if(!this._createWidget)return new n(e,t);arguments.length&&this._createWidget(e,t)},e.extend(n,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),(o=new i).options=e.widget.extend({},o.options),e.each(r,(function(t,r){e.isFunction(r)?a[t]=function(){function e(){return i.prototype[t].apply(this,arguments)}function s(e){return i.prototype[t].apply(this,e)}return function(){var t,i=this._super,n=this._superApply;return this._super=e,this._superApply=s,t=r.apply(this,arguments),this._super=i,this._superApply=n,t}}():a[t]=r})),n.prototype=e.widget.extend(o,{widgetEventPrefix:s&&o.widgetEventPrefix||t},a,{constructor:n,namespace:l,widgetName:t,widgetFullName:c}),s?(e.each(s._childConstructors,(function(t,i){var r=i.prototype;e.widget(r.namespace+"."+r.widgetName,n,i._proto)})),delete s._childConstructors):i._childConstructors.push(n),e.widget.bridge(t,n),n},e.widget.extend=function(t){for(var i,s,n=r.call(arguments,1),o=0,a=n.length;o<a;o++)for(i in n[o])s=n[o][i],n[o].hasOwnProperty(i)&&void 0!==s&&(e.isPlainObject(s)?t[i]=e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):t[i]=s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(n){var o="string"==typeof n,a=r.call(arguments,1),l=this;return o?this.length||"instance"!==n?this.each((function(){var i,r=e.data(this,s);return"instance"===n?(l=r,!1):r?e.isFunction(r[n])&&"_"!==n.charAt(0)?(i=r[n].apply(r,a))!==r&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0:e.error("no such method '"+n+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+n+"'")})):l=void 0:(a.length&&(n=e.widget.extend.apply(null,[n].concat(a))),this.each((function(){var t=e.data(this,s);t?(t.option(n||{}),t._init&&t._init()):e.data(this,s,new i(n,this))}))),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),this.classesElementLookup={},r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){
var t=this;this._destroy(),e.each(this.classesElementLookup,(function(e,i){t._removeClass(i,e)})),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var r,s,n,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},r=t.split("."),t=r.shift(),r.length){for(s=o[t]=e.widget.extend({},this.options[t]),n=0;n<r.length-1;n++)s[r[n]]=s[r[n]]||{},s=s[r[n]];if(t=r.pop(),1===arguments.length)return void 0===s[t]?null:s[t];s[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return"classes"===e&&this._setOptionClasses(t),this.options[e]=t,"disabled"===e&&this._setOptionDisabled(t),this},_setOptionClasses:function(t){var i,r,s;for(i in t)s=this.classesElementLookup[i],t[i]!==this.options.classes[i]&&s&&s.length&&(r=e(s.get()),this._removeClass(s,i),r.addClass(this._classes({element:r,keys:i,classes:t,add:!0})))},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e),e&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(t){var i=[],r=this;function s(s,n){var o,a;for(a=0;a<s.length;a++)o=r.classesElementLookup[s[a]]||e(),o=t.add?e(e.unique(o.get().concat(t.element.get()))):e(o.not(t.element).get()),r.classesElementLookup[s[a]]=o,i.push(s[a]),n&&t.classes[s[a]]&&i.push(t.classes[s[a]])}return t=e.extend({element:this.element,classes:this.options.classes||{}},t),this._on(t.element,{remove:"_untrackClassesElement"}),t.keys&&s(t.keys.match(/\S+/g)||[],!0),t.extra&&s(t.extra.match(/\S+/g)||[]),i.join(" ")},_untrackClassesElement:function(t){var i=this;e.each(i.classesElementLookup,(function(r,s){-1!==e.inArray(t.target,s)&&(i.classesElementLookup[r]=e(s.not(t.target).get()))}))},_removeClass:function(e,t,i){return this._toggleClass(e,t,i,!1)},_addClass:function(e,t,i){return this._toggleClass(e,t,i,!0)},_toggleClass:function(e,t,i,r){r="boolean"==typeof r?r:i;var s="string"==typeof e||null===e,n={extra:s?t:i,keys:s?e:t,element:s?this.element:e,add:r};return n.element.toggleClass(this._classes(n),r),this},_on:function(t,i,r){var s,n=this;"boolean"!=typeof t&&(r=i,i=t,t=!1),r?(i=s=e(i),this.bindings=this.bindings.add(i)):(r=i,i=this.element,s=this.widget()),e.each(r,(function(r,o){function a(){if(t||!0!==n.options.disabled&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof o?n[o]:o).apply(n,arguments)}"string"!=typeof o&&(a.guid=o.guid=o.guid||a.guid||e.guid++);var l=r.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+n.eventNamespace,u=l[2];u?s.on(c,u,a):i.on(c,a)}))},
_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(i).off(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){var i=this;return setTimeout((function(){return("string"==typeof e?i[e]:e).apply(i,arguments)}),t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){this._addClass(e(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){this._addClass(e(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,i,r){var s,n,o=this.options[t];if(r=r||{},(i=e.Event(i)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],n=i.originalEvent)for(s in n)s in i||(i[s]=n[s]);return this.element.trigger(i,r),!(e.isFunction(o)&&!1===o.apply(this.element[0],[i].concat(r))||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},(function(t,i){e.Widget.prototype["_"+t]=function(r,s,n){var o;"string"==typeof s&&(s={effect:s});var a=s?!0===s||"number"==typeof s?i:s.effect||i:t;"number"==typeof(s=s||{})&&(s={duration:s}),o=!e.isEmptyObject(s),s.complete=n,s.delay&&r.delay(s.delay),o&&e.effects&&e.effects.effect[a]?r[t](s):a!==t&&r[a]?r[a](s.duration,s.easing,n):r.queue((function(i){e(this)[t](),n&&n.call(r[0]),i()}))}})),e.widget})?r.apply(t,s):r)||(e.exports=n)},66177:(e,t,i)=>{var r,s,n;s=[i(18184),i(21870),i(85592),i(26891)],void 0===(n="function"==typeof(r=function(e){var t=!1;return e(document).on("mouseup",(function(){t=!1})),e.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.on("mousedown."+this.widgetName,(function(e){return t._mouseDown(e)})).on("click."+this.widgetName,(function(i){if(!0===e.data(i.target,t.widgetName+".preventClickEvent"))return e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1})),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var r=this,s=1===i.which,n=!("string"!=typeof this.options.cancel||!i.target.nodeName)&&e(i.target).closest(this.options.cancel).length;return!(s&&!n&&this._mouseCapture(i)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){r.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=!1!==this._mouseStart(i),
!this._mouseStarted)?(i.preventDefault(),0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,0)))}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(i){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,i.target===this._mouseDownEvent.target&&e.data(i.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(i)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,t=!1,i.preventDefault()},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})?r.apply(t,s):r)||(e.exports=n)},69483:(e,t,i)=>{e.exports=function e(t,i,r){function s(o,a){if(!i[o]){if(!t[o]){if(n)return n(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[o]={exports:{}};t[o][0].call(c.exports,(function(e){var i=t[o][1][e];return s(i||e)}),c,c.exports,e,t,i,r)}return i[o].exports}for(var n=void 0,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(e,t,i){"use strict";var r=e(2);function s(){}var n={},o=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==s&&p(this,e)}function u(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function d(e,t,i){r((function(){var r;try{r=t(i)}catch(t){return n.reject(e,t)}r===e?n.reject(e,new TypeError("Cannot resolve promise with itself")):n.resolve(e,r)}))}function h(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var i=!1;function r(t){i||(i=!0,n.reject(e,t))}
function s(t){i||(i=!0,n.resolve(e,t))}var o=_((function(){t(s,r)}));"error"===o.status&&r(o.value)}function _(e,t){var i={};try{i.value=e(t),i.status="success"}catch(e){i.status="error",i.value=e}return i}t.exports=i=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===o)return this;var i=new this.constructor(s);return this.state!==l?d(i,this.state===a?e:t,this.outcome):this.queue.push(new u(i,e,t)),i},u.prototype.callFulfilled=function(e){n.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){n.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},n.resolve=function(e,t){var i=_(h,t);if("error"===i.status)return n.reject(e,i.value);var r=i.value;if(r)p(e,r);else{e.state=a,e.outcome=t;for(var s=-1,o=e.queue.length;++s<o;)e.queue[s].callFulfilled(t)}return e},n.reject=function(e,t){e.state=o,e.outcome=t;for(var i=-1,r=e.queue.length;++i<r;)e.queue[i].callRejected(t);return e},i.resolve=function(e){return e instanceof this?e:n.resolve(new this(s),e)},i.reject=function(e){var t=new this(s);return n.reject(t,e)},i.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,r=!1;if(!i)return this.resolve([]);for(var o=new Array(i),a=0,l=-1,c=new this(s);++l<i;)u(e[l],l);return c;function u(e,s){t.resolve(e).then((function(e){o[s]=e,++a!==i||r||(r=!0,n.resolve(c,o))}),(function(e){r||(r=!0,n.reject(c,e))}))}},i.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,r=!1;if(!i)return this.resolve([]);for(var o,a=-1,l=new this(s);++a<i;)o=e[a],t.resolve(o).then((function(e){r||(r=!0,n.resolve(l,e))}),(function(e){r||(r=!0,n.reject(l,e))}));return l}},{2:2}],2:[function(e,t,r){(function(e){"use strict";var i,r,s=e.MutationObserver||e.WebKitMutationObserver;if(s){var n=0,o=new s(u),a=e.document.createTextNode("");o.observe(a,{characterData:!0}),i=function(){a.data=n=++n%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,i=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;r=!0;for(var i=c.length;i;){for(t=c,c=[],e=-1;++e<i;)t[e]();i=c.length}r=!1}t.exports=function(e){1!==c.push(e)||r||i()}}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,r){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(1))
}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1}],4:[function(e,t,i){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){}}();function n(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(s){if("TypeError"!==s.name)throw s;for(var i=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)i.append(e[r]);return i.getBlob(t.type)}}"undefined"==typeof Promise&&void 0!==e&&e(3);var o=Promise;function a(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function l(e,t,i){"function"==typeof t&&e.then(t),"function"==typeof i&&e.catch(i)}var c,u,d=Object.prototype.toString;function h(e){return"boolean"==typeof c?o.resolve(c):(t=e,new o((function(e){var i=n([""]);t.objectStore("local-forage-detect-blob-support").put(i,"key"),t.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},t.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),i=navigator.userAgent.match(/Edge\//);e(i||!t||parseInt(t[1],10)>=43)}})).catch((function(){return!1}))).then((function(e){return c=e}));var t}function p(e,t){return new o((function(i,r){if(e.db){if(!t)return i(e.db);!function(e){var t=u[e.name],i={};i.promise=new o((function(e){i.resolve=e})),t.deferredOperations.push(i),t.dbReady?t.dbReady=t.dbReady.then((function(){return i.promise})):t.dbReady=i.promise}(e),e.db.close()}var n=[e.name];t&&n.push(e.version);var a=s.open.apply(s,n);t&&(a.onupgradeneeded=function(t){var i=a.result;try{i.createObjectStore(e.storeName),t.oldVersion<=1&&i.createObjectStore("local-forage-detect-blob-support")}catch(i){if("ConstraintError"!==i.name)throw i;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),a.onerror=function(){r(a.error)},a.onsuccess=function(){i(a.result),function(e){var t=u[e.name].deferredOperations.pop();t&&t.resolve()}(e)}}))}function _(e){return n([function(e){for(var t=e.length,i=new ArrayBuffer(t),r=new Uint8Array(i),s=0;s<t;s++)r[s]=e.charCodeAt(s);return i}(atob(e.data))],{type:e.type})}function m(e){return e&&e.__local_forage_encoded_blob}function f(e){var t=this,i=t._initReady().then((function(){var e=u[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return l(i,e,e),i}var g={_driver:"asyncStorage",_initStorage:function(e){var t=this,i={db:null};if(e)for(var r in e)i[r]=e[r];u||(u={});var s=u[i.name];s||(s={forages:[],db:null,
dbReady:null,deferredOperations:[]},u[i.name]=s),s.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=f);var n=[];function a(){return o.resolve()}for(var l=0;l<s.forages.length;l++){var c=s.forages[l];c!==t&&n.push(c._initReady().catch(a))}var d=s.forages.slice(0);return o.all(n).then((function(){return i.db=s.db,function(e){return p(e,!1)}(i)})).then((function(e){return i.db=e,function(e,t){if(!e.db)return!0;var i=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,s=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),s||i){if(i){var n=e.db.version+1;n>e.version&&(e.version=n)}return!0}return!1}(i,t._defaultConfig.version)?function(e){return p(e,!0)}(i):e})).then((function(e){i.db=s.db=e,t._dbInfo=i;for(var r=0;r<d.length;r++){var n=d[r];n!==t&&(n._dbInfo.db=i.db,n._dbInfo.version=i.version)}}))},iterate:function(e,t){var i=this,r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo,n=s.db.transaction(s.storeName,"readonly").objectStore(s.storeName).openCursor(),o=1;n.onsuccess=function(){var i=n.result;if(i){var r=i.value;m(r)&&(r=_(r));var s=e(r,i.key,o++);void 0!==s?t(s):i.continue()}else t()},n.onerror=function(){r(n.error)}})).catch(r)}));return a(r,t),r},getItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo,n=s.db.transaction(s.storeName,"readonly").objectStore(s.storeName).get(e);n.onsuccess=function(){var e=n.result;void 0===e&&(e=null),m(e)&&(e=_(e)),t(e)},n.onerror=function(){r(n.error)}})).catch(r)}));return a(r,t),r},setItem:function(e,t,i){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var s=new o((function(i,s){var n;r.ready().then((function(){return n=r._dbInfo,"[object Blob]"===d.call(t)?h(n.db).then((function(e){return e?t:(i=t,new o((function(e,t){var r=new FileReader;r.onerror=t,r.onloadend=function(t){var r=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:i.type})},r.readAsBinaryString(i)})));var i})):t})).then((function(t){var r=n.db.transaction(n.storeName,"readwrite"),o=r.objectStore(n.storeName);null===t&&(t=void 0),r.oncomplete=function(){void 0===t&&(t=null),i(t)},r.onabort=r.onerror=function(){var e=a.error?a.error:a.transaction.error;s(e)};var a=o.put(t,e)})).catch(s)}));return a(s,i),s},removeItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo,n=s.db.transaction(s.storeName,"readwrite"),o=n.objectStore(s.storeName).delete(e);n.oncomplete=function(){t()},n.onerror=function(){r(o.error)},n.onabort=function(){var e=o.error?o.error:o.transaction.error;r(e)}})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){
var r=t._dbInfo,s=r.db.transaction(r.storeName,"readwrite"),n=s.objectStore(r.storeName).clear();s.oncomplete=function(){e()},s.onabort=s.onerror=function(){var e=n.error?n.error:n.transaction.error;i(e)}})).catch(i)}));return a(i,e),i},length:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){var r=t._dbInfo,s=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).count();s.onsuccess=function(){e(s.result)},s.onerror=function(){i(s.error)}})).catch(i)}));return a(i,e),i},key:function(e,t){var i=this,r=new o((function(t,r){e<0?t(null):i.ready().then((function(){var s=i._dbInfo,n=s.db.transaction(s.storeName,"readonly").objectStore(s.storeName),o=!1,a=n.openCursor();a.onsuccess=function(){var i=a.result;i?0===e||o?t(i.key):(o=!0,i.advance(e)):t(null)},a.onerror=function(){r(a.error)}})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){var r=t._dbInfo,s=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).openCursor(),n=[];s.onsuccess=function(){var t=s.result;t?(n.push(t.key),t.continue()):e(n)},s.onerror=function(){i(s.error)}})).catch(i)}));return a(i,e),i}},v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S=/^~~local_forage_type~([^~]+)~/,y="__lfsc__:".length,b=y+"arbf".length,w=Object.prototype.toString;function P(e){var t,i,r,s,n,o=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var c=new ArrayBuffer(o),u=new Uint8Array(c);for(t=0;t<a;t+=4)i=v.indexOf(e[t]),r=v.indexOf(e[t+1]),s=v.indexOf(e[t+2]),n=v.indexOf(e[t+3]),u[l++]=i<<2|r>>4,u[l++]=(15&r)<<4|s>>2,u[l++]=(3&s)<<6|63&n;return c}function C(e){var t,i=new Uint8Array(e),r="";for(t=0;t<i.length;t+=3)r+=v[i[t]>>2],r+=v[(3&i[t])<<4|i[t+1]>>4],r+=v[(15&i[t+1])<<2|i[t+2]>>6],r+=v[63&i[t+2]];return i.length%3==2?r=r.substring(0,r.length-1)+"=":i.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var T={serialize:function(e,t){var i="";if(e&&(i=w.call(e)),e&&("[object ArrayBuffer]"===i||e.buffer&&"[object ArrayBuffer]"===w.call(e.buffer))){var r,s="__lfsc__:";e instanceof ArrayBuffer?(r=e,s+="arbf"):(r=e.buffer,"[object Int8Array]"===i?s+="si08":"[object Uint8Array]"===i?s+="ui08":"[object Uint8ClampedArray]"===i?s+="uic8":"[object Int16Array]"===i?s+="si16":"[object Uint16Array]"===i?s+="ur16":"[object Int32Array]"===i?s+="si32":"[object Uint32Array]"===i?s+="ui32":"[object Float32Array]"===i?s+="fl32":"[object Float64Array]"===i?s+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(s+C(r))}else if("[object Blob]"===i){var n=new FileReader;n.onload=function(){var i="~~local_forage_type~"+e.type+"~"+C(this.result);t("__lfsc__:blob"+i)},n.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(i){console.error("Couldn't convert value into a JSON string: ",e),t(null,i)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,y))return JSON.parse(e);var t,i=e.substring(b),r=e.substring(y,b);if("blob"===r&&S.test(i)){var s=i.match(S);t=s[1],i=i.substring(s[0].length)}var o=P(i);switch(r){case"arbf":return o
;case"blob":return n([o],{type:t});case"si08":return new Int8Array(o);case"ui08":return new Uint8Array(o);case"uic8":return new Uint8ClampedArray(o);case"si16":return new Int16Array(o);case"ur16":return new Uint16Array(o);case"si32":return new Int32Array(o);case"ui32":return new Uint32Array(o);case"fl32":return new Float32Array(o);case"fl64":return new Float64Array(o);default:throw new Error("Unkown type: "+r)}},stringToBuffer:P,bufferToString:C},x={_driver:"webSQLStorage",_initStorage:function(e){var t=this,i={db:null};if(e)for(var r in e)i[r]="string"!=typeof e[r]?e[r].toString():e[r];var s=new o((function(e,r){try{i.db=openDatabase(i.name,String(i.version),i.description,i.size)}catch(e){return r(e)}i.db.transaction((function(s){s.executeSql("CREATE TABLE IF NOT EXISTS "+i.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],(function(){t._dbInfo=i,e()}),(function(e,t){r(t)}))}))}));return i.serializer=T,s},iterate:function(e,t){var i=this,r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){i.executeSql("SELECT * FROM "+s.storeName,[],(function(i,r){for(var n=r.rows,o=n.length,a=0;a<o;a++){var l=n.item(a),c=l.value;if(c&&(c=s.serializer.deserialize(c)),void 0!==(c=e(c,l.key,a+1)))return void t(c)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},getItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){i.executeSql("SELECT * FROM "+s.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,i){var r=i.rows.length?i.rows.item(0).value:null;r&&(r=s.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},setItem:function(e,t,i){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var s=new o((function(i,s){r.ready().then((function(){void 0===t&&(t=null);var n=t,o=r._dbInfo;o.serializer.serialize(t,(function(t,r){r?s(r):o.db.transaction((function(r){r.executeSql("INSERT OR REPLACE INTO "+o.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){i(n)}),(function(e,t){s(t)}))}),(function(e){e.code===e.QUOTA_ERR&&s(e)}))}))})).catch(s)}));return a(s,i),s},removeItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){i.executeSql("DELETE FROM "+s.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){t.executeSql("DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i},length:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){
t.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,i){var r=i.rows.item(0).c;e(r)}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i},key:function(e,t){var i=this,r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){i.executeSql("SELECT key FROM "+s.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,i){var r=i.rows.length?i.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){t.executeSql("SELECT key FROM "+r.storeName,[],(function(t,i){for(var r=[],s=0;s<i.rows.length;s++)r.push(i.rows.item(s).key);e(r)}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i}},I={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var i in e)t[i]=e[i];return t.keyPrefix=t.name+"/",t.storeName!==this._defaultConfig.storeName&&(t.keyPrefix+=t.storeName+"/"),this._dbInfo=t,t.serializer=T,o.resolve()},iterate:function(e,t){var i=this,r=i.ready().then((function(){for(var t=i._dbInfo,r=t.keyPrefix,s=r.length,n=localStorage.length,o=1,a=0;a<n;a++){var l=localStorage.key(a);if(0===l.indexOf(r)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(s),o++)))return c}}}));return a(r,t),r},getItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=i.ready().then((function(){var t=i._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return a(r,t),r},setItem:function(e,t,i){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var s=r.ready().then((function(){void 0===t&&(t=null);var i=t;return new o((function(s,n){var o=r._dbInfo;o.serializer.serialize(t,(function(t,r){if(r)n(r);else try{localStorage.setItem(o.keyPrefix+e,t),s(i)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||n(e),n(e)}}))}))}));return a(s,i),s},removeItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=i.ready().then((function(){var t=i._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return a(r,t),r},clear:function(e){var t=this,i=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var r=localStorage.key(i);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return a(i,e),i},length:function(e){var t=this.keys().then((function(e){return e.length}));return a(t,e),t},key:function(e,t){var i=this,r=i.ready().then((function(){var t,r=i._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return a(r,t),r},keys:function(e){var t=this,i=t.ready().then((function(){for(var e=t._dbInfo,i=localStorage.length,r=[],s=0;s<i;s++)0===localStorage.key(s).indexOf(e.keyPrefix)&&r.push(localStorage.key(s).substring(e.keyPrefix.length));return r}))
;return a(i,e),i}},L={},M={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},E=[M.INDEXEDDB,M.WEBSQL,M.LOCALSTORAGE],A=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],k={description:"",driver:E.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},D={};D[M.INDEXEDDB]=function(){try{return!!s&&!("undefined"!=typeof openDatabase&&"undefined"!=typeof navigator&&navigator.userAgent&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))&&s&&"function"==typeof s.open&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),D[M.WEBSQL]="function"==typeof openDatabase,D[M.LOCALSTORAGE]=function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(e){return!1}}();var R=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function N(e,t){e[t]=function(){var i=arguments;return e.ready().then((function(){return e[t].apply(e,i)}))}}function O(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var i in t)t.hasOwnProperty(i)&&(R(t[i])?arguments[0][i]=t[i].slice():arguments[0][i]=t[i])}return arguments[0]}function V(e){for(var t in M)if(M.hasOwnProperty(t)&&M[t]===e)return!0;return!1}var B=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.INDEXEDDB=M.INDEXEDDB,this.LOCALSTORAGE=M.LOCALSTORAGE,this.WEBSQL=M.WEBSQL,this._defaultConfig=O({},k),this._config=O({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e)"storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),this._config[t]=e[t];return"driver"in e&&e.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,i){var r=new o((function(t,i){try{var r=e._driver,s=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),n=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void i(s);if(V(e._driver))return void i(n);for(var a=A.concat("_initStorage"),l=0;l<a.length;l++){var c=a[l];if(!c||!e[c]||"function"!=typeof e[c])return void i(s)}var u=o.resolve(!0);"_support"in e&&(u=e._support&&"function"==typeof e._support?e._support():o.resolve(!!e._support)),u.then((function(i){D[r]=i,L[r]=e,t()}),i)}catch(e){i(e)}}));return l(r,t,i),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,i){var r=this,s=o.resolve().then((function(){if(!V(e)){if(L[e])return L[e];throw new Error("Driver not found.")}switch(e){case r.INDEXEDDB:return g;case r.LOCALSTORAGE:return I;case r.WEBSQL:return x}}));return l(s,t,i),s},
e.prototype.getSerializer=function(e){var t=o.resolve(T);return l(t,e),t},e.prototype.ready=function(e){var t=this,i=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return l(i,e,e),i},e.prototype.setDriver=function(e,t,i){var r=this;R(e)||(e=[e]);var s=this._getSupportedDrivers(e);function n(){r._config.driver=r.driver()}var a=null!==this._driverSet?this._driverSet.catch((function(){return o.resolve()})):o.resolve();return this._driverSet=a.then((function(){var e=s[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,n(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(e){return function(){var t=0;return function i(){for(;t<e.length;){var s=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(s).then((function(e){return r._extend(e),n(),r._ready=r._initStorage(r._config),r._ready})).catch(i)}n();var a=new Error("No available storage method found.");return r._driverSet=o.reject(a),r._driverSet}()}}(s)}))})).catch((function(){n();var e=new Error("No available storage method found.");return r._driverSet=o.reject(e),r._driverSet})),l(this._driverSet,t,i),this._driverSet},e.prototype.supports=function(e){return!!D[e]},e.prototype._extend=function(e){O(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],i=0,r=e.length;i<r;i++){var s=e[i];this.supports(s)&&t.push(s)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0;e<A.length;e++)N(this,A[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=B},{3:3}]},{},[4])(4)},69441:function(e,t){!function(i){if("object"==typeof t&&void 0!==e)e.exports=i();else if("function"==typeof define&&define.amd)define([],i);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).localforage=i()}}((function(){return function e(t,i,r){function s(o,a){if(!i[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(n)return n(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[o]={exports:{}};t[o][0].call(u.exports,(function(e){var i=t[o][1][e];return s(i||e)}),u,u.exports,e,t,i,r)}return i[o].exports}for(var n="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(e,t,i){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var s=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){}}();function n(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(s){if("TypeError"!==s.name)throw s
;for(var i=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)i.append(e[r]);return i.getBlob(t.type)}}"undefined"==typeof Promise&&void 0!==e&&e("lie/polyfill");var o=Promise;function a(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function l(e,t,i){"function"==typeof t&&e.then(t),"function"==typeof i&&e.catch(i)}var c,u,d=Object.prototype.toString;function h(e){return"boolean"==typeof c?o.resolve(c):(t=e,new o((function(e){var i=n([""]);t.objectStore("local-forage-detect-blob-support").put(i,"key"),t.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},t.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),i=navigator.userAgent.match(/Edge\//);e(i||!t||parseInt(t[1],10)>=43)}})).catch((function(){return!1}))).then((function(e){return c=e}));var t}function p(e,t){return new o((function(i,r){if(e.db){if(!t)return i(e.db);!function(e){var t=u[e.name],i={};i.promise=new o((function(e){i.resolve=e})),t.deferredOperations.push(i),t.dbReady?t.dbReady=t.dbReady.then((function(){return i.promise})):t.dbReady=i.promise}(e),e.db.close()}var n=[e.name];t&&n.push(e.version);var a=s.open.apply(s,n);t&&(a.onupgradeneeded=function(t){var i=a.result;try{i.createObjectStore(e.storeName),t.oldVersion<=1&&i.createObjectStore("local-forage-detect-blob-support")}catch(i){if("ConstraintError"!==i.name)throw i;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),a.onerror=function(){r(a.error)},a.onsuccess=function(){i(a.result),function(e){var t=u[e.name].deferredOperations.pop();t&&t.resolve()}(e)}}))}function _(e){return n([function(e){for(var t=e.length,i=new ArrayBuffer(t),r=new Uint8Array(i),s=0;s<t;s++)r[s]=e.charCodeAt(s);return i}(atob(e.data))],{type:e.type})}function m(e){return e&&e.__local_forage_encoded_blob}function f(e){var t=this,i=t._initReady().then((function(){var e=u[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return l(i,e,e),i}var g={_driver:"asyncStorage",_initStorage:function(e){var t=this,i={db:null};if(e)for(var r in e)i[r]=e[r];u||(u={});var s=u[i.name];s||(s={forages:[],db:null,dbReady:null,deferredOperations:[]},u[i.name]=s),s.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=f);var n=[];function a(){return o.resolve()}for(var l=0;l<s.forages.length;l++){var c=s.forages[l];c!==t&&n.push(c._initReady().catch(a))}var d=s.forages.slice(0);return o.all(n).then((function(){return i.db=s.db,function(e){return p(e,!1)}(i)})).then((function(e){return i.db=e,function(e,t){if(!e.db)return!0;var i=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,s=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),s||i){if(i){var n=e.db.version+1
;n>e.version&&(e.version=n)}return!0}return!1}(i,t._defaultConfig.version)?function(e){return p(e,!0)}(i):e})).then((function(e){i.db=s.db=e,t._dbInfo=i;for(var r=0;r<d.length;r++){var n=d[r];n!==t&&(n._dbInfo.db=i.db,n._dbInfo.version=i.version)}}))},iterate:function(e,t){var i=this,r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo,n=s.db.transaction(s.storeName,"readonly").objectStore(s.storeName).openCursor(),o=1;n.onsuccess=function(){var i=n.result;if(i){var r=i.value;m(r)&&(r=_(r));var s=e(r,i.key,o++);void 0!==s?t(s):i.continue()}else t()},n.onerror=function(){r(n.error)}})).catch(r)}));return a(r,t),r},getItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo,n=s.db.transaction(s.storeName,"readonly").objectStore(s.storeName).get(e);n.onsuccess=function(){var e=n.result;void 0===e&&(e=null),m(e)&&(e=_(e)),t(e)},n.onerror=function(){r(n.error)}})).catch(r)}));return a(r,t),r},setItem:function(e,t,i){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var s=new o((function(i,s){var n;r.ready().then((function(){return n=r._dbInfo,"[object Blob]"===d.call(t)?h(n.db).then((function(e){return e?t:(i=t,new o((function(e,t){var r=new FileReader;r.onerror=t,r.onloadend=function(t){var r=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:i.type})},r.readAsBinaryString(i)})));var i})):t})).then((function(t){var r=n.db.transaction(n.storeName,"readwrite"),o=r.objectStore(n.storeName);null===t&&(t=void 0),r.oncomplete=function(){void 0===t&&(t=null),i(t)},r.onabort=r.onerror=function(){var e=a.error?a.error:a.transaction.error;s(e)};var a=o.put(t,e)})).catch(s)}));return a(s,i),s},removeItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo,n=s.db.transaction(s.storeName,"readwrite"),o=n.objectStore(s.storeName).delete(e);n.oncomplete=function(){t()},n.onerror=function(){r(o.error)},n.onabort=function(){var e=o.error?o.error:o.transaction.error;r(e)}})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){var r=t._dbInfo,s=r.db.transaction(r.storeName,"readwrite"),n=s.objectStore(r.storeName).clear();s.oncomplete=function(){e()},s.onabort=s.onerror=function(){var e=n.error?n.error:n.transaction.error;i(e)}})).catch(i)}));return a(i,e),i},length:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){var r=t._dbInfo,s=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).count();s.onsuccess=function(){e(s.result)},s.onerror=function(){i(s.error)}})).catch(i)}));return a(i,e),i},key:function(e,t){var i=this,r=new o((function(t,r){e<0?t(null):i.ready().then((function(){var s=i._dbInfo,n=s.db.transaction(s.storeName,"readonly").objectStore(s.storeName),o=!1,a=n.openCursor()
;a.onsuccess=function(){var i=a.result;i?0===e||o?t(i.key):(o=!0,i.advance(e)):t(null)},a.onerror=function(){r(a.error)}})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){var r=t._dbInfo,s=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).openCursor(),n=[];s.onsuccess=function(){var t=s.result;t?(n.push(t.key),t.continue()):e(n)},s.onerror=function(){i(s.error)}})).catch(i)}));return a(i,e),i}},v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S=/^~~local_forage_type~([^~]+)~/,y="__lfsc__:".length,b=y+"arbf".length,w=Object.prototype.toString;function P(e){var t,i,r,s,n,o=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var c=new ArrayBuffer(o),u=new Uint8Array(c);for(t=0;t<a;t+=4)i=v.indexOf(e[t]),r=v.indexOf(e[t+1]),s=v.indexOf(e[t+2]),n=v.indexOf(e[t+3]),u[l++]=i<<2|r>>4,u[l++]=(15&r)<<4|s>>2,u[l++]=(3&s)<<6|63&n;return c}function C(e){var t,i=new Uint8Array(e),r="";for(t=0;t<i.length;t+=3)r+=v[i[t]>>2],r+=v[(3&i[t])<<4|i[t+1]>>4],r+=v[(15&i[t+1])<<2|i[t+2]>>6],r+=v[63&i[t+2]];return i.length%3==2?r=r.substring(0,r.length-1)+"=":i.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var T={serialize:function(e,t){var i="";if(e&&(i=w.call(e)),e&&("[object ArrayBuffer]"===i||e.buffer&&"[object ArrayBuffer]"===w.call(e.buffer))){var r,s="__lfsc__:";e instanceof ArrayBuffer?(r=e,s+="arbf"):(r=e.buffer,"[object Int8Array]"===i?s+="si08":"[object Uint8Array]"===i?s+="ui08":"[object Uint8ClampedArray]"===i?s+="uic8":"[object Int16Array]"===i?s+="si16":"[object Uint16Array]"===i?s+="ur16":"[object Int32Array]"===i?s+="si32":"[object Uint32Array]"===i?s+="ui32":"[object Float32Array]"===i?s+="fl32":"[object Float64Array]"===i?s+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(s+C(r))}else if("[object Blob]"===i){var n=new FileReader;n.onload=function(){var i="~~local_forage_type~"+e.type+"~"+C(this.result);t("__lfsc__:blob"+i)},n.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(i){console.error("Couldn't convert value into a JSON string: ",e),t(null,i)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,y))return JSON.parse(e);var t,i=e.substring(b),r=e.substring(y,b);if("blob"===r&&S.test(i)){var s=i.match(S);t=s[1],i=i.substring(s[0].length)}var o=P(i);switch(r){case"arbf":return o;case"blob":return n([o],{type:t});case"si08":return new Int8Array(o);case"ui08":return new Uint8Array(o);case"uic8":return new Uint8ClampedArray(o);case"si16":return new Int16Array(o);case"ur16":return new Uint16Array(o);case"si32":return new Int32Array(o);case"ui32":return new Uint32Array(o);case"fl32":return new Float32Array(o);case"fl64":return new Float64Array(o);default:throw new Error("Unkown type: "+r)}},stringToBuffer:P,bufferToString:C};var x={_driver:"webSQLStorage",_initStorage:function(e){var t=this,i={db:null};if(e)for(var r in e)i[r]="string"!=typeof e[r]?e[r].toString():e[r];var s=new o((function(e,r){try{i.db=openDatabase(i.name,String(i.version),i.description,i.size)}catch(e){
return r(e)}i.db.transaction((function(s){s.executeSql("CREATE TABLE IF NOT EXISTS "+i.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],(function(){t._dbInfo=i,e()}),(function(e,t){r(t)}))}))}));return i.serializer=T,s},iterate:function(e,t){var i=this,r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){i.executeSql("SELECT * FROM "+s.storeName,[],(function(i,r){for(var n=r.rows,o=n.length,a=0;a<o;a++){var l=n.item(a),c=l.value;if(c&&(c=s.serializer.deserialize(c)),void 0!==(c=e(c,l.key,a+1)))return void t(c)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},getItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){i.executeSql("SELECT * FROM "+s.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,i){var r=i.rows.length?i.rows.item(0).value:null;r&&(r=s.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},setItem:function(e,t,i){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var s=new o((function(i,s){r.ready().then((function(){void 0===t&&(t=null);var n=t,o=r._dbInfo;o.serializer.serialize(t,(function(t,r){r?s(r):o.db.transaction((function(r){r.executeSql("INSERT OR REPLACE INTO "+o.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){i(n)}),(function(e,t){s(t)}))}),(function(e){e.code===e.QUOTA_ERR&&s(e)}))}))})).catch(s)}));return a(s,i),s},removeItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){i.executeSql("DELETE FROM "+s.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){t.executeSql("DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i},length:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){t.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,i){var r=i.rows.item(0).c;e(r)}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i},key:function(e,t){var i=this,r=new o((function(t,r){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){i.executeSql("SELECT key FROM "+s.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,i){var r=i.rows.length?i.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,i=new o((function(e,i){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){t.executeSql("SELECT key FROM "+r.storeName,[],(function(t,i){for(var r=[],s=0;s<i.rows.length;s++)r.push(i.rows.item(s).key)
;e(r)}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i}};var I={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var i in e)t[i]=e[i];return t.keyPrefix=t.name+"/",t.storeName!==this._defaultConfig.storeName&&(t.keyPrefix+=t.storeName+"/"),this._dbInfo=t,t.serializer=T,o.resolve()},iterate:function(e,t){var i=this,r=i.ready().then((function(){for(var t=i._dbInfo,r=t.keyPrefix,s=r.length,n=localStorage.length,o=1,a=0;a<n;a++){var l=localStorage.key(a);if(0===l.indexOf(r)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(s),o++)))return c}}}));return a(r,t),r},getItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=i.ready().then((function(){var t=i._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return a(r,t),r},setItem:function(e,t,i){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var s=r.ready().then((function(){void 0===t&&(t=null);var i=t;return new o((function(s,n){var o=r._dbInfo;o.serializer.serialize(t,(function(t,r){if(r)n(r);else try{localStorage.setItem(o.keyPrefix+e,t),s(i)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||n(e),n(e)}}))}))}));return a(s,i),s},removeItem:function(e,t){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=i.ready().then((function(){var t=i._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return a(r,t),r},clear:function(e){var t=this,i=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var r=localStorage.key(i);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return a(i,e),i},length:function(e){var t=this.keys().then((function(e){return e.length}));return a(t,e),t},key:function(e,t){var i=this,r=i.ready().then((function(){var t,r=i._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return a(r,t),r},keys:function(e){var t=this,i=t.ready().then((function(){for(var e=t._dbInfo,i=localStorage.length,r=[],s=0;s<i;s++)0===localStorage.key(s).indexOf(e.keyPrefix)&&r.push(localStorage.key(s).substring(e.keyPrefix.length));return r}));return a(i,e),i}},L={},M={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},E=[M.INDEXEDDB,M.WEBSQL,M.LOCALSTORAGE],A=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],k={description:"",driver:E.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},D={};D[M.INDEXEDDB]=function(){try{return!!s&&(!("undefined"!=typeof openDatabase&&"undefined"!=typeof navigator&&navigator.userAgent&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))&&(s&&"function"==typeof s.open&&"undefined"!=typeof IDBKeyRange))}catch(e){return!1}}(),D[M.WEBSQL]="function"==typeof openDatabase,D[M.LOCALSTORAGE]=function(){try{
return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(e){return!1}}();var R=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function N(e,t){e[t]=function(){var i=arguments;return e.ready().then((function(){return e[t].apply(e,i)}))}}function O(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var i in t)t.hasOwnProperty(i)&&(R(t[i])?arguments[0][i]=t[i].slice():arguments[0][i]=t[i])}return arguments[0]}function V(e){for(var t in M)if(M.hasOwnProperty(t)&&M[t]===e)return!0;return!1}var B=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.INDEXEDDB=M.INDEXEDDB,this.LOCALSTORAGE=M.LOCALSTORAGE,this.WEBSQL=M.WEBSQL,this._defaultConfig=O({},k),this._config=O({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e)"storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),this._config[t]=e[t];return"driver"in e&&e.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,i){var r=new o((function(t,i){try{var r=e._driver,s=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),n=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void i(s);if(V(e._driver))return void i(n);for(var a=A.concat("_initStorage"),l=0;l<a.length;l++){var c=a[l];if(!c||!e[c]||"function"!=typeof e[c])return void i(s)}var u=o.resolve(!0);"_support"in e&&(u=e._support&&"function"==typeof e._support?e._support():o.resolve(!!e._support)),u.then((function(i){D[r]=i,L[r]=e,t()}),i)}catch(e){i(e)}}));return l(r,t,i),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,i){var r=this,s=o.resolve().then((function(){if(!V(e)){if(L[e])return L[e];throw new Error("Driver not found.")}switch(e){case r.INDEXEDDB:return g;case r.LOCALSTORAGE:return I;case r.WEBSQL:return x}}));return l(s,t,i),s},e.prototype.getSerializer=function(e){var t=o.resolve(T);return l(t,e),t},e.prototype.ready=function(e){var t=this,i=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return l(i,e,e),i},e.prototype.setDriver=function(e,t,i){var r=this;R(e)||(e=[e]);var s=this._getSupportedDrivers(e);function n(){r._config.driver=r.driver()}var a=null!==this._driverSet?this._driverSet.catch((function(){return o.resolve()})):o.resolve();return this._driverSet=a.then((function(){var e=s[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,n(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(e){return function(){var t=0;return function i(){
for(;t<e.length;){var s=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(s).then((function(e){return r._extend(e),n(),r._ready=r._initStorage(r._config),r._ready})).catch(i)}n();var a=new Error("No available storage method found.");return r._driverSet=o.reject(a),r._driverSet}()}}(s)}))})).catch((function(){n();var e=new Error("No available storage method found.");return r._driverSet=o.reject(e),r._driverSet})),l(this._driverSet,t,i),this._driverSet},e.prototype.supports=function(e){return!!D[e]},e.prototype._extend=function(e){O(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],i=0,r=e.length;i<r;i++){var s=e[i];this.supports(s)&&t.push(s)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0;e<A.length;e++)N(this,A[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=B},{undefined:void 0}]},{},[1])(1)}))},74941:(e,t,i)=>{"use strict";i.d(t,{default:()=>h});const r=function(){this.__data__=[],this.size=0};var s=i(52373);const n=function(e,t){for(var i=e.length;i--;)if((0,s.default)(e[i][0],t))return i;return-1};var o=Array.prototype.splice;const a=function(e){var t=this.__data__,i=n(t,e);return!(i<0)&&(i==t.length-1?t.pop():o.call(t,i,1),--this.size,!0)};const l=function(e){var t=this.__data__,i=n(t,e);return i<0?void 0:t[i][1]};const c=function(e){return n(this.__data__,e)>-1};const u=function(e,t){var i=this.__data__,r=n(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this};function d(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}d.prototype.clear=r,d.prototype.delete=a,d.prototype.get=l,d.prototype.has=c,d.prototype.set=u;const h=d},96686:(e,t,i)=>{"use strict";i.d(t,{default:()=>n});var r=i(20570),s=i(56169);const n=(0,r.default)(s.default,"Map")},22990:(e,t,i)=>{"use strict";i.d(t,{default:()=>P});const r=(0,i(20570).default)(Object,"create");const s=function(){this.__data__=r?r(null):{},this.size=0};const n=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t};var o=Object.prototype.hasOwnProperty;const a=function(e){var t=this.__data__;if(r){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return o.call(t,e)?t[e]:void 0};var l=Object.prototype.hasOwnProperty;const c=function(e){var t=this.__data__;return r?void 0!==t[e]:l.call(t,e)};const u=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this};function d(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}d.prototype.clear=s,d.prototype.delete=n,d.prototype.get=a,d.prototype.has=c,d.prototype.set=u;const h=d;var p=i(74941),_=i(96686);const m=function(){this.size=0,this.__data__={hash:new h,map:new(_.default||p.default),string:new h}};const f=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};const g=function(e,t){var i=e.__data__;return f(t)?i["string"==typeof t?"string":"hash"]:i.map};const v=function(e){var t=g(this,e).delete(e)
;return this.size-=t?1:0,t};const S=function(e){return g(this,e).get(e)};const y=function(e){return g(this,e).has(e)};const b=function(e,t){var i=g(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this};function w(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}w.prototype.clear=m,w.prototype.delete=v,w.prototype.get=S,w.prototype.has=y,w.prototype.set=b;const P=w},5876:(e,t,i)=>{"use strict";i.d(t,{default:()=>r});const r=i(56169).default.Symbol},80758:(e,t,i)=>{"use strict";i.d(t,{default:()=>r});const r=function(e,t){for(var i=-1,r=null==e?0:e.length,s=Array(r);++i<r;)s[i]=t(e[i],i,e);return s}},21059:(e,t,i)=>{"use strict";i.d(t,{default:()=>r});const r=function(e,t){for(var i=-1,r=t.length,s=e.length;++i<r;)e[s+i]=t[i];return e}},85285:(e,t,i)=>{"use strict";i.d(t,{default:()=>c});var r=i(21059),s=i(5876),n=i(56986),o=i(39350),a=s.default?s.default.isConcatSpreadable:void 0;const l=function(e){return(0,o.default)(e)||(0,n.default)(e)||!!(a&&e&&e[a])};const c=function e(t,i,s,n,o){var a=-1,c=t.length;for(s||(s=l),o||(o=[]);++a<c;){var u=t[a];i>0&&s(u)?i>1?e(u,i-1,s,n,o):(0,r.default)(o,u):n||(o[o.length]=u)}return o}},23791:(e,t,i)=>{"use strict";i.d(t,{default:()=>n});var r=i(36699),s=i(35429);const n=function(e,t){for(var i=0,n=(t=(0,r.default)(t,e)).length;null!=e&&i<n;)e=e[(0,s.default)(t[i++])];return i&&i==n?e:void 0}},26818:(e,t,i)=>{"use strict";i.d(t,{default:()=>h});var r=i(5876),s=Object.prototype,n=s.hasOwnProperty,o=s.toString,a=r.default?r.default.toStringTag:void 0;const l=function(e){var t=n.call(e,a),i=e[a];try{e[a]=void 0;var r=!0}catch(e){}var s=o.call(e);return r&&(t?e[a]=i:delete e[a]),s};var c=Object.prototype.toString;const u=function(e){return c.call(e)};var d=r.default?r.default.toStringTag:void 0;const h=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":d&&d in Object(e)?l(e):u(e)}},36699:(e,t,i)=>{"use strict";i.d(t,{default:()=>v});var r=i(39350),s=i(8633),n=i(22990);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var i=function(){var r=arguments,s=t?t.apply(this,r):r[0],n=i.cache;if(n.has(s))return n.get(s);var o=e.apply(this,r);return i.cache=n.set(s,o)||n,o};return i.cache=new(o.Cache||n.default),i}o.Cache=n.default;const a=o;var l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,c=/\\(\\)?/g;const u=function(e){var t=a(e,(function(e){return 500===i.size&&i.clear(),e})),i=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(l,(function(e,i,r,s){t.push(r?s.replace(c,"$1"):i||e)})),t}));var d=i(5876),h=i(80758),p=i(97828),_=d.default?d.default.prototype:void 0,m=_?_.toString:void 0;const f=function e(t){if("string"==typeof t)return t;if((0,r.default)(t))return(0,h.default)(t,e)+"";if((0,p.default)(t))return m?m.call(t):"";var i=t+"";return"0"==i&&1/t==-1/0?"-0":i};const g=function(e){return null==e?"":f(e)};const v=function(e,t){return(0,r.default)(e)?e:(0,
s.default)(e,t)?[e]:u(g(e))}},48277:(e,t,i)=>{"use strict";i.d(t,{default:()=>r});const r="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g},20570:(e,t,i)=>{"use strict";i.d(t,{default:()=>v});var r=i(25069);const s=i(56169).default["__core-js_shared__"];var n,o=(n=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";const a=function(e){return!!o&&o in e};var l=i(89122),c=i(48723),u=/^\[object .+?Constructor\]$/,d=Function.prototype,h=Object.prototype,p=d.toString,_=h.hasOwnProperty,m=RegExp("^"+p.call(_).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const f=function(e){return!(!(0,l.default)(e)||a(e))&&((0,r.default)(e)?m:u).test((0,c.default)(e))};const g=function(e,t){return null==e?void 0:e[t]};const v=function(e,t){var i=g(e,t);return f(i)?i:void 0}},8633:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});var r=i(39350),s=i(97828),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;const a=function(e,t){if((0,r.default)(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!(0,s.default)(e))||(o.test(e)||!n.test(e)||null!=t&&e in Object(t))}},56169:(e,t,i)=>{"use strict";i.d(t,{default:()=>n});var r=i(48277),s="object"==typeof self&&self&&self.Object===Object&&self;const n=r.default||s||Function("return this")()},35429:(e,t,i)=>{"use strict";i.d(t,{default:()=>s});var r=i(97828);const s=function(e){if("string"==typeof e||(0,r.default)(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},48723:(e,t,i)=>{"use strict";i.d(t,{default:()=>s});var r=Function.prototype.toString;const s=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},99479:(e,t,i)=>{"use strict";i.d(t,{default:()=>m});var r=i(89122),s=i(56169);const n=function(){return s.default.Date.now()};var o=i(97828),a=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,d=parseInt;const h=function(e){if("number"==typeof e)return e;if((0,o.default)(e))return NaN;if((0,r.default)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,r.default)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var i=c.test(e);return i||u.test(e)?d(e.slice(2),i?2:8):l.test(e)?NaN:+e};var p=Math.max,_=Math.min;const m=function(e,t,i){var s,o,a,l,c,u,d=0,m=!1,f=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var i=s,r=o;return s=o=void 0,d=t,l=e.apply(r,i)}function S(e){return d=e,c=setTimeout(b,t),m?v(e):l}function y(e){var i=e-u;return void 0===u||i>=t||i<0||f&&e-d>=a}function b(){var e=n();if(y(e))return w(e);c=setTimeout(b,function(e){var i=t-(e-u);return f?_(i,a-(e-d)):i}(e))}function w(e){return c=void 0,g&&s?v(e):(s=o=void 0,l)}function P(){var e=n(),i=y(e);if(s=arguments,o=this,u=e,i){if(void 0===c)return S(u);if(f)return clearTimeout(c),c=setTimeout(b,t),v(u)}return void 0===c&&(c=setTimeout(b,t)),l}return t=h(t)||0,(0,r.default)(i)&&(m=!!i.leading,a=(f="maxWait"in i)?p(h(i.maxWait)||0,t):a,g="trailing"in i?!!i.trailing:g),
P.cancel=function(){void 0!==c&&clearTimeout(c),d=0,s=u=o=c=void 0},P.flush=function(){return void 0===c?l:w(n())},P}},52373:(e,t,i)=>{"use strict";i.d(t,{default:()=>r});const r=function(e,t){return e===t||e!=e&&t!=t}},62543:(e,t,i)=>{"use strict";i.d(t,{default:()=>s});var r=i(85285);const s=function(e){return(null==e?0:e.length)?(0,r.default)(e,1):[]}},56986:(e,t,i)=>{"use strict";i.d(t,{default:()=>c});var r=i(26818),s=i(23195);const n=function(e){return(0,s.default)(e)&&"[object Arguments]"==(0,r.default)(e)};var o=Object.prototype,a=o.hasOwnProperty,l=o.propertyIsEnumerable;const c=n(function(){return arguments}())?n:function(e){return(0,s.default)(e)&&a.call(e,"callee")&&!l.call(e,"callee")}},39350:(e,t,i)=>{"use strict";i.d(t,{default:()=>r});const r=Array.isArray},25069:(e,t,i)=>{"use strict";i.d(t,{default:()=>n});var r=i(26818),s=i(89122);const n=function(e){if(!(0,s.default)(e))return!1;var t=(0,r.default)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},45018:(e,t,i)=>{"use strict";i.d(t,{default:()=>r});const r=function(e){return null===e}},89122:(e,t,i)=>{"use strict";i.d(t,{default:()=>r});const r=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},23195:(e,t,i)=>{"use strict";i.d(t,{default:()=>r});const r=function(e){return null!=e&&"object"==typeof e}},97828:(e,t,i)=>{"use strict";i.d(t,{default:()=>n});var r=i(26818),s=i(23195);const n=function(e){return"symbol"==typeof e||(0,s.default)(e)&&"[object Symbol]"==(0,r.default)(e)}},58848:(e,t,i)=>{"use strict";i.d(t,{default:()=>n});var r=i(99479),s=i(89122);const n=function(e,t,i){var n=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return(0,s.default)(i)&&(n="leading"in i?!!i.leading:n,o="trailing"in i?!!i.trailing:o),(0,r.default)(e,t,{leading:n,maxWait:t,trailing:o})}},59440:(e,t,i)=>{"use strict";i.d(t,{default:()=>u});var r=i(36699);const s=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var n=i(23791);const o=function(e,t,i){var r=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(i=i>s?s:i)<0&&(i+=s),s=t>i?0:i-t>>>0,t>>>=0;for(var n=Array(s);++r<s;)n[r]=e[r+t];return n};const a=function(e,t){return t.length<2?e:(0,n.default)(e,o(t,0,-1))};var l=i(35429);const c=function(e,t){return t=(0,r.default)(t,e),null==(e=a(e,t))||delete e[(0,l.default)(s(t))]};const u=function(e,t){return null==e||c(e,t)}},18266:()=>{},80874:()=>{},60272:()=>{},94066:()=>{},59621:()=>{},33399:e=>{e.exports={errorDialog:"errorDialog-35rITUhS"}},52467:()=>{},93088:()=>{},36563:e=>{e.exports={"tv-transition--fade-in":"tv-transition--fade-in-1zC4Mcq2","tv-transition--fade-out":"tv-transition--fade-out-1zC4Mcq2","tv-transition--slide-out":"tv-transition--slide-out-1zC4Mcq2"}},54119:()=>{},93801:()=>{},28429:e=>{e.exports={css_value_currency_label_top:"6",css_value_currency_label_radius:"4",css_value_currency_label_text_horizontal_padding:"4",css_value_border_color_light:"#D1D4DC",css_value_border_color_dark:"#363A45",
"price-axis-currency-label-wrapper":"price-axis-currency-label-wrapper-25tFaE37","price-axis-currency-label":"price-axis-currency-label-25tFaE37",readonly:"readonly-25tFaE37",multiline:"multiline-25tFaE37","price-axis-currency-label-dropdown":"price-axis-currency-label-dropdown-25tFaE37","price-axis-currency-label-text":"price-axis-currency-label-text-25tFaE37","price-axis-currency-label-arrow-down":"price-axis-currency-label-arrow-down-25tFaE37"}},92175:e=>{e.exports={labelwidth:"19px",labelheight:"19px",bordersize:"2px",bottommargin:"5px",gearheight:"15px",gearwidth:"15px","price-axis-stub":"price-axis-stub-1DJMiIgd",wrapper:"wrapper-1DJMiIgd",label:"label-1DJMiIgd",symbol:"symbol-1DJMiIgd",gear:"gear-1DJMiIgd","fixed-gear":"fixed-gear-1DJMiIgd","fixed-symbol":"fixed-symbol-1DJMiIgd"}},95411:()=>{},46596:()=>{},34811:e=>{e.exports={content:"content-SNaRagqV",titleWrapper:"titleWrapper-SNaRagqV",title:"title-SNaRagqV",subtitle:"subtitle-SNaRagqV",text:"text-SNaRagqV",icon:"icon-SNaRagqV",group:"group-SNaRagqV",groupIcon:"groupIcon-SNaRagqV",beforeMarketOpen:"beforeMarketOpen-SNaRagqV",afterMarketClose:"afterMarketClose-SNaRagqV",groupTitle:"groupTitle-SNaRagqV",groupRow:"groupRow-SNaRagqV",groupCell:"groupCell-SNaRagqV",link:"link-SNaRagqV",mob:"mob-SNaRagqV",mini:"mini-SNaRagqV"}},91498:e=>{e.exports={"css-value-pane-controls-padding-left":"1px","css-value-pane-controls-padding-right":"5px"}},34104:e=>{e.exports={"css-value-small-size":"18px","css-value-border-radius-small-size":"9px","css-value-large-size":"22px","css-value-border-radius-large-size":"11px",statuses:"statuses-1NfuygY0",statusItem:"statusItem-1NfuygY0",small:"small-1NfuygY0",large:"large-1NfuygY0",blinking:"blinking-1NfuygY0",oneWidgetsVisible:"oneWidgetsVisible-1NfuygY0",twoWidgetsVisible:"twoWidgetsVisible-1NfuygY0",threeWidgetsVisible:"threeWidgetsVisible-1NfuygY0","blinking-animation":"blinking-animation-1NfuygY0",marketStatusOpen:"marketStatusOpen-1NfuygY0",marketStatusClose:"marketStatusClose-1NfuygY0",marketStatusPre:"marketStatusPre-1NfuygY0",marketStatusPost:"marketStatusPost-1NfuygY0",marketStatusHoliday:"marketStatusHoliday-1NfuygY0",invalidSymbol:"invalidSymbol-1NfuygY0",replayMode:"replayMode-1NfuygY0",notAccurate:"notAccurate-1NfuygY0",delay:"delay-1NfuygY0",eod:"eod-1NfuygY0",dataProblemHigh:"dataProblemHigh-1NfuygY0",dataProblemLow:"dataProblemLow-1NfuygY0"}},8325:()=>{},78746:e=>{e.exports={"common-tooltip":"common-tooltip-36YLR71G","common-tooltip--hidden":"common-tooltip--hidden-36YLR71G","common-tooltip--horizontal":"common-tooltip--horizontal-36YLR71G","common-tooltip--farther":"common-tooltip--farther-36YLR71G","common-tooltip--vertical":"common-tooltip--vertical-36YLR71G","common-tooltip-farther":"common-tooltip-farther-36YLR71G","common-tooltip--direction_normal":"common-tooltip--direction_normal-36YLR71G","common-tooltip__body":"common-tooltip__body-36YLR71G","common-tooltip__button-container":"common-tooltip__button-container-36YLR71G","common-tooltip__body--no-buttons":"common-tooltip__body--no-buttons-36YLR71G",
"common-tooltip__button":"common-tooltip__button-36YLR71G","common-tooltip--direction_reversed":"common-tooltip--direction_reversed-36YLR71G","common-tooltip__ear-holder":"common-tooltip__ear-holder-36YLR71G","common-tooltip__ear-holder--below":"common-tooltip__ear-holder--below-36YLR71G","common-tooltip__ear-holder--above":"common-tooltip__ear-holder--above-36YLR71G","common-tooltip__ear-holder--before":"common-tooltip__ear-holder--before-36YLR71G","common-tooltip__ear-holder--after":"common-tooltip__ear-holder--after-36YLR71G","common-tooltip__body--with-hotkey":"common-tooltip__body--with-hotkey-36YLR71G","common-tooltip__body--width_wide":"common-tooltip__body--width_wide-36YLR71G","common-tooltip__body--width_narrow":"common-tooltip__body--width_narrow-36YLR71G","common-tooltip__body--no-padding":"common-tooltip__body--no-padding-36YLR71G","common-tooltip__hotkey-block":"common-tooltip__hotkey-block-36YLR71G","common-tooltip__hotkey-block--divider":"common-tooltip__hotkey-block--divider-36YLR71G","common-tooltip__hotkey-text":"common-tooltip__hotkey-text-36YLR71G","common-tooltip__hotkey-button":"common-tooltip__hotkey-button-36YLR71G","common-tooltip__plus-sign":"common-tooltip__plus-sign-36YLR71G"}},22243:function(e,t,i){!function(e){"use strict";e.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})}(i(30381))},55655:function(e,t,i){!function(e){"use strict";var t="Ene._Feb._Mar._Abr._May._Jun._Jul._Ago._Sep._Oct._Nov._Dic.".split("_"),i="Ene_Feb_Mar_Abr_May_Jun_Jul_Ago_Sep_Oct_Nov_Dic".split("_");e.defineLocale("es",{months:"Enero_Febrero_Marzo_Abril_Mayo_Junio_Julio_Agosto_Septiembre_Octubre_Noviembre_Diciembre".split("_"),monthsShort:function(e,r){return/-MMM-/.test(r)?i[e.month()]:t[e.month()]},weekdays:"Domingo_Lunes_Martes_Miércoles_Jueves_Viernes_Sábado".split("_"),weekdaysShort:"Dom._Lun._Mar._Mié._Jue._Vie._Sáb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_Sá".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){
return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[mañana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinalParse:/\d{1,2}º/,ordinal:"%dº",week:{dow:1,doy:4}})}(i(30381))},90626:function(e,t,i){!function(e){"use strict";e.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"Domenica_Lunedì_Martedì_Mercoledì_Giovedì_Venerdì_Sabato".split("_"),weekdaysShort:"Dom_Lun_Mar_Mer_Gio_Ven_Sab".split("_"),weekdaysMin:"D_L_Ma_Me_G_V_S".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinalParse:/\d{1,2}º/,ordinal:"%dº",week:{dow:1,doy:4}})}(i(30381))},39183:function(e,t,i){!function(e){"use strict";e.defineLocale("ja",{months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),longDateFormat:{LT:"Ah時m分",LTS:"Ah時m分s秒",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah時m分",LLLL:"YYYY年M月D日Ah時m分 dddd"},meridiemParse:/午前|午後/i,isPM:function(e){return"午後"===e},meridiem:function(e,t,i){return e<12?"午前":"午後"},calendar:{sameDay:"[今日] LT",nextDay:"[明日] LT",nextWeek:"[来週]dddd LT",lastDay:"[昨日] LT",lastWeek:"[前週]dddd LT",sameElse:"L"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}})}(i(30381))},33730:function(e,t,i){!function(e){"use strict";e.defineLocale("ko",{months:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),monthsShort:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),weekdays:"일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"),weekdaysShort:"일_월_화_수_목_금_토".split("_"),weekdaysMin:"일_월_화_수_목_금_토".split("_"),longDateFormat:{LT:"A h시 m분",LTS:"A h시 m분 s초",L:"YYYY.MM.DD",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 A h시 m분",LLLL:"YYYY년 MMMM D일 dddd A h시 m분"},calendar:{sameDay:"오늘 LT",
nextDay:"내일 LT",nextWeek:"dddd LT",lastDay:"어제 LT",lastWeek:"지난주 dddd LT",sameElse:"L"},relativeTime:{future:"%s 후",past:"%s 전",s:"몇초",ss:"%d초",m:"일분",mm:"%d분",h:"한시간",hh:"%d시간",d:"하루",dd:"%d일",M:"한달",MM:"%d달",y:"일년",yy:"%d년"},ordinalParse:/\d{1,2}일/,ordinal:"%d일",meridiemParse:/오전|오후/,isPM:function(e){return"오후"===e},meridiem:function(e,t,i){return e<12?"오전":"오후"}})}(i(30381))},64495:function(e,t,i){!function(e){"use strict";var t="styczeń_luty_marzec_kwiecień_maj_czerwiec_lipiec_sierpień_wrzesień_październik_listopad_grudzień".split("_"),i="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_września_października_listopada_grudnia".split("_");function r(e){return e%10<5&&e%10>1&&~~(e/10)%10!=1}function s(e,t,i){var s=e+" ";switch(i){case"m":return t?"minuta":"minutę";case"mm":return s+(r(e)?"minuty":"minut");case"h":return t?"godzina":"godzinę";case"hh":return s+(r(e)?"godziny":"godzin");case"MM":return s+(r(e)?"miesiące":"miesięcy");case"yy":return s+(r(e)?"lata":"lat")}}e.defineLocale("pl",{months:function(e,r){return""===r?"("+i[e.month()]+"|"+t[e.month()]+")":/D MMMM/.test(r)?i[e.month()]:t[e.month()]},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_paź_lis_gru".split("_"),weekdays:"niedziela_poniedziałek_wtorek_środa_czwartek_piątek_sobota".split("_"),weekdaysShort:"nie_pon_wt_śr_czw_pt_sb".split("_"),weekdaysMin:"N_Pn_Wt_Śr_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dziś o] LT",nextDay:"[Jutro o] LT",nextWeek:"[W] dddd [o] LT",lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zeszłą niedzielę o] LT";case 3:return"[W zeszłą środę o] LT";case 6:return"[W zeszłą sobotę o] LT";default:return"[W zeszły] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:s,mm:s,h:s,hh:s,d:"1 dzień",dd:"%d dni",M:"miesiąc",MM:s,y:"rok",yy:s},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}(i(30381))},57971:function(e,t,i){!function(e){"use strict";e.defineLocale("pt-br",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-Feira_Terça-Feira_Quarta-Feira_Quinta-Feira_Sexta-Feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Dom_2ª_3ª_4ª_5ª_6ª_Sáb".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [às] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [às] HH:mm"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrás",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",
y:"um ano",yy:"%d anos"},ordinalParse:/\d{1,2}º/,ordinal:"%dº"})}(i(30381))},89520:function(e,t,i){!function(e){"use strict";e.defineLocale("pt",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-Feira_Terça-Feira_Quarta-Feira_Quinta-Feira_Sexta-Feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Dom_2ª_3ª_4ª_5ª_6ª_Sáb".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY HH:mm"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"há %s",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinalParse:/\d{1,2}º/,ordinal:"%dº",week:{dow:1,doy:4}})}(i(30381))},21793:function(e,t,i){!function(e){"use strict";function t(e,t,i){var r,s;return"m"===i?t?"минута":"минуту":e+" "+(r=+e,s={mm:t?"минута_минуты_минут":"минуту_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"}[i].split("_"),r%10==1&&r%100!=11?s[0]:r%10>=2&&r%10<=4&&(r%100<10||r%100>=20)?s[1]:s[2])}e.defineLocale("ru",{months:function(e,t){return{nominative:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),accusative:"января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_")}[/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(t)?"accusative":"nominative"][e.month()]},monthsShort:function(e,t){return{nominative:"янв_фев_март_апр_май_июнь_июль_авг_сен_окт_ноя_дек".split("_"),accusative:"янв_фев_мар_апр_мая_июня_июля_авг_сен_окт_ноя_дек".split("_")}[/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(t)?"accusative":"nominative"][e.month()]},weekdays:function(e,t){return{nominative:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),accusative:"воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_")}[/\[ ?[Вв] ?(?:прошлую|следующую|эту)? ?\] ?dddd/.test(t)?"accusative":"nominative"][e.day()]},weekdaysShort:"вс_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),monthsParse:[/^янв/i,/^фев/i,/^мар/i,/^апр/i,/^ма[й|я]/i,/^июн/i,/^июл/i,/^авг/i,/^сен/i,/^окт/i,/^ноя/i,/^дек/i],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., HH:mm",LLLL:"dddd, D MMMM YYYY г., HH:mm"},calendar:{sameDay:"[Сегодня в] LT",nextDay:"[Завтра в] LT",lastDay:"[Вчера в] LT",nextWeek:function(){return 2===this.day()?"[Во] dddd [в] LT":"[В] dddd [в] LT"},lastWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[Во] dddd [в] LT":"[В] dddd [в] LT";switch(this.day()){case 0:
return"[В прошлое] dddd [в] LT";case 1:case 2:case 4:return"[В прошлый] dddd [в] LT";case 3:case 5:case 6:return"[В прошлую] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:t,mm:t,h:"час",hh:t,d:"день",dd:t,M:"месяц",MM:t,y:"год",yy:t},meridiemParse:/ночи|утра|дня|вечера/i,isPM:function(e){return/^(дня|вечера)$/.test(e)},meridiem:function(e,t,i){return e<4?"ночи":e<12?"утра":e<17?"дня":"вечера"},ordinalParse:/\d{1,2}-(й|го|я)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":return e+"-й";case"D":return e+"-го";case"w":case"W":return e+"-я";default:return e}},week:{dow:1,doy:7}})}(i(30381))},72397:function(e,t,i){!function(e){"use strict";var t={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'üncü",4:"'üncü",100:"'üncü",6:"'ncı",9:"'uncu",10:"'uncu",30:"'uncu",60:"'ıncı",90:"'ıncı"};e.defineLocale("tr",{months:"Ocak_Şubat_Mart_Nisan_Mayıs_Haziran_Temmuz_Ağustos_Eylül_Ekim_Kasım_Aralık".split("_"),monthsShort:"Oca_Şub_Mar_Nis_May_Haz_Tem_Ağu_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Salı_Çarşamba_Perşembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_Çar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_Ça_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugün saat] LT",nextDay:"[yarın saat] LT",nextWeek:"[haftaya] dddd [saat] LT",lastDay:"[dün] LT",lastWeek:"[geçen hafta] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s önce",s:"birkaç saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gün",dd:"%d gün",M:"bir ay",MM:"%d ay",y:"bir yıl",yy:"%d yıl"},ordinalParse:/\d{1,2}'(inci|nci|üncü|ncı|uncu|ıncı)/,ordinal:function(e){if(0===e)return e+"'ıncı";var i=e%10;return e+(t[i]||t[e%100-i]||t[e>=100?100:null])},week:{dow:1,doy:7}})}(i(30381))},3639:(e,t,i)=>{var r={"./en-gb":22243,"./en-gb.js":22243,"./es":55655,"./es.js":55655,"./it":90626,"./it.js":90626,"./ja":39183,"./ja.js":39183,"./ko":33730,"./ko.js":33730,"./pl":64495,"./pl.js":64495,"./pt":89520,"./pt-br":57971,"./pt-br.js":57971,"./pt.js":89520,"./ru":21793,"./ru.js":21793,"./tr":72397,"./tr.js":72397};function s(e){var t=n(e);return i(t)}function n(e){if(!i.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}s.keys=function(){return Object.keys(r)},s.resolve=n,e.exports=s,s.id=3639},30381:function(e,t,i){(e=i.nmd(e)).exports=function(){"use strict";var t;function r(){return t.apply(null,arguments)}function s(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function a(e,t){for(var i in t)o(t,i)&&(e[i]=t[i]);return o(t,"toString")&&(e.toString=t.toString),o(t,"valueOf")&&(e.valueOf=t.valueOf),e}function l(e,t,i,r){return Re(e,t,i,r,!0).utc()}function c(e){
return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}),e._pf}function u(e){if(null==e._isValid){var t=c(e);e._isValid=!(isNaN(e._d.getTime())||!(t.overflow<0)||t.empty||t.invalidMonth||t.invalidWeekday||t.nullInput||t.invalidFormat||t.userInvalidated),e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)}return e._isValid}function d(e){var t=l(NaN);return null!=e?a(c(t),e):c(t).userInvalidated=!0,t}var h=r.momentProperties=[];function p(e,t){var i,r,s;if(void 0!==t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),void 0!==t._i&&(e._i=t._i),void 0!==t._f&&(e._f=t._f),void 0!==t._l&&(e._l=t._l),void 0!==t._strict&&(e._strict=t._strict),void 0!==t._tzm&&(e._tzm=t._tzm),void 0!==t._isUTC&&(e._isUTC=t._isUTC),void 0!==t._offset&&(e._offset=t._offset),void 0!==t._pf&&(e._pf=c(t)),void 0!==t._locale&&(e._locale=t._locale),h.length>0)for(i in h)void 0!==(s=t[r=h[i]])&&(e[r]=s);return e}var _=!1;function m(e){p(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),!1===_&&(_=!0,r.updateOffset(this),_=!1)}function f(e){return e instanceof m||null!=e&&null!=e._isAMomentObject}function g(e){return e<0?Math.ceil(e):Math.floor(e)}function v(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=g(t)),i}function S(e,t,i){var r,s=Math.min(e.length,t.length),n=Math.abs(e.length-t.length),o=0;for(r=0;r<s;r++)(i&&e[r]!==t[r]||!i&&v(e[r])!==v(t[r]))&&o++;return o+n}function y(){}var b,w={};function P(e){return e?e.toLowerCase().replace("_","-"):e}function C(t){var r=null;if(!w[t]&&e&&e.exports)try{r=b._abbr,i(3639)("./"+t),T(r)}catch(e){}return w[t]}function T(e,t){var i;return e&&(i=void 0===t?I(e):x(e,t))&&(b=i),b._abbr}function x(e,t){return null!==t?(t.abbr=e,w[e]=w[e]||new y,w[e].set(t),T(e),w[e]):(delete w[e],null)}function I(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return b;if(!s(e)){if(t=C(e))return t;e=[e]}return function(e){for(var t,i,r,s,n=0;n<e.length;){for(t=(s=P(e[n]).split("-")).length,i=(i=P(e[n+1]))?i.split("-"):null;t>0;){if(r=C(s.slice(0,t).join("-")))return r;if(i&&i.length>=t&&S(s,i,!0)>=t-1)break;t--}n++}return null}(e)}var L={};function M(e,t){var i=e.toLowerCase();L[i]=L[i+"s"]=L[t]=e}function E(e){return"string"==typeof e?L[e]||L[e.toLowerCase()]:void 0}function A(e){var t,i,r={};for(i in e)o(e,i)&&(t=E(i))&&(r[t]=e[i]);return r}function k(e,t){return function(i){return null!=i?(R(this,e,i),r.updateOffset(this,t),this):D(this,e)}}function D(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function R(e,t,i){return e._d["set"+(e._isUTC?"UTC":"")+t](i)}function N(e,t){var i;if("object"==typeof e)for(i in e)this.set(i,e[i]);else if("function"==typeof this[e=E(e)])return this[e](t);return this}function O(e,t,i){var r=""+Math.abs(e),s=t-r.length;return(e>=0?i?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+r}
var V=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,B=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,F={},W={};function U(e,t,i,r){var s=r;"string"==typeof r&&(s=function(){return this[r]()}),e&&(W[e]=s),t&&(W[t[0]]=function(){return O(s.apply(this,arguments),t[1],t[2])}),i&&(W[i]=function(){return this.localeData().ordinal(s.apply(this,arguments),e)})}function H(e,t){return e.isValid()?(t=z(t,e.localeData()),F[t]=F[t]||function(e){var t,i,r,s=e.match(V);for(t=0,i=s.length;t<i;t++)W[s[t]]?s[t]=W[s[t]]:s[t]=(r=s[t]).match(/\[[\s\S]/)?r.replace(/^\[|\]$/g,""):r.replace(/\\/g,"");return function(r){var n="";for(t=0;t<i;t++)n+=s[t]instanceof Function?s[t].call(r,e):s[t];return n}}(t),F[t](e)):e.localeData().invalidDate()}function z(e,t){var i=5;function r(e){return t.longDateFormat(e)||e}for(B.lastIndex=0;i>=0&&B.test(e);)e=e.replace(B,r),B.lastIndex=0,i-=1;return e}var j=/\d/,Y=/\d\d/,G=/\d{3}/,q=/\d{4}/,X=/[+-]?\d{6}/,$=/\d\d?/,K=/\d{1,3}/,J=/\d{1,4}/,Z=/[+-]?\d{1,6}/,Q=/\d+/,ee=/[+-]?\d+/,te=/Z|[+-]\d\d:?\d\d/gi,ie=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,re={};function se(e,t,i){var r;re[e]="function"==typeof(r=t)&&"[object Function]"===Object.prototype.toString.call(r)?t:function(e){return e&&i?i:t}}function ne(e,t){return o(re,e)?re[e](t._strict,t._locale):new RegExp(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,i,r,s){return t||i||r||s})).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))}var oe={};function ae(e,t){var i,r=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(r=function(e,i){i[t]=v(e)}),i=0;i<e.length;i++)oe[e[i]]=r}function le(e,t){ae(e,(function(e,i,r,s){r._w=r._w||{},t(e,r._w,r,s)}))}function ce(e,t,i){null!=t&&o(oe,e)&&oe[e](t,i._a,i,e)}function ue(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}U("M",["MM",2],"Mo",(function(){return this.month()+1})),U("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),U("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),M("month","M"),se("M",$),se("MM",$,Y),se("MMM",ie),se("MMMM",ie),ae(["M","MM"],(function(e,t){t[1]=v(e)-1})),ae(["MMM","MMMM"],(function(e,t,i,r){var s=i._locale.monthsParse(e,r,i._strict);null!=s?t[1]=s:c(i).invalidMonth=e}));var de="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),he="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function pe(e,t){var i;return"string"==typeof t&&"number"!=typeof(t=e.localeData().monthsParse(t))||(i=Math.min(e.date(),ue(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i)),e}function _e(e){return null!=e?(pe(this,e),r.updateOffset(this,!0),this):D(this,"Month")}function me(e){var t,i=e._a;return i&&-2===c(e).overflow&&(t=i[1]<0||i[1]>11?1:i[2]<1||i[2]>ue(i[0],i[1])?2:i[3]<0||i[3]>24||24===i[3]&&(0!==i[4]||0!==i[5]||0!==i[6])?3:i[4]<0||i[4]>59?4:i[5]<0||i[5]>59?5:i[6]<0||i[6]>999?6:-1,
c(e)._overflowDayOfYear&&(t<0||t>2)&&(t=2),c(e).overflow=t),e}function fe(e){!1===r.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function ge(e,t){var i=!0;return a((function(){return i&&(fe(e+"\n"+(new Error).stack),i=!1),t.apply(this,arguments)}),t)}var ve={};r.suppressDeprecationWarnings=!1;var Se=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ye=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],be=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],we=/^\/?Date\((\-?\d+)/i;function Pe(e){var t,i,r=e._i,s=Se.exec(r);if(s){for(c(e).iso=!0,t=0,i=ye.length;t<i;t++)if(ye[t][1].exec(r)){e._f=ye[t][0];break}for(t=0,i=be.length;t<i;t++)if(be[t][1].exec(r)){e._f+=(s[6]||" ")+be[t][0];break}r.match(te)&&(e._f+="Z"),ke(e)}else e._isValid=!1}function Ce(e,t,i,r,s,n,o){var a=new Date(e,t,i,r,s,n,o);return e<1970&&a.setFullYear(e),a}function Te(e){var t=new Date(Date.UTC.apply(null,arguments));return e<1970&&t.setUTCFullYear(e),t}function xe(e){return Ie(e)?366:365}function Ie(e){return e%4==0&&e%100!=0||e%400==0}r.createFromInputFallback=ge("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),U(0,["YY",2],0,(function(){return this.year()%100})),U(0,["YYYY",4],0,"year"),U(0,["YYYYY",5],0,"year"),U(0,["YYYYYY",6,!0],0,"year"),M("year","y"),se("Y",ee),se("YY",$,Y),se("YYYY",J,q),se("YYYYY",Z,X),se("YYYYYY",Z,X),ae(["YYYYY","YYYYYY"],0),ae("YYYY",(function(e,t){t[0]=2===e.length?r.parseTwoDigitYear(e):v(e)})),ae("YY",(function(e,t){t[0]=r.parseTwoDigitYear(e)})),r.parseTwoDigitYear=function(e){return v(e)+(v(e)>68?1900:2e3)};var Le=k("FullYear",!1);function Me(e,t,i){var r,s=i-t,n=i-e.day();return n>s&&(n-=7),n<s-7&&(n+=7),r=Ne(e).add(n,"d"),{week:Math.ceil(r.dayOfYear()/7),year:r.year()}}function Ee(e,t,i){return null!=e?e:null!=t?t:i}function Ae(e){var t,i,r,s,n=[];if(!e._d){for(r=function(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[2]&&null==e._a[1]&&function(e){var t,i,r,s,n,o,a;null!=(t=e._w).GG||null!=t.W||null!=t.E?(n=1,o=4,i=Ee(t.GG,e._a[0],Me(Ne(),1,4).year),r=Ee(t.W,1),s=Ee(t.E,1)):(n=e._locale._week.dow,o=e._locale._week.doy,i=Ee(t.gg,e._a[0],Me(Ne(),n,o).year),r=Ee(t.w,1),null!=t.d?(s=t.d)<n&&++r:s=null!=t.e?t.e+n:n),a=function(e,t,i,r,s){var n,o=6+s-r,a=Te(e,0,1+o).getUTCDay();return a<s&&(a+=7),{year:(n=1+o+7*(t-1)-a+(i=null!=i?1*i:s))>0?e:e-1,dayOfYear:n>0?n:xe(e-1)+n}}(i,r,s,o,n),e._a[0]=a.year,e._dayOfYear=a.dayOfYear}(e),e._dayOfYear&&(s=Ee(e._a[0],r[0]),
e._dayOfYear>xe(s)&&(c(e)._overflowDayOfYear=!0),i=Te(s,0,e._dayOfYear),e._a[1]=i.getUTCMonth(),e._a[2]=i.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=n[t]=r[t];for(;t<7;t++)e._a[t]=n[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[3]&&0===e._a[4]&&0===e._a[5]&&0===e._a[6]&&(e._nextDay=!0,e._a[3]=0),e._d=(e._useUTC?Te:Ce).apply(null,n),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[3]=24)}}function ke(e){if(e._f!==r.ISO_8601){e._a=[],c(e).empty=!0;var t,i,s,n,o,a=""+e._i,l=a.length,u=0;for(s=z(e._f,e._locale).match(V)||[],t=0;t<s.length;t++)n=s[t],(i=(a.match(ne(n,e))||[])[0])&&((o=a.substr(0,a.indexOf(i))).length>0&&c(e).unusedInput.push(o),a=a.slice(a.indexOf(i)+i.length),u+=i.length),W[n]?(i?c(e).empty=!1:c(e).unusedTokens.push(n),ce(n,i,e)):e._strict&&!i&&c(e).unusedTokens.push(n);c(e).charsLeftOver=l-u,a.length>0&&c(e).unusedInput.push(a),!0===c(e).bigHour&&e._a[3]<=12&&e._a[3]>0&&(c(e).bigHour=void 0),e._a[3]=function(e,t,i){var r;return null==i?t:null!=e.meridiemHour?e.meridiemHour(t,i):null!=e.isPM?((r=e.isPM(i))&&t<12&&(t+=12),r||12!==t||(t=0),t):t}(e._locale,e._a[3],e._meridiem),Ae(e),me(e)}else Pe(e)}function De(e){var t=e._i,i=e._f;return e._locale=e._locale||I(e._l),null===t||void 0===i&&""===t?d({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),f(t)?new m(me(t)):(s(i)?function(e){var t,i,r,s,n;if(0===e._f.length)return c(e).invalidFormat=!0,void(e._d=new Date(NaN));for(s=0;s<e._f.length;s++)n=0,t=p({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[s],ke(t),u(t)&&(n+=c(t).charsLeftOver,n+=10*c(t).unusedTokens.length,c(t).score=n,(null==r||n<r)&&(r=n,i=t));a(e,i||t)}(e):i?ke(e):n(t)?e._d=t:function(e){var t=e._i;void 0===t?e._d=new Date:n(t)?e._d=new Date(+t):"string"==typeof t?function(e){var t=we.exec(e._i);null===t?(Pe(e),!1===e._isValid&&(delete e._isValid,r.createFromInputFallback(e))):e._d=new Date(+t[1])}(e):s(t)?(e._a=function(e,t){var i,r=[];for(i=0;i<e.length;++i)r.push(t(e[i],i));return r}(t.slice(0),(function(e){return parseInt(e,10)})),Ae(e)):"object"==typeof t?function(e){if(!e._d){var t=A(e._i);e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],Ae(e)}}(e):"number"==typeof t?e._d=new Date(t):r.createFromInputFallback(e)}(e),e))}function Re(e,t,i,r,s){var n,o={};return"boolean"==typeof i&&(r=i,i=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=s,o._l=i,o._i=e,o._f=t,o._strict=r,(n=new m(me(De(o))))._nextDay&&(n.add(1,"d"),n._nextDay=void 0),n}function Ne(e,t,i,r){return Re(e,t,i,r,!1)}U("w",["ww",2],"wo","week"),U("W",["WW",2],"Wo","isoWeek"),M("week","w"),M("isoWeek","W"),se("w",$),se("ww",$,Y),se("W",$),se("WW",$,Y),le(["w","ww","W","WW"],(function(e,t,i,r){t[r.substr(0,1)]=v(e)})),U("DDD",["DDDD",3],"DDDo","dayOfYear"),M("dayOfYear","DDD"),se("DDD",K),se("DDDD",G),ae(["DDD","DDDD"],(function(e,t,i){i._dayOfYear=v(e)})),r.ISO_8601=function(){};var Oe=ge("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",(function(){var e=Ne.apply(null,arguments)
;return e<this?this:e})),Ve=ge("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",(function(){var e=Ne.apply(null,arguments);return e>this?this:e}));function Be(e,t){var i,r;if(1===t.length&&s(t[0])&&(t=t[0]),!t.length)return Ne();for(i=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](i)||(i=t[r]);return i}function Fe(e){var t=A(e),i=t.year||0,r=t.quarter||0,s=t.month||0,n=t.week||0,o=t.day||0,a=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._milliseconds=+u+1e3*c+6e4*l+36e5*a,this._days=+o+7*n,this._months=+s+3*r+12*i,this._data={},this._locale=I(),this._bubble()}function We(e){return e instanceof Fe}function Ue(e,t){U(e,0,0,(function(){var e=this.utcOffset(),i="+";return e<0&&(e=-e,i="-"),i+O(~~(e/60),2)+t+O(~~e%60,2)}))}Ue("Z",":"),Ue("ZZ",""),se("Z",te),se("ZZ",te),ae(["Z","ZZ"],(function(e,t,i){i._useUTC=!0,i._tzm=ze(e)}));var He=/([\+\-]|\d\d)/gi;function ze(e){var t=(e||"").match(te)||[],i=((t[t.length-1]||[])+"").match(He)||["-",0,0],r=60*i[1]+v(i[2]);return"+"===i[0]?r:-r}function je(e,t){var i,s;return t._isUTC?(i=t.clone(),s=(f(e)||n(e)?+e:+Ne(e))-+i,i._d.setTime(+i._d+s),r.updateOffset(i,!1),i):Ne(e).local()}function Ye(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Ge(){return this._isUTC&&0===this._offset}r.updateOffset=function(){};var qe=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Xe=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;function $e(e,t){var i,r,s,n,a,l,c=e,u=null;return We(e)?c={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(c={},t?c[t]=e:c.milliseconds=e):(u=qe.exec(e))?(i="-"===u[1]?-1:1,c={y:0,d:v(u[2])*i,h:v(u[3])*i,m:v(u[4])*i,s:v(u[5])*i,ms:v(u[6])*i}):(u=Xe.exec(e))?(i="-"===u[1]?-1:1,c={y:Ke(u[2],i),M:Ke(u[3],i),d:Ke(u[4],i),h:Ke(u[5],i),m:Ke(u[6],i),s:Ke(u[7],i),w:Ke(u[8],i)}):null==c?c={}:"object"==typeof c&&("from"in c||"to"in c)&&(n=Ne(c.from),a=je(a=Ne(c.to),n),n.isBefore(a)?l=Je(n,a):((l=Je(a,n)).milliseconds=-l.milliseconds,l.months=-l.months),(c={}).ms=(s=l).milliseconds,c.M=s.months),r=new Fe(c),We(e)&&o(e,"_locale")&&(r._locale=e._locale),r}function Ke(e,t){var i=e&&parseFloat(e.replace(",","."));return(isNaN(i)?0:i)*t}function Je(e,t){var i={milliseconds:0,months:0};return i.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+e.clone().add(i.months,"M"),i}function Ze(e,t){return function(i,r){var s;return null===r||isNaN(+r)||(function(e,t){ve[e]||(fe(t),ve[e]=!0)}(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),s=i,i=r,r=s),Qe(this,$e(i="string"==typeof i?+i:i,r),e),this}}function Qe(e,t,i,s){var n=t._milliseconds,o=t._days,a=t._months;s=null==s||s,n&&e._d.setTime(+e._d+n*i),o&&R(e,"Date",D(e,"Date")+o*i),a&&pe(e,D(e,"Month")+a*i),s&&r.updateOffset(e,o||a)}$e.fn=Fe.prototype;var et=Ze(1,"add"),tt=Ze(-1,"subtract");function it(){var e=this.clone().utc()
;return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():H(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):H(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function rt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=I(e))&&(this._locale=t),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var st=ge("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function nt(){return this._locale}function ot(e,t){U(0,[e,e.length],0,t)}function at(e,t,i){return Me(Ne([e,11,31+t-i]),t,i).week}U(0,["gg",2],0,(function(){return this.weekYear()%100})),U(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),ot("gggg","weekYear"),ot("ggggg","weekYear"),ot("GGGG","isoWeekYear"),ot("GGGGG","isoWeekYear"),M("weekYear","gg"),M("isoWeekYear","GG"),se("G",ee),se("g",ee),se("GG",$,Y),se("gg",$,Y),se("GGGG",J,q),se("gggg",J,q),se("GGGGG",Z,X),se("ggggg",Z,X),le(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,i,r){t[r.substr(0,2)]=v(e)})),le(["gg","GG"],(function(e,t,i,s){t[s]=r.parseTwoDigitYear(e)})),U("Q",0,0,"quarter"),M("quarter","Q"),se("Q",j),ae("Q",(function(e,t){t[1]=3*(v(e)-1)})),U("D",["DD",2],"Do","date"),M("date","D"),se("D",$),se("DD",$,Y),se("Do",(function(e,t){return e?t._ordinalParse:t._ordinalParseLenient})),ae(["D","DD"],2),ae("Do",(function(e,t){t[2]=v(e.match($)[0])}));var lt=k("Date",!0);U("d",0,"do","day"),U("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),U("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),U("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),U("e",0,0,"weekday"),U("E",0,0,"isoWeekday"),M("day","d"),M("weekday","e"),M("isoWeekday","E"),se("d",$),se("e",$),se("E",$),se("dd",ie),se("ddd",ie),se("dddd",ie),le(["dd","ddd","dddd"],(function(e,t,i){var r=i._locale.weekdaysParse(e);null!=r?t.d=r:c(i).invalidWeekday=e})),le(["d","e","E"],(function(e,t,i,r){t[r]=v(e)}));var ct="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),ut="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),dt="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function ht(e,t){U(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function pt(e,t){return t._meridiemParse}U("H",["HH",2],0,"hour"),U("h",["hh",2],0,(function(){return this.hours()%12||12})),ht("a",!0),ht("A",!1),M("hour","h"),se("a",pt),se("A",pt),se("H",$),se("h",$),se("HH",$,Y),se("hh",$,Y),ae(["H","HH"],3),ae(["a","A"],(function(e,t,i){i._isPm=i._locale.isPM(e),i._meridiem=e})),ae(["h","hh"],(function(e,t,i){t[3]=v(e),c(i).bigHour=!0}));var _t=k("Hours",!0);U("m",["mm",2],0,"minute"),M("minute","m"),se("m",$),se("mm",$,Y),ae(["m","mm"],4);var mt=k("Minutes",!1);U("s",["ss",2],0,"second"),M("second","s"),se("s",$),se("ss",$,Y),ae(["s","ss"],5);var ft,gt=k("Seconds",!1);for(U("S",0,0,(function(){return~~(this.millisecond()/100)})),U(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),
U(0,["SSS",3],0,"millisecond"),U(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),U(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),U(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),U(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),U(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),U(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),M("millisecond","ms"),se("S",K,j),se("SS",K,Y),se("SSS",K,G),ft="SSSS";ft.length<=9;ft+="S")se(ft,Q);function vt(e,t){t[6]=v(1e3*("0."+e))}for(ft="S";ft.length<=9;ft+="S")ae(ft,vt);var St=k("Milliseconds",!1);U("z",0,0,"zoneAbbr"),U("zz",0,0,"zoneName");var yt=m.prototype;yt.add=et,yt.calendar=function(e,t){var i=e||Ne(),r=je(i,this).startOf("day"),s=this.diff(r,"days",!0),n=s<-6?"sameElse":s<-1?"lastWeek":s<0?"lastDay":s<1?"sameDay":s<2?"nextDay":s<7?"nextWeek":"sameElse";return this.format(t&&t[n]||this.localeData().calendar(n,this,Ne(i)))},yt.clone=function(){return new m(this)},yt.diff=function(e,t,i){var r,s,n,o,a,l,c,u,d=je(e,this),h=6e4*(d.utcOffset()-this.utcOffset());return"year"===(t=E(t))||"month"===t||"quarter"===t?(n=this,c=12*((o=d).year()-n.year())+(o.month()-n.month()),u=n.clone().add(c,"months"),o-u<0?(a=n.clone().add(c-1,"months"),l=(o-u)/(u-a)):(a=n.clone().add(c+1,"months"),l=(o-u)/(a-u)),s=-(c+l),"quarter"===t?s/=3:"year"===t&&(s/=12)):(r=this-d,s="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?(r-h)/864e5:"week"===t?(r-h)/6048e5:r),i?s:g(s)},yt.endOf=function(e){return void 0===(e=E(e))||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")},yt.format=function(e){var t=H(this,e||r.defaultFormat);return this.localeData().postformat(t)},yt.from=function(e,t){return this.isValid()?$e({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},yt.fromNow=function(e){return this.from(Ne(),e)},yt.to=function(e,t){return this.isValid()?$e({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},yt.toNow=function(e){return this.to(Ne(),e)},yt.get=N,yt.invalidAt=function(){return c(this).overflow},yt.isAfter=function(e,t){return"millisecond"===(t=E(void 0!==t?t:"millisecond"))?+this>+(e=f(e)?e:Ne(e)):(f(e)?+e:+Ne(e))<+this.clone().startOf(t)},yt.isBefore=function(e,t){var i;return"millisecond"===(t=E(void 0!==t?t:"millisecond"))?+this<+(e=f(e)?e:Ne(e)):(i=f(e)?+e:+Ne(e),+this.clone().endOf(t)<i)},yt.isBetween=function(e,t,i){return this.isAfter(e,i)&&this.isBefore(t,i)},yt.isSame=function(e,t){var i;return"millisecond"===(t=E(t||"millisecond"))?+this==+(e=f(e)?e:Ne(e)):(i=+Ne(e),+this.clone().startOf(t)<=i&&i<=+this.clone().endOf(t))},yt.isValid=function(){return u(this)},yt.lang=st,yt.locale=rt,yt.localeData=nt,yt.max=Ve,yt.min=Oe,yt.parsingFlags=function(){return a({},c(this))},yt.set=N,yt.startOf=function(e){switch(e=E(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0)
;case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},yt.subtract=tt,yt.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},yt.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},yt.toDate=function(){return this._offset?new Date(+this):this._d},yt.toISOString=it,yt.toJSON=it,yt.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},yt.unix=function(){return Math.floor(+this/1e3)},yt.valueOf=function(){return+this._d-6e4*(this._offset||0)},yt.year=Le,yt.isLeapYear=function(){return Ie(this.year())},yt.weekYear=function(e){var t=Me(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")},yt.isoWeekYear=function(e){var t=Me(this,1,4).year;return null==e?t:this.add(e-t,"y")},yt.quarter=yt.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},yt.month=_e,yt.daysInMonth=function(){return ue(this.year(),this.month())},yt.week=yt.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},yt.isoWeek=yt.isoWeeks=function(e){var t=Me(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},yt.weeksInYear=function(){var e=this.localeData()._week;return at(this.year(),e.dow,e.doy)},yt.isoWeeksInYear=function(){return at(this.year(),1,4)},yt.date=lt,yt.day=yt.days=function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},yt.weekday=function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},yt.isoWeekday=function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},yt.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},yt.hour=yt.hours=_t,yt.minute=yt.minutes=mt,yt.second=yt.seconds=gt,yt.millisecond=yt.milliseconds=St,yt.utcOffset=function(e,t){var i,s=this._offset||0;return null!=e?("string"==typeof e&&(e=ze(e)),Math.abs(e)<16&&(e*=60),!this._isUTC&&t&&(i=Ye(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),s!==e&&(!t||this._changeInProgress?Qe(this,$e(e-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?s:Ye(this)},yt.utc=function(e){return this.utcOffset(0,e)},yt.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ye(this),"m")),this},yt.parseZone=function(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(ze(this._i)),this},yt.hasAlignedHourOffset=function(e){return e=e?Ne(e).utcOffset():0,
(this.utcOffset()-e)%60==0},yt.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},yt.isDSTShifted=function(){if(void 0!==this._isDSTShifted)return this._isDSTShifted;var e={};if(p(e,this),(e=De(e))._a){var t=e._isUTC?l(e._a):Ne(e._a);this._isDSTShifted=this.isValid()&&S(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted},yt.isLocal=function(){return!this._isUTC},yt.isUtcOffset=function(){return this._isUTC},yt.isUtc=Ge,yt.isUTC=Ge,yt.zoneAbbr=function(){return this._isUTC?"UTC":""},yt.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},yt.dates=ge("dates accessor is deprecated. Use date instead.",lt),yt.months=ge("months accessor is deprecated. Use month instead",_e),yt.years=ge("years accessor is deprecated. Use year instead",Le),yt.zone=ge("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",(function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}));var bt=yt;function wt(e){return e}var Pt=y.prototype;function Ct(e,t,i,r){var s=I(),n=l().set(r,t);return s[i](n,e)}function Tt(e,t,i,r,s){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return Ct(e,t,i,s);var n,o=[];for(n=0;n<r;n++)o[n]=Ct(e,n,i,s);return o}Pt._calendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Pt.calendar=function(e,t,i){var r=this._calendar[e];return"function"==typeof r?r.call(t,i):r},Pt._longDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Pt.longDateFormat=function(e){var t=this._longDateFormat[e],i=this._longDateFormat[e.toUpperCase()];return t||!i?t:(this._longDateFormat[e]=i.replace(/MMMM|MM|DD|dddd/g,(function(e){return e.slice(1)})),this._longDateFormat[e])},Pt._invalidDate="Invalid date",Pt.invalidDate=function(){return this._invalidDate},Pt._ordinal="%d",Pt.ordinal=function(e){return this._ordinal.replace("%d",e)},Pt._ordinalParse=/\d{1,2}/,Pt.preparse=wt,Pt.postformat=wt,Pt._relativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Pt.relativeTime=function(e,t,i,r){var s=this._relativeTime[i];return"function"==typeof s?s(e,t,i,r):s.replace(/%d/i,e)},Pt.pastFuture=function(e,t){var i=this._relativeTime[e>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)},Pt.set=function(e){var t,i;for(i in e)"function"==typeof(t=e[i])?this[i]=t:this["_"+i]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},Pt.months=function(e){return this._months[e.month()]},Pt._months=de,Pt.monthsShort=function(e){return this._monthsShort[e.month()]},Pt._monthsShort=he,Pt.monthsParse=function(e,t,i){var r,s,n;for(this._monthsParse||(this._monthsParse=[],
this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(s=l([2e3,r]),i&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),i||this._monthsParse[r]||(n="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[r]=new RegExp(n.replace(".",""),"i")),i&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(i&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!i&&this._monthsParse[r].test(e))return r}},Pt.week=function(e){return Me(e,this._week.dow,this._week.doy).week},Pt._week={dow:0,doy:6},Pt.firstDayOfYear=function(){return this._week.doy},Pt.firstDayOfWeek=function(){return this._week.dow},Pt.weekdays=function(e){return this._weekdays[e.day()]},Pt._weekdays=ct,Pt.weekdaysMin=function(e){return this._weekdaysMin[e.day()]},Pt._weekdaysMin=dt,Pt.weekdaysShort=function(e){return this._weekdaysShort[e.day()]},Pt._weekdaysShort=ut,Pt.weekdaysParse=function(e){var t,i,r;for(this._weekdaysParse=this._weekdaysParse||[],t=0;t<7;t++)if(this._weekdaysParse[t]||(i=Ne([2e3,1]).day(t),r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(r.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},Pt.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},Pt._meridiemParse=/[ap]\.?m?\.?/i,Pt.meridiem=function(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"},T("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===v(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),r.lang=ge("moment.lang is deprecated. Use moment.locale instead.",T),r.langData=ge("moment.langData is deprecated. Use moment.localeData instead.",I);var xt=Math.abs;function It(e,t,i,r){var s=$e(t,i);return e._milliseconds+=r*s._milliseconds,e._days+=r*s._days,e._months+=r*s._months,e._bubble()}function Lt(e){return e<0?Math.floor(e):Math.ceil(e)}function Mt(e){return 4800*e/146097}function Et(e){return 146097*e/4800}function At(e){return function(){return this.as(e)}}var kt=At("ms"),Dt=At("s"),Rt=At("m"),Nt=At("h"),Ot=At("d"),Vt=At("w"),Bt=At("M"),Ft=At("y");function Wt(e){return function(){return this._data[e]}}var Ut=Wt("milliseconds"),Ht=Wt("seconds"),zt=Wt("minutes"),jt=Wt("hours"),Yt=Wt("days"),Gt=Wt("months"),qt=Wt("years"),Xt=Math.round,$t={s:45,m:45,h:22,d:26,M:11};function Kt(e,t,i,r,s){return s.relativeTime(t||1,!!i,e,r)}var Jt=Math.abs;function Zt(){var e,t,i=Jt(this._milliseconds)/1e3,r=Jt(this._days),s=Jt(this._months);e=g(i/60),t=g(e/60),i%=60,e%=60;var n=g(s/12),o=s%=12,a=r,l=t,c=e,u=i,d=this.asSeconds();return d?(d<0?"-":"")+"P"+(n?n+"Y":"")+(o?o+"M":"")+(a?a+"D":"")+(l||c||u?"T":"")+(l?l+"H":"")+(c?c+"M":"")+(u?u+"S":""):"P0D"}var Qt=Fe.prototype;return Qt.abs=function(){var e=this._data;return this._milliseconds=xt(this._milliseconds),this._days=xt(this._days),this._months=xt(this._months),e.milliseconds=xt(e.milliseconds),e.seconds=xt(e.seconds),
e.minutes=xt(e.minutes),e.hours=xt(e.hours),e.months=xt(e.months),e.years=xt(e.years),this},Qt.add=function(e,t){return It(this,e,t,1)},Qt.subtract=function(e,t){return It(this,e,t,-1)},Qt.as=function(e){var t,i,r=this._milliseconds;if("month"===(e=E(e))||"year"===e)return t=this._days+r/864e5,i=this._months+Mt(t),"month"===e?i:i/12;switch(t=this._days+Math.round(Et(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}},Qt.asMilliseconds=kt,Qt.asSeconds=Dt,Qt.asMinutes=Rt,Qt.asHours=Nt,Qt.asDays=Ot,Qt.asWeeks=Vt,Qt.asMonths=Bt,Qt.asYears=Ft,Qt.valueOf=function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*v(this._months/12)},Qt._bubble=function(){var e,t,i,r,s,n=this._milliseconds,o=this._days,a=this._months,l=this._data;return n>=0&&o>=0&&a>=0||n<=0&&o<=0&&a<=0||(n+=864e5*Lt(Et(a)+o),o=0,a=0),l.milliseconds=n%1e3,e=g(n/1e3),l.seconds=e%60,t=g(e/60),l.minutes=t%60,i=g(t/60),l.hours=i%24,o+=g(i/24),s=g(Mt(o)),a+=s,o-=Lt(Et(s)),r=g(a/12),a%=12,l.days=o,l.months=a,l.years=r,this},Qt.get=function(e){return this[(e=E(e))+"s"]()},Qt.milliseconds=Ut,Qt.seconds=Ht,Qt.minutes=zt,Qt.hours=jt,Qt.days=Yt,Qt.weeks=function(){return g(this.days()/7)},Qt.months=Gt,Qt.years=qt,Qt.humanize=function(e){var t=this.localeData(),i=function(e,t,i){var r=$e(e).abs(),s=Xt(r.as("s")),n=Xt(r.as("m")),o=Xt(r.as("h")),a=Xt(r.as("d")),l=Xt(r.as("M")),c=Xt(r.as("y")),u=s<$t.s&&["s",s]||1===n&&["m"]||n<$t.m&&["mm",n]||1===o&&["h"]||o<$t.h&&["hh",o]||1===a&&["d"]||a<$t.d&&["dd",a]||1===l&&["M"]||l<$t.M&&["MM",l]||1===c&&["y"]||["yy",c];return u[2]=t,u[3]=+e>0,u[4]=i,Kt.apply(null,u)}(this,!e,t);return e&&(i=t.pastFuture(+this,i)),t.postformat(i)},Qt.toISOString=Zt,Qt.toString=Zt,Qt.toJSON=Zt,Qt.locale=rt,Qt.localeData=nt,Qt.toIsoString=ge("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Zt),Qt.lang=st,U("X",0,0,"unix"),U("x",0,0,"valueOf"),se("x",ee),se("X",/[+-]?\d+(\.\d{1,3})?/),ae("X",(function(e,t,i){i._d=new Date(1e3*parseFloat(e,10))})),ae("x",(function(e,t,i){i._d=new Date(v(e))})),r.version="2.10.6",t=Ne,r.fn=bt,r.min=function(){var e=[].slice.call(arguments,0);return Be("isBefore",e)},r.max=function(){var e=[].slice.call(arguments,0);return Be("isAfter",e)},r.utc=l,r.unix=function(e){return Ne(1e3*e)},r.months=function(e,t){return Tt(e,t,"months",12,"month")},r.isDate=n,r.locale=T,r.invalid=d,r.duration=$e,r.isMoment=f,r.weekdays=function(e,t){return Tt(e,t,"weekdays",7,"day")},r.parseZone=function(){return Ne.apply(null,arguments).parseZone()},r.localeData=I,r.isDuration=We,r.monthsShort=function(e,t){return Tt(e,t,"monthsShort",12,"month")},r.weekdaysMin=function(e,t){return Tt(e,t,"weekdaysMin",7,"day")},r.defineLocale=x,r.weekdaysShort=function(e,t){return Tt(e,t,"weekdaysShort",7,"day")},r.normalizeUnits=E,r.relativeTimeThreshold=function(e,t){
return void 0!==$t[e]&&(void 0===t?$t[e]:($t[e]=t,!0))},r}()},53363:(e,t,i)=>{var r=i(55375),s=i(48994),n=i(62378),o=new Uint32Array([3432918353,461845907]);function a(e,t){return e<<t|e>>>32-t}e.exports=function(e,t){if(t=t?0|t:0,"string"==typeof e&&(e=n(e)),!(e instanceof ArrayBuffer))throw new TypeError("Expected key to be ArrayBuffer or string");var i=new Uint32Array([t]);return function(e,t){for(var i=e.byteLength/4|0,s=new Uint32Array(e,0,i),n=0;n<i;n++)s[n]=r(s[n],o[0]),s[n]=a(s[n],15),s[n]=r(s[n],o[1]),t[0]=t[0]^s[n],t[0]=a(t[0],13),t[0]=r(t[0],5)+3864292196}(e,i),function(e,t){var i=e.byteLength/4|0,s=e.byteLength%4,n=0,l=new Uint8Array(e,4*i,s);switch(s){case 3:n^=l[2]<<16;case 2:n^=l[1]<<8;case 1:n^=l[0]<<0,n=a(n=r(n,o[0]),15),n=r(n,o[1]),t[0]=t[0]^n}}(e,i),function(e,t){t[0]=t[0]^e.byteLength,t[0]=s(t[0])}(e,i),i.buffer}},46417:(e,t)=>{"use strict";var i,r=!("undefined"==typeof window||!window.document||!window.document.createElement);function s(){if(i)return i;if(!r||!window.document.body)return"indeterminate";var e=window.document.createElement("div");return e.appendChild(document.createTextNode("ABCD")),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",document.body.appendChild(e),i="reverse",e.scrollLeft>0?i="default":(e.scrollLeft=1,0===e.scrollLeft&&(i="negative")),document.body.removeChild(e),i}t.detectScrollType=s,t.getNormalizedScrollLeft=function(e,t){var i=e.scrollLeft;if("rtl"!==t)return i;var r=s();if("indeterminate"===r)return Number.NaN;switch(r){case"negative":return e.scrollWidth-e.clientWidth+i;case"reverse":return e.scrollWidth-e.clientWidth-i}return i},t.setNormalizedScrollLeft=function(e,t,i){if("rtl"===i){var r=s();if("indeterminate"!==r)switch(r){case"negative":e.scrollLeft=e.clientWidth-e.scrollWidth+t;break;case"reverse":e.scrollLeft=e.scrollWidth-e.clientWidth-t;break;default:e.scrollLeft=t}}else e.scrollLeft=t}},27418:e=>{"use strict";var t=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function s(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,n){for(var o,a,l=s(e),c=1;c<arguments.length;c++){for(var u in o=Object(arguments[c]))i.call(o,u)&&(l[u]=o[u]);if(t){a=t(o);for(var d=0;d<a.length;d++)r.call(o,a[d])&&(l[a[d]]=o[a[d]])}}return l}},93669:(e,t,i)=>{"use strict";i.r(t),i.d(t,{colorsPalette:()=>u,getHexColorByName:()=>d})
;const r=JSON.parse('{"color-white":"#ffffff","color-black":"#000000","color-cold-gray-50":"#F8F9FD","color-cold-gray-100":"#F0F3FA","color-cold-gray-150":"#E0E3EB","color-cold-gray-200":"#D1D4DC","color-cold-gray-250":"#C1C4CD","color-cold-gray-300":"#B2B5BE","color-cold-gray-350":"#A3A6AF","color-cold-gray-400":"#9598A1","color-cold-gray-450":"#868993","color-cold-gray-500":"#787B86","color-cold-gray-550":"#6A6D78","color-cold-gray-600":"#5D606B","color-cold-gray-650":"#50535E","color-cold-gray-700":"#434651","color-cold-gray-750":"#363A45","color-cold-gray-800":"#2A2E39","color-cold-gray-850":"#1E222D","color-cold-gray-900":"#131722","color-cold-gray-950":"#0C0E15","color-ripe-red-50":"#FFEBEC","color-ripe-red-100":"#FCCBCD","color-ripe-red-200":"#FAA1A4","color-ripe-red-300":"#F77C80","color-ripe-red-400":"#F7525F","color-ripe-red-500":"#F23645","color-ripe-red-600":"#CC2F3C","color-ripe-red-700":"#B22833","color-ripe-red-800":"#991F29","color-ripe-red-900":"#801922","color-ripe-red-a100":"#FF8080","color-ripe-red-a200":"#FF5252","color-ripe-red-a400":"#FF3333","color-ripe-red-a600":"#CC2929","color-ripe-red-a700":"#802028","color-ripe-red-a800":"#4D191D","color-ripe-red-a900":"#331F20","color-tan-orange-50":"#FFF3E0","color-tan-orange-100":"#FFE0B2","color-tan-orange-200":"#FFCC80","color-tan-orange-300":"#ffb74d","color-tan-orange-400":"#FFA726","color-tan-orange-500":"#FF9800","color-tan-orange-600":"#FB8C00","color-tan-orange-700":"#F57C00","color-tan-orange-800":"#EF6C00","color-tan-orange-900":"#e65100","color-tan-orange-a200":"#ffab40","color-tan-orange-a400":"#ff9100","color-tan-orange-a700":"#FF6D00","color-iguana-green-100":"#C8E6C9","color-iguana-green-200":"#A5D6A7","color-iguana-green-300":"#81c784","color-iguana-green-400":"#66BB6A","color-iguana-green-500":"#4caf50","color-iguana-green-600":"#43a047","color-iguana-green-700":"#388e3c","color-iguana-green-800":"#2E7D32","color-iguana-green-900":"#1B5E20","color-iguana-green-a700":"#00c853","color-banana-yellow-100":"#FFF9C4","color-banana-yellow-200":"#FFF59D","color-banana-yellow-300":"#FFF176","color-banana-yellow-400":"#ffee58","color-banana-yellow-500":"#ffeb3b","color-banana-yellow-600":"#fdd835","color-banana-yellow-700":"#fbc02d","color-banana-yellow-800":"#f9a825","color-banana-yellow-900":"#F57F17","color-banana-yellow-a400":"#ffea00","color-banana-yellow-a700":"#ffd600","color-tv-blue-50":"#E3EFFD","color-tv-blue-100":"#BBD9FB","color-tv-blue-200":"#90BFF9","color-tv-blue-300":"#5B9CF6","color-tv-blue-400":"#3179F5","color-tv-blue-500":"#2962FF","color-tv-blue-600":"#1E53E5","color-tv-blue-700":"#1848CC","color-tv-blue-800":"#143EB3","color-tv-blue-900":"#0C3299","color-tv-blue-a100":"#82b1ff","color-tv-blue-a200":"#448aff","color-tv-blue-a400":"#2979ff","color-tv-blue-a600":"#2962FF","color-tv-blue-a700":"#143A87","color-tv-blue-a800":"#142E61","color-tv-blue-a900":"#132042","color-deep-blue-100":"#D1C4E9","color-deep-blue-200":"#B39DDB","color-deep-blue-300":"#9575cd","color-deep-blue-400":"#7e57c2","color-deep-blue-500":"#673ab7","color-deep-blue-700":"#512da8","color-deep-blue-800":"#4527A0","color-deep-blue-900":"#311B92","color-deep-blue-a100":"#b388ff","color-deep-blue-a400":"#651FFF","color-deep-blue-a700":"#6200EA","color-minty-green-50":"#DAF2EE","color-minty-green-100":"#ACE5DC","color-minty-green-200":"#70CCBD","color-minty-green-300":"#42BDA8","color-minty-green-400":"#22AB94","color-minty-green-500":"#089981","color-minty-green-600":"#06806B","color-minty-green-700":"#056656","color-minty-green-800":"#004D40","color-minty-green-900":"#00332A","color-minty-green-a400":"#2BD9BC","color-minty-green-a700":"#24B29B","color-minty-green-a900":"#082621","color-grapes-purple-50":"#F3E5F5","color-grapes-purple-100":"#E1BEE7","color-grapes-purple-200":"#CE93D8","color-grapes-purple-300":"#ba68c8","color-grapes-purple-400":"#ab47bc","color-grapes-purple-500":"#9c27b0","color-grapes-purple-600":"#8e24aa","color-grapes-purple-700":"#7b1fa2","color-grapes-purple-800":"#6A1B9A","color-grapes-purple-900":"#4A148C","color-grapes-purple-a200":"#E040FB","color-grapes-purple-a400":"#D500F9","color-grapes-purple-a700":"#aa00ff","color-berry-pink-100":"#F8BBD0","color-berry-pink-200":"#f48fb1","color-berry-pink-300":"#f06292","color-berry-pink-400":"#ec407a","color-berry-pink-500":"#e91e63","color-berry-pink-600":"#D81B60","color-berry-pink-700":"#C2185B","color-berry-pink-800":"#AD1457","color-berry-pink-900":"#880E4F","color-berry-pink-a100":"#ff80ab","color-berry-pink-a200":"#ff4081","color-sky-blue-100":"#B2EBF2","color-sky-blue-200":"#80DEEA","color-sky-blue-300":"#4dd0e1","color-sky-blue-400":"#26c6da","color-sky-blue-500":"#00bcd4","color-sky-blue-600":"#00acc1","color-sky-blue-700":"#0097A7","color-sky-blue-800":"#00838F","color-sky-blue-900":"#006064","color-sky-blue-a400":"#00e5ff","color-sky-blue-a700":"#00B8D4","color-deep-blue-600":"#5E35B1","color-facebook":"#1877F2","color-deep-facebook":"#1564CA","color-twitter":"#1DA1F2","color-deep-twitter":"#188CD3","color-youtube":"#FF0000","color-linkedin":"#007BB5","color-aqua-spring":"#ebf9f5","color-army-green":"#3d2c12","color-army-green-2":"#31230d","color-athens-gray-1":"#f2f3f5","color-athens-gray-2":"#f7f8fa","color-athens-gray-3":"#eceff2","color-black-180":"#b4b4b4","color-blue-dianne":"#21384d","color-bluish":"#2185cc","color-bright-gray":"#363c4e","color-brownish-grey":"#8d6e63","color-carnation":"#f04561","color-catskill-white":"#e1ecf2","color-charade":"#2f3241","color-charcoal-grey":"#323337","color-curious-blue":"#299dcd","color-dark-blue-grey":"#123440","color-darkness-blue-grey":"#12213b","color-dark-grey":"#292a2d","color-dark-grey-blue":"#28415a","color-dark-sky-blue":"#37a6ef","color-deep-sea-blue":"#016087","color-ebony-clay":"#262b3e","color-foam":"#d7f0fb","color-gull-gray":"#9db2bd","color-humming-bird":"#d3eef9","color-keppel-1":"#37bc9b","color-keppel-2":"#34b293","color-lavender-blush":"#ffedf0","color-lightish-purple":"#a75ee8","color-loblolly":"#c5cbce","color-manatee":"#878ca8","color-mandy":"#eb4d5c","color-medium-blue":"#2e7bb2","color-milk-chocolate":"#6f2626","color-mirage-1":"#131722","color-mirage-2":"#171b29","color-mirage-3":"#1c2030","color-mischka":"#d6d8e0","color-morning-glory":"#9addcc","color-oslo-gray":"#8b8e95","color-pale":"#fff2cf","color-pale-grey-1":"#f9fafb","color-pale-grey-2":"#e7ebee","color-pale-sky":"#6b7988","color-picton-blue-1":"#3bb3e4","color-puerto-rico":"#3bc2a1","color-purple-brown":"#4e2934","color-purple-brown-2":"#3d2028","color-radical-red":"#ff4a68","color-regent-gray":"#8797a5","color-scooter":"#38acdb","color-silver-tree":"#53b987","color-slate-gray":"#758696","color-sundown":"#ffa4b3","color-sunglow":"#ffca3b","color-tan-hide":"#ff9850","color-trout-1":"#4c525e","color-trout-2":"#4f5966","color-violet-1":"#332738","color-violet-2":"#271d2b","color-white-ice":"#ebf7fc","color-wild-watermelon":"#ff5773","color-readonly-input":"#b4b4b4","color-brand-dark":"#2a2c39","color-seeking-alpha-brand":"#ff7200"}'),s=JSON.parse('{"color-bg-primary":"color-white","color-bg-primary-hover":"color-cold-gray-100","color-bg-secondary":"color-white","color-bg-highlight":"color-cold-gray-50","color-bg-scroll-buttons":"color-cold-gray-100","color-legacy-bg-scroll-buttons":"color-cold-gray-850","color-legacy-bg-widget":"color-white","color-text-primary":"color-cold-gray-900","color-text-secondary":"color-cold-gray-500","color-text-tertiary":"color-cold-gray-400","color-text-disabled":"color-cold-gray-300","color-accent-content":"color-cold-gray-900","color-box-shadow":"color-cold-gray-300","color-divider":"color-cold-gray-150","color-divider-hover":"color-cold-gray-100","color-divider-secondary":"color-cold-gray-100","color-active-hover-text":"color-cold-gray-900","color-alert-text":"color-cold-gray-900","color-border-table":"color-cold-gray-100","color-brand":"color-tv-blue-500","color-brand-active":"color-tv-blue-700","color-brand-hover":"color-tv-blue-600","color-chart-page-bg":"color-cold-gray-150","color-common-tooltip-bg":"color-cold-gray-800","color-danger":"color-ripe-red-400","color-danger-hover":"color-ripe-red-500","color-danger-active":"color-ripe-red-600","color-depthrenderer-stroke-style":"color-cold-gray-100","color-highlight-new":"color-tan-orange-50","color-input-bg":"color-white","color-input-publish-bg":"color-white","color-link":"color-tv-blue-500","color-link-hover":"color-tv-blue-600","color-link-active":"color-tv-blue-700","color-list-nth-child-bg":"color-cold-gray-50","color-pane-bg":"color-white","color-pane-secondary-bg":"color-cold-gray-100","color-popup-menu-item-hover-bg":"color-cold-gray-100","color-popup-menu-separator":"color-cold-gray-150","color-screener-description":"color-cold-gray-650","color-success":"color-minty-green-500","color-success-hover":"color-minty-green-600","color-success-active":"color-minty-green-700","color-toolbar-button-text":"color-cold-gray-900","color-toolbar-button-text-hover":"color-cold-gray-900","color-toolbar-button-text-active":"color-tv-blue-500","color-toolbar-button-text-active-hover":"color-tv-blue-600","color-toolbar-button-background-hover":"color-cold-gray-100","color-toolbar-button-background-secondary-hover":"color-cold-gray-150","color-toolbar-toggle-button-background-active":"color-tv-blue-500","color-toolbar-toggle-button-background-active-hover":"color-tv-blue-600","color-toolbar-interactive-element-text-normal":"color-cold-gray-900","color-toolbar-interactive-element-text-hover":"color-cold-gray-900","color-toolbar-opened-element-bg":"color-cold-gray-100","color-tooltip-bg":"color-cold-gray-800","color-tv-dialog-caption":"color-cold-gray-650","color-tv-dropdown-item-hover-bg":"color-cold-gray-100","color-underlined-text":"color-cold-gray-500","color-widget-pages-bg":"color-white","color-warning":"color-tan-orange-500","color-growing":"color-minty-green-400","color-falling":"color-ripe-red-400","color-forex-icon":"color-cold-gray-750","color-list-item-active-bg":"color-tv-blue-400","color-list-item-hover-bg":"color-tv-blue-50","color-list-item-text":"color-cold-gray-800","color-price-axis-label-back":"color-cold-gray-150","color-price-axis-label-text":"color-cold-gray-650","color-price-axis-gear":"color-cold-gray-900","color-price-axis-gear-hover":"color-black","color-price-axis-highlight":"color-cold-gray-150","color-bid":"color-tv-blue-500","color-border":"color-cold-gray-150","color-border-chat-fields":"color-cold-gray-250","color-border-hover":"color-cold-gray-250","color-button-hover-bg":"color-cold-gray-150","color-depthrenderer-fill-style":"color-cold-gray-650","color-disabled-border-and-color":"color-cold-gray-150","color-disabled-input":"color-cold-gray-150","color-empty-container-message":"color-cold-gray-500","color-icons":"color-cold-gray-500","color-input-textarea-readonly":"color-cold-gray-650","color-input-placeholder-text":"color-cold-gray-350","color-item-active-blue":"color-tv-blue-50","color-item-hover-active-bg":"color-tv-blue-100","color-item-hover-bg":"color-tv-blue-100","color-item-hover-blue":"color-tv-blue-100","color-item-selected-blue":"color-tv-blue-50","color-item-active-text":"color-white","color-item-active-bg":"color-tv-blue-500","color-list-item":"color-cold-gray-450","color-news-highlight":"color-tv-blue-100","color-placeholder":"color-cold-gray-350","color-row-hover-active-bg":"color-cold-gray-100","color-sb-scrollbar-body-bg":"color-cold-gray-200","color-section-separator-border":"color-cold-gray-300","color-separator-table-chat":"color-cold-gray-150","color-tag-active-bg":"color-cold-gray-200","color-tag-hover-bg":"color-cold-gray-150","color-text-regular":"color-cold-gray-700","color-tv-button-checked":"color-cold-gray-550","color-scroll-bg":"color-cold-gray-400","color-scroll-border":"color-cold-gray-100","color-widget-border":"color-cold-gray-100","color-scroll-buttons-arrow":"color-white","color-control-intent-default":"color-cold-gray-200","color-control-intent-success":"color-minty-green-600","color-control-intent-primary":"color-tv-blue-500","color-control-intent-warning":"color-tan-orange-500","color-control-intent-danger":"color-ripe-red-500","color-pre-market":"color-tan-orange-600","color-pre-market-bg":"color-tan-orange-400","color-post-market":"color-tv-blue-500","color-post-market-bg":"color-tv-blue-400","color-market-open":"color-minty-green-500","color-market-open-bg":"color-minty-green-400","color-market-closed":"color-cold-gray-400","color-market-holiday":"color-cold-gray-400","color-invalid-symbol":"color-ripe-red-400","color-invalid-symbol-hover":"color-ripe-red-700","color-replay-mode":"color-tv-blue-500","color-replay-mode-icon":"color-white","color-replay-mode-hover":"color-tv-blue-600","color-notaccurate-mode":"color-berry-pink-700","color-notaccurate-mode-bg":"color-berry-pink-400","color-delay-mode":"color-tan-orange-700","color-delay-mode-bg":"color-tan-orange-400","color-eod-mode":"color-grapes-purple-700","color-eod-mode-bg":"color-grapes-purple-400","color-data-problem":"color-ripe-red-600","color-data-problem-bg":"color-ripe-red-400","color-data-problem-hover":"color-ripe-red-700","color-list-item-bg-highlighted":"color-tv-blue-50","color-list-item-bg-selected":"color-tv-blue-100","color-list-item-bg-highlighted-hover":"color-tv-blue-100","color-list-item-bg-selected-hover":"color-tv-blue-200","color-screener-header-bg":"color-white","color-screener-header-bg-hover":"color-cold-gray-100","color-marker-flagged":"color-ripe-red-400","color-marker-flagged-hovered":"color-ripe-red-600","color-ask":"color-ripe-red-400","color-sell":"color-ripe-red-400","color-buy":"color-tv-blue-500","color-neutral":"color-cold-gray-500","color-pro":"color-minty-green-400","color-pro-hover":"color-minty-green-600","color-pro-plus":"color-tv-blue-500","color-pro-plus-hover":"color-tv-blue-600","color-pro-premium":"color-tan-orange-500","color-pro-premium-hover":"color-tan-orange-700","color-trial":"color-cold-gray-500","color-trial-hover":"color-cold-gray-600","color-mod":"color-ripe-red-400","color-mod-hover":"color-ripe-red-600","color-top":"color-banana-yellow-700","color-top-hover":"color-banana-yellow-800","color-ad":"color-banana-yellow-a700","color-broker-featured":"color-minty-green-400","color-broker-featured-hover":"color-minty-green-600","color-alert-status-active":"color-minty-green-400","color-alert-status-stopped":"color-ripe-red-500","color-alert-status-triggered":"color-tan-orange-500","color-covid19-confirmed":"color-ripe-red-500","color-covid19-recovered":"color-minty-green-500","color-covid19-deaths":"color-cold-gray-450","color-overlay":"color-cold-gray-400","color-search-button-hover":"color-cold-gray-150","color-brand-light":"color-tv-blue-500","color-common-tooltip-text":"color-cold-gray-100","color-replay-data-mode":"color-radical-red","color-legacy-success":"color-keppel-1","color-collapse-tabs-border":"color-athens-gray-3","color-site-widget-hover":"color-athens-gray-1","color-attention":"color-sunglow","color-card-border":"color-cold-gray-150","color-card-border-hover":"color-cold-gray-300","color-background-special-primary":"color-white","color-stroke-special-primary":"color-cold-gray-150","color-selection-bg":"color-tv-blue-100"}')
;var n=i(16282);const o={...r,...s},a={},l=Object.keys(o).length,c=/^#[0-9A-F]{6}$/i;Object.keys(o).forEach(e=>{const t=function e(t,i=[]){const r=o[t];if(!r)return null;if(c.test(r))return r;const s=r;return i.push(t),-1!==i.indexOf(s)?(console.warn("Colors definitions cycled"),r):i.length>l?(console.warn("Too many variables-link in HEX-color search: "+i[0]),null):e(s,i)}(e);a[e]=(0,n.ensureNotNull)(t)});const u=a;function d(e){const t=u[e];if(!t)throw new Error("No such color "+e);return t}},69388:(e,t,i)=>{"use strict";i.d(t,{dur:()=>r,easingFunc:()=>s,CubicBezier:()=>n,color:()=>o});const r=350,s={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e*e:(4-2*e)*e-1,easeInCubic:e=>e*e*e,easeOutCubic:e=>--e*e*e+1,easeInOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1- --e*e*e*e,easeInOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1+--e*e*e*e*e,easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e};class n{constructor(e,t,i,r){this._mX1=e,this._mY1=t,this._mX2=i,this._mY2=r}easingFunc(e){return this._mX1===this._mY1&&this._mX2===this._mY2?e:this._calcBezier(this._getTForX(e))}_a(e,t){return 1-3*t+3*e}_b(e,t){return 3*t-6*e}_c(e){return 3*e}_calcBezier(e){return((this._a(this._mY1,this._mY2)*e+this._b(this._mY1,this._mY2))*e+this._c(this._mY1))*e}_getSlope(e){return 3*this._a(this._mX1,this._mX2)*e*e+2*this._b(this._mX1,this._mX2)*e+this._c(this._mX1)}_getTForX(e){let t=e;for(let i=0;i<4;++i){const i=this._getSlope(t);if(0===i)return t;t-=(this._calcBezier(t)-e)/i}return t}}const o={black70:"#4A4A4A",black80:"#535353"}},40539:(e,t,i)=>{"use strict";i.d(t,{Icon:()=>s});var r=i(67294);const s=r.forwardRef((e,t)=>{const{icon:i="",...s}=e;return r.createElement("span",{...s,ref:t,dangerouslySetInnerHTML:{__html:i}})})},74888:(e,t,i)=>{"use strict";var r;i.d(t,{ToastIntent:()=>r}),function(e){e.Default="default",e.Success="success",e.Warning="warning",e.Danger="danger"}(r||(r={}))},85139:(e,t,i)=>{"use strict";i.d(t,{makeCancelable:()=>s,isCancelled:()=>n});class r{}function s(e){let t=!1;return{promise:new Promise((i,s)=>{e.then(e=>t?s(new r):i(e)),e.catch(e=>s(t?new r:e))}),cancel(){t=!0}}}function n(e){return e instanceof r}},6802:(e,t,i)=>{"use strict";i.d(t,{setupChartEventHint:()=>d});var r=i(16282),s=i(20220),n=i(42098),o=i(14397),a=i(32719),l=i(68724),c=i(11877),u=i(22842);function d(e,t=!1){if(!u.enabled("popup_hints"))return;const d=e.getContainer();let h=null,p=null;function _(e,t,s){if(h)h.show(e,s?void 0:m.bind(null,t));else{const n=o.tool.value();Promise.all([i.e(69756),i.e(6884),i.e(73935),i.e(26166)]).then(i.bind(i,90049)).then(i=>{h=new i.ChartEventHintRenderer((0,r.ensureNotNull)(d)),n===o.tool.value()&&h.show(e,s?void 0:m.bind(null,t))})}}function m(e){n.setValue(e,!0,{forceFlush:!0}),(0,r.ensureNotNull)(h).destroy(),null!==p&&p(),h=null}o.tool.subscribe((function(){if(Boolean(n.getBool("hint.touchPainting")))return;const e=o.tool.value();(0,
a.isStudyLineToolName)(e)&&"LineToolRegressionTrend"!==e&&!l.CheckMobile.any()?_((0,s.t)("Click to set a point"),"hint.touchPainting"):l.CheckMobile.any()&&!(0,a.isLineDrawnWithPressedButton)(e)&&(0,a.isLineToolName)(e)?_((0,s.t)("Move the point to position the anchor then tap to place"),"hint.touchPainting"):h&&h.hide()})),o.createdLineTool.subscribe(null,(function(){const e=o.tool.value();"LineToolPath"!==e||Boolean(n.getBool("hint.finishBuildPathByDblClick"))?"LineToolPolyline"!==e||Boolean(n.getBool("hint.finishBuildPolylineByDblClick"))||_((0,s.t)("Double-click to finish Polyline"),"hint.finishBuildPolylineByDblClick"):_((0,s.t)("Double-click to finish Path"),"hint.finishBuildPathByDblClick")})),o.finishedLineTool.subscribe(null,(function(){if(h){const e=o.tool.value();"LineToolPath"===e?m("hint.finishBuildPathByDblClick"):"LineToolPolyline"===e&&m("hint.finishBuildPolylineByDblClick")}})),t||l.CheckMobile.any()||Boolean(n.getBool("hint.startFocusedZoom"))||(p=function(e,t){let i=!1;const r=s=>{s?(i&&t(s),e.onZoom().unsubscribe(null,r)):i||(t(s),i=!0)};return e.onZoom().subscribe(null,r),()=>e.onZoom().unsubscribe(null,r)}(e,(function(e){if(Boolean(n.getBool("hint.startFocusedZoom")))return;if(e)h&&(p=null,m("hint.startFocusedZoom"));else{const e=c.isMacKeyboard?"⌘":"Ctrl";_((0,s.t)("Press and hold {key} while zooming to maintain the chart position").format({key:e}),"hint.startFocusedZoom")}})))}},19225:(e,t,i)=>{"use strict";i.d(t,{setupChartScreenshotHint:()=>o});var r=i(20220),s=i(88001),n=i(16282);function o(e,t){const o=(0,r.t)("Link to the chart image copied to clipboard {emoji}").format({emoji:"👍"}),a=(0,r.t)("Chart image copied to clipboard {emoji}").format({emoji:"👍"});s.on("onServerScreenshotCopiedToClipboard",()=>u(o),null),s.on("onClientScreenshotCopiedToClipboard",()=>u(a),null);let l=null;const c=e.getContainer();function u(e){l?l.show(e):Promise.all([i.e(74814),i.e(52139),i.e(20384),i.e(73935),i.e(30092)]).then(i.bind(i,54548)).then(i=>{l||(l=new i.ChartScreenshotHintRenderer((0,n.ensureNotNull)(c),{bottomPadding:t.seriesControlBarEnabled}),l.show(e))})}}},61581:(e,t,i)=>{"use strict";i.d(t,{getTooltipData:()=>s,setTooltipData:()=>n});const r=new WeakMap;function s(e,t){const i=r.get(e);return i instanceof Function?i(t):i&&i[t]}function n(e,t,i){if(i instanceof Function)return void r.set(e,i);const s=r.get(e),n=void 0===s||s instanceof Function?{}:s;n[t]=i,r.set(e,n)}},83147:(e,t,i)=>{"use strict";i.d(t,{hotKeySerialize:()=>s,hotKeyDeserialize:()=>n});var r=i(44197);function s(e){return(0,r.clean)(JSON.stringify(e))}function n(e){return JSON.parse((0,r.clean)(e,!0))}},94970:(e,t,i)=>{"use strict";i.d(t,{hide:()=>Y,show:()=>z,showOnElement:()=>H});var r=i(95355);let s=0,n=0,o=0;function a(){clearTimeout(s),clearTimeout(n),clearTimeout(o)}function l(e,t){s=setTimeout(e,t)}const c="tooltip-root-element";let u;function d(){const e=document.getElementById(c);e?u=e:(u=document.createElement("div"),u.id=c,document.body.appendChild(u))}function h(){u&&(u.innerHTML="")}
"interactive"===document.readyState?d():document.addEventListener("DOMContentLoaded",d);var p=i(16282);const _={default:"",white:"theme-white","round-shadow":"theme-round-shadow"},m=Object.keys(_);var f=i(61581),g=i(83147),v=i(13548),S=i(82755),y=(i(68421),i(53549)),b=i(84162),w=i(68724),P=i(78746);function C(e){const t=function(e){const t=e.hasAttribute("data-tooltip")?e.getAttribute("data-tooltip"):e.getAttribute("title");return t&&((0,f.setTooltipData)(e,"text",t),e.removeAttribute("title")),(0,f.getTooltipData)(e,"text")||""}(e),i=e.getBoundingClientRect(),r={h:i.height,w:i.width,x:i.left,y:i.top},s=e.getAttribute("data-color-theme")||"",n=e.classList.contains("common-tooltip-html"),o=parseInt(e.getAttribute("data-tooltip-delay")||""),a=parseInt(e.getAttribute("data-tooltip-debounce")||"");let l={type:"none"};return t&&(l={type:n?"html":"text",data:t}),{above:e.classList.contains("common-tooltip-above"),below:e.classList.contains("common-tooltip-below"),otl:e.classList.contains("common-tooltip-otl"),otr:e.classList.contains("common-tooltip-otr"),vertical:e.classList.contains("common-tooltip-vertical"),hotkey:e.getAttribute("data-tooltip-hotkey"),narrow:e.classList.contains("common-tooltip-narrow"),wide:e.classList.contains("common-tooltip-wide"),colorTheme:s,tooltipDelay:o,tooltipDebounce:a,rect:r,content:l,target:e}}function T(e){const t=k.cloneNode(!0),i=N(t),{content:r}=e;switch(r.type){case"element":i.innerHTML="",i.appendChild(r.data);break;case"html":i.innerHTML=r.data;break;case"text":if(e.hotkey){const e=R.cloneNode(!0);e.innerText=r.data,i.appendChild(e)}else i.innerText=r.data}if(e.hotkey){const t="none"!==r.type,s=D.cloneNode(!0),n=(0,g.hotKeyDeserialize)(e.hotkey),o=n.keys.map(e=>`<span class="${P["common-tooltip__hotkey-button"]}">${e}</span>`);s.innerHTML=function(e,t){return e.replace(/{\d}|{hotkey_\d}/gi,e=>{const i=Number(e.match(/\d/));return t[i]})}(n.text,o).replace(/\s\+\s/g,`<span class="${P["common-tooltip__plus-sign"]}">+</span>`),i.classList.add(P["common-tooltip__body--with-hotkey"]),t&&s.classList.add(P["common-tooltip__hotkey-block--divider"]),i.appendChild(s)}return t.addEventListener("contextmenu",y.preventDefault),t}function x(e,t){const i=t.rect;if(!i)return;!function(e,t){const i=m.includes(t)?_[t]:"";e.classList.remove(...m.map(e=>_[e]).filter(e=>!!e)),i&&!e.classList.contains(i)&&e.classList.add(i)}(e,t.colorTheme||"default"),t.addClass&&e.classList.add(t.addClass);const r=N(e),s=e.querySelector("."+P["common-tooltip__button-container"]);r.classList.toggle(P["common-tooltip__body--width_wide"],Boolean(t.wide)),r.classList.toggle(P["common-tooltip__body--no-padding"],Boolean(t.noPadding)),r.classList.toggle(P["common-tooltip__body--width_narrow"],Boolean(t.narrow)),r.classList.toggle(P["common-tooltip__body--no-buttons"],!0),r.style.left=L(0),r.style.width=L(r.clientWidth+(Boolean(t.noPadding)?0:2));const n=document.body.clientWidth,o=w.CheckMobile.iOS()||(0,w.supportTouch)()&&(0,
w.isMac)()?window.innerHeight:document.body.clientHeight,a=t.vertical,l=t.extendMargin||a&&i.w<20||!a&&i.h<20;e.classList.toggle(P["common-tooltip--farther"],l),e.classList.toggle(P["common-tooltip--vertical"],a),e.classList.toggle(P["common-tooltip--horizontal"],!a);const c=function(e){return e.querySelector("."+P["common-tooltip__ear-holder"])}(e),u=e.offsetHeight;if(a){const a=10,l=o-10,d=12,h=a+d,p=l-d,_=(0,b.clamp)(i.y+i.h/2,h,p)-u/2,m=_+u;e.style.left=L(i.x+i.w),e.style.top=L(_),_<a?r.style.top=s.style.top=L(a-_):m>l&&(r.style.top=s.style.top=L(l-m));const{right:f}=(e.querySelector(":last-child")||r).getBoundingClientRect(),g=f+10>n;e.classList.toggle(P["common-tooltip--direction_reversed"],g),e.classList.toggle(P["common-tooltip--direction_normal"],!g);let v=g?"after":"before";(0,S.isRtl)()?(v=t.otr?"after":v,v=t.otl?"before":v):(v=t.otr?"before":v,v=t.otl?"after":v),c.classList.toggle(P["common-tooltip__ear-holder--before"],"before"===v),c.classList.toggle(P["common-tooltip__ear-holder--after"],"after"===v),"after"===v&&(e.style.left="auto",e.style.right=L(n-i.x))}else{const a=i.x-(r.offsetWidth-i.w)/2,l=n-10-e.offsetWidth,d=Math.max(10,Math.min(a,l));e.style.left=L(d);const h=l<a;e.classList.toggle(P["common-tooltip--direction_reversed"],h),e.classList.toggle(P["common-tooltip--direction_normal"],!h);const p=function(e,t,i,r){if(e.above)return O(t,r)?"above":"below";if(e.below)return function(e,t,i){return i.y+i.h+t+10<e}(t,i,r)?"below":"above";return O(i,r)?"above":"below"}(t,o,u,i);"above"===p?e.style.bottom=L(o-i.y):e.style.top=L(i.y+i.h),c.classList.add("above"===p?P["common-tooltip__ear-holder--above"]:P["common-tooltip__ear-holder--below"]);const{left:_}=r.getBoundingClientRect();let m=Math.trunc(i.x+i.w/2-(_+r.clientWidth/2));e.style.left=L(d+m),e.style.width=L(r.clientWidth+s.clientWidth),m=h?Math.max(0,m):Math.min(0,m),s.style.left=L(-m),r.style.left=L(-m)}}function I(e){e.classList.toggle(P["common-tooltip--hidden"],!0)}function L(e){return Math.floor(e)+"px"}const M=`\n\t<div id="common-tooltip-wrapper" class="${P["common-tooltip"]}">\n\t\t<div class="${P["common-tooltip__ear-holder"]}" >\n\t\t\t<div class="${P["common-tooltip__body"]} js-tooltip-body"></div>\n\t\t</div>\n\t\t<div class="${P["common-tooltip__button-container"]}"></div>\n\t</div>\n`,E=`\n\t<div class="${P["common-tooltip__hotkey-block"]}"></div>\n`,A=`\n\t<div class="${P["common-tooltip__hotkey-text"]}"></div>\n`,k=(0,v.parseHtmlElement)(M),D=(0,v.parseHtmlElement)(E),R=(0,v.parseHtmlElement)(A);function N(e){return e.querySelector("."+P["common-tooltip__body"])}function O(e,t){return 10+e<t.y}var V=i(26083);let B=!1,F=null,W=null;r.mobiletouch||document.addEventListener("mouseover",(function(e){var t;if(null===(t=e.sourceCapabilities)||void 0===t?void 0:t.firesTouchEvents)return;const i=e.target,r=e.currentTarget,s=function(e,t,i){const r=[];for(;e&&e!==t;)e.classList&&e.classList.contains(i)&&r.push(e),e=e.parentElement||(s=e.parentNode)&&(s.nodeType===Node.ELEMENT_NODE?s:null);var s;return r}(i,r,"apply-common-tooltip")
;for(const t of s){if("buttons"in e){if(1&e.buttons)continue}else if(1===e.which)continue;const i=()=>H(t);if(i()){const e=e=>{e.target instanceof Element&&e.target.contains(t)&&r(null,!0)},r=(s,n=!1)=>{t.removeEventListener("common-tooltip-update",i),t.removeEventListener("mouseleave",r),t.removeEventListener("mousedown",r),document.removeEventListener("scroll",e,{capture:!0}),W&&(W.destroy(),W=null),Y(n)};t.addEventListener("common-tooltip-update",i),t.addEventListener("mouseleave",r),t.addEventListener("mousedown",r),document.addEventListener("scroll",e,{capture:!0}),null===W&&(W=(0,V.createGroup)({desc:"Tooltip"}),W.add({desc:"Hide",hotkey:27,handler:r}));break}}}),!0);const U=new MutationObserver(()=>{if(F&&F.options.target){let e;e="isConnected"in F.options.target?F.options.target.isConnected:document.body.contains(F.options.target),e||Y()}}),H=(e,t={})=>{const{content:i,...r}=q(t),s=C(e),n=Object.assign(s,r);return"none"!==i.type&&(n.content=i),!("none"===n.content.type&&!n.hotkey)&&(n.target=e,z(n),!0)},z=e=>{const t=q(e),i=T(t);var r;if(F={options:t,element:i},r=i,h(),u&&u.appendChild(r),a(),!B)return I(i),void l(()=>G(i),function(e){return"number"!=typeof e.tooltipDelay||isNaN(e.tooltipDelay)?500:e.tooltipDelay}(t));const{tooltipDebounce:s}=e;"number"!=typeof s||isNaN(s)?G(i):l(()=>G(i),s)};function j(){h(),B=!1,F=null}const Y=e=>{if(a(),U.disconnect(),!F)return;if(!e&&!B)return;const{element:t,options:i}=F,r=()=>{t.removeEventListener("mouseleave",r),I(t),e?j():o=setTimeout(()=>{j()},250)};var s,l;i.tooltipHideDelay?(s=()=>{t.querySelector(":hover")?t.addEventListener("mouseleave",r):r()},l=i.tooltipHideDelay,n=setTimeout(s,l)):r()};function G(e){const{options:t}=(0,p.ensureNotNull)(F);if(x(e,t),function(e){e.classList.toggle(P["common-tooltip--hidden"],!1)}(e),U.observe(document,{childList:!0,subtree:!0}),B=!0,t.forceHideOnMove){const e=()=>{document.removeEventListener("mousemove",e),Y()};document.addEventListener("mousemove",e)}}function q(e){if(function(e){return"content"in e}(e))return e;const{inner:t,html:i,text:r,...s}=e;let n={type:"none"};return t&&(n={type:"element",data:t}),r&&(n={type:i?"html":"text",data:r}),{content:n,...s}}},30060:(e,t,i)=>{"use strict";i.d(t,{createErrorDialog:()=>n,showErrorDialog:()=>a});var r=i(20220),s=i(33399);async function n(e){return(await Promise.all([i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(38817),i.e(466),i.e(64011),i.e(44740),i.e(94795),i.e(13469),i.e(34834)]).then(i.bind(i,64161))).createDialog({...o(e),type:"modal"})}function o(e){const{title:t,content:i,actions:n,btnTitle:o,btnType:a,help:l}=e;return{title:t||(0,r.t)("Error"),help:l,content:i,addClass:s.errorDialog,destroyOnClose:!0,width:500,dataset:{"dialog-type":"error-dialog"},actions:n||[{key:[13,32],method:"close",name:"ok",text:o||(0,r.t)("OK"),type:a||"primary"}]}}function a(e){n(e).then(e=>e.open())}},59836:(e,t,i)=>{"use strict";e.exports.pushChartPage=async function(e){
const{default:t}=await Promise.all([i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(38817),i.e(71576),i.e(466),i.e(64011),i.e(44740),i.e(34629)]).then(i.t.bind(i,30173,23)),r=new t.ChartPage(e);TradingView.historyManager.push(r)}},42127:(e,t,i)=>{"use strict";var r=i(94970),s=i(95498);const n=/\b(msie|trident)\b/i.test(navigator.userAgent)?1:0;function o(e){return e.offsetWidth+n<e.scrollWidth}(0,s.whenDocumentReady)(()=>{document.addEventListener("mouseenter",e=>{const t=e.target;var i;t instanceof HTMLElement&&t.matches(".apply-overflow-title")&&((i=t).getAttribute("title")||i.offsetWidth+n>=i.scrollWidth||i.setAttribute("title",i.textContent||""))},!0),document.addEventListener("mouseenter",e=>{const t=e.target;if(t instanceof HTMLElement&&t.matches(".apply-overflow-tooltip")){if(t.matches(".apply-overflow-tooltip--check-children")){let e=!1;const i=t.children;for(let t=0;t<i.length;t++){const r=i[t];if(r instanceof HTMLElement&&o(r)){e=!0;break}}if(!e)return}else if(!o(t))return;let e="";e=t.matches&&t.matches(".apply-overflow-tooltip--allow-text")?t.textContent||"":Array.from(t.childNodes).reduce((e,t)=>(t.nodeType===Node.TEXT_NODE&&e.push(t.textContent||""),e),[]).join("").trim(),(0,r.showOnElement)(t,{text:e});const i=()=>{(0,r.hide)(),["mouseleave","mousedown"].forEach(e=>t.removeEventListener(e,i))};["mouseleave","mousedown"].forEach(e=>t.addEventListener(e,i))}},!0)})},15869:(e,t,i)=>{"use strict";i.d(t,{ChartPage:()=>c});var r=i(65066),s=i.n(r),n=i(43137),o=i(67097),a=i(22842);const l=a.enabled("no_min_chart_width");class c{constructor(e){this._processVisibility=e=>{const t=e.container.value();return this._affectsLayout(e.name)?(t&&t.classList.toggle("js-hidden",!1),!0):(t&&t.classList.toggle("js-hidden",!0),!1)},this._setWidth=(e,t)=>{let i=t;this._fullscreenArea!==e.name&&(e.availWidth.setValue(t),e.canNegotiate.width&&(i=(0,o.determineSize)(t,e.negotiations.width)));const r=e.container.value();return r&&(r.style.width=i+"px"),e.width.setValue(i),i},this._setHeight=(e,t)=>{let i=t;this._fullscreenArea!==e.name&&(e.availHeight.setValue(t),e.canNegotiate.height&&(i=(0,o.determineSize)(t,e.negotiations.height)));const r=e.container.value();return r&&(r.style.height=i+"px"),e.height.setValue(i),i};const t=e.container.value();if(!t)throw new Error("bridge.container.value() must be an element");this._container=t,this._availableAreas=["left","tradingpanel","right","top","bottom","center","topleft","extratop"],this._areas={},this._bridge=e,this._width=e.width,this._height=e.height,this._width.subscribe(()=>this.recalculate()),this._height.subscribe(()=>this.recalculate()),this._bridge.visible.subscribe(()=>this._updateVisibility()),this._bridge.fullscreen.subscribe(()=>this._onParentFullscreenChange()),this.recalculate()}allocate(e){const t=e&&e.areaName;if(-1===this._availableAreas.indexOf(t))throw new Error("unknown options.areaName");this.free(t);const i=this._createDOM(t),r={name:t,canNegotiate:{width:"left"===t||"right"===t||"tradingpanel"===t||"topleft"===t,
height:"top"===t||"bottom"===t||"topleft"===t||"extratop"===t},negotiations:{width:[],height:[]},remove:()=>{for(const e in this._areas)this._areas[e]===r&&this.free(e)},negotiateWidth:e=>{if(!r.canNegotiate.width)return;const t=(0,o.processNegotiation)(e);(0,o.negotiationsAreEqual)(r.negotiations.width,t)||(r.negotiations.width=t,this.recalculate())},negotiateHeight:e=>{if(!r.canNegotiate.height)return;const t=(0,o.processNegotiation)(e);(0,o.negotiationsAreEqual)(r.negotiations.height,t)||(r.negotiations.height=t,this.recalculate())},requestFullscreen:()=>{this._fullscreenArea||("right"!==t&&"center"!==t||(this._fullscreenArea=t),"center"===t&&this._bridge.requestFullscreen(),this._updateFullscreen())},exitFullscreen:()=>{t===this._fullscreenArea&&(this._fullscreenArea=void 0,"center"===t&&this._bridge.exitFullscreen(),this._updateFullscreen())},width:new(s()),height:new(s()),availWidth:new(s()),availHeight:new(s()),alive:new(s())(!0),container:new(s())(i),visible:new(s())(!0),fullscreen:new(s())(!1),fullscreenable:new(s())("right"===t||"center"===t),rdState:new n.ResizerDetacherState};return r.rdState.pushOwner(r),this._areas[t]=r,r.rdState.owner.subscribe(e=>{const i=r.container.value();if(e!==r)i&&(i.innerHTML="",i.parentElement&&i.parentElement.removeChild(i));else{let e=null;for(let i=this._availableAreas.indexOf(t);i--;){const t=this._availableAreas[i];if(this._affectsLayout(t)){e=this._areas[t].container.value();break}}i&&(e&&i.parentElement?i.insertAdjacentElement("afterend",e):this._container.appendChild(i))}this.recalculate()},{callWithLast:!0}),r.rdState.bridge()}free(e){const t=this._areas[e];if(!t)return;this._areas[e]=void 0;const i=t.container.value();i&&i.parentElement&&i.parentElement.removeChild(i),t.alive.setValue(!1)}recalculate(){const e={};this._recalcSingleRunToken=e;const t=this._areas.topleft,i=this._areas.left,r=this._areas.tradingpanel,s=this._areas.right,n=this._areas.top,o=this._areas.bottom,a=this._areas.center,c=this._areas.extratop,u=this._width.value(),d=this._height.value();let h=0,p=0,_=0,m=0,f=0,g=0,v=0,S=0;if(e===this._recalcSingleRunToken&&c&&this._processVisibility(c)&&(S=this._setHeight(c,d),this._setWidth(c,u)),e===this._recalcSingleRunToken&&t&&this._processVisibility(t)){v=this._setHeight(t,d),g=this._setWidth(t,u),g&&(g+=4);const e=t.container.value();e&&(e.style.top=S+"px")}if(e===this._recalcSingleRunToken&&i&&this._processVisibility(i)){const e=i.container.value();e&&(e.style.top=v+S+"px"),this._setHeight(i,d-v-S),_=this._setWidth(i,u),_&&(_+=4)}if(e===this._recalcSingleRunToken&&r&&this._processVisibility(r)){this._setHeight(r,d);let e=u-_;l||(e-=300),f=this._setWidth(r,e)}if(e===this._recalcSingleRunToken&&s&&this._processVisibility(s)){this._setHeight(s,d-S);let e=u-_-f;l||(e-=300),m=this._setWidth(s,e);const t=s.container.value();t&&(t.style.top=S+"px")}const y=f+m,b=y?4:0;if(e===this._recalcSingleRunToken&&n&&this._processVisibility(n)){const e=Math.max(g,_),t=n.container.value();t&&(t.style.left=e+"px",t.style.top=S+"px");const i=u-e-f-m-b;this._setWidth(n,i),
h=this._setHeight(n,d)}let w=0;const P=u-_-f-m-b;if(e===this._recalcSingleRunToken&&o&&this._processVisibility(o)){const e=o.container.value();e&&(e.style.left=_+"px",e.classList.toggle("no-border-top-left-radius",!_),e.classList.toggle("no-border-top-right-radius",!y)),this._setWidth(o,P);const t=d-S;w=Math.min(300,t-0),p=this._setHeight(o,t)+4}if(e===this._recalcSingleRunToken&&a&&this._processVisibility(a)){const e=a.container.value();e&&(e.style.left=_+"px",e.style.top=h+S+"px",e.classList.toggle("no-border-bottom-left-radius",!p||!_),e.classList.toggle("no-border-bottom-right-radius",!y||!p)),this._setWidth(a,P);const t=d-h-p-S;this._setHeight(a,Math.max(t,w))}if(e===this._recalcSingleRunToken&&r&&this._affectsLayout("tradingpanel")){const e=r.container.value();e&&(e.style.right=m+"px",e.style.top=S+"px")}e===this._recalcSingleRunToken&&this._updateVisibility()}_affectsLayout(e){const t=this._areas[e];if(!t)return!1;if(t.rdState.owner.value()!==t)return!1;if(this._fullscreenArea&&this._fullscreenArea!==e)return u(e);if(this._width.value()<=567||this._height.value()<=445){if(!["center","top","left","topleft","extratop"].includes(e))return!1}return!0}_updateVisibility(){const e=this._bridge.visible.value();for(let t=0;t<this._availableAreas.length;t++){const i=this._availableAreas[t],r=this._areas[i];r&&(e&&this._affectsLayout(i)?r.visible.setValue(!0):r.visible.setValue(!1))}}_onParentFullscreenChange(){this._bridge.fullscreen.value()||(this._fullscreenArea=void 0,this._updateFullscreen())}_updateFullscreen(){const e=void 0!==this._fullscreenArea;for(let t=0;t<this._availableAreas.length;t++){const i=this._availableAreas[t],r=this._areas[i];if(!r)continue;if(i===this._fullscreenArea){r.fullscreen.setValue(!0);continue}r.fullscreen.setValue(!1);const s=r.container.value();s&&s.classList.toggle("js-hidden",e&&!u(i))}this._updateVisibility(),this.recalculate()}_createDOM(e){const t=document.createElement("div");return t.classList.add("layout__area--"+e),t.style.position="absolute","bottom"===e?t.style.bottom="0":t.style.top="0","right"===e||"tradingpanel"===e?t.style.right="0":t.style.left="0",t}}function u(e){const t=a.enabled("side_toolbar_in_fullscreen_mode"),i=a.enabled("header_in_fullscreen_mode");return"center"===e||"left"===e&&t||"top"===e&&i}},43137:(e,t,i)=>{"use strict";i.d(t,{ResizerDetacherState:()=>o});var r=i(16282),s=i(65066),n=i.n(s);class o{constructor(e){this._alive=new(n()),this._container=new(n()),this._width=new(n()),this._height=new(n()),this._fullscreen=new(n()),this._detachable=new(n()),this._fullscreenable=new(n()),this._visible=new(n()),this._availWidth=new(n()),this._availHeight=new(n()),this._owner=new(n()),this._ownersStack=[],this.owner=this._owner.readonly(),this._bridge={alive:this._alive.readonly(),container:this._container.readonly(),width:this._width.readonly(),height:this._height.readonly(),fullscreen:this._fullscreen.readonly(),detachable:this._detachable.readonly(),fullscreenable:this._fullscreenable.readonly(),visible:this._visible.readonly(),
availWidth:this._availWidth.readonly(),availHeight:this._availHeight.readonly(),remove:()=>{const e=this._owner.value();e&&e.remove&&e.remove()},negotiateWidth:e=>{const t=this._owner.value();t&&t.negotiateWidth&&t.negotiateWidth(e)},negotiateHeight:e=>{const t=this._owner.value();t&&t.negotiateHeight&&t.negotiateHeight(e)},requestFullscreen:()=>{const e=this._owner.value();e&&e.requestFullscreen&&e.requestFullscreen()},exitFullscreen:()=>{const e=this._owner.value();e&&e.exitFullscreen&&e.exitFullscreen()},detach:e=>{const t=this._owner.value();t&&t.detach&&t.detach(e)},attach:()=>{const e=this._owner.value();e&&e.attach&&e.attach()}},e&&this.pushOwner(e)}bridge(){return this._bridge}pushOwner(e){if(!e.alive.value())return;for(const e of this._ownersStack)this._unsubscribeOwner(e);const t={owner:e};this._ownersStack.push(t),this._subscribeOwner(t)}_subscribeOwner(e){const t=e.owner;if(e.deathWatcher||(this._alive.setValue(!0),e.deathWatcher=t.alive.spawn(),e.deathWatcher.subscribe(t=>{t||this._deadHandler(e)})),this._owner.setValue(t),!e.subscriptions){const i=e.subscriptions=[];this._visible.setValue(!1);const r=(e,t)=>{if(e){const r=e.spawn();i.push(r),r.subscribe(e=>{t.setValue(e)},{callWithLast:!0})}else t.deleteValue()};r(t.container,this._container),r(t.width,this._width),r(t.height,this._height),r(t.fullscreen,this._fullscreen),r(t.detachable,this._detachable),r(t.fullscreenable,this._fullscreenable),r(t.availWidth,this._availWidth),r(t.availHeight,this._availHeight),r(t.visible,this._visible)}}_unsubscribeOwner(e,t){if(e.subscriptions){for(const t of e.subscriptions)t.unsubscribe();e.subscriptions=null}t&&e.deathWatcher&&(e.deathWatcher.unsubscribe(),e.deathWatcher=null)}_deadHandler(e){const t=this._ownersStack.indexOf(e);(0,r.assert)(-1!==t,"sanitized owner should be in stack");for(let e=this._ownersStack.length-1;e>=t;e--)this._unsubscribeOwner(this._ownersStack[e],!0);this._ownersStack.length=t,t>0?this._subscribeOwner(this._ownersStack[t-1]):(this._alive.setValue(!1),this._owner.deleteValue())}}},67097:(e,t,i)=>{"use strict";function r(e,t){let i=0;for(const{min:r,max:s}of t){if(e<r||s<r)continue;const t=Math.min(e,s);if(i=Math.max(i,t),e===i)break}return i}function s(e){const t=[];if(void 0===e)return[];Array.isArray(e)||(e=[e]);for(const i of e){let e,r;isFinite(i)?e=r=Number(i):(e=+i.min,r=+i.max),(e<0||isNaN(e))&&(e=0),isNaN(r)&&(r=1/0),e<=r&&r>0&&t.push({min:e,max:r})}return t.sort((e,t)=>e.min-t.min||e.max-t.max),t}function n(e,t){if(e.length!==t.length)return!1;for(let i=e.length;i--;){if(e[i].min!==t[i].min)return!1;if(e[i].max!==t[i].max)return!1}return!0}i.d(t,{determineSize:()=>r,processNegotiation:()=>s,negotiationsAreEqual:()=>n})},11117:(e,t,i)=>{"use strict";i.d(t,{detachToPopup:()=>a,screenBox:()=>l});var r=i(16282),s=i(2153),n=i(44385),o=i(26083);function a(e,t){const i=Object.assign({},t),r=e.bridge().container.value();r&&(i.useStylesFrom=r.ownerDocument||void 0);const s=c(i);return!!s&&(e.pushOwner(s.allocate()),!0)}function l(e){const t=(0,r.ensureNotNull)(e.ownerDocument),i=(0,
r.ensureNotNull)(t.defaultView),s=e.getBoundingClientRect(),n={left:s.left+i.pageXOffset,top:s.top+i.pageYOffset,width:e.clientWidth,height:e.clientHeight},o=i.innerWidth/t.documentElement.clientWidth;return isFinite(o)&&(n.left*=o,n.top*=o,n.width*=o,n.height*=o),n.left+=i.screenLeft||i.screenX||0,n.top+=i.screenTop||i.screenY||0,n}const c=(e={})=>{let t="menubar=no,toolbar=no,location=no,personalbar=no,status=no";for(const i of["top","left","width","height"]){const r=Number(e[i]);isFinite(r)&&r>=0&&(t+=`,${i}=${r}`)}const r=window.open("",e.name||"_blank",t);if(!r||r.closed)return null;let a=null;try{a=r.document,a.close()}catch(e){return null}if(a.open(),a.write('<!DOCTYPE html><html><head><meta http-equiv="X-UA-Compatible" content="IE=Edge" /></head><body></body></html>'),a.close(),null!=e.title&&(a.title=String(e.title)),e.useStylesFrom){a.head.appendChild(((e,t)=>{const i=e.querySelectorAll('style, link[rel~="stylesheet"]'),r=t.createDocumentFragment();for(let e=0;e<i.length;e++){const s=i[e],n=t.createElement(s.tagName);for(let e=0;e<s.attributes.length;e++){const t=s.attributes[e];n.setAttribute(t.nodeName,t.nodeValue||"")}const o=s.textContent;o&&(n.textContent=o),r.appendChild(n)}return r})(e.useStylesFrom,a));const t=a.createElement("style");t.textContent="html, body {min-width: 0 !important; max-width: none !important}",a.head.appendChild(t)}const l=new s.Root(r);return((e,t,r)=>{let s=!1;(0,n.listen)(t),(0,o.registerWindow)(t);let a=null;Promise.all([Promise.resolve().then(i.bind(i,87479)),Promise.resolve().then(i.bind(i,59943))]).then(e=>{const[i,r]=e;s||(a=i.watchedTheme.spawn(),a.subscribe(e=>{r.applyTheme(e,t)},{callWithLast:!0}))}),Promise.resolve().then(i.bind(i,26083)).then(e=>{s||e.registerWindow(t)});const l=()=>{s=!0,e&&e.removeEventListener("unload",l,!1),t&&(t.removeEventListener("unload",l,!1),t.close()),r&&r.free(),a&&(a.destroy(),a=null)};e.addEventListener("unload",l,!1),t.addEventListener("unload",l,!1)})(window,r,l),l}},2153:(e,t,i)=>{"use strict";i.d(t,{Root:()=>d});i(20220);var r=i(65066),s=i.n(r),n=i(43137);class o{constructor(e){this._document=e,this.isFullscreen=new(s());const t=()=>{const e=["fullscreenElement","webkitFullscreenElement","mozFullscreenElement","mozFullScreenElement","msFullscreenElement"];for(let t=0;t<e.length;t++){const i=e[t];if(i in this._document){this.isFullscreen.setValue(!!this._document[i]);break}}};t();for(const i of["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"])e.addEventListener(i,t,!1)}enter(){const e=this._document.documentElement;for(const t of["requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen"])if("function"==typeof e[t]){e[t]();break}this.isFullscreen.setValue(!0)}exit(){const e=this._document;for(const t of["exitFullscreen","mozCancelFullScreen","mozExitFullscreen","webkitExitFullscreen","msExitFullscreen"])if("function"==typeof e[t]){e[t]();break}this.isFullscreen.setValue(!1)}}var a=i(73384),l=i(40142),c=i(16282),u=i(68724);class d{constructor(e){
this._updateDocumentHeight=e=>{"visual"===this._viewportType&&this._window.document.documentElement.style.setProperty("height",e+"px","important")},this._window=e,this._fullscreenApi=new o(e.document),this._viewportType=u.isChrome||(0,l.isOnMobileAppPage)("any")||!this._window.visualViewport?"quirks":"visual","visual"===this._viewportType?this._viewport=(0,c.ensureDefined)(this._window.visualViewport):this._viewport=this._window;const t=this._layoutSizeSensor=this._window.document.createElement("div");t.id="layout-size-sensor",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.right="0",t.style.bottom="0",t.style.pointerEvents="none",t.style.visibility="hidden",this._initFullscreen()}allocate(){this.free();const e=this._window.document,t=e.createElement("div");t.classList.add("js-rootresizer__contents"),t.style.position="relative",t.style.width="100%",t.style.height="100%",e.body.insertAdjacentElement("afterbegin",t),e.body.insertAdjacentElement("afterbegin",this._layoutSizeSensor),this._visibilityApi=new a.VisibilityApi(this._window.document);const i={alive:new(s())(!0),fullscreenable:new(s())(!0),container:new(s())(t),width:new(s()),height:new(s()),availWidth:new(s()),availHeight:new(s()),visible:this._visibilityApi.isVisible,fullscreen:this._fullscreenApi.isFullscreen,remove:()=>{i.alive.setValue(!1)},attach:()=>{i.alive.setValue(!1),this._window.close()},requestFullscreen:()=>{this._requestFullscreen()},exitFullscreen:()=>{this._exitFullscreen()}};return i.alive.subscribe(e=>{e||i!==this._area||this.free()}),this._area=i,this._resizeHandler=()=>{const e=this._width(i)||800,t=this._height(i)||600;i.availHeight.setValue(t),i.availWidth.setValue(e),i.height.setValue(t),i.width.setValue(e)},this._area.height.subscribe(this._updateDocumentHeight,{callWithLast:!0}),this._resizeHandler(),this._viewport.addEventListener("resize",this._resizeHandler),new n.ResizerDetacherState(i).bridge()}free(){if(this._resizeHandler&&(this._viewport.removeEventListener("resize",this._resizeHandler),this._resizeHandler=void 0),this._visibilityApi&&(this._visibilityApi.destroy(),this._visibilityApi=void 0),this._area){const e=this._area;this._area=void 0,e.height.unsubscribe(this._updateDocumentHeight),e.alive.setValue(!1);const t=e.container.value(),i=null==t?void 0:t.parentElement;i&&(i.removeChild(t),i.removeChild(this._layoutSizeSensor))}}_height(e){if("visual"===this._viewportType)return this._layoutSizeSensor.clientHeight;return e.container.value().clientHeight}_width(e){return e.container.value().clientWidth}_requestFullscreen(){this._fullscreenApi.enter()}_exitFullscreen(){this._fullscreenApi.exit()}_initFullscreen(){this._fullscreenApi.isFullscreen.subscribe(e=>{this._resizeHandler&&this._resizeHandler()})}}},73384:(e,t,i)=>{"use strict";i.d(t,{VisibilityApi:()=>n});var r=i(65066),s=i.n(r);class n{constructor(e){let t;this.isVisible=new(s())(!0);let i=null;for(const r of["","moz","ms","webkit"]){const s=r?r+"Hidden":"hidden";if(s in e){t=r+"visibilitychange",i=()=>{this.isVisible.setValue(!e[s])},i(),
e.addEventListener(t,i,!1);break}}this.destroy=()=>{i&&(e.removeEventListener(t,i,!1),i=null)}}}},29786:(e,t,i)=>{"use strict";i.d(t,{DEFAULT_SIZE:()=>r});const r="large"},80238:(e,t,i)=>{"use strict";i.d(t,{Spinner:()=>o});i(18266);var r=i(13548),s=i(29786);const n=(0,r.parseHtmlElement)('\n\t\t<div class="tv-spinner" role="progressbar">\n\t\t\t<div class="tv-spinner__spinner-layer">\n\t\t\t\t<div class="tv-spinner__background tv-spinner__width_element"></div>\n\t\t\t\t<div class="tv-spinner__circle-clipper tv-spinner__width_element tv-spinner__circle-clipper--left"></div>\x3c!--\n\t\t\t\t--\x3e<div class="tv-spinner__circle-clipper tv-spinner__width_element tv-spinner__circle-clipper--right"></div>\n\t\t\t</div>\n\t\t</div>\n\t');class o{constructor(e){this._shown=!1,this._el=n.cloneNode(!0),this.setSize(e||s.DEFAULT_SIZE)}spin(e){return this._el.classList.add("tv-spinner--shown"),void 0===this._container&&(this._container=e,void 0!==e&&e.appendChild(this._el)),this._shown=!0,this}stop(e){return e&&void 0!==this._container&&this._container.removeChild(this._el),this._el.classList.remove("tv-spinner--shown"),this._shown=!1,this}setStyle(e){return Object.keys(e).forEach(t=>{const i=e[t];void 0!==i&&this._el.style.setProperty(t,i)}),this}style(){return this._el.style}setSize(e){const t=void 0!==e?"tv-spinner--size_"+e:"";return this._el.className=`tv-spinner ${t} ${this._shown?"tv-spinner--shown":""}`,this}getEl(){return this._el}destroy(){this.stop(),delete this._el,delete this._container}}},97105:(e,t,i)=>{"use strict";i.d(t,{solutionIds:()=>r})
;const r=JSON.parse('{"EXTENDED_HOURS":43000502023,"PRE_MARKET":43000502023,"POST_MARKET":43000502023,"SPREAD_CHARTS":43000502298,"ALERTS":43000520149,"ALERT_ON_STRATEGY":43000481368,"ALERT_WEBHOOK":43000529348,"ALERT_DESCRIPTION_PLACEHOLDER":43000531021,"VOLUME_PROFILE":43000502040,"VOLUME_PROFILE_INDICATOR":43000557450,"RENKO":43000502284,"KAGI":43000502272,"LINE_BREAK":43000502273,"PNF":43000502276,"FINANCIAL_DATA":43000543506,"BROKER_RATING":43000542490,"CRYPTO_MARKET_CAP":43000540941,"CRYPTO_PAYMENT":43000485536,"ALERT_ON_SPREAD":43000478406,"ALERT_ON_CUSTOM_SCRIPT":43000478415,"ALERT_FUNCTION":43000597494,"SMS_VERIFICATION":43000553429,"MAGNET_MODE":43000537270,"PINE_CANNOT_DETERMINE":43000587849,"PRIVACY_SETTINGS":43000548335,"PUBLICATION_TYPE":43000609497,"SCRIPT_ACCESS":43000482573,"MEMORY_LIMITS_EXCEEDED":43000590233,"FREE_USER_FAQS":43000590947,"STRATEGY_UNREALISTIC_RESULTS":43000481029,"STRATEGY_FUTURE_DATA":43000614705,"STREAM_RULES":43000591348,"HOW_TO_USE_PAPER":43000516466,"HOW_TO_USE_CQG":43000516372,"HOW_TO_USE_OANDA":43000516375,"HOW_TO_USE_FOREXCOM":43000516374,"FAVORITE_IDEA":43000555216,"YOUTUBE_ERROR":43000612153,"AUTHORS_INSTRUCTIONS_PUBCLICATION":43000549951,"AUTHORS_INSTRUCTIONS_EDIT":43000614618,"SCRIPT_INSTRUCTIONS":43000482573,"BAR_REPLAY_UNAVAILABILITY":43000475470,"WHAT_IS_CBOE_BZX_EXCHANGE":43000473924,"GOPRO_UPGRADE_DESCRIPTION":43000473324,"GOPRO_DOWNGRADE_DESCRIPTION":43000485437,"BROKERAGE_REVIEWS":43000591351,"CHANGE_SUBSCRIPTION":43000635806,"PINE_LIBRARY_INFO":43000638371,"HOW_TO_CREATE_A_STREAM":43000560174,"HOW_DO_I_UPDATE_DESKTOP_APP":43000647779}')},78264:(e,t,i)=>{"use strict";i.d(t,{followSymbol:()=>s});var r=i(64553);function s(e){return(0,r.handleJSONRequest)({path:"/social/follow-the-symbol/",requestData:{body:e,method:"POST"}})}},27609:(e,t,i)=>{"use strict";async function r(e){return(await Promise.all([i.e(2328),i.e(55146)]).then(i.bind(i,70250))).showMagnetModeToast(e)}i.d(t,{showMagnetModeNotification:()=>r})},33735:(e,t,i)=>{"use strict";i.d(t,{AbstractIndicator:()=>a});var r=i(87380),s=i(75443),n=i(6798);i(94970);const o=(0,r.getLogger)("GUI.Blocks.AbstractIndicator");class a{constructor(e){this._classSuffix="",this._quoteSessionPrefix="abstract-indicator",this._shortMode=!1,this._showTooltip=!0,this._subscribed=!1,this._tooltipType="custom",this._lastTooltipText="",this._quoteSession=e.quoteSession}getValue(){return this._value}getTooltipText(){return this._labelMap[this._value]||""}getLabel(){return this._labelMap[this._value]||""}getElement(){return this._el}update(e,t){this._updateValue(e,t),this._render()}setTooltipEnabled(e=!1){this._showTooltip!==e&&(this._showTooltip=e,this._renderTooltip())}enableShortMode(){!0!==this._shortMode&&(this._shortMode=!0,this._render())}disableShortMode(){!1!==this._shortMode&&(this._shortMode=!1,this._render())}isShortModeEnabled(){return this._shortMode}start(){!this._subscribed&&this._symbolName&&(this._quoteSession||(this._quoteSession=(0,n.getQuoteSessionInstance)("simple")),
this._quoteSession.subscribe(this._getQuoteSessionId(),this._symbolName,this.update.bind(this)),this._subscribed=!0)}stop(){this._subscribed&&this._quoteSession&&this._symbolName&&(this._quoteSession.unsubscribe(this._getQuoteSessionId(),this._symbolName),this._subscribed=!1)}_init(e){this._el=e.el?e.el:document.createElement("span"),this._el.innerHTML="",this._classMap=e.classMap,this._labelMap=e.labelMap,this._showTooltip=e.showTooltip,this._classSuffix=e.classSuffix,this._symbolName=e.symbol,e.tooltipType&&(this._tooltipType=e.tooltipType),this._quoteSessionGUID=(0,s.guid)(),!0===e.short&&this.enableShortMode(),e.data&&this._updateValue(e.data)}_clearClasses(){Object.values(this._classMap).map(e=>{this._el.classList.remove(""+e),this._el.classList.remove(`${e}${this._classSuffix}`)})}_render(){this._renderClasses(),this._renderTooltip(),this._renderLabel()}_renderLabel(){this._el.textContent=this.getLabel()}_updateValue(e,t){const i=this._getValueFromData(e);(t||i!==this._value)&&(this._value=i)}_renderClasses(){const e=this._el.classList;e.add(this._componentClass,this._componentClass+this._classSuffix);const t=this._classMap[this._value];for(const i in this._classMap){const r=this._classMap[i];r&&(r===t?e.add(r,r+this._classSuffix):e.remove(r,r+this._classSuffix))}!t&&this._value&&o.logWarn("no className for status "+this._value)}_renderTooltip(){const e=this._showTooltip?this.getTooltipText():"";e!==this._lastTooltipText&&(this._lastTooltipText=e,this._el.setAttribute("title",e),"custom"===this._tooltipType&&this._el.classList.toggle("apply-common-tooltip",this._showTooltip))}_getQuoteSessionId(){return`${this._quoteSessionPrefix}.${this._quoteSessionGUID}`}}},15701:(e,t,i)=>{"use strict";i.d(t,{DataModeIndicator:()=>c});var r=i(20220),s=(i(68421),i(52467),i(33735));const n={connecting:(0,r.t)("Connecting"),delayed:(0,r.t)("Delayed"),delayed_streaming:(0,r.t)("Delayed"),endofday:(0,r.t)("End of Day"),forbidden:(0,r.t)("Instrument is not allowed"),realtime:(0,r.t)("Real-time"),snapshot:(0,r.t)("Snapshot"),loading:"",replay:(0,r.t)("Replay Mode")},o={connecting:(0,r.t)("C",{context:"data_mode_connecting_letter"}),delayed:(0,r.t)("D",{context:"data_mode_delayed_letter"}),delayed_streaming:(0,r.t)("D",{context:"data_mode_delayed_streaming_letter"}),endofday:(0,r.t)("E",{context:"data_mode_end_of_day_letter"}),forbidden:(0,r.t)("F",{context:"data_mode_forbidden_letter"}),realtime:(0,r.t)("R",{context:"data_mode_realtime_letter"}),snapshot:(0,r.t)("S",{context:"data_mode_snapshot_letter"}),loading:"",replay:(0,r.t)("R",{context:"data_mode_replay_letter"})},a={streaming:"realtime"},l={classMap:{connecting:"tv-data-mode--connecting",delayed:"tv-data-mode--delayed",delayed_streaming:"tv-data-mode--delayed",endofday:"tv-data-mode--endofday",forbidden:"tv-data-mode--forbidden",realtime:"tv-data-mode--realtime",snapshot:"tv-data-mode--snapshot",loading:"tv-data-mode--loading",replay:"tv-data-mode--replay"},classSuffix:"",data:{values:{update_mode:"connecting"}},labelMap:n,modeInterval:600,short:!1,shortLabelMap:o,
showTooltip:!0,tooltipType:"custom"};class c extends s.AbstractIndicator{constructor(e){super(e),this._quoteSessionPrefix="data-mode-indicator",this._componentClass="tv-data-mode",this._init(e)}getLabel(){return!0===this._shortMode?this._shortLabelMap[this._value]||"":super.getLabel()}setMode(e,t){this.update({values:{update_mode:e,update_mode_seconds:t}})}hide(){this._el.classList.add("i-hidden")}show(){this._el.classList.remove("i-hidden")}getTooltipText(){let e="";const t=this.getValue();if(""===t)return e;switch(t){case"delayed":e=(0,r.t)("Quotes are delayed by {number} min and updated every 30 seconds");break;case"delayed_streaming":e=(0,r.t)("Quotes are delayed by {number} min");break;default:e=this._labelMap[t]||e}return["delayed","delayed_streaming"].includes(t)&&(e=e.format({number:String(Math.round(this._modeInterval/60))})),e}_init(e={}){const t=Object.assign({},l,e);this._modeInterval=t.modeInterval||600,this._shortLabelMap=t.shortLabelMap||o,super._init(t),this._render()}_getValueFromData(e){let t;return t=void 0!==e.values&&void 0!==e.values.update_mode?e.values.update_mode:this.getValue(),a[t]||t}_updateValue(e,t){void 0!==e.values&&void 0!==e.values.update_mode_seconds&&(this._modeInterval=e.values.update_mode_seconds),super._updateValue(e,t)}}},20446:(e,t,i)=>{"use strict";i.d(t,{MarketStatusIndicator:()=>n});i(20220),i(93088);var r=i(33735);const s={classMap:{invalid:"tv-market-status--invalid",market:"tv-market-status--market",out_of_session:"tv-market-status--out-of-session",post_market:"tv-market-status--post-market",pre_market:"tv-market-status--pre-market",loading:"tv-market-status--loading",holiday:"tv-market-status--holiday",replay:"tv-market-status--replay"},classSuffix:"",data:{},extraTitle:"",labelMap:{invalid:window.t("Invalid Symbol"),market:window.t("Market Open"),out_of_session:window.t("Market Closed"),post_market:window.t("Post Market"),pre_market:window.t("Pre Market"),loading:window.t("Loading"),holiday:window.t("Holiday"),replay:""},short:!1,showTooltip:!0,tooltipType:"custom"};class n extends r.AbstractIndicator{constructor(e){super(e),this._quoteSessionPrefix="market-status-indicator",this._componentClass="tv-market-status",this._extraTitle="",this._init(e)}setStatus(e,t){const i={values:{current_session:e}};this.update(i,t)}getTooltipText(){let e=super.getTooltipText();return""===e||""!==this._extraTitle&&(e=`${e}, ${this._extraTitle}`),e}setExtraTitle(e){this._extraTitle=e}reset(){this._clearClasses(),this._labelEl.textContent="",this._extraTitle="",this._el.setAttribute("title",""),this._value=""}enableShortMode(e=!0){void 0!==this._labelEl&&this._labelEl.classList.add("i-hidden"),super.enableShortMode()}disableShortMode(){void 0!==this._labelEl&&this._labelEl.classList.remove("i-hidden"),super.disableShortMode()}_renderLabel(){this._labelEl.textContent=this.getLabel()}_getValueFromData(e){return void 0!==e.values&&void 0!==e.values.current_session?e.values.current_session:this.getValue()}_render(){this._renderLabelElement(),this._renderDotElement(),super._render()}_init(e){
const t=Object.assign({},s,e);super._init(t),this.setExtraTitle(t.extraTitle),this._render()}_renderLabelElement(){void 0===this._labelEl&&(this._labelEl=document.createElement("span"),this._labelEl.classList.add(this._componentClass+"__label"),this._labelEl.classList.add(`${this._componentClass}__label${this._classSuffix}`),this._el.appendChild(this._labelEl))}_renderDotElement(){void 0===this._dotEl&&(this._dotEl=document.createElement("span"),this._dotEl.classList.add(this._componentClass+"__dot"),this._dotEl.classList.add(`${this._componentClass}__dot${this._classSuffix}`),this._el.appendChild(this._dotEl))}}},87451:(e,t,i)=>{"use strict";async function r(e){
const[{configure:t},r,{HotlistRenderer:s},{ReutersCalendarWidget:n},o]=await Promise.all([Promise.all([i.e(13523),i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(38817),i.e(39409),i.e(54551),i.e(59678),i.e(78918),i.e(37653),i.e(6585),i.e(42732),i.e(94782),i.e(53684),i.e(62602),i.e(40114),i.e(29890),i.e(92309),i.e(76192),i.e(73935),i.e(1529),i.e(14563),i.e(466),i.e(36982),i.e(64011),i.e(44740),i.e(9622),i.e(73715),i.e(45623),i.e(41242),i.e(38140),i.e(92765),i.e(80594),i.e(45856),i.e(18555),i.e(40604),i.e(37620),i.e(95848),i.e(80643),i.e(35829),i.e(96663),i.e(55490),i.e(53513),i.e(25120),i.e(54876)]).then(i.bind(i,46271)),Promise.all([i.e(13523),i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(38817),i.e(39409),i.e(54551),i.e(59678),i.e(78918),i.e(37653),i.e(6585),i.e(42732),i.e(94782),i.e(53684),i.e(62602),i.e(40114),i.e(29890),i.e(92309),i.e(76192),i.e(73935),i.e(1529),i.e(14563),i.e(466),i.e(36982),i.e(64011),i.e(44740),i.e(9622),i.e(73715),i.e(45623),i.e(41242),i.e(38140),i.e(92765),i.e(80594),i.e(45856),i.e(18555),i.e(40604),i.e(37620),i.e(95848),i.e(80643),i.e(35829),i.e(96663),i.e(55490),i.e(53513),i.e(25120),i.e(54876)]).then(i.bind(i,34156)),Promise.all([i.e(13523),i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(38817),i.e(39409),i.e(54551),i.e(59678),i.e(78918),i.e(37653),i.e(6585),i.e(42732),i.e(94782),i.e(53684),i.e(62602),i.e(40114),i.e(29890),i.e(92309),i.e(76192),i.e(73935),i.e(1529),i.e(14563),i.e(466),i.e(36982),i.e(64011),i.e(44740),i.e(9622),i.e(73715),i.e(45623),i.e(41242),i.e(38140),i.e(92765),i.e(80594),i.e(45856),i.e(18555),i.e(40604),i.e(37620),i.e(95848),i.e(80643),i.e(35829),i.e(96663),i.e(55490),i.e(53513),i.e(25120),i.e(54876)]).then(i.bind(i,97218)),Promise.all([i.e(13523),i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(38817),i.e(39409),i.e(54551),i.e(59678),i.e(78918),i.e(37653),i.e(6585),i.e(42732),i.e(94782),i.e(53684),i.e(62602),i.e(40114),i.e(29890),i.e(92309),i.e(76192),i.e(73935),i.e(1529),i.e(14563),i.e(466),i.e(36982),i.e(64011),i.e(44740),i.e(9622),i.e(73715),i.e(45623),i.e(41242),i.e(38140),i.e(92765),i.e(80594),i.e(45856),i.e(18555),i.e(40604),i.e(37620),i.e(95848),i.e(80643),i.e(35829),i.e(96663),i.e(55490),i.e(53513),i.e(25120),i.e(54876)]).then(i.bind(i,98656)),Promise.all([i.e(13523),i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(38817),i.e(39409),i.e(54551),i.e(59678),i.e(78918),i.e(37653),i.e(6585),i.e(42732),i.e(94782),i.e(53684),i.e(62602),i.e(40114),i.e(29890),i.e(92309),i.e(76192),i.e(73935),i.e(1529),i.e(14563),i.e(466),i.e(36982),i.e(64011),i.e(44740),i.e(9622),i.e(73715),i.e(45623),i.e(41242),i.e(38140),i.e(92765),i.e(80594),i.e(45856),i.e(18555),i.e(40604),i.e(37620),i.e(95848),i.e(80643),i.e(35829),i.e(96663),i.e(55490),i.e(53513),i.e(25120),i.e(54876)]).then(i.bind(i,50298))]);return{Watchlist:t(e),Detail:r,CalendarWidget:o,ReutersCalendarWidget:n,HotlistWidget:s}}i.d(t,{configuration:()=>r})},96010:(e,t,i)=>{"use strict";i.d(t,{AuthToken:()=>l});var r=i(96276),s=i.n(r),n=i(87380),o=i(85864);const a=(0,
n.getLogger)("ChartApi.AuthToken",{color:"#173"});class l{constructor(){this.invalidated=new(s()),this._tid=0,window.loginStateChange||(window.loginStateChange=new(s())),window.loginStateChange.subscribe(this,e=>{e||(this._set(window.user.auth_token),this.invalidated.fire())}),this._set(window.user.auth_token)}get(e){return window.is_authenticated?!e&&performance.now()<this._cache.validThru?(a.logInfo("Using cached token "+this._cache.token),Promise.resolve(this._cache.token)):this._fetch(Boolean(e),0).then(e=>{if(!window.is_authenticated)throw new Error("User logged out while the request was in flight");return this._set(e),e}).catch(e=>(a.logError("Error fetching new token: "+(e&&e.message)),"")):Promise.resolve("")}reset(){this._set(void 0),this.invalidated.fire()}_set(e){if(window.is_authenticated&&void 0!==e){const t=function(e){if(""===e)return 144e5;try{const t=JSON.parse(atob(e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"))),i=1e3*(t.exp-t.iat);if(!isFinite(i))throw new Error("invalid expiration");return Math.max(i-3e5,3e5)}catch(t){return a.logError(`${e} is invalid: ${t.message}`),144e5}}(e);this._cache={token:e,validThru:performance.now()+t},clearTimeout(this._tid),this._tid=setTimeout(()=>this.reset(),t),a.logInfo(`Cached for ${t} ms: ${e}`)}else this._cache={token:"",validThru:-1/0},clearTimeout(this._tid),a.logInfo("Cache dropped")}_fetch(e,t){return a.logNormal("Fetching a new token, grabSession="+e),(0,o.fetch)("/quote_token/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e?"grabSession=true":""}).then(e=>{if(!e.ok)throw new Error("Response status is not ok: "+e.status);return e.json().then(String)},i=>{if(t>=3)throw i;return a.logWarn("Request failed, will retry"),function(e){return new Promise(t=>setTimeout(t,1e3*e))}(t).then(()=>this._fetch(e,t+1))})}}},11008:(e,t,i)=>{"use strict";i.r(t),i.d(t,{getCharts:()=>p,getChartsCount:()=>_,getDrawingTemplates:()=>M,getGlobalNotifications:()=>h,getStandardStudyTemplateContentById:()=>T,getStudyTemplateContent:()=>w,getStudyTemplateContentById:()=>C,getStudyTemplatesList:()=>S,invalidateStudyTemplatesList:()=>y,loadChart:()=>m,loadDrawingTemplate:()=>A,removeChart:()=>g,removeDrawingTemplate:()=>k,removeStudyTemplate:()=>P,removeStudyTemplateById:()=>x,renameStudyTemplate:()=>I,replaceStudyTemplate:()=>L,saveChart:()=>f,saveDrawingTemplate:()=>E,saveStudyTemplate:()=>b});i(18184);var r=i(67448),s=i(19992);const n=(0,i(87380).getLogger)("Lib.AsyncGzip"),o=[];var a=i(85864);function l(e){if(e.ok)return e.json();throw new Error("not ok")}function c(e){if(e.ok)return e.json();throw new Error("not ok")}var u=i(40142),d=i(18184);function h(e,t){const i={count:t};return e&&(i.lastId=e),d.ajax({url:"/global-notifications/",cache:!1,dataType:"json",type:"GET",data:i})}function p(e){return new Promise((t,i)=>{d.getJSON("/my-charts/",{limit:e},t).fail(i)})}function _(e,t){d.getJSON("/api/v1/charts/count/",void 0,e).fail(t)}function m(e){const t=(0,r.generateChartUrl)({chartId:e.url}),i=document.createElement("a");i.href=t,!(0,
u.isOnMobileAppPage)("new")&&/^\/chart(\/|$)/.test(location.pathname)&&(i.target="_blank",i.rel="noopener"),i.click()}function f(e,t,i,r,a){return function(e){let t;const i=new Promise((i,r)=>{let n=setTimeout(r,5e3,new Error("Loading timed out"));t=o.pop()||new s,t.onerror=r,t.onmessageerror=r,t.onmessage=e=>{clearTimeout(n),"done"===e.data.type?i(e.data.payload):n=setTimeout(r,3e4,new Error("Processing timed out"))},t.postMessage({type:"do",payload:e})});return i.then(()=>{o.length<1?(delete t.onerror,delete t.onmessage,delete t.onmessageerror,o.push(t)):t.terminate()},e=>{n.logError("Worker request failed: "+e.message),t.terminate()}),i}(r.content).catch(()=>null).then(e=>{const t=new FormData;for(const i in r)"content"===i&&e?t.append(i,new Blob([e],{type:"application/gzip"}),"blob.gz"):t.append(i,String(r[i]));return fetch("/savechart/",{method:"POST",credentials:"same-origin",body:t})}).then(e=>{if(!e.ok)throw e;return e.text()})}function g(e){return new Promise((t,i)=>{d.post("/deletechart/",{uid:[e]},e=>{e.error?i(e.error):t()})})}let v=null;function S(){return null===v&&(v=(0,a.fetch)("/api/v1/study-templates",{credentials:"same-origin"}).then(l).then(e=>{const t=new Set((e.standard||[]).map(e=>e.name)),i=(e.custom||[]).map(e=>({...e,is_default:!1}));for(const e of i)t.delete(e.name);const r=(e.standard||[]).filter(e=>t.has(e.name)).map(e=>({...e,is_default:!0}));return[...i,...r]})),v}function y(){v=null}function b(e){return t={name:e.name,content:e.content,meta_info:e.meta_info||{indicators:[]}},(0,a.fetch)("/api/v1/study-templates",{credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>{if(e.ok)return e.json().then(e=>({result:e}));switch(e.status){case 403:return e.json().then(e=>({error:e.code}));case 422:return e.json().then(e=>({error:e.code,id:e.id}));default:throw new Error("not ok")}});var t}async function w(e){throw new Error("Not implemented")}async function P(e){throw new Error("Not implemented")}function C(e,t){(function(e){return(0,a.fetch)("/api/v1/study-templates/"+e,{credentials:"same-origin"}).then(l)})(e).then(t)}function T(e,t){(function(e){return(0,a.fetch)("/api/v1/study-templates/standard/"+e,{credentials:"same-origin"}).then(l)})(e).then(t)}function x(e,t){(function(e){return(0,a.fetch)("/api/v1/study-templates/"+e,{credentials:"same-origin",method:"DELETE"}).then(e=>{if(!e.ok)throw new Error("not ok")})})(e).then(t)}function I(e,t,i){(function(e,t){return(0,a.fetch)(`/api/v1/study-templates/${e}/rename/`,{credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(l)})(e,{name:t}).then(i)}function L(e,t,i){(function(e,t){return(0,a.fetch)("/api/v1/study-templates/"+e,{credentials:"same-origin",method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(l)})(e,{name:t.name,content:t.content,meta_info:t.meta_info||{indicators:[]}}).then(i)}function M(e){return function(e){return(0,a.fetch)(`/drawing-templates/${e}/`,{credentials:"same-origin"
}).then(c)}(e)}function E(e,t,i){return function(e,t,i){const r=new FormData;return r.append("name",t),r.append("tool",e),r.append("content",i),(0,a.fetch)("/save-drawing-template/",{method:"POST",credentials:"same-origin",body:r}).then(c)}(e,t,i)}function A(e,t){return async function(e,t){const i=await(0,a.fetch)(`/drawing-template/${e}/?templateName=${encodeURIComponent(t)}`,{credentials:"same-origin"}),r=await c(i);return JSON.parse(r.content)}(e,t)}function k(e,t){return function(e,t){const i=new FormData;return i.append("name",t),i.append("tool",e),(0,a.fetch)("/remove-drawing-template/",{method:"POST",credentials:"same-origin",body:i}).then(c)}(e,t)}},91288:(e,t,i)=>{"use strict";i.d(t,{ChartSession:()=>p});var r=i(96276),s=i.n(r),n=i(16282),o=i(65066),a=i.n(o),l=i(75443),c=i(87380);const u=(0,c.getLogger)("ChartApi.AbstractSession");var d=i(31565);const h=(0,c.getLogger)("ChartSession");class p extends class{constructor(e,t,i){this._isConnected=new(a())(!1),this._state=0,this._isConnectForbidden=!1,this._sessionId="",this._sessionIdChanged=new(s()),this._chartApi=e,this._sessionPrefix=t,this._shouldReconnectAfterCriticalError=i}destroy(){this._logNormal("Destroying session"),this._isConnected.unsubscribe(),this.disconnect(),this._sessionIdChanged.destroy(),delete this._chartApi,this._logNormal("Session has been destroyed")}isConnected(){return this._isConnected}sessionId(){return this._sessionId}onSessionIdChanged(){return this._sessionIdChanged}connect(){0===this._state&&((0,n.assert)(!this._isConnectForbidden,"Cannot call connect because it is forbidden at this moment"),this._setSessionId(`${this._sessionPrefix}_${(0,l.randomHash)()}`),this._logNormal("Connecting session - wait until transport stay connected"),this._state=1,this._chartApi.createSession(this._sessionId,this))}disconnect(){0!==this._state&&((0,n.assert)(""!==this._sessionId,"sessionId must not be invalid"),this._logNormal("Disconnecting session..."),this._forbidConnectWhile(()=>{this._chartApi.connected()&&this._sendRemoveSession(),this._processDestroyingOnServer()}))}onMessage(e){switch(e.method){case"connected":return void this._onChartApiConnected();case"disconnected":return void this._onChartApiDisconnected();case"critical_error":const t=String(e.params[0]),i=String(e.params[1]);return void this._onCriticalError(t,i)}this._onMessage(e)}_getChartApi(){return this._chartApi}_generateLogMessage(e){return`[${this._sessionId}] ${e}`}_onCriticalError(e,t){this._logError(`Critical error. Reason=${e}, info=${t}.`),this._forbidConnectWhile(()=>{this._processDestroyingOnServer()}),this._shouldReconnectAfterCriticalError?(this._logNormal("Reconnecting after critical error..."),this.connect()):this._logNormal("Reconnecting after critical error skipped")}_onChartApiConnected(){(0,n.assert)(1===this._state,"Session is not registered"),this._logNormal("Transport is connected. Creating session on the server"),this._sendCreateSession(),this._state=2,this._isConnected.setValue(!0)}_onChartApiDisconnected(){
this._logNormal("Transport is disconnected. Reconnecting..."),this._forbidConnectWhile(()=>{this._processDestroyingOnServer()}),this.connect()}_setSessionId(e){const t=this._sessionId;this._logNormal(`Changing sessionId: old=${t}, new=${e}`),this._sessionId=e,this._sessionIdChanged.fire(e,t)}_logNormal(e){u.logNormal(this._generateLogMessage(e))}_logError(e){u.logError(this._generateLogMessage(e))}_processDestroyingOnServer(){this._state=0,this._isConnected.setValue(!1),this._chartApi.removeSession(this._sessionId),this._setSessionId("")}_forbidConnectWhile(e){this._isConnectForbidden=!0,e(),this._isConnectForbidden=!1}}{constructor(e,t=!1){super(e,"cs",!1),this._sessionDisabled=!1,this._handler=null,this._criticalError=new(s()),this._disableStatistics=t}destroy(){this._criticalError.destroy(),this._handler=null,super.destroy()}serverTimeOffset(){return this._getChartApi().serverTimeOffset()}switchTimezone(e){return this._getChartApi().switchTimezone(this.sessionId(),e)}defaultResolutions(){return this._getChartApi().defaultResolutions()}availableCurrencies(){return this._getChartApi().availableCurrencies()}availableUnits(){return this._getChartApi().availableUnits()}resolveSymbol(e,t,i){return this._getChartApi().resolveSymbol(this.sessionId(),e,t,i)}requestFirstBarTime(e,t,i){return this._getChartApi().requestFirstBarTime(this.sessionId(),e,t,i)}createSeries(e,t,i,r,s,n,o){return this._getChartApi().createSeries(this.sessionId(),e,t,i,r,s,n,o)}modifySeries(e,t,i,r,s,n){return this._getChartApi().modifySeries(this.sessionId(),e,t,i,r,s,n)}removeSeries(e){return!!this.isConnected().value()&&this._getChartApi().removeSeries(this.sessionId(),e)}requestMoreData(e,t,i){return"number"==typeof e?this._getChartApi().requestMoreData(this.sessionId(),e):this._getChartApi().requestMoreData(this.sessionId(),e,t,i)}requestMoreTickmarks(e,t,i){return(0,d.isNumber)(e)?this._getChartApi().requestMoreTickmarks(this.sessionId(),e):this._getChartApi().requestMoreTickmarks(this.sessionId(),e,t,i)}requestMetadata(e,t){const i=()=>this._getChartApi().requestMetadata(this.sessionId(),e,t);window.localForageReady.done(i).fail(e=>{h.logError("localForage is not initialized, cannot proceed. "+e)})}isCanCreateStudy(e){return this._getChartApi().isCanCreateStudy(e)}createStudy(e,t,i,r,s,n,o){return this._getChartApi().createStudy(this.sessionId(),e,t,i,r,s,n,o)}rebindStudy(e,t,i,r,s,n,o){return this._getChartApi().rebindStudy(this.sessionId(),e,t,i,r,s,n,o)}modifyStudy(e,t,i,r){return this._getChartApi().modifyStudy(this.sessionId(),e,t,i,r)}removeStudy(e,t){return this._getChartApi().removeStudy(this.sessionId(),e,t)}createPointset(e,t,i,r,s,n){return this._getChartApi().createPointset(this.sessionId(),e,t,i,r,s,n)}modifyPointset(e,t,i,r){return this._getChartApi().modifyPointset(this.sessionId(),e,t,i,r)}removePointset(e){return this._getChartApi().removePointset(this.sessionId(),e)}setVisibleTimeRange(e,t,i,r,s,n){0}criticalError(){return this._criticalError}connect(e=null){null!==e&&(this._handler=e),super.connect()}setHandler(e){
this._handler=e}connected(){return this.isConnected().value()&&!this._sessionDisabled}disable(){this._sessionDisabled=!0}chartApi(){return this._getChartApi()}_sendCreateSession(){Object.keys(this).forEach(e=>{/^(s|st|symbol_)\d+$/.test(e)&&delete this[e]}),this._getChartApi().chartCreateSession(this.sessionId(),this._disableStatistics)}_sendRemoveSession(){this._getChartApi().chartDeleteSession(this.sessionId())}_onMessage(e){this._handler&&this._handler(e)}_onCriticalError(e,t){this._criticalError.fire(e,t),super._onCriticalError(e,t)}}},78087:(e,t,i)=>{"use strict";var r=i(31565).declareClassAsPureInterface;function s(){}TradingView.WEB_SOCKET_WAS_CONNECTED=!1,s.REBIND_STUDY_STANDALONE_TO_CHILD=1,s.REBIND_STUDY_CHILD_TO_STANDALONE=2,s.prototype.defaultWatchlistSymbols=function(){},s.prototype.defaultResolutions=function(){},s.prototype.availableCurrencies=function(){},s.prototype.availableUnits=function(){},s.prototype.supportedSymbolsTypes=function(){},s.prototype.supportedExchangesList=function(){},s.prototype.symbolsGrouping=function(){},s.prototype.quoteCreateSession=function(e){},s.prototype.quoteDeleteSession=function(e){},s.prototype.quoteSetFields=function(e,t){},s.prototype.quoteAddSymbols=function(e,t){},s.prototype.quoteRemoveSymbols=function(e,t){},s.prototype.quoteFastSymbols=function(e,t){},s.prototype.depthCreateSession=function(e,t,i){},s.prototype.depthDeleteSession=function(e){},s.prototype.depthSetSymbol=function(e,t){},s.prototype.depthClearSymbol=function(e){},s.prototype.depthSetScale=function(e,t){},s.prototype.chartCreateSession=function(e,t){},s.prototype.chartDeleteSession=function(e){},s.prototype.createSession=function(e,t){},s.prototype.removeSession=function(e){},s.prototype.connected=function(){},s.prototype.connect=function(){},s.prototype.disconnect=function(){},s.prototype.switchTimezone=function(e,t){},s.prototype.resolveSymbol=function(e,t,i,r){},s.prototype.createSeries=function(e,t,i,r,s,n,o,a){},s.prototype.removeSeries=function(e,t,i){},s.prototype.modifySeries=function(e,t,i,r,s,n,o){},s.prototype.requestMoreData=function(e,t,i,r){},s.prototype.requestMetadata=function(e,t,i){},s.prototype.isCanCreateStudy=function(e,t){},s.prototype.createStudy=function(e,t,i,r,s,n,o){},s.prototype.rebindStudy=function(e,t,i,r,s,n,o,a){},s.prototype.removeStudy=function(e,t,i){},s.prototype.modifyStudy=function(e,t,i,r,s){},s.prototype.createPointset=function(e,t,i,r,s,n,o){},s.prototype.modifyPointset=function(e,t,i,r,s){},s.prototype.removePointset=function(e,t,i){},s.prototype.requestMoreTickmarks=function(e,t,i,r){},s.prototype.requestFirstBarTime=function(e,t,i,r){},s.prototype._invokeHandler=function(e,t){},s.prototype._sendRequest=function(e,t){},s.prototype._onMessage=function(e){},s.prototype._dispathNotification=function(e){},s.prototype._invokeNotificationHandler=function(e,t,i){},s.prototype._notifySessions=function(e){},s.prototype.unpack=function(e){},s.prototype.searchSymbols=function(e,t,i,r,s,n,o,a,l,c){},s.prototype.serverTimeOffset=function(){},
s.prototype.getMarks=function(e,t,i,r,s){},s.prototype.getTimescaleMarks=function(e,t,i,r,s){},r(s,"ChartApiInterface"),e.exports.HandlerInfo=function(e,t){this.handler=e,this.customId=t},e.exports.ChartApiInterface=s},35582:e=>{"use strict";e.exports=function(){this.set_broker=function(e){return[e]},this.set_data_quality=function(){return["low"]},this.quote_create_session=function(e){return[e]},this.quote_delete_session=function(e){return[e]},this.quote_set_fields=function(e,t){return[e].concat(t)},this.quote_add_symbols=function(e,t){return[e].concat(t)},this.quote_remove_symbols=function(e,t){return[e].concat(t)},this.quote_fast_symbols=function(e,t){return[e].concat(t)},this.quote_hibernate_all=function(e){return[e]},this.depth_create_session=function(e,t,i){return[e,t,i]},this.depth_delete_session=function(e){return[e]},this.depth_set_symbol=function(e,t){return[e,t]},this.depth_clear_symbol=function(e){return[e]},this.depth_set_scale=function(e,t){return[e,t]},this.chart_create_session=function(e,t){return[e,t?"disable_statistics":""]},this.chart_delete_session=function(e){return[e]},this.set_auth_token=function(e){return[e]},this.switch_timezone=function(e,t){return[e,t]},this.resolve_symbol=function(e,t,i){return[e,t,i]},this.create_series=function(e,t,i,r,s,n,o){return[e,t,i=i||"",r,s,n,o]},this.remove_series=function(e,t){return[e,t]},this.modify_series=function(e,t,i,r,s,n){return[e,t,i=i||"",r,s,n]},this.request_more_data=function(e,t,i){return[e,t,i]},this.request_studies_metadata=function(e,t){return[e,t]},this.create_study=function(e,t,i,r,s,n){return[e,t,i=i||"",r,s].concat(n)},this.create_child_study=function(e,t,i,r,s,n){return this.create_study(e,t,i,r,s,n)},this.child_study_rebind=function(e,t,i,r,s,n){return[e,t,i=i||"",r,s].concat(n)},this.remove_study=function(e,t){return[e,t]},this.modify_study=function(e,t,i,r){return[e,t,i=i||""].concat(r)},this.create_pointset=function(e,t,i,r,s,n){return[e,t,i=i||"",r,s].concat(n)},this.modify_pointset=function(e,t,i,r){return[e,t,i=i||""].concat(r)},this.remove_pointset=function(e,t){return[e,t]},this.request_more_tickmarks=function(e,t,i){return[e,t,i]},this.get_first_bar_time=function(e,t,i){return[e,t,i]},this.replay_create_session=function(e){return[e]},this.replay_delete_session=function(e){return[e]},this.replay_reset=function(e,t,i){return[e,t,i]},this.replay_start=function(e,t,i){return[e,t,i]},this.replay_stop=function(e,t){return[e,t]},this.replay_step=function(e,t,i){return[e,t,i]},this.replay_add_series=function(e,t,i,r){return[e,t,i,r]},this.replay_remove_series=function(e,t,i,r){return[e,t,i,r]},this.replay_set_resolution=function(e,t,i){return[e,t,i]},this.convertTimescaleResponse=function(e){for(var t=e.marks,i=0;i<t.length;++i)t[i]={span:t[i][0],time:t[i][1],index:t[i][2]};if(void 0!==e.index_diff){var r=e.index_diff;for(i=0;i<r.length;++i)r[i]={old:r[i][0],new:r[i][1]}}else e.index_diff=[];return e};var e=this;this.getDataUpdateObjects=function(t){return e.getTimescaleObjects(t)},this.getTimescaleObjects=function(e){return e.params[0]},
this.getTimescaleChangeset=function(e){return e.params[1]},this.prepareDataUpdateObjects=function(e,t,i){for(var r in t){var s=t[r],n={};for(var o in n.customId=r,n.turnaround=s.turnaround,n.plots=s.series?s.series:s.plots,s.ns&&(n.nonseries=s.ns),s.lbs&&(n.lastBar={closeTime:s.lbs.bar_close_time}),n.plots)for(var a in n.plots[o].value)1e100===n.plots[o].value[a]&&(n.plots[o].value[a]=void 0);i(e,r,{method:"data_update",params:n})}},this.unpack=function(e){var t,i;function r(e){return e.index=e.i,e.value=e.v,delete e.i,delete e.v,e}function s(e){for(i in e)e[i].t&&(e[i].turnaround=e[i].t),e[i].s&&!e[i].series&&(e[i].series=e[i].s.map(r)),e[i].st&&!e[i].series&&(e[i].series=e[i].st.map(r))}switch((e=JSON.parse(e)).m&&e.p&&(e.method=e.m,e.params=e.p,e.time=e.t),t=e.params[1],e.method){case"qsd":e.method="quote_symbol_data",t.symbolname=t.n,t.status=t.s,t.values=t.v,t.values.change=t.v.ch,t.values.last_price=t.v.lp,t.values.change_percent=t.v.chp,delete t.n,delete t.s,delete t.v,delete t.values.ch,delete t.values.lp,delete t.values.chp;break;case"du":e.method="data_update",s(t);break;case"clear_data":for(i in t)t[i].turnaround=t[i].t;break;case"timescale_update":s(t)}return e},this.prepareEncodeMessage=function(e,t){return JSON.stringify({m:e,p:t})}}},757:(e,t,i)=>{"use strict";e=i.nmd(e);var r=!1,s=!1,n=!1,o=i(6450).showTooManyStudiesNotice,a=i(78087),l=a.ChartApiInterface,c=a.HandlerInfo,u=i(96010).AuthToken,d=i(11767),h=i(10164).telemetry,p=i(35582),_=i(22842),m=i(56598);i(92491);var f=i(3851).enabled,g=i(3851).getConfig,v=i(5803).ProductFeatures,S=i(31565).requireFullInterfaceImplementation,y=i(98006).isFeatureEnabled,b=i(75443).randomHash,w=i(95612).ResponseMethods,P=i(87380),C=P.getLogger("ChartApi.Core",{color:"#706"}),T=P.getLogger("ChartApi.ChartSession",{color:"#706"}),x=P.getLogger("ChartApi.ChartSession",{highRate:!0,maxCount:100,color:"#706"}),I=P.getLogger("ChartApi.ChartSession",{maxCount:0,color:"#706"}),L=P.getLogger("ChartApi.ChartSession",{maxCount:50,color:"#706"}),M=P.getLogger("ChartApi.QuoteSession",{maxCount:50,color:"#660"}),E=P.getLogger("ChartApi.QuoteSession",{highRate:!0,maxCount:10,color:"#660"}),A=P.getLogger("ChartApi.TrafficMeter",{maxCount:20,color:"#268"}),k=i(93175),D=i(65255).exchanges,R=i(36254),N=i(36757).errorToString,O=i(85864).fetch,V=i(62972),B=i(25143).TIMEFRAMETYPE,F=y("broker_id_session");function W(e){function t(e){if(0===e)return"0";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+["","KB","MB","GB","TB"][t]}this._isAuthTokenLoaded=!1,this._authTokenDfd=null,this._notificationHandlers={},this._sessions={},this._dataHandleModule=new p,this.studyCounter=0,this.childStudyCounter=0,this._sendingQueuedRequestsCount=0,this._pendingMessagesQueue=[],this._brokerId="",this._serverTimeOffset=0,this._serverTimeBasePoint=Date.now()-performance.now(),this._trafficStats={total:0,sinceConnect:0,lastChunk:0},this._wsBackendConnection=e,this._wsBackendConnection.onReconnect(this._bindSocketEvents.bind(this)),
this._wsBackendConnection.setLogger(C,P.getLogHistory),this._wsBackendConnection.setTelemetry(h),this._bindSocketEvents(),this._lowQualityEnabled=!1,this._turnaroundPrefix=b(),this._turnaroundIndex=0,setInterval(function(){A.logNormal("Last 30 seconds:"+t(this._trafficStats.lastChunk)+" Since last connect:"+t(this._trafficStats.sinceConnect)+" Total traffic:"+t(this._trafficStats.total)),this._trafficStats.lastChunk=0}.bind(this),3e4)}W.prototype.defaultWatchlistSymbols=function(){var e=k[window.locale];return void 0===e&&(e=k.default),e},W.prototype.defaultResolutions=function(){var e=["1","3","5","15","30","45","60","120","180","240","1D","1W","1M","1000R","100R","10R","1R"];if(!_.enabled("widget")){return["1S","5S","15S","30S"].concat(e)}return e};var U=null;function H(e){if(null===e)return"";if(e.type===B.PeriodBack){var t=e.value;return"YTD"!==t&&"D"===t.slice(-1)&&(t=t.slice(0,-1)),t}return"r,"+e.from+":"+e.to}W.prototype.availableCurrencies=function(){if(null===U){const e=document.querySelector('link[rel~="currencies-config"]'),t=new URL(e.href);U=O(t.toString(),{method:"GET"}).then((function(e){if(!e.ok)throw new Error("Response status is not success");return e.json()}))}return U},W.prototype.availableUnits=function(){return Promise.resolve({})},W.prototype.supportedSymbolsTypes=function(){return"bovespa"===TradingView.widgetCustomer?R.filter((function(e){return-1!==["","stock","futures","index"].indexOf(e.value)})):"cme"===TradingView.widgetCustomer?R.filter((function(e){return e.value!==m.types.QUANDL})):R},W.prototype.supportedExchangesList=function(){return D},W.prototype.symbolsGrouping=function(){return{futures:/^(.+?)([12]!|\w\d{4})?$/}},W.prototype.enableLowQualityMode=function(){this._lowQualityEnabled=!0,this._sendLowQualityModeIfEnabled()},W.prototype._sendLowQualityModeIfEnabled=function(){this._lowQualityEnabled&&this.connected()&&this._sendRequest("set_data_quality",[])},W.prototype.setLoadNew=function(e){this._loadNewBars=!!e},W.prototype.quoteCreateSession=function(e){return this._sendRequest("quote_create_session",[e])},W.prototype.quoteDeleteSession=function(e){return this._sendRequest("quote_delete_session",[e])},W.prototype.quoteSetFields=function(e,t){return this._sendRequest("quote_set_fields",[e,t])},W.prototype.quoteAddSymbols=function(e,t){return this._sendRequest("quote_add_symbols",[e,t])},W.prototype.quoteRemoveSymbols=function(e,t){return this._sendRequest("quote_remove_symbols",[e,t])},W.prototype.quoteFastSymbols=function(e,t){return this._sendRequest("quote_fast_symbols",[e,t])},W.prototype.quoteHibernateAll=function(e){return this._sendRequest("quote_hibernate_all",[e])},W.prototype.depthCreateSession=function(e,t,i){return this._sendRequest("depth_create_session",[e,t,i])},W.prototype.depthDeleteSession=function(e){return this._sendRequest("depth_delete_session",[e])},W.prototype.depthSetSymbol=function(e,t){return this._sendRequest("depth_set_symbol",[e,t])},W.prototype.depthClearSymbol=function(e){return this._sendRequest("depth_clear_symbol",[e])},
W.prototype.depthSetScale=function(e,t){return this._sendRequest("depth_set_scale",[e,t])},W.prototype.chartCreateSession=function(e,t){return this._sendRequest("chart_create_session",[e,t])},W.prototype.chartDeleteSession=function(e){return this._sendRequest("chart_delete_session",[e])},W.prototype.createSession=function(e,t){this._sessions[e]=t,this._notificationHandlers[e]={},this.connected()&&this._isAuthTokenLoaded&&t.onMessage({method:"connected",params:[]})},W.prototype.removeSession=function(e){delete this._sessions[e],delete this._notificationHandlers[e]},W.prototype.connected=function(){return!!this._isConnected},W.prototype._bindSocketEvents=function(){var e=this;this.connectDfd=new Promise((function(t,i){e._wsBackendConnection.on("connect",(function(){e._onConnect(),t()})),e._wsBackendConnection.on("message",e._onMessage.bind(e)),e._wsBackendConnection.on("disconnect",(function(){e._authTokenDfd&&(e._authTokenDfd=null),delete e._isConnected,e.studyCounter=0,e._notifySessions({method:"disconnected",params:[]}),delete e._metadataCallback,e._disconnectCount=(e._disconnectCount||0)+1,e._wsBackendConnection.isConnected()&&(e._telemetryDisconnectTimeout=setTimeout((function(){h.sendChartReport("disconnect")}),5e3),e._wsBackendConnection.isMaxReconnects()&&(e._notifySessions({method:"reconnect_bailout",params:[]}),i(),h.sendChartReport("reconnect_bailout")))}))}))},W.prototype.setBroker=function(e){return e===this._brokerId||(this._brokerId=e,this._sendBrokerIdToSession(this._brokerId))},W.prototype.serverTimeOffset=function(){return this._serverTimeOffset},W.prototype.serverTime=function(){return Math.round(this._serverTimeBasePoint+performance.now())},W.disconnectReason=function(e){
return 1e3===e?"Normal closure, meaning that the purpose for which the connection was established has been fulfilled.":1001===e?'An endpoint is "going away", such as a server going down or a browser having navigated away from a page.':1002===e?"An endpoint is terminating the connection due to a protocol error":1003===e?"An endpoint is terminating the connection because it has received a type of data it cannot accept (e.g., an endpoint that understands only text data MAY send this if it receives a binary message).":1004===e?"Reserved. The specific meaning might be defined in the future.":1005===e?"No status code was actually present.":1006===e?"The connection was closed abnormally, e.g., without sending or receiving a Close control frame":1007===e?"An endpoint is terminating the connection because it has received data within a message that was not consistent with the type of the message (e.g., non-UTF-8 [http://tools.ietf.org/html/rfc3629] data within a text message).":1008===e?'An endpoint is terminating the connection because it has received a message that "violates its policy". This reason is given either if there is no other sutible reason, or if there is a need to hide specific details about the policy.':1009===e?"An endpoint is terminating the connection because it has received a message that is too big for it to process.":1010===e?"An endpoint (client) is terminating the connection because it has expected the server to negotiate one or more extension, but the server didn't return them in the response message of the WebSocket handshake. <br /> Specifically, the extensions that are needed are: "+event.reason:1011===e?"A server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request.":1015===e?"The connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified).":"Unknown reason"},W.prototype._sendBrokerIdToSession=function(e){return!F||this._sendRequest("set_broker",[e])},W.prototype._getAuthTokenDfd=function(e){if(this._loadNewBars)return Promise.resolve("load_new_token");if(_.enabled("widget")||-1!==window.location.search.indexOf("widget_token")||-1!==window.location.hash.indexOf("widget_token")){var t=window.TradingView&&window.TradingView.widgetCustomer||"";return Promise.resolve(V[t]||"widget_user_token")}if(!window.is_authenticated)return Promise.resolve("unauthorized_user_token");var i=this;if(!i._authTokenManager){var r=new u;i._authTokenManager=r,i._authTokenManager.invalidated.subscribe(null,(function(e){i._authTokenManager.get().then((function(e){e&&i.connected()&&i._sendRequest("set_auth_token",[e])}))}))}return i._authTokenManager.get(e)},W.prototype._onConnect=function(){if(!this.connected()){this._trafficStats.sinceConnect=0,this._isAuthTokenLoaded=!1;var e=this;if(this._connectOnlyOptions=this._connectOnlyOptions||{},this._authTokenDfd=this._getAuthTokenDfd(this._connectOnlyOptions.tokenGrabSession),this._connectOnlyOptions={},
this.sessionid=this._wsBackendConnection.getSessionId(),this.sessionid&&!this._isConnected){this._pendingMessagesQueue=[],this._sendingQueuedRequestsCount=0,this._isConnected=!0;var t=JSON.parse(this.sessionid);this._sendLowQualityModeIfEnabled(),this._metadataServerHash=t.studies_metadata_hash||null;var i=this._wsBackendConnection.getConnectionEstablished();try{var r=(performance.now()-i)/1e3,n=t.timestamp+r;this._serverTimeOffset=n-Date.now()/1e3,this._serverTimeBasePoint=Math.round(1e3*t.timestamp-i)}catch(e){this._serverTimeOffset=0,this._serverTimeBasePoint=Date.now()-performance.now()}if(C.logInfo("Time shift with server:"+Math.round(this._serverTimeOffset)+" seconds."),this._authTokenDfd){this._sendingQueuedRequestsCount+=1,C.logInfo("Wait for auth token before send messages");var o=this._authTokenDfd;o.then((function(t){null!==e._authTokenDfd&&e._authTokenDfd===o?(C.logNormal("Auth token request is finished, token: "+Boolean(t)),e._authTokenDfd=null,t&&e._pendingMessagesQueue.unshift({method:"set_auth_token",args:[t]}),e._onSendingQueueRequestFinished(),e._isAuthTokenLoaded=!0,e._notifySessions({method:"connected",params:[]})):C.logNormal("Comes auth token after requesting new token or after socket disconnected")})).catch((function(e){C.logNormal(N(e))}))}else C.logWarn("Deferred auth token object is not valid"),this._isAuthTokenLoaded=!0;""!==this._brokerId&&this._sendBrokerIdToSession(this._brokerId);var a=this._wsBackendConnection.getConnectionStart();TradingView.WEB_SOCKET_WAS_CONNECTED=!0,h.setSessionInfo(this.sessionid),h.sendChartReport("websocket_connected"),h.sendChartReport("websocket_connection_time_frame",{value:i-a}),h.sendChartReport("reconnect_count_frame",{value:this._wsBackendConnection.getReconnectCount()}),h.sendChartReport("redirect_count_frame",{value:this._wsBackendConnection.getRedirectCount()}),s||(s=!0,h.sendChartReport("before_websocket_connection_time_frame",{value:a})),this._wsBackendConnection.resetCounters(),clearTimeout(this._telemetryDisconnectTimeout)}}},W.prototype.connect=function(e){this._connectOnlyOptions=e,this._wsBackendConnection.isConnected()||this._wsBackendConnection.isConnecting()||this._wsBackendConnection.connect()},W.prototype.disconnect=function(e){return this._wsBackendConnection.disconnect(),!0},W.prototype.switchTimezone=function(e,t){return this._sendRequest("switch_timezone",[e,t])},W.prototype.resolveSymbol=function(e,t,i,r){return h.timeCounters.series["resolve_symbol_"+e]=window.performance.now(),this._notificationHandlers[e][t]=new c(r,t),this._sendRequest("resolve_symbol",[e,t,i])},W.prototype.createSeries=function(e,t,i,r,s,n,o,a){this._notificationHandlers[e][t]=new c(a,t),h.timeCounters.series.marks.push("create_series_"+e);const l=H(o);return this._sendRequest("create_series",[e,t,i,r,s,n,l])},W.prototype.removeSeries=function(e,t){return delete this._notificationHandlers[e][t],this._sendRequest("remove_series",[e,t])},W.prototype.modifySeries=function(e,t,i,r,s,n,o){this._notificationHandlers[e][t]=new c(o,t);const a=H(n)
;return this._sendRequest("modify_series",[e,t,i,r,s,a])},W.prototype.requestMoreData=function(e,t,i,r){if("number"!=typeof i)throw new Error("unsupported request to load more data, bars="+i);return this._notificationHandlers[e][t]=new c(r,t),this._sendRequest("request_more_data",[e,t,i])},W.prototype.requestMetadata=function(e,t,i){var r=this;if(r._metadataCallback)r._metadataCallback.handlers.push(i);else{var s=_.enabled("widget"),n=s?"studies_metadata_widget":"studies_metadata",o=[];r._metadataCallback=function(e){r._metadataCallback=null,TVLocalForage.setItem(n,TradingView.clone(e)).then((function(){if(C.logNormal("Updated studies_metadata cache"),!s){var e=pro.hash();TVLocalForage.setItem("pro_hash",TradingView.clone(e)).then((function(){C.logNormal("Updated pro_hash cache")})).catch((function(e){C.logError("Cannot update pro_hash cache, reason: "+e)}))}})).catch((function(e){C.logError("Cannot update studies_metadata cache, reason: "+e)}));for(var t=0;t<o.length;t++){(0,o[t])(TradingView.clone(e))}},r._metadataCallback.handlers=o,r._metadataCallback.handlers.push(i),C.logNormal("Requesting pro hash"),TVLocalForage.getItem("pro_hash").then((function(i){var o=pro.hash();null!==i&&i===o||s?(C.logNormal("Pro hash has not changed, requesting from local"),TVLocalForage.getItem(n).then((function(i){var s=null!==i&&i.params[1].hash||null;if(null===s||null===r._metadataServerHash||r._metadataServerHash!==s)return C.logNormal("Metadata hash has changed (cached:'"+s+"', server:'"+r._metadataServerHash+"'')"),void r._requestMetadataFromServer(e,t,r._metadataCallback);if(pro.hasPackage("tv-volumebyprice")&&void 0===i.params[1].metainfo.find((function(e){return e.id.includes("@tv-volumebyprice")})))return C.logNormal("De-sync detected! pro.hash contains VbPR studies, but data from cache doesn't and pro.hash isn't changed, pro.hash="+o),void r._requestMetadataFromServer(e,t,r._metadataCallback);if(C.logNormal("Using studies_metadata from browser cache"),r._metadataCallback){for(var n=0;n<r._metadataCallback.handlers.length;n++){(0,r._metadataCallback.handlers[n])(TradingView.clone(i))}r._metadataCallback=null}else C.logWarn("Cached metadata received, but callback expired")})).catch((function(i){C.logError("Cannot get studies_metadata, reason: "+i),r._requestMetadataFromServer(e,t,r._metadataCallback)}))):(C.logNormal("Pro hash has changed (cached: '"+i+"', current:'"+o+"')"),r._requestMetadataFromServer(e,t,r._metadataCallback))})).catch((function(i){C.logError("Cannot get studies_metadata, reason: "+i),r._requestMetadataFromServer(e,t,r._metadataCallback)}))}},W.prototype.authTokenManager=function(){return this._authTokenManager},W.prototype._requestMetadataFromServer=function(e,t,i){return!!i&&(C.logNormal("Request studies_metadata from server"),this._notificationHandlers[e][t]=new c(i,t),this._sendRequest("request_studies_metadata",[e,t]))},W.prototype.isCanCreateStudy=function(e,t){if(!f(v.STUDY_ON_STUDY))return!1;var i=g(v.STUDY_ON_STUDY);return!0===e?this.childStudyCounter<i.child_limit:this.studyCounter<i.limit},
W.prototype.createStudy=function(e,t,i,r,s,n,a,l){if(!this.isCanCreateStudy())return o(),!1;this._notificationHandlers[e][t]=new c(a,t);var u=this._sendRequest(!0===l?"create_child_study":"create_study",[e,t,i,r,s,n]);return!1!==u&&(this.studyCounter++,l&&this.childStudyCounter++,u)},W.prototype.rebindStudy=function(e,t,i,r,s,n,o,a){if(a===l.REBIND_STUDY_STANDALONE_TO_CHILD){if(!this.isCanCreateStudy(!0))return!1;this.childStudyCounter++}else a===l.REBIND_STUDY_CHILD_TO_STANDALONE&&this.childStudyCounter--;return i=i||"",this._notificationHandlers[e][t]=new c(o,t),this._sendRequest("child_study_rebind",[e,t,i,r,s,n]),!0},W.prototype.removeStudy=function(e,t,i){delete this._notificationHandlers[e][t];var r=this._sendRequest("remove_study",[e,t]);return!1!==r&&(this.studyCounter--,i&&this.childStudyCounter--,r)},W.prototype.modifyStudy=function(e,t,i,r,s){return this._notificationHandlers[e][t]=new c(s,t),this._sendRequest("modify_study",[e,t,i,r])},W.prototype.createPointset=function(e,t,i,r,s,n,o){return this._notificationHandlers[e][t]=new c(o,t),this._sendRequest("create_pointset",[e,t,i,r,s,n])},W.prototype.modifyPointset=function(e,t,i,r,s){return this._notificationHandlers[e][t]=new c(s,t),this._sendRequest("modify_pointset",[e,t,i,r])},W.prototype.removePointset=function(e,t,i){return this._notificationHandlers[e][t]=new c(i,t),this._sendRequest("remove_pointset",[e,t])},W.prototype.requestMoreTickmarks=function(e,t,i,r){return this._notificationHandlers[e][t]=new c(r,t),this._sendRequest("request_more_tickmarks",[e,t,i])},W.prototype.requestFirstBarTime=function(e,t,i,r){return this._notificationHandlers[e][t]=new c(r,t),this._sendRequest("get_first_bar_time",[e,t,i])},W.prototype._generateNextTurnaround=function(){var e=this._turnaroundPrefix+this._turnaroundIndex;return this._turnaroundIndex+=1,e},W.prototype.replayCreateSession=function(e){return this._sendRequest("replay_create_session",[e])},W.prototype.replayDeleteSession=function(e){return this._sendRequest("replay_delete_session",[e])},W.prototype.replayReset=function(e,t,i){var r=this._generateNextTurnaround();return this._notificationHandlers[e][r]=new c(i,r),this._sendRequest("replay_reset",[e,r,t])},W.prototype.replayStart=function(e,t,i){var r=this._generateNextTurnaround();return this._notificationHandlers[e][r]=new c(i,r),this._sendRequest("replay_start",[e,r,t])},W.prototype.replayStop=function(e,t){var i=this._generateNextTurnaround();return this._notificationHandlers[e][i]=new c(t,i),this._sendRequest("replay_stop",[e,i])},W.prototype.replayStep=function(e,t,i){var r=this._generateNextTurnaround();return this._notificationHandlers[e][r]=new c(i,r),this._sendRequest("replay_step",[e,r,t])},W.prototype.replayAddSeries=function(e,t,i,r){var s=this._generateNextTurnaround();return this._notificationHandlers[e][s]=new c(r,s),this._sendRequest("replay_add_series",[e,s,t,i])},W.prototype.replayRemoveSeries=function(e,t,i,r){var s=this._generateNextTurnaround();return this._notificationHandlers[e][s]=new c(r,s),
this._sendRequest("replay_remove_series",[e,s,t,i])},W.prototype.replaySetResolution=function(e,t,i){var r=this._generateNextTurnaround();return this._notificationHandlers[e][r]=new c(i,r),this._sendRequest("replay_set_resolution",[e,r,t])},W.prototype.redirectCount=function(){return this._wsBackendConnection.getRedirectCount()},W.prototype.disconnectCount=function(){return this._disconnectCount||0},W.prototype._invokeHandler=function(e,t){e&&e(t)},W.prototype._flushPendingMessages=function(){C.logInfo("Flush pending messages. Count="+this._pendingMessagesQueue.length),this._pendingMessagesQueue.forEach((function(e){this._sendRequest(e.method,e.args)}),this),this._pendingMessagesQueue=[]},W.prototype._sendRequest=function(e,t){if(0!==this._sendingQueuedRequestsCount)return this._pendingMessagesQueue.push({method:e,args:t}),!0;var i=this._dataHandleModule[e].apply(this._dataHandleModule,t),r={m:e,p:i},s=JSON.stringify(r);if(i.length>0){var n=i[0];n.startsWith("qs_")?M.logNormal("send: "+s):n.startsWith("cs_")&&T.logNormal("send: "+s)}else C.logNormal("send: "+s);var o=this._dataHandleModule.prepareEncodeMessage(e,i);return this._wsBackendConnection.send(o)},W.prototype._onMessage=function(e){this._calcTrafficStats(e);var t=this.unpack(e);"protocol_switched"!==t.method?this._dispathNotification(t,e):C.logError("Unexpected protocol changing request, try skipping. Requested protocol:"+t.params[0])},W.prototype._onSendingQueueRequestFinished=function(){this._sendingQueuedRequestsCount-=1,C.logInfo("Sending queue request finished. Remaining pending requests="+this._sendingQueuedRequestsCount),this._sendingQueuedRequestsCount<0&&C.logError("Invalid queue state="+this._sendingQueuedRequestsCount),0===this._sendingQueuedRequestsCount&&this._flushPendingMessages()},W.prototype._convertTimescaleResponse=function(e){return this._dataHandleModule.convertTimescaleResponse(e)},W.prototype._appendDuration=function(e,t){return e?t+", duration: "+Math.round(Date.now()/1e3-e+this._serverTimeOffset)+"s":t},W.prototype._dispathNotification=function(e,t){var i=e.params.shift();if(this._notificationHandlers[i]){var s=e.params[0];if("symbol_resolved"===e.method){var o=e.params[1].full_name;h.sendChartReport("symbol_resolved",{count:1,additional:{symbol:o}});var a=h.timeCounters.series["resolve_symbol_"+i];"number"==typeof a&&h.sendChartReport("symbol_resolve_time_frame",{value:window.performance.now()-a,additional:{symbol:o}})}if(["series_error","series_completed"].includes(e.method)&&h.timeCounters.series.marks.length>0){var l="create_series_"+i,c=h.timeCounters.series.marks.indexOf(l);c>=0&&h.timeCounters.series.marks.splice(c,1)}n||"series_error"!==e.method||(n=!0);var u=this._wsBackendConnection.getConnectionEstablished();if(null!==u&&"series_completed"===e.method&&(n||(n=!0,h.sendChartReport("first_series_full_time_frame",{value:window.performance.now()-u}),h.timeCounters.series.marks=[]),r||(r=!0,h.sendChartReport("page_full_load_time_frame",{value:window.performance.now()}))),i.startsWith("cs_")){var d="recv: "+t
;"data_update"===e.method?(d=P.isHighRateEnabled()?d:d.slice(0,500),x.logNormal(this._appendDuration(e.time,d))):"study_loading"===e.method?I.logNormal(this._appendDuration(e.time,d)):"tickmark_update"===e.method?L.logNormal(this._appendDuration(e.time,d)):T.logNormal(this._appendDuration(e.time,d))}if(i.startsWith("qs_"))("quote_symbol_data"===e.method?E.logNormal:M.logNormal)("recv: "+t);switch(e.method){case"timescale_update":var p=this._dataHandleModule.getTimescaleObjects(e),_=this._dataHandleModule.getTimescaleChangeset(e);(m=this._convertTimescaleResponse(_)).clear=0===m.changes.length&&0===m.index_diff.length&&0===m.marks.length,this._sessions[i].onMessage({method:"timescale_update",params:m}),this._dataHandleModule.prepareDataUpdateObjects(i,p,function(e,t,i){this._invokeNotificationHandler(e,t,i)}.bind(this));break;case"tickmark_update":var m;(m=this._convertTimescaleResponse(e.params[0])).changes=[],this._sessions[i].onMessage({method:"timescale_update",params:m});break;case"data_update":p=this._dataHandleModule.getDataUpdateObjects(e);this._dataHandleModule.prepareDataUpdateObjects(i,p,function(e,t,i){this._invokeNotificationHandler(e,t,i)}.bind(this));break;case"index_update":for(var f in e.params[0]){var g={method:"index_update",params:e.params[0][f]};this._invokeNotificationHandler(i,f,g)}break;case"critical_error":C.logInfo(new Date+" critical_error session:"+this.sessionid+" reason:"+e.params[0]),h.sendChartReport("critical_error"),this._sessions[i].onMessage({method:"critical_error",params:e.params});break;case"timescale_completed":case"quote_symbol_data":case"quote_list_fields":case"quote_completed":case"depth_symbol_error":case"depth_symbol_success":case"dd":case"dpu":case"depth_bar_last_value":this._sessions[i].onMessage({method:e.method,params:e.params});break;case"clear_data":for(var v in e.params[0])this._invokeNotificationHandler(i,v,{method:"clear_data",params:e.params[0][v]});break;case w.point:case w.resolutions:case w.endOfData:case w.instanceId:this._sessions[i].onMessage(e);break;case"series_timeframe":e.params[4]=function(e){if(null==e)return null;var t=/r,(\d+):(\d+)/.exec(e);return null!==t?{from:Number(t[1]),to:Number(t[2]),type:B.TimeRange}:{value:e,type:B.PeriodBack}}(e.params[4]),this._invokeNotificationHandler(i,s,e);break;case"symbol_resolved":!function(e){if(void 0===e.corrections){var t=e.subsessions.find((function(t){return t.id===e.subsession_id}));void 0!==t&&(e.corrections=t["session-correction"])}}(e.params[1]),this._invokeNotificationHandler(i,s,e);break;default:this._invokeNotificationHandler(i,s,e)}}},W.prototype._isStrategy=function(e,t){var i=this._notificationHandlers[e][t];return i&&i.handler&&i.handler.isTVScriptStrategy},W.prototype._invokeNotificationHandler=function(e,t,i){if(void 0!==t){var r=this._notificationHandlers[e][t];0===i.method.indexOf("replay_")&&delete this._notificationHandlers[e][t],void 0!==r&&this._invokeHandler(r.handler,i)}},W.prototype._notifySessions=function(e){for(var t in this._sessions){if(!this._sessions.hasOwnProperty(t))return
;var i=this._sessions[t];"function"==typeof i.onMessage&&i.onMessage(e)}},W.prototype.unpack=function(e){return this._dataHandleModule.unpack(e)},W.prototype._symbolSearchRequest=null,W.prototype.searchSymbols=function(e,t,i,r,s,n,o,a,l,c){var u=this;this._symbolSearchRequest&&this._symbolSearchRequest.abort();var p=location.protocol+"//"+window.SS_HOST;d.isProd()?p+="/symbol_search/":p+="/local_search/",window.SS_URL&&(p=window.SS_URL);var _={text:e,exchange:t,type:i,hl:s,lang:r};window.SS_DOMAIN_PARAMETER&&(_.domain=window.SS_DOMAIN_PARAMETER),n&&(_.strict=1),i===m.types.QUANDL&&(p="https://quandlapi.tradingview.com/api/v3/datasets.json",_={query:e,database_code:t}),o&&(_.broker=o,a&&(_.tradable=!0),l&&(_.unhide=l));var f=Object.keys(_).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(_[e])})).join("&"),g=new XMLHttpRequest;g.open("GET",p+"?"+f);var v=window.performance.now();function S(){h.sendChartReport("symbol_search_time_frame",{value:window.performance.now()-v})}function y(){S(),h.sendChartReport("symbol_search_http_error"),u._symbolSearchRequest=null}g.addEventListener("load",(function(){var e=JSON.parse(g.responseText);c&&c(e),S(),h.sendChartReport("symbol_search_http_status",{value:g.status}),u._symbolSearchRequest=null})),g.addEventListener("error",y),g.addEventListener("timeout",y),this._symbolSearchRequest=g,g.send()},W.prototype.getMarks=function(e,t,i,r,s){throw Error("This method is not implemented")},W.prototype.getTimescaleMarks=function(e,t,i,r,s){throw Error("This method is not implemented")},W.prototype.getPingInfo=function(){return this._wsBackendConnection.getPingInfo()},W.prototype._calcTrafficStats=function(e){var t=e.length;this._trafficStats.total+=t,this._trafficStats.sinceConnect+=t,this._trafficStats.lastChunk+=t},S(W,"TVChartApi",l,"ChartApiInterface"),window.ChartApiInstance=new W(window.WSBackendConnection),e&&e.exports&&(e.exports=W)},83291:(e,t,i)=>{"use strict";i.d(t,{reconnectChartApi:()=>r,setBroker:()=>s});i(757);function r(e){const t=window.ChartApiInstance;window.is_authenticated&&(t.disconnect(),e&&t.authTokenManager().reset(),setTimeout(()=>t.connect(),500))}function s(e){window.ChartApiInstance.setBroker(e)}},20895:(e,t,i)=>{"use strict";i.d(t,{backend:()=>r});const r=i(11008)},25143:(e,t,i)=>{"use strict";var r,s;function n(e,t){return"period-back"===e.type&&"period-back"===t.type?e.value===t.value:"time-range"===e.type&&"time-range"===t.type&&(e.from===t.from&&e.to===t.to)}i.d(t,{TIMEFRAMETYPE:()=>s,areEqualTimeFrames:()=>n}),function(e){e.extractErrorReason=function(e){return e.params[1]}}(r||(r={})),function(e){e.PeriodBack="period-back",e.TimeRange="time-range"}(s||(s={}))},6798:(e,t,i)=>{"use strict";i.r(t),i.d(t,{getQuoteSessionInstance:()=>o,setQuoteSessionInstance:()=>a,getQuoteSessionNoEnsure:()=>l,destroyQuoteSessions:()=>c});var r=i(70447),s=i.n(r);const n={};function o(e="full"){return n[e]||a(e,new(s())(e)),n[e]}function a(e="full",t){n[e]=t}function l(e="full"){return n[e]}function c(){for(const e in n)if(n.hasOwnProperty(e)){const t=n[e]
;void 0!==t&&t.destroy(),delete n[e]}}},63404:(e,t,i)=>{"use strict";e=i.nmd(e);var r=i(75443).randomHash;function s(e){this._chartApi=e,this._sessionid="qs_"+r(),this._sessionstarted=!1}s.prototype.destroy=function(){this._sessionstarted&&(this._chartApi.quoteDeleteSession(this._sessionid),this._sessionid=null,this._sessionstarted=!1)},s.prototype.connected=function(){return this._chartApi.connected()},s.prototype.connect=function(e){this._globalHandler=e,this._chartApi.createSession(this._sessionid,this),this._chartApi.connect()},s.prototype.disconnect=function(){this._chartApi.disconnect()},s.prototype.quoteAddSymbols=function(e){this._chartApi.quoteAddSymbols(this._sessionid,e)},s.prototype.quoteRemoveSymbols=function(e){this._chartApi.quoteRemoveSymbols(this._sessionid,e)},s.prototype.quoteFastSymbols=function(e){this._chartApi.quoteFastSymbols(this._sessionid,e)},s.prototype.quoteSetFields=function(e){this._chartApi.quoteSetFields(this._sessionid,e)},s.prototype.onMessage=function(e){switch(e.method){case"connected":this._sessionstarted||(this._chartApi.quoteCreateSession(this._sessionid),this._sessionstarted=!0);break;case"disconnected":this._sessionstarted=!1}this._globalHandler(e)},s.prototype.quoteHibernateAll=function(e){this._chartApi.quoteHibernateAll(this._sessionid)},TradingView.QuoteSession=s,e&&e.exports&&(e.exports=s)},70447:(e,t,i)=>{"use strict";e=i.nmd(e);var r=i(96276),s=i(58848).default,n=i(99479).default,o=i(11228).PriceFormatter;const{uniq:a}=i(94972);var l,c=i(75443),u=i(24754).parseUpdateMode,d=i(21318).deepExtend;function h(e,t){this.options=Object.assign({throttleTimeout:125},t),this._connected=!1,this._symbol_data={},this._subscriptions={},this.onConnect=new r,this.onDisconnect=new r,this._quoteApi=new l(window.ChartApiInstance),this._type=e||"full",this._delayUpdateFastSymbols=n(this._updateFastSymbols,250),this._throttledSymbolData={},this._formatterValuesCache={},this._waitingForFormatters={},this._snapshotValuesCache={},this._waitingForSnapshot={},this.connect()}l=i(63404),h.prototype.destroy=function(){this._quoteApi.destroy(),this._quoteApi=null,this._connected=!1,this.onDisconnect.fire()},h.prototype.typeFields={},h.prototype.typeFields.simple=["base-currency-logoid","ch","chp","currency-logoid","currency_code","current_session","description","exchange","format","fractional","is_tradable","language","local_description","logoid","lp","lp_time","minmov","minmove2","original_name","pricescale","pro_name","short_name","type","update_mode","volume"],h.prototype.typeFields.simpleDetailed=[].concat(h.prototype.typeFields.simple,["ask","bid","fundamentals","high_price","is_tradable","low_price","open_price","prev_close_price","rch","rchp","rtc","rtc_time","status","basic_eps_net_income","beta_1_year","earnings_per_share_basic_ttm","industry","market_cap_basic","price_earnings_ttm","sector","volume","dividends_yield","timezone"]),h.prototype.typeFields.full=[],h.prototype.typeFields.watchlist=[].concat(h.prototype.typeFields.simple,["rchp","rtc","country_code","provider_id"]),
h.prototype.typeFields.portfolio=["pro_name","short_name","exchange","description","sector","type","industry","currency_code","currency_id","ch","chp","logoid","currency-logoid","base-currency-logoid","earnings_per_share_forecast_next_fq","earnings_release_next_date","earnings_release_date","earnings_per_share_fq","lp","fractional","minmov","minmove2","pricescale","volume","average_volume","market_cap_basic","total_revenue","earnings_per_share_basic_ttm","price_earnings_ttm","beta_1_year","dps_common_stock_prim_issue_fy","dividends_yield","fundamental_currency_code"],h.prototype.connect=function(e){this._quoteApi.connect(this.quoteHandler.bind(this))},h.prototype.quoteHandler=function(e){var t=e.method,i=e.params;switch(t){case"connected":this._connected||(this._connected=!0,this.onConnected());break;case"quote_list_fields":break;case"quote_symbol_data":this._connected&&this.onSymbolData(i[0]);break;case"quote_completed":this._connected&&this.onSymbolData({symbolname:i[0],complete:performance.now(),values:{}});break;case"disconnected":this._connected&&(this._connected=!1,this.onDisconnect.fire())}},h.prototype.onConnected=function(){this.setFields();var e=Object.keys(this._symbol_data);e.length&&(this._quoteApi.quoteAddSymbols(e),this._delayUpdateFastSymbols()),this.onConnect.fire()},h.prototype.setFields=function(){var e=h.prototype.typeFields[this._type];e&&e.length&&this._quoteApi.quoteSetFields(e)},h.prototype.onSymbolData=function(e){var t=e.symbolname,i=this._throttledSymbolData[t];i||(i=this._throttledSymbolData[t]={fnDispatch:s(this.dipatchSymbolData.bind(this),this.options.throttleTimeout)}),i.cache?d(i.cache,e):i.cache=e,i.fnDispatch(t)},h.prototype._parseUpdateMode=function(e){var t=u(e.update_mode);null!==t&&(e.update_mode=t.mode,e.update_mode_seconds=t.interval)},h.prototype.dipatchSymbolData=function(e){var t=this._symbol_data[e],i=this._throttledSymbolData[e].cache;if(delete this._throttledSymbolData[e].cache,this._symbol_data[e])for(var r in d(t,i),t.values&&this._parseUpdateMode(t.values),this._subscriptions){var s=this._subscriptions[r];s.has(e)&&s.get(e).forEach((function(e){e(t,i)}))}},h.prototype.subscribe=function(e,t,i){this._subscriptions[e]=this._subscriptions[e]||new Map;var r=this._subscriptions[e];t=[].concat(t);var s=[];t.forEach((function(e){this._symbol_data[e]?r&&r.has(e)||this._symbol_data[e].subscribers_count++:(this._symbol_data[e]={subscribers_count:1},s.push(e)),r.has(e)||r.set(e,[]),r.get(e).push(i),r.get(e).fast=!0,this._symbol_data[e]&&this._symbol_data[e].values&&i(this._symbol_data[e],this._symbol_data[e])}),this),s.length&&this._connected&&(this._quoteApi.quoteAddSymbols(s),this._delayUpdateFastSymbols())},h.prototype.unsubscribe=function(e,t,i){t=[].concat(t);for(var r=this._subscriptions[e],s=[],n=0;n<t.length;n++){var o=t[n];if(r)if(r.has(o)&&i){var a=r.get(o).indexOf(i);~a&&r.get(o).splice(a,1),r.get(o).length||r.delete(o)}else r.delete(o);r&&0===r.size&&delete this._subscriptions[e],
this._symbol_data.hasOwnProperty(o)&&(r&&!r.has(o)&&this._symbol_data[o].subscribers_count--,this._symbol_data[o].subscribers_count||(delete this._symbol_data[o],s.push(o)))}s.length&&this._connected&&(this._quoteApi.quoteRemoveSymbols(s),this._delayUpdateFastSymbols())},h.prototype.setFastSymbols=function(e,t){if(this._subscriptions[e])for(var i=this._subscriptions[e],r=Array.from(i.keys()),s=0;s<r.length;++s){var n=r[s];i.get(n).fast=-1!==t.indexOf(n)}this._delayUpdateFastSymbols()},h.prototype._updateFastSymbols=function(){if(this._connected){var e=this._fastSymbols();0===e.length?this._quoteApi.quoteHibernateAll():this._quoteApi.quoteFastSymbols(e)}},h.prototype._delayUpdateFastSymbols=h.prototype._updateFastSymbols,h.prototype._fastSymbols=function(){var e=[];for(var t in this._subscriptions)for(var i=this._subscriptions[t],r=Array.from(i.keys()),s=0;s<r.length;++s){var n=r[s];i.get(n).fast&&e.push(n)}return e=a(e)},h.prototype.formatter=function(e,t){var i=this;if(this._waitingForFormatters[e])return this._waitingForFormatters[e];function r(e){var i=t&&!e.fractional?1:e.minmov;return new o(e.pricescale,i,e.fractional,e.minmove2)}var s=new Promise((function(t,s){if(i._formatterValuesCache[e])t(r(i._formatterValuesCache[e]));else{var n=c.guid();i.subscribe(n,[e],(function(o){"error"===o.status&&(i._waitingForFormatters[e]=null,s("Quotes snapshot is not received")),function(e){return e&&null!=e.pricescale&&null!=e.minmov}(o.values)&&(i._waitingForFormatters[e]=null,i._formatterValuesCache[e]=o.values,t(r(o.values)),i.unsubscribe(n,e))}))}}));return this._waitingForFormatters[e]=s,s},h.prototype.snapshot=function(e){var t=this;if(this._waitingForSnapshot[e])return this._waitingForSnapshot[e];var i=new Promise((function(i,r){if(t._snapshotValuesCache[e])i(t._snapshotValuesCache[e]);else{var s=c.guid();t.subscribe(s,[e],(function(n){"error"===n.status&&(t._waitingForSnapshot[e]=null,r("Quotes snapshot is not received"));var o=n.values;o&&o.minmov&&o.pricescale&&o.description&&(t._waitingForSnapshot[e]=null,t._snapshotValuesCache[e]=o,i(o),t.unsubscribe(s,e))}))}}));return this._waitingForSnapshot[e]=i,i},TradingView.QuoteSessionMultiplexer=h,e&&e.exports&&(e.exports=h)},61991:(e,t,i)=>{"use strict";function r(e,t,i){const r=e.get(t);return void 0!==r?r:(e.set(t,i),i)}function s(e,t,i,s){const n=r(e,t,new Map);return r(n,i,s)}function n(e,t,i,s,n){const o=r(e,t,new Map),a=r(o,i,new Map);return r(a,s,n)}i.d(t,{getDefault2:()=>s,getDefault3:()=>n,AbstractMapContainer:()=>o});class o{constructor(){this._map=new Map,this._size=0}size(){return this._size}clear(){this._map.clear(),this._size=0}}},4543:(e,t,i)=>{"use strict";function r(e,t){return e<t}function s(e,t,i,r,s){let n=s-r;for(;0<n;){const s=n>>1,o=r+s;i(e(o),t)?(r=o+1,n-=s+1):n=s}return r}function n(e,t,i,r=0,n=e.length){return s(t=>e[t],t,i,r,n)}function o(e,t,i=0,s=e.length){return n(e,t,r,i,s)}function a(e,t,i,r=0,s=e.length){let n=s-r;for(;0<n;){const s=n>>1,o=r+s;i(t,e[o])?n=s:(r=o+1,n-=s+1)}return r}function l(e,t){return e.filter(e=>!t.includes(e))}
function c(e,t){const i=e.indexOf(t);return i<0?e.slice():[t].concat(e.slice(0,i)).concat(e.slice(i+1))}function u(e,t,i){const r=new Set(t),s=[],n=[],a=[];return e.forEach((e,t)=>{r.has(e)?n.push(e):(s.push(e),a.push(t))}),i=i<e.length-1?o(a,i+1):s.length,s.splice(i,0,...n),{newItems:s,movedItemsStartIndex:i}}function d(e,t,i){const r=new Set(t),s=[],n=[],a=[];return e.forEach((e,t)=>{r.has(e)?n.push(e):(s.push(e),a.push(t))}),i=i<=e.length-1?o(a,i):s.length,s.splice(i,0,...n),{newItems:s,movedItemsStartIndex:i}}function h(e,t){const i=new Set;return e.forEach(e=>{t.has(e)&&i.add(e)}),i}i.d(t,{lowerboundExt:()=>s,lowerbound:()=>n,upperbound:()=>a,subtract:()=>l,moveToHead:()=>c,moveAfter:()=>u,moveBefore:()=>d,intersect:()=>h})},4033:(e,t,i)=>{"use strict";var r=i(57014),s=i(51966).tzData;function n(e){this._name=e;var t=s[e];if(t||(t={time:[],offset:[]},this._invalid=!0),t.time.length!==t.offset.length&&(t={time:[],offset:[]},this._invalid=!0),!t.time_utc){for(var i=t.time,r=t.offset,n=i.length,o=new Array(n),a=0;a<n;a++)i[a]*=1e3,r[a]*=1e3,o[a]=i[a]-r[a];t.time_utc=o}this.tz=t}function o(e,t){var i=e.length;if(0===i)return-1;if(isNaN(t))throw Error("Key is NaN");for(var r=0,s=i-1,n=a((r+s)/2);;){if(e[n]>t){if((s=n-1)<r)return n}else if(s<(r=n+1))return n<i-1?n+1:-1;n=a((r+s)/2)}}n.prototype.offset_utc=function(e){return n._offset(this.tz.time_utc,this.tz.offset,e)},n.prototype.offset_loc=function(e){return n._offset(this.tz.time,this.tz.offset,e)},n.prototype.name=function(){return this._name},n.prototype.correction_loc=function(e){var t=this.tz.time,i=this.tz.offset,r=o(t,e);if(r<1)return 0;var s=i[r]-i[r-1];if(s>0&&e-t[r-1]<=s)return s;return 0},n.prototype.is_valid=function(){return!this._invalid},n._offset=function(e,t,i){var r=o(e,i);return-1===r?0:t[r]};var a=function(e){return 0|e},l=function(e){return 60*e*1e3},c=function(e,t){return u(e)-u(t)},u=function(e){return e<0?a(e/1e3)-(e%1e3!=0?1:0):a(e/1e3)};function d(e){return e%4==0&&(e%100!=0||e%400==0)}var h={0:0,1:31,2:59,3:90,4:120,5:151,6:181,7:212,8:243,9:273,10:304,11:334},p={...r.WeekDays,...r.Months,YEAR:1,MONTH:2,WEEK_OF_YEAR:3,DAY_OF_MONTH:5,DAY_OF_YEAR:6,DAY_OF_WEEK:7,HOUR_OF_DAY:11,MINUTE:12,SECOND:13,minutesPerDay:1440,millisecondsPerDay:l(1440),get_minutes_from_hhmm:function(e){return-1!==e.indexOf(":")&&(e=e.split(":").join("")),e%100+60*a(e/100)},get_year:function(e){return e.getUTCFullYear()},get_month:function(e){return e.getUTCMonth()},get_hours:function(e){return e.getUTCHours()},get_minutes:function(e){return e.getUTCMinutes()},get_seconds:function(e){return e.getUTCSeconds()},get_day_of_month:function(e){return e.getUTCDate()},get_day_of_week:function(e){return e.getUTCDay()+1},get_day_of_year:function(e){var t=e.getUTCMonth(),i=h[t];return t>p.JANUARY+1&&d(e.getUTCFullYear())&&(i+=1),i+e.getUTCDate()},get_week_of_year:function(e){var t=new Date(Date.UTC(e.getUTCFullYear(),0,1)).getUTCDay(),i=0===t?1:8-t,r=p.get_day_of_year(e)-i;return Math.ceil(r/7)+1},get_minutes_from_midnight:function(e){return 60*p.get_hours(e)+p.get_minutes(e)},
set_hms:function(e,t,i,r,s,n){e.setUTCHours(t),e.setUTCMinutes(i),e.setUTCSeconds(r),e.setUTCMilliseconds(s),void 0!==n&&p.correct_time(e,n)},correct_time:function(e,t){var i=e.getTime(),r=t.correction_loc(i);e.setTime(i+r)},add_days_considering_dst:function(e,t,i){var r=e.offset_utc(t),s=this.clone(t);this.add_date(s,i);var n=e.offset_utc(s);return s.setTime(s.getTime()+r-n),s},add_date:function(e,t){e.setTime(e.getTime()+t*p.millisecondsPerDay)},add_minutes:function(e,t){e.setTime(e.getTime()+l(t))},clone:function(e){return new Date(e.getTime())},get_days_per_year:function(e){var t=e.getUTCFullYear();return this.days_per_year(t)},days_per_year:function(e){return d(e)?366:365},get_days_in_month:function(e,t){let i;switch(e){case 0:case 2:case 4:case 6:case 7:case 9:case 11:i=31;break;case 1:i=28,d(t)&&i++;break;default:i=30}return i},get_part:function(e,t){switch(t){case p.YEAR:return p.get_year(e);case p.MONTH:return p.get_month(e);case p.DAY_OF_MONTH:return p.get_day_of_month(e);case p.WEEK_OF_YEAR:return p.get_week_of_year(e);case p.DAY_OF_WEEK:return p.get_day_of_week(e);case p.HOUR_OF_DAY:return p.get_hours(e);case p.MINUTE:return p.get_minutes(e);case p.DAY_OF_YEAR:return p.get_day_of_year(e);case p.SECOND:return p.get_seconds(e);default:return e.getTime()}},time_minutes:l,time_seconds:function(e){return 1e3*e},time_minutes_diff:function(e,t){return a(c(e,t)/60)},time_seconds_diff:c,utc_to_cal:function(e,t){return new Date(p.utc_to_cal_ts(e,t))},utc_to_cal_ts:function(e,t){return t+e.offset_utc(t)},get_cal:function(e,t,i,r,s,n,o){var a=new Date(Date.UTC(t,i,r,s||0,n||0,o||0)),l=e.offset_utc(+a);return new Date(a.valueOf()-l)},get_cal_from_unix_timestamp_ms:function(e,t){return new Date(t+e.offset_utc(t))},get_cal_utc:function(e,t,i){return new Date(Date.UTC(e,t,i))},cal_to_utc:function(e,t){var i=t.getTime();return i-e.offset_loc(i)},get_timezone:function(e){return new n(e)},shift_day:function(e,t){var i=e-1;return(i+=t)>6?i%=7:i<0&&(i=(7+i%7)%7),i+1}};e.exports=p},3707:(e,t,i)=>{"use strict";i.r(t),i.d(t,{LINESTYLE_SOLID:()=>r,LINESTYLE_DOTTED:()=>s,LINESTYLE_DASHED:()=>n,LINESTYLE_LARGE_DASHED:()=>o,LINESTYLE_SPARSE_DOTTED:()=>a,LINESTYLE_SMALL_DASHED:()=>l});const r=0,s=1,n=2,o=3,a=4,l=5},99438:(e,t,i)=>{"use strict";var r=i(84162),s=r.greaterThan,n=r.lessThan,o=window.CanvasEx=i(3707);o.computeDashPattern=function(e){return[[e.lineWidth,2*e.lineWidth],[5*e.lineWidth,6*e.lineWidth],[6*e.lineWidth,6*e.lineWidth],[e.lineWidth,4*e.lineWidth],[2*e.lineWidth,e.lineWidth]][e.lineStyle-1]},o.drawLine=function(e,t,i,r,s){isFinite(t)&&isFinite(r)&&isFinite(i)&&isFinite(s)&&(e.lineStyle!==o.LINESTYLE_SOLID?o.drawDashedLine(e,t,i,r,s):o.drawSolidLine(e,t,i,r,s))},o.drawArrow=function(e,t,i,r,s,n){if(isFinite(t)&&isFinite(r)&&isFinite(i)&&isFinite(s)){var o=Math.round(n/2),a=t+o,l=r+o;e.beginPath(),e.moveTo(l,s),e.lineTo(a,i),e.moveTo(t,i+o),e.lineTo(a,i),e.lineTo(t+n,i+o),e.stroke()}},o.drawSolidLine=function(e,t,i,r,s){e.beginPath(),e.moveTo(t,i),e.lineTo(r,s),e.stroke()},o.setLineStyle=function(e,t){e.lineStyle=t
;var i=[];t!==o.LINESTYLE_SOLID&&(i=o.computeDashPattern(e)),o.setLineDash(e,i)},o.setLineDash=function(e,t){"function"==typeof e.setLineDash?e.setLineDash(t):void 0!==e.mozDash?e.mozDash=t:void 0!==e.webkitLineDash&&(e.webkitLineDash=t)},o.drawPoly=function(e,t,i){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(var r=0;r<t.length;r++){var s=t[r];e.lineTo(s.x,s.y)}e.closePath(),e.stroke(),i&&e.fill()},o.drawDashedLine=function(e,t,i,r,s){e.save();var n=o.computeDashPattern(e);if(e.beginPath(),"function"==typeof e.setLineDash)e.setLineDash(n);else if(void 0!==e.mozDash)e.mozDash=n;else{if(void 0===e.webkitLineDash)return o.dashedLineTo(e,t,i,r,s,n),e.stroke(),void e.restore();e.webkitLineDash=n}e.moveTo(t,i),e.lineTo(r,s),e.stroke(),e.restore()},o.drawDashedLineHorizontal=function(e,t,i,r){e.save();var s=o.computeDashPattern(e),n=0,a=e.lineWidth,l=a/2;e.translate(-l,-l);for(var c=!0,u=t+r;t<u;){var d=s[n];c&&e.fillRect(t,i,d,a),c=!c,t+=d,n=n===s.length-1?0:n+1}e.restore()},o.drawDashedLineVertical=function(e,t,i,r){e.save();var s=o.computeDashPattern(e),n=0,a=e.lineWidth,l=a/2;e.translate(-l,-l);for(var c=!0,u=i+r;i<u;){var d=s[n];c&&e.fillRect(t,i,a,d),c=!c,i+=d,n=n===s.length-1?0:n+1}e.restore()},o.dashedLineTo=function(e,t,i,r,o,a){var l={thereYet:s,cap:Math.min},c={thereYet:s,cap:Math.min};i-o>0&&(c.thereYet=n,c.cap=Math.max),t-r>0&&(l.thereYet=n,l.cap=Math.max),e.moveTo(t,i);for(var u=t,d=i,h=0,p=!0;!l.thereYet(u,r)||!c.thereYet(d,o);){var _=Math.atan2(o-i,r-t),m=a[h];u=l.cap(r,u+Math.cos(_)*m),d=c.cap(o,d+Math.sin(_)*m),p?e.lineTo(u,d):e.moveTo(u,d),h=(h+1)%a.length,p=!p}},o.setFont=function(e,t){if(e.font!==t)try{e.font=t}catch(e){}},"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.setFont=function(e){o.setFont(this,e)},CanvasRenderingContext2D.prototype.lineStyle=o.LINESTYLE_SOLID),e.exports=o},759:(e,t,i)=>{"use strict";var r=i(72316),s=i(13469),n=i(87380).getLogger("Common.CollectionObserver"),o=r.Collection.extend({initialize:function(e,t){if(this._observableCollection=t.observableCollection,this._validator=t.validator,this._syncEvents=s.isArray(t.syncEvents)?t.syncEvents:[],this._syncEvents.push("reset"),this._syncEvents=s.uniq(this._syncEvents),this._observableCollection)if(this._observableCollection instanceof r.Collection){"function"==typeof t.comparator&&(this.comparator=t.comparator),this.comparator||"function"!=typeof this._observableCollection.comparator||(this.comparator=this._observableCollection.comparator),this._observableCollection.on("add",this.onAdd,this),this._observableCollection.on("remove",this.remove,this);for(var i=this._syncEvents.length-1;i>=0;i--)this._observableCollection.on(this._syncEvents[i],this.syncCollections,this);e&&e.length&&this.add(e)}else n.logError("'observableCollection' need to be Backbone.Collection");else n.logError("'observableCollection' option required")},syncCollections:function(){var e=this._validator;e&&this.reset(s.filter(this._observableCollection.models,e))},onAdd:function(e,t,i){var s=this._validator;if(!s||s(e)){
var n=t instanceof r.Collection?i:t;this.add(e,n)}},destroy:function(){this._observableCollection.off("add",this.onAdd,this),this._observableCollection.off("remove",this.remove,this);for(var e=this._syncEvents.length-1;e>=0;e--)this._observableCollection.off(this._syncEvents[e],this.syncCollections,this)}});e.exports=o},68198:(e,t,i)=>{"use strict";i.d(t,{combine:()=>n});var r=i(65066),s=i.n(r);function n(e,...t){const i=(...t)=>e(...t.map(e=>e.value())),r=new(s())(i(...t)),n=()=>r.setValue(i(...t)),o=t.map(e=>e.spawn());for(const e of o)e.subscribe(n);return r.readonly().spawn(()=>o.forEach(e=>e.destroy()))}},30029:(e,t,i)=>{"use strict";i.r(t),i.d(t,{availableTimezones:()=>a,timezoneIsAvailable:()=>l,timezoneTitle:()=>c});i(20220);var r=i(27841);const s=[{id:"Etc/UTC",title:window.t("UTC")},{id:"exchange",title:window.t("Exchange")}],n=[{id:"Africa/Cairo",title:window.t("Cairo"),offset:0},{id:"Africa/Johannesburg",title:window.t("Johannesburg"),offset:0},{id:"Africa/Lagos",title:window.t("Lagos"),offset:0},{id:"America/Argentina/Buenos_Aires",title:window.t("Buenos Aires"),offset:0},{id:"America/Bogota",title:window.t("Bogota"),offset:0},{id:"America/Caracas",title:window.t("Caracas"),offset:0},{id:"America/Chicago",title:window.t("Chicago"),offset:0},{id:"America/El_Salvador",title:window.t("San Salvador"),offset:0},{id:"America/Juneau",title:window.t("Juneau"),offset:0},{id:"America/Lima",title:window.t("Lima"),offset:0},{id:"America/Los_Angeles",title:window.t("Los Angeles"),offset:0},{id:"America/Mexico_City",title:window.t("Mexico City"),offset:0},{id:"America/New_York",title:window.t("New York"),offset:0},{id:"America/Phoenix",title:window.t("Phoenix"),offset:0},{id:"America/Santiago",title:window.t("Santiago"),offset:0},{id:"America/Sao_Paulo",title:window.t("Sao Paulo"),offset:0},{id:"America/Toronto",title:window.t("Toronto"),offset:0},{id:"America/Vancouver",title:window.t("Vancouver"),offset:0},{id:"US/Mountain",title:window.t("Denver"),offset:0},{id:"Asia/Almaty",title:window.t("Almaty"),offset:0},{id:"Asia/Ashkhabad",title:window.t("Ashgabat"),offset:0},{id:"Asia/Bahrain",title:window.t("Bahrain"),offset:0},{id:"Asia/Bangkok",title:window.t("Bangkok"),offset:0},{id:"Asia/Chongqing",title:window.t("Chongqing"),offset:0},{id:"Asia/Dubai",title:window.t("Dubai"),offset:0},{id:"Asia/Ho_Chi_Minh",title:window.t("Ho Chi Minh"),offset:0},{id:"Asia/Hong_Kong",title:window.t("Hong Kong"),offset:0},{id:"Asia/Jakarta",title:window.t("Jakarta"),offset:0},{id:"Asia/Jerusalem",title:window.t("Jerusalem"),offset:0},{id:"Asia/Kolkata",title:window.t("Kolkata"),offset:0},{id:"Asia/Kuwait",title:window.t("Kuwait"),offset:0},{id:"Asia/Manila",title:window.t("Manila"),offset:0},{id:"Asia/Muscat",title:window.t("Muscat"),offset:0},{id:"Asia/Qatar",title:window.t("Qatar"),offset:0},{id:"Asia/Riyadh",title:window.t("Riyadh"),offset:0},{id:"Asia/Seoul",title:window.t("Seoul"),offset:0},{id:"Asia/Shanghai",title:window.t("Shanghai"),offset:0},{id:"Asia/Singapore",title:window.t("Singapore"),offset:0},{id:"Asia/Taipei",
title:window.t("Taipei"),offset:0},{id:"Asia/Tehran",title:window.t("Tehran"),offset:0},{id:"Asia/Tokyo",title:window.t("Tokyo"),offset:0},{id:"Atlantic/Reykjavik",title:window.t("Reykjavik"),offset:0},{id:"Australia/Adelaide",title:window.t("Adelaide"),offset:0},{id:"Australia/Brisbane",title:window.t("Brisbane"),offset:0},{id:"Australia/Perth",title:window.t("Perth"),offset:0},{id:"Australia/Sydney",title:window.t("Sydney"),offset:0},{id:"Europe/Amsterdam",title:window.t("Amsterdam"),offset:0},{id:"Europe/Athens",title:window.t("Athens"),offset:0},{id:"Europe/Belgrade",title:window.t("Belgrade"),offset:0},{id:"Europe/Berlin",title:window.t("Berlin"),offset:0},{id:"Europe/Brussels",title:window.t("Brussels"),offset:0},{id:"Europe/Copenhagen",title:window.t("Copenhagen"),offset:0},{id:"Europe/Dublin",title:window.t("Dublin"),offset:0},{id:"Europe/Helsinki",title:window.t("Helsinki"),offset:0},{id:"Europe/Istanbul",title:window.t("Istanbul"),offset:0},{id:"Europe/Lisbon",title:window.t("Lisbon"),offset:0},{id:"Europe/London",title:window.t("London"),offset:0},{id:"Europe/Luxembourg",title:window.t("Luxembourg"),offset:0},{id:"Europe/Madrid",title:window.t("Madrid"),offset:0},{id:"Europe/Malta",title:window.t("Malta"),offset:0},{id:"Europe/Moscow",title:window.t("Moscow"),offset:0},{id:"Europe/Oslo",title:window.t("Oslo"),offset:0},{id:"Europe/Paris",title:window.t("Paris"),offset:0},{id:"Europe/Riga",title:window.t("Riga"),offset:0},{id:"Europe/Rome",title:window.t("Rome"),offset:0},{id:"Europe/Stockholm",title:window.t("Stockholm"),offset:0},{id:"Europe/Tallinn",title:window.t("Tallinn"),offset:0},{id:"Europe/Vilnius",title:window.t("Vilnius"),offset:0},{id:"Europe/Warsaw",title:window.t("Warsaw"),offset:0},{id:"Europe/Zurich",title:window.t("Zurich"),offset:0},{id:"Pacific/Auckland",title:window.t("New Zealand"),offset:0},{id:"Pacific/Chatham",title:window.t("Chatham Islands"),offset:0},{id:"Pacific/Fakaofo",title:window.t("Tokelau"),offset:0},{id:"Pacific/Honolulu",title:window.t("Honolulu"),offset:0},{id:"Pacific/Norfolk",title:window.t("Norfolk Island"),offset:0}],o=n.map(({id:e,title:t})=>{const{string:i,offset:s}=(0,r.parseTzOffset)(e);return{id:e,offset:s,title:`(${i}) ${t}`}}).sort((e,t)=>{const i=e.offset-t.offset;return 0!==i?i:e.title.localeCompare(t.title)}),a=s.concat(o);function l(e){for(let t=0;t<a.length;t++)if(e===a[t].id)return!0;return!1}function c(e){for(const{id:t,title:i}of n)if(t===e){return`${i} (${(0,r.parseTzOffset)(e).string})`}return e}},80633:(e,t,i)=>{"use strict";function r(e){const t={};return{promise:new Promise((i,r)=>{e.subscribe(t,i,!0)}),destroy:()=>{e.unsubscribeAll(t)}}}i.d(t,{delegateToPromise:()=>r})},96276:(e,t,i)=>{"use strict";e=i.nmd(e);const r=i(87380).getLogger("Common.Delegate");function s(){this._listeners=[]}function n(e){return!e.singleshot}s.prototype.subscribe=function(e,t,i){const r={object:e,member:t,singleshot:!!i,skip:!1};this._listeners.push(r)},s.prototype.unsubscribe=function(e,t){for(let i=0;i<this._listeners.length;++i){const r=this._listeners[i]
;if(r.object===e&&r.member===t){r.skip=!0,this._listeners.splice(i,1);break}}},s.prototype.unsubscribeAll=function(e){for(let t=this._listeners.length-1;t>=0;--t){const i=this._listeners[t];i.object===e&&(i.skip=!0,this._listeners.splice(t,1))}},s.prototype.destroy=function(){delete this._listeners},s.prototype.fire=function(){const e=this._listeners;this._listeners=this._listeners.filter(n);const t=e.length;for(let i=0;i<t;++i){const t=e[i];if(!t.skip)try{t.member.apply(t.object||null,arguments)}catch(e){r.logError(e.stack||e.message)}}},"undefined"!=typeof window&&(window.Delegate=s),e&&e.exports&&(e.exports=s)},22842:(e,t,i)=>{var r=i(79704),s={},n={},o={},a={init:function(){var e,t;Object.keys(r).forEach((function(i){e=r[i],t=e.subsets,Array.isArray(t)?t.forEach((function(e){s[e]=1})):t&&Object.keys(t).forEach((function(e){s[e]=1})),s[i]=1}));var i,l=Object.keys(s);l.forEach((function(e){l.forEach((function(s){if(void 0!==(i=r[s])){if(!(t=i.subsets))return;n.hasOwnProperty(e)||(n[e]=[]),(Array.isArray(t)&&~t.indexOf(e)||e in t)&&n[e].push(s)}}))})),"undefined"!=typeof __initialDisabledFeaturesets&&__initialDisabledFeaturesets&&__initialDisabledFeaturesets.forEach((function(e){a.disable(e)})),"undefined"!=typeof __initialEnabledFeaturesets&&__initialEnabledFeaturesets&&__initialEnabledFeaturesets.forEach((function(e){a.enable(e)})),"undefined"!=typeof window&&(window.Featuresets=a),this.meta={_uniqueSetsNames:s,_setsReverseDependencies:n,_setsStates:o}},enabled:function(e){var t=function(e){var i=n.hasOwnProperty(e)?n[e]:[];if(!1===o[e])return!1;for(var r=o[e],s=0;s<i.length;++s)r|=t(i[s]);return r};return!!t(e)},enable:function(e){o[e]=!0},disable:function(e){o[e]=!1},setEnabled:function(e,t){o[e]=!!t},getAllFeatures:function(){var e={};return Object.keys(s).forEach((function(t){e[t]=o[t]})),e}};a.init(),e.exports=a},92491:(e,t,i)=>{"use strict";var r=i(69483),s=i(18184);i(18184);var n=i(87380).getLogger("Common.LocalForage"),o=i(55119).TVLocalStorageAsync,a=[r.INDEXEDDB,r.LOCALSTORAGE,r.WEBSQL],l=[r.LOCALSTORAGE,r.WEBSQL,r.INDEXEDDB];window.localForageReady=s.Deferred();var c=function(e){n.logNormal("localForage driver: "+JSON.stringify(e));var t={name:"tradingview",driver:e};r.config(t),window.TVLocalForage=r,window.localForageReady.resolve()};try{var u=window.indexedDB.open("tradingviewCheckIndexedDB");u.onerror=function(e){n.logError("IndexedDB is NOT available"),c(l)},u.onsuccess=function(e){n.logNormal("IndexedDB is available"),c(a)}}catch(e){n.logError("IndexedDB is NOT available, "+e);try{c(l)}catch(e){window.TVLocalForage=o,window.localForageReady.resolve()}}e.exports={TVLocalForage:window.TVLocalForage}},84162:(e,t,i)=>{"use strict";function r(e,t){return e<=t}function s(e,t){return e>=t}function n(e,t,i){return Math.min(Math.max(e,t),i)}function o(e){return e<0?-1:e>0?1:0}function a(e){if(e<0)return!1;for(let t=e;t>1;t/=10)if(t%10!=0)return!1;return!0}function l(e,t,i){return t-e<=i}function c(e,t,i){return Math.abs(e-t)<i}function u(e){return e<=0?NaN:Math.log(e)/Math.log(10)}function d(e,t){
return e<t?-1:e>t?1:0}function h(e,t=d){if(e.length<1)throw Error("array is empty");let i=e[0];for(let r=0;r<e.length;++r)t(e[r],i)<0&&(i=e[r]);return i}function p(e,t=d){if(e.length<1)throw Error("array is empty");let i=e[0];for(let r=0;r<e.length;++r)t(e[r],i)>0&&(i=e[r]);return i}function _(e){const t=Math.ceil(e);return t%2!=0?t-1:t}function m(e){return e>0?Math.floor(e):Math.ceil(e)}i.r(t),i.d(t,{lessThan:()=>r,greaterThan:()=>s,clamp:()=>n,sign:()=>o,isBaseDecimal:()=>a,greaterOrEqual:()=>l,equal:()=>c,log10:()=>u,defComparator:()=>d,min:()=>h,max:()=>p,ceiledEven:()=>_,toInt:()=>m})},27841:(e,t,i)=>{"use strict";i.d(t,{parseTzOffset:()=>s});var r=i(4033);function s(e,t=Date.now()){const i=(0,r.get_timezone)(e).offset_utc(t);let s="";const n=i/1e3/60/60;n%1&&(s=":"+n%1*60);let o="";return o=n>0?"+"+(n-n%1)+s:0===n?"":String(n-n%1+s),{offset:i,string:"UTC"+o}}},31565:function(e,t,i){var r;e=i.nmd(e);var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=function(e){return"object"==typeof e&&null!==e};function o(e){return"number"==typeof e&&isFinite(e)}function a(e){return null!=e&&e.constructor===Function}function l(e,t){e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}"undefined"!=typeof window?(r=window.TradingView=window.TradingView||{},window.isNumber=o,window.isFunction=a,window.inherit=l,window.isArray=s):r=this.TradingView=this.TradingView||{},r.isNaN=function(e){return!(e<=0||e>0)},r.isAbsent=function(e){return null==e},r.isExistent=function(e){return null!=e},Number.isNaN=Number.isNaN||function(e){return e!=e},r.isSameType=function(e,t){return Number.isNaN(e)||Number.isNaN(t)?Number.isNaN(e)===Number.isNaN(t):{}.toString.call(e)==={}.toString.call(t)},r.isInteger=function(e){return"number"==typeof e&&e%1==0},r.parseBool=function(e){return!0===e||"true"===e},r.isBoolean=function(e){return!0===e||!1===e},r.isString=function(e){return null!=e&&e.constructor===String},r.isInherited=function(e,t){if(null==e||null==e.prototype)throw new TypeError("isInherited: child should be a constructor function");if(null==t||null==t.prototype)throw new TypeError("isInherited: parent should be a constructor function");return e.prototype instanceof t||e.prototype===t.prototype},r.TypeValidator=function(e){this.m_type=e},r.TypeValidator.prototype.check=function(e){return e.constructor===this.m_type||r.isInherited(e.constructor,this.m_type)},r.PredicateValidator=function(e){this.m_predicate=e},r.PredicateValidator.prototype.check=function(e){return this.m_predicate(e)},r.clone=function(e){if(!e||"object"!=typeof e)return e;var t,i,s;for(i in t="function"==typeof e.pop?[]:{},e)e.hasOwnProperty(i)&&(s=e[i],t[i]=s&&"object"==typeof s?r.clone(s):s);return t},r.deepEquals=function(e,t,i){if(i||(i=""),e===t)return[!0,i];if(a(e)&&(e=void 0),a(t)&&(t=void 0),void 0===e&&void 0!==t)return[!1,i];if(void 0===t&&void 0!==e)return[!1,i];if(null===e&&null!==t)return[!1,i];if(null===t&&null!==e)return[!1,i]
;if("object"!=typeof e&&"object"!=typeof t)return[e===t,i];if(Array.isArray(e)&&Array.isArray(t)){var n=e.length;if(n!==t.length)return[!1,i];for(var o=0;o<n;o++){if(!(c=r.deepEquals(e[o],t[o],i+"["+o+"]"))[0])return c}return[!0,i]}if(s(e)||s(t))return[!1,i];if(Object.keys(e).length!==Object.keys(t).length)return[!1,i];for(var l in e){var c;if(!(c=r.deepEquals(e[l],t[l],i+"["+l+"]"))[0])return c}return[!0,i]},r.merge=function(e,t){for(var i in t)null!==t[i]&&"object"==typeof t[i]&&e.hasOwnProperty(i)?r.merge(e[i],t[i]):e[i]=t[i];return e},r.mergeObj=function(e,t){for(var i in t)t[i].constructor===Object&&e.hasOwnProperty(i)?r.mergeObj(e[i],t[i]):e[i]=t[i];return e},r.mergeWithRules=function(e,t,i,s){for(var n in t){var o=s?s+"."+n:n;i&&o in i?e[n]=i[o](e[n],t[n]):"object"==typeof t[n]&&e.hasOwnProperty(n)?r.merge(e[n],t[n],i,o):e[n]=t[n]}},r.sortMultipleFunction=function(){var e=[].slice.call(arguments),t=e.length;return function(i,r){var s,n,o,a,l,c,u;for(u=0;u<t&&(c=0,s=i[a="string"==typeof(o=e[u])?o:o.name],n=r[a],"function"==typeof o.fn&&(s=o.fn(s),n=o.fn(n)),l=o.reverse?-1:1,s<n&&(c=-1*l),s>n&&(c=1*l),0===c);u++);return c}},e&&e.exports&&(e.exports={inherit:l,clone:r.clone,merge:r.merge,isNumber:o,isInteger:r.isInteger,isBoolean:r.isBoolean,isString:r.isString,isObject:n,isHashObject:function(e){return n(e)&&-1!==e.constructor.toString().indexOf("function Object")},isPromise:function(e){return n(e)&&e.then},isNaN:r.isNaN,isAbsent:r.isAbsent,isExistent:r.isExistent,isSameType:r.isSameType,isArray:s,isFunction:a,parseBool:r.parseBool,deepEquals:r.deepEquals,notNull:function(e){return null!==e},notUndefined:function(e){return void 0!==e},declareClassAsPureInterface:function(e,t){for(var i in e.prototype)"function"==typeof e.prototype[i]&&e.prototype.hasOwnProperty(i)&&(e.prototype[i]=function(){throw new Error(t+"::"+i+" is an interface member declaration and must be overloaded in order to be called")})},requireFullInterfaceImplementation:function(e,t,i,r){for(var s in i.prototype)if("function"==typeof i.prototype[s]&&!e.prototype[s])throw new Error("Interface implementation assertion failed: "+t+" does not implement "+r+"::"+s+" function")}})},68421:(e,t,i)=>{"use strict";i.r(t);var r=i(31565);const s=/{(\w+)}/g,n=/{(\d+)}/g;String.prototype.format=function(...e){const t=(0,r.isObject)(e[0]),i=t?s:n,o=t?(t,i)=>{const r=e[0];return void 0!==r[i]?r[i]:t}:(t,i)=>{const r=parseInt(i,10),s=e[r];return void 0!==s?s:t};return this.replace(i,o)}},73715:(e,t,i)=>{"use strict";var r=i(22842),s=[{d:"E-Mini S&P 500",t:"ES"},{d:"E-Mini Nasdaq 100",t:"NQ"},{d:"Gold",t:"GC"},{d:"Silver",t:"SI"},{d:"Crude Oil WTI",t:"CL"},{d:"Natural Gas",t:"NG"},{d:"Australian Dollar",t:"6A"},{d:"Australian Dollar (Floor)",t:"AD"},{d:"Euro FX",t:"6E"},{d:"Euro FX (Floor)",t:"EC"},{d:"Corn",t:"ZC"},{d:"Corn (Floor)",t:"C"},{d:"Eurodollar",t:"GE"},{d:"Eurodollar (Floor)",t:"ED"}],n=function(){var e=[{pattern:"(",ctor:o},{pattern:")",ctor:a},{pattern:"+",ctor:c},{pattern:"-",ctor:u},{pattern:"*",ctor:d},{pattern:"/",ctor:h},{pattern:"^",ctor:p},{
pattern:/\d+(?:\.\d*|(?![a-zA-Z0-9_!:.&]))|\.\d+/,ctor:g},{pattern:/\./,ctor:y},{pattern:r.enabled("charting_library_base")?/[a-zA-Z0-9_\u0370-\u1FFF_\u2E80-\uFFFF^][a-zA-Z0-9_\u0020\u0370-\u1FFF_\u2E80-\uFFFF_!:.&]*|'.+?'/:/[a-zA-Z0-9_\u0370-\u1FFF_\u2E80-\uFFFF][a-zA-Z0-9_\u0020\u0370-\u1FFF_\u2E80-\uFFFF_!|:.&]*|'.+?'/,ctor:f},{pattern:/'[^']*/,ctor:S},{pattern:/[\0-\x20\s]+/,ctor:n}];function t(e,t){var i=function(){};return i.prototype=t.prototype,e.prototype=new i,e}function i(){}function n(e){this.value=e}function o(){}function a(){}function l(){}function c(){}function u(){}function d(){}function h(){}function p(){}i.prototype.toString=function(){return this.value},t(n,i),t(o,i),o.prototype.value="(",t(a,i),a.prototype.value=")",t(l,i),t(c,l),c.prototype.value="+",c.prototype.precedence=0,c.prototype.commutative=!0,t(u,l),u.prototype.value="-",u.prototype.precedence=0,u.prototype.commutative=!1,t(d,l),d.prototype.value="*",d.prototype.precedence=1,d.prototype.commutative=!0,t(h,l),h.prototype.value="/",h.prototype.precedence=1,h.prototype.commutative=!1,t(p,l),p.prototype.value="^",p.prototype.precedence=2,p.prototype.commutative=!1;var _=/^'?(?:([A-Z0-9_]+):)?(.*?)'?$/i,m=/[+\-/*]/;function f(e){this.value=e}function g(e){this.value=e}function v(e){this.value=e}function S(){f.apply(this,arguments)}function y(){g.apply(this,arguments)}t(f,i),f.prototype.toString=function(){if(this.hasOwnProperty("_ticker")){var e=m.test(this._ticker)?"'":"";return e+(this._exchange?this._exchange+":":"")+this._ticker+e}return this.value},f.prototype.parse=function(){var e=_.exec(this.value);e[1]&&(this._exchange=e[1]),this._ticker=e[2]},f.prototype.parseAsFutures=function(){this.hasOwnProperty("_ticker")||this.parse();for(var e=function(e){return s.some((function(t){return t.t===e}))},t=2;t>=1;--t){var i=this._ticker.slice(0,t);if(e(i)){this._root=i,this._contract=this._ticker.slice(t);break}}},f.prototype.exchange=function(e){if(this.hasOwnProperty("_ticker")||this.parse(),!(arguments.length>0))return this._exchange;null==e?delete this._exchange:this._exchange=e+""},f.prototype.ticker=function(e){if(this.hasOwnProperty("_ticker")||this.parse(),!(arguments.length>0))return this._ticker;null==e?delete this._ticker:this._ticker=e+"",delete this._root,delete this._contract},f.prototype.root=function(e){if(this.hasOwnProperty("_root")||this.parseAsFutures(),!(arguments.length>0))return this._root;null==e?delete this._root:(this._root=e+"",this._root&&(this._ticker=this._root+(this._contract||"")))},f.prototype.contract=function(e){if(this.hasOwnProperty("_contract")||this.parseAsFutures(),!(arguments.length>0))return this._root;null==e?delete this._contract:(this._contract=e+"",this._root&&(this._ticker=this._root+this._contract))},t(g,i),g.prototype.toString=function(){return this.hasOwnProperty("_normalizedValue")?this._normalizedValue:this.value},g.prototype.parse=function(){this._normalizedValue=this.value.replace(/^0+|\.0*$/g,"").replace(/(\.\d*?)0+$/,"$1").replace(/^(\.|$)/,"0$1")},v.prototype.toString=function(){
return this.value},t(S,f),S.prototype.isIncomplete=!0,S.prototype.incompleteSuggest=function(){if("'"!==this.value)return String("'")},t(y,g),y.prototype.isIncomplete=!0;var b=new RegExp(e.map((function(e){return"("+("string"==typeof e.pattern?e.pattern.replace(/[\^$()[\]{}*+?|\\]/g,"\\$&"):e.pattern.source)+")"})).concat(".").join("|"),"g");function w(t,i){var r,s=[];e:for(;r=b.exec(t);){for(var o=e.length;o--;)if(r[o+1]){if(e[o].ctor){var a=new e[o].ctor(r[o+1]);a._offset=r.index,s.push(a)}continue e}var l=new v(r[0]);l._offset=r.index,s.push(l)}if(i&&i.recover){var c;for(o=s.length;o--;){var u=s[o];if(u instanceof g||u instanceof f){if(void 0!==c){var d=new f(""),h=s.splice(o,c-o+1,d);d.value=h.map((function(e){return e.value})).join("")}c=o}else u instanceof n||(c=void 0)}}return s}function P(e){for(var t=[],i=0;i<e.length;i++)e[i]instanceof n||t.push(e[i]);return t}function C(e){e=P(e);for(var t,i=[],r=[],s=0;s<e.length;s++){var n=e[s];if(n instanceof l)r.length&&r[r.length-1].minPrecedence>n.precedence&&(r[r.length-1].minPrecedence=n.precedence);else if(n instanceof o)r.push(t={minPrecedence:1/0,openBraceIndex:s});else if(n instanceof a){var c=e[(t=r.pop()).openBraceIndex-1],u=e[s+1];u instanceof l&&!(u.precedence<=t.minPrecedence)||!(!(c instanceof l)||c.precedence<t.minPrecedence||c.precedence===t.minPrecedence&&c.commutative)||(i.unshift(t.openBraceIndex),i.push(s),r.length&&r[r.length-1].minPrecedence>t.minPrecedence&&(r[r.length-1].minPrecedence=t.minPrecedence))}}for(s=i.length;s--;)e.splice(i[s],1);return e}function T(e){if("string"!=typeof e)throw new TypeError("expression must be a string");return(e=w(e)).filter((function(e){return e instanceof f})).map((function(e){return e.exchange()})).filter((function(e){return e}))}function x(e){return 1!==(e=T(e)).length?null:e[0]}function I(e,t){return(e=T(e)).some((function(e){return t.includes((e||"").toUpperCase())}))}function L(e){return e.join("")}return{tokenize:w,validate:function(e){if(r.enabled("charting_library_base"))return{currentState:"var"};for(var t="init",i={warnings:[],errors:[],isEmpty:!0},s=[],c=0;c<e.length;c++){if(!((d=e[c])instanceof n)){if(delete i.isEmpty,d.isIncomplete){var u={status:"incomplete",reason:"incomplete_token",offset:d._offset,token:d};if(d.incompleteSuggest&&(u.recover={append:d.incompleteSuggest()}),i.warnings.push(u),c!==e.length-1){u.status="error";continue}}if(d instanceof f||d instanceof g){if("var"===t){i.errors.push({status:"error",reason:"unexpected_token",offset:d._offset,token:d});continue}t="var"}else if(d instanceof l){if("var"!==t){i.errors.push({status:"error",reason:"unexpected_token",offset:d._offset,token:d});continue}t="operator"}else if(d instanceof o){if("var"===t){i.errors.push({status:"error",reason:"unexpected_token",offset:d._offset,token:d});continue}s.push(d),t="init"}else if(d instanceof a){if("var"!==t){i.errors.push({status:"error",reason:"unexpected_token",offset:d._offset,token:d});continue}s.pop()||i.errors.push({status:"error",reason:"unbalanced_brace",offset:d._offset,token:d,recover:{
prepend:new o}}),t="var"}else d instanceof v&&i.errors.push({status:"error",reason:"unparsed_entity",offset:d._offset,token:d})}}for(i.braceBalance=s.length,"var"!==t&&i.warnings.push({status:"incomplete"});s.length;){var d;u={status:"incomplete",reason:"unbalanced_brace",offset:(d=s.pop())._offset,token:d};"var"===t&&(u.recover={append:new a}),i.warnings.push(u)}return i.currentState=t,0===i.warnings.length&&delete i.warnings,0===i.errors.length&&delete i.errors,i},factorOutBraces:C,normalizeTokens:function(e){for(var t=0;t<e.length;t++)e[t].parse&&e[t].parse();return e},flip:function(e){var t=function(e){for(var t,i=0,r=0,s=0;s<e.length;s++){var c=e[s];if(!(c instanceof n))switch(i){case 0:if(!(c instanceof g&&1==+c.value))return!1;i=1;break;case 1:if(!(1===i&&c instanceof h))return!1;i=2,t=s+1;break;case 2:if(c instanceof o)i=3,r=1;else if(c instanceof l)return!1;break;case 3:c instanceof o?r++:c instanceof a&&--r<=0&&(i=2)}}return e.slice(t)}(e);return C(t||[new g("1"),new h,new o].concat(e).concat(new a))},hasBatsSymbols:function(e){return I(e,["BATS"])},hasEodSymbols:function(e){return(e=x(e))&&-1!==e.toUpperCase().indexOf("_EOD")},hasChxjpySymbols:function(e){return I(e,["CHXJPY"])},hasFreeDelaySymbols:function(e){return I(e,pro.getProductsByType(pro.PRODUCT_TYPES.exchange).map((function(e){return e.exchange.toUpperCase()+"_DLY"})))},getExchange:x,getExchanges:T,isExchange:function(e,t){return!!(e=x(e))&&e.substr(0,t.length)===t},SymbolToken:f,IncompleteSymbolToken:S,NumberToken:g,BinaryOperatorToken:l,OpenBraceToken:o,CloseBraceToken:a,ticker:function(e){return new f(e).ticker()},shortName:function(e){if("string"!=typeof e)throw new TypeError("expression must be a string");var t=C(P(w(e)));return t.forEach((function(e){e instanceof f&&e.exchange(null)})),L(t)},normalize:function(e){if("string"!=typeof e)throw new TypeError("expression must be a string");return L(C(P(w(e))))}}}();e.exports=n},51966:e=>{e.exports.tzData={"America/New_York":{
time:[-2717668562,-1633298400,-1615154400,-1601848800,-1583704800,-1570399200,-1551650400,-1536530400,-1523224800,-1504476e3,-1491775200,-1473026400,-1459720800,-1441576800,-1428271200,-1410127200,-1396821600,-1378677600,-1365372e3,-1347228e3,-1333922400,-1315173600,-1301868e3,-1283724e3,-1270418400,-1252274400,-1238968800,-1220824800,-1207519200,-1189375200,-1176069600,-1157320800,-114462e4,-1125871200,-1112565600,-1094421600,-1081116e3,-1062972e3,-1049666400,-1031522400,-1018216800,-1000072800,-986767200,-968018400,-955317600,-936568800,-923263200,-905119200,-891813600,-880236e3,-76941e4,-765410400,-747266400,-733960800,-715816800,-702511200,-684367200,-671061600,-652917600,-639612e3,-620863200,-608162400,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-447285600,-431560800,-415836e3,-400111200,-384386400,-368661600,-352936800,-337212e3,-321487200,-305762400,-289432800,-273708e3,-257983200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],
offset:[-17762,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3]},"America/Los_Angeles":{
time:[-2717668378,-1633298400,-1615154400,-1601848800,-1583704800,-880236e3,-769420800,-765410400,-687995940,-662680800,-620866800,-608162400,-589417200,-576108e3,-557967600,-544658400,-526518e3,-513208800,-495068400,-481759200,-463618800,-450309600,-431564400,-418255200,-400114800,-386805600,-368665200,-355356e3,-337215600,-323906400,-305766e3,-292456800,-273711600,-261007200,-242262e3,-226533600,-210812400,-195084e3,-179362800,-163634400,-147913200,-13158e4,-116463600,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[-28378,-28800,-25200,-28800,-25200,-28800,-25200,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800]},"America/Chicago":{
time:[-2717668236,-1633298400,-1615154400,-1601848800,-1583704800,-1563746400,-1551650400,-1538949600,-1520200800,-1504476e3,-1491775200,-1473026400,-1459720800,-1441576800,-1428271200,-1410127200,-1396821600,-1378677600,-1365372e3,-1347228e3,-1333922400,-1315173600,-1301868e3,-1283724e3,-1270418400,-1252274400,-1238968800,-1220824800,-1207519200,-1189375200,-1176069600,-1157320800,-114462e4,-1125871200,-1112565600,-1094421600,-1081116e3,-1067810400,-1045432800,-1031522400,-1018216800,-1000072800,-986767200,-968018400,-955317600,-936568800,-923263200,-905119200,-891813600,-880236e3,-769413600,-765410400,-747266400,-733960800,-715816800,-702511200,-684367200,-671061600,-652917600,-639612e3,-620863200,-608162400,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-447285600,-431560800,-415836e3,-400111200,-384386400,-368661600,-352936800,-337212e3,-321487200,-305762400,-289432800,-273708e3,-257983200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],
offset:[-21036,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600]},"America/Phoenix":{time:[-2717670498,-1633298400,-1615154400,-1601848800,-1583704800,-880236e3,-820540740,-812678340,-796867140,-84405600,-68680800,1924966800],offset:[-26898,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200]},"America/Toronto":{
time:[-2366755200,-1632088800,-1615154400,-1601771400,-1583712e3,-1567375200,-1554681600,-1534716e3,-1524088800,-1503266400,-149238e4,-1471816800,-1460930400,-1440972e3,-1428876e3,-1409522400,-1397426400,-1378072800,-1365976800,-1346623200,-1333922400,-1315173600,-1301868e3,-1283724e3,-1270418400,-1252274400,-1238968800,-1220824800,-1207519200,-1188770400,-1176069600,-1157320800,-1144015200,-1125871200,-1112565600,-1094421600,-1081116e3,-1062972e3,-1049666400,-1031522400,-1018216800,-1000072800,-986767200,-968018400,-955317600,-936568800,-880232400,-76941e4,-765410400,-747266400,-733960800,-715824e3,-702518400,-684374400,-671068800,-652924800,-634176e3,-620863200,-602719200,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-450309600,-431560800,-418255200,-400111200,-384386400,-368661600,-352936800,-337212e3,-321487200,-305762400,-289432800,-273708e3,-257983200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,136346400,152071200,167796e3,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],
offset:[-19052,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-14400,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3]},"America/Vancouver":{
time:[-2713910400,-1632088800,-1615154400,-880236e3,-769420800,-765410400,-747266400,-733960800,-715816800,-702511200,-684367200,-671061600,-652917600,-639612e3,-620863200,-608162400,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-450309600,-431560800,-418255200,-400111200,-386805600,-368661600,-355356e3,-337212e3,-323906400,-305762400,-292456800,-273708e3,-261007200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,136346400,152071200,167796e3,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],
offset:[-29548,-28800,-25200,-28800,-25200,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800]},"America/Argentina/Buenos_Aires":{time:[-2372112e3,-1567468800,-1233446400,-1222992e3,-1205971200,-1194048e3,-117288e4,-1162512e3,-1141344e3,-1130976e3,-1109808e3,-109944e4,-1078272e3,-1067817600,-1046649600,-1036281600,-1015113600,-1004745600,-983577600,-973209600,-952041600,-941587200,-931046400,-900892800,-890352e3,-83376e4,-82728e4,-752284800,-733795200,-197337600,-190857600,-184204800,-164505600,-152668800,-132969600,-121132800,-101433600,-86832e3,-71107200,-54777600,-39052800,-23328e3,-7603200,128131200,136598400,596937600,605059200,624412800,636508800,656467200,667958400,687916800,699408e3,719366400,731462400,938908800,952041600,1198972800,1205625600,1224374400,1237075200,1924981200],offset:[-14028,-15408,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-10800,-10800,-7200,-10800,-7200,-10800]},"America/El_Salvador":{time:[-1546300800,546998400,559699200,578448e3,591148800,1924970400],offset:[-21408,-21600,-18e3,-21600,-18e3,-21600]},"America/Sao_Paulo":{
time:[-1767225600,-1206968400,-1191369600,-1175385600,-1159833600,-633830400,-622076400,-602294400,-59184e4,-570758400,-560217600,-539136e3,-53136e4,-195436800,-184204800,-155174400,-150076800,-128908800,-121132800,-99964800,-89596800,-68428800,-57974400,499737600,511228800,530582400,540259200,562118400,571190400,592963200,602035200,624412800,634694400,656467200,666748800,687916800,697593600,719971200,728438400,750816e3,761702400,782265600,793152e3,813715200,823996800,84456e4,856051200,876096e3,888710400,908064e3,919555200,938908800,951609600,970963200,982454400,1003017600,1013904e3,1036281600,1045353600,1066521600,1076803200,1099353600,1108857600,1129420800,1140307200,1162684800,1172361600,119232e4,1203206400,1224374400,1234656e3,1255824e3,1266710400,1287273600,129816e4,1318723200,1330214400,1350777600,1361059200,1382227200,1392508800,1413676800,1424563200,1445126400,1456012800,1476576e3,1487462400,1508025600,1518912e3,1541289600,1550361600,1924981200],offset:[-11188,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800]},"America/Bogota":{time:[-2707689600,-1739059200,704851200,733881600,1924974e3],offset:[-17776,-17776,-18e3,-14400,-18e3]},"America/Caracas":{time:[-2524521600,-1826755200,-157766400,1197169200,1462069800,1924977600],offset:[-16064,-16060,-16200,-14400,-16200,-14400]},"Europe/Moscow":{time:[-2840140800,-1688256e3,-165681e4,-1641340800,-1627956e3,-1618700400,-1596416400,-1593804521,-1589846400,-1542416400,-1539478800,-1525305600,-1522713600,-1491177600,-1247529600,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,695786400,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1414288800,1925002800],
offset:[9017,9017,9079,12679,9079,16279,12679,16279,14400,10800,14400,18e3,14400,10800,7200,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,10800,7200,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800]},"Europe/Athens":{time:[-2344636800,-1686095940,-1182988800,-1178150400,-906854400,-904867200,-85725e4,-844473600,-828230400,-812419200,-552355200,-541641600,166492800,186195600,198036e3,213764400,228880800,244090800,260330400,275457600,291805200,307418400,323395200,338947200,354682800,370411200,386132400,401860800,417582e3,433310400,449031600,465364800,481086e3,496814400,512535600,528264e3,543985200,559713600,575434800,591163200,606884400,622612800,638334e3,654667200,670388400,686116800,701838e3,717566400,733287600,749016e3,764737200,780465600,796186800,811915200,828241200,846388800,859690800,877838400,891140400,909288e3,92259e4,941342400,954039600,972792e3,985489200,1004241600,1017543600,1035691200,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[5692,5692,7200,10800,7200,10800,7200,3600,7200,3600,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Europe/Belgrade":{
time:[-2713910400,-905821200,-85725e4,-844552800,-828219600,-812498400,-79677e4,-777938400,-766616400,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[4920,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Berlin":{time:[-2422051200,-1693702800,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-938901600,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-776556e3,-765925200,-761173200,-748476e3,-733266e3,-717627600,-714603600,-71037e4,-701902800,-684972e3,-670453200,-654127200,-639003600,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],
offset:[3208,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,10800,7200,3600,7200,3600,7200,10800,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/London":{
time:[-3852662400,-1691964e3,-1680469200,-1664143200,-1650142800,-1633903200,-1617483600,-1601848800,-1586034e3,-1570399200,-1552165200,-1538344800,-152253e4,-15075e5,-1490562e3,-1473631200,-1460926800,-1442786400,-1428872400,-1410732e3,-1396213200,-1379282400,-1364763600,-1348437600,-1333314e3,-1315778400,-1301259600,-1284328800,-126981e4,-1253484e3,-1238360400,-1221429600,-1206910800,-118998e4,-1175461200,-1159135200,-1143406800,-1126476e3,-1111957200,-1095631200,-1080507600,-1063576800,-1049058e3,-1032127200,-1017608400,-1001282400,-986158800,-969228e3,-950475600,-942012e3,-904514400,-896043600,-875484e3,-864594e3,-844034400,-832539600,-812584800,-798066e3,-781048800,-772059600,-764802e3,-748476e3,-733352400,-719445600,-717026400,-706741200,-699483600,-687996e3,-668034e3,-654732e3,-636584400,-622072800,-605739600,-590623200,-57429e4,-558568800,-542235600,-527119200,-512600400,-496274400,-481150800,-46422e4,-449701200,-432165600,-417646800,-401320800,-386197200,-369266400,-354747600,-337816800,-323298e3,-306972e3,-291848400,-276732e3,-257979600,-245282400,-22653e4,-213228e3,-195080400,-182383200,-163630800,-150933600,-132181200,-119484e3,-100731600,-88034400,-68677200,-59004e3,-37238400,57726e3,69818400,89175600,101268e3,120625200,132717600,152074800,164167200,183524400,196221600,214974e3,227671200,246423600,259120800,278478e3,290570400,309927600,32202e4,341377200,354675600,372823200,386125200,404272800,417574800,435722400,449024400,467776800,481078800,499226400,512528400,530676e3,543978e3,562125600,575427600,593575200,606877200,625629600,638326800,657079200,670381200,688528800,701830800,719978400,733280400,751428e3,76473e4,782877600,796179600,814327200,828234e3,846381600,859683600,877831200,891133200,909280800,922582800,941335200,954032400,972784800,985482e3,1004234400,1017536400,1035684e3,1048986e3,1067133600,1080435600,1099188e3,1111885200,1130637600,1143334800,1162087200,1174784400,1193536800,1206838800,1224986400,1238288400,1256436e3,1269738e3,1288490400,1301187600,131994e4,1332637200,1351389600,1364691600,1382839200,1396141200,1414288800,1427590800,1445738400,1459040400,1477792800,149049e4,1509242400,1521939600,1540692e3,1553994e3,1572141600,1585443600,1603591200,1616893200,1635645600,1648342800,1667095200,1679792400,1698544800,1711846800,1729994400,1743296400,1761444e3,1774746e3,1792893600,1806195600,1824948e3,1837645200,1856397600,1869094800,1887847200,1901149200,1919296800,1932598800],
offset:[-75,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,0,3600,0,3600,7200,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0]},"Europe/Luxembourg":{time:[-2069712e3,-1692493200,-1680476400,-1662339600,-165015e4,-1632002400,-1618693200,-1612656e3,-1604278800,-1585515600,-1574038800,-1552255200,-1539997200,-1520546400,-1507510800,-1490569200,-1473642e3,-1459116e3,-1444006800,-142767e4,-1411866e3,-1396220400,-1379293200,-1364770800,-1348448400,-1333321200,-1316394e3,-1301266800,-1284339600,-126981e4,-1253484e3,-1238360400,-1221429600,-1206910800,-1191189600,-1175461200,-1160344800,-1143406800,-1127685600,-1111957200,-1096840800,-1080507600,-1063576800,-1049058e3,-1033336800,-1017608400,-1002492e3,-986158800,-969228e3,-950475600,-942012e3,-935182800,-85725e4,-844552800,-828219600,-812498400,-797979600,-781048800,-766616400,-745452e3,-733266e3,228880800,244004400,260330400,276058800,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],
offset:[1476,3600,7200,3600,7200,3600,7200,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Madrid":{time:[-2177453684,-1631926800,-1616886e3,-1601168400,-158535e4,-1442451600,-142767e4,-1379293200,-1364770800,-1348448400,-1333321200,-1316390400,-1301266800,-1284339600,-1269817200,-1026954e3,-1017615600,-1001898e3,-999478800,-986083200,-954111600,-940208400,-873075600,-862614e3,-842835600,-828313200,-811386e3,-796863600,-779936400,-765414e3,-748486800,-733964400,-652323600,-639010800,135126e3,150253200,166575600,181702800,196815600,212547600,22887e4,243997200,260330400,276058800,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],
offset:[-884,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Paris":{time:[-2486592e3,-1855958400,-1689814800,-1680393600,-1665363600,-1648339200,-1635123600,-1616889600,-1604278800,-158544e4,-1574038800,-1552262400,-1539997200,-1520553600,-1507510800,-1490572800,-1470618e3,-1459123200,-1444006800,-1427673600,-1411952400,-1396224e3,-1379293200,-1364774400,-1348448400,-1333324800,-1316394e3,-1301270400,-1284339600,-1269820800,-1253494800,-1238371200,-1221440400,-1206921600,-1191200400,-1175472e3,-1160355600,-1143417600,-1127696400,-1111968e3,-1096851600,-1080518400,-1063587600,-1049068800,-1033347600,-1017619200,-1002502800,-986169600,-969238800,-950486400,-942012e3,-932432400,-85725e4,-844552800,-828219600,-812498400,-800064e3,-796258800,-781048800,-766616400,196822800,212547600,228880800,244004400,260330400,276058800,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],
offset:[561,561,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,7200,3600,7200,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Rome":{time:[-3252096e3,-2403562204,-1690761600,-168048e4,-1664755200,-1648944e3,-163512e4,-1616889600,-1604275200,-1585526400,-1571011200,-1555286400,-932428800,-85725e4,-844552800,-828219600,-812498400,-798066e3,-781048800,-76671e4,-750895200,-733352400,-719452800,-70191e4,-689205600,-670453200,-114048e3,-103161600,-81993600,-71708400,-50544e3,-40258800,-18489600,-8204400,1296e4,23245200,43804800,54694800,75859200,86749200,107913600,118198800,138758400,149648400,170812800,181098e3,202262400,212547600,233107200,243997200,265161600,276051600,296611200,307501200,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],
offset:[2996,2996,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Warsaw":{time:[-2840140800,-1717027200,-1693702800,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-1600466400,-1587157200,-1501718400,-931730400,-85725e4,-844552800,-828219600,-812498400,-796600800,-778723200,-762652800,-748483200,-733266e3,-715212e3,-701902800,-684972e3,-670453200,-654127200,-639003600,-397090800,-386805600,-371084400,-355356e3,-334191600,-323301600,-307580400,-291852e3,-271292400,-260402400,-239842800,-228952800,-208393200,-197503200,-176338800,-166053600,228877200,244000800,260326800,276055200,291776400,307504800,323830800,338954400,354675600,370404e3,386125200,401853600,417574800,433303200,449024400,465357600,481078800,496807200,512528400,528256800,543978e3,559706400,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],
offset:[5040,5040,3600,7200,3600,7200,3600,7200,7200,10800,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Istanbul":{time:[-2840140800,-1869868800,-1693699200,-168048e4,-1570406400,-1552176e3,-1538352e3,-1522540800,-1507507200,-1490572800,-1440201600,-1428019200,-1409702400,-1396483200,-931046400,-922665600,-917827200,-892425600,-875836800,-764726400,-744336e3,-733795200,-716428800,-701913600,-684979200,-670464e3,-654134400,-639014400,-62208e4,-60696e4,-590025600,-575510400,-235612800,-194832e3,-177724800,-165715200,107917200,121226400,133927200,152676e3,164685600,184125600,196221600,215575200,228880800,245815200,260330400,267926400,428464800,433908e3,468122400,482806800,496720800,512528400,528256800,543978e3,559706400,575427600,591156e3,606877200,622605600,638326800,65466e4,670381200,686109600,701830800,717559200,733280400,749008800,764125200,780458400,796179600,811908e3,828234e3,846381600,859683600,877831200,891133200,909280800,922582800,941335200,954032400,972784800,985482e3,1004234400,1017536400,1035684e3,1048986e3,1067133600,1080435600,1099188e3,1111885200,1130637600,1143334800,1162087200,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301281200,1319947200,1332644400,1351396800,1364698800,1382846400,1396234800,1414296e3,1427598e3,1446955200,1459047600,1473206400,1925002800],offset:[6952,7016,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,10800,14400,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,10800]},"Europe/Zurich":{
time:[-3675196800,-2385244800,-904431600,-891122400,-872982e3,-859672800,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[2048,1786,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Australia/Sydney":{time:[-2364076800,-1672524e3,-1665349200,-883605600,-876085200,-860364e3,-844635600,-828309600,-813186e3,57722400,68007600,89172e3,100062e3,120621600,131511600,152071200,162961200,183520800,195015600,215575200,226465200,247024800,257914800,278474400,289364400,309924e3,320814e3,341373600,352263600,372823200,386737200,404877600,415767600,436327200,447217200,467776800,478666800,499226400,511326e3,530071200,542775600,562125600,57483e4,59418e4,606279600,625629600,636519600,657079200,667969200,688528800,699418800,719978400,731473200,752032800,762922800,783482400,794372400,814932e3,828241200,846381600,859690800,877831200,891140400,909280800,92259e4,941335200,954039600,967341600,985489200,1004234400,1017543600,1035684e3,1048993200,1067133600,1080442800,1099188e3,1111892400,1130637600,1143946800,1162087200,1174791600,1193536800,1207450800,1223172e3,1238900400,1254621600,127035e4,1286071200,1301799600,1317520800,1333249200,1349575200,1365303600,1381024800,1396753200,1412474400,1428202800,1443924e3,1459652400,1475373600,1491102e3,1506823200,1522551600,1538877600,1554606e3,1570327200,1586055600,1601776800,1617505200,1633226400,1648954800,1664676e3,1680404400,1696125600,1712458800,172818e4,1743908400,1759629600,1775358e3,1791079200,1806807600,1822528800,1838257200,1853978400,1869706800,1886032800,1901761200,1917482400,1933210800],
offset:[36292,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600]},"Australia/Brisbane":{time:[-2366755200,-1672524e3,-1665349200,-883605600,-876085200,-860364e3,-844635600,-828309600,-813186e3,57722400,68007600,625629600,636519600,657079200,667969200,688528800,699418800,1925028e3],offset:[36728,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3]},"Australia/Adelaide":{time:[-2364076800,-2230156800,-1672524e3,-1665349200,-883605600,-876085200,-860364e3,-844635600,-828309600,-813186e3,57722400,68007600,89172e3,100062e3,120621600,131511600,152071200,162961200,183520800,195015600,215575200,226465200,247024800,257914800,278474400,289364400,309924e3,320814e3,341373600,352263600,372823200,384318e3,404877600,415767600,436327200,447217200,467776800,478666800,499226400,511326e3,530071200,542775600,562125600,57483e4,59418e4,606279600,625629600,637729200,657079200,667969200,688528800,701233200,719978400,731473200,752032800,764132400,783482400,796186800,814932e3,828241200,846381600,859690800,877831200,891140400,909280800,92259e4,941335200,954039600,972784800,985489200,1004234400,1017543600,1035684e3,1048993200,1067133600,1080442800,1099188e3,1111892400,1130637600,1143946800,1162087200,1174791600,1193536800,1207450800,1223172e3,1238900400,1254621600,127035e4,1286071200,1301799600,1317520800,1333249200,1349575200,1365303600,1381024800,1396753200,1412474400,1428202800,1443924e3,1459652400,1475373600,1491102e3,1506823200,1522551600,1538877600,1554606e3,1570327200,1586055600,1601776800,1617505200,1633226400,1648954800,1664676e3,1680404400,1696125600,1712458800,172818e4,1743908400,1759629600,1775358e3,1791079200,1806807600,1822528800,1838257200,1853978400,1869706800,1886032800,1901761200,1917482400,1933210800],
offset:[33260,32400,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800]},"Australia/ACT":{time:[-2364076800,-1672524e3,-1665349200,-883605600,-876085200,-860364e3,-844635600,-828309600,-813186e3,57722400,68007600,89172e3,100062e3,120621600,131511600,152071200,162961200,183520800,195015600,215575200,226465200,247024800,257914800,278474400,289364400,309924e3,320814e3,341373600,352263600,372823200,386737200,404877600,415767600,436327200,447217200,467776800,478666800,499226400,511326e3,530071200,542775600,562125600,57483e4,59418e4,606279600,625629600,636519600,657079200,667969200,688528800,699418800,719978400,731473200,752032800,762922800,783482400,794372400,814932e3,828241200,846381600,859690800,877831200,891140400,909280800,92259e4,941335200,954039600,967341600,985489200,1004234400,1017543600,1035684e3,1048993200,1067133600,1080442800,1099188e3,1111892400,1130637600,1143946800,1162087200,1174791600,1193536800,1207450800,1223172e3,1238900400,1254621600,127035e4,1286071200,1301799600,1317520800,1333249200,1349575200,1365303600,1381024800,1396753200,1412474400,1428202800,1443924e3,1459652400,1475373600,1491102e3,1506823200,1522551600,1538877600,1554606e3,1570327200,1586055600,1601776800,1617505200,1633226400,1648954800,1664676e3,1680404400,1696125600,1712458800,172818e4,1743908400,1759629600,1775358e3,1791079200,1806807600,1822528800,1838257200,1853978400,1869706800,1886032800,1901761200,1917482400,1933210800],offset:[36292,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600]},"Asia/Almaty":{
time:[-1441152e3,-1247529600,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,695786400,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1925013600],offset:[18468,18e3,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,21600,18e3,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600]},"Asia/Ashkhabad":{time:[-1441152e3,-1247529600,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,695786400,192501e4],offset:[14012,14400,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,18e3,14400,18e3]},"Asia/Tokyo":{time:[-2587678861,-683769600,-672274800,-654739200,-640825200,-620265600,-609375600,-588816e3,-577926e3,1925024400],offset:[33539,32400,36e3,32400,36e3,32400,36e3,32400,36e3,32400]},"Asia/Taipei":{time:[-2335219200,-1017792e3,-766191600,-745804800,-733795200,-716860800,-699580800,-683856e3,-670636800,-65232e4,-639100800,-620784e3,-607564800,-589248e3,-576028800,-562896e3,-541728e3,-528681600,-510192e3,-497145600,-478656e3,-465609600,-449798400,-433987200,-418176e3,-402451200,-38664e4,-370915200,-355104e3,-339379200,-323568e3,-302486400,-291945600,-270950400,-260409600,134006400,149817600,165542400,181353600,299635200,307584e3,1925020800],offset:[29160,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Singapore":{time:[-2177452800,-2038176e3,-1167609600,-1073001600,-894153600,-879638400,-766972800,378691200,1925020800],offset:[24925,24925,25200,26400,26400,27e3,32400,27e3,28800]},"Asia/Manila":{time:[-3944678400,-2229292800,-1046649600,-1038700800,-873244800,-794188800,-496195200,-489283200,259372800,275184e3,1925020800],offset:[-57360,29040,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Shanghai":{time:[-2177452800,-1600646400,-1585872e3,-933638400,-922060800,-908841600,-888796800,-881020800,-767836800,-745804800,-733795200,-716860800,-699580800,-683856e3,-670636800,-65232e4,-649987200,515556e3,527047200,545191200,558496800,577245600,589946400,608695200,622000800,640144800,653450400,671594400,6849e5,1925020800],
offset:[29143,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Seoul":{time:[-1948752e3,-1830384e3,-767318400,-681177600,-672192e3,-654739200,-640828800,-623376e3,-609379200,-588816e3,-577929600,-498096e3,-462672e3,-451699200,-429753600,-418262400,-399513600,-387417600,-368064e3,-355968e3,-336614400,-324518400,-305164800,-293068800,-264902400,547610400,560919600,57906e4,592369200,1925024400],offset:[30472,30600,32400,32400,36e3,32400,36e3,32400,36e3,32400,36e3,32400,30600,34200,30600,34200,30600,34200,30600,34200,30600,34200,30600,34200,30600,32400,36e3,32400,36e3,32400]},"Asia/Tehran":{time:[-1704153600,-757382400,247190400,259286400,277776e3,283996800,290822400,306547200,322444800,338515200,673228800,685497600,701222400,71712e4,732758400,748656e3,764294400,780192e3,795830400,811728e3,827366400,843264e3,858988800,874886400,890524800,906422400,922060800,937958400,953596800,969494400,985219200,1001116800,1016755200,1032652800,1048291200,1064188800,1079827200,1095724800,1111449600,1127347200,1206057600,1221955200,123768e4,1253577600,1269216e3,1285113600,1300752e3,1316649600,1332288e3,1348185600,1363910400,1379808e3,1395446400,1411344e3,1426982400,144288e4,1458518400,1474416e3,1490140800,1506038400,1521676800,1537574400,1553212800,1569110400,1584748800,1600646400,1616371200,1632268800,1647907200,1663804800,1679443200,1695340800,1710979200,1726876800,1742601600,1758499200,1774137600,1790035200,1805673600,1821571200,1837209600,1853107200,1868745600,1884643200,1900368e3,1916265600,1931904e3],offset:[12344,12344,12600,14400,18e3,14400,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600]},"Asia/Dubai":{time:[-1577923200,1925006400],offset:[13272,14400]},"Asia/Kolkata":{time:[-3645216e3,-3155673600,-2019686400,-891561600,-872035200,-862617600,-764121600,1925011800],offset:[21208,21200,19270,19800,23400,19800,23400,19800]},"Asia/Hong_Kong":{
time:[-2056663398,-900882e3,-891547200,-884217600,-761176800,-747878400,-728508600,-717021e3,-697059e3,-683757e3,-668028600,-654726600,-636579e3,-623277e3,-605129400,-591827400,-573679800,-559773e3,-541625400,-528323400,-510179400,-498083400,-478729800,-466633800,-446675400,-435184200,-415225800,-403129800,-383776200,-371680200,-352326600,-340230600,-320877e3,-308781e3,-288822600,-277331400,-257373e3,-245881800,-225923400,-213827400,-194473800,-182377800,-163024200,-148509e3,-132784200,-117059400,-101334600,-85609800,-69280200,-53555400,-37830600,-22105800,-6381e3,9343800,25068600,40793400,56518200,72243e3,88572600,104297400,120022200,126070200,151471800,167196600,182921400,198646200,214371e3,295414200,309324600,1925020800],offset:[27402,28800,32400,30600,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Bangkok":{time:[-2840140800,-1570060800,1925017200],offset:[24124,24124,25200]},"Asia/Chongqing":{time:[-2177452800,-1600646400,-1585872e3,-933638400,-922060800,-908841600,-888796800,-881020800,-767836800,-745804800,-733795200,-716860800,-699580800,-683856e3,-670636800,-65232e4,-649987200,515556e3,527047200,545191200,558496800,577245600,589946400,608695200,622000800,640144800,653450400,671594400,6849e5,1925020800],offset:[29143,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Jerusalem":{
time:[-2840140800,-1640995200,-933631200,-923086800,-919029600,-857336400,-844293600,-825800400,-812671200,-794178e3,-779839200,-762642e3,-748303200,-731106e3,-681948e3,-673214400,-667947600,-652312800,-636411600,-622072800,-608936400,-591832800,-572475600,-558568800,-542840400,-527724e3,-514414800,-490831200,-482965200,-459381600,-451515600,-428536800,-418251600,-400111200,-387406800,142387200,150854400,167184e3,178675200,334108800,337741200,452649600,46233e4,482284800,494380800,516758400,526435200,545443200,558489600,576633600,589334400,609897600,620784e3,638323200,651628800,669772800,683683200,701827200,715737600,733708800,747187200,765158400,778032e3,796608e3,810086400,826848e3,842832e3,858902400,874195200,890352e3,90504e4,923018400,936324e3,955677600,970794e3,986778e3,1001293200,1017363600,1033952400,1048813200,1065142800,1081299600,1095814800,1112320800,1128823200,1143770400,1159668e3,117522e4,1189908e3,1206669600,1223172e3,1238119200,1254016800,1269568800,1284256800,1301623200,1317520800,1333072800,1348365600,1364522400,1382839200,1395972e3,1414288800,1427421600,1445738400,1458871200,1477792800,1490320800,1509242400,1521770400,1540692e3,1553824800,1572141600,1585274400,1603591200,1616724e3,1635645600,1648173600,1667095200,1679623200,1698544800,1711677600,1729994400,1743127200,1761444e3,1774576800,1792893600,1806026400,1824948e3,1837476e3,1856397600,1868925600,1887847200,190098e4,1919296800,1932429600],offset:[8454,8440,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,14400,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Asia/Kuwait":{time:[-719625600,1925002800],offset:[11212,10800]},"Asia/Muscat":{time:[-1577923200,1925006400],offset:[13272,14400]},"Asia/Qatar":{time:[-1577923200,76204800,1925002800],offset:[12368,14400,10800]},"Asia/Riyadh":{time:[-719625600,1925002800],offset:[11212,10800]},"Pacific/Auckland":{
time:[-3192393600,-1330293600,-1320012e3,-1300658400,-1287352800,-1269208800,-1255903200,-1237759200,-1224453600,-1206309600,-1192399200,-117486e4,-1160949600,-1143410400,-1125871200,-1112565600,-1094421600,-1081116e3,-1062972e3,-1049666400,-1031522400,-1018216800,-1000072800,-986767200,-968018400,-955317600,-936568800,-923263200,-757382400,152676e3,162356400,183520800,195015600,215575200,226465200,247024800,257914800,278474400,289364400,309924e3,320814e3,341373600,352263600,372823200,384318e3,404877600,415767600,436327200,447217200,467776800,478666800,499226400,510116400,530676e3,541566e3,562125600,573620400,59418e4,60507e4,623815200,637729200,655264800,669178800,686714400,700628400,718164e3,732682800,749613600,764132400,781063200,795582e3,812512800,827031600,844567200,858481200,876016800,889930800,907466400,921985200,938916e3,953434800,970365600,984884400,100242e4,1016334e3,1033869600,1047783600,1065319200,1079838e3,1096768800,1111287600,1128218400,1142737200,1159668e3,1174186800,1191117600,1207450800,1222567200,1238900400,1254016800,127035e4,1285466400,1301799600,1316916e3,1333249200,1348970400,1365303600,138042e4,1396753200,1411869600,1428202800,1443319200,1459652400,1474768800,1491102e3,1506218400,1522551600,1538272800,1554606e3,1569722400,1586055600,1601172e3,1617505200,1632621600,1648954800,1664071200,1680404400,1695520800,1712458800,1727575200,1743908400,1759024800,1775358e3,1790474400,1806807600,1821924e3,1838257200,1853373600,1869706800,1885428e3,1901761200,1916877600,1933210800],offset:[41944,41400,45e3,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800]},"Pacific/Chatham":{
time:[-3192393600,-757382400,152678700,162359100,183523500,195018300,215577900,226467900,247027500,257917500,278477100,289367100,309926700,320816700,341376300,352266300,372825900,384320700,404880300,415770300,436329900,447219900,467779500,478669500,499229100,510119100,530678700,541568700,562128300,573623100,594182700,605072700,623817900,637731900,655267500,669181500,686717100,700631100,718166700,732685500,749616300,764135100,781065900,795584700,812515500,827034300,844569900,858483900,876019500,889933500,907469100,921987900,938918700,953437500,970368300,984887100,1002422700,1016336700,1033872300,1047786300,1065321900,1079840700,1096771500,1111290300,1128221100,1142739900,1159670700,1174189500,1191120300,1207453500,1222569900,1238903100,1254019500,1270352700,1285469100,1301802300,1316918700,1333251900,1348973100,1365306300,1380422700,1396755900,1411872300,1428205500,1443321900,1459655100,1474771500,1491104700,1506221100,1522554300,1538275500,1554608700,1569725100,1586058300,1601174700,1617507900,1632624300,1648957500,1664073900,1680407100,1695523500,1712461500,1727577900,1743911100,1759027500,1775360700,1790477100,1806810300,1821926700,1838259900,1853376300,1869709500,1885430700,1901763900,1916880300,1933213500],offset:[44028,44100,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500]},"Pacific/Fakaofo":{time:[-2177452800,1325203200,1925038800],offset:[-41096,-39600,46800]},"Pacific/Honolulu":{time:[-2334139200,-1157320800,-1155470400,-880236e3,-769429800,-765410400,-712188e3,1924956e3],offset:[-37886,-37800,-34200,-37800,-34200,-34200,-37800,-36e3]},"America/Mexico_City":{
time:[-1514763396,-1343091600,-1234828800,-1220317200,-1207180800,-1191369600,-975283200,-963187200,-917136e3,-907372800,-821923200,-810086400,-627523200,-613008e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,989114400,1001815200,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1175392800,1193536800,1207447200,1224986400,1238896800,1256436e3,1270346400,1288490400,1301796e3,131994e4,1333245600,1351389600,13653e5,1382839200,1396749600,1414288800,1428199200,1445738400,1459648800,1477792800,1491098400,1509242400,1522548e3,1540692e3,1554602400,1572141600,1586052e3,1603591200,1617501600,1635645600,1648951200,1667095200,1680400800,1698544800,1712455200,1729994400,1743904800,1761444e3,1775354400,1792893600,1806804e3,1824948e3,1838253600,1856397600,1869703200,1887847200,1901757600,1919296800,1933207200],offset:[-23796,-25200,-21600,-25200,-21600,-25200,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600]},"Africa/Cairo":{time:[-2185401600,-929836800,-923097600,-906163200,-892857600,-875836800,-857779200,-844300800,-825811200,-812678400,-794188800,-779846400,-762652800,-399081600,-38664e4,-368323200,-355104e3,-336783600,-323643600,-305161200,-292021200,-273625200,-260485200,-242089200,-228949200,-210553200,-197413200,-178930800,-165790800,-147394800,-134254800,-115858800,-102632400,-84322800,-71096400,-52700400,-39474e3,-21164400,-7938e3,10371600,23598e3,41907600,55134e3,7353e4,86756400,105066e3,118292400,136602e3,149828400,168138e3,181364400,199760400,212986800,231296400,244522800,262832400,276058800,294368400,307594800,325990800,339217200,357526800,370753200,396406800,402289200,426819600,433825200,452221200,465447600,483757200,496983600,515293200,528519600,546829200,560055600,578451600,591678e3,610419600,623214e3,641523600,65475e4,673059600,686286e3,704682e3,717908400,736218e3,749444400,767754e3,780980400,799027200,812332800,830476800,843782400,861926400,875232e3,893376e3,906681600,925430400,938736e3,95688e4,970185600,988329600,1001635200,1019779200,1033084800,1051228800,1064534400,1083283200,1096588800,1114732800,1128038400,1146182400,1158883200,1177632e3,1189123200,1209081600,1219968e3,1240531200,1250812800,1272585600,1281484800,1284076800,1285891200,1400198400,1403827200,1406851200,1411689600,1924999200],
offset:[7509,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Africa/Johannesburg":{time:[-2458166400,-2109283200,-860968800,-845244e3,-829519200,-813794400,1924999200],offset:[6720,5400,7200,10800,7200,10800,7200]},"Asia/Kathmandu":{time:[-1577923200,504921600,1925012700],offset:[20476,19800,20700]},"US/Mountain":{time:[-2717668796,-1633298400,-1615154400,-1601848800,-1583704800,-1570399200,-1551650400,-1538949600,-1534111200,-880236e3,-769417200,-765410400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],
offset:[-25196,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200]},"Europe/Helsinki":{time:[-2890252800,-1535932800,-875664e3,-859762800,354679200,370407600,386128800,401857200,417582e3,433310400,449031600,465364800,481086e3,496814400,512535600,528264e3,543985200,559713600,575434800,591163200,606884400,622612800,638334e3,654667200,670388400,686116800,701838e3,717566400,733287600,749016e3,764737200,780465600,796186800,811915200,828241200,846388800,859690800,877838400,891140400,909288e3,92259e4,941342400,954039600,972792e3,985489200,1004241600,1017543600,1035691200,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[5989,5989,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Europe/Stockholm":{
time:[-2871676800,-2208988800,-1692493200,-1680476400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[4332,3614,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Copenhagen":{time:[-2524521600,-2398291200,-1692493200,-1680483600,-935107200,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-769381200,-747007200,-736376400,-715212e3,-706741200,-683157600,-675291600,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],
offset:[3020,3020,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Atlantic/Reykjavik":{time:[-1956614400,-1668214800,-1647212400,-1636678800,-161343e4,-1605142800,-1581894e3,-1539565200,-153135e4,-968029200,-952293600,-942012e3,-920239200,-909961200,-888789600,-877906800,-857944800,-846457200,-826495200,-815007600,-795045600,-783558e3,-762991200,-752108400,-731541600,-717634800,-700092e3,-686185200,-668642400,-654735600,-636588e3,-623286e3,-605743200,-591836400,-573688800,-559782e3,-542239200,-528332400,-510789600,-496882800,-47934e4,-465433200,-447890400,-433983600,-415836e3,-401929200,-384386400,-370479600,-352936800,-33903e4,-321487200,-307580400,-290037600,-276130800,-258588e3,-244681200,-226533600,-212626800,-195084e3,-181177200,-163634400,-149727600,-132184800,-118278e3,-100735200,-86828400,-68680800,-54774e3,1924992e3],offset:[-5280,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0]},"Europe/Tallinn":{time:[-2840140800,-1638316800,-1632002400,-1618693200,-1593820800,-1535932800,-927936e3,-892944e3,-85725e4,-844552800,-828219600,-812498400,-797644800,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909288e3,92259e4,941342400,1017543600,1035691200,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],
offset:[5940,5940,3600,7200,3600,5940,7200,10800,7200,3600,7200,3600,7200,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Europe/Riga":{time:[-2840140800,-1632002400,-1618693200,-1601676e3,-1597266e3,-1377302400,-928022400,-899510400,-85725e4,-844552800,-828219600,-812498400,-79677e4,-795830400,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,843966e3,859690800,877838400,891140400,909288e3,92259e4,941342400,985489200,1004241600,1017543600,1035691200,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[5794,5794,9394,5794,9394,5794,7200,10800,7200,3600,7200,3600,7200,3600,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Europe/Vilnius":{
time:[-2840140800,-1672531200,-1585094400,-1561248e3,-1553558400,-928195200,-900115200,-85725e4,-844552800,-828219600,-812498400,-802137600,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891140400,909284400,922586400,941338800,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[6076,5040,5736,3600,7200,3600,10800,7200,3600,7200,3600,7200,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,7200,3600,7200,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"America/Lima":{time:[-2524521600,-1938556800,-1009843200,-1002067200,-986774400,-971049600,-955324800,-9396e5,504921600,512697600,536457600,544233600,631152e3,638928e3,757382400,765158400,1924974e3],offset:[-18492,-18516,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3]},"America/Santiago":{
time:[-2524521600,-1892678400,-1688428800,-1619222400,-1593820800,-1336003200,-13176e5,-1304380800,-1286064e3,-1272844800,-1254528e3,-1241308800,-1222992e3,-1209772800,-1191369600,-1178150400,-870566400,-865296e3,-740534400,-736387200,-718070400,-713667600,-36633600,-23932800,-3369600,7516800,24451200,37756800,55900800,69206400,87955200,100656e3,118195200,132105600,150854400,163555200,182304e3,195609600,213753600,227059200,245203200,258508800,277257600,289958400,308707200,321408e3,340156800,353462400,371606400,384912e3,403056e3,416361600,434505600,447811200,46656e4,479260800,498009600,510710400,529459200,545184e3,560908800,574214400,592358400,605664e3,624412800,637113600,653443200,668563200,687312e3,700617600,718761600,732067200,750211200,763516800,781660800,794966400,813715200,826416e3,845164800,85968e4,876614400,88992e4,906854400,923184e3,939513600,952819200,971568e3,984268800,1003017600,1015718400,1034467200,1047168e3,1065916800,1079222400,1097366400,1110672e3,1128816e3,1142121600,1160870400,1173571200,119232e4,1206835200,1223769600,1237075200,1255219200,1270339200,1286668800,1304812800,1313884800,1335657600,1346544e3,1367107200,1378598400,1398556800,1410048e3,1463270400,1471132800,149472e4,1502582400,1526169600,1534032e3,1554595200,1567900800,1586044800,1599350400,1617494400,16308e5,1648944e3,1662249600,1680393600,1693699200,1712448e3,1725753600,1743897600,1757203200,1775347200,1788652800,1806796800,1820102400,1838246400,1851552e3,1870300800,1883001600,1901750400,1915056e3,19332e5],offset:[-16966,-16966,-18e3,-16966,-14400,-16966,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-10800,-14400,-18e3,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800]},"Asia/Bahrain":{time:[-1577923200,76204800,1925002800],offset:[12368,14400,10800]},"Asia/Jakarta":{time:[-3231273600,-1451693568,-117288e4,-876614400,-766022400,-683856e3,-620784e3,-189388800,1925017200],offset:[25632,25632,26400,27e3,32400,27e3,28800,27e3,25200]},"Africa/Lagos":{time:[-2035584e3,-1940889600,-1767225600,-1588464e3,1924995600],offset:[815,0,815,1800,3600]},"Pacific/Norfolk":{
time:[-2177452800,-599616e3,152071200,162961200,1443924e3,1570327200,1586055600,1601776800,1617505200,1633226400,1648954800,1664676e3,1680404400,1696125600,1712458800,172818e4,1743908400,1759629600,1775358e3,1791079200,1806807600,1822528800,1838257200,1853978400,1869706800,1886032800,1901761200,1917482400,1933210800],offset:[40312,40320,41400,45e3,41400,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200]},"America/Juneau":{time:[-3225169588,-2188987200,-880236e3,-769420800,-765410400,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,438998400,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[54139,-32261,-28800,-25200,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-28800,-28800,-25200,-28800,-25200,-28800,-25200,-32400,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400]},"Asia/Ho_Chi_Minh":{time:[-2004048e3,-1851552e3,-852080400,-782614800,-767836800,-718070400,-457747200,-315622800,171849600,1925017200],offset:[25600,25590,25200,28800,32400,25200,28800,25200,28800,25200]},"Australia/Perth":{
time:[-2337897600,-1672524e3,-1665349200,-883605600,-876085200,-860364e3,-844635600,152071200,162961200,436327200,447217200,690343200,699418800,1165111200,1174791600,1193536800,1206846e3,1224986400,1238295600,1925020800],offset:[27804,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Europe/Malta":{time:[-2403475200,-1690761600,-168048e4,-1664755200,-1648944e3,-163512e4,-1616889600,-1604275200,-1585526400,-1571011200,-1555286400,-932428800,-85725e4,-844552800,-828219600,-812584800,-798066e3,-781048800,-76671e4,-750895200,-733352400,-719452800,-70191e4,-689205600,-670453200,-114048e3,-103161600,-81993600,-71708400,-50544e3,-40258800,-18489600,-8204400,1296e4,23245200,43804800,54694800,75859200,86749200,102384e3,118112400,135734400,148525200,167191200,180496800,198640800,211946400,230090400,243396e3,26154e4,274845600,292989600,306295200,323316e3,338349600,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[3484,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Amsterdam":{
time:[-4260211200,-1693699200,-168048e4,-1663452e3,-1650142800,-1633212e3,-1617483600,-1601157600,-1586034e3,-1569708e3,-1554584400,-1538258400,-1523134800,-15075e5,-1490562e3,-1470175200,-1459112400,-1443996e3,-1427662800,-1406671200,-1396213200,-1376949600,-1364763600,-1345413600,-1333314e3,-1313791200,-1301259600,-1282255200,-126981e4,-1250719200,-1238360400,-1219183200,-1206910800,-1186956e3,-1175461200,-1156024800,-1143406800,-1124488800,-1111957200,-1092952800,-1080507600,-1061330400,-1049058e3,-1029189600,-1025740800,-1017608400,-998258400,-986158800,-966722400,-954104400,-935020800,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-766616400,228880800,244004400,260330400,276058800,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[1172,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,4800,1200,4800,1200,4800,1200,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Brussels":{
time:[-2840140800,-2450994150,-1740355200,-1693699200,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-1613822400,-1604278800,-1585526400,-1574038800,-1552262400,-1539997200,-1520553600,-1507510800,-1490572800,-1473642e3,-1459123200,-1444006800,-1427673600,-1411952400,-1396224e3,-1379293200,-1364774400,-1348448400,-1333324800,-1316394e3,-1301259600,-1284328800,-126981e4,-1253484e3,-1238360400,-1221429600,-1206910800,-1191189600,-1175461200,-1160344800,-1143406800,-1127685600,-1111957200,-1096840800,-1080507600,-1063576800,-1049058e3,-1033336800,-1017608400,-1002492e3,-986158800,-969228e3,-950475600,-942012e3,-934664400,-85725e4,-844552800,-828219600,-812498400,-798066e3,-781048800,-766616400,-745452e3,-733266e3,228880800,244004400,260330400,276058800,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[1050,1050,0,3600,7200,3600,7200,3600,7200,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Lisbon":{
time:[-1830386205,-1689555600,-1677798e3,-1667437200,-1647734400,-1635814800,-1616198400,-1604365200,-1584662400,-1572742800,-155304e4,-1541206800,-1521504e3,-1442451600,-1426809600,-1379293200,-1364774400,-1348448400,-1333324800,-1316394e3,-1301270400,-1284339600,-1269820800,-1221440400,-1206921600,-1191200400,-1175472e3,-1127696400,-1111968e3,-1096851600,-1080518400,-1063587600,-1049068800,-1033347600,-1017619200,-1002502800,-986169600,-969238800,-950486400,-942022800,-922665600,-906944400,-891129600,-877309200,-873680400,-864e6,-857952e3,-845859600,-842835600,-831340800,-825897600,-81441e4,-810781200,-799891200,-794448e3,-782960400,-779331600,-768441600,-762998400,-749091600,-733363200,-717631200,-701902800,-686181600,-670453200,-654732e3,-639003600,-623282400,-607554e3,-591832800,-575499600,-559778400,-54405e4,-528328800,-512600400,-496879200,-481150800,-465429600,-449701200,-43398e4,-417646800,-401925600,-386197200,-370476e3,-354747600,-339026400,-323298e3,-307576800,-291848400,-276127200,-260398800,-244677600,-228344400,-212623200,-196894800,-181173600,-165445200,-149724e3,-133995600,-118274400,212547600,228268800,243997200,260323200,276051600,291772800,307504800,323222400,338954400,354675600,370404e3,386125200,401853600,417578400,433303200,449024400,465357600,481078800,496807200,512528400,528256800,543978e3,559706400,575427600,591156e3,606877200,622605600,638326800,65466e4,670381200,686109600,701830800,717559200,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846381600,859683600,877831200,891133200,909280800,922582800,941335200,954032400,972784800,985482e3,1004234400,1017536400,1035684e3,1048986e3,1067133600,1080435600,1099188e3,1111885200,1130637600,1143334800,1162087200,1174784400,1193536800,1206838800,1224986400,1238288400,1256436e3,1269738e3,1288490400,1301187600,131994e4,1332637200,1351389600,1364691600,1382839200,1396141200,1414288800,1427590800,1445738400,1459040400,1477792800,149049e4,1509242400,1521939600,1540692e3,1553994e3,1572141600,1585443600,1603591200,1616893200,1635645600,1648342800,1667095200,1679792400,1698544800,1711846800,1729994400,1743296400,1761444e3,1774746e3,1792893600,1806195600,1824948e3,1837645200,1856397600,1869094800,1887847200,1901149200,1919296800,1932598800],offset:[-2205,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,0,3600,7200,3600,0,3600,7200,3600,0,3600,7200,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,3600,7200,3600,7200,3600,7200,3600,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0]},"Europe/Dublin":{
time:[-2821651200,-1691964e3,-1680469200,-1664143200,-1650142800,-1633903200,-1617483600,-1601848800,-1586034e3,-1570399200,-1552165200,-1538344800,-152253e4,-15075e5,-1490562e3,-1473631200,-1460926800,-1442786400,-1428872400,-1410732e3,-1396213200,-1379282400,-1364763600,-1348437600,-1333314e3,-1315778400,-1301259600,-1284328800,-126981e4,-1253484e3,-1238360400,-1221429600,-1206910800,-118998e4,-1175461200,-1159135200,-1143406800,-1126476e3,-1111957200,-1095631200,-1080507600,-1063576800,-1049058e3,-1032127200,-1017608400,-1001282400,-986158800,-969228e3,-950475600,-942012e3,-733352400,-719445600,-699483600,-684972e3,-668034e3,-654732e3,-636584400,-622072800,-605739600,-590623200,-57429e4,-558568800,-542235600,-527119200,-512600400,-496274400,-481150800,-46422e4,-449701200,-432165600,-417646800,-401320800,-386197200,-369266400,-354747600,-337816800,-323298e3,-306972e3,-291848400,-276732e3,-257979600,-245282400,-22653e4,-213228e3,-195080400,-182383200,-163630800,-150933600,-132181200,-119484e3,-100731600,-88034400,-68677200,-59004e3,57726e3,69818400,89175600,101268e3,120625200,132717600,152074800,164167200,183524400,196221600,214974e3,227671200,246423600,259120800,278478e3,290570400,309927600,32202e4,341377200,354675600,372823200,386125200,404272800,417574800,435722400,449024400,467776800,481078800,499226400,512528400,530676e3,543978e3,562125600,575427600,593575200,606877200,625629600,638326800,657079200,670381200,688528800,701830800,719978400,733280400,751428e3,76473e4,782877600,796179600,814327200,828234e3,846381600,859683600,877831200,891133200,909280800,922582800,941335200,954032400,972784800,985482e3,1004234400,1017536400,1035684e3,1048986e3,1067133600,1080435600,1099188e3,1111885200,1130637600,1143334800,1162087200,1174784400,1193536800,1206838800,1224986400,1238288400,1256436e3,1269738e3,1288490400,1301187600,131994e4,1332637200,1351389600,1364691600,1382839200,1396141200,1414288800,1427590800,1445738400,1459040400,1477792800,149049e4,1509242400,1521939600,1540692e3,1553994e3,1572141600,1585443600,1603591200,1616893200,1635645600,1648342800,1667095200,1679792400,1698544800,1711846800,1729994400,1743296400,1761444e3,1774746e3,1792893600,1806195600,1824948e3,1837645200,1856397600,1869094800,1887847200,1901149200,1919296800,1932598800],offset:[-1500,-1521,2079,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0]},"Europe/Oslo":{
time:[-2366755200,-1691881200,-1680566400,-927507600,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-765320400,-340840800,-324507600,-308786400,-293058e3,-277336800,-261608400,-245887200,-230158800,-214437600,-198709200,-182988e3,-166654800,-147909600,-135205200,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[2580,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]}}},44560:(e,t,i)=>{"use strict";i.d(t,{Version:()=>s});var r=i(16282);class s{constructor(e,t){this._major=e,this._minor=t}major(){return this._major}minor(){return this._minor}isZero(){return 0===this._major&&0===this._minor}toString(){return this._major+"."+this._minor}compareTo(e){return this._major<e._major?-1:this._major>e._major?1:this._minor<e._minor?-1:this._minor>e._minor?1:0}isLess(e){return this.compareTo(e)<0}isLessOrEqual(e){return this.compareTo(e)<=0}isEqual(e){return 0===this.compareTo(e)}isGreater(e){return this.compareTo(e)>0}isGreaterOrEqual(e){return this.compareTo(e)>=0}static parse(e){if(e instanceof s)return new s(e.major(),e.minor());if("number"==typeof e)return(0,r.assert)(Math.floor(e)===e,"Version should not be a float number"),new s(e,0);if("string"==typeof e){const t=e.split(".");if(1===t.length){const i=parseInt(t[0],10);return(0,r.assert)(!isNaN(i),"Bad version string: "+e),new s(i,0)}if(2===t.length){const i=parseInt(t[0],10);(0,r.assert)(!isNaN(i),"Bad version string: "+e);const n=parseInt(t[1],10);return(0,
r.assert)(!isNaN(n),"Bad version string: "+e),new s(i,n)}throw new Error("Bad version string (one dot expected): "+e)}throw new Error("Bad version: "+e)}}s.ZERO=new s(0,0)},96131:(e,t,i)=>{"use strict";i.d(t,{WatchedObject:()=>a});var r=i(65066),s=i.n(r),n=i(31565);function o(e,t){return(0,n.deepEquals)(e,t)[0]}class a extends(s()){constructor(e,t=o){super(e),this._comparator=t}setValue(e,t){!1===this._comparator(this.value(),e)&&super.setValue(e,t)}}},65066:(e,t,i)=>{"use strict";e=i.nmd(e);var r=i(87380).getLogger("Common.WatchedValue");function s(){}function n(e){if(!(this instanceof n))return new n(e);arguments.length>0&&(this._value=e),this._listeners=[]}n.prototype.value=function(){return this._owner?this._owner._value:this._value},n.prototype.setValue=function(e,t){var i=this._owner?this._owner:this;if("function"==typeof i.hook&&(e=i.hook(e)),i.writeLock)return i._value;var s=i._value===e||Number.isNaN(i._value)&&Number.isNaN(e);if(!t&&s&&i.hasOwnProperty("_value"))return e;i._value=e;for(var n=i._listeners.slice(),o=0,a=0;a<n.length;a++){n[a].once&&(i._listeners.splice(a-o,1),o++);try{n[a].cb(e)}catch(e){r.logError(e.stack||e.message)}}return e},n.prototype.deleteValue=function(){var e=this._owner?this._owner:this;if(e.hasOwnProperty("_value")){if(e.writeLock)return e._value;delete e._value;for(var t=e._listeners.slice(),i=0,s=0;s<t.length;s++){t[s].once&&(e._listeners.splice(s-i,1),i++);try{t[s].cb()}catch(e){r.logError(e.stack||e.message)}}}},n.prototype.subscribe=function(e,t){if("function"!=typeof e)throw new TypeError("callback must be a function");var i=!!t&&!!t.once,s=!!t&&!!t.callWithLast,n=this._owner?this._owner:this;if(s&&n.hasOwnProperty("_value")){try{e(n._value)}catch(e){r.logError(e.stack||e.message)}if(i)return}n._listeners.push({cb:e,owner:this,once:!!t&&!!t.once})},n.prototype.unsubscribe=function(e){var t=this._owner?this._owner:this;void 0===e&&(e=null);for(var i=t._listeners,r=i.length;r--;)i[r].owner!==this&&t!==this||i[r].cb!==e&&null!==e||i.splice(r,1)},n.prototype.listeners=function(){return(this._owner?this._owner:this)._listeners},n.prototype.readonly=function(){if(this._readonlyInstance)return this._readonlyInstance;var e=this._readonlyInstance=new s;return e.subscribe=this.subscribe.bind(this),e.unsubscribe=this.unsubscribe.bind(this),e.value=this.value.bind(this),e.when=this.when.bind(this),e.spawn=function(){return this.spawn().readonly()}.bind(this),this.destroy&&(e.destroy=this.destroy.bind(this)),e},n.prototype.spawn=function(e){var t=new n;return delete t._listeners,t._owner=this._owner||this,t.destroy=function(){if("function"==typeof e)try{e()}catch(e){r.logError(e.stack||e.message)}this.unsubscribe(),delete this._owner},t},n.prototype.when=function(e){var t=this;if(this.value())try{e()}catch(e){r.logError(e.stack||e.message)}else{var i=function(r){r&&(t.unsubscribe(i),e())};t.subscribe(i)}},n.prototype.opposite=function(){if(!this._opposite){var e=this,t=new n(!this.value());this.subscribe((function(e){t.setValue(!e)})),t.subscribe((function(t){e.setValue(!t)})),
this._opposite=t}return this._opposite},"undefined"!=typeof window&&(window.WatchedValue=n),e&&e.exports&&(e.exports=n)},12578:(e,t,i)=>{"use strict";i.d(t,{isDrawingToolbarVisible:()=>c});var r=i(42098),s=i(22842),n=i(65066),o=i.n(n);const a=!s.enabled("hide_left_toolbar_by_default"),l=r.getBool("ChartDrawingToolbarWidget.visible",a),c=new(o())(l)},74554:(e,t,i)=>{"use strict";function r(e){return"seekingalpha"===e||"smartlab-custom"===e?Promise.all([i.e(23876),i.e(29448),i.e(37610),i.e(76473),i.e(43894),i.e(33996),i.e(60700),i.e(87936),i.e(55313),i.e(19843),i.e(68604),i.e(96637),i.e(2359),i.e(18277),i.e(63537),i.e(10446),i.e(81778),i.e(97757),i.e(60959),i.e(63170),i.e(75249),i.e(19513),i.e(73935),i.e(45867),i.e(1529),i.e(36982),i.e(27274),i.e(38464),i.e(80594),i.e(72417),i.e(57276),i.e(32923),i.e(9353),i.e(68718)]).then(i.bind(i,68718)):"cme"===e?Promise.all([i.e(23876),i.e(29448),i.e(37610),i.e(76473),i.e(43894),i.e(33996),i.e(60700),i.e(87936),i.e(55313),i.e(19843),i.e(68604),i.e(96637),i.e(2359),i.e(18277),i.e(63537),i.e(10446),i.e(97757),i.e(60959),i.e(63170),i.e(75249),i.e(73935),i.e(45867),i.e(1529),i.e(36982),i.e(27274),i.e(38464),i.e(80594),i.e(72417),i.e(57276),i.e(32923),i.e(81045)]).then(i.bind(i,81045)):Promise.all([i.e(23876),i.e(29448),i.e(37610),i.e(76473),i.e(43894),i.e(33996),i.e(60700),i.e(87936),i.e(55313),i.e(19843),i.e(68604),i.e(96637),i.e(2359),i.e(18277),i.e(63537),i.e(10446),i.e(97757),i.e(60959),i.e(63170),i.e(75249),i.e(73935),i.e(45867),i.e(1529),i.e(36982),i.e(27274),i.e(38464),i.e(80594),i.e(72417),i.e(57276),i.e(32923),i.e(72239)]).then(i.bind(i,72239))}i.d(t,{resolveByCustomer:()=>r})},54281:(e,t,i)=>{"use strict";i.r(t),i.d(t,{Action:()=>l,ActionAsync:()=>c,Separator:()=>u,Loader:()=>d});var r=i(34647),s=i(96276),n=i.n(s),o=i(11877),a=i(75443);class l{constructor(e,t=a.guid()){this.type=r.MenuItemType.Action,this._destroyed=!1,this._binding=null,this.id=t,this._onUpdate=new(n()),this._options=e,this.update(e)}execute(){this._options.checkable&&this.update({checked:!this._options.checked}),this._options.onExecute&&this._options.onExecute(this)}getLabel(){return this._options.label||""}getSubItems(){return this._options.subItems||[]}isDisabled(){return!0===this._options.disabled}isActive(){return!0===this._options.active}isCheckable(){return!0===this._options.checkable}isChecked(){return!0===this._options.checked}isLoading(){return!0===this._options.loading}getSize(){var e;return null!==(e=this._options.size)&&void 0!==e?e:"normal"}getPayload(){return this._options.payload}update(e){this._destroyed||(this._unbindShortcut(),e.hotkeyHash&&(this._options.shortcutHint=(0,o.humanReadableHash)(e.hotkeyHash)),this._options=Object.assign(this._options,e),this._bindShortcut(),this._onUpdate.fire(this))}onUpdate(){return this._onUpdate}getState(){return{label:this.getLabel(),disabled:this.isDisabled(),active:this.isActive(),subItems:this.getSubItems(),checkable:this.isCheckable(),checked:this.isChecked(),loading:this.isLoading(),size:this.getSize(),
doNotCloseOnClick:this._options.doNotCloseOnClick||!1,shortcutHint:this._options.shortcutHint,hint:this._options.hint,icon:this._options.icon,iconChecked:this._options.iconChecked,toolbox:this._options.toolbox,showToolboxOnHover:this._options.showToolboxOnHover||!1,statName:this._options.statName,name:this._options.name,invisibleHotkey:this._options.invisibleHotkey,jsxLabel:this._options.jsxLabel}}getBinding(){return this._binding}setBinding(e){this._binding=e}destroy(){this._destroyed=!0,this._onUpdate.destroy(),null!==this._binding&&this._binding.destroy(),this._unbindShortcut()}options(){return this._options}_bindShortcut(){if(!this._options.hotkeyGroup||!this._options.hotkeyHash)return;const e="string"==typeof this._options.label?this._options.label:this._options.name;this._hotkeyAction=this._options.hotkeyGroup.add({hotkey:this._options.hotkeyHash,desc:e,handler:()=>this.execute(),isDisabled:()=>this.isDisabled()})}_unbindShortcut(){this._hotkeyAction&&(this._hotkeyAction.destroy(),delete this._hotkeyAction)}}class c extends l{constructor(e,t){super({},t),this._loader=e,this._loaded=!1}loadOptions(){return this._loadingPromise||(this._loadingPromise=this._loader().then(e=>{this._loaded=!0,this.update(e)})),this._loadingPromise}getState(){return this.loadOptions(),super.getState()}isLoading(){return!this.isLoaded()}isLoaded(){return this._loaded}}class u{constructor(e,t=a.guid()){this.type=r.MenuItemType.Separator,this.id=t,this._hint=e}getHint(){return this._hint}}class d extends l{constructor(){super({})}isLoading(){return!0}getSize(){return"big"}}},34647:(e,t,i)=>{"use strict";var r;i.d(t,{MenuItemType:()=>r}),function(e){e[e.Separator=0]="Separator",e[e.Action=1]="Action"}(r||(r={}))},88137:(e,t,i)=>{"use strict";i.d(t,{ActionsProvider:()=>jt,createActionAddAlert:()=>Vt,createActionTrade:()=>Ft,createLinesAction:()=>Ht,createMTPredictorActions:()=>Ut,createSyncDrawingActions:()=>zt,defaultContextMenuOptions:()=>Nt});var r=i(16282),s=i(87380),n=i(93302),o=i(31565),a=i(22842),l=i(54281),c=i(26377),u=i(76887),d=i(55304),h=i(46926),p=i(29098),_=i(86472),m=i(59958),f=i(24322),g=i(7767),v=i(42258),S=i(91293);var y=i(66962),b=i(55833),w=i(73356),P=i(57746),C=i(63145),T=i(93363),x=i(8412),I=i(5991),L=i(32411),M=i(18301),E=i(66679),A=i(20552),k=i(79318),D=i(75196),R=i(70677),N=i(68724),O=i(98006),V=i(40142);const B=(0,O.isFeatureEnabled)("mobile_trading_ios")&&N.CheckMobile.iOS()&&(0,V.isOnMobileAppPage)("old"),F=(0,O.isFeatureEnabled)("mobile_trading_android")&&N.CheckMobile.Android()&&(0,V.isOnMobileAppPage)("new"),W=(0,O.isFeatureEnabled)("mobile_trading_web")&&N.CheckMobile.any()&&!/iPad/.test(navigator.platform)&&(window.matchMedia("screen and (orientation: portrait) and (max-width: 567px)").matches||window.matchMedia("screen and (orientation: landscape) and (max-height: 567px)").matches)&&!(0,V.isOnMobileAppPage)("any"),U=a.enabled("mobile_trading")&&(B||F||W);var H=i(11877),z=i(27393),j=i(16834),Y=i(39610),G=i(55034),q=i(49992),X=i(87048),$=i(88987),K=i(11585),J=i(20220),Z=i(68450),Q=i(71928),ee=i(14397)
;const te=(0,s.getLogger)("Chart.ActionsProvider"),ie=(0,J.t)("Add Alert"),re=(0,J.t)("Add Alert on {series}"),se=(0,J.t)("Add Alert on {drawing}"),ne=(0,K.appendEllipsis)((0,J.t)("Edit {title} Alert")),oe=(0,J.t)("Extend Alert Lines"),ae=(0,J.t)("Show alert label lines"),le=(0,J.t)("Hide alert label lines"),ce=(0,J.t)("Trade"),ue=(0,K.appendEllipsis)((0,J.t)("Create Limit Order")),de=(0,J.t)("Show"),he=(0,J.t)("Hide"),pe=(0,J.t)("MTPredictor"),_e=(0,J.t)("Apply Manual Risk/Reward"),me=(0,J.t)("Apply Manual Decision Point"),fe=(0,J.t)("Analyze Trade Setup"),ge=(0,J.t)("Apply Elliott Wave"),ve=(0,J.t)("Apply Elliott Wave Intermediate"),Se=(0,J.t)("Apply Elliott Wave Major"),ye=(0,J.t)("Apply Elliott Wave Minor"),be=(0,J.t)("Apply WPT Up Wave"),we=(0,J.t)("Up Wave 1 or A"),Pe=(0,J.t)("Up Wave 2 or B"),Ce=(0,J.t)("Up Wave C"),Te=(0,J.t)("Up Wave 3"),xe=(0,J.t)("Up Wave 4"),Ie=(0,J.t)("Up Wave 5"),Le=(0,J.t)("Apply WPT Down Wave"),Me=(0,J.t)("Down Wave 1 or A"),Ee=(0,J.t)("Down Wave 2 or B"),Ae=(0,J.t)("Down Wave C"),ke=(0,J.t)("Down Wave 3"),De=(0,J.t)("Down Wave 4"),Re=(0,J.t)("Down Wave 5"),Ne=(0,J.t)("Pinned To Scale {label} (Hidden)"),Oe=(0,J.t)("Pinned To Right Scale (Hidden)"),Ve=(0,J.t)("Pin To Scale {label} (Hidden)"),Be=(0,J.t)("Pin To Right Scale (Hidden)"),Fe=(0,J.t)("Pinned To Scale {label}"),We=(0,J.t)("Pinned To Right Scale"),Ue=(0,J.t)("Pin To Scale {label}"),He=(0,J.t)("Pin To Right Scale"),ze=(0,J.t)("Pinned To Left Scale (Hidden)"),je=(0,J.t)("Pin To Left Scale (Hidden)"),Ye=(0,J.t)("Pinned To Left Scale"),Ge=(0,J.t)("Pin To Left Scale"),qe=(0,J.t)("Pin To New Left Scale"),Xe=(0,J.t)("Pin To New Right Scale"),$e=(0,J.t)("Pin To Scale (Now {label})"),Ke=(0,J.t)("Pin To Scale (Now No Scale)"),Je=(0,J.t)("Pin To Scale (Now Left)"),Ze=(0,J.t)("Pin To Scale (Now Right)"),Qe=(0,J.t)("No Scale (Fullscreen)"),et=(0,J.t)("Move To"),tt=(0,J.t)("Existing Pane Above"),it=(0,J.t)("New Pane Above"),rt=(0,J.t)("Existing Pane Below"),st=(0,J.t)("New Pane Below"),nt=(0,J.t)("Bring to Front"),ot=(0,J.t)("Send to Back"),at=(0,J.t)("Bring Forward"),lt=(0,J.t)("Send Backward"),ct=(0,J.t)("Visual Order"),ut=(0,J.t)("Lines"),dt=(0,K.appendEllipsis)((0,J.t)("Add Indicator/Strategy on {studyTitle}")),ht=(0,K.appendEllipsis)((0,J.t)("Add Financial metric for {instrumentName}")),pt=(0,K.appendEllipsis)((0,J.t)("Settings")),_t=(0,J.t)("Apply Default"),mt=(0,K.appendEllipsis)((0,J.t)("Save As")),ft=(0,J.t)("Copy"),gt=(0,J.t)("Clone"),vt=(0,J.t)("Template"),St=(0,J.t)("Go to {lineToolName}"),yt=(0,J.t)("Unlock"),bt=(0,J.t)("Lock"),wt=(0,J.t)("objects"),Pt=(0,J.t)("Show Earnings"),Ct=(0,J.t)("Show Dividends"),Tt=(0,J.t)("Show Splits"),xt=(0,J.t)("Show All Ideas"),It=(0,J.t)("Show Ideas of Followed Users"),Lt=(0,J.t)("Show My Ideas Only"),Mt=(0,K.appendEllipsis)((0,J.t)("Settings")),Et=(0,J.t)("Hide Events on Chart"),At=(0,J.t)("Add this Symbol to Entire Layout"),kt=(0,J.t)("Add this Indicator to Entire Layout"),Dt=(0,J.t)("Add this Strategy to Entire Layout"),Rt=(0,J.t)("Add this Financial Metric to Entire Layout"),Nt={general:!0,
mainSeries:!0,mainSeriesTrade:!0,esdStudies:!0,studies:!0,fundamentals:!0,lineTools:!0,publishedCharts:!0,ordersAndPositions:!0,alerts:!0,chartEvents:!0,objectTree:!0,gotoLineTool:!1};function Ot(e){return(0,$.isSymbolSource)(e)?e.symbolTitle(!0,!0):e.title(!0)}function Vt(e,t){const i=e.model().model();if(i.mainSeries().isConvertedToOtherCurrency()||i.mainSeries().isConvertedToOtherUnit())return null;let s={},n=ie,o=null;const a=void 0!==t.series?Bt(t.series,i.mainSeries()):t.e?Bt((0,r.ensureNotNull)((0,r.ensureDefined)(t.pane).mainDataSource()),i.mainSeries(),t.e.localY):t.drawing?function(e){const t=(0,r.ensureNotNull)(e.ownerSource()).symbolSource();if(t&&(t.isConvertedToOtherCurrency()||t.isConvertedToOtherUnit()))return null;return{label:se.format({drawing:e.title()}),trackEventLabel:"ContextMenuDrawing",alertEditorOptions:{drawing:e}}}(t.drawing):null;return a&&(s=a.alertEditorOptions,n=a.label,o=a.trackEventLabel),n=(0,K.appendEllipsis)(n),new l.ActionAsync(()=>(s.series?(0,A.hasUserAccessToDataSource)(s.series):Promise.resolve(!0)).then(e=>{const t={label:n,icon:M,statName:"AddAlert"};return e?{...t,shortcutHint:(0,H.humanReadableHash)(H.Modifiers.Alt+65),onExecute:()=>{null!==o&&((0,p.trackEvent)("GUI","CreateAlert",o),o=null),window.runOrSignIn(()=>{(0,m.invokeAlertEditorWithOnlineSeries)({...s,dataSourceHub:i,actionSource:"pane_context_menu_add_alert"})},{source:"Alert add from pane context menu",sourceMeta:"Chart"})}}:{...t,disabled:!0}}))}function Bt(e,t,i){const r=e.symbolSource();if(r&&(r.isConvertedToOtherCurrency()||r.isConvertedToOtherUnit()))return null;let s,n=(0,d.isStudy)(e)?re.format({series:Ot(e)}):ie;const o=(0,d.isStudy)(e)?"ContextMenuStudy":e===t?"ContextMenuSeries":null,a=e.priceScale()||t.priceScale(),l=e.firstValue();if(void 0!==i&&null!==l)s=a.coordinateToPrice(i,l);else if(e===t)s=t.lastValueData(4,!0,!0).price;else if((0,d.isStudy)(e)){const t=e.defaultPlotIdForAlert();s=null===t?void 0:e.lastValueData(t,!0,!0).price}return void 0!==s&&(n+=" ("+a.formatter().format(s)+")"),{label:n,trackEventLabel:o,alertEditorOptions:{series:e,value:s}}}function Ft(e,t,i){const r=e.model().mainSeries();return r.isConvertedToOtherCurrency()||r.isConvertedToOtherUnit()?null:new l.ActionAsync(()=>function(e,t,i="promise rejected by time-out"){return new Promise((r,s)=>{const n=setTimeout(()=>s(i),t);e.then(e=>{clearTimeout(n),r(e)}),e.catch(e=>{clearTimeout(n),s(e)})})}(new Promise((t,r)=>{const s=(0,v.tradingService)();if(null===s||0===s.brokersList().length)return void t({label:ce,disabled:!0});const n=e.model().mainSeries();let o;i&&(o=i.localY),(0,S.createTradeContext)(n,o).then(e=>{try{return s.chartContextMenuActions(e)}catch(e){return te.logError(e.message),[]}}).then(e=>{0!==e.length?t({name:"trade",label:ce,subItems:e,statName:"Trading"}):t({label:ce,disabled:!0})}).catch(()=>{r("Unable to get Trade Context")})}),2e3,"Action trade not received"))}function Wt(){const e=(0,r.ensureNotNull)((0,v.tradingService)());return new l.Action({label:ue,statName:"ShowSelectBrokerNotification",
onExecute:()=>{var t;let i=!0;i=U,i&&!(null===(t=window.TradingView.bottomWidgetBar)||void 0===t?void 0:t.isVisible().value())?e.toggleTradingPanelPopup():e.toggleTradingWidget(),e.onNeedSelectBroker.fire()}})}function Ut(e,t,i,s){const n=(n,o,a)=>new l.Action({label:n,onExecute:()=>{const n=e.model(),l=n.model().timeScale(),c=t.defaultPriceScale();if(!l.isEmpty()&&!c.isEmpty())if(a&&void 0!==i&&void 0!==s){const e=(0,r.ensureNotNull)((0,r.ensureNotNull)(t.mainDataSource()).firstValue()),a=c.coordinateToPrice(i,e),u=Math.round(l.coordinateToIndex(s));n.createLineTool(t,{index:u,price:a},o,void 0)}else ee.tool.setValue(o)}});return new l.Action({label:pe,subItems:[n(_e,"LineStudyMtpRiskReward",!1),n(me,"LineStudyMtpDecisionPoint",!0),n(fe,"LineStudyMtpAnalysis",!0),new l.Action({label:ge,subItems:[n(ve,"LineStudyMtpElliotWaveMain",!0),n(Se,"LineStudyMtpElliotWaveMajor",!0),n(ye,"LineStudyMtpElliotWaveMinor",!0)]}),new l.Action({label:be,subItems:[n(we,"LineStudyMtpUpWave1OrA",!1),n(Pe,"LineStudyMtpUpWave2OrB",!1),n(Ce,"LineStudyMtpUpWaveC",!1),n(Te,"LineStudyMtpUpWave3",!1),n(xe,"LineStudyMtpUpWave4",!1),n(Ie,"LineStudyMtpUpWave5",!1)]}),new l.Action({label:Le,subItems:[n(Me,"LineStudyMtpDownWave1OrA",!1),n(Ee,"LineStudyMtpDownWave2OrB",!1),n(Ae,"LineStudyMtpDownWaveC",!1),n(ke,"LineStudyMtpDownWave3",!1),n(De,"LineStudyMtpDownWave4",!1),n(Re,"LineStudyMtpDownWave5",!1)]})]})}function Ht(e){const t=e.actions(),i=[t.showPriceLine];return i.push(t.showSeriesPrevCloseLine),i.push(t.showPrePostMarketPriceLine),i.push(t.showHighLowPriceLines),i.push(t.showAverageClosePriceLine),e.model().model().hasCustomSource("bidask")&&i.push(t.showBidAskLines),new l.Action({label:ut,statName:"Lines",subItems:i})}function zt(e,t){const i=[];if(ee.isToolCreatingNow.value())return i;if(a.enabled("support_multicharts")&&e.isMultipleLayout()&&t.some(e=>e.isSynchronizable())){const r=t.every(e=>!!e.linkKey().value()),s=()=>{let t;return e.chartWidgetCollection()&&(t=e.chartWidgetCollection().activeChartWidget.value()),t||(t=e),t};i.push(new l.Separator),i.push(new l.Action({label:(0,J.t)("No sync"),statName:"NoSyncDrawing",checkable:!0,checked:!r,onExecute:e=>{e.isChecked()&&s().unlinkSelectedLine()}})),i.push(new l.Action({label:(0,J.t)("Sync in layout"),statName:"SyncDrawingInLayout",checkable:!0,checked:r,onExecute:e=>{e.isChecked()&&s().copyLineToOtherCharts()}}))}return i}class jt{constructor(e,t){this._chartWidget=e,this._options=(0,o.merge)((0,o.clone)(Nt),t||{})}async contextMenuActionsForSources(e){const t=e[0],i=this._options;if(t===this._chartWidget.model().mainSeries()&&i.mainSeries)return this._contextMenuActionsForSeries(t);if(t instanceof L.ESDStudyBase&&i.esdStudies)return this._contextMenuActionsForESD();if((0,d.isStudy)(t)&&i.studies)return this._contextMenuActionsForStudy(t);if(t instanceof C.PublishedChartsTimeline&&i.publishedCharts)return this._contextMenuActionsForPublishedTimeline(t)
;if((t instanceof y.LineToolOrder||t instanceof b.LineToolPosition)&&i.ordersAndPositions)return this._contextMenuActionsForTradingDrawings(t);if(t instanceof x.AlertLabel&&t.alert().id&&i.alerts)return this._contextMenuActionsForAlertLabel(t);if((0,X.isLineTool)(t)&&i.lineTools){const t=e.filter(X.isLineTool);return this._contextMenuActionsForLineTool(t)}return t instanceof I.ChartEventsSource&&i.chartEvents?this._contextMenuActionsForChartEvents(t):[]}_isReadOnly(){return this._chartWidget.readOnly()}_createActionHide(e){return new l.Action({label:he,icon:i(96136),statName:"HideSelectedObject",onExecute:this._chartWidget.hideDataSources.bind(this._chartWidget,[e])})}_createActionShow(e){const t=new l.Action({checkable:!0,label:de,icon:i(6162),statName:"ToggleShow"}),r=new c.ActionBinder(t,e.properties().visible,this._chartWidget.model(),de);return t.setBinding(r),r.setValue(e.properties().visible.value()),t}_createActionScale(e){const t=(0,r.ensureNotNull)(e.priceScale()),s=this._chartWidget.model().model(),n=(0,r.ensureNotNull)(s.paneForSource(e)),o=n.priceScalePosition(t),a=("left"===o?n.leftPriceScales():n.rightPriceScales()).indexOf(t),c=s.priceScaleSlotsCount().totallySlots<2?"dontneedname":"needname",d="overlay"===o?"":(0,u.getPriceAxisNameInfo)(o,a).label,h=$e.format({label:d}),p={"left-needname":h,"left-dontneedname":Je,"right-needname":h,"right-dontneedname":Ze,"overlay-needname":Ke,"overlay-dontneedname":Ke}[o+"-"+c];return new l.Action({label:p,icon:i(74553),subItems:this._createActionScaleItems(e)})}_createActionScaleDetach(e,t,i,s){const n=this._chartWidget.model().model(),o=(0,r.ensureNotNull)(n.paneForSource(e));if(!o.canCreateNewPriceScale())return null;const a=(0,r.ensureNotNull)(e.priceScale()),c=a.canDetachSource(e),d=o.priceScalePosition(a),h=c||d!==t;if(!h)return null;const p=n.priceScaleSlotsCount(),_={left:{labelled:Ue,sided:qe},right:{labelled:Ue,sided:Xe}},m="left"===t?o.leftPriceScales().length:o.rightPriceScales().length,f=p[t]>m?"labelled":"sided",g=(0,u.getPriceAxisNameInfo)(t,m).label,v=_[t][f].format({label:g});return new l.Action({checkable:!1,disabled:!h,label:v,statName:s,payload:e,onExecute:i})}_onDetachLeft(e){const t=e.getPayload(),i=this._chartWidget.model().model(),s=(0,r.ensureNotNull)(i.paneForSource(t));this._chartWidget.model().detachToLeft(t,s)}_onDetachRight(e){const t=e.getPayload(),i=this._chartWidget.model().model(),s=(0,r.ensureNotNull)(i.paneForSource(t));this._chartWidget.model().detachToRight(t,s)}_createActionScaleDetachLeft(e){return this._createActionScaleDetach(e,"left",this._onDetachLeft.bind(this),"ToggleScaleLeft")}_createActionScaleDetachRight(e){return this._createActionScaleDetach(e,"right",this._onDetachRight.bind(this),"ToggleScaleRight")}_onMoveToScale(e){const t=e.getPayload();if(t.datasource.priceScale()===t.priceScale)return;const i=this._chartWidget.model().model(),s=(0,r.ensureNotNull)(i.paneForSource(t.datasource));this._chartWidget.model().moveToScale(t.datasource,s,t.priceScale,t.undoText)}_createMoveToScaleAction(e,t,i,r){
const s=e.priceScale()===t;return new l.Action({checkable:!0,checked:s,label:i,statName:"ToggleScale",payload:{datasource:e,priceScale:t,undoText:r},onExecute:this._onMoveToScale.bind(this)})}_onNoScale(e){const t=e.getPayload().datasource,i=this._chartWidget.model().model(),s=(0,r.ensureNotNull)(i.paneForSource(t));s.isOverlay(t)||this._chartWidget.model().detachNoScale(t,s)}_createActionNoScale(e){const t=this._chartWidget.model().model(),i=(0,r.ensureNotNull)(t.paneForSource(e)),s=i.actionNoScaleIsEnabled(e);return new l.Action({checkable:!0,checked:i.isOverlay(e),label:Qe,disabled:!s,statName:"ToggleNoScale",payload:{datasource:e},onExecute:this._onNoScale.bind(this)})}_createActionScaleItems(e){const t=[],i=this._chartWidget.model().model(),s=(0,r.ensureNotNull)(i.paneForSource(e)),n=i.priceScaleSlotsCount().totallySlots>1,o=s.rightPriceScales(),a=s.leftPriceScales(),c=this._createActionScaleDetachRight(e),d=this._createActionScaleDetachLeft(e),h=o.length+a.length+(null===c?0:1)+(null===d?0:1)>2,p={right:{hidden:{checked:{labelled:Ne,sided:Oe},unchecked:{labelled:Ve,sided:Be}},visible:{checked:{labelled:Fe,sided:We},unchecked:{labelled:Ue,sided:He}}},left:{hidden:{checked:{labelled:Ne,sided:ze},unchecked:{labelled:Ve,sided:je}},visible:{checked:{labelled:Fe,sided:Ye},unchecked:{labelled:Ue,sided:Ge}}}},_={left:s.visibleLeftPriceScales(),right:s.visibleRightPriceScales()},m=(t,i)=>{const r=("right"===i?o:a)[t],s=_[i].includes(r)?"visible":"hidden",l=e.priceScale()===r?"checked":"unchecked",c=n?"labelled":"sided",d=p[i],h={labelled:d.visible.unchecked.labelled,sided:d.visible.unchecked.sided},m=(0,u.getPriceAxisNameInfo)(i,t).label;return{actionText:d[s][l][c].format({label:m}),undoText:h[c].format({label:m})}};t.push(...o.map((t,i)=>{const r=m(i,"right");return this._createMoveToScaleAction(e,t,r.actionText,r.undoText)})),null!==c&&t.push(c);h&&(o.length>0||null!==c)&&t.push(new l.Separator);t.push(...a.map((t,i)=>{const r=m(i,"left");return this._createMoveToScaleAction(e,t,r.actionText,r.undoText)})),null!==d&&t.push(d);h&&(a.length>0||null!==d)&&t.push(new l.Separator);return t.push(this._createActionNoScale(e)),t}_createVisualOrderAction(e){const t=this._chartWidget.model(),r=t.availableZOrderOperations(e),s=[new l.Action({label:nt,statName:"BringToFront",disabled:!r.bringToFrontEnabled,onExecute:()=>t.bringToFront(e)}),new l.Action({label:ot,statName:"SendToBack",disabled:!r.sendToBackEnabled,onExecute:()=>t.sendToBack(e)}),new l.Action({label:at,statName:"BringForward",disabled:!r.bringForwardEnabled,onExecute:()=>t.bringForward(e)}),new l.Action({label:lt,statName:"SendBackward",disabled:!r.sendBackwardEnabled,onExecute:()=>t.sendBackward(e)})];return new l.Action({label:ct,icon:i(63679),statName:"VisualOrder",subItems:s})}_createActionMergeUp(e){const t=this._chartWidget.model();return t.model().isMergeUpAvailableForSource(e)?new l.Action({label:tt,statName:"MergeUp",onExecute:()=>t.mergeSourceUp(e)}):null}_createActionUnmergeUp(e){const t=this._chartWidget.model()
;return t.model().isUnmergeAvailableForSource(e)?new l.Action({label:it,statName:"UnmergeUp",onExecute:()=>t.unmergeSourceUp(e)}):null}_createActionMergeDown(e){const t=this._chartWidget.model();return t.model().isMergeDownAvailableForSource(e)?new l.Action({label:rt,statName:"MergeDown",onExecute:()=>t.mergeSourceDown(e)}):null}_createActionUnmergeDown(e){const t=this._chartWidget.model();return t.model().isUnmergeAvailableForSource(e)?new l.Action({label:st,statName:"UnmergeDown",onExecute:()=>t.unmergeSourceDown(e)}):null}_mergeContentMenuItems(e){return[this._createActionMergeUp(e),this._createActionUnmergeUp(e),this._createActionMergeDown(e),this._createActionUnmergeDown(e)].filter(o.notNull)}_createActionMove(e){const t=this._mergeContentMenuItems(e);return t.length>0?new l.Action({label:et,icon:i(8916),subItems:t}):null}_contextMenuActionsForSeries(e){var t;const i=[],s=e.properties().childs().visible.value(),n=this._chartWidget.model().model(),o=(0,r.ensureNotNull)(n.paneForSource(e)),c=this._chartWidget.actions();if(this._isReadOnly())i.push(s?this._createActionHide(e):this._createActionShow(e)),i.push(new l.Separator),i.push(this._createActionScale(e));else{if(e.alertCreationAvailable()){const t=Vt(this._chartWidget,{series:e});null!==t&&i.push(t)}if(i.push(this._createActionAddChildStudy(e)),this._options.fundamentals){const t=this._createActionAddFundamentals(e);null!==t&&i.push(t)}if(this._options.mainSeriesTrade){const e=Ft(this._chartWidget);null!==e&&i.push(e)}i.length>0&&!(i[i.length-1]instanceof l.Separator)&&i.push(new l.Separator),a.enabled("symbol_info")&&i.push(c.showSymbolInfoDialog);const u=n.mainSeries().symbolInfo();c.showFinancials&&null!==u&&(0,R.hasMoreFinancialsButton)(u.type,u.typespecs)&&i.push(c.showFinancials),i.length>0&&!(i[i.length-1]instanceof l.Separator)&&i.push(new l.Separator),i.push(this._createVisualOrderAction([e]));const d=this._createActionMove(e);null!==d&&i.push(d),i.push(this._createActionScale(e)),i.push(s?this._createActionHide(e):this._createActionShow(e)),i.push(new l.Separator),i.push(Ht(this._chartWidget)),i.push(new l.Separator);Boolean(null===(t=window.widgetbar)||void 0===t?void 0:t.widget("watchlist"))&&c.addToWatchlist&&i.push(c.addToWatchlist),a.enabled("text_notes")&&i.push(c.addToTextNotes),i[i.length-1]instanceof l.Separator||i.push(new l.Separator),window.pro&&window.pro.hasPackage("mtp-mtpredictor")&&i.push((0,r.ensureNotNull)(Ut(this._chartWidget,o)),new l.Separator),a.enabled("show_chart_property_page")&&!this._chartWidget.onWidget()&&i.push(c.mainSeriesPropertiesAction),i[i.length-1]instanceof l.Separator&&i.pop()}return i}_createActionAddChildStudy(e){const t=this._chartWidget.model().model();return new l.Action({label:dt.format({studyTitle:Ot(e)}),icon:i(61084),statName:"ApplyIndicator",onExecute:()=>{const i=this._chartWidget.showIndicators((0,d.isStudy)(e)?e:void 0);if(i&&(0,d.isStudy)(e)){const e=()=>{(0,p.trackEvent)("SOS","Apply SOS","Apply by RC menu")},r=t.studyInserted();r.subscribe(this,e),i.visible().subscribe(t=>{
t||r.unsubscribe(this,e)},{once:!0})}}})}_createActionAddFundamentals(e){{const t=e.symbolInfo();return null===t||"forex"===t.type||"crypto"===t.type||"bitcoin"===t.type?null:new l.Action({label:ht.format({instrumentName:Ot(e)}),icon:i(70707),statName:"ApplyFundamental",onExecute:()=>{this._chartWidget.showFundamentals(e!==this._chartWidget.model().mainSeries()?e:void 0)}})}}_createActionShowSymbolInfoDialog(e,t){return new l.Action({label:(0,K.appendEllipsis)((0,J.t)("Symbol Info")),icon:i(51264),checkable:!1,statName:"SymbolInfo",onExecute:()=>{const i=e.symbol(),r={symbolInfo:e.symbolInfo(),unitName:e=>t.name(e)};(0,G.showSymbolInfoDialog)(i,r)}})}_createActionShowProperties(e){return new l.Action({label:pt,icon:i(99673),statName:"EditSelectedObject",onExecute:()=>this._chartWidget.showSourceProperties(e)})}_contextMenuActionsForStudy(e){const t=this._chartWidget.actions(),i=e.properties().visible.value(),r=[];if(!e.userEditEnabled())return r;if(this._chartWidget.readOnly())r.push(i?this._createActionHide(e):this._createActionShow(e)),r.push(new l.Separator),e.constructor instanceof f.NonSeriesStudy||r.push(this._createActionScale(e));else{if(e.alertCreationAvailable()){const t=Vt(this._chartWidget,{series:e});null!==t&&r.push(t)}if(a.enabled("study_on_study")&&e.canHaveChildren()&&r.push(this._createActionAddChildStudy(e)),(e instanceof Y.StudyCompare||e instanceof j.study_Overlay)&&this._options.fundamentals){const t=this._createActionAddFundamentals(e);null!==t&&r.push(t)}const s=this._createApplyToEntireLayoutCommand(e);if(null!==s&&r.push(s),r.length>0&&!(r[r.length-1]instanceof l.Separator)&&r.push(new l.Separator),a.enabled("symbol_info")&&(e instanceof Y.StudyCompare||e instanceof j.study_Overlay)&&null!==e.symbolInfo()&&(r.push(this._createActionShowSymbolInfoDialog(e,this._chartWidget.model().model().availableUnits())),r.push(new l.Separator)),r.push(this._createVisualOrderAction([e])),!(e.constructor instanceof f.NonSeriesStudy)){const t=this._createActionMove(e);null!==t&&r.push(t),r.push(this._createActionScale(e))}r.push(new l.Separator);const n=e.metaInfo();if(!(0,d.isFundamentalStudy)(e)&&n.pine&&t.viewSourceCode&&(r.push(t.viewSourceCode),r.push(new l.Separator),t.viewSourceCode.update({disabled:!1}),(0,P.isAuthToGetPineSourceCode)(n.scriptIdPart,n.pine.version).done(e=>{e||t.viewSourceCode.update({disabled:!0})}).fail(e=>{te.logError("Failed isAuthToGetPineSourceCode, reason: "+e)})),e.copiable()){const t=new l.Action({label:ft,shortcutHint:(0,H.humanReadableHash)(H.Modifiers.Mod+67),statName:"Copy",onExecute:()=>{this._chartWidget.chartWidgetCollection().clipboard.uiRequestCopy([e])}});r.push(t)}r.push(i?this._createActionHide(e):this._createActionShow(e)),r.push(t.studyRemove),this._chartWidget.onWidget()||(r.push(new l.Separator),this._options.objectTree&&t.paneObjectTree&&r.push(t.paneObjectTree)),r.push(new l.Separator),a.enabled("property_pages")&&new g.MetaInfoHelper(n).hasUserEditableOptions()&&r.push(this._createActionShowProperties(e)),r[r.length-1]instanceof l.Separator&&r.pop()}
return r}_createEditAlertDrawingAction(e){return new l.Action({label:ne.format({title:e.title()}),icon:E,statName:"EditAlert",onExecute:()=>{window.runOrSignIn(()=>{e.editAlert("pane_context_menu_edit_alert")},{source:"Alert edit from pane context menu"})}})}_createLineToolTemplateAction(e){{const t=this._chartWidget.model(),r=i=>{t.applyLineToolTemplate(e,i,"Apply Drawing Template")};return new l.ActionAsync(async()=>{const{LinetoolTemplatesList:s}=await Promise.all([i.e(38676),i.e(59963),i.e(11008),i.e(69458),i.e(3177)]).then(i.bind(i,69458)),n=new s(e.toolname,r),o=[],a=new l.Action({label:mt,statName:"SaveAs",onExecute:()=>{n.showSaveDialog(t=>{const i=JSON.stringify(e.template());n.saveTemplate(t,i)})}});o.push(a);const c=new l.Action({label:_t,statName:"ApplyDefault",onExecute:()=>{t.restorePropertiesForSource(e),window.lineToolPropertiesToolbar.onSourceChanged(e)}});return o.push(c),new Promise(e=>{n.templatesLoaded().then(()=>{var e;const t=null!==(e=n.getData())&&void 0!==e?e:[];t.length>0&&o.push(new l.Separator),t.forEach((e,t)=>{const i=new l.Action({label:e,statName:"ApplyTemplate",onExecute:()=>n.loadTemplate(e),toolbox:{type:z.ToolboxType.Delete,action:()=>{n.deleteAction(e)}},showToolboxOnHover:!0});o.push(i)})},e=>{te.logWarn(e)}).then(()=>{e({label:vt,statName:"Template",subItems:o})})})})}}_createActionToggleLockLineTools(e){const t=e[0].properties().frozen.value(),r=t?yt:bt;return new l.Action({label:r,statName:"ToggleLockSelectedObject",checkable:!0,icon:i(t?51146:4821),onExecute:()=>{if(1===e.length)this._chartWidget.toggleLockSelectedObject();else{const i=`${r} ${wt}`,s=this._chartWidget.model();s.withMacro(i,()=>{e.forEach(e=>{s.setProperty(e.properties().frozen,!t,i)})})}}})}async _contextMenuActionsForLineTool(e){const t=[],s=this._chartWidget.actions(),c=this._chartWidget.model().model(),u=()=>{t.push(this._createVisualOrderAction(e))},d=()=>{const r=e.filter(e=>e.cloneable());if(r.length>0){const e=new l.Action({label:gt,icon:i(35961),shortcutHint:(0,H.humanReadableModifiers)(H.Modifiers.Mod)+"Drag",statName:"Clone",onExecute:()=>this._chartWidget.model().cloneLineTools(r,!1)},"Clone");t.push(e)}return!!r.length},h=()=>{const i=e.filter(e=>e.copiable());if(i.length>0){const e=new l.Action({label:ft,shortcutHint:(0,H.humanReadableHash)(H.Modifiers.Mod+67),statName:"Copy",onExecute:()=>this._chartWidget.chartWidgetCollection().clipboard.uiRequestCopy(i)},"Copy");t.push(e)}return!!i.length},p=()=>{const i=zt(this._chartWidget,e);return t.push(...i),i.length>0},_=async e=>{const i=e.getOrderTemplate();if(null===i)return;const s=(0,v.tradingService)();if(null!==s){const e=s.activeBroker();if(e&&1===e.connectionStatus()&&e.metainfo().configFlags.supportLimitOrders){const s=c.mainSeries();i.symbol=s.proSymbol();if((await e.isTradable(i.symbol)).tradable){const{qty:{step:s}}=await e.symbolInfo(i.symbol);i.qty=function(e,t){return Number((0,n.Big)(e).div(t).round(void 0,0).mul(t))}(i.qty,s),t.push(new l.Separator),t.push(function(e){const t=(0,r.ensureNotNull)((0,v.tradingService)())
;return new l.Action({label:ue,statName:"CreateLimitOrder",onExecute:()=>{t.trackEvent("Chart Context Menu","RiskRewardCreateLimitOrder"),(0,r.ensureNotNull)(t.brokerCommandsUI()).placeOrder(e)}})}(i))}}else null===e&&(t.push(new l.Separator),t.push((0,r.ensureNotNull)(Wt())))}},m=e=>{const i=new l.Action({label:St.format({lineToolName:e.title()}),statName:"GoToLineTool",checkable:!1,onExecute:async()=>{const t=c.timeScale().logicalRange();if(null===t)return;const i=this._chartWidget.model(),s=c.timeScale().barSpacing();let n=t.left();const a=e.points().map(e=>e.index);let l=c.timeScale().points().firstIndex();const u=c.timeScale().points().lastIndex();if(null===l||null===u)return;const d=t.length()/2;if(0===a.length||a.some(e=>t.contains(e)))return;const h=()=>{const t=e.points().map(e=>e.index),i=t.filter(e=>e<=u).reduce((e,t)=>null===e?t:Math.max(e,t),null);return null!==i?i:t.reduce((e,t)=>Math.min(e,t))};let p,_=h();if(l-d>_){const t=e.points().map(e=>e.time).filter(o.notUndefined).map(e=>e.valueOf()/1e3);if(0===t.length)return;const i=t.reduce((e,t)=>Math.min(e,t),t[0]);await c.gotoTime(i),_=h();n=(0,r.ensureNotNull)(c.timeScale().logicalRange()).left(),l=(0,r.ensureNotNull)(c.timeScale().points().firstIndex())}l-d>_?(p=(n-l+d)*s,c.mainSeries().setGotoDateResult({timestamp:(0,r.ensureNotNull)(c.timeScale().points().valueAt(l)),eod:!0})):p=(n-_+1+d)*s,i.startScrollTime(0),(0,Z.doAnimate)({onStep:(e,t)=>i.scrollTimeTo(t),from:0,to:Math.round(p),easing:Q.easingFunc.easeInOutCubic,duration:Q.dur,onComplete:()=>i.endScrollTime()})}});t.push(i)},f=e=>{const t=this._chartWidget.model().model().lineToolsGroupModel(),i=e.map(e=>t.groupForLineTool(e));return new Set(i).size<=1};if(1===e.length){const i=e[0];if(this._chartWidget.readOnly())t.push(s.lineHide);else if(i.userEditEnabled()){if(a.enabled("alerts")&&!this._chartWidget.onWidget())if(i.hasAlert&&i.hasAlert.value())t.push(this._createEditAlertDrawingAction(i)),t.push(new l.Separator);else if(i.canHasAlert()){const e=Vt(this._chartWidget,{drawing:i});null!==e&&(t.push(e),t.push(new l.Separator))}{const e=this._createLineToolTemplateAction(i);null!==e&&t.push(e)}u(),this._options.objectTree&&s.paneObjectTree&&t.push(s.paneObjectTree),await _(i),t.push(new l.Separator);let e=d();e=h()||e,e=p()||e,e&&t.push(new l.Separator),t.push(this._createActionToggleLockLineTools([i])),t.push(s.lineHide),t.push(s.lineRemove),i.points().length>0&&this._options.gotoLineTool&&(t.push(new l.Separator),m(i));const r=await this._chartWidget.propertiesDefinitionsForSource(i);if(a.enabled("property_pages")&&null!==r&&(t.push(new l.Separator),t.push(s.format)),i.additionalActions){t.push(new l.Separator);const e=i.additionalActions(this._chartWidget.model());t.push(...e)}}}else this._options.objectTree&&s.paneObjectTree&&t.push(s.paneObjectTree),f(e)&&u(),t.length>0&&t.push(new l.Separator),d(),h(),p(),t.push(new l.Separator),t.push(this._createActionToggleLockLineTools(e)),t.push(s.lineHide),t.push(s.lineRemove),a.enabled("property_pages")&&(t.push(new l.Separator),t.push(s.format))
;return t}_createEarningsShow(){const e=this._chartWidget.model().mainSeries().properties().childs().esdShowEarnings;return new l.Action({label:Pt,checkable:!0,checked:e.value(),name:"ToggleShowEarnings",statName:"ToggleShowEarnings",onExecute:t=>this._chartWidget.model().setProperty(e,t.isChecked(),Pt)})}_createDividendsShow(){const e=this._chartWidget.model().mainSeries().properties().childs().esdShowDividends;return new l.Action({label:Ct,checkable:!0,checked:e.value(),name:"ToggleShowDividends",statName:"ToggleShowDividends",onExecute:t=>this._chartWidget.model().setProperty(e,t.isChecked(),Ct)})}_createSplitsShow(){const e=this._chartWidget.model().mainSeries().properties().childs().esdShowSplits;return new l.Action({checkable:!0,label:Tt,checked:e.value(),name:"ToggleShowSplits",statName:"ToggleShowSplits",onExecute:t=>this._chartWidget.model().setProperty(e,t.isChecked(),Tt)})}_contextMenuActionsForESD(){const e=[];return this._chartWidget.readOnly()||e.push((0,r.ensureNotNull)(this._createDividendsShow()),(0,r.ensureNotNull)(this._createSplitsShow()),(0,r.ensureNotNull)(this._createEarningsShow())),e}_contextMenuActionsForPublishedTimeline(e){const t=this._chartWidget.actions(),i=[];if(i.push(t.lineHide),window.is_authenticated){const t=e.properties().childs().filter,r=new l.Action({checked:t.value()===T.PublishedChartsFilter.None,checkable:!0,label:xt,name:"ToggleAllIdeas",statName:"ToggleAllIdeas",onExecute:()=>this._chartWidget.model().setProperty(t,T.PublishedChartsFilter.None,xt)}),s=new l.Action({checked:t.value()===T.PublishedChartsFilter.Following,checkable:!0,label:It,name:"ToggleIdeasOfPeopleAndUser",statName:"ToggleIdeasOfPeopleAndUser",onExecute:()=>this._chartWidget.model().setProperty(t,T.PublishedChartsFilter.Following,It)}),n=new l.Action({checked:t.value()===T.PublishedChartsFilter.Private,checkable:!0,label:Lt,name:"ToggleUserIdeas",statName:"ToggleUserIdeas",onExecute:()=>this._chartWidget.model().setProperty(t,T.PublishedChartsFilter.Private,Lt)});i.push(new l.Separator,r,s,n)}return i}_contextMenuActionsForTradingDrawings(e){return e.contextMenuItems()}_createAlertToggleHorzLineLabelAction(e){const t=(0,_.getSettingsProperty)().childs().line.childs().visible,i=t.value()?le:ae;return new l.Action({checkable:!0,label:oe,checked:t.value(),statName:"ToggleExtendAlertLine",onExecute:()=>this._chartWidget.model().setProperty(t,!t.value(),i)})}_contextMenuActionsForAlertLabel(e){const t=e.alert(),i=[];return t.get("active")?i.push(w.ActionCreators.stopAlert(t)):i.push(w.ActionCreators.restartAlert(t,"alert_label_context_menu_restart")),i.push(w.ActionCreators.editAlert(t,"alert_label_context_menu_edit")),i.push(w.ActionCreators.deleteAlert(t)),i.push(new l.Separator),i.push(this._createAlertToggleHorzLineLabelAction(e)),i}_contextMenuActionsForChartEvents(e){const t=[];if(a.enabled("property_pages")){const e=new l.Action({label:Mt,statName:"Format",onExecute:()=>this._chartWidget.showGeneralChartProperties(h.TabNames.eventsAndAlerts)});t.push(e)}const i=new l.Action({label:Et,name:"HideEvents",
statName:"HideEvents",onExecute:()=>this._chartWidget.model().setProperty(e.properties().childs().visible,!1,Et)});return t.push(i),t}_createApplyToEntireLayoutCommand(e){if(!this._chartWidget.chartWidgetCollection().applyIndicatorsToAllChartsAvailable())return null;const t=this._chartWidget.model().model();if(e.parentSource()!==t.mainSeries())return null;const i=(0,r.ensureNotNull)(t.paneForSource(e)),s=t.paneForSource(t.mainSeries())===i,n=e instanceof Y.StudyCompare&&e.priceScale()===t.mainSeries().priceScale()&&(0,r.ensureNotNull)(e.priceScale()).isPercentage(),o=s?void 0:t.panes().indexOf(i);let a=kt,c="AddStudyToEntireLayout";return(0,$.isSymbolSource)(e)&&(a=At,c="AddSymbolToEntireLayout"),e instanceof k.StudyStrategy&&(a=Dt,c="AddStrategyToEntireLayout"),e instanceof D.Fundamental&&(a=Rt,c="AddFundamentalToEntireLayout"),new l.Action({label:a,statName:c,onExecute:()=>{const i=(0,r.ensureNotNull)((0,q.clipboardDataForSources)(t.id(),[e])),l=this._chartWidget.chartWidgetCollection(),c={isOnMainPane:s,asCompare:n,paneIndex:o};l.applyIndicatorToAllCharts(this._chartWidget,i,c,a)}},"applyStudyToEntireLayout")}}},98562:(e,t,i)=>{"use strict";var r;i.d(t,{AlertEditorAbortReason:()=>r}),function(e){e.AlertIsInvalid="alert-is-invalid",e.AlertsMaintenance="alerts-maintenance",e.ChartModelNotFound="chart-model-not-found",e.IsAlreadyPresent="is-already-present",e.MainSeriesIsATR="main-series-is-atr",e.MainSeriesIsInReplay="main-series-is-in-replay",e.MainSeriesIsOffline="main-series-is-offline",e.SourceIsDangerous="source-is-dangerous",e.SymbolInfoTimeout="symbol-info-timeout",e.SymbolIsInvalid="symbol-is-invalid",e.SymbolIsConverted="symbol-is-converted",e.UnsupportedResolution="unsupported-resolution",e.ManualAbort="manual-abort",e.MisleadingPriceScale="misleading-price-scale"}(r||(r={}))},11132:(e,t,i)=>{"use strict";i.d(t,{getAlertDialogType:()=>h,shouldAbortAlertEditor:()=>p,showAbortExplainingDialog:()=>m,ensureSeriesIsNotOffline:()=>g});var r=i(20220),s=i(79407),n=i(98562),o=i(97786),a=i(52946),l=i(17476),c=i(36989),u=i(79200),d=i(18771);function h(e){return e.alert?e.type||"edit_alert":"create_alert"}function p(e){var t;if(d.alertsMaintenanceTracker.value())return n.AlertEditorAbortReason.AlertsMaintenance;if(!e.alert&&!e.dataSourceHub)return n.AlertEditorAbortReason.ChartModelNotFound;if(!l.alertEditorInvocationHandler.isAllowedToInvoke(e))return n.AlertEditorAbortReason.IsAlreadyPresent;const i=null===(t=e.dataSourceHub)||void 0===t?void 0:t.mainSeries();if(i&&_(i))return n.AlertEditorAbortReason.MainSeriesIsOffline;if(i&&function(e){return e.status()===o.STATUS_INVALID_SYMBOL}(i))return n.AlertEditorAbortReason.SymbolIsInvalid;if(i&&(i.isConvertedToOtherCurrency()||i.isConvertedToOtherUnit()))return n.AlertEditorAbortReason.SymbolIsConverted;const r=h(e);if("create_alert"===r&&i&&function(e){var t;return"ATR"===(null===(t=e.stateForAlert().styleInputs)||void 0===t?void 0:t.style)}(i))return n.AlertEditorAbortReason.MainSeriesIsATR;if("create_alert"===r&&i&&function(e){return e.isInReplay()
}(i))return n.AlertEditorAbortReason.MainSeriesIsInReplay;const s=i?i.interval():a.linking.interval.value();return"create_alert"!==r||(0,c.canPlaceAlertOnResolution)(s)?null:n.AlertEditorAbortReason.UnsupportedResolution}function _(e){return e.status()===o.STATUS_OFFLINE}function m(e,t){if(f.has(e))return;f.add(e);const i=()=>f.delete(e),o=function(e){return new Map([[n.AlertEditorAbortReason.UnsupportedResolution,"alertsOnSeconds"]]).get(e)||null}(e);if(o)return void(0,u.reloginOrGoPro)({feature:o,actionAfterClose:i});const a=function(e,t){const i=r.t("Oops!"),s=r.t("Alert editor could not be initialized"),o=r.t("Ok");return new Map([[n.AlertEditorAbortReason.AlertsMaintenance,{title:r.t("Alerts maintenance"),text:r.t("We are doing some brief daily maintenance. Alerts will be back really soon, thanks for your patience!"),buttonText:o}],[n.AlertEditorAbortReason.MainSeriesIsOffline,{title:i,text:("create_alert"===t?r.t("Cannot create an alert while offline"):r.t("Cannot edit an alert while offline"))+". "+r.t("Please check your internet connection")+".",buttonText:o}],[n.AlertEditorAbortReason.SymbolIsInvalid,{title:i,text:"create_alert"===t?r.t("Can't create alert on invalid symbol"):r.t("Can't edit alert on invalid symbol"),buttonText:o}],[n.AlertEditorAbortReason.SymbolIsConverted,{title:r.t("Oops – Converted Currency!"),text:"create_alert"===t?r.t("It's not currently possible to create alerts on a converted currency symbol."):r.t("It's not currently possible to edit alerts on a converted currency symbol."),buttonText:r.t("Got it")}],[n.AlertEditorAbortReason.MainSeriesIsATR,{title:r.t("Alert cannot be set on an ATR-based chart"),text:r.t("Your alert won't trigger the way you expect it to! Inputs for ATR-based charts are recalculated each time you open a chart and are generally dependent on time. Please use the traditional chart type to set an alert with a static box size."),buttonText:o}],[n.AlertEditorAbortReason.MainSeriesIsInReplay,{title:r.t("Oops – Replay Mode!"),text:r.t("Alerts are not currently available in replay mode."),buttonText:r.t("Got it")}]]).get(e)||{title:i,text:s,buttonText:o}}(e,t);(0,s.showWarning)({...a,onClose:i})}const f=new Set;function g(e){return new Promise(t=>{if(!_(e))return void t();const i=()=>{_(e)||(e.onStatusChanged().unsubscribe(null,i),t())};e.onStatusChanged().subscribe(null,i)})}},59958:(e,t,i)=>{"use strict";i.d(t,{invokeAlertEditor:()=>d,invokeAlertEditorWithOnlineSeries:()=>p});var r=i(11132),s=i(82324),n=i(98562),o=i(20552),a=i(87380),l=i(17476),c=i(18771);const u=(0,a.getLogger)("Alerts.Price.InvokeAlertEditor");function d(e){c.alertsMaintenanceTracker.sync();const t=(0,r.shouldAbortAlertEditor)(e);if(null!==t)return t!==n.AlertEditorAbortReason.IsAlreadyPresent&&(0,r.showAbortExplainingDialog)(t,(0,r.getAlertDialogType)(e)),u.logWarn("Aborted: "+t),void(e.onAborted&&e.onAborted(t));const{unlockInvocation:o,abortSignal:a}=l.alertEditorInvocationHandler.lockInvocation(e)
;Promise.all([Promise.all([i.e(32637),i.e(14563),i.e(73715),i.e(34698),i.e(4033),i.e(68981),i.e(45623),i.e(41242),i.e(19453),i.e(93669),i.e(84101),i.e(84234),i.e(18319),i.e(81627),i.e(4982),i.e(18555),i.e(87048),i.e(43887),i.e(35829),i.e(28022),i.e(35683),i.e(60273)]).then(i.t.bind(i,23931,19)),(0,s.getPriceAlertsDispatcher)(),h(e,o,a)]).then(e=>{const[t,i,r]=e;new t.AlertEditor(i,r)},o)}function h(e,t,i){return(e.series?(0,o.hasUserAccessToDataSource)(e.series):Promise.resolve(!0)).then(r=>{const s=e.onDestroy,n={...e,abortSignal:i,onDestroy:()=>{t(),s&&s()}};return r||(delete n.series,delete n.value),n})}function p(e){e.dataSourceHub?(0,r.ensureSeriesIsNotOffline)(e.dataSourceHub.mainSeries()).then(()=>{d(e)}):d(e)}},49992:(e,t,i)=>{"use strict";i.d(t,{clipboardDataForSources:()=>o});var r=i(16282),s=i(55304),n=i(87048);function o(e,t){if(1===t.length&&(0,s.isStudy)(t[0])){const e=t[0];return{title:e.title(),sources:[{source:(0,r.ensureNotNull)(e.state()),type:"study"}]}}const i={sources:[],title:""};return i.sources=t.filter(e=>e.copiable()&&(0,n.isLineTool)(e)).map(t=>{const i={type:"drawing",geometry:t.geometry(),source:{...t.state(!1),points:t.normalizedPoints()},modelId:e};return delete i.source.alertId,i}),i.sources.length>0?(1===i.sources.length?i.title=t[0].title&&t[0].title():i.title="Drawings",i):null}},89537:(e,t,i)=>{"use strict";i.d(t,{AvailableOnTVPopup:()=>a});var r=i(20220),s=(i(68421),i(88674)),n=i(38140);const o=(0,r.t)("This symbol is only available on {linkStart}TradingView{linkEnd}.");class a{constructor(e){this._lastResolvedSymbol=null,this._chart=e,this._chart.withModel(this,this._connectToModel)}show(){const e=this._getSymbol(),t=this._chart.defaultSymbol(),[i,r]=e.split(":"),a="https://www.tradingview.com{0}?utm_source=www.tradingview.com&utm_medium=widget&utm_campaign=chart&utm_term={2}:{1}".format((0,n.getSymbolPagePath)({proName:this._getProSymbol()}),r,i);(0,s.createNoticeDialog)({content:o.format({linkStart:`<a target="_blank" href="${a}">`,linkEnd:"</a>"})}).then(i=>{i.on("destroy",()=>{let i;i=this._lastResolvedSymbol?this._lastResolvedSymbol:t!==e?t:"AAPL",this._chart.setSymbol(i)}),i.open()})}_getProSymbol(){return this._chart.model().mainSeries().proSymbol()}_getSymbol(){return this._chart.model().mainSeries().actualSymbol()}_connectToModel(){const e=this._chart.model().mainSeries();e.dataEvents().symbolResolved().subscribe(this,this._onSymbolResolved),e.dataEvents().symbolGroupNotPermitted().subscribe(this,this._onSymbolGroupNotPermitted),e.dataEvents().symbolNotPermitted().subscribe(this,this.show)}_onSymbolResolved(){this._lastResolvedSymbol=this._getSymbol()}_onSymbolGroupNotPermitted(){this.show()}}},24940:(e,t,i)=>{"use strict";i.d(t,{axesHighlightColor:()=>s});var r=i(93669);const s=(0,i(50946).generateColor)(r.colorsPalette["color-tv-blue-500"],75)},79024:(e,t,i)=>{"use strict";i.d(t,{addBrandingSource:()=>z})
;var r=i(99479),s=i(72927),n=i(71044),o=i(93669),a=i(16282),l=i(20220),c=i(22842),u=i(91513),d=i(62288),h=i(71928),p=i(50946),_=i(68450),m=i(64348),f=i(14900),g=i(94211),v=i(38140),S=i(43080),y=i(61697),b=i(39304),w=i(54567);i(8325);const P="Ch{0}ar{1}t{2}by{3}{4}".format("",""," "," ","TradingView"),C="po{0}wer{1}ed{2}by{3}{4}".format("",""," "," ","TradingView"),T=("by{3}{4}".format("",""," "," ","TradingView"),C),x=navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&-1===navigator.userAgent.toLowerCase().indexOf("edge"),I=window.urlParams||{},L=window.initData||{};(I.referral_id||I.no_referral_id)&&(0,g.enable)(I.referral_id||"","aggressive");const M=(0,l.t)("By TradingView"),E=(0,l.t)("{symbol} financials by TradingView"),A=(0,l.t)("More features on tradingview.com"),k=(0,l.t)("powered by")+" ";(0,l.t)(P),(0,l.t)(T);function D(e){return"px EuclidCircular"===e?.1:0}class R extends u.CustomSourceBase{constructor(e,t,i,s){super(e,t),this._canvasWidth=0,this._paneHeight=0,this._left=13,this._bottom=16,this._layout="site_branding",this._needToShow=!0,this._showBranding=!1,this._customLogoSrc="",this._customLogoLink="",this._cubicBezier=new h.CubicBezier(.4,.01,.22,1),this._openAnimation=null,this._closeAnimation=null,this._powBy=null,this._custom=null,this._mainSeries=this._model.mainSeries(),this._showAllowance=i,this._showForPro=Boolean(s),this._checkLayout(),"widget_custom_branding"!==this._layout&&"fundamental_custom_branding"!==this._layout||(this._left=8,this._bottom=5);const n=()=>{this._needToShow?this._showBranding=!0:this._showBranding=!1};this._resizeHandlerDelayed=(0,r.default)(n,200),n(),window.addEventListener("resize",this._resizeHandlerDelayed),this._monitorCanvas=(0,f.createDisconnectedBoundCanvas)(document,new f.Size(0,0)),this._monitorCanvas.subscribeCanvasConfigured(()=>{this._init()}),this._model.isSnapshot()?this._init():(this._mainSeries.dataEvents().symbolResolved().subscribe(this,this._init),null!==this._mainSeries.symbolInfo()&&this._init()),this._renderer={draw:this.draw.bind(this),hitTest:this.hitTest.bind(this)}}destroy(){window.removeEventListener("resize",this._resizeHandlerDelayed),this._mainSeries.dataEvents().symbolResolved().unsubscribeAll(this),this._powBy&&this._powBy.destroy()}paneViews(e){if(window.TradingView.printing)return[];if(!this._showAllowance())return[];if("site_branding"===this._layout&&!this._showForPro&&window.user&&window.user.is_pro)return[];const t=c.enabled("move_logo_to_main_pane");return t&&e.isMainPane()||!t&&e.isLast()||e.isMaximized()?[{renderer:this.renderer.bind(this)}]:[]}labelPaneViews(e){return[]}priceAxisViews(e,t){return[]}updateAllViews(){}updateViewsForPane(e){}priceScale(){return null}renderer(e,t){return this._paneHeight=e,this._canvasWidth=t,this._renderer}hasContextMenu(){return!1}onClickOutside(){this._hasAnimation()&&this._startCloseAnimation()}hitTest(e){
return!this._showBranding||c.enabled("logo_without_link")?null:this._powBy&&"widget_custom_no_powered_branding"!==this._layout&&"fundamental_custom_no_powered_branding"!==this._layout&&(this._powBy.hitTest(e)||this._custom&&this._custom.hitTest(e))?new d.HitTestResult(d.HitTestResult.CUSTOM,{hideCrosshairLinesOnHover:!0,clickHandler:()=>{this._openLink()},tapHandler:()=>{this._hasAnimation()?this._toggleOpenAnimatedOrOpenLink():this._openLink()},mouseEnterHandler:()=>{this._hasAnimation()&&this._startOpenAnimation()},mouseLeaveHandler:()=>{this._hasAnimation()&&this._startCloseAnimation()}}):null}tvUrl(){var e;let t=new URL("https://www.tradingview.com/");{const i=(null===(e=this._mainSeries.symbolInfo())||void 0===e?void 0:e.pro_name)||"";if(c.enabled("referral_program_for_widget_owners")){const e=(0,g.referenceToTradingView)(),r=e.indexOf("utm_source");return-1!==r&&(t=new URL(e.slice(0,r))),t.searchParams.append("utm_source",I.utm_source||""),t.searchParams.append("utm_medium",I.utm_medium||""),t.searchParams.append("utm_campaign",I.utm_campaign||""),t.searchParams.append("utm_term",i),t.toString()}const r=this._mainSeries.symbolInfo(),s=(null==r?void 0:r.name)||"APPL",n=(null==r?void 0:r.listed_exchange)||"";if(!L.customer&&s){const e=(0,v.getSymbolPagePath)({shortName:s,exchange:n});t=new URL(t.toString().replace(/\/$/,"")+e)}t.searchParams.append("utm_source",I.utm_source||""),t.searchParams.append("utm_medium",I.utm_medium||""),t.searchParams.append("utm_campaign",I.utm_campaign||""),t.searchParams.append("utm_term",i)}return t.toString()}draw(e,t){if(!this._showBranding)return;let i=0;I.utm=!0,(0,f.drawScaled)(e,t.pixelRatio,()=>{this._powBy&&this._powBy.show&&(i=this._powBy.height,e.save(),e.translate(this._left,this._paneHeight-this._bottom-i),this._powBy.draw(e,t,this._canvasWidth),e.restore()),this._custom&&this._custom.show&&(e.save(),e.translate(this._left,this._paneHeight-this._bottom-i-this._custom.height),this._custom.draw(e,t),e.restore())})}_init(){const e=this._mainSeries.symbolInfo();this._powBy&&this._powBy.destroy(),this._powBy=new U(this._layout,(null==e?void 0:e.name)||"",this._model,()=>this._model.fullUpdate()),this._custom=new H(this._layout,this._customLogoSrc,()=>this._model.fullUpdate()),this._openAnimation=null,this._closeAnimation=null}_checkLayout(){if(c.enabled("widget")){const e=L.logo||{},t=c.enabled("fundamental_widget");this._needToShow=!(L.whitelabel||I.whitelabel||e.whitelabel),e.image?(this._customLogoSrc="/static/images/widget-embed-logo/"+e.image,e.no_powered_by?this._layout=t?"fundamental_custom_no_powered_branding":"widget_custom_no_powered_branding":this._layout=t?"fundamental_custom_branding":"widget_custom_branding"):I.referral_id||I.no_referral_id?this._layout="widget_referral_branding":this._layout=t?"fundamental_branding":"widget_branding"}else if(c.enabled("charting_library")||c.enabled("trading_terminal")){const e=JSON.parse(I.logo)||{};e.image?(this._customLogoSrc=e.image,this._customLogoLink=e.link,this._needToShow=c.enabled("widget_logo"),
c.enabled("link_to_tradingview")?this._layout="library_custom_branding":this._layout="library_custom_no_powered_branding"):(this._layout="library_branding",this._needToShow=c.enabled("widget_logo"))}else this._layout="site_branding"}_startOpenAnimation(){null===this._openAnimation&&(null!==this._closeAnimation&&(this._closeAnimation.stop(),this._closeAnimation=null),this._openAnimation=(0,_.doAnimate)({from:this._currentStateForAnimation(),to:this._openedStateForAnimation(),duration:200,easing:this._cubicBezier.easingFunc,onStep:this._animatedDrawStep.bind(this)}))}_startCloseAnimation(){null===this._closeAnimation&&(null!==this._openAnimation&&(this._openAnimation.stop(),this._openAnimation=null),this._closeAnimation=(0,_.doAnimate)({from:this._currentStateForAnimation(),to:this._closedStateForAnimation(),duration:200,easing:this._cubicBezier.easingFunc,onStep:this._animatedDrawStep.bind(this)}))}_currentStateForAnimation(){return(0,a.ensureNotNull)(this._powBy).width}_closedStateForAnimation(){return(0,a.ensureNotNull)(this._powBy).minimizedAnimationWidth()}_openedStateForAnimation(){return(0,a.ensureNotNull)(this._powBy).maximizedAnimationWidth()}_animatedDrawStep(e,t){(0,a.ensureNotNull)(this._powBy).animatedDrawStep(e,t),this._model.lightUpdate()}_hasAnimation(){return null!==this._powBy&&this._powBy.hasAnimation()}_openLink(){if("site_branding"===this._layout)return!1;c.enabled("widget")&&(0,S.sendWidgetTrackData)(this.tvUrl(),"copyright");return(0,a.ensureNotNull)(window.open(this.tvUrl(),"_blank")).opener=null,!0}_toggleOpenAnimatedOrOpenLink(){null!==this._openAnimation&&this._openAnimation.completed()?this._openLink()||this._startCloseAnimation():this._startOpenAnimation()}}const N={customBrandingTradingViewText:o.colorsPalette["color-brand"],customBrandingText:o.colorsPalette["color-cold-gray-850"],background:o.colorsPalette["color-cold-gray-900"],shadow:(0,p.generateColor)(o.colorsPalette["color-white"],91),text:o.colorsPalette["color-white"],staticTextBackground:(0,p.generateColor)(o.colorsPalette["color-cold-gray-800"],20),logo:o.colorsPalette["color-white"]},O={customBrandingTradingViewText:o.colorsPalette["color-brand"],customBrandingText:o.colorsPalette["color-cold-gray-850"],background:o.colorsPalette["color-white"],shadow:(0,p.generateColor)(o.colorsPalette["color-black"],91),text:o.colorsPalette["color-cold-gray-900"],staticTextBackground:(0,p.generateColor)(o.colorsPalette["color-white"],20),logo:o.colorsPalette["color-cold-gray-900"]};const V={};function B(e,t){const i=V[e];if(void 0!==i)return i.image||null;const r={};return V[e]=r,function(e){return new Promise(t=>{const i=y.replace(/fill="#[\da-f]{6}"/i,`fill="${e}"`),r=new Image;r.onload=()=>{r.onload=null,t(r)},r.src=URL.createObjectURL(new Blob([i],{type:"image/svg+xml"}))})}(e).then(e=>{r.image=e,t()}),null}function F(e){const{a:t,d:i,e:r,f:n}=e;return new s.Point(r/t,n/i)}class W{constructor(){this._originPoint=null}hitTest(e){const t=this._getHitTestBox();if(t)return(0,n.pointInBox)(e,t)}_getHitTestBox(){const e=this._originPoint;if(e){
const{x:t,y:i}=e;return(0,s.box)(e,new s.Point(t+this.width,i+this.height))}}}class U extends W{constructor(e,t,i,r){if(super(),this.show=!0,this.borderRadius=0,this._needDisplayImage=!1,this._imageWidth=22,this._imageHeight=11,this._animatedWidth=32,this._font="px "+b.CHART_FONT_FAMILY,this._txt="TradingView",this._textWidth=0,this._maximizedAnimationTextWidth=0,this._textWidthCache=new w.TextWidthCache,this._pixelRatio=1,this._model=i,this._layout=e,this._symbol=t,this.showAnimatedBranding=c.enabled("show_animated_logo")||"widget_branding"===this._layout,this._fontSize=this.showAnimatedBranding?11:14,this.showAnimatedBranding||"widget_custom_branding"!==this._layout&&"fundamental_custom_branding"!==this._layout||(this._fontSize=12),this.width=32,this.height=this._fontSize+2,this._onReadyCallback=r,this._init(),document.fonts&&document.fonts.check&&document.fonts.load){document.fonts.check(this._fontSize+"px EuclidCircular")?this._font="px EuclidCircular":document.fonts.load(this._fontSize+"px EuclidCircular",this._txt).then(()=>{this._font="px EuclidCircular",this._recalculateMetrics()})}this._recalculateMetrics()}destroy(){this._model.properties().paneProperties.background.unsubscribeAll(this),this._model.onChartThemeLoaded().unsubscribeAll(this)}hasAnimation(){return this.showAnimatedBranding}minimizedAnimationWidth(){return 32}maximizedAnimationWidth(){return this._maximizedAnimationTextWidth+32-3}animatedDrawStep(e,t){this._animatedWidth=t}draw(e,t,i){t.pixelRatio!==this._pixelRatio&&(this._textWidthCache.reset(),this._pixelRatio=t.pixelRatio);const r=this._colors;if(this.showAnimatedBranding)this._needDisplayImage&&null!==this._getLogoImage(r.logo)&&(e.save(),e.translate(-Math.ceil((32-this._imageWidth)/2),Math.floor((32-this._imageHeight)/2)),this._originPoint=F(e.getTransform()),this.borderRadius=16,this._drawFillRectWithRoundedCorner(e,-.5,0,this._animatedWidth,32,this.borderRadius),this._drawLogoImage(e,Math.round((32-this._imageWidth)/2),Math.round((32-this._imageHeight)/2)+0),this._animatedWidth>32&&(e.translate(Math.round(32),Math.round(this._fontSize*D(this._font))),this._drawFillTextCropWidth(e,this._animatedWidth-32)),e.restore(),this.width=this._animatedWidth);else if("widget_custom_branding"===this._layout||"fundamental_custom_branding"===this._layout){e.font=this._fontSize+this._font;const t=e.measureText(this._txt).width+2;this.width=t+e.measureText("TradingView").width+2,this._originPoint=F(e.getTransform()),e.save(),e.globalAlpha=.7,e.fillStyle=this._colors.customBrandingText,e.fillText(this._txt,0,12),e.fillStyle=this._colors.customBrandingTradingViewText,e.fillText("TradingView",t,12),e.restore()}else if(this._needDisplayImage&&null!==this._getLogoImage(r.logo)){e.save(),e.translate(-Math.ceil((32-this._imageWidth)/2),Math.floor((32-this._imageHeight)/2)),this._originPoint=F(e.getTransform()),this.borderRadius=16,this._drawBgCircle(e),e.drawImage((0,a.ensureNotNull)(this._getLogoImage(r.logo)),Math.round((32-this._imageWidth)/2),Math.round((32-this._imageHeight)/2)+0);const t=!0
;t&&(e.translate(37,Math.round(this._fontSize*D(this._font))),this._drawTextStroke(e),this._drawTextFill(e)),e.restore(),this.width=32,t&&(this.width+=this._maximizedAnimationTextWidth)}else{const t=!0;t&&(e.save(),e.translate(x?-.5:0,-.5),this._drawTextStroke(e),this._drawTextFill(e),e.restore()),t&&(this.width=this._maximizedAnimationTextWidth)}}_init(){this._checkLayout(),this.show&&(this.height=this._needDisplayImage?32:this._fontSize+2,this._updateColors(),this._model.properties().paneProperties.background.subscribe(this,this._updateColors),this._model.onChartThemeLoaded().subscribe(this,this._updateColors))}_recalculateMetrics(){const e=(0,f.createDisconnectedBoundCanvas)(document,new f.Size(0,0)),t=(0,f.getPretransformedContext2D)(e,!0);t.font=this._fontSize+this._font,this._textWidth=Math.ceil(t.measureText(this._txt).width)+2;let i=this._textWidth+8;i%2==0&&(i+=1),this._maximizedAnimationTextWidth=i,this._textWidthCache.reset()}_updateColors(){this._colors=this._model.isDark()?N:O}_getLogoImage(e){return B(e,this._onReadyCallback)}_checkLayout(){switch(this._layout){case"widget_branding":case"widget_referral_branding":case"widget_custom_branding":case"fundamental_branding":case"fundamental_custom_branding":case"library_custom_branding":case"library_branding":case"site_branding":this.show=!0;break;case"widget_custom_no_powered_branding":case"fundamental_custom_no_powered_branding":case"library_custom_no_powered_branding":this.show=!1}switch(this._layout){case"widget_branding":this._needDisplayImage=!0,this._txt=M;break;case"fundamental_branding":this._txt=E.format({symbol:this._symbol});break;case"widget_referral_branding":this._txt=A;break;case"widget_custom_branding":case"fundamental_custom_branding":this._txt=k;break;case"site_branding":this._needDisplayImage=!0}}_drawTextStroke(e){e.save(),e.textBaseline="middle",e.textAlign="start",e.font=this._fontSize+this._font,e.strokeStyle=this._colors.staticTextBackground,e.lineWidth=4,e.lineJoin="round",e.strokeText(this._txt,0,16+this._textWidthCache.yMidCorrection(e,this._txt)),e.restore()}_drawTextFill(e){e.save(),e.textBaseline="middle",e.textAlign="start",e.font=this._fontSize+this._font,e.fillStyle=this._colors.text,e.fillText(this._txt,0,16+this._textWidthCache.yMidCorrection(e,this._txt)),e.restore()}_drawFillTextCropWidth(e,t){e.save(),e.beginPath(),e.rect(0,0,t,this.height),e.clip(),this._drawTextFill(e),e.restore()}_drawBgCircle(e){const t=this.borderRadius,i=2*Math.PI;e.save(),e.beginPath(),e.fillStyle=this._colors.shadow,e.arc(t,t,t+1,0,i),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),e.fillStyle=this._colors.background,e.arc(t,t,t,0,i,!1),e.fill(),e.closePath(),e.restore()}_drawFillRectWithRoundedCorner(e,t,i,r,s,n){e.save(),(0,m.drawRoundRect)(e,t-1,i-1,r+2,s+2,n),e.fillStyle=this._colors.shadow,e.fill(),e.closePath(),e.restore(),e.save(),(0,m.drawRoundRect)(e,t,i,r,s,n),e.fillStyle=this._colors.background,e.fill(),e.closePath(),e.restore()}_drawLogoImage(e,t,i){e.drawImage((0,a.ensureNotNull)(this._getLogoImage(this._colors.logo)),t,i)}
}class H extends W{constructor(e,t,i){super(),this.show=!1,this.width=0,this.height=0,this._ready=!1,this._layout=e,this._src=t,this._onReadyCallback=i,this._checkLayout();const r=new Image;this._img=r,this.show&&(r.addEventListener("load",()=>{this.width=Math.round(r.width),this.height=Math.round(r.height),this._ready=!0,this._onReadyCallback&&this._onReadyCallback()}),r.crossOrigin="anonymous",r.src=this._src)}draw(e,t){this._ready&&(e.drawImage(this._img,-.5,-.5,this.width,this.height),this._originPoint=F(e.getTransform()))}_checkLayout(){switch(this._layout){case"widget_custom_branding":case"widget_custom_no_powered_branding":case"fundamental_custom_branding":case"fundamental_custom_no_powered_branding":case"library_custom_branding":case"library_custom_no_powered_branding":this.show=!0;break;case"site_branding":case"widget_branding":case"widget_referral_branding":case"fundamental_branding":case"library_branding":this.show=!1}}}function z(e,t){function i(t){const i=e.getAll();if(1===i.length)return!0;const r=i[0].hasModel()&&i[0].model();return r&&r.model()===t}e.addCustomSource("branding",(e,r)=>new R(e,r,i.bind(null,r),t))}},14900:(e,t,i)=>{"use strict";i.r(t),i.d(t,{Size:()=>o,getCanvasDevicePixelRatio:()=>a,getContext2D:()=>l,getPrescaledContext2D:()=>c,getPretransformedContext2D:()=>u,hardResizeCanvas:()=>d,resizeCanvasPreservingContent:()=>h,fillRect:()=>p,clearRect:()=>_,drawScaled:()=>m,createDisconnectedCanvas:()=>f,createDisconnectedBoundCanvas:()=>g,createBoundCanvas:()=>S,calcTextHorizontalShift:()=>y,disableSelection:()=>b});var r=i(68545),s=i(16282),n=i(82755);class o{constructor(e,t){this.w=e,this.h=t}equals(e){return this.w===e.w&&this.h===e.h}}function a(e){var t,i;return Math.max(1,(null===(i=null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView)||void 0===i?void 0:i.devicePixelRatio)||1)}function l(e){const t=(0,s.ensureNotNull)(e.getContext("2d"));return t.setTransform(1,0,0,1,0,0),t}function c(e){const t=(0,s.ensureNotNull)(e.getContext("2d")),i=a(e);return t.setTransform(i,0,0,i,0,0),t}function u(e,t){const i=(0,s.ensureNotNull)(e.canvas.getContext("2d"));return i.setTransform(e.pixelRatio,0,0,e.pixelRatio,0,0),t||i.translate(.5,.5),i}function d(e,t){e.resizeCanvas({width:0,height:0}),e.resizeCanvas({width:t.w,height:t.h})}function h(e,t){const i=g(document,t),r=c(i.canvas);return r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(e.canvas,0,0,e.canvasSize.width*e.pixelRatio,e.canvasSize.height*e.pixelRatio),r.restore(),i}function p(e,t,i,r,s,n){e.save(),e.translate(-.5,-.5),e.fillStyle=n,e.fillRect(t,i,r,s),e.restore()}function _(e,t,i,r,s,n){e.save(),e.translate(-.5,-.5),e.globalCompositeOperation="copy",e.fillStyle=n,e.fillRect(t,i,r,s),e.restore()}function m(e,t,i){e.save(),e.scale(t,t),i(),e.restore()}function f(e,t,i){const r=v(e);return void 0===i&&(i=a(r)),r.width=t.w*i,r.height=t.h*i,r}function g(e,t){const i=v(e),s=(0,r.bindToDevicePixelRatio)(i,{allowDownsampling:!1});return s.resizeCanvas({width:t.w,height:t.h}),s}function v(e){const t=e.createElement("canvas");return b(t),t}
function S(e,t){const i=v((0,s.ensureNotNull)(e.ownerDocument));e.appendChild(i);const n=(0,r.bindToDevicePixelRatio)(i,{allowDownsampling:!1});return n.resizeCanvas({width:t.w,height:t.h}),n}function y(e,t){return"center"===e.textAlign?0:(0,n.isRtl)()?"start"===e.textAlign||"right"===e.textAlign?t:0:"start"===e.textAlign||"left"===e.textAlign?0:t}function b(e){e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.msUserSelect="none",e.style.MozUserSelect="none",e.style.webkitTapHighlightColor="transparent"}},54255:(e,t,i)=>{"use strict";i.d(t,{shiftPressed:()=>p,modifierPressed:()=>_,globalEnvironmentState:()=>m,ChartHotkeysListener:()=>f});var r=i(26083),s=i(11877),n=i(20887),o=i(65066),a=i.n(o),l=i(17483);const c=new(a())(Boolean(r.pressedKeys.value()&s.Modifiers.Shift)),u=new(a())(Boolean(r.pressedKeys.value()&s.Modifiers.Mod)),d=new(a())(Boolean(r.pressedKeys.value()&s.Modifiers.Alt)),h=[s.Modifiers.None,s.Modifiers.Alt,s.Modifiers.Mod,s.Modifiers.Alt+s.Modifiers.Shift];function p(){return c}function _(){return u}function m(){return new l.EnvironmentState({altKey:d.value(),ctrlKey:_().value(),metaKey:_().value(),shiftKey:p().value()})}r.pressedKeys.subscribe(e=>{c.setValue(Boolean(e&s.Modifiers.Shift)),u.setValue(Boolean(e&s.Modifiers.Mod)),d.setValue(Boolean(e&s.Modifiers.Alt))});class f{constructor(e,t){this._pressedKeyCode=null,this._boundKeydownHandler=null,this._boundKeyupHandler=null,this._chartWidget=e,this._parent=t,this._boundKeydownHandler=this._keydownHandler.bind(this),this._boundKeyupHandler=this._keyupHandler.bind(this),this._parent.ownerDocument.addEventListener("keydown",this._boundKeydownHandler),this._parent.ownerDocument.addEventListener("keyup",this._boundKeyupHandler)}destroy(){null!==this._boundKeydownHandler&&(this._parent.ownerDocument.removeEventListener("keydown",this._boundKeydownHandler),this._boundKeydownHandler=null),null!==this._boundKeyupHandler&&(this._parent.ownerDocument.removeEventListener("keyup",this._boundKeyupHandler),this._boundKeyupHandler=null)}_keydownHandler(e){this._chartWidget.hasModel()&&window.document.activeElement===window.document.body&&this._chartWidget.isActive()&&(this._handleMoveDrawingsKeyDown(e)||this._handleScrollKeyDown(e)||this._handleZoomKeyDown(e))&&e.preventDefault()}_keyupHandler(e){this._chartWidget.hasModel()&&this._handleScrollKeyUp(e)}_handleMoveDrawingsKeyDown(e){const t=255&(0,s.hashFromEvent)(e),i=this._chartWidget.model();switch(t){case 37:return i.moveSelectedToolsLeft();case 39:return i.moveSelectedToolsRight();case 38:return i.moveSelectedToolsUp();case 40:return i.moveSelectedToolsDown()}return!1}_handleScrollKeyDown(e){if(null!==this._pressedKeyCode)return!1;const t=(0,s.hashFromEvent)(e),i=255&t,r=(0,s.modifiersFromEvent)(e);let o;if(37===i)o=1;else{if(39!==i)return!1;o=-1}return!(s.isMacKeyboard&&r===s.Modifiers.Mod||!h.includes(r))&&(!(0,n.isNativeUIInteraction)(t,e.target)&&(this._pressedKeyCode=i,
r===s.Modifiers.None?this._chartWidget.scrollHelper().moveByBar(o):r===s.Modifiers.Alt||r===s.Modifiers.Mod?this._chartWidget.scrollHelper().move(o):-1===o?this._chartWidget.model().timeScale().scrollToRealtime(!0):this._chartWidget.model().timeScale().scrollToFirstBar(),!0))}_handleScrollKeyUp(e){if(null===this._pressedKeyCode)return!1;const t=(0,s.hashFromEvent)(e);if((0,n.isNativeUIInteraction)(t,e.target))return!1;return(255&t)===this._pressedKeyCode&&(this._pressedKeyCode=null,this._chartWidget.scrollHelper().stopMove(),!0)}_handleZoomKeyDown(e){const t=(0,s.hashFromEvent)(e),i=255&t;if((0,s.modifiersFromEvent)(e)!==s.Modifiers.Mod||(0,n.isNativeUIInteraction)(t,e.target))return!1;const r=this._chartWidget.model();if(38===i)r.zoomIn();else{if(40!==i)return!1;r.zoomOut()}return!0}}},37560:(e,t,i)=>{"use strict";i.d(t,{ChartWidgetBase:()=>Me});var r=i(16282),s=i(87380),n=i(37945),o=i(42098),a=i(68724),l=i(57137),c=i(88001),u=i(63628);let d;class h extends u.DialogRenderer{constructor(){super(),this._dialog=null,this._subscribe=e=>{this._setVisibility(e)}}show(){this._load().then(e=>e.show())}hide(){var e;null===(e=this._dialog)||void 0===e||e.hide()}static getInstance(){return d||(d=new h),d}_load(){return Promise.all([i.e(23876),i.e(26822),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(63193),i.e(52802),i.e(61212),i.e(85597),i.e(43894),i.e(33996),i.e(94595),i.e(94269),i.e(87936),i.e(13940),i.e(19843),i.e(68604),i.e(96637),i.e(2359),i.e(63660),i.e(56864),i.e(90487),i.e(46540),i.e(31933),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(36982),i.e(19894),i.e(27420),i.e(9881),i.e(40953),i.e(38676),i.e(38464),i.e(59963),i.e(37703),i.e(13066),i.e(80064),i.e(34862)]).then(i.bind(i,8626)).then(e=>{var t,i;return null===(t=this._dialog)||void 0===t||t.hide(),null===(i=this._dialog)||void 0===i||i.visible().unsubscribe(this._subscribe),this._dialog=new e.ObjectTreeDialogRenderer,this._dialog.visible().subscribe(this._subscribe),this._dialog})}}var p=i(31565),_=i(25658);var m=i(87048),f=i(55304),g=i(94420),v=i(1658),S=i(14563),y=i(84162),b=i(10595),w=i(14900);i(54119);class P{constructor(e,t,i){this._handleEl=null,this._startY=0,this._totalStretch=0,this._prevStretchA=0,this._pixelStretchFactor=0,this._minPaneStretch=0,this._maxPaneStretch=0,this._colorCache={lineColor:"",backgroundColor:"",color:""},this._chart=e,this._paneA=e.paneWidgets()[t],this._paneB=e.paneWidgets()[i],this._row=document.createElement("tr"),this._cell=document.createElement("td"),this._row.appendChild(this._cell),this._cell.classList.add("pane-separator"),this._cell.setAttribute("colspan","3"),this._cell.style.background=this._color(),this.adjustSize(),this._cell.addEventListener("click",()=>{});const r=document.createElement("div");r.classList.add("handle"),this._cell.appendChild(r),this._mouseEventHandler=new b.MouseEventHandler(r,this,{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0}),this._handleEl=r}destroy(){this._mouseEventHandler.destroy(),this._row.parentElement&&this._row.parentElement.removeChild(this._row)}getElement(){
return this._row}hide(){this._row.classList.add("js-hidden")}show(){this._row.classList.remove("js-hidden")}adjustSize(){this._row.style.height=P.height()+"px"}mouseDownEvent(e){this._mouseDownOrTouchStartEvent(e)}touchStartEvent(e){this._mouseDownOrTouchStartEvent(e)}pressedMouseMoveEvent(e){this._pressedMouseOrTouchMoveEvent(e)}touchMoveEvent(e){this._pressedMouseOrTouchMoveEvent(e)}mouseUpEvent(e){this._mouseUpOrTouchEndEvent(e)}touchEndEvent(e){this._mouseUpOrTouchEndEvent(e)}update(){this._cell.style.background=this._color().toString()}paint(){}image(){const e=this._paneA.leftPriceAxisesContainer().getWidth(),t=this._paneA.width(),i=this._paneA.rightPriceAxisesContainer().getWidth(),r=this._color(),s=(0,w.createDisconnectedCanvas)(document,new w.Size(e,1)),n=(0,w.getPrescaledContext2D)(s);n.fillStyle=r,n.fillRect(0,0,e,1);const o=(0,w.createDisconnectedCanvas)(document,new w.Size(t,1)),a=(0,w.getPrescaledContext2D)(o);a.fillStyle=r,a.fillRect(0,0,t,1);const l=(0,w.createDisconnectedCanvas)(document,new w.Size(i,1)),c=(0,w.getPrescaledContext2D)(l);return c.fillStyle=r,c.fillRect(0,0,i,1),{type:"separator",leftAxis:{content:s.toDataURL(),canvas:s,contentWidth:e,contentHeight:1},rightAxis:{content:l.toDataURL(),canvas:l,contentWidth:i,contentHeight:1},content:o.toDataURL(),canvas:o,contentWidth:t,contentHeight:1}}static height(){const e=window.devicePixelRatio||1;return e>=1?1:1/e}_mouseDownOrTouchStartEvent(e){this._startY=e.pageY,this._prevStretchA=this._paneA.state().stretchFactor(),this._totalStretch=this._paneA.state().stretchFactor()+this._paneB.state().stretchFactor();const t=this._paneA.height()+this._paneB.height();this._pixelStretchFactor=this._totalStretch/t,this._minPaneStretch=30*this._pixelStretchFactor,this._maxPaneStretch=this._totalStretch-this._minPaneStretch,(0,r.ensureNotNull)(this._handleEl).classList.add("i-active")}_pressedMouseOrTouchMoveEvent(e){const t=(e.pageY-this._startY)*this._pixelStretchFactor,i=(0,y.clamp)(this._prevStretchA+t,this._minPaneStretch,this._maxPaneStretch);this._paneA.state().setStretchFactor(i),this._paneB.state().setStretchFactor(this._totalStretch-i),this._chart.model().model().fullUpdate()}_mouseUpOrTouchEndEvent(e){this._chart.model().addPaneStretchFactorUndoCommand(this._paneA.state(),this._paneB.state(),this._prevStretchA,this._paneA.state().stretchFactor()),this._startY=0,this._totalStretch=0,this._prevStretchA=0,this._pixelStretchFactor=0,this._minPaneStretch=0,this._maxPaneStretch=0,(0,r.ensureNotNull)(this._handleEl).classList.remove("i-active")}_color(){const e=this._chart.properties().childs().scalesProperties.childs().lineColor.value(),t=this._chart.model().model().backgroundColor().value();if(this._colorCache.lineColor!==e||this._colorCache.backgroundColor!==t){const i=(0,S.parseRgba)(t),r=(0,S.parseRgba)(e),s=0===i[3]&&0===r[3]?"rgba(0,0,0,0)":(0,S.rgbaToString)((0,S.blendRgba)(i,r));this._colorCache={lineColor:e,backgroundColor:t,color:s}}return this._colorCache.color}}var C=i(14397),T=i(17483),x=i(748),I=i(96276),L=i.n(I),M=i(65066),E=i.n(M)
;function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var k=i(50946),D=i(34698);const R={moving:"wait_finishing",wait_finishing:"stop",stop:"moving"};class N{constructor(e){this._chartModel=null,this._currentDistance=0,this._deferredFinishTimeout=0,this._finishingTimeout=0,this._moveType="",this._startTime=0,this._state="stop",this._movingTimeout=0,this._chart=e,this._chart.withModel(this,()=>{this._chartModel=this._chart.model()})}destroy(){clearTimeout(this._movingTimeout)}move(e){if(null!==this._chartModel&&"stop"===this._state&&this._chartModel.beginUndoMacro(1===e?"Move Left":"Move Right"),this._state=R.stop,this._moveType="animated",this._deferredFinishTimeout&&(clearTimeout(this._deferredFinishTimeout),this._deferredFinishTimeout=0),this._finishingTimeout&&(clearTimeout(this._finishingTimeout),this._finishingTimeout=0),this._startTime=Date.now(),0===this._movingTimeout){const t=this._startTime,i=10,r=()=>{this.moveStep(t,0,50*e,1e3),this._movingTimeout=setTimeout(r,i)};this._movingTimeout=setTimeout(r,i)}}moveStep(e,t,i,r){if(null!==this._chartModel&&!this._chartModel.timeScale().isEmpty()){const s=Date.now();s<e&&(e=s);let n=(s-e)/r;(n>1||!isFinite(n))&&(n=1);const o=1-Math.pow(1-n,3);return this._currentDistance=(i-t)*o+t,this._chartModel.scrollChart(this._currentDistance),n}}moveByBar(e){if(null!==this._chartModel){const t=this._chartModel.timeScale();if(t.isEmpty())return;if("stop"===this._state&&this._chartModel.beginUndoMacro(1===e?"Move Left":"Move Right"),null!==t.visibleBarsStrictRange()){const e=t.indexToCoordinate(t.visibleBarsStrictRange().lastBar())+t.barSpacing()/2;Math.abs(t.width()-e)>t.barSpacing()/6&&this._chartModel.scrollChart(t.width()-e)}if(this._state=R.stop,this._moveType="by_bar",this._startTime=Date.now(),!this._movingTimeout){let t=0,i=150;const r=400,s=()=>{this._moveByBarStep(e),t++,i>100&&(i-=t/5*20),this._movingTimeout=setTimeout(s,i)};this._movingTimeout=setTimeout(s,r),this._moveByBarStep(e)}}}stopMove(){"by_bar"===this._moveType?this.stopMoveByBar():this._stopMove()}stopMoveByBar(){"moving"===this._state&&(clearTimeout(this._movingTimeout),this._movingTimeout=0,this._state=R.wait_finishing,this._moveType="",this._movingTimeout=0,this._currentDistance=0,null!==this._chartModel&&this._chartModel.endUndoMacro())}_finishMove(){clearTimeout(this._movingTimeout),this._movingTimeout=0,this._deferredFinishTimeout=0;const e=this._currentDistance,t=Date.now(),i=()=>{const r=this.moveStep(t,e,0,700);r&&r<1?this._finishingTimeout=setTimeout(i,10):null!==this._chartModel&&(this._state=R.wait_finishing,this._moveType="",this._movingTimeout=0,this._currentDistance=0,this._chartModel.endUndoMacro())};this._finishingTimeout=setTimeout(i,10)}_stopMove(){"moving"===this._state&&(this._state=R.moving,Date.now()-this._startTime<200?this._deferredFinishTimeout=setTimeout(this._finishMove.bind(this),200-(Date.now()-this._startTime)):this._finishMove())}_moveByBarStep(e){if(null!==this._chartModel){if(this._chartModel.timeScale().isEmpty())return;this._chartModel.scrollChartByBar(e)}}}
var O=i(99479),V=i(62543),B=i(5013),F=i(50137),W=i(98006);const U=(0,s.getLogger)("Chart.LinkKeyResolver");class H{constructor(e,t,i){this._pendingRequests=new Map,this._startRequestingDebounced=(0,O.default)(()=>this._startNextRequest(),500),this._layoutId=e,this._chartId=t,this._ownerSourceId=i}resolveLinkKey(e,t,i){var r;const s=function(e,t){return JSON.stringify([e,t])}(e,i),n=null!==(r=this._pendingRequests.get(s))&&void 0!==r?r:new Map;if(n.has(t))return n.get(t).promise;const o=(0,l.createDeferredPromise)();return n.set(t,o),this._pendingRequests.set(s,n),this._startRequestingDebounced(),o.promise}async _startNextRequest(){if(0===this._pendingRequests.size)return;const e=(0,F.getChartStorage)(),t=this._pendingRequests.entries().next().value,{symbol:i,brokerName:r}=function(e){const t=JSON.parse(e);return{symbol:t[0],brokerName:t[1]}}(t[0]),s=t[1],n={requestType:"mainSeriesLineTools",seriesSourceId:this._ownerSourceId,symbol:i,brokerName:r};try{const t=await e.loadLineToolsAndGroups(this._layoutId,this._chartId,n);null!==t&&(t.sources.forEach((e,t)=>{if(null===e)return;const i=e.state.linkKey;if(!i)return;const r=s.get(i);null==r||r.resolve(e.id),s.delete(i)}),t.serverRequestId&&console.log("PROCESSED:"+t.serverRequestId))}catch(e){U.logError("Error requesting line tools: "+e)}s.forEach(e=>{e.resolve(null)}),this._pendingRequests.delete(t[0]),await this._startNextRequest()}}var z=i(77903),j=i(31654),Y=i(75443),G=i(82713),q=i(56138);const X=[500,1e4,6e4];const $=(0,s.getLogger)("LineToolsSynchronizer");function K(e,t){return{id:e.id,name:e.name(),symbol:e.symbol(),currencyId:e.currencyId(),unitId:e.unitId()}}function J(e,t,i){const r=new Map;return e.forEach((e,s)=>{const n=!i||i.has(s);(e>t||!n)&&r.set(s,e)}),r}class Z{constructor(e,t,i,r){this._clientId=(0,Y.randomHash)(),this._invalidatedLineTools=new Map,this._allLineTools=new Map,this._invalidatedLineToolGroups=new Map,this._ignoreInvalidatingEventsDepth=0,this._saveChartService=null,this._debouncedSave=(0,O.default)(()=>this._saveInvalidatedIfRequired(!1),500),this._savingImmediatellyEnabled=!1,this._loadWithoutSymbolResolving=!1,this._currentlyLoadedSymbol="",this._linkKeyResolver=null,this._brokerName="",this._hasChanges=new(E())(!1),this._layoutId=e,this._chartId=t,this._chartModel=i,this._readOnlyMode=r,this._assignAllLineTools(this._chartModel.panes()),this._chartModel.panesCollectionChanged().subscribe(this,this._processPanesCollectionChanged.bind(this)),this._chartModel.dataSourceCollectionChanged().subscribe(this,this._processDataSourceCollectionChanged.bind(this)),this._chartModel.lineToolsGroupModel().onChanged().subscribe(this,this._processLineToolsGroupModelChanged.bind(this)),this._chartModel.mainSeries().dataEvents().symbolResolved().subscribe(this,this._onSymbolResolved.bind(this)),this._chartModel.mainSeries().onRestarted().subscribe(this,this._onSeriesRestarted.bind(this)),this._chartModel.sourcePropertiesChanged().subscribe(this,this._processPropertiesChanged.bind(this)),
this._chartModel.sourceZOrderChanged().subscribe(this,this._processPropertiesChanged.bind(this)),this._loadAndMergeLineToolsOnStudies(!1),this._loadAndMergeLineToolsWithoutSymbol(!1),(0,W.onFeaturesStateChanged)().subscribe(this,e=>{if("remove_line_tools_from_content"===e){(0,W.isFeatureEnabled)("remove_line_tools_from_content")&&this.invalidateAll()}"autosave_line_tools_immediately"===e&&(this._savingImmediatellyEnabled=(0,W.isFeatureEnabled)("autosave_line_tools_immediately"),this._debouncedSave()),"chart_storage_with_broker_name"===e&&(this._loadWithoutSymbolResolving=(0,W.isFeatureEnabled)("chart_storage_with_broker_name"))}),this._linkKeyResolver=new H(e,t,i.mainSeries().id()),this._savingImmediatellyEnabled=(0,W.isFeatureEnabled)("autosave_line_tools_immediately"),this._loadWithoutSymbolResolving=(0,W.isFeatureEnabled)("chart_storage_with_broker_name")}destroy(){(0,W.onFeaturesStateChanged)().unsubscribeAll(this),this._chartModel.mainSeries().dataEvents().symbolResolved().unsubscribeAll(this),this._chartModel.mainSeries().onRestarted().unsubscribeAll(this),this._chartModel.sourcePropertiesChanged().unsubscribeAll(this),this._chartModel.sourceZOrderChanged().unsubscribeAll(this),this._chartModel.panesCollectionChanged().unsubscribeAll(this),this._chartModel.dataSourceCollectionChanged().unsubscribeAll(this),this._chartModel.lineToolsGroupModel().onChanged().unsubscribeAll(this)}reloadAllLineTools(){if(this._currentlyLoadedSymbol="",this._loadAndMergeLineToolsOnStudies(!0),this._loadAndMergeLineToolsWithoutSymbol(!0),this._loadWithoutSymbolResolving)this._onSeriesRestarted();else{const e=this._chartModel.mainSeries().symbolInfo();e&&this._onSymbolResolved(e)}}hasChanges(){return this._hasChanges}setSaveChartService(e){this._saveChartService=e}prepareDTO(e){const t=new Map,i=new Map;return this._invalidatedLineTools.forEach((s,n)=>{const o=this._chartModel.dataSourceForId(n);if(null===o)t.set(n,null);else{if(o===this._chartModel.lineBeingCreated()||o===this._chartModel.lineBeingEdited()||!o.isSavedInChart())return;const s=o.ownerSource()===this._chartModel.mainSeries();if(!e||s){t.set(n,function(e,t){const i=t.lineToolsGroupModel().groupForLineTool(e),s={id:e.id(),ownerSource:(0,r.ensureNotNull)(e.ownerSource()).id(),state:e.state(!1)};return e.boundToSymbol()&&(s.symbol=e.symbol()),s.currencyId=e.properties().childs().currencyId.value(),s.unitId=e.properties().childs().unitId.value(),null!==i&&(s.groupId=i.id),s}(o,this._chartModel));const e=this._chartModel.lineToolsGroupModel().groupForLineTool(o);null!==e&&i.set(e.id,K(e,this._chartModel))}}}),this._invalidatedLineToolGroups.forEach((e,t)=>{if(!i.has(t)){const e=this._chartModel.lineToolsGroupModel().groupForId(t);null===e?i.set(t,null):i.set(t,K(e,this._chartModel))}}),{sources:t,groups:i,clientId:this._clientId}}resetInvalidated(e,t){this._invalidatedLineTools=J(this._invalidatedLineTools,e,null==t?void 0:t.sources),this._invalidatedLineToolGroups=J(this._invalidatedLineToolGroups,e,null==t?void 0:t.groups),this._recalculateHasChanges()}
applyLineToolUpdateNotification(e){e.clientId!==this._clientId&&this._applyLineToolsAndGroupsDTO(e)}applyAlertIdByExternalSource(e,t){this._withoutInvalidating(()=>{const i=this._chartModel.dataSourceForId(e);i&&(0,m.isLineTool)(i)&&i.setAlert(t,{noChartSave:!0})})}deleteAlertByExternalSource(e){this._withoutInvalidating(()=>{const t=this._chartModel.dataSourceForId(e);t&&(0,m.isLineTool)(t)&&t.removeAlert()})}async markSyncedLineToolAsDeleted(e,t){if(this._linkKeyResolver){const i=await this._linkKeyResolver.resolveLinkKey(t,e,this._brokerName);if(null!==i){const t=(0,m.lineToolByLinkKey)(this._chartModel,e);null===t?this._invalidateLineTool(i,performance.now()):this._withoutInvalidating(()=>{const e=(0,r.ensureNotNull)(this._chartModel.paneForSource(t)),i=this._allLineTools.get(e.id())||new Map;this._chartModel.removeSource(t),i.delete(t.id())}),this._debouncedSave()}return i}return null}invalidateAll(){const e=performance.now();this._allLineTools.forEach(t=>{t.forEach((t,i)=>{this._invalidateLineTool(i,e)})}),this._chartModel.lineToolsGroupModel().groupsForAllSymbols().forEach(t=>{this._invalidateLineToolGroup(t.id,e)})}setBroker(e){this._brokerName=e}_assignAllLineTools(e){this._allLineTools.clear(),e.forEach(e=>{const t=e.dataSources().filter(m.isLineTool).map(e=>[e.id(),e.linkKey().value()]),i=new Map(t);this._allLineTools.set(e.id(),i)})}_processPropertiesChanged(e,t){(0,m.isLineTool)(t)&&this._invalidateLineTool(t.id(),performance.now())}_processLineToolsGroupModelChanged(e,t){const i=performance.now();this._invalidateLineToolGroup(e,i),t&&(t.affectedLineTools||[]).forEach(e=>this._invalidateLineTool(e,i))}_processPanesCollectionChanged(e){const t=e.map(e=>e.id()),i=new Set(t),s=performance.now();Array.from(this._allLineTools.keys()).filter(e=>!i.has(e)).forEach(e=>{Array.from((0,r.ensureDefined)(this._allLineTools.get(e)).keys()).forEach(e=>{this._invalidateLineTool(e,s)})}),e.filter(e=>!this._allLineTools.has(e.id())).forEach(e=>{e.dataSources().filter(m.isLineTool).forEach(e=>this._invalidateLineTool(e.id(),s))}),this._assignAllLineTools(e)}_processDataSourceCollectionChanged(e){const t=e.dataSources().filter(m.isLineTool),i=t.map(e=>[e.id(),e.linkKey().value()]),s=new Map(i),n=performance.now();if(this._allLineTools.has(e.id())){const i=(0,r.ensureDefined)(this._allLineTools.get(e.id()));t.filter(e=>!i.has(e.id())).forEach(e=>this._invalidateLineTool(e.id(),n)),Array.from(i.entries()).filter(e=>!s.has(e[0])).forEach(e=>{null!==e[1]&&this._debouncedSave(),this._invalidateLineTool(e[0],n)})}else t.forEach(e=>this._invalidateLineTool(e.id(),n));this._allLineTools.set(e.id(),s)}_unloadLineTools(e,t){const i=e.filter(e=>!this._invalidatedLineTools.has(e)).map(e=>this._chartModel.dataSourceForId(e)).filter(p.notNull).filter(t).filter(e=>{const t=this._chartModel.lineToolsGroupModel().groupForLineTool(e);return null===t||!this._invalidatedLineToolGroups.has(t.id)});this._withoutInvalidating(()=>{i.forEach(e=>{var t;e.hasAlert.value()&&e.detachAlert();const i=(0,r.ensureNotNull)(this._chartModel.paneForSource(e))
;this._chartModel.removeSource(e);(null!==(t=this._allLineTools.get(i.id()))&&void 0!==t?t:new Map).delete(e.id())}),this._chartModel.lineToolsGroupModel().removeLineTools(i)})}_unloadLinesOnSeries(){const e=this._chartModel.mainSeries(),t=(0,r.ensureNotNull)(this._chartModel.paneForSource(e)),i=this._allLineTools.get(t.id());(null==i?void 0:i.size)&&this._unloadLineTools(Array.from(i.keys()),t=>t.boundToSymbol()&&t.ownerSource()===e)}_isAutosaveEnabled(){return Boolean(this._saveChartService&&this._saveChartService.autoSaveEnabled().value())}_saveInvalidatedIfRequired(e){if(!this._isAutosaveEnabled()||this._readOnlyMode)return Promise.resolve();const t=this.prepareDTO(e);if(0===t.sources.size&&0===t.groups.size)return Promise.resolve();const i=performance.now();return(0,r.ensureNotNull)(this._saveChartService).saveChartLineTools(this._chartId,t).then(()=>{this.resetInvalidated(i,t)})}_savePromise(e){var t,i;return this._savingImmediatellyEnabled?null!==(i=null===(t=this._debouncedSave)||void 0===t?void 0:t.flush())&&void 0!==i?i:Promise.resolve():this._saveInvalidatedIfRequired(e)}_seriesLineToolsUnloader(e){const t=this._chartModel.mainSeries();(0,W.isFeatureEnabled)("remove_line_tools_from_content")&&"mainSeriesLineTools"===e.requestType&&t.symbolSameAsCurrent(e.symbol)&&(this._unloadLinesOnSeries(),this._currentlyLoadedSymbol=e.symbol)}_onSymbolResolved(e){if(this._loadWithoutSymbolResolving)return;const t={requestType:"mainSeriesLineTools",seriesSourceId:this._chartModel.mainSeries().id(),symbol:e.pro_name,brokerName:""};this._makeLoadRequestAndMerge(t,this._seriesLineToolsUnloader.bind(this,t))}_onSeriesRestarted(){if(!this._loadWithoutSymbolResolving)return;const e={requestType:"mainSeriesLineTools",seriesSourceId:this._chartModel.mainSeries().id(),symbol:this._chartModel.mainSeries().properties().childs().symbol.value(),brokerName:(0,W.isFeatureEnabled)("broker_id_session")?this._brokerName:""};this._makeLoadRequestAndMerge(e,this._seriesLineToolsUnloader.bind(this,e))}async _makeLoadRequestAndMerge(e,t){if(!!this._chartModel.mainSeries().symbolSameAsCurrent(this._currentlyLoadedSymbol))return;const i=(0,F.getChartStorage)();await this._savePromise("mainSeriesLineTools"===e.requestType),async function(e,t,i,r){const s=async()=>e.loadLineToolsAndGroups(t,i,r);return s().catch(()=>(0,q.retriesWithDelays)(async()=>(await(0,G.waitForOnline)(),s()),X))}(i,this._layoutId,this._chartId,e).then(e=>{null!==e&&(t(),this._applyLineToolsAndGroupsDTO(e),e.serverRequestId&&console.log("PROCESSED:"+e.serverRequestId))})}_restoreGroups(e,t){const i=new Map;return(t.groups||new Map).forEach((t,s)=>{const n=this._chartModel.lineToolsGroupModel().groupForId(s);if(null===t)null!==n&&new j.ExcludeLineToolsFromGroupUndoCommand(this._chartModel,n,n.lineTools()).redo();else if(n&&t.serverUpdateTime){const i=parseInt((0,r.ensureDefined)(t.serverUpdateTime));if(null!==e&&e>=i)return;n.setName(t.name)}else i.set(s,t)}),i}_createNewLineTool(e){const t=this._chartModel.dataSourceForId(e.ownerSource);if(null===t)return null;const i=(0,
r.ensureNotNull)(this._chartModel.paneForSource(t)),s=this._chartModel.panes().indexOf(i),n=this._chartModel.restoreSource(!1,s,null,e.state,null);if(null!==n){const e=this._allLineTools.get(i.id())||new Map;e.set(n.id(),n.linkKey().value()),this._allLineTools.set(i.id(),e)}return n}_migrateStateFromMetainfo(e){const t=void 0!==e.symbol&&e.symbol!==e.state.state.symbol;t&&(e.state.state.symbol=e.symbol);const i=void 0!==e.currencyId&&e.currencyId!==e.state.state.currencyId;i&&(e.state.state.currencyId=e.currencyId);const r=void 0!==e.unitId&&e.unitId!==e.state.state.unitId;return r&&(e.state.state.unitId=e.unitId),t||i||r}_restoreLineTool(e,t){var i;if((null!==(i=t.state.points)&&void 0!==i?i:[]).some(e=>!(0,p.isNumber)(e.time_t)))return null;const s=this._chartModel.dataSourceForId(t.id);if(null!==s&&!(0,m.isLineTool)(s))return null;if(s&&t.serverUpdateTime){const i=parseInt((0,r.ensureDefined)(t.serverUpdateTime));if(null!==e&&e>=i)return null;this._chartModel.restoreLineToolState(s,t.state),s.calcIsActualSymbol()}this._migrateStateFromMetainfo(t)&&this._invalidateLineTool(t.id,performance.now(),!0);const n=s||this._createNewLineTool(t);return t.state.alertId?null==n||n.setAlert(t.state.alertId,{noChartSave:!0}):null==n||n.detachAlert(),n}_removeLineTool(e){const t=this._chartModel.dataSourceForId(e);null!==t&&new z.RemoveSourcesCommand(this._chartModel,[t],"").redo()}_restoreLineDTO(e,t,i,s){if(!this._invalidatedLineTools.has(t))if(null===e)this._removeLineTool(t);else{const t=this._restoreLineTool(s,e);if(t)if(e.groupId){const s=this._chartModel.lineToolsGroupModel().groupForLineTool(t),n=this._chartModel.lineToolsGroupModel().groupForId(e.groupId);if(null!==s&&n===s)return;if(null!==s&&(s.excludeLineTool(t),0===s.lineTools().length&&this._chartModel.lineToolsGroupModel().removeGroup(s)),n&&!n.containsLineTool(t))n.addLineTools([t]);else if(!n&&i.has(e.groupId)){const s=(0,r.ensureDefined)(i.get(e.groupId));this._chartModel.lineToolsGroupModel().createGroup([t],s.name,s.id)}}else this._chartModel.lineToolsGroupModel().removeLineTools([t])}}_applyLineToolsAndGroupsDTO(e){const t=this._chartModel.chartSaveTime(),i=this._withoutInvalidating(()=>this._restoreGroups(t,e)),r="ChartStorage.Synchronizer.ApplyingDTO."+`${this._layoutId}.${this._chartId}`;(0,B.perfMeasureOperation)(r,()=>this._withoutInvalidating(()=>{(e.sources||new Map).forEach((e,r)=>{try{this._restoreLineDTO(e,r,i,t)}catch(e){$.logError(`Error restoring line tool ${r}: ${e}`)}}),(e.groups||new Map).forEach((e,t)=>{this._invalidatedLineToolGroups.delete(t)}),this._recalculateHasChanges()}))}_withoutInvalidating(e){try{return this._ignoreInvalidatingEventsDepth++,e()}finally{this._ignoreInvalidatingEventsDepth--}}_invalidateLineTool(e,t,i){this._ignoreInvalidatingEventsDepth>0&&!i||(this._invalidatedLineTools.set(e,t),this._hasChanges.setValue(!0),this._savingImmediatellyEnabled&&this._debouncedSave())}_invalidateLineToolGroup(e,t){if(!(this._ignoreInvalidatingEventsDepth>0)){if((0,W.isFeatureEnabled)("log_removing_line_tools_group")){
this._chartModel.lineToolsGroupModel().groupForId(e)||$.logError("stack: "+(new Error).stack)}this._invalidatedLineToolGroups.set(e,t),this._hasChanges.setValue(!0),this._savingImmediatellyEnabled&&this._debouncedSave()}}_loadAndMergeLineToolsOnStudies(e){const t={requestType:"studiesLineTools",seriesSourceId:this._chartModel.mainSeries().id()},i=e?(0,V.default)(Array.from(this._allLineTools.values()).map(e=>Array.from(e.keys()))):[],r=this._chartModel.mainSeries();this._makeLoadRequestAndMerge(t,()=>{this._unloadLineTools(i,e=>e.ownerSource()!==r)})}_loadAndMergeLineToolsWithoutSymbol(e){const t={requestType:"lineToolsWithoutSymbol",seriesSourceId:this._chartModel.mainSeries().id()},i=this._chartModel.mainSeries(),s=(0,r.ensureNotNull)(this._chartModel.paneForSource(i)),n=this._allLineTools.get(s.id()),o=e&&n?Array.from(n.keys()):[];this._makeLoadRequestAndMerge(t,()=>{this._unloadLineTools(o,e=>!e.boundToSymbol()&&e.ownerSource()===i)})}_recalculateHasChanges(){this._hasChanges.setValue(this._invalidatedLineTools.size>0||this._invalidatedLineToolGroups.size>0)}}var Q=i(82655),ee=i(79200),te=i(20220),ie=i(97105),re=i(55471),se=i(45630);const ne=(0,te.t)("Why might my US stock data look different?");function oe(e){switch(e.type){case"replaced_to_exchange":return{text:ne,warningIcon:se,warningType:"notaccurate",solutionId:ie.solutionIds.WHAT_IS_CBOE_BZX_EXCHANGE}}}class ae{constructor(e){this._activeHint=null,this._deferredPromise=null,this._chart=e;e.model().mainSeries().dataEvents().symbolResolved().subscribe(this,this._onSymbolResolved)}destroy(){this._destroyActiveHint();this._chart.model().mainSeries().dataEvents().symbolResolved().unsubscribe(this,this._onSymbolResolved)}_destroyActiveHint(){null!==this._activeHint&&(this._activeHint.destroy(),this._activeHint=null),this._deferredPromise=null}async _createHint(){if(null===this._deferredPromise){const e=(0,l.createDeferredPromise)();this._deferredPromise=e,Promise.all([i.e(74814),i.e(52139),i.e(87453),i.e(73935),i.e(83129)]).then(i.bind(i,64922)).then(t=>{e.resolve(new t.ChartWarningHintRenderer(this._chart))})}return this._deferredPromise.promise}_onSymbolResolved(e){const t=function(e){const t=(0,re.firstReplacedByBatsExchange)(e);return null!==t?{type:"replaced_to_exchange",exchange:t}:null}(e),i=t&&function(e){return"warning.noSubsc_"+e.exchange}(t);if(null===t||null===i||Boolean(o.getBool(i)))return void this._destroyActiveHint();const r={...oe(t),onClose:()=>{o.setValue(i,!0,{forceFlush:!0}),this._destroyActiveHint()}};null!==this._activeHint?this._activeHint.show(r):this._createHint().then(e=>{this._activeHint=e,this._activeHint.show(r)})}}var le=i(88674),ce=i(54255),ue=i(22842),de=i.n(ue),he=i(89150),pe=i(20554),_e=i(19453);class me{constructor(){this._draggingSource=null,this._activeTouchPanes=new Set,this._scrollingPane=null,this._pinchingPane=null}onPaneDestroyed(e){this._activeTouchPanes.delete(e),this._scrollingPane===e&&(this._scrollingPane=null),this._pinchingPane===e&&(this._pinchingPane=null)}startTouch(e){this._activeTouchPanes.add(e)}
endTouch(e){this._activeTouchPanes.delete(e)}hasTouchesOnOtherPanes(e){return this._activeTouchPanes.size>1||1===this._activeTouchPanes.size&&!this._activeTouchPanes.has(e)}trySetDraggingSource(e,t){return!this.hasTouchesOnOtherPanes(t)&&((0,r.assert)(null===this._draggingSource||this._draggingSource===e),this._draggingSource=e,!0)}clearDraggingSource(){null!==this._draggingSource&&(this._draggingSource=null)}draggingSource(){return this._draggingSource}setScrollingPane(e){(0,r.assert)(null===e||null===this._scrollingPane||this._scrollingPane===e),this._scrollingPane=e}scrollingPane(){return this._scrollingPane}setPinchingPane(e){(0,r.assert)(null===e||null===this._pinchingPane||this._pinchingPane===e),this._pinchingPane=e}pinchingPane(){return this._pinchingPane}}let fe=null;var ge=i(29098),ve=i(46926);function Se(e,t,r,s,n){return Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(32795),i.e(63193),i.e(52802),i.e(61212),i.e(76473),i.e(85597),i.e(43894),i.e(45266),i.e(33996),i.e(94595),i.e(94269),i.e(87936),i.e(99305),i.e(90901),i.e(38968),i.e(40587),i.e(55442),i.e(55313),i.e(68604),i.e(26992),i.e(96271),i.e(93228),i.e(52951),i.e(81542),i.e(18277),i.e(98755),i.e(57373),i.e(25913),i.e(69602),i.e(81778),i.e(76548),i.e(13410),i.e(86333),i.e(29082),i.e(15518),i.e(82321),i.e(33793),i.e(72091),i.e(26143),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(36982),i.e(19894),i.e(27420),i.e(53011),i.e(9881),i.e(52616),i.e(91050),i.e(45080),i.e(38676),i.e(9622),i.e(27274),i.e(9394),i.e(59963),i.e(91712),i.e(62348),i.e(12503),i.e(20356),i.e(37703),i.e(60006),i.e(5131),i.e(15382),i.e(11008),i.e(23600),i.e(18629),i.e(20197),i.e(15623),i.e(16e3),i.e(32235),i.e(66034),i.e(46265)]).then(i.bind(i,42026)).then(i=>{const o=new(0,i.EditObjectDialogRenderer)(e,t,s,n);return o.show(r),o})}let ye=null;var be=i(95047);const we={[ve.TabNames.symbol]:"symbol",[ve.TabNames.legend]:"legend",[ve.TabNames.scales]:"scales",[ve.TabNames.trading]:"trading",[ve.TabNames.events]:"events",[ve.TabNames.timezoneSessions]:"appearance",[ve.TabNames.text]:"text",[ve.TabNames.style]:"style",[ve.TabNames.visibility]:"visibility"},Pe={[ve.TabNames.style]:"style",[ve.TabNames.visibility]:"visibilities"};async function Ce(e,t,r={},s,n){const o=s.activeChartWidget.value(),{initialTab:a,tabName:l}=r;if(l&&!a&&(r.initialTab=Pe[l]),(0,m.isStudyLineTool)(e)&&function(e){return[be.LineToolVbPFixed].some(t=>e instanceof t)}(e))return o.propertiesDefinitionsForSource(e).then(i=>null!==i?Se(e,t,r,n,i):null);if((0,f.isStudy)(e)&&function(e){const{shortId:t}=e.metaInfo();return"Overlay"===t}(e)||(0,m.isLineTool)(e))return o.propertiesDefinitionsForSource(e).then(r=>{if(null!==r){return function(e){
return Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(32795),i.e(63193),i.e(52802),i.e(61212),i.e(76473),i.e(85597),i.e(43894),i.e(45266),i.e(33996),i.e(94595),i.e(94269),i.e(87936),i.e(99305),i.e(90901),i.e(38968),i.e(40587),i.e(55442),i.e(68604),i.e(26992),i.e(96271),i.e(93228),i.e(81542),i.e(57373),i.e(25913),i.e(69602),i.e(81778),i.e(76548),i.e(13410),i.e(86333),i.e(15518),i.e(72091),i.e(25637),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(36982),i.e(19894),i.e(27420),i.e(53011),i.e(9881),i.e(52616),i.e(91050),i.e(45080),i.e(38676),i.e(9622),i.e(27274),i.e(9394),i.e(59963),i.e(12503),i.e(20356),i.e(37703),i.e(60006),i.e(5131),i.e(15382),i.e(11008),i.e(23600),i.e(18629),i.e(20197),i.e(66034),i.e(46780)]).then(i.bind(i,5439)).then(t=>{const i=new(0,t.SourcePropertiesEditorRenderer)(e);return null!==ye&&ye.hide(),i.show(),ye=i,i})}({propertyPages:r,model:t,source:e,activePageId:l&&we[l]})}return null});if((0,f.isStudy)(e)&&!(0,f.isESDStudy)(e))return Se(e,t,r,n);{const t=(0,f.isESDStudy)(e)?"events":l&&we[l],i=s.getChartPropertiesDialogRenderer();return i.setActivePage(t),i.show()}}const Te=(0,ue.enabled)("chart_content_overrides_by_defaults"),xe=(0,s.getLogger)("ChartWidget",{color:"#606"}),Ie={addToWatchlistEnabled:!0,showFinancialsEnabled:!1,sourceSelectionEnabled:!0,propertyPagesEnabled:!0,paneContextMenuEnabled:!0,priceScaleContextMenuEnabled:!0,currencyConversionEnabled:!1,unitConversionEnabled:!1,goToDateEnabled:!1,marketStatusWidgetEnabled:!0,chartWarningWidgetEnabled:!0,dataProblemWidgetEnabled:!0,paneControlsEnabled:!0,isSymbolAvailable:e=>Promise.resolve(!0),legendWidgetEnabled:!0,chartEventsEnabled:!0,esdEnabled:!1,croppedTickMarks:!0,countdownEnabled:!0,lastPriceAnimationEnabled:!0,useKineticScroll:a.CheckMobile.any(),indicatorsDialogShortcutEnabled:!0,handleScale:{mouseWheel:!0,pinch:!0,axisPressedMouseMove:{time:!0,price:!0}},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0}};function Le(e,t,i,r=0){const s=t.mainSeries().syncModel(),n=e.mainSeries().syncModel();let o=i;if(null!==s&&null!==n){const t=e.createSyncPoint(s,n);0!==r&&(i=s.projectTime(i,r)),o=t.sourceTimeToTargetTime(i)}return e.timeScale().points().roughIndex(o,n&&n.distance.bind(n))}class Me{constructor(e,t,i){this.activePaneWidget=null,this._model=null,this._paneWidgets=[],this._maximizedPaneWidget=null,this._timeAxisWidget=null,this._paneSeparators=[],this._controlBarNavigation=null,this._lineToolsSynchronizer=null,this._modelCreated=new(L()),this._isDestroyed=!1,this._customLegendWidgetsFactoryMap=new Map,this._backgroundTopTheme=new(E())("light"),this._backgroundBasedTheme=new(E())("light"),this._backgroundBottomTheme=new(E())("light"),this._lhsAxesWidth=0,this._rhsAxesWidth=0,this._lhsPriceAxisWidthChanged=new(L()),this._rhsPriceAxisWidthChanged=new(L()),this._mainDiv=null,this._parent=null,this._elTooltipDiv=null,this._hotkeysListener=null,this._mouseWheelHelper=null,this._onWheelBound=null,this._justActivated=!1,this._inited=!1,this._containsData=!1,
this._initialLoading=!1,this._defTimeframe=void 0,this._removeMaximizeHotkey=null,this._metaInfoRepository=null,this._invalidationMask=null,this._drawPlanned=!1,this._drawRafId=0,this._inLoadingState=!1,this._timingsMeter=null,this._tagsChanged=new(L()),this._redraw=new(L()),this._isVisible=new(E())(!0),this._collapsed=new(E())(!1),this._dataWindowWidget=null,this._updateThemedColorBound=this._updateThemedColor.bind(this),this._saveChartService=null,this._objectTreeDialogController=null,this._chartPaintedPromise=null,this._noExchangeSubscrptionWarning=null,this._paneWidgetsSharedState=new me,this._brokerName="",this._onZoom=new(L()),this._id=t,this._layoutId=i,this._options=(0,p.merge)((0,p.clone)(Ie),e),this._options.customLegendWidgetFactories&&(this._customLegendWidgetsFactoryMap=this._options.customLegendWidgetFactories),this._subscribeToDrawingState(),this.withModel(this,()=>{const e=this.model().model();e.backgroundTopColor().subscribe(this._updateThemedColorBound),e.backgroundColor().subscribe(this._updateThemedColorBound)}),this._scrollHelper=new N(this),this._objectTreeDialogController=h.getInstance()}destroy(){var e,t;null===(e=this._lineToolsSynchronizer)||void 0===e||e.destroy(),null===(t=this._noExchangeSubscrptionWarning)||void 0===t||t.destroy(),window.loginStateChange.unsubscribe(this,this._handleLoginStateChanged),null!==this._model&&(this._model.model().backgroundTopColor().unsubscribe(this._updateThemedColorBound),this._model.model().backgroundColor().unsubscribe(this._updateThemedColorBound),this._model.destroy()),this._customLegendWidgetsFactoryMap.clear(),this._scrollHelper.destroy(),this._isDestroyed=!0}lineToolSynchronizer(){return this._lineToolsSynchronizer}model(){return(0,r.ensureNotNull)(this._model)}id(){return this._id}layoutId(){return this._layoutId}isVisible(){return this._isVisible.value()}setVisible(e){this._isVisible.setValue(e)}setCollapsed(e){this._collapsed.setValue(e)}async showChartPropertiesForSources(e){if(!de().enabled("property_pages"))return Promise.resolve(null);const{sources:t}=e,s=(0,r.ensureNotNull)(this._model),n=t.map(e=>e.properties().childs().intervalsVisibilities).reduce((e,t)=>{for(const i in t)if(A(t,i)){const r=t[i],s=e[i];s?s.push(r):e[i]=[r]}return e},{});const[{createPropertyPage:o},{getSelectionIntervalsVisibilitiesPropertiesDefinition:a}]=await Promise.all([Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,44597)),Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,16e3))]);return async function(e){
const{SourcesPropertiesEditorRenderer:t}=await Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(32795),i.e(63193),i.e(52802),i.e(61212),i.e(76473),i.e(85597),i.e(43894),i.e(45266),i.e(33996),i.e(94595),i.e(94269),i.e(87936),i.e(99305),i.e(90901),i.e(38968),i.e(40587),i.e(55442),i.e(68604),i.e(26992),i.e(96271),i.e(93228),i.e(81542),i.e(57373),i.e(25913),i.e(69602),i.e(81778),i.e(76548),i.e(13410),i.e(86333),i.e(15518),i.e(72091),i.e(25637),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(36982),i.e(19894),i.e(27420),i.e(53011),i.e(9881),i.e(52616),i.e(91050),i.e(45080),i.e(38676),i.e(9622),i.e(27274),i.e(9394),i.e(59963),i.e(12503),i.e(20356),i.e(37703),i.e(60006),i.e(5131),i.e(15382),i.e(11008),i.e(23600),i.e(18629),i.e(20197),i.e(66034),i.e(46780)]).then(i.bind(i,63014)),r=new t(e);return null!==fe&&(fe.hide(),fe=r),r.show(),r}({sources:t,propertyPage:o(a(n,s),"visibility",window.t("Visibility")),undoModel:s})}getPriceAxisWidthChangedByName(e){return"left"===e?this._lhsPriceAxisWidthChanged:this._rhsPriceAxisWidthChanged}getPriceAxisMaxWidthByName(e){return"left"===e?this._lhsAxesWidth:this._rhsAxesWidth}timeAxisHeight(){return null!==this._timeAxisWidget?this._timeAxisWidget.size.h:0}withModel(e,t){null!==this._model?t.call(e):this.modelCreated().subscribe(e,t,!0)}hasModel(){return null!==this._model}onZoom(){return this._onZoom}images(e){window.TradingView.printing=!0;const t=this.model().selection().allSources();this.model().selectionMacro(e=>e.clearSelection());const i=(t,i)=>{t.paint(i,this.onWidget());const r={showCollapsedStudies:Boolean(null==e?void 0:e.showCollapsedStudies),status:null==e?void 0:e.status};return t.getScreenshotData(r)},r=[];if(null!==this._maximizedPaneWidget){const e=this._paneWidgets.indexOf(this._maximizedPaneWidget);r.push(i(this._maximizedPaneWidget,g.InvalidationMask.light().invalidateForPane(e)))}else for(let e=0;e<this._paneWidgets.length;++e){const t=this._paneWidgets[e];r.push(i(t,g.InvalidationMask.light().invalidateForPane(e))),e<this._paneWidgets.length-1&&r.push(this._paneSeparators[e].image())}let s;this._timeAxisWidget&&(this._timeAxisWidget.paint(g.InvalidationLevel.Light),s=this._timeAxisWidget.getScreenshotData()),window.TradingView.printing=!1,this.model().selectionMacro(e=>{t.forEach(t=>{e.addSourceToSelection(t)})}),this.model().model().lightUpdate();const n=this.mainSeriesQuotesAndMetainfo();return{panes:r,timeAxis:s,colors:{text:this.properties().childs().scalesProperties.childs().textColor.value(),bg:this.properties().childs().paneProperties.childs().background.value(),scales:this.properties().childs().scalesProperties.childs().lineColor.value()},meta:n.meta,ohlc:n.ohlc,quotes:n.quotes}}setSaveChartService(e){this._saveChartService=e,null!==this._lineToolsSynchronizer&&this._lineToolsSynchronizer.setSaveChartService(e)}getSaveChartService(){return this._saveChartService}mainSeriesQuotesAndMetainfo(){let e,t,i;const r=this._model&&this._model.mainSeries();if(r){
const s=e=>null==e?"":r.formatter().format(e,void 0,void 0,!0,!1)+"",n=e=>null==e?"":e+"";e={resolution:r.interval(),symbol:r.symbol()};const o=r.symbolInfo();o&&(e.symbol=o.full_name,e.description=o.description,e.exchange=o.exchange);const a=r.bars().last();null!==a&&(t=a.value.slice(1,5).map(s));const l=r.quotes();l&&(i={change:s(l.change),changePercent:n(l.change_percent),last:s(l.last_price)})}return{meta:e,ohlc:t,quotes:i}}updateCrossHairPositionIfNeeded(){if(this._model){const e=C.tool.value();if(this._model.model().setCurrentTool(e),(0,x.lastEventIsTouch)()){const e=this._maximizedPaneWidget||this._paneWidgets[0];if(e.hasState()&&(this._isLineToolModeExceptBrush()||this.selectPointMode().value()||(0,C.toolIsMeasure)(C.tool.value()))){const t=e.state(),i=.5*this._model.model().timeScale().width(),r=.5*t.defaultPriceScale().height();this._model.model().setAndSaveCurrentPosition(i,r,t)}}this._model&&(0,x.lastEventIsTouch)()&&this._model.model().crossHairSource().updateAllViews()}}trackingModePaneWidget(){if(!(0,x.lastEventIsTouch)())return null;for(const e of this.paneWidgets())if(e.trackingModeEnabled())return e;return null}startTrackingMode(){if((0,x.lastEventIsTouch)()){this.exitTrackingMode(),this.updateCrossHairPositionIfNeeded();const e=this._maximizedPaneWidget||this._paneWidgets[0],t=this.model().model().crossHairSource().currentPoint();e.startTrackingMode(t,t)}}exitTrackingMode(){(0,x.lastEventIsTouch)()&&this.paneWidgets().some(e=>e.trackingModeEnabled())&&(this.paneWidgets().forEach(e=>e.exitTrackingMode()),this.model().model().clearCurrentPosition())}onToolChanged(){this.selectPointMode().value()&&this.cancelRequestSelectPoint(),this.exitTrackingMode()}setInLoadingState(e){this._inLoadingState=e}paint(e){const t=null!=e?e:g.InvalidationMask.full();t.validationActions().forEach(e=>e()),this._paneWidgets.forEach((e,i)=>{null!==this._maximizedPaneWidget&&this._maximizedPaneWidget!==e||e.paint(t.invalidateForPane(i),!1)}),this._timeAxisWidget&&this._timeAxisWidget.paint(t.invalidateForTimeScale()),this._redraw.fire()}GUIResetScales(){(0,ge.trackEvent)("GUI","Reset Scales"),null!==this._model&&this._model.resetScales()}maximizedPaneWidget(){return this._maximizedPaneWidget}isMaximizedPane(){return null!==this._maximizedPaneWidget}unsetActivePaneWidget(){this.activePaneWidget=null}setActivePaneWidget(e){this.activePaneWidget=e}onPaneWidgetDestroyed(e){this.activePaneWidget===e&&(this.activePaneWidget=null)}backgroundTopTheme(){return this._backgroundTopTheme.readonly()}backgroundBasedTheme(){return this._backgroundBasedTheme.readonly()}backgroundBottomTheme(){return this._backgroundBottomTheme.readonly()}lineToolsAndGroupsDTO(){return(0,r.ensureNotNull)(this._lineToolsSynchronizer).prepareDTO()}resetLineToolsInvalidated(e,t){(0,r.ensureNotNull)(this._lineToolsSynchronizer).resetInvalidated(e,t)}reloadAllLineTools(){(0,r.ensureNotNull)(this._lineToolsSynchronizer).reloadAllLineTools()}applyLineToolUpdateNotification(e){(0,r.ensureNotNull)(this._lineToolsSynchronizer).applyLineToolUpdateNotification(e)}
applyAlertIdByExternalSource(e,t){var i;null===(i=this._lineToolsSynchronizer)||void 0===i||i.applyAlertIdByExternalSource(e,t)}deleteAlertByExternalSource(e,t){var i;null===(i=this._lineToolsSynchronizer)||void 0===i||i.deleteAlertByExternalSource(e)}shouldBeSavedEvenIfHidden(){return this.model().model().shouldBeSavedEvenIfHidden()}showObjectsTreeDialog(){var e;null===(e=this._objectTreeDialogController)||void 0===e||e.show()}addCustomWidgetToLegend(e,t){this._customLegendWidgetsFactoryMap.set(e,t);for(const i of this.paneWidgets())i.addCustomWidgetToLegend(e,t)}applyIndicatorsToAllChartsAvailable(){if(!this.chartWidgetCollection().applyIndicatorsToAllChartsAvailable())return!1;for(const e of this.model().model().panes()){if(e.sourcesByGroup().all().some(e=>(0,f.isStudy)(e)&&!(0,f.isESDStudy)(e)))return!0}return!1}restoreState(e,t,s){this._adjustSize();const n=(0,r.ensureNotNull)(this._model).restoreState(this._content,t,s);this._setActions(),n&&n.lines_limit_exceeded&&!this.readOnly()&&Promise.all([i.e(99752),i.e(59456),i.e(25535),i.e(70964),i.e(38817),i.e(466),i.e(64011),i.e(44740),i.e(90609)]).then(i.bind(i,79982)).then(({showLinetoolsLimitExceededDialog:e})=>{e(this)})}addCompareAsOverlay(e,t){const i=this.model();return(0,r.ensureDefined)(this._options.isSymbolAvailable)(e).then(r=>{if(!r)return null;const s=i.createStudyInserter({type:"java",studyId:"Overlay@tv-basicstudies"});return s.setForceOverlay(!0),s.setPreferredPriceScale("as-series"),s.setTargetPriceScaleMode({percentage:!0}),void 0!==t&&s.setPropertiesState({allowExtendTimeScale:t}),s.insert(async()=>({inputs:{symbol:e}}))})}scrollHelper(){return this._scrollHelper}setBroker(e){var t;this._brokerName=e,null===(t=this._lineToolsSynchronizer)||void 0===t||t.setBroker(e)}chartPainted(){return this._drawPlanned?(null===this._chartPaintedPromise&&(this._chartPaintedPromise=(0,l.createDeferredPromise)()),this._chartPaintedPromise.promise):Promise.resolve()}setDataWindowWidget(e){this._dataWindowWidget=e}removeDataWindowWidget(){this._dataWindowWidget=null}showSelectedSourcesProperties(){const e=(0,r.ensureNotNull)(this._model).selection().dataSources(),t=e.length;1===t?this.showSourceProperties(e[0]):t>0&&e.every(e=>(0,m.isLineTool)(e))&&this.showChartPropertiesForSources({sources:e})}async _showChartProperties(e,t,i,r){if(!this._model)return null;t&&((0,o.setValue)("properties_dialog.active_tab.chart",t),i.tabName=t);const s=await Ce(e,this._model,i,this._options.chartWidgetCollection,r);return(null==s?void 0:s.visible().value())?s:null}_createLineToolsSynchronizerIfNeeded(){this._lineToolsSynchronizer=new Z(this._layoutId,this._id,this.model().model(),this.readOnly()),null!==this._saveChartService&&this._lineToolsSynchronizer.setSaveChartService(this._saveChartService),this._lineToolsSynchronizer.setBroker(this._brokerName),(0,W.isFeatureEnabled)("remove_line_tools_from_content")&&(0,r.ensureNotNull)(this._lineToolsSynchronizer).invalidateAll()}_updateThemedColor(){const e=this.model().model(),t=e.backgroundColorAtYPercentFromTop(.5)
;let i=e.backgroundTopColor().value(),r=e.backgroundColor().value();const s=(0,k.isColorDark)(t),n=(0,k.isColorDark)(i),o=(0,k.isColorDark)(r);this.widget().classList.toggle("chart-widget--themed-dark",s),this.widget().classList.toggle("chart-widget--themed-light",!s),this.widget().classList.toggle("chart-widget__top--themed-dark",n),this.widget().classList.toggle("chart-widget__top--themed-light",!n),this.widget().classList.toggle("chart-widget__bottom--themed-dark",o),this.widget().classList.toggle("chart-widget__bottom--themed-light",!o),this._backgroundTopTheme.setValue(n?"dark":"light"),this._backgroundBasedTheme.setValue(s?"dark":"light"),this._backgroundBottomTheme.setValue(o?"dark":"light"),i===r&&(0,D.isStdThemedDefaultValue)("chartProperties.paneProperties.background",i,this._backgroundBasedTheme.value())&&(i=null,r=null);for(const e of this._paneWidgets)e.updateThemedColors(i,r)}_isLineToolModeExceptBrush(){const e=C.tool.value();return(0,m.isLineToolName)(e)&&!(0,m.isLineDrawnWithPressedButton)(e)&&!this.selectPointMode().value()}_cancelCreatingLine(){const e=(0,r.ensureNotNull)(this._model).model(),t=e.lineBeingCreated();if(null!==t){const i=(0,r.ensureNotNull)(e.paneForSource(t));(0,r.ensureNotNull)(this.paneByState(i)).cancelCreatingLineTool()}const i=e.crossHairSource().measurePane();if(null!==i){(0,r.ensureNotNull)(this.paneByState(i)).cancelMeasuring()}}_adjustSize(e){var t;let i=0;const r=null===this._model?null:this._model.model().priceScaleSlotsCount(),s=new Uint32Array(null===r?0:r.left),n=new Uint32Array(null===r?0:r.right),o=(0,w.getCanvasDevicePixelRatio)(document.body),a=(e,t)=>e+t,l=(e,t)=>{t.forEach((t,i)=>{e[i]=Math.max(e[i],t)})};for(const e of this._paneWidgets)if(!this._maximizedPaneWidget||this._maximizedPaneWidget===e){const t=e.leftPriceAxisesContainer().optimalWidths(),r=e.rightPriceAxisesContainer().optimalWidths();l(s,t),l(n,r),i+=e.stretchFactor()}let u=s.reduce(a,0),d=n.reduce(a,0);const h=this._width(),p=this._height();let _=Math.max(h-u-d,0);if(_<=102){u=0,d=0,_=h;for(let e=0;e<s.length;e++)s[e]=0;for(let e=0;e<n.length;e++)n[e]=0}for(const e of this._paneSeparators)e.adjustSize();const m=this._paneSeparators.length,f=P.height(),g=this.isMaximizedPane()?0:f*m,v=null!==this._timeAxisWidget?this._timeAxisWidget.optimalHeight():0;let S=p-v>=61?v:0;S%2&&(S+=1);const y=g+S,b=p<y?0:p-y,C=b/i;let T=0,x=!1;const I=null===(t=this._model)||void 0===t?void 0:t.model();for(let e=0;e<this._paneWidgets.length;++e){const t=this._paneWidgets[e];void 0!==I&&t.setState(I.panes()[e]);let i=0;if(this.isMaximizedPane())i=this._maximizedPaneWidget===t?b:0;else{let r=0;r=e===this._paneWidgets.length-1?Math.ceil((b-T)*o)/o:Math.round(t.stretchFactor()*C*o)/o,i=Math.max(r,2),T+=i}t.setPriceAxisSizes("left",i,s),t.setPriceAxisSizes("right",i,n),x=x||i!==t.height(),t.setSize(new w.Size(_,i)),I&&t.state()&&I.setPaneHeight(t.state(),i)}null!==this._timeAxisWidget&&this._timeAxisWidget.setSizes(new w.Size(_,S),s,n),I&&I.setWidth(_,e),this._controlBarNavigation&&this._controlBarNavigation.updatePosition(),
this._lhsAxesWidth!==u&&(this._lhsAxesWidth=u,this._lhsPriceAxisWidthChanged.fire(u)),this._rhsAxesWidth!==d&&(this._rhsAxesWidth=d,this._rhsPriceAxisWidthChanged.fire(d)),x&&c.emit("panes_height_changed")}_makePaneWidgetsAndSeparators(){const e=this.model().model().panes(),t=e.length,i=this._paneWidgets.length;for(let e=t;e<i;e++){(0,r.ensureDefined)(this._paneWidgets.pop()).destroy();const e=this._paneSeparators.pop();e&&e.destroy()}const s=this._options.containsData;for(let r=i;r<t;r++){const t={contextMenuEnabled:this._options.paneContextMenuEnabled,currencyConversionEnabled:this._options.currencyConversionEnabled,unitConversionEnabled:this._options.unitConversionEnabled,handleScale:this._options.handleScale,handleScroll:this._options.handleScroll,priceScaleContextMenuEnabled:this._options.priceScaleContextMenuEnabled,legendWidgetEnabled:this._options.legendWidgetEnabled,sourceStatusesWidgetEnabled:!s,sourceStatusesWidget:this._options.sourceStatusesWidget,marketStatusWidgetEnabled:this._options.marketStatusWidgetEnabled&&!s,chartWarningWidgetEnabled:this._options.chartWarningWidgetEnabled&&!s,chartWarningWidget:this._options.chartWarningWidget,dataProblemWidgetEnabled:this._options.dataProblemWidgetEnabled&&!s,legendWidget:this._options.legendWidget,propertyPagesEnabled:this._options.propertyPagesEnabled,sourceSelectionEnabled:this._options.sourceSelectionEnabled,controlsEnabled:this._options.paneControlsEnabled,croppedTickMarks:this._options.croppedTickMarks,countdownEnabled:this._options.countdownEnabled,customLegendWidgetFactories:new Map(this._customLegendWidgetsFactoryMap),useKineticScroll:this._options.useKineticScroll};void 0!==this._options.paneContextMenu&&(t.contextMenu=this._options.paneContextMenu),void 0!==this._options.priceScaleContextMenu&&(t.priceScaleContextMenu=this._options.priceScaleContextMenu);const i=new v.PaneWidget(this,e[r],t,this._paneWidgetsSharedState);if(this._paneWidgets.push(i),r>0){const e=new P(this,r-1,r);this._paneSeparators.push(e),this._timeAxisWidget?this._elMainTable.insertBefore(e.getElement(),this._timeAxisWidget.getElement()):this._elMainTable.appendChild(e.getElement())}this._timeAxisWidget?this._elMainTable.insertBefore(i.getElement(),this._timeAxisWidget.getElement()):this._elMainTable.appendChild(i.getElement())}for(let i=0;i<t;i++){const t=e[i],r=this._paneWidgets[i];r.hasState()&&r.state()===t?r.updatePriceAxisWidgets():r.setState(t)}for(let e=t;e--;)this._paneWidgets[e].updateControls();this._updateThemedColor()}_width(){return this._options.width.value()}_height(){return this._options.height.value()}_onMousewheel(e){if(!this.model().model().zoomEnabled()||null===this._mouseWheelHelper)return;if(!(0,a.onWidget)()&&parent&&parent!==window&&parent.IS_DEMO_PAGE)return;if(null===this._model)return;if(this.model().timeScale().isEmpty())return;const t=this._mouseWheelHelper.processWheel(e),i=t.deltaX,s=-t.deltaY;if(0!==i&&this._options.handleScroll.mouseWheel||0!==s&&this._options.handleScale.mouseWheel){if(e.cancelable&&e.preventDefault(),
0!==s&&this._options.handleScale.mouseWheel){const t=Math.sign(s)*Math.min(1,Math.abs(s)),i=(0,r.ensureNotNull)(this._mainDiv).getBoundingClientRect(),n=e.clientX-this._lhsAxesWidth-i.left;if(!Number.isFinite(n)||!Number.isFinite(t))return void xe.logWarn("Incorrect mouse wheel processing: scrollPosition: "+n+", zoomScale: "+t);const o=new T.EnvironmentState(e).control();this.model().model().zoomTime(n,t,!!o||void 0),this._onZoom.fire(o)}0!==i&&this._options.handleScroll.mouseWheel&&this.model().scrollChart(-80*i)}}_setElement(e){if(this._mainDiv){this._mainDiv.remove();const e=document.createRange();e.selectNodeContents((0,r.ensureNotNull)(this._parent)),e.deleteContents()}this._controlBarNavigation&&(this._controlBarNavigation.destroy(),this._controlBarNavigation=null),null!==this._removeMaximizeHotkey&&this._removeMaximizeHotkey(),this._removeMaximizeHotkey=this._initMaximizeHotkey(e);const t=e.ownerDocument,s=t.createElement("div");s.classList.add("chart-container-border"),e.insertBefore(s,e.firstChild),this._parent=s;const n=t.createElement("div");if(n.classList.add("chart-widget"),this._mainDiv=n,this._elTooltipDiv=t.createElement("div"),this._elTooltipDiv.className="tooltip-wrapper",this._mainDiv.appendChild(this._elTooltipDiv),this._elMainTable=t.createElement("table"),this._elMainTable.className="chart-markup-table",this._elMainTable.setAttribute("cellpading","0"),this._elMainTable.setAttribute("cellspacing","0"),this._mainDiv.appendChild(this._elMainTable),this._hotkeysListener&&this._hotkeysListener.destroy(),this._hotkeysListener=new ce.ChartHotkeysListener(this,this._mainDiv),(this._options.controlBarEnabled||(0,ue.enabled)("control_bar"))&&Promise.all([i.e(23876),i.e(43894),i.e(60700),i.e(47607),i.e(30209),i.e(20597),i.e(18078),i.e(89189),i.e(73935),i.e(1529),i.e(38676),i.e(52146),i.e(807),i.e(33289),i.e(25155),i.e(5093)]).then(i.bind(i,54940)).then(e=>{this._controlBarNavigation=new e.ControlBarNavigation(this,(0,r.ensureNotNull)(this._mainDiv),this._options.controlBar),this._model&&this._adjustSize()}),this._options.handleScale.mouseWheel||this._options.handleScroll.mouseWheel){this._mouseWheelHelper=new he.MouseWheelHelper;const e=this._onMousewheel.bind(this);this._onWheelBound=e,this._mainDiv.addEventListener("wheel",e,{passive:!1})}this.resize(),this._justActivated=!1,this.withModel(this,()=>{s.appendChild(n),n.addEventListener("mousedown",this._beginRequestActive.bind(this)),n.addEventListener("mouseup",this._endRequestActive.bind(this)),n.addEventListener("touchstart",this._beginRequestActive.bind(this)),n.addEventListener("touchmove",this._endRequestActive.bind(this)),n.addEventListener("touchend",this._endRequestActive.bind(this)),n.addEventListener("click",this._requestActive.bind(this))}),this._inited&&(null!==this._timeAxisWidget&&(this._timeAxisWidget.destroy(),this._timeAxisWidget=null),this._paneWidgets.forEach(e=>{e.destroy()}),this._paneWidgets.length=0,this._paneSeparators.forEach(e=>{e.destroy()}),this._paneSeparators.length=0,this._update(g.InvalidationMask.full()))}
_makeDefaultModel(){let e;if(this._content&&this._content.timeScale.points){const t=this._content.timeScale.points.items[0];e={startDate:t}}if(!(0,r.ensureNotNull)(this._metaInfoRepository).getInternalMetaInfoArray())throw new Error("Cannot create chart model: studies metainfo is absent");const t=()=>{this._drawPlanned=!1,this._drawRafId=0,this._inLoadingState||(this._invalidationMask&&(this._update(this._invalidationMask),this._invalidationMask=null),null!==this._chartPaintedPromise&&(this._chartPaintedPromise.resolve(),this._chartPaintedPromise=null))},i=()=>{const i={readOnly:this.readOnly(),isSnapshot:!!this._containsData,...(0,n.pickFields)(this._options,["timeScale","crossHair","esdEnabled","countdownEnabled","lastPriceAnimationEnabled","currencyConversionEnabled","unitConversionEnabled","watermarkEnabled","shiftVisibleRangeOnNewBar","hideIdeas","onWidget"])},s=function(e,t,i,r,s,n,o,a,l,c){const u=new _.ChartUndoModel(e,t,i,r,s,n,o,a,l,c);return u.model().fullUpdate(),u}(this._chartSession,e=>{if(!(e instanceof g.InvalidationMask))throw new Error("Invalid mask");null!==this._invalidationMask?this._invalidationMask.merge(e):this._invalidationMask=e,this._drawPlanned||(this._drawPlanned=!0,this._options.visible.when(()=>{const e=!document.hidden,i=this.screen&&this.screen.isShown();null!==this._timingsMeter&&e&&!i&&this._timingsMeter.startWaitingDraw();const s=(0,r.ensureNotNull)((0,r.ensureNotNull)(this._parent).ownerDocument.defaultView);this._drawRafId=s.requestAnimationFrame(t)}))},this.properties(),e,(0,r.ensureNotNull)(this._metaInfoRepository),this,this._options.undoHistory,this._options.barsMarksContainersFactory,i,this._collapsed);return this._createSessions(s.model()),this._createPrePostMarket(s.model()),s};(0,ue.enabled)("lean_chart_load")?this._model=this._model||i():this._model=i(),this._createVolumeIfNeeded();if(this._content){let e={};Te&&this._initialLoading&&(e={symbol:this._defSymbol,interval:this._defInterval,style:this._defStyle}),this.restoreState(this._content,this._containsData,e),Te&&this._defSymbol&&this.model().model().recalculatePriceRangeOnce()}else this._setActions();return this._createLineToolsSynchronizerIfNeeded(),(()=>{const e=(0,r.ensureNotNull)(this._model);e.onTagsChanged().subscribe(this,()=>this.onModelTagsChanged()),this._initBackgroundColor(),this._updateGui(),this._modelCreated.fire(e),this._tagsChanged.fire();const t=e.mainSeries(),i=t.properties().childs();this._defTimeframe&&t.setDefaultTimeframe(this._defTimeframe),e.lineCancelled().subscribe(this,()=>this.onLineCancelled()),t.dataEvents().symbolNotPermitted().subscribe(null,e=>{i.symbol.setValue(e)}),window.loginStateChange.subscribe(this,this._handleLoginStateChanged),this._handleLoginStateChanged(),t.dataEvents().symbolResolved().subscribe(this,e=>{const t=e.pro_name;t&&this._options.isSymbolAvailable&&this._options.isSymbolAvailable(t).then(e=>{e||i.symbol.setValue(window.DEFAULT_SYMBOL)})}),void 0!==this._options.requestFallbackSymbol&&t.dataEvents().symbolGroupNotPermitted().subscribe(this,e=>{(0,
r.ensureDefined)(this._options.requestFallbackSymbol)(i.symbol.value(),{type:"group_not_permitted",symbolGroup:e}).then(e=>{e&&i.symbol.setValue(e)})}),(0,r.ensureDefined)(t.onInReplayStateChanged).bind(t)().subscribe(this.screen,this.screen.show),i.style.unsubscribe(this,this._onChartStyleChanged),i.style.subscribe(this,this._onChartStyleChanged),t.dataEvents().completed().subscribe(this,()=>this._addPerfMark("SeriesCompleted"),!0),t.dataEvents().barReceived().subscribe(this,()=>this._addPerfMark("SeriesFirstDataReceived"),!0);const s=this._options;t.dataEvents().chartTypeNotPermitted().subscribe(null,()=>{i.interval.setValue("D"),s.muteSessionErrors||((0,Q.trackGoProFeature)("kagiRenko"),(0,ee.reloginOrGoPro)({feature:"kagiRenko"}))}),t.dataEvents().intradaySpreadNotPermitted().subscribe(null,()=>{i.interval.setValue("D"),s.muteSessionErrors||(0,ee.reloginOrGoPro)({feature:"intradaySpread"})}),t.dataEvents().customIntervalNotPermitted().subscribe(null,()=>{i.interval.setValue((0,_e.getDefaultResolution)((0,pe.isRangeStyle)(i.style.value()))),s.muteSessionErrors||(0,ee.reloginOrGoPro)({feature:"customIntervals"})}),t.dataEvents().secondsIntervalNotPermitted().subscribe(null,()=>{i.interval.setValue((0,_e.getDefaultResolution)((0,pe.isRangeStyle)(i.style.value()))),s.muteSessionErrors||(0,ee.reloginOrGoPro)({feature:"secondsIntervals",upgradeMessage:window.t("Upgrade now"),forceUpgradeBtn:!0})}),t.dataEvents().intradayExchangeNotPermitted().subscribe(null,()=>{if(i.interval.setValue("D"),!s.muteSessionErrors){let e=(0,r.ensureNotNull)(t.symbolInfo()).listed_exchange;window.ChartApiInstance.supportedExchangesList().forEach(t=>{t.value===e&&(e=t.name)}),(0,ee.reloginOrGoPro)({feature:"intradayExchange"})}}),t.requestingIntradayWhenNotSupported.subscribe(null,()=>{if(i.interval.setValue("D"),!s.muteSessionErrors){const e=window.t("Interval is not applicable"),t=document.createElement("div"),i=window.t("{p_start}Only {b_start}D, W, M{b_end} intervals are supported for this symbol/exchange. You will be automatically switched to a D interval. Intraday intervals are not available because of exchange policies.{p_end}").format({p_start:"<p>",p_end:"</p>",b_start:"<b>",b_end:"</b>"});t.innerHTML=i,(0,le.showNoticeDialog)({title:e,content:t})}}),t.requestingResolutionWhenNotSupported.subscribe(null,e=>t.setInterval(e)),t.requestingStyleIsNotSupported.subscribe(null,()=>{const i=t.interval(),r=e.model().defaultResolutions(),s=(0,pe.getLastUsedSingleValueBasedStyle)(),n=(0,_e.getResolutionByChartStyle)(s,i,r);t.setChartStyleWithIntervalIfNeeded(s,n)}),t.requestingStyleSupportRecovered.subscribe(null,i=>{const r=t.interval(),s=e.model().defaultResolutions(),n=(0,_e.getResolutionByChartStyle)(i,r,s);t.setChartStyleWithIntervalIfNeeded(i,n)})})()}_initBarsMarksSources(){this.withModel(this,()=>{for(const e of this.model().barsMarksSources())e.onNeedRepaint.subscribe(this,()=>this.model().model().lightUpdate())})}_handleLoginStateChanged(){(0,
ue.enabled)("popup_hints")&&window.user&&window.user.is_pro?this._noExchangeSubscrptionWarning=new ae(this):null!==this._noExchangeSubscrptionWarning&&(this._noExchangeSubscrptionWarning.destroy(),this._noExchangeSubscrptionWarning=null)}_subscribeToDrawingState(){if(this._options.readOnly)return;(0,C.init)();const e=(e,t)=>{if(null===this._model)return;const i=this._model.model();e.model!==i&&t(i,this._model)};C.createdLineTool.subscribe(null,t=>{e(t,(e,i)=>{const s=(0,r.ensureNotNull)(e.paneForSource(e.mainSeries()));let n,o=null;if(void 0===t.pointPositionPercents){if(o=Le(e,t.model,t.point.timeStamp),null===o)return;n=t.point.price}else{const i=t.pointPositionPercents.x*e.timeScale().width(),r=e.mainSeries().priceScale(),s=t.pointPositionPercents.y*r.height(),a=e.mainSeries().firstValue();if(null===a)return;o=e.timeScale().coordinateToIndex(i),n=r.coordinateToPrice(s,a)}const a={index:(0,r.ensureNotNull)(o),price:n},l=i.createLineTool(s,a,t.linetool,t.properties,t.linkKey,e.mainSeries(),!0);null!==l&&!Boolean(this.model().lineBeingCreated())&&t.finalState&&l.restoreExternalPoints(t.finalState,{indexesChanged:!0,pricesChanged:!0})})}),C.continuedLineTool.subscribe(null,t=>{e(t,(e,i)=>{var r;const s=Le(e,t.model,t.point.timeStamp);if(null===s)return;const n={index:s,price:t.point.price},o=e.lineBeingCreated();if(null===o)return;i.continueExternalLine(n,null!==(r=t.envState)&&void 0!==r?r:void 0,!!t.finalState)&&t.finalState&&o.restoreExternalPoints(t.finalState,{indexesChanged:!0,pricesChanged:!0})})}),C.cancelledLineTool.subscribe(null,t=>{e(t,(e,t)=>{e.cancelCreatingLine()})}),C.beenSetLineToolLastPoint.subscribe(null,t=>{e(t,(e,i)=>{const r=e.lineBeingCreated();if(null===r||r.linkKey().value()!==t.linkKey)return;const s=Le(e,t.model,t.point.timeStamp);if(null===s)return;const n={index:s,price:t.point.price};r.setLastPoint(n),r.updateAllViews(),e.lightUpdate()})}),C.startedMovingLineTool.subscribe(null,t=>{e(t,(e,i)=>{var r,s;const n=t.linkKeys.map(m.lineToolByLinkKey.bind(null,e)).filter(p.notNull);if(n.length){const i=Le(e,t.model,t.point.timeStamp);if(null===i)return;const o={index:i,price:t.point.price},a=null!==(r=t.activeItem)&&void 0!==r?r:null;e.startMovingSources(n,{logical:o},a,t.pointPositionPercents,null!==(s=t.envState)&&void 0!==s?s:void 0,!0)}})}),C.movedLineTool.subscribe(null,t=>{e(t,(e,i)=>{var r;if(!e.sourcesBeingMoved().filter(m.isLineTool).filter(e=>(e=>t.linkKeys.some(t=>e.linkKey().value()===t))(e)).length)return;const s=Le(e,t.model,t.point.timeStamp);if(null===s)return;const n={index:s,price:t.point.price};e.moveSources({logical:n},t.pointPositionPercents,null!==(r=t.envState)&&void 0!==r?r:void 0,!0)})}),C.finishedMovingLineTool.subscribe(null,t=>{e(t,(e,i)=>{const r=e.sourcesBeingMoved().filter(m.isLineTool);if(0===r.length)return;r.forEach(i=>{const r=(e=>{for(let i=0;i<t.linkKeys.length;i++)if(t.linkKeys[i]===e.linkKey().value())return{state:t.finalStates[i],changes:t.changes[i]};return null})(i);e.endMovingSources(null!==r,!0),null!==r&&(i.restoreExternalPoints(r.state,r.changes),
r.state.pointPositionPercents&&i.restorePositionPercents(r.state.pointPositionPercents))})})}),C.startedChangingLineTool.subscribe(null,t=>{e(t,(e,i)=>{var r;const s=(0,m.lineToolByLinkKey)(e,t.linkKey);if(null!==s){const i=s.getPoint(t.pointIndex),n=i?i.index:Le(e,t.model,t.point.timeStamp);if(null===n)return;if(s.isActualSymbol()&&s.isActualCurrency()&&s.isActualUnit()){const i={index:n,price:t.point.price};e.startChangingLinetool(s,i,t.pointIndex,null!==(r=t.envState)&&void 0!==r?r:void 0,!0)}}})}),C.changedLineTool.subscribe(null,t=>{e(t,(e,i)=>{const s=e.lineBeingEdited();if(null===s||s.linkKey().value()!==t.linkKey)return;let n=null;if(n=t.changes.indexesChanged?Le(e,t.model,t.point.timeStamp):(0,r.ensureNotNull)(e.linePointBeingChanged()).index,null!==n&&s.isActualSymbol()&&s.isActualCurrency()&&s.isActualUnit()){const i={index:n,price:t.point.price};e.changeLinePoint(i,void 0,!0)}})}),C.finishedChangingLineTool.subscribe(null,t=>{e(t,(e,i)=>{const r=(0,m.lineToolByLinkKey)(e,t.linkKey);null!==r&&r.isActualSymbol()&&r.isActualCurrency()&&r.isActualUnit()&&null!==e.lineBeingEdited()&&e.endChangingLinetool(!!t.finalState,!0),null!==r&&t.finalState&&r.restoreExternalPoints(t.finalState,t.changes)})}),C.removedLineTool.subscribe(null,t=>{e(t,(e,i)=>{const r=(0,m.lineToolByLinkKey)(e,t.linkKey),{withUndo:s}=t;if(null!==r)s?i.removeSource(r,!1):e.removeSource(r);else if(this._lineToolsSynchronizer){const{sourceTitle:e,linkKey:r,symbol:n,lineToolState:o}=t;i.removeUnloadedLineTool(this._lineToolsSynchronizer,e,r,n,o,s)}})}),C.finishedLineTool.subscribe(null,t=>{e(t,(e,i)=>{const r=(0,m.lineToolByLinkKey)(e,t.linkKey);null!==r&&(0,m.isLineDrawnWithPressedButton)(r.toolname)&&r.finish()})}),C.changedLineStyle.subscribe(null,t=>{e(t,(e,i)=>{const r=(0,m.lineToolByLinkKey)(e,t.linkKey);null!==r&&(r.restoreExternalState(t.state),r.propertiesChanged(!0))})}),C.restoredLineToolState.subscribe(null,t=>{e(t,(e,i)=>{const r=(0,m.lineToolByLinkKey)(e,t.linkKey);if(null!==r){const i={...t.state};i.indexes=t.state.points.map(i=>({index:Le(e,t.model,i.time_t),price:i.price})),e.restoreLineToolState(r,i)}})}),C.restoredLineTool.subscribe(null,t=>{e(t,(e,i)=>{e.restoreSource(t.state.restorePane,t.state.paneIndex,t.state.paneState,t.state.sourceState,null)})}),C.copiedLineTool.subscribe(null,t=>{e(t,(e,i)=>{const s=(0,r.ensureNotNull)(e.paneForSource(e.mainSeries()));let n;const o=(0,m.createLineToolProperties)(t.linetool,t.state,e);if(t.pointPositionPercents){const e={index:0,price:0};if(n=i.createLineTool(s,e,t.linetool,o,t.linkKey,void 0,!0),null===n)return;n.restorePositionPercents((0,r.ensureDefined)(t.pointPositionPercents))}else{const a=t.points.map(i=>({index:(0,r.ensureNotNull)(Le(e,t.model,i.timeStamp)),price:i.price})),l=a[0];if(n=i.createLineTool(s,l,t.linetool,o,t.linkKey,void 0,!0),null===n)return;if(e.lineBeingCreated())for(let e=1;e<a.length;e++)e!==a.length-1||!(0,m.isLineDrawnWithPressedButton)(t.linetool)&&"LineToolGhostFeed"!==t.linetool||n.finish(),
i.continueCreatingLine(a[e],new T.EnvironmentState(void 0),e<a.length-1,!0)}n.properties().interval.setValue(t.state.interval),n.restoreExternalState(t.state),n.restoreData&&n.restoreData(t),n.propertiesChanged(!0),t.finalState&&(n.calcIsActualSymbol(),n.restoreExternalPoints(t.finalState,{pricesChanged:!0,indexesChanged:!0}))})})}}},72674:(e,t,i)=>{"use strict";i.r(t),i.d(t,{applyIndicatorToAllChartsImpl:()=>I,applyIndicatorsToAllChartsImpl:()=>x,applyLineToolUpdateNotificationImpl:()=>D,chartsSymbolsImpl:()=>V,createClipboardHandler:()=>N,getAsyncStateForChartImpl:()=>A,getStateForChartImpl:()=>E,lineToolsAndGroupsDTOsImpl:()=>M,reloadAllLineTools:()=>B,resetLineToolsInvalidatedImpl:()=>k,setBrokerImpl:()=>O});var r=i(16282),s=i(20220),n=i(36270);class o extends n.UndoCommand{constructor(e,t){super(""),this._chartModel=e,this._targetIndex=t}redo(){const e=this._chartModel.createPane(this._targetIndex,void 0,this._paneId);this._paneId=e.id()}undo(){const e=(0,r.ensureDefined)(this._paneId),t=this._chartModel.panes().find(t=>t.id()===e);void 0!==t&&this._chartModel.removePane(t)}createdPaneId(){return this._paneId}}var a=i(87380),l=i(36170),c=i(3426);const u=(0,a.getLogger)("Clipboard");class d{constructor(e){this._e=e}write(e){return(0,c.writeImpl)(this._toRaw(e),this._e)}_toRaw(e){const t={files:[]};t.text=e.text,void 0!==e.app?t.html=this._serializeAppData(e.app,e.text):e.html&&(t.html=e.html);for(const i of e.files||[])t.files.push(i);return t}_serializeAppData(e,t){return`<meta charset="utf-8"><span data-tradingview-clip="${(0,l.htmlEscape)(e)}">${t?(0,l.htmlEscape)(t.slice(0,256)):"&#128200;"}</span>`}}class h{constructor(e){this._e=e}async read(){this._e&&0===this._e.eventPhase&&(u.logWarn("Cannot use an already dispatched ClipboardEvent for reading"),this._e=null);const e=this._e?this._readUsingEvent(this._e):await this._readUsingApi();return this._fromRaw(e)}_readUsingEvent(e){const t=(0,r.ensure)(e.clipboardData);e.preventDefault();const i={files:[]};for(let e=0;e<t.files.length;e++)i.files.push(t.files[e]);for(let e=0;e<t.items.length;e++){const r=t.items[e];"string"===r.kind&&("text/plain"===r.type?i.text=t.getData(r.type):"text/html"===r.type?i.html=t.getData(r.type):i.files.push(new Blob([t.getData(r.type)],{type:r.type})))}return i}async _readUsingApi(){if(!navigator.clipboard||!navigator.clipboard.read)throw new DOMException("ClipboardApi is not supported","NotSupportedError");let e,t;const i=[],r=await navigator.clipboard.read();for(const s of r)for(const r of s.types)"text/html"===r?e=s.getType(r).then(this._readBlobAsText):"text/plain"===r?t=s.getType(r).then(this._readBlobAsText):i.push(s.getType(r));return{text:await t,html:await e,files:await Promise.all(i)}}_fromRaw(e){const t={};if(void 0!==e.text&&(t.text=e.text),void 0!==e.html){const i=this._parseAppData(e.html);i?t.app=i:t.html=e.html}return e.files.length>0&&(t.files=e.files),t}_parseAppData(e){if(-1===e.slice(0,1024).indexOf("data-tradingview-clip"))return
;const t=(new DOMParser).parseFromString(e,"text/html").querySelector("[data-tradingview-clip]");return t?t.getAttribute("data-tradingview-clip")||"":void 0}_readBlobAsText(e){return new Promise((t,i)=>{const r=new FileReader;r.onloadend=()=>{t(r.result)},r.onerror=()=>{i(r.error)},r.readAsText(e)})}}var p=i(20887);function _(e){const t=e.target;return null!==t&&1===t.nodeType&&(0,p.isTextEditingField)(t)}function m(e){const t=e.target;if(null===t)return!1;const i=(t.ownerDocument||t).getSelection();return null!==i&&!i.isCollapsed}class f extends class{constructor(e){this._callbacks=Object.assign({},e),this._boundOnCopy=this._onCopyEv.bind(this),this._boundOnCut=this._onCutEv.bind(this),this._boundOnPaste=this._onPasteEv.bind(this)}listen(){document.addEventListener("copy",this._boundOnCopy),document.addEventListener("cut",this._boundOnCut),document.addEventListener("paste",this._boundOnPaste)}async peek(){if("granted"!==(await navigator.permissions.query({name:"clipboard-read"})).state)throw new Error("clipboard-read is not granted");return new h(null).read()}uiRequestCopy(e){this._callbacks.copyRequested&&this._callbacks.copyRequested(new d(null),e)}uiRequestCut(e){this._callbacks.cutRequested&&this._callbacks.cutRequested(new d(null),e)}uiRequestPaste(e){this._callbacks.pasteRequested&&this._callbacks.pasteRequested(new h(null),e)}destroy(){document.removeEventListener("copy",this._boundOnCopy),document.removeEventListener("cut",this._boundOnCut),document.removeEventListener("paste",this._boundOnPaste)}_onCopyEv(e){e.defaultPrevented||this._callbacks.copyRequested&&this._callbacks.copyRequested(new d(e))}_onCutEv(e){e.defaultPrevented||this._callbacks.cutRequested&&this._callbacks.cutRequested(new d(e))}_onPasteEv(e){e.defaultPrevented||this._callbacks.pasteRequested&&this._callbacks.pasteRequested(new h(e))}}{_onCopyEv(e){if(!_(e)&&!m(e))return super._onCopyEv(e)}_onCutEv(e){if(!_(e)&&!m(e))return super._onCutEv(e)}_onPasteEv(e){if(!_(e))return super._onPasteEv(e)}}var g=i(11877),v=i(74888),S=i(32719);function y(e){return{...e,panes:(t=e.panes,t.map(e=>{return{...e,sources:(t=e.sources,t.filter(e=>!(0,S.isLineToolName)(e.type)))};var t}))};var t}function b(e,t){var i;const r=e.find(e=>e.tools.includes(t));return null!==(i=null==r?void 0:r.id)&&void 0!==i?i:null}function w(e){var t,i;const s=e.panes.map(e=>e.sources.filter(e=>(0,S.isLineToolName)(e.type))).reduce((e,t)=>t.concat(e),[]),n=null!==(i=null===(t=e.lineToolsGroups)||void 0===t?void 0:t.groups)&&void 0!==i?i:[],o=new Map;s.forEach(e=>{const t=e.id;o.set(t,function(e,t){var i;return{id:e.id,symbol:e.state.symbol,ownerSource:(0,r.ensureDefined)(e.ownerSource),state:e,groupId:null!==(i=b(t,e.id))&&void 0!==i?i:void 0}}(e,n))});const a=new Map;return n.forEach(e=>{const t=function(e,t){var i,r;if(0===e.tools.length)return null;const s=e.tools[0];return null!==(r=null===(i=t.get(s))||void 0===i?void 0:i.symbol)&&void 0!==r?r:null}(e,o);null!==t&&a.set(e.id,{id:e.id,name:e.name,symbol:t})}),{sources:o,groups:a}}var P=i(98006),C=i(83291);const T=(0,
s.t)("Please give us a clipboard writing permission in your browser or press {keystroke}");function x(e,t){const i=t.model().model().studyTemplate();e.undoHistory.beginUndoMacro("Apply Indicators to Entire Layout");for(let r=0;r<e.chartWidgetsDefs.length;r++){const s=e.chartWidgetsDefs[r].chartWidget;s!==t&&(s.hasModel()&&s.model().applyStudyTemplate(i,""))}e.undoHistory.endUndoMacro()}function I(e,t,i,s,n){e.undoHistory.beginUndoMacro(n);for(let a=0;a<e.chartWidgetsDefs.length;a++){const l=e.chartWidgetsDefs[a].chartWidget;if(l!==t&&l.hasModel()){const t=l.model();let a;if(s.isOnMainPane)a=(0,r.ensureNotNull)(t.model().paneForSource(l.model().model().mainSeries()));else{const i=new o(t.model(),s.paneIndex);e.undoHistory.pushUndoCommand(i);const n=(0,r.ensureDefined)(i.createdPaneId());a=(0,r.ensureDefined)(t.model().panes().find(e=>e.id()===n))}const c=t.pasteSourceFromClip(a,i,!0);if(c&&1===c.length){const e=c[0];if(s.asCompare){const i=(0,r.ensureNotNull)(t.mainSeries().priceScale());t.moveToScale(e,(0,r.ensureDefined)(a),i,n),t.setPriceScaleMode({percentage:!0},i,"")}}t.model().lightUpdate()}}e.undoHistory.endUndoMacro()}function L(e){let t=1;for(;e.has(""+t);)t++;return""+t}function M(e){const t=new Map,i=e.chartsCountToSave(),r=new Set;for(let s=0;s<i;s++)if(s<e.chartWidgetsDefs.length){const i=e.chartWidgetsDefs[s].chartWidget,n=i.id(),o=i.lineToolsAndGroupsDTO();t.set(n,o),r.add(n)}else{const i=e.savedChartWidgetOptions[s-e.chartWidgetsDefs.length].content;i.chartId||(i.chartId=L(r)),t.set(i.chartId,w(i)),r.add(i.chartId)}return t}function E(e,t,i,r,s,n){if(t<e.chartWidgetsDefs.length){const o=e.chartWidgetsDefs[t].chartWidget;return t<e.actualLayoutCount()||o.shouldBeSavedEvenIfHidden()?o.state(i,r,s,n):null}return function(e,t,i,r,s){return s&&(0,P.isFeatureEnabled)("migrate_unloaded_charts")?y(e):e}(e.savedChartWidgetOptions[t-e.chartWidgetsDefs.length].content,0,0,0,n)}function A(e,t){return t<e.chartWidgetsDefs.length?e.chartWidgetsDefs[t].chartWidget.asyncState():Promise.resolve({})}function k(e,t,i){const r=e.chartsCountToSave();for(let s=0;s<r;s++)if(s<e.chartWidgetsDefs.length){const r=e.chartWidgetsDefs[s].chartWidget,n=r.id(),o=i.get(n);r.resetLineToolsInvalidated(t,o)}else{{const t=y(e.savedChartWidgetOptions[s-e.chartWidgetsDefs.length].content);e.savedChartWidgetOptions[s-e.chartWidgetsDefs.length].content=t}}}function D(e,t,i){var r;null===(r=e.map(e=>e.chartWidget).find(e=>e.id()===t))||void 0===r||r.applyLineToolUpdateNotification(i)}function R(e){return e instanceof Error?e.message:null}function N(e){return new f({copyRequested:(t,i)=>{e.activeChartWidget.value().model().clipboardCopy(t,i).catch(t=>{var i;null===(i=e.toastsFactory)||void 0===i||i.getChartToasts().then(e=>{var i;(0,r.ensureNotNull)(e).showSimpleToast({title:(0,s.t)("Couldn't copy"),text:null!==(i=R(t))&&void 0!==i?i:T.format({keystroke:(0,g.humanReadableHash)(g.Modifiers.Mod+67)}),role:"alert",intent:v.ToastIntent.Warning})})})},cutRequested:(t,i)=>{e.activeChartWidget.value().model().clipboardCut(t,i).catch(t=>{var i
;null===(i=e.toastsFactory)||void 0===i||i.getChartToasts().then(e=>{var i;(0,r.ensureNotNull)(e).showSimpleToast({title:window.t("Couldn't cut"),text:null!==(i=R(t))&&void 0!==i?i:T.format({keystroke:(0,g.humanReadableHash)(g.Modifiers.Mod+88)}),role:"alert",intent:v.ToastIntent.Warning})})})},pasteRequested:(t,i)=>{(i?i.model().undoModel():e.activeChartWidget.value().model()).clipboardPaste(t,i).catch(t=>{var i;null===(i=e.toastsFactory)||void 0===i||i.getChartToasts().then(e=>{var i;(0,r.ensureNotNull)(e).showSimpleToast({title:window.t("Couldn't paste"),text:null!==(i=R(t))&&void 0!==i?i:T.format({keystroke:(0,g.humanReadableHash)(g.Modifiers.Mod+86)}),role:"alert",intent:v.ToastIntent.Warning})})})}})}function O(e,t){(0,C.setBroker)(t),e.chartWidgetsDefs.forEach(e=>{var i;return null===(i=e.chartWidget)||void 0===i?void 0:i.setBroker(t)})}function V(e){const t={};return e.chartWidgetsDefs.map(e=>e.chartWidget).forEach(e=>t[e.id()]=function(e){var t,i;const r={},s=e.model().mainSeries(),n=s.properties().childs(),o=s.symbolInfo();r.resolution=n.interval.value(),r.symbol_type=null!==o&&o.type||"",r.exchange=null!==o&&o.exchange||"",r.listed_exchange=null!==o&&o.listed_exchange||"";const a=null!==(t=null==o?void 0:o.legs)&&void 0!==t?t:[];if(null!==o&&s.isSpread()){const e=a[0];let t=o.base_name[0];t=t.split(":")[1],r.symbol=e,r.short_name=t,r.expression=o.full_name}else r.symbol=null!==o&&o.ticker||n.symbol.value(),r.short_name=n.shortName.value();const l=null!==(i=null==o?void 0:o.base_name)&&void 0!==i?i:[];return r.legs=a.map((e,t)=>({symbol:e,pro_symbol:l[t]})),r}(e)),t}function B(e){e.chartWidgetsDefs.map(e=>e.chartWidget).forEach(e=>e.reloadAllLineTools())}},39304:(e,t,i)=>{"use strict";i.d(t,{CHART_FONT_FAMILY:()=>s});var r=i(40142);const s=((0,r.isOnMobileAppPage)("old"),"'Trebuchet MS', Roboto, Ubuntu, sans-serif")},73038:(e,t,i)=>{"use strict";var r=i(96276);i(59621);var s=i(20220).t,n=i(16282),o=n.assert,a=n.ensureDefined,l=i(4543).moveToHead,c=i(81319).TimeAxisWidget,u=i(47658).Series,d=i(22842),h=i(26377).ActionBinder,p=i(42098),_=p.getValue,m=p.setValue,f=i(46926).TabNames,g=i(47107).showGoToDateDialog,v=i(11877),S=i(26083),y=i(42335).showConfirmInputsDialog,b=i(14900).disableSelection,w=i(5991).ChartEventsSource,P=i(44560).Version,C=i(14764).showDeleteStudyTreeConfirm,T=i(89537).AvailableOnTVPopup,x=i(88674).showNoticeDialog,I=i(3898).InsertionErrorCode,L=i(79407).showConfirm,M=i(60470).confirmDatasourceRemoving;const E=i(70541).showFinancialsDialog
;var A=i(98006).isFeatureEnabled,k=i(14127).Study,D=i(97133).StudyStub,R=i(55304).isStudy,N=i(73371).LineDataSource,O=i(87048),V=O.isLineTool,B=O.isStudyLineTool,F=i(54281),W=F.Action,U=F.Separator,H=i(27393).ToolboxType,z=i(14397),j=i(2459).Interval,Y=i(20554),G=Y.getDefaultStyle,q=Y.hasVolume,X=i(55034).showSymbolInfoDialog,$=i(94420).InvalidationMask,K=i(94420).InvalidationLevel,J=i(52946).linking,Z=i(21331).showChangeIntervalDialogAsync,Q=i(99219).showDetailsDialog,ee=i(10786).isMobile,te=i(71073).getTracker,ie=i(60185).WatchlistWithSubmenuAction,re=i(70955),se=re.activateKeyPressHandler,ne=re.showDialog,oe=i(1771).DefaultProperty,ae=i(30029),le=ae.availableTimezones,ce=ae.timezoneIsAvailable,ue=i(91288).ChartSession,de=i(84234),he=i(80238).Spinner,pe=i(29098).trackEvent,_e=i(748).lastEventIsTouch,me=i(81890).LoadingScreen,fe=i(68981),ge=i(87380).getLogger("ChartWidget",{color:"#606"}),ve=i(11585).appendEllipsis,Se=i(52994).StudyMetaInfoRepository,ye=i(86913).isMultipleLayout,be=i(5013).addPerfMark,we=i(88001),Pe=i(37560).ChartWidgetBase,Ce=i(68724).CheckMobile.any(),Te=i(25143).TIMEFRAMETYPE,xe=i(57137).createDeferredPromise,Ie=i(23939).addPlusButtonProperty,Le=s("On The Left"),Me=s("On The Right"),Ee=s("Move Scale To Left"),Ae=s("Move Scale To Right"),ke=!A("remove_scale_settings_from_menu");class De extends Pe{constructor(e,t,i){super(e,t,i),this._options.timeScaleWidget&&(this._options.timeScaleWidget.pressedMouseMoveScale=this._options.handleScale.axisPressedMouseMove.time);var s=this;this._startSpinner(this._options.container.value());var n=this._options.content,o=this._options.readOnly;this._removeMaximizeHotkey=null,s._hotkeys=S.createGroup({desc:"Chart actions",isDisabled:function(){return!s._isActive}});var a=this._options.containsData,l=this._options.onWidget,c=this._options.onCmeWidget;c&&ge.logWarn("[ChartWidget] 'onCmeWidget' option is depricated");var u=this._options.widgetCustomer,d=this._options.timezone,h=this._options.hideSymbolSearch,p=this._options.defSymbol,_=j.isValid(this._options.defInterval)?this._options.defInterval:void 0,m=parseInt(this._options.defStyle),f=Y.isValidStyle(m)?m:void 0,g=this._options.defSessionId,v=void 0!==this._options.defTimeframe?{value:this._options.defTimeframe.toUpperCase(),type:Te.PeriodBack}:void 0;this._chartWidgetCollection=this._options.chartWidgetCollection,this._content=n,this._initialLoading=this._options.initialLoading,this._readOnly=o,this._containsData=a,this._showChartEvents=!a&&this._options.chartEventsEnabled,this._defSymbol=p,this._defInterval=_,this._defTimeframe=v,this._defStyle=f,this._onWidget=!!l,this._compareSymbols=this._options.compareSymbols,this._onWidget&&(c?this._widgetCustomer="cme":u&&(this._widgetCustomer=u)),this._hideSymbolSearch=h,this._frameTime=30,this._model=null,this._metaInfo={},this._drawRafId=0,this._compareDialog=this._chartWidgetCollection.getCompareDialogRenderer();var y=this._contentSeriesProperties();y&&(p=y.symbol,_=y.interval),
void 0===this._options.useUserChartPreferences&&(this._options.useUserChartPreferences=!0),this._properties=new oe("chartproperties",void 0,void 0,this._options.useUserChartPreferences);var b=this._options.useUserChartPreferences?fe.defaults("chartproperties.mainSeriesProperties"):fe.factoryDefaults("chartproperties.mainSeriesProperties");this._properties.mainSeriesProperties.merge(b),this._properties.mainSeriesProperties.hasChild("esdBreaksStyle")&&this._properties.mainSeriesProperties.removeProperty("esdBreaksStyle"),_=_||b.interval||"D",Y.isValidStyle(f)||(f=Y.isValidStyle(b.style)?b.style:G(j.isRange(_))),this._properties.mainSeriesProperties.merge({visible:!0,symbol:p||DEFAULT_SYMBOL,shortName:"",timeframe:"",onWidget:this._onWidget,interval:_,currencyId:null,unitId:null,style:f,sessionId:g,lineStyle:{styleType:fe.factoryDefaults("chartproperties.mainSeriesProperties.lineStyle.styleType")}}),this._containsData&&this._properties.mainSeriesProperties.merge({showCountdown:!1}),d&&ce(d)&&this._properties.timezone.setValue(d),this._tagsChanged=new r,this._disconnected=new r,this._reconnectBailout=new r,this._connected=new r,this._onScroll=new r,this.chartWidgetInitialized=new r,this._chartSession=new ue(ChartApiInstance),this._metaInfoRepository=new Se(this._chartSession),this._timingsMeter=null,this._isActive=this._options.isActive,this._options.container.subscribe((function(e){s._setElement(e)}),{callWithLast:!0});var w=function(){s.resize()};this._options.width.subscribe(w),this._options.height.subscribe(w),this._options.visible.subscribe(this._updateTimingsMeterState.bind(this)),this._aboutToBeDestroyed=new r,this._actions=null,this._definitionsViewModel=null,this._backgroundTopColorSpawn=null,this._backgroundBottomColorSpawn=null,this._hintDefferedPromise=null,this._activeHint=null}isInitialized(){return Boolean(this._inited)}compareSymbols(){return this._compareSymbols}async _getChartPropertyDefinitionsViewModel(){if(null===this._definitionsViewModel){const{ChartPropertyDefinitionsViewModel:e}=await Promise.all([i.e(60006),i.e(71667),i.e(83596)]).then(i.bind(i,36831));if(this._isDestroyed)throw new Error("Chart widget already destroyed");await new Promise(e=>this.withModel(null,e)),null===this._definitionsViewModel&&(this._definitionsViewModel=new e(this.model(),this.properties(),this._options))}return this._definitionsViewModel}_initMaximizeHotkey(e){var t=this;function i(e){e.defaultPrevented||v.modifiersFromEvent(e)===v.Modifiers.Alt&&e.stopPropagation()}function r(e){e.defaultPrevented||v.modifiersFromEvent(e)===v.Modifiers.Alt&&(e.preventDefault(),e.stopPropagation(),t.toggleFullscreen())}return e.addEventListener("mousedown",i,!0),e.addEventListener("click",r,!0),function(){e.removeEventListener("mousedown",i,!0),e.removeEventListener("click",r,!0)}}toggleFullscreen(){var e=this.getResizerDetacher();e.fullscreenable.value()&&(e.fullscreen.value()?e.exitFullscreen():e.requestFullscreen())}_beginRequestActive(){var e=this._chartWidgetCollection.activeChartWidget.value()!==this
;this._chartWidgetCollection.activeChartWidget.setValue(this),e&&(_e()&&this._isLineToolModeExceptBrush()&&this.updateCrossHairPositionIfNeeded(),this._justActivated=!0)}_endRequestActive(){var e=this;this._justActivated&&setTimeout((function(){e._justActivated=!1}),0)}_requestActive(){this._beginRequestActive(),this._endRequestActive()}justActivated(){return this._justActivated}setTimezone(e){e&&ce(e)?this._properties.timezone.setValue(e):console.warn("Incorrect timezone: "+JSON.stringify(e))}getTimezone(){return this._properties.timezone.value()}refreshMarks(){this.model().barsMarksSources().forEach((function(e){e.refreshData()}))}clearMarks(){this.model().barsMarksSources().forEach((function(e){e.clearMarks()}))}metaInfoRepository(){return this._metaInfoRepository}_init(){var e=this;this.hasModel()&&this.model().mainSeries().clearData(),this.initColors(),this._makeDefaultGui();var t=function(){e._checkObsoleteTimezone(),e._chartSession&&e._chartSession.connected()&&this._model.restart(),this._content&&(this.initColors(),this._updateGui(),this.update()),this._resizeHandler=function(){this._adjustSize(),this.paint()}.bind(this),this._resizeHandler(),this._parent.appendChild(this._mainDiv),this._spinner&&(this._spinner.stop(),delete this._spinner),this._keydownEventListener=function(e){27===e.which&&e.preventDefault()},window.addEventListener("keydown:chart_"+this._id,this._keydownEventListener),this._initBarsMarksSources(),this._showChartEvents&&this._createChartEventsSource(),this._activateSymbolSearchHotkeys(),this.model().timeScale().onScroll().subscribe(this,(function(){this._onScroll.fire()})),this._inited=!0}.bind(this),i=this._makeDefaultModel();void 0===i?t():i.then(t)}_activateSymbolSearchHotkeys(){this.readOnly()||this._hideSymbolSearch||se()}_checkObsoleteTimezone(){var e=this._properties.timezone.value();ce(e)||this._properties.timezone.setValue({UTC:"Etc/UTC",EST:"America/New_York",CST:"America/Chicago",PST:"America/Los_Angeles"}[e]||"exchange")}initColors(){this._properties.scalesProperties.lineColor.listeners().subscribe(this,De.prototype.setScaleLineColor),this._properties.scalesProperties.textColor.listeners().subscribe(this,De.prototype.setScaleTextColor)}_initBackgroundColor(){null===this._backgroundTopColorSpawn&&(this._backgroundTopColorSpawn=this._model.model().backgroundTopColor().spawn(),this._backgroundTopColorSpawn.subscribe(this._onBackgroundColorChanged.bind(this))),null===this._backgroundBottomColorSpawn&&(this._backgroundBottomColorSpawn=this._model.model().backgroundColor().spawn(),this._backgroundBottomColorSpawn.subscribe(this._onBackgroundColorChanged.bind(this)))}paneWidgets(){return this._paneWidgets}paneByCanvas(e){for(var t=0;t<this._paneWidgets.length;t++)if(this._paneWidgets[t].hasCanvas(e))return this._paneWidgets[t];return null}paneByState(e){for(var t=0;t<this._paneWidgets.length;t++)if(this._paneWidgets[t].state()===e)return this._paneWidgets[t];return null}timeAxisByCanvas(e){return this._timeAxisWidget.hasCanvas(e)?this._timeAxisWidget:null}properties(){
return this._properties}emulateCriticalError(){this._chartSession.removeSeries("-1")}readOnly(){return this._readOnly}onDisconnected(){return this._disconnected}onReconnectBailout(){return this._reconnectBailout}onConnected(){return this._connected}onRedraw(){return this._redraw}onScroll(){return this._onScroll}modelCreated(){return this._modelCreated}setResolution(e){if(this._model){var t=this._model.mainSeries().properties(),i=s("Change Resolution");this._model.setResolutionProperty(t.interval,e,this,i)}else this._properties.mainSeriesProperties.merge({interval:e})}getResolution(){return this._model?this._model.mainSeries().properties().interval.value():this._properties.mainSeriesProperties.interval.value()}addOverlayStudy(e,t,i){var r=this.model();return this._options.isSymbolAvailable(e).then((function(s){if(!s)return null;var n=r.createStudyInserter({type:"java",studyId:"Overlay@tv-basicstudies"}),o={allowExtendTimeScale:i};if(d.enabled("use_overrides_for_overlay")){var a=fe.factoryDefaults("study_Overlay@tv-basicstudies.style");o.style=a}return n.setPropertiesState(o),n.setForceOverlay(t),n.insert((function(){return Promise.resolve({inputs:{symbol:e}})}))}))}addCompareStudy(e){var t=this.model();return this._options.isSymbolAvailable(e).then((function(i){return i?t.createStudyInserter({type:"java",studyId:"Compare@tv-basicstudies"}).insert((function(){return Promise.resolve({inputs:{symbol:e}})})):null}))}updateActions(){for(var e=this,t=this.actions(),r=this._model.dataSources(),n=!1,o=!1,a=0,l=r.length;a<l;a++){var c=r[a];TradingView.isInherited(c.constructor,N)&&c.isUserDeletable()&&(n=!0),TradingView.isInherited(c.constructor,k)&&c.removeByRemoveAllStudies()&&(o=!0),TradingView.isInherited(c.constructor,D)&&(o=!0)}this._readOnly||(t.paneRemoveAllStudies&&t.paneRemoveAllStudies.update({disabled:!o}),t.paneRemoveAllDrawingTools&&t.paneRemoveAllDrawingTools.update({disabled:!n}),t.paneRemoveAllStudiesDrawingTools&&t.paneRemoveAllStudiesDrawingTools.update({disabled:!o&&!n})),Promise.all([i.e(83767).then(i.bind(i,34698)),i.e(83767).then(i.bind(i,2070))]).then(([i,r])=>{const n=n=>{var o=[],a=i.getStdThemeNames(),l=i.getCurrentTheme().name;if(a.forEach(t=>{var r=new W({name:"theme-switch-to-"+t,label:TradingView.clean(i.translateStdThemeName(t)),checkable:!0,checked:l===t,onExecute:r=>{r.update({checked:!0}),i.loadTheme(t,!0,!1,e._chartWidgetCollection).then(()=>{this.readOnly()||window.saver.saveChartSilently(),pe("GUI","Themes","Switch to "+t+" theme")})}});o.push(r)}),o.sort((function(e,t){return e.getLabel()>t.getLabel()?-1:1})),window.is_authenticated){o.push(new U);var c=new W({name:"theme-save-as",label:ve(s("Save As")),onExecute:function(){r.showThemeSaveDialogAsync(e._model.model().theme())}});o.push(c)}n&&n.length&&window.is_authenticated&&(o.push(new U),n.forEach((function(t,s){var n=new W({label:TradingView.clean(i.translateStdThemeName(t)),checkable:!1,onExecute:function(r){i.loadTheme(t,!1,!1,e._chartWidgetCollection).then((function(){window.saver.saveChartSilently(),
pe("GUI","Switch to custom theme")}))},toolbox:{type:H.Delete,action:function(){r.showRemoveThemeDialogAsync(t)}},showToolboxOnHover:!0});o.push(n)}))),t.applyColorTheme.update({subItems:o})};window.is_authenticated?i.getThemeNames().then(n):n()});var u=this,d=[],h=function(e){return e.id===u.model().model().properties().timezone.value()};le.forEach((function(e){if(!e.separator){var t=new W({label:e.title,checkable:!0,checked:h(e),statName:"SetTimeZone",onExecute:function(){u.model().setProperty(u.model().model().properties().timezone,e.id,"Changed Time Zone")}});d.push(t)}}),this),t.applyTimeZone.update({subItems:d}),t.addToWatchlist&&(t.addToWatchlist.request(),t.addToWatchlist.updateLabel(this.getSymbol(!0))),t.addToTextNotes&&t.addToTextNotes.update({label:s("Add Text Note for {symbol}").format({symbol:this.getSymbol(!0)})}),t.moveChartAction&&t.moveChartAction.update({disabled:!this._chartWidgetCollection.activeChartCanBeMoved()})}applyTheme(e){var t=this;i.e(83767).then(i.bind(i,34698)).then(i=>{e=e||i.getCurrentTheme().name,i.loadTheme(e,!0,!0,t._chartWidgetCollection)})}actions(){return null===this._actions&&this._setActions(),this._actions}_setActions(){this._actions&&this._actions.addToWatchlist&&(this._actions.addToWatchlist.destroy(),delete this._actions.addToWatchlist);var e,t=this,r=[];if(!this._readOnly){r=[new W({label:s("Eraser"),payload:"eraser",statName:"Eraser"}),new U,new W({label:s("Trend Line"),payload:"LineToolTrendLine",statName:"LineToolTrendLine"}),new W({label:s("Horizontal Line"),payload:"LineToolHorzLine",statName:"LineToolHorzLine"}),new W({label:s("Vertical Line"),payload:"LineToolVertLine",statName:"LineToolVertLine"}),new W({label:s("Arrow"),payload:"LineToolArrow",statName:"LineToolArrow"}),new W({label:s("Ray"),payload:"LineToolRay",statName:"LineToolRay"}),new W({label:s("Extended"),payload:"LineToolExtended",statName:"LineToolExtended"}),new W({label:s("Parallel Channel"),payload:"LineToolParallelChannel",statName:"LineToolParallelChannel"}),new U,new W({label:s("Pitchfork"),payload:"LineToolPitchfork",statName:"LineToolPitchfork"}),new W({label:s("Schiff Pitchfork"),payload:"LineToolSchiffPitchfork",statName:"LineToolSchiffPitchfork"}),new W({label:s("Pitchfan"),payload:"LineToolPitchfan",statName:"LineToolPitchfan"}),new W({label:s("Gann Square"),payload:"LineToolGannSquare",statName:"LineToolGannSquare"}),new W({label:s("Gann Fan"),payload:"LineToolGannFan",statName:"LineToolGannFan"}),new W({label:s("Fib Retracement"),payload:"LineToolFibRetracement",statName:"LineToolFibRetracement"}),new W({label:s("Trend-Based Fib Extension"),payload:"LineToolTrendBasedFibExtension",statName:"LineToolTrendBasedFibExtension"}),new W({label:s("Fib Speed Resistance Fan"),payload:"LineToolFibSpeedResistanceFan",statName:"LineToolFibSpeedResistanceFan"}),new W({label:s("Fib Time Zone"),payload:"LineToolFibTimeZone",statName:"LineToolFibTimeZone"}),new W({label:s("Circle Lines"),payload:"LineToolCircleLines",statName:"LineToolCircleLines"}),new W({label:s("Fib Circles"),
payload:"LineToolFibCircles",statName:"LineToolFibCircles"}),new W({label:s("Fib Speed Resistance Arcs"),payload:"LineToolFibSpeedResistanceArcs",statName:"LineToolFibSpeedResistanceArcs"}),new U,new W({label:s("Rectangle"),payload:"LineToolRectangle",statName:"LineToolRectangle"}),new W({label:s("Ellipse"),payload:"LineToolEllipse",statName:"LineToolEllipse"}),new W({label:s("Triangle"),payload:"LineToolTriangle",statName:"LineToolTriangle"}),new W({label:s("Polyline"),payload:"LineToolPolyline",statName:"LineToolPolyline"}),new W({label:s("Path"),payload:"LineToolPath",statName:"LineToolPath"}),new W({label:s("Arc"),payload:"LineToolArc",statName:"LineToolArc"}),new U,new W({label:s("Text",{context:"tool"}),payload:"LineToolText",statName:"LineToolText"}),new W({label:s("Anchored Text"),payload:"LineToolTextAbsolute",statName:"LineToolTextAbsolute"}),new W({label:s("Balloon"),payload:"LineToolBalloon",statName:"LineToolBalloon"}),new W({label:s("Price Label"),payload:"LineToolPriceLabel",statName:"LineToolPriceLabel"}),new U,new W({label:s("Elliott Wave Subminuette"),payload:"LineToolElliottSubminuette",statName:"LineToolElliottSubminuette"}),new W({label:s("Elliott Wave Minor"),payload:"LineToolElliottMinor",statName:"LineToolElliottMinor"}),new W({label:s("Elliott Wave Circle"),payload:"LineToolElliottCircle",statName:"LineToolElliottCircle"}),new W({label:s("Elliott Minor Retracement"),payload:"LineToolElliottMinorRetr",statName:"LineToolElliottMinorRetr"}),new W({label:s("Elliott Major Retracement"),payload:"LineToolElliottMajorRetr",statName:"LineToolElliottMajorRetr"}),new U,new W({label:s("Brush"),payload:"LineToolBrush",statName:"LineToolBrush"}),new U,new W({label:s("Forecast"),payload:"LineToolPrediction",statName:"LineToolPrediction"})];for(var n=function(e){z.tool.setValue(e.getPayload())},o=0;o<r.length;o++)r[o]instanceof W&&r[o].update({onExecute:n});ke&&(e=new W({label:ve(s("Settings")),icon:i(99673),statName:"ScalesProperties",onExecute:function(){t.showGeneralChartProperties(f.scales)}}))}this._hotkeys.add({desc:"Maximize",hotkey:S.Modifiers.Alt+13,handler:function(){t.toggleFullscreen()},isDisabled:function(){return!t._options.fullscreenable.value()}}),this._hotkeys.add({desc:"Cancel selection",hotkey:27,handler:function(){t.selectPointMode().value()?t.cancelRequestSelectPoint():t._model.selectionMacro((function(e){t._cancelCreatingLine(),e.clearSelection()}))},isDisabled:function(){var e=0===t._model.selection().allSources().length,i=null===t._model.crossHairSource().measurePane(),r=!t.selectPointMode().value(),s=e&&i&&r;return!t._model||s}}),t.withModel(null,(function(){var e=function(){t._hotkeys.promote()};t._model.onSelectedSourceChanged().subscribe(null,e),t._model.crossHairSource().measuringEnabled().subscribe(null,t=>{t&&e()})}));var a=new W({label:s("Reset Chart"),icon:i(77624),statName:"ResetChart",onExecute:this.GUIResetScales.bind(this),hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+82}),l=new W({label:s("Invert Scale"),statName:"Invert Scale",checkable:!0,onExecute:function(){
t._model.invertPriceScale(t._model.mainSeries().priceScale())},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+73}),c=new W({label:s("Auto (Fits Data To Screen)"),checkable:!0,onExecute:function(){var e=t._model.mainSeries().priceScale();t._model.togglePriceScaleAutoScaleMode(e),c.update({checked:e.isAutoScale()})}}),u=new W({label:s("Lock Price To Bar Ratio"),checkable:!0,statName:"ToggleLockScale",onExecute:function(){t._model.togglePriceScaleLockScaleMode(t._model.mainSeries().priceScale())}}),p=new W({label:s("Regular"),checkable:!0,statName:"ToggleRegularScale",onExecute:function(){var e=t._model.mainSeries().priceScale();t._model.setPriceScaleRegularScaleMode(e),p.update({checked:e.isRegular()})}}),y=new W({label:s("Percent"),checkable:!0,statName:"TogglePercantage",onExecute:function(){t._model.togglePriceScalePercentageScaleMode(t._model.mainSeries().priceScale())},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+80}),b=new W({label:s("Indexed to 100"),checkable:!0,statName:"ToggleIndexedTo100",onExecute:function(){t._model.togglePriceScaleIndexedTo100ScaleMode(t._model.mainSeries().priceScale())}}),w=new W({label:s("Logarithmic"),statName:"ToggleLogScale",checkable:!0,onExecute:function(){t._model.togglePriceScaleLogScaleMode(t._model.mainSeries().priceScale())},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+76}),P=new W({label:s("Undo"),onExecute:function(){pe("GUI","Undo"),t._model.undoHistory().undo()},disabled:!0,hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Mod+90}),C=new W({label:s("Redo"),onExecute:function(){pe("GUI","Redo"),t._model.undoHistory().redo()},disabled:!0,hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Mod+89});t.withModel(null,(function(){t._model.undoHistory().undoStack().onChange().subscribe(t,t.updateUndoRedo),t._model.undoHistory().redoStack().onChange().subscribe(t,t.updateUndoRedo)}));var T=[new W({label:s("Loading")})],x=new W({name:"apply-color-theme",label:s("Color Theme"),icon:i(12673),subItems:T,statName:"ColorTheme"}),I=new W({label:s("Time Zone"),statName:"TimeZone"}),L=new W({label:ve(s("Change Symbol")),statName:"ChangeSymbol",onExecute:function(){ne({defaultValue:""})}});m("symboledit.dialog_last_entry","");var M={label:ve(s("Change Interval")),statName:"ChangeInterval",onExecute:function(){Z({initVal:J.interval.value(),selectOnInit:!0})}};!d.enabled("show_interval_dialog_on_key_press")||this.readOnly()||this._hideSymbolSearch||(M.shortcutHint=",",M.hotkeyGroup=this._hotkeys,M.hotkeyHash=188);var A,k,D=new W(M);if(!TradingView.onWidget()){if(this._options.addToWatchlistEnabled){const e={hotkeyGroup:this._hotkeys};A=new ie(this,e)}k=new W({label:s("Add To Text Notes"),statName:"AddToTextNotes",onExecute:function(){window.runOrSignIn((function(){TradingView.bottomWidgetBar&&(TradingView.bottomWidgetBar.toggleWidget("text_notes",!0),TradingView.bottomWidgetBar._widgets.text_notes.addNote(null,t.getSymbol(!0),t.getSymbol()))}),{source:"Add text note in chart context menu"})},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+78})}var R=new W({
label:s("Reset Time Scale"),icon:i(77624),statName:"ResetScale",onExecute:function(){t.model().resetTimeScale()},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Mod+S.Modifiers.Alt+81}),N=new W({label:s("Insert Drawing Tool"),subItems:r,statName:"InsertDravingTool"}),O=new W({label:s("Remove Indicators"),statName:"RemoveAllIndicators",onExecute:this.removeAllStudies.bind(this)}),V=new W({label:s("Remove Drawings"),statName:"RemoveAllDrawingTools",onExecute:this.removeAllDrawingTools.bind(this)}),B=new W({label:s("All Indicators And Drawing Tools"),statName:"RemoveAllIndicatorsAndDrawingTools",onExecute:this.removeAllStudiesDrawingTools.bind(this)}),F=this.chartWidgetCollection(),H=new W({label:s("Apply these Indicators to Entire Layout"),statName:"ApplyIndicatorsToAllCharts",onExecute:function(){F.applyIndicatorsToAllCharts(t)}}),j={label:ve(s("Insert Indicator")),statName:"InsertIndicator",onExecute:function(){t.showIndicators()}};this._options.indicatorsDialogShortcutEnabled&&(j.hotkeyGroup=this._hotkeys,j.hotkeyHash=191,new W({label:ve(s("Insert Indicator")),statName:"InsertIndicator",onExecute:function(){t.showIndicators()},hotkeyGroup:this._hotkeys,hotkeyHash:111}));var Y,G=new W(j),q=new W({label:ve(s("Compare or Add Symbol")),statName:"CompareOrAddSymbol",onExecute:this.toggleCompareOrAdd.bind(this)}),K=new W({label:ve(s("Compare")),statName:"Compare",onExecute:this.toggleCompareOrAdd.bind(this)}),re=new W({label:ve(s("Object Tree")),statName:"ObjectsTree",onExecute:this.showObjectsTreePanelOrDialog.bind(this)}),se=new W({label:ve(s("Settings")),icon:i(99673),statName:"ChartProperties",onExecute:function(){t.showGeneralChartProperties()}}),oe=new W({label:ve(s("Settings")),icon:i(99673),statName:"MainSeriesProperties",onExecute:function(){t.showGeneralChartProperties(f.symbol)}}),ae=new W({label:s("Lock/Unlock"),statName:"ToggleLockSelectedObject",onExecute:this.toggleLockSelectedObject.bind(this)}),le=new W({label:s("Hide"),icon:i(96136),statName:"HideSelectedObject",onExecute:this.hideSelectedObject.bind(this)});d.enabled("property_pages")&&(Y=new W({label:ve(s("Settings")),icon:i(99673),statName:"EditSelectedObject",onExecute:function(){t.showSelectedSourcesProperties()}})),this.withModel(null,(function(){var e=t.model().mainSeries(),i=e.properties();i.priceAxisProperties.subscribe(t,t._updateScalesActions),e.priceScaleAboutToBeChanged().subscribe(t,(function(){i.priceAxisProperties.unsubscribeAll(t)})),e.priceScaleChanged().subscribe(t,(function(){i.priceAxisProperties.subscribe(t,t._updateScalesActions),t._updateScalesActions()}))}));var ce=new W({label:s("Scale Price Chart Only"),checkable:!0,statName:"ScalePriceChartOnly"});ce.binder=new h(ce,this._properties.scalesProperties.scaleSeriesOnly,this.model(),s("Scale Price Chart Only"));var ue=this.model().model();this._properties.scalesProperties.scaleSeriesOnly.listeners().subscribe(null,(function(){ue.recalculateAllPanes(),ue.invalidate($.full())}));var de=new W({label:s("Drawings Toolbar"),checkable:!0,statName:"ToggleDrawingToolbar"
}),he=this._options.isDrawingToolbarVisible;he&&(he.subscribe((function(e){de.update({checked:e})}),{callWithLast:!0}),de.update({onExecute:function(){he.setValue(!he.value())}}));var _e=new W({label:s("Stay in Drawing Mode"),checkable:!0,statName:"ToggleStayInDrawingMode"});_e.binder=new h(_e,z.properties().stayInDrawingMode,this.model(),s("Stay In Drawing Mode"));var me=new W({label:s("Sync drawings to all charts"),checkable:!0,statName:"ToggleSyncDrawings"});me.binder=new h(me,z.properties().drawOnAllCharts,this.model(),"SyncDrawings");var fe=new W({label:s("Lock All Drawing Tools"),checkable:!0,statName:"ToggleLockDrawings"});fe.binder=new h(fe,z.lockDrawings(),this.model(),s("Lock drawings"),(function(){z.lockDrawings().setValue(this.value())}));var ge=new W({label:s("Hide All Drawing Tools"),checkable:!0,statName:"ToggleHideAllDrawingTools",hotkeyHash:S.Modifiers.Mod+S.Modifiers.Alt+72,hotkeyGroup:this._hotkeys});ge.binder=new h(ge,z.hideAllDrawings(),this.model(),s("Hide All Drawing Tools"),(function(){var e=_("ChartToolsHideMode","drawings"),t=z.hideAllDrawings(),i=z.hideAllIndicators();switch(e){case"drawings":t.setValue(!t.value());break;case"indicators":i.setValue(!i.value());break;default:t.setValue(!t.value()),i.setValue(!i.value())}}));var Se=new W({label:s("Hide Marks On Bars"),checkable:!0,statName:"ToggleHideMarksOnBars"});Se.binder=new h(Se,z.hideMarksOnBars(),this.model(),s("Hide Marks On Bars"),(function(){z.hideMarksOnBars().setValue(this.value())}));var ye=new W({label:s("Symbol Last Price Label"),checkable:!0,checked:!1,statName:"ToggleSymbolLastValue"});ye.binder=new h(ye,this.properties().scalesProperties.showSeriesLastValue,this.model(),s("Show Symbol Last Value"));var be=new W({label:s("Symbol Previous Day Close Price Label"),checkable:!0,checked:!1,statName:"ToggleSymbolPrevCloseValue"});be.binder=new h(be,this.properties().scalesProperties.showSeriesPrevCloseValue,this.model(),s("Show Symbol Previous Close Value"));var we=new W({label:s("Previous Day Close Price Line"),checkable:!0,checked:!1,statName:"ToggleSymbolPrevCloseLine"});we.binder=new h(we,this.model().mainSeries().properties().showPrevClosePriceLine,this.model(),s("Show Previous Close Price Line")),this.model().mainSeries().onRestarted().subscribe(this,(function(){this.updateActionForIntradayOnly(be),this.updateActionForIntradayOnly(we)}));var Pe=new W({label:s("Symbol Name Label"),checkable:!0,checked:!1,statName:"ToggleSymbolLabels"});Pe.binding=new h(Pe,this.properties().scalesProperties.showSymbolLabels,this.model(),"Undo Show Symbol Labels");var Ce=new W({label:s("Indicator Last Value Label"),checkable:!0,checked:!1,statName:"ToggleStudyLastValue"});Ce.binder=new h(Ce,this.properties().scalesProperties.showStudyLastValue,this.model(),s("Show Indicator Last Value"));var Te=new W({label:s("Indicator Name Label"),checkable:!0,checked:!1,statName:"ToggleIndicatorsLabels"});Te.binding=new h(Te,this.properties().scalesProperties.showStudyPlotLabels,this.model(),"Undo Show Indicator Labels");var xe=new W({
label:s("Bid and Ask Labels"),checkable:!0,checked:!1,statName:"ToggleBidAskLabels"});xe.binding=new h(xe,this.properties().scalesProperties.showBidAskLabels,this.model(),s("Show Bid and Ask Labels"));var De=new W({label:s("Bid and Ask Lines"),checkable:!0,checked:!1,statName:"ToggleBidAskLines"});De.binding=new h(De,this.model().mainSeries().properties().bidAsk.visible,this.model(),s("Show Bid and Ask Lines"));var Re=new W({label:s("Pre/Post Market Price Label"),checkable:!0,checked:!1,statName:"TogglePrePostMarketPriceLabel"});Re.binding=new h(Re,this.properties().scalesProperties.showPrePostMarketPriceLabel,this.model(),s("Show Pre/Post Market Price Label"));var Ne=new W({label:s("Pre/Post Market Price Line"),checkable:!0,checked:!1,statName:"TogglePrePostMarketPriceLine"});Ne.binding=new h(Ne,this.model().mainSeries().properties().prePostMarket.visible,this.model(),s("Show Pre/Post Market Price Line")),this.model().mainSeries().isPrePostMarketPricesForbiddenProperty().subscribe(this,(function(e){Re.update({disabled:e.value()}),Ne.update({disabled:e.value()})}));var Oe=this.model().mainSeries().properties().highLowAvgPrice,Ve=new W({label:s("High and low price labels"),checkable:!0,checked:!1,statName:"ToggleHighLowPriceLabels"});Ve.binding=new h(Ve,Oe.highLowPriceLabelsVisible,this.model(),s("Show high and low price labels"));var Be=new W({label:s("High and low price lines"),checkable:!0,checked:!1,statName:"ToggleHighLowPriceLine"});Be.binding=new h(Be,Oe.highLowPriceLinesVisible,this.model(),s("Show high and low price lines"));var Fe=new W({label:s("Average close price label"),checkable:!0,checked:!1,statName:"ToggleAverageClosePriceLabel"});Fe.binding=new h(Fe,Oe.averageClosePriceLabelVisible,this.model(),s("Show average close price label"));var We=new W({label:s("Average close price line"),checkable:!0,checked:!1,statName:"ToggleAverageClosePriceLine"});We.binding=new h(We,Oe.averageClosePriceLineVisible,this.model(),s("Show average close price line"));var Ue=new W({label:s("Financials Last Value Label"),checkable:!0,checked:!1,statName:"ToggleFundamentalsLastValue"});Ue.binder=new h(Ue,this.properties().scalesProperties.showFundamentalLastValue,this.model(),"Show Financials Last Value");var He=new W({label:s("Financials Name Label"),checkable:!0,checked:!1,statName:"ToggleFundamentalsLabels"});He.binding=new h(He,this.properties().scalesProperties.showFundamentalNameLabel,this.model(),"Show Financials Name Label");var ze=new W({label:s("Countdown To Bar Close"),checkable:!0,checked:!1,statName:"ToggleCountdown"});ze.binder=new h(ze,this.model().mainSeries().properties().showCountdown,this.model(),ze.getLabel());var je=new W({label:s("Currency"),checkable:!0,checked:!0,statName:"ToggleScalesCurrency"});je.binder=new h(je,this.properties().scalesProperties.showCurrency,this.model(),"Change Currency Label Visibility");var Ye=new W({label:s("Unit"),checkable:!0,checked:!0,statName:"ToggleScalesUnit"});Ye.binder=new h(Ye,this.properties().scalesProperties.showUnit,this.model(),"Change Unit Label Visibility")
;var Ge=new W({label:s("Plus Button"),checkable:!0,checked:Ie.value(),statName:"ToggleAddOrderPlusButton"});Ge.binder=new h(Ge,Ie,this.model(),Ge.getLabel());var qe=null;this._options.goToDateEnabled&&(qe=new W({label:ve(s("Go to Date")),statName:"GoToDate",onExecute:function(){var e=t._chartWidgetCollection.activeChartWidget.value();g(e)},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+71}));var Xe,$e=new W({label:ve(ee()?s("Symbol Details"):s("Symbol Info")),icon:i(51264),checkable:!1,statName:"SymbolInfo",onExecute:function(){if(ee())Q(),pe("ContextMenuClick","Mobile","SymbolInfo");else{var e=t.model().mainSeries().symbol(),i=t.model().mainSeries().symbolInfo(),r=t.model().model().availableUnits(),s=t.model().model().unitConversionEnabled();X(e,{symbolInfo:i,showUnit:s,unitName:function(e){return r.name(e)}})}}}),Ke=new W({label:Le,statName:"MergeAllScalesToLeft",onExecute:function(){t.model().mergeAllScales("left")}}),Je=new W({label:Me,statName:"MergeAllScalesToRight",onExecute:function(){t.model().mergeAllScales("right")}}),Ze=new W({label:Ee,statName:"MoveScaleToLeft",onExecute:function(){t.model().mergeAllScales("left")}}),Qe=new W({label:Ae,statName:"MoveScaleToRight",onExecute:function(){t.model().mergeAllScales("right")}});Xe=new W({label:s("Move Chart"),subItems:[new W({label:s("Forward"),statName:"MoveChartRight",onExecute:function(){t._chartWidgetCollection.moveActiveChartWithUndo(!1)}}),new W({label:s("Back"),statName:"MoveChartLeft",onExecute:function(){t._chartWidgetCollection.moveActiveChartWithUndo(!0)}})]});var et=d.enabled("show_object_tree");let tt;if(this._options.showFinancialsEnabled&&(tt=new W({label:ve(s("Financials")),icon:i(70707),statName:"Financials",onExecute:()=>{E(),window.matchMedia("screen and (max-width: 428px)").matches&&pe("ContextMenuClick","","Financials"),te().then(e=>{null!==e&&e.trackFinancialsDialog(J.proSymbol.value(),"contextMenu")})}})),this._actions={chartProperties:se,mainSeriesPropertiesAction:oe,timeScaleReset:R,chartReset:a,invertSeriesScale:l,logSeriesScale:w,autoSeriesScale:c,lockSeriesScale:u,regularSeriesScale:p,percentSeriesScale:y,indexedTo100SeriesScale:b,compareOrAdd:q,compare:K,paneObjectTree:et?re:void 0,insertIndicator:G,insertDrawingTool:N,applyColorTheme:x,symbolSearch:L,showSymbolInfoDialog:$e,changeInterval:D,seriesHide:le,studyHide:le,lineToggleLock:ae,lineHide:le,scaleSeriesOnly:ce,drawingToolbarAction:de,stayInDrawingModeAction:_e,syncModeAction:me,lockDrawingsAction:fe,hideAllDrawingsAction:ge,hideAllMarks:Se,applyTimeZone:I,showCountdown:ze,showCurrency:je,showUnit:Ye,addPlusButton:Ge,showSeriesLastValue:ye,showSeriesPrevCloseValue:be,showSeriesPrevCloseLine:we,showBidAskLabels:xe,showBidAskLines:De,showPrePostMarketPriceLabel:Re,showPrePostMarketPriceLine:Ne,showHighLowPriceLabels:Ve,showHighLowPriceLines:Be,showAverageClosePriceLabel:Fe,showAverageClosePriceLine:We,showSymbolLabelsAction:Pe,showStudyLastValue:Ce,showStudyPlotNamesAction:Te,showFundamentalsLastValueAction:Ue,showFundamentalNamesAction:He,undo:P,redo:C,
mergeLeftScalesAction:Ke,mergeRightScalesAction:Je,moveScaleToLeft:Ze,moveScaleToRight:Qe,moveChartAction:Xe},e&&(this._actions.scalesProperties=e),A&&(this._actions.addToWatchlist=A),tt&&(this._actions.showFinancials=tt),d.enabled("show_source_code")&&(this._actions.viewSourceCode=new W({label:ve(s("Source Code")),statName:"OpenSelectedObjectSource",onExecute:this.openSelectedObjectSource.bind(this)})),!TradingView.onWidget()&&d.enabled("text_notes")&&(this._actions.addToTextNotes=k),null!==qe&&(this._actions.gotoDate=qe),this.createSessionBreaksActions(),!this.readOnly()){var it=new W({label:s("Remove"),icon:i(54500),statName:"RemoveSelectedObject",onExecute:function(){var e=this._chartWidgetCollection.activeChartWidget.value();e||(e=this),e.removeSelectedSources()}.bind(this),hotkeyGroup:this._hotkeys,hotkeyHash:v.isMacKeyboard?8:46});this._hotkeys.add({handler:function(){this.removeSelectedSources()}.bind(this),desc:"Remove selected source",hotkey:v.isMacKeyboard?46:8}),this._actions.insertDrawingTool=N,this._actions.paneRemoveAllStudies=O,this._actions.paneRemoveAllDrawingTools=V,this._actions.paneRemoveAllStudiesDrawingTools=B,this._actions.applyStudiesToAllCharts=H,this._actions.seriesRemove=it,this._actions.studyRemove=it,this._actions.lineRemove=it,d.enabled("property_pages")&&(this._actions.format=Y),this._actions.lockDrawingsAction=fe,this._actions.hideAllDrawingsAction=ge,this._actions.hideAllMarks=Se}this._actions.showPriceLine=new W({label:s("Price Line"),checkable:!0,statName:"TogglePriceLine"}),this._actions.showPriceLine.binding=new h(this._actions.showPriceLine,this.model().mainSeries().properties().showPriceLine,this.model(),"Undo Toggle Price Line"),this.readOnly()||(this._actions.horzLineRightThere=new W({label:s("Draw Horizontal Line Here"),onExecute:function(){t.activePaneWidget&&t.activePaneWidget.drawRightThere("LineToolHorzLine")},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+72}),this._actions.horzRayRightThere=new W({label:s("Draw Horizontal Ray Here"),onExecute:function(){t.activePaneWidget&&t.activePaneWidget.drawRightThere("LineToolHorzRay")},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+74}),this._actions.vertLineRightThere=new W({label:s("Draw Vertical Line Here"),onExecute:function(){t.activePaneWidget&&t.activePaneWidget.drawRightThere("LineToolVertLine")},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+86}),this._actions.crossLineRightThere=new W({label:s("Draw Cross Line Here"),onExecute:function(){t.activePaneWidget&&t.activePaneWidget.drawRightThere("LineToolCrossLine")},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+67}),this._actions.trendLine=new W({label:s("Draw Trend Line"),onExecute:function(){t.activePaneWidget&&z.tool.setValue("LineToolTrendLine")},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+84}),this._actions.FibRetracement=new W({label:s("Draw Fib Retracement"),onExecute:function(){t.activePaneWidget&&z.tool.setValue("LineToolFibRetracement")},hotkeyGroup:this._hotkeys,hotkeyHash:S.Modifiers.Alt+70})),this._updateScalesActions()}
options(){return this._options}executeActionById(e){if("takeScreenshot"===e)return console.warn('Action "takeScreenshot" is deprecated. Use method "takeScreenshot" instead'),void this._chartWidgetCollection.takeScreenshot();"lockDrawingsAction"===e&&console.warn('Action "lockDrawingsAction" is deprecated. Use method "lockAllDrawingTools" instead'),"hideAllDrawingsAction"===e&&console.warn('Action "hideAllDrawingsAction" is deprecated. Use method "hideAllDrawingTools" instead'),e in this._actions?this._actions[e]instanceof W&&this._actions[e].execute():console.warn("Unknown action id: "+e)}getCheckableActionState(e){if("lockDrawingsAction"===e)return console.warn('Action "lockDrawingsAction" is deprecated. Use method "lockAllDrawingTools" instead'),null;if("hideAllDrawingsAction"===e)return console.warn('Action "hideAllDrawingsAction" is deprecated. Use method "hideAllDrawingTools" instead'),null;if(e in this._actions){var t=this._actions[e];if(t instanceof W&&t.isCheckable())return t.isChecked();console.warn("Action "+e+" has no state")}else console.warn("Unknown action id: "+e);return null}_updateScalesActions(){if(null!==this._actions){var e=this.model().mainSeries(),t=e.priceScale(),i=e.properties(),r=t.isLockScale(),s=i.style.value()===u.STYLE_PNF;this._actions.percentSeriesScale.update({disabled:r||s,checked:t.isPercentage()}),this._actions.logSeriesScale.update({disabled:r||s,checked:t.isLog()}),this._actions.regularSeriesScale.update({disabled:r||s,checked:t.isRegular()}),this._actions.indexedTo100SeriesScale.update({disabled:r||s,checked:t.isIndexedTo100()}),this._actions.invertSeriesScale.update({checked:t.isInverted()}),this._actions.lockSeriesScale.update({checked:t.isLockScale()}),this._actions.autoSeriesScale.update({checked:t.isAutoScale(),disabled:t.properties().autoScaleDisabled.value()})}}removeAllStudies(){this._model.removeAllStudies()}removeAllDrawingTools(){this._model.removeAllDrawingTools()}removeAllStudiesDrawingTools(){this._model.removeAllStudiesAndDrawingTools()}defaultSymbol(){return this._defSymbol}connect(){this._handler=function(e){this._onData(e)}.bind(this),this._boundOnChartSessionIsConnectedChanged=this._onChartSessionIsConnectedChanged.bind(this),this._chartSession.isConnected().subscribe(this._boundOnChartSessionIsConnectedChanged),this._chartSession.criticalError().subscribe(this,this._onChartSessionCriticalError),this._chartSession.connect(this._handler)}finishInitWithoutConnect(){this._chartSession.disable(),this._init(),this.chartWidgetInitialized.fire()}reconnect(){this._chartSession.disconnect(),this._chartSession.connect()}update(){if(this._model){for(var e=0;e<this._paneWidgets.length;e++)this._paneWidgets[e].update();this._timeAxisWidget&&this._timeAxisWidget.update()}}_makeDefaultGui(){this._makeLoadingScreen(),this.onWidget()&&this._makeAvailableOnTVPopup(),this._model&&(this._makeTimeAxisWidget(),this._makePaneWidgetsAndSeparators()),this._adjustSize(),this._updateScalesActions(),b(this._elMainTable),this.update(),this.paint()}widget(){return this._mainDiv}
_onBackgroundColorChanged(){for(var e=0;e<this._paneWidgets.length;e++)this._paneWidgets[e].setCursorForTool();this.update(),this.model().model().fullUpdate()}setScaleLineColor(e){this.scaleLineColor=e.value(),this._paneSeparators.forEach((function(e){e.update()})),this.update(),this.paint()}setScaleTextColor(e){this.scaleTextColor=e.value(),this.update(),this.paint()}setTimingsMeter(e){this._timingsMeter=e,this._updateTimingsMeterState()}ownerDocument(){return this._parent.ownerDocument}_updateTimingsMeterState(){var e=this._options.visible.value();null!==this._timingsMeter&&(e?this._timingsMeter.startCollect():this._timingsMeter.stopCollect())}_update(e){var t=e?e.fullInvalidation():K.Full,i=!!e&&e.isVisibleTimeRangeLockedOnResize();if(null!==this._timingsMeter&&this._timingsMeter.startDraw(t),t===K.Full&&(this._model?this._updateGui(i):this._adjustSize(i)),e.invalidateForTimeScale()>K.Cursor&&this._timeAxisWidget.update(),this.paint(e),this._dataWindowWidget){var r=e.maxPaneInvalidation();r===K.Full?this._dataWindowWidget.fullUpdate():r>K.None&&this._dataWindowWidget.update()}for(var s=0;s<this._paneWidgets.length;s++)this._paneWidgets[s].updateStatusWidget(e.invalidateForPane(s).fullInvalidation());null!==this._timingsMeter&&this._timingsMeter.stopDraw(),e&&e.panesOrderInvalidated()&&we.emit("panes_order_changed")}_createVolumeIfNeeded(){var e=d.enabled("create_volume_indicator_by_default")&&this._options.addVolume,t=!this._content,i=d.enabled("charting_library_base"),r=d.enabled("create_volume_indicator_by_default_once"),s=this._content&&!this._content.loading;e&&(t||i&&s&&!r)&&this._model.mainSeries().dataEvents().symbolResolved().subscribe(this,(function(){var e=this;setTimeout((function(){var t=e._model.model().mainSeries().symbolInfo();if(t){var i=q(t);if(!e.containsVolume()&&i){var r=fe.factoryDefaults("chartproperties.volumePaneSize"),s=e._model.model().createStudyInserter({type:"java",studyId:"Volume@tv-basicstudies"});s.setForceOverlay(d.enabled("volume_force_overlay")),s.setPaneSize(r),d.enabled("hide_volume_ma")&&s.setPropertiesState({styles:{vol_ma:{visible:!1}}}),s.insert()}else if(!i&&e.containsVolume()){var n=e.model().dataSources().filter((function(e){return e instanceof k&&"Volume"===e.metaInfo().shortId}))[0];e._model.model().removeSource(n)}}}),0)}),r)}_createSessions(e){var t=this.showGeneralChartProperties.bind(this,f.timezoneSessions);e.createSessions(t)}_createPrePostMarket(e){var t=this.showGeneralChartProperties.bind(this,f.symbol);e.createPrePostMarket(t)}_createChartEventsSource(){if(d.enabled("chart_events")){var e=this._model.mainSeries(),t=new w(e);this._model.paneForSource(e).insertDataSource(t,e.priceScale())}}_onChartStyleChanged(){pe("Chart","Chart Style "+this._model.mainSeries().getStyleShortName().toUpperCase())}_updateGui(e){this._model&&(this._makeTimeAxisWidget(),this._makePaneWidgetsAndSeparators(),this._elMainTable.style.userSelect="none",this._adjustSize(e))}setVisibleTimeRange(e,t,i,r){throw new Error("Not implemented")}_makeLoadingScreen(){
if(d.enabled("lean_chart_load")){if(this.screen)return;this.screen=new me(this,this._parent)}else this.screen=new me(this,this._mainDiv)}_makeAvailableOnTVPopup(){this.available_screen||(this.available_screen=new T(this))}_setSymbol(e,t){if(this._model){var i=this._model.mainSeries();if(!t&&i.symbolSameAsCurrent(e))return;this._model.selectionMacro((function(e){e.clearSelection()})),this._model.setSymbol(this._model.mainSeries(),e)}else this._properties.mainSeriesProperties.merge({symbol:e})}setSymbol(e,t){return this._setSymbol.apply(this,arguments)}loadRange(e){this._model&&(this.screen.show(),this._model.loadRange(e))}getSymbol(e){var t;return(t=this._model?this._model.mainSeries().properties():this._properties.mainSeriesProperties)?e&&t.shortName&&t.shortName.value()?t.shortName.value():t.symbol.value():""}toggleMaximizePane(e){if(!(this._paneWidgets.length<2)){this._maximizedPaneWidget?(this._maximizedPaneWidget.state().setMaximized(!1),this._maximizedPaneWidget=null,this._paneSeparators.forEach((function(e){e.show()}))):(this._maximizedPaneWidget=e,this._maximizedPaneWidget.state().setMaximized(!0),this._paneSeparators.forEach((function(e){e.hide()})));for(var t=this._paneWidgets.length;t--;)this._paneWidgets[t].updateControls(),this._paneWidgets[t].updatePriceAxisWidgets();this._timeAxisWidget.updatePriceAxisStubs(),this._adjustSize(),this.updateCrossHairPositionIfNeeded()}}_titlesProvider(e,t){var i=this.model(),r=this._maximizedPaneWidget?this._maximizedPaneWidget.state():i.paneForSource(i.mainSeries()),s="right"===e?r.rightPriceScales():r.leftPriceScales();if(s.length<t+1)return[];var n=s[t].orderedSources().filter((function(e){return e===i.mainSeries()||e instanceof k}));return n.reverse(),(n=l(n,i.mainSeries())).map((function(e){return e.title(!0,void 0,!1)}))}_menuItemsProvider(e,t){var i=this.model(),r=this._maximizedPaneWidget?this._maximizedPaneWidget.state():i.paneForSource(i.mainSeries()),s="right"===e?r.visibleRightPriceScales():r.visibleLeftPriceScales();if(s.length<t+1)return[];var n=s[t],o=i.panes().indexOf(r),a=this._paneWidgets[o];return("right"===e?a.rightPriceAxisesContainer():a.leftPriceAxisesContainer()).findAxisWidgetForScale(n).getContextMenuActions()}_makeTimeAxisWidget(){if(this._timeAxisWidget)this._timeAxisWidget.updatePriceAxisStubs();else{var e=this.model();this._timeAxisWidget=new c(this,this._options.timeScaleWidget,this._titlesProvider.bind(this),this._menuItemsProvider.bind(this),this._backgroundBasedTheme),this._elMainTable.appendChild(this._timeAxisWidget.getElement()),this._timeAxisWidget.updatePriceAxisStubs(),this._timeAxisWidget.onLabelHovered().subscribe(this,(function(t,i){var r=this._maximizedPaneWidget?this._maximizedPaneWidget.state():e.paneForSource(e.mainSeries()),s=this.paneByState(r).highlightedPriceAxis(),n=s.value();(i||n.owner===t.owner)&&(s.setValue({owner:t.owner,axis:i?t.axis:null}),this.model().model().lightUpdate())}))}}insertStudy(e,t,i,r){var s=this;return new Promise((function(n){t?window.runOrSignIn((function(){n(s._insertStudy(e,t,i,r))}),{
source:"study on study"}):n(s._insertStudy(e,t,i,r))})).catch((function(){}))}_insertStudy(e,t,i,r){var n=this._model.createStudyInserter(e,t,i);n.setForceOverlay("java"===e.type&&"Volume@tv-basicstudies"===e.studyId&&d.enabled("volume_force_overlay"));var o=this,a=n.insert((function(e,t,i){return new Promise((function(s,n){o.selectPointMode().value()&&o.cancelRequestSelectPoint(),r?s(r(e,t,i)):o.isSymbolicStudy(i)?(pe("GUI","Confirmation dialogs","Symbol confirmation dialog"),y(o,i,s,n,"symbol")):o.hasConfirmInputs(t)?(pe("GUI","Confirmation dialogs","Inputs confirmation dialog"),y(o,i,s,n)):s({inputs:{}})}))}));return a.catch((function(e){e===I.StudyCannotBeChild&&x({type:"modal",title:s("Oops!"),content:s("This indicator cannot be applied to another indicator.")}),e===I.CannotGetMetainfo&&x({type:"modal",title:s("Oops!"),content:s("Something went wrong. Please try again later.")})})),a}hasConfirmInputs(e){if(void 0===e)return!1;for(var t=0;t<e.length;++t){var i=e[t];if(void 0!==i.confirm&&i.confirm)return!0}return!1}isSymbolicStudy(e){switch(e.id){case"Overlay@tv-basicstudies":case"CorrelationCoefficient@tv-basicstudies":case"Correlation Coeff@tv-basicstudies":case"Spread@tv-basicstudies":case"Ratio@tv-basicstudies":return!0;default:return!1}}_onChartSessionIsConnectedChanged(e){e?this._onConnection():this._onDisconnect()}_onChartSessionCriticalError(e,t){this._disconnected.fire(!0)}_onData(e){switch(e.method){case"reconnect_bailout":this._reconnectBailout.fire();break;default:this._model.onData(e)}}_onConnection(){this._online=!0,this.requestMetadata(),this._model&&(this._model.restart(),this.model().model().fullUpdate(),this._connected.fire())}_onDisconnect(){this._model&&this._model.disconnect(),this._online=!1,this.model().model().fullUpdate(),this._disconnected.fire()}_applyStudiesOverrides(){de.overrideDefaults(this._metaInfoRepository.getInternalMetaInfoArray())}requestMetadata(){this._addPerfMark("RequestMetadataStart"),ge.logInfo("RequestMetadataStart"),this._metaInfoRepository.requestMetaInfo().then(function(){this._addPerfMark("RequestMetadataEnd"),ge.logInfo("RequestMetadataEnd, already initialized: "+Boolean(this._inited)),this._inited?this.model().model().setStudiesMetaData(this._metaInfoRepository.getInternalMetaInfoArray(),this._metaInfoRepository.getMigrations()):(this._init(),this.chartWidgetInitialized.fire(),d.enabled("charting_library_base")||ge.logDebug("initialized"))}.bind(this))}studiesMetaData(){return this._model.studiesMetaData()}getTimeScale(){return this._timeAxisWidget}chartWidgetCollection(){return this._chartWidgetCollection}setSeriesStyle(e,t){this._model.setProperty(e.properties().style,t)}showObjectsTreePanelOrDialog(){var e=!1,t=window.widgetbar;t&&t.isVisible()&&(e="object_tree"===t.setPage("object_tree").name);e||this.showObjectsTreeDialog()}showGeneralChartProperties(e){if(!d.enabled("show_chart_property_page"))return Promise.resolve(null);var t=this;return this._showChartProperties(this._model.mainSeries(),e,{doNotCloseOnBgClick:!0,onResetToDefault:function(){
t._model.restorePreferences(t._model),t.applyTheme(t)}}).then((function(e){if(null===e)return null;var i=function(){e.hide(),t._chartWidgetCollection.activeChartWidget.unsubscribe(i)};return t._chartWidgetCollection.activeChartWidget.subscribe(i),e}))}showChartPropertiesForSource(e,t,i,r){return d.enabled("property_pages")?e===this._model.model().mainSeries()?this.showGeneralChartProperties(t):((i=i||{}).onResetToDefault=this._model.restorePropertiesForSource.bind(this._model,e),this._showChartProperties(e,t,i,r)):Promise.resolve(null)}generalPropertiesDefinitions(){return this._getChartPropertyDefinitionsViewModel().then((function(e){return e.propertyPages()}))}propertiesDefinitionsForSource(e){return V(e)||R(e)||B(e)?e.getPropertyDefinitionsViewModel().then((function(e){return null===e?null:e.propertyPages()})).catch((function(e){return ge.logWarn(e),null})):Promise.resolve(null)}toggleCompareOrAdd(){this._compareDialog.visible().value()?this._compareDialog.hide():this._compareDialog.show()}showIndicators(e){if(window.studyMarket)return window.studyMarket.visible().value()?void window.studyMarket.hide():(window.studyMarket.show(e),window.studyMarket)}showFundamentals(e){if(window.fundamentalsDialog){if(!window.fundamentalsDialog.visible().value()){var t,i=void 0!==e?e.title(!0):void 0;if(void 0!==e){var r=e.symbolInfo();t=null===r?e.symbol():r.ticker||r.full_name}return window.fundamentalsDialog.show(t,i),window.fundamentalsDialog}window.fundamentalsDialog.hide()}}removeSelectedSources(){this.removeDataSources(this._model.selection().dataSources())}removeDataSources(e){var t=e.filter(function(e){return e!==this._model.mainSeries()&&e!==this._model.lineBeingCreated()&&e.isUserDeletable()}.bind(this));if(0!==t.length){var i=null;R(t[0])&&(o(1===t.length,"Cannot remove several studies (no multi select for studies)"),i=t[0]),t.find((function(e){return e.hasAlert.value()}))?M().then(function(e){e&&this._model.removeSelectedSources()}.bind(this)):i&&i.hasChildren()?C(this._model.removeSelectedSources.bind(this._model)):this._model.removeSelectedSources()}}unlinkSelectedLine(){var e=this._model,t=e.selection().lineDataSources();e.unlinkLines(t)}copyLineToOtherCharts(){var e=this._model,t=e.selection().lineDataSources().filter((function(e){return e.isSynchronizable()}));e.copyToOtherCharts(t)}hideSelectedObject(){this.hideDataSources(this._model.selection().dataSources())}hideDataSources(e){if(e.length){var t=e.map((function(e){return e.properties().visible})),i=e.map((function(){return!1}));this._model.setProperties(t,i,"Hide "+e[0].title())}}toggleLockSelectedObject(){var e=this._model;e.selection().lineDataSources().forEach((function(t){var i=t.properties().frozen.value();e.setProperty(t.properties().frozen,!i,s(i?"Unlock":"Lock")+" "+t.title())}))}showSourceProperties(e){var t=null;e===this._model.mainSeries()&&(t=f.symbol),this.showChartPropertiesForSource(e,t)}openSelectedObjectSource(e){var t=this._model.selection().dataSources()[0];if(t&&t.metaInfo){var r=t.metaInfo()
;if(r&&r.scriptIdPart&&r.pine)if(TradingView.bottomWidgetBar)i(57746).getPineSourceCode(r.scriptIdPart,r.pine.version).done((function(e){var t=P.parse(e.version),i=e.lastVersionMaj?P.parse(e.lastVersionMaj):new P(0,0),s={scriptSource:e.source,scriptIdPart:r.scriptIdPart,scriptName:e.scriptName,scriptTitle:e.scriptTitle,version:e.version,isOld:!i.isZero()&&i.major()!==t.major()};TradingView.bottomWidgetBar.activateScriptEditorTab(s)}))}}tags(){return this._model?this._model.calculateDefaultTags():[]}state(e,t,i,r){if(this._model){const s=this._model.state(e,t,i,r);return s.chartId=this.id(),s}return this._content?this._content:{}}asyncState(){return this._model.asyncState()}metaInfo(){var e=this._metaInfo;return this._model&&(e.systemTags=this._model.calculateDefaultTags()),e}onTagsChanged(){return this._tagsChanged}onModelTagsChanged(){this._tagsChanged.fire()}onAboutToBeDestroyed(){return this._aboutToBeDestroyed}destroy(){this._aboutToBeDestroyed.fire(),null!==this._removeMaximizeHotkey&&(this._removeMaximizeHotkey(),this._removeMaximizeHotkey=null),0!==this._drawRafId&&this._parent.ownerDocument.defaultView.cancelAnimationFrame(this._drawRafId),null!==this._backgroundTopColorSpawn&&this._backgroundTopColorSpawn.destroy(),null!==this._backgroundBottomColorSpawn&&this._backgroundBottomColorSpawn.destroy(),null!==this._timingsMeter&&(this._timingsMeter.stopCollect(),this._timingsMeter=null);for(var e=0;e<this._paneWidgets.length;e++)this._paneWidgets[e].destroy();this._paneWidgets.length=0;for(e=0;e<this._paneSeparators.length;e++)this._paneSeparators[e].destroy();for(var t in this._paneSeparators.length=0,this._hotkeysListener&&this._hotkeysListener.destroy(),this._barsButton&&this._barsButton.destroy(),this._controlBarNavigation&&(this._controlBarNavigation.destroy(),this._controlBarNavigation=void 0),this._mainDiv&&this._mainDiv.remove(),this._actions){var i=this._actions[t];i instanceof W&&(i.destroy(),i.binder&&i.binder.destroy())}null!==this._timeAxisWidget&&(this._timeAxisWidget.destroy(),this._timeAxisWidget=null),null!==this._definitionsViewModel&&this._definitionsViewModel.destroy(),this._hotkeys&&(this._hotkeys.destroy(),this._hotkeys=null),this._mainDiv.removeEventListener("wheel",this._onWheelBound),window.removeEventListener("keydown:chart_"+this._id,this._keydownEventListener),super.destroy(),this._chartSession.criticalError().unsubscribe(this,this._onChartSessionCriticalError),this._chartSession.isConnected().unsubscribe(this._boundOnChartSessionIsConnectedChanged),this._chartSession.destroy()}title(){return s("Chart Properties")}symbolProperty(){return this._model.mainSeries().properties().shortName?this._model.mainSeries().properties().shortName:this._model.mainSeries().properties().symbol}loadContent(e,t){this.screen.show();this.isMaximizedPane()&&this.toggleMaximizePane();for(var i,r=this._model.model().dataSources(),s=0;s<r.length;s++){var n=r[s];n!==this._model.mainSeries()&&this._model.model().removeSource(n,!0)}this._model.disconnect(),this.activePaneWidget=null,
this._model.mainSeries().purgeSymbolInfo(),e.loading=!0,this._content=e,this._initialLoading=Boolean(t);for(s=0;s<e.panes.length;++s)for(var o=0;o<e.panes[s].sources.length;++o)if(e.panes[s].sources[o].state.symbol){i=e.panes[s].sources[o].state;break}if(!i)throw Error("An error occured while determining main series ion the chart");this._properties.mainSeriesProperties.mergeAndFire({visible:!0,symbol:i.symbol,timeframe:"",onWidget:this._onWidget,interval:i.interval||"D",style:i.style}),this._init(),this._model.undoHistory().clearStack()}_contentSeriesProperties(){if(this._content)for(var e=this._content.panes.length;e-- >0;)for(var t=this._content.panes[e].sources,i=t.length;i-- >0;)if("MainSeries"===t[i].type)return t[i].state}updateUndoRedo(){this._model&&(this.actions().undo.update({disabled:this._model.undoHistory().undoStack().isEmpty()}),this.actions().redo.update({disabled:this._model.undoHistory().redoStack().isEmpty()}))}createSessionBreaksActions(e){var t=new W({label:s("Session Breaks"),checkable:!0,statName:"ToggleSessionBreaks"});t.binder=new h(t,this._model.chartModel().sessions().properties().graphics.vertlines.sessBreaks.visible,this.model(),"Session Breaks"),this._actions.sessionBreaks=t}updateActionForIntradayOnly(e){e&&e instanceof W&&e.update({disabled:this.model().mainSeries().isDWM()})}containsVolume(){return this.model().dataSources().some((function(e){return e instanceof k&&"Volume"===e.metaInfo().shortId}))}containsStudyByPredicate(e){return!!this._model&&this._model.dataSources().some((function(t){if(!(t instanceof k))return!1;var i=t.metaInfo();return e(i)}))}containsStudy(e){return this.containsStudyByPredicate((function(t){return t.id===e||t.fullId===e}))}isSmall(){return this._width()<550||this._height()<300}onWidget(){return this._onWidget}onCmeWidget(){return"cme"===this.widgetCustomer()}widgetCustomer(){return this._widgetCustomer}resize(){var e=this._height()+"px",t=this._width()+"px";this._mainDiv.style.height=e,this._mainDiv.style.width=t,this._elMainTable.style.height=e,this._elMainTable.style.width=t,this._resizeHandler&&this._mainDiv&&this._resizeHandler()}chartSession(){return this._chartSession}onLineCancelled(){z.resetToCursor()}_startSpinner(e){this._spinner||e&&(this._spinner=(new he).spin(e))}isJustClonedChart(){return!!(this._options||{}).justCloned}applyOverrides(e){var t={};for(var i in e)i.startsWith("mainSeriesProperties.priceAxisProperties")||(t[i]=e[i]);applyPropertiesOverrides(this.properties(),null,!1,t,null),this._model&&(applyPropertiesOverrides(this._model.model().properties(),null,!1,t),applyPropertiesOverrides(this._model.mainSeries().properties(),null,!1,t,"mainSeriesProperties"))}applyStudiesOverrides(e){de.mergeDefaultsOverrides(e),this._applyStudiesOverrides()}setActive(e){this._isActive=e,_e()&&(e&&this.selectPointMode().value()?this.startTrackingMode():this.exitTrackingMode()),this._paneWidgets.forEach((function(e){e.update()})),e||this.model().selectionMacro((function(e){e.clearSelection()}))}isActive(){return this._isActive}trackTime(){
return this._chartWidgetCollection.lock.trackTime}crossHairSyncEnabled(){return this._chartWidgetCollection.lock.crosshair.value()}isMultipleLayout(){return ye(this._chartWidgetCollection.layout.value())}selectPointMode(){return this._model.model().selectPointMode()}cancelRequestSelectPoint(){this._model.model().cancelRequestSelectPoint()}requestSelectPoint(e,t){var i=this;return new Promise((function(r,s){if(a()){z.resetToCursor(!0),i._model.lineBeingCreated()&&i._model.cancelCreatingLine();var n=!1,o={};i._model.model().onPointSelected().subscribe(o,(function(e,t){n=!0,i._isVisible.unsubscribe(a),i._hideHint(),r({point:e,pane:t})}),!0),i._model.model().requestSelectPoint(e),i.startTrackingMode(),void 0!==t&&i._showHint(t),i._isVisible.subscribe(a),i.selectPointMode().subscribe((function(){setTimeout((function(){n||(i.selectPointMode().value()||i._hideHint(),i._model.model().onPointSelected().unsubscribeAll(o),i._isVisible.unsubscribe(a),s("cancelled"))}))}),{once:!0})}function a(){return!!i.isVisible()||(s("Chartwidget must be visible"),i.cancelRequestSelectPoint(),!1)}}))}showReplayOrderConfirmationDialog(){return this.model().isInReplay()?new Promise((function(e,t){L({text:s("You are in the chart replay mode. An order will be placed in real-time. Do you still want to place the order?"),onConfirm:function(t){e(),t.dialogClose()},onClose:t})})):Promise.resolve()}_addPerfMark(e){be("ChartWidget."+this._id+"."+e)}requestFullscreen(){this._options.requestFullscreen()}getResizerDetacher(){return this._options}_createHint(){if(null===this._hintDefferedPromise){var e=xe();this._hintDefferedPromise=e;var t=this;Promise.all([i.e(69756),i.e(6884),i.e(73935),i.e(26166)]).then(i.bind(i,90049)).then((function(i){e.resolve(new i.ChartEventHintRenderer(t._chartWidgetCollection.getContainer()))}))}return this._hintDefferedPromise?a(this._hintDefferedPromise).promise:null}_showHint(e){if(d.enabled("popup_hints"))if(null!==this._activeHint)this._activeHint.show(e);else{var t=this,i=this._createHint();null!==i&&i.then((function(i){if(null!==i){if(t._activeHint=i,void 0===e)return;t._activeHint.show(e)}}))}}_hideHint(){null!==this._activeHint&&this._activeHint.hide()}}e.exports.ChartWidget=De,e.exports.trackingModeIsAvailable=Ce},69202:(e,t,i)=>{"use strict";var r=i(96276),s=i(16282).assert,n=i(57137).createDeferredPromise,o=i(86913).layouts,a=i(73038),l=i(68724).supportTouch,c=i(68724).isIE,u=i(68724).isEdge,d=i(67413).createUndoHistory,h=i(14397),p=i(26083),_=i(11877),m=i(88001),f=i(6493),g=i(22842),v=i(50225).SetChartLayoutCommand,S=i(65066),y=i(43137).ResizerDetacherState,b=i(80633).delegateToPromise,w=(i(10611).UserDefinedBarsMarks,i(51095).UserDefinedTimescaleMarks,i(87380).getLogger("Chart.ChartWidgetCollection")),P=i(53549).preventDefaultForContextMenu,C=i(29098).trackEvent,T=i(27247).ChangeToolBarsThemeUndoCommand;const{getCurrentTheme:x}=i(34698)
;var I=i(97786),L=i(71004).rangesAreEqual,M=i(97205).GeneralChartPropertiesRenderer,E=i(88296).clientSnapshot,A=i(19453).setLastUsedResolution,k=i(84199).CompareDialogRenderer,D=i(40142).isOnMobileAppPage,R=i(35252).CollectionViewMode,N=i(44020).mediaState,O=i(7456).SwapChartsUndoCommand,V=i(8279).ToastsFactory,{trackGoProFeature:B}=i(82655),F=i(3851).enabled,W=i(3851).getConfig,U=i(5803).ProductFeatures,H=i(23946).createGoProDialog,z=i(27366).TimingsMeter,j=i(63145).PublishedChartsTimeline,Y=i(11117).detachToPopup,G=i(11117).screenBox,q=i(27609).showMagnetModeNotification,X=i(59836).pushChartPage,$=i(98006).isFeatureEnabled,K=i(83291).reconnectChartApi,J=i(17442).marketStatusText,Z=i(28771),Q=Z.ChartStorageChangesSubscription,ee=Z.isChartStorageChangesSubscriptionSupported,te=i(97786).STYLE_RANGE,ie=i(2459).Interval,re=i(79407).showConfirm,se=i(82948).DateTimeWithTzFormatter,ne=i(72674),oe=ne.applyIndicatorsToAllChartsImpl,ae=ne.applyIndicatorToAllChartsImpl,le=ne.lineToolsAndGroupsDTOsImpl,ce=ne.getStateForChartImpl,ue=ne.getAsyncStateForChartImpl,de=ne.resetLineToolsInvalidatedImpl,he=ne.applyLineToolUpdateNotificationImpl,pe=ne.createClipboardHandler,_e=ne.chartsSymbolsImpl,me=ne.setBrokerImpl,fe={saveChartEnabled:!0,takeScreenshotEnabled:!0,publishedChartsEnabled:!0};e.exports=function(e){var t=this,Z=Object.assign({},fe,e),ge=1,ve=2,Se=0,ye=0,be=new S,we=Z.readOnly||!1,Pe=[],Ce=0,Te=new S,xe=new S,Ie=null,Le="s",Me=new S;Me.setValue(R.ForceFullscreen);var Ee=[],Ae=!1,ke=!1,De=!1,Re=new S(!1),Ne=new S(!1),Oe=new S(!1),Ve=new S(TVSettings.getBool("chart.syncCrosshair",!0)),Be=p.createGroup({desc:"Layout"}),Fe=null,We=null,Ue=Ve.value();Ve.subscribe((function(e){Ue=e=!!e,TVSettings.setValue("chart.syncCrosshair",e);for(var t=0;t<Pe.length;++t){var i=Pe[t].chartWidget;i.hasModel()&&i.model().model().lightUpdate()}}));var He=new S(Le),ze=Z.resizerBridge.width,je=Z.resizerBridge.height,Ye=null;void 0!==Z.padding&&(ve=Z.padding),void 0!==Z.topOffset&&(ge=Z.topOffset),void 0!==Z.edge&&(Se=Z.edge),void 0!==Z.border&&(ye=Z.border);var Ge=Z.widgetOptions||{},qe=Z.metaInfo||{},Xe={id:new S(qe.id||null),name:new S(qe.name),description:new S(qe.description),username:new S(qe.username),uid:new S(qe.uid),lastModified:new S(qe.lastModified)},$e=d();$e.onChange().subscribe(null,(function(e){m.emit("undo_redo_state_changed",e)}));var Ke=Z.resizerBridge.container.value();Ke.addEventListener("contextmenu",P);var Je=n(),Ze=new r,Qe=new r,et=new r,tt=new S(!1);function it(){tt.setValue(Pe.some(e=>{const t=e.chartWidget.lineToolSynchronizer();return null!==t&&t.hasChanges().value()}))}function rt(){Pe.forEach((function(e){const t=e.chartWidget;t.onZoom().unsubscribeAll(this),t.onScroll().unsubscribeAll(this),t.withModel(null,()=>{const e=t.lineToolSynchronizer();null!==e&&(e.hasChanges().unsubscribe(it),it())})}))}var st,nt=null,ot=null,at=null;Z.seriesControlBarEnabled&&(st=Se+ye+"px",(nt=document.createElement("div")).style.left=st,nt.style.right=st,nt.style.bottom=st,nt.classList.add("chart-toolbar","chart-controls-bar"),
Ke.appendChild(nt),Promise.all([i.e(23876),i.e(29448),i.e(37610),i.e(76473),i.e(43894),i.e(33996),i.e(94595),i.e(60700),i.e(87936),i.e(19843),i.e(10446),i.e(47607),i.e(81778),i.e(19513),i.e(67916),i.e(73935),i.e(45867),i.e(1529),i.e(36982),i.e(38464),i.e(80594),i.e(9353),i.e(47260)]).then(i.bind(i,3229)).then(({BottomToolbarRenderer:e})=>{var i=Z.resizerBridge,s=[i.container.spawn(),i.width.spawn(),i.height.spawn()],n=i.container.value(),o=new r,a=function(){o.fire()};s.forEach((function(e){e.subscribe(a)})),ot=new e(nt,o,(function(){var e=n.getBoundingClientRect(),t=ht();return t.top=e.top+t.top,t.left=e.left+t.left,t}),t,ChartApiInstance,Ge,Z.seriesControlBar),at=function(){null!==ot&&(ot.destroy(),ot=null,nt.remove(),nt=null),s.forEach((function(e){e.destroy()})),o.destroy()}}));var lt=new M(t),ct=new k(t),ut=null;function dt(){return{undoHistory:$e,chartWidgetsDefs:Pe,chartsCountToSave:pt,actualLayoutCount:_t,savedChartWidgetOptions:Ee,activeChartWidget:be,options:Z,parent:Ke,toastsFactory:ut}}function ht(){var e=Se+ye,t=nt?nt.offsetHeight:0;return{width:ze.value()-2*e,height:je.value()-ge-t-e,top:ge,left:e}}function pt(){return $("save_all_charts_in_layout")?Pe.length+Ee.length:_t()}function _t(){return o[Le].count}function mt(e,t,i,r,s){return ce(dt(),e,t,i,r,s)}function ft(){var e;e=Ye?[Ye]:Pe.slice(0,Ie.count).filter((function(e){return!e.hiddenInLayout.value()}));for(var t=0;t<e.length;t++)gt(e[t],t,e.length)}function gt(e,t,i){var r=Ie.sizer(ht(),t,i,ve+ye);r.width=Math.max(Math.round(r.width),0),r.height=Math.max(Math.round(r.height),0),r.top=Math.round(r.top),r.left=Math.round(r.left),e.metrics=r;var s=e.container.value();s&&(s.style.width=r.width+"px",s.style.height=r.height+"px",s.style.top=r.top+"px",s.style.left=r.left+"px",s.classList.toggle("single-visible",1===i)),e.width.setValue(r.width),e.height.setValue(r.height)}ut=new V(Z.resizerBridge,(function(){return nt?nt.offsetHeight:0})),ze.subscribe(ft),je.subscribe(ft),this.updateLayout=ft;var vt,St=!1,yt=["phone","phone-vertical"];function bt(e,t){Z.mobileForceChartMaximizeEnabled&&(!yt.includes(N.device)||t&&yt.includes(t)?yt.includes(N.device)||t&&!yt.includes(t)||(St=!1):St=!0)}function wt(){window.is_authenticated&&(St?Me.value()===R.ForceFullscreen&&(vt=Ye,be.value().requestFullscreen()):vt||(Lt(null),Nt()))}function Pt(e){return e.rdState.owner.value()!==e}function Ct(){return ut.getChartToasts()}function Tt(e){var r;e=Object.assign({chartWidgetCollection:t,isActive:0===Pe.length,barsMarksContainersFactory:xt,undoHistory:$e,readOnly:we,initialLoading:De,getToasts:Ct},e||{}),void 0!==ci&&(e.customLegendWidgetFactories=new Map(ci));var s=document.createElement("div");s.classList.add("chart-container"),s.style.position="absolute",s.style.overflow="hidden",Ke.appendChild(s),(c||u)&&(s.style.touchAction="none",s.style.msTouchAction="none"),Z.className&&s.addClass(Z.className);var n={alive:new S(!0),container:new S(s),width:new S,height:new S,collapsed:new S(!1),hiddenInLayout:new S(!1),visible:new S,rdState:new y,requestFullscreen:function(){
Te.value()&&(Lt(n),be.setValue(n.chartWidget))},exitFullscreen:function(){be.value()===n.chartWidget&&Lt(null)},detachable:Te,fullscreenable:Te,fullscreen:new S};function o(){n.visible.setValue(!n.hiddenInLayout.value()&&Z.resizerBridge.visible.value())}n.detach=function(){Y(n.rdState,Object.assign({title:window.t("Detached chart")},G(n.rdState.bridge().container.value())))},n.rdState.pushOwner(n),n.rdState.owner.subscribe((function(e){e!==n&&(Promise.all([i.e(63973),i.e(50645)]).then(i.bind(i,49103)).then(e=>{e.show(n.rdState.bridge().container.value())}),C("GUI","Chart detached")),Ye===n&&Lt(null),Rt(Le)})),Pe.push(n),n.hiddenInLayout.subscribe((function(){n.chartWidget.setVisible(!n.hiddenInLayout.value()),o()})),n.collapsed.subscribe(()=>n.chartWidget.setCollapsed(n.collapsed.value())),Z.resizerBridge.visible.subscribe(o),o(),function(e){for(var t=0,i=0,r=0;r<Ie.count;r++){Pe[r]&&Pt(Pe[r])||(Pe[r]===e&&(i=t),t++)}gt(e,i,t)}(n),Object.assign(e,n.rdState.bridge());var l=e.content?e.content.chartId:Et(Mt);return n.chartWidget=r=new a.ChartWidget(e,l,Xe.uid.value()),Fe&&n.chartWidget.setSaveChartService(Fe),we||(n.timingsMeter=new z(String(Pe.length-1)),n.chartWidget.setTimingsMeter(n.timingsMeter)),e.containsData?r.finishInitWithoutConnect():r.connect(),r.withModel(null,(function(){var e=r.model().model();li.forEach((function(t,i){e.addCustomSource(i,t.factory,t.layer)}))})),Ot(),Vt(),Ze.fire(r),r}function xt(e){var t=[];if(Z.publishedChartsEnabled){var i=new j(e,It);t.push(i)}return t}function It(e){e=Object.assign({},e,{chartWidgetCollection:t}),X(e)}function Lt(e){Ye!==e&&(Ye=e,Rt(Le))}function Mt(e){return Pe.some((function(t){return t.chartWidget&&t.chartWidget.id()===e}))}function Et(e){for(var t=1;e(""+t);)t++;return""+t}function At(){Pe.every(e=>e.chartWidget.hasModel())&&(Ot(),m.emit("layout_changed"))}function kt(e,t){const i=Tt(Object.assign({},Ge,Ee.shift()||function(){const e=be.value();if(e){const t=e.state();return t.chartId=Et(Mt),t.shouldBeSavedEvenIfHidden=!1,{content:t}}}(),0===e||Re.value()?void 0:{defSymbol:null}));return i.modelCreated().subscribe(null,t||At,!0),i}function Dt(e){e.hiddenInLayout.setValue(!0);const t=e.container.value();t.parentNode&&t.parentNode.removeChild(t),e.fullscreen.setValue(!1)}function Rt(e){e in o||(e="s"),rt();var t=Le,i=o[e].count;m.emit("layout_about_to_be_changed",e),He.setValue(e),Le=e,Ie=o[e];for(var r=i;r<Pe.length;r++){Pt(n=Pe[r])&&n.rdState.bridge().attach()}if(St&&Me.value()===R.ForceFullscreen)if(Ye){var s=Pe.indexOf(Ye);(s<0||s>=i)&&(Ye=Pe[0])}else Ye=Pe[0];else t!==e&&Ye&&(Ye=null);Ye&&be.setValue(Ye.chartWidget);for(r=0;r<i||r<Pe.length;r++){var n=Pe[r],a=r>=i&&(!n||!Pt(n));if(Ye?Ye===n:r<i&&(!n||!Pt(n))){if(n){if(Ke.appendChild(n.container.value()),n.hiddenInLayout.setValue(!1),ke){var l=Ee.shift();l&&(Ae=!0,n.chartWidget.loadContent(l.content,De),Ae=!1)}}else kt(r),n=Pe[r];n.container.value().classList.toggle("multiple",i>1),n.fullscreen.setValue(Ye===n),n.collapsed.setValue(a)}else n?(Dt(n),
n.collapsed.setValue(a)):St&&Me.value()===R.ForceFullscreen&&(kt(r),Dt(Pe[r]),Pe[r].collapsed.setValue(a))}ft(),Ot(),function(){for(var e=Ie.count,t=e,i=0;i<e;i++)Pe[i]&&Pt(Pe[i])&&t--;xe.setValue(t),Te.setValue(t>1)}(),At(),Pe.forEach((function(e){const t=e.chartWidget;t.onZoom().subscribe(this,e=>Qe.fire(e)),t.onScroll().subscribe(this,()=>et.fire()),t.withModel(null,()=>{const e=t.lineToolSynchronizer();null!==e&&(e.hasChanges().subscribe(it),it())})})),De||Nt(),xe.value()<1&&i>0&&Pe[i-1].rdState.bridge().attach()}function Nt(){"s"===Le||Ye?Me.setValue(R.ForceFullscreen):Me.setValue(R.Multichart)}function Ot(){var e=Math.min(Ie.count,Pe.length)-1;if(e<0)be.deleteValue();else{var t=Ce;t<0&&(t=0),t>e&&(t=e),be.setValue(Pe[t].chartWidget)}}function Vt(){for(var e=Pe.length;e--;){var t=e===Ce;Pe[e].container.value().classList.toggle("active",t),Pe[e].container.value().classList.toggle("inactive",!t)}}function Bt(e,t){var i=Pe.slice(0,Ie.count).filter((function(e){return!Pt(e)})).map((function(e,t,i){return{def:e,metrics:Ie.sizer({top:0,left:0,width:256,height:256},t,i.length,0)}})).sort((function(e,t){return e.metrics.top-t.metrics.top||e.metrics.left-t.metrics.left})).map((function(e){return e.def}));if(i.length<2)return null;var r=i.indexOf(e);return-1===r?null:i[r=(r+(t?i.length-1:1))%i.length]}function Ft(e){var t=Bt(Pe[Ce],e);t&&(be.setValue(t.chartWidget),Ye&&Rt(Le))}function Wt(e,t){var i=Pe.findIndex((function(t){return t.chartWidget===e})),r=Pe.findIndex((function(e){return e.chartWidget===t}));if(-1===i||-1===r)throw new Error("chart is not in the layout");var s=Pe[i],n=Pe[r];Pe[i]=n,Pe[r]=s,Ce===i?Ce=r:Ce===r&&(Ce=i),ft()}var Ut=new r,Ht=new S,zt=new S;function jt(e,t){var i=e.model(),r=i.mainSeries().properties().style;i.setChartStyleProperty(r,t,"Change Series Style")}var Yt=null;function Gt(e){var t=e.mainSeries().properties();t.style.subscribe(null,qt),qt(t.style),e.model().onSelectedSourceChanged().subscribe(null,Xt),Xt(e.selection().allSources())}function qt(e){Ht.setValue(e.value())}function Xt(){var e=Yt.model();zt.setValue(e.selection().allSources())}function $t(e){for(var t=!1,i=0;i<Pe.length;i++){var r=Pe[i].chartWidget;if(r.hasModel())r.model().mainSeries().properties().symbol.value()!==e&&(t||($e.beginUndoMacro("Change Symbol"),t=!0),r.setSymbol(e))}t&&$e.endUndoMacro()}be.subscribe((function(e){if(e){for(var t,i=Pe.length;i--;)if(Pe[i].chartWidget===e){t=i;break}if(!isFinite(t))throw new Error("Cannot make detached ChartWidget active");if(Ce!==t){Ye&&(Pt(Pe[t])||(Ye=Pe[t])),Ce=t,Vt();for(i=Pe.length;i--;)Pe[i].chartWidget!==e&&Pe[i].chartWidget.setActive(!1);mi(),e.setActive(!0)}!function(e){if(Yt!==e){if(Yt&&(Yt.modelCreated().unsubscribe(null,Gt),Yt.hasModel())){var t=Yt.model();t.mainSeries().properties().style.unsubscribe(null,qt),t.model().onSelectedSourceChanged().unsubscribe(null,Xt),Yt=null}e&&(Yt=e,e.hasModel()?Gt(e.model()):e.modelCreated().subscribe(null,Gt))}}(e)}}),{callWithLast:!0});var Kt=!1;function Jt(e){if(A(e),Kt=!0,Ne.value()){for(var t=!1,i=0;i<Pe.length;i++){
var r=Pe[i].chartWidget;r.model().mainSeries().properties().interval.value()!==e&&(t||($e.beginUndoMacro("Change Resolution"),t=!0),r.setResolution(e))}t&&$e.endUndoMacro()}else be.value().setResolution(e);Kt=!1}function Zt(){var e=[];if(Ne.value())for(var t=0;t<Pe.length;t++)e.push(Pe[t].chartWidget);else e.push(be.value());return e}var Qt=!1;function ei(e){var t=Math.max(1,window.devicePixelRatio||1);if(e&&e.onlyActiveChart||Ye)return{layout:"s",hidpiRatio:t,theme:x().name,charts:[be.value().images(e)]};for(var i=[],r=Ie.count,s={showCollapsedStudies:(e=e||{}).showCollapsedStudies,status:e.status},n=0;n<Pe.length&&n<r;n++)i.push(Pe[n].chartWidget.images(s));return{layout:Le,hidpiRatio:t,theme:x().name,charts:i}}var ti=new r;function ii(){const e={snapshotUrl:Z.snapshotUrl,sendClientImage:!0};e.asyncSave=!window.TVD;const i=D("any");return(i?f.getImageOfChartSilently:f.copyToClipboardImageOfChart)(t,e).then((function(e){return m.emit("onScreenshotReady",e),i||m.emit("onServerScreenshotCopiedToClipboard"),e}))}function ri(){Z.resizerBridge.requestFullscreen()}function si(){Z.resizerBridge.exitFullscreen()}function ni(){return Z.resizerBridge.fullscreenable}function oi(){return Z.resizerBridge.fullscreen}function ai(e){if(0!==Pe.length){for(var t=Pe.length;t--;)Pe[t].chartWidget.setActive(!1);Pe[Ce].chartWidget.setActive(e)}}we||(Be.add({desc:"Switch active chart",hotkey:9,handler:function(){Ft(!1)}}),Be.add({desc:"Switch active chart",hotkey:_.Modifiers.Shift+9,handler:function(){Ft(!0)}})),Be.add({desc:"Fullscreen mode",hotkey:_.Modifiers.Shift+70,isDisabled:g.enabled("widget")||!ni().value(),handler:function(){oi().value()?si():ri()}}),Z.takeScreenshotEnabled&&(Be.add({desc:"Screenshot server",hotkey:_.Modifiers.Alt+83,handler:function(){ii()}}),D("any")||(Be.add({desc:"Download client screenshot",hotkey:_.Modifiers.Mod+_.Modifiers.Alt+83,handler:function(){f.downloadClientScreenshot(t)}}),Be.add({desc:"Copy client screenshot",hotkey:_.Modifiers.Mod+_.Modifiers.Shift+83,handler:function(){f.copyToClipboardClientScreenshot(t).then(()=>{m.emit("onClientScreenshotCopiedToClipboard")})}}))),Z.saveChartEnabled&&Be.add({desc:"Save Chart Layout",hotkey:_.Modifiers.Mod+83,handler:function(){Ut.fire()}});var li=new Map,ci=new Map;const ui=pe(dt());function di(e){if(g.enabled("charting_library_base"))return e;if("s"===e||Ge.containsData||we||F(U.MULTIPLE_CHARTS)&&W(U.MULTIPLE_CHARTS).limit>=o[e].count)return e;var t="s",i=1,r=W(U.MULTIPLE_CHARTS).limit;for(var s in o)if(o.hasOwnProperty(s)){var n=o[s].count;n<=r&&n>i&&(t=s,i=n)}return B("multipleCharts"),H({feature:"multipleCharts"}),t}function hi(e,t){if(ke=!0,De=Boolean(t),Ee=[],e){e.charts||(e={layout:"s",charts:[e]});var i=new Set;e.charts.forEach((function(e){e.chartId&&i.add(e.chartId)})),e.charts.forEach((function(e){if(!e.chartId){var t=Et((function(e){return i.has(e)}));i.add(t),e.chartId=t}})),Le=di(e.layout||"s");for(var r=0;r<e.charts.length;r++){var s=e.charts[r];Ee.push({content:s})}e.symbolLock&&Re.setValue(!0),e.intervalLock&&Ne.setValue(!0),
e.trackTimeLock&&Oe.setValue(!0)}Rt(Le),"s"===Le||Z.mobileForceChartMaximizeEnabled||Me.setValue(R.Multichart),h.init(),Ge.onWidget||h.properties().magnet.subscribe(null,_i),h.tool.subscribe(fi),h.tool.subscribe(mi),ke=!1,De=!1}Z.globalEvents&&ui.listen(),Object.assign(this,{createChartWidget:Tt,getAll:function(){return Pe.map((function(e){return e.chartWidget}))},destroy:function(){ti.fire(),ai(!1),null!==at&&(at(),at=null),rt(),Pe.forEach((function(e){void 0!==e.timingsMeter&&e.timingsMeter.destroy(),e.chartWidget.destroy()})),Z.resizerBridge.remove(),window.removeEventListener("resize",ft),N.off("changeDevice",bt),Z.mobileForceChartMaximizeEnabled&&!Z.handleMaximizedChartOnResizeDisabled&&N.off("changeDevice",wt),Ge.onWidget||h.properties().magnet.unsubscribe(null,_i),h.tool.unsubscribe(mi),h.tool.unsubscribe(fi),Je.resolve(),Ke.remove(),li.clear(),ci.clear(),Be.destroy(),We&&We.destroy(),ui&&ui.destroy()},onAboutToBeDestroyed:ti,layout:He.readonly(),setLayout:Rt,activeChartWidget:be,viewMode:Me,activeChartStyle:Ht.readonly(),setChartStyleToWidget:function(e,t){if(t||(t=be.value()),t){for(var i=!1,r=Zt(),s=0;s<r.length;s++){var n=r[s].model().model();if(n.isInReplay()&&!n.isSeriesStyleSupported(e)){i=!0;break}}i?re({text:window.t("Bar Replay isn't available for this chart type. Do you want to exit Bar Replay?"),onConfirm:function(i){jt(t,e),i.dialogClose()}}):jt(t,e)}},selectedSources:zt.readonly(),metaInfo:Xe,state:function(e,i,r,s){for(var n=[],o=pt(),a=0;a<o;a++){var l=mt(a,e,i,r,s);l&&n.push(l)}var c={name:t.metaInfo.name.value(),layout:Le,charts:n};return Re.value()&&(c.symbolLock=1),Ne.value()&&(c.intervalLock=1),Oe.value()&&(c.trackTimeLock=1),c},lineToolsAndGroupsDTOs:function(){return le(dt())},resetLineToolsInvalidated:function(e,t){return de(dt(),e,t)},applyLineToolUpdateNotification:he.bind(null,Pe),asyncState:function(){for(var e,t=[],i=pt(),r=0;r<i;r++)t.push((e=r,ue(dt(),e)));return Promise.all(t).then((function(e){for(var t={charts:[]},i=0;i<e.length;i++)t.charts.push(e[i]);return t}))},readOnly:function(){return we},onZoom:function(){return Qe},onScroll:function(){return et},resizerBridge:function(){return Z.resizerBridge},lock:{symbol:Re,setSymbolLockWithUndo:function(e){if(e!==Re.value()){if($e.beginUndoMacro("Symbol Lock"),e)for(var t=be.value(),i=t.getSymbol(),r=0;r<Pe.length;r++){var s=Pe[r].chartWidget;s!==t&&(s.getSymbol()!==i&&s.setSymbol(i))}$e.setWatchedValue(Re,e,"Symbol Lock"),$e.endUndoMacro()}},interval:Ne,setIntervalLockWithUndo:function(e){if(e!==Ne.value()){if($e.beginUndoMacro("Interval Lock"),e)for(var t=be.value(),i=t.getResolution(),r=0;r<Pe.length;r++){var s=Pe[r].chartWidget;s!==t&&(s.getResolution()!==i&&s.setResolution(i))}$e.setWatchedValue(Ne,e,"Resolution Lock"),$e.endUndoMacro()}},crosshair:Ve,trackTime:Oe,setTrackTimeWithUndo:function(e){Oe.value()!==e&&$e.setWatchedValue(Oe,e,"Track Time")}},setSymbol:function(e){Re.value()?$t(e):be.value().setSymbol(e)},setResolution:function(e){if(!(Ae||Qt||Kt)){var t=!1;if(ie.isRange(e))for(var i=Zt(),r=0;r<i.length;r++){
var s=i[r].model().model();if(s.isInReplay()&&s.mainSeries().style()!==te){t=!0;break}}t?re({text:window.t("Bar Replay isn't available for this chart type. Do you want to exit Bar Replay?"),onConfirm:function(t){Jt(e),t.dialogClose()}}):Jt(e)}},setTimeFrame:function(e){if(!Ae&&!Qt){if(Qt=!0,Ne.value())for(var t=0;t<Pe.length;t++){var i,r=Pe[t].chartWidget;null!==(i=r.model().model().appliedTimeFrame().value())&&L(i,e)||r.loadRange(e)}else null!==(i=be.value().model().model().appliedTimeFrame().value())&&L(i,e)||be.value().loadRange(e);Qt=!1}},updateLayout:ft,setChartLayoutWithUndo:function(e){return e=di(e),He.value()!==e&&($e.pushUndoCommand(new v(t,e)),!0)},images:ei,clientSnapshot:function(e){const t=Z.widgetOptions.customerReadableName||"TradingView.com";let i=e||{};const r=Boolean(i.hideResolution),s={hideResolution:r};{let e=be.value().properties().childs().timezone.value();if("exchange"===e){const t=be.value().model().mainSeries().symbolInfo();e=t?t.timezone:e}const r=new se({timezone:e,dateFormat:"MMM dd, yyyy"}).format(Date.now()/1e3),s=Xe.username.value(),n=!s||we||Ge.onWidget?window.t("Published on {customer}, {date}"):window.t("{userName} published on {customer}, {date}"),o=[{text:n.split(/{date}/)[0].format({userName:s,customer:t})},{text:r}],a=[{text:n.format({userName:s,customer:t,date:r})}],l={header:N.isPhoneSizeDevice()?o:a};i=Object.assign({},l,i)}return E(ei({showCollapsedStudies:!1,status:s,hideResolution:r}),i)},tags:function(){for(var e=[],t=0;t<Pe.length&&t<Ie.count;t++)e=e.concat(Pe[t].chartWidget.tags());return e=(e=Array.from(new Set(e))).map((function(e){return e.toLowerCase().replace(/\W+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}))},syncCrosshair:function(e,t,i,r){if(i||Ue)for(var s=Ie.count,n=0;n<Pe.length&&n<s;n++){var o=Pe[n].chartWidget;o!==t&&(Pe[n].rdState.bridge().visible.value()&&o.hasModel()&&o.model().model().setExternalPosition(e,r))}},syncScroll:function(e,t){if(Oe.value()){var i=Ie.count;$e.beginUndoMacro("Sync Time");for(var r=0;r<Pe.length&&r<i;r++){var s=Pe[r].chartWidget;if(s.hasModel()){var n=s.model().model();if(n===t)continue;n.syncTimeWithModel(t,e)}}$e.endUndoMacro()}},setSymbolAll:$t,clearChartMetaInfo:function(){Xe.id.setValue(null),Xe.uid.setValue(void 0),Xe.name.setValue(void 0)},takeScreenshot:function(){var e={snapshotUrl:Z.snapshotUrl,sendClientImage:!0};return e.asyncSave=!window.TVD,f.getImageOfChartSilently(t,e).then((function(e){return m.emit("onScreenshotReady",e),e}))},takeServerScreenshot:ii,loadContent:hi,purgeUnusedWidgets:function(){for(var e=o[Le].count;e<Pe.length;e++)Pe[e].chartWidget.destroy();Pe.splice(o[Le].count)},applyOverrides:function(e){for(var t=0;t<Pe.length;t++)Pe[t].chartWidget.applyOverrides(e)},applyStudiesOverrides:function(e){for(var t=0;t<Pe.length;t++)Pe[t].chartWidget.applyStudiesOverrides(e)},switchChart:Ft,startFullscreen:ri,exitFullscreen:si,fullscreen:oi,fullscreenable:ni,destroyPromise:function(){return Je.promise()},chartWidgetCreated:function(){return Ze},saveKeysPressed:function(){return Ut},
getContainer:function(){return Ke},onWidget:Ge.onWidget,applyTheme:function(e,t,i,r,s,n,o){void 0===n&&(n=!0);const a=x().name;return Promise.all(t?[be.value()]:Pe.concat(Ee).map((e,t)=>e.chartWidget?e.chartWidget:new Promise(e=>{const i=kt(t,()=>e(i));Dt(Pe[t])}))).then(t=>{o?(s&&new T(a,r,n).redo(),t.forEach((function(t){t.model().model().restoreTheme(e,i,o)}))):($e.beginUndoMacro("Apply Chart Theme"),s&&$e.pushUndoCommand(new T(a,r,n)),t.forEach((function(t){t.model().model().restoreTheme(e,i)})),$e.endUndoMacro())})},applyIndicatorsToAllCharts:function(e){oe(dt(),e)},applyIndicatorsToAllChartsAvailable:function(){return!we&&_t()>1},applyIndicatorToAllCharts:function(e,t,i,r){ae(dt(),e,t,i,r)},setActive:ai,inlineChartsCount:xe.readonly(),revertToInline:function(){if(!St||Me.value()!==R.ForceFullscreen){Lt(null);for(var e=0;e<Pe.length;e++)Pe[e].rdState.bridge().attach()}},chartMarketStatuses:function(){return Pe.map((function(e){var t=e.chartWidget.hasModel()?e.chartWidget.model().mainSeries().marketStatusModel():null;return null!==t?J(t.status()):"-"}))},chartSeriesStatuses:function(){return Pe.map((function(e){var t=e.chartWidget.hasModel()?e.chartWidget.model().mainSeries().status():null;return(null===t?"":I.SERIES_STATUS_TEXT[t])+" ("+t+")"}))},undoHistory:$e,lineToolSynchronizerHasChanges:tt,applyPreferencesToAllCharts:function(e){var t=e.model().preferences();Pe.forEach((function(i){i.chartWidget._model!==e&&i.chartWidget._model.applyPreferences(t)}))},getToasts:Ct,addCustomSource:function(e,t,i){s(!li.has(e),"Cannot create the same custom source multiple times"),li.set(e,{factory:t,layer:i});for(var r=0;r<Pe.length;++r){var n=Pe[r].chartWidget;n.hasModel()&&n.model().model().addCustomSource(e,t,i)}},removeCustomSource:function(e){s(li.has(e),"Cannot remove not created custom source"),li.delete(e);for(var t=0;t<Pe.length;++t){var i=Pe[t].chartWidget;i.hasModel()&&i.model().model().removeCustomSource(e)}},addCustomWidgetToLegend:function(e,t){s(!ci.has(e),"Cannot create the same custom widget in legend multiple times"),ci.set(e,t);for(var i=0;i<Pe.length;++i)Pe[i].chartWidget.addCustomWidgetToLegend(e,t)},setViewMode:function(e){Me.setValue(e)},moveActiveChartWithUndo:function(e){var t=Pe[Ce],i=Bt(t,e);i&&$e.pushUndoCommand(new O(Wt,t.chartWidget,i.chartWidget))},activeChartCanBeMoved:function(){return!(we||xe.value()<2||Pt(Pe[Ce]))},generalPropertiesDefinitions:function(){return be.value().generalPropertiesDefinitions()},reconnectChartApi:function(e){K(e)},setBroker:function(e){me(dt(),e)},setSaveChartService:function(e){Fe=e;for(var t=0;t<Pe.length;++t){Pe[t].chartWidget.setSaveChartService(e)}},getCompareDialogRenderer:function(){return ct},getChartPropertiesDialogRenderer:function(){return lt},clipboard:ui,chartsSymbols:function(){return _e(dt())}}),ee(this,Ge)&&(We=new Q(this)).beforeUnhibernating().subscribe(this,()=>{ne.reloadAllLineTools(dt())});var pi=null;function _i(e){e.value()&&null===pi&&Ct().then((function(e){null!==e&&null===pi&&(pi=q(e)).then((function(){pi=null}))}))}function mi(){
var e=be.value();Pe.forEach((function(t){t.chartWidget!==e&&t.chartWidget.updateCrossHairPositionIfNeeded()})),e&&e.updateCrossHairPositionIfNeeded()}function fi(){Pe.forEach((function(e){e.chartWidget.onToolChanged()}))}hi(Z.content,!0),He.subscribe((function(){Vt()})),He.hook=function(e){return e===this.value()?e:di(e)},we&&(He.writeLock=!0),window.addEventListener("resize",ft),Z.mobileForceChartMaximizeEnabled&&(N.on("changeDevice",bt),Z.handleMaximizedChartOnResizeDisabled||N.on("changeDevice",wt),bt(),wt());var gi=0;function vi(){0===--gi&&m.emitOnce("onChartReady")}if(Pe.forEach((function(e){if(e){gi++;var t=e.chartWidget;t.withModel(null,(function(){Z.metaInfo&&t.model().model().setChartSaveTime(1e3*Z.metaInfo.lastModified);var e=t.model().mainSeries();if(e.bars().size()>0||e.isStatusBad())vi();else{var i=e.dataEvents(),r=function(){vi(),i.barReceived().unsubscribe(null,r),i.completed().unsubscribe(null,r),i.error().unsubscribe(null,r)};i.barReceived().subscribe(null,r),i.completed().subscribe(null,r),i.error().subscribe(null,r)}}))}})),l()){var Si=h.tool.setValue;h.tool.setValue=function(){t.selectedSources.value()&&t.activeChartWidget.value().model().lineBeingCreated()&&t.activeChartWidget.value().model().cancelCreatingLine(),Si.apply(h.tool,arguments)}}Promise.all(Pe.map((function(e){return b(e.chartWidget.modelCreated()).promise}))).then((function(){return Promise.all(Pe.map((function(e){return b(e.chartWidget.model().mainSeries().dataEvents().symbolResolved()).promise})))})).then((function(){window.saver&&window.is_authenticated&&Z.widgetOptions.justCloned&&window.saver.saveChartSilently()})).catch(w.logError.bind(w))}},88296:(e,t,i)=>{"use strict";i.d(t,{clientSnapshot:()=>b});var r=i(72927),s=i(14563),n=i(64853),o=i(4543),a=i(14900),l=i(39304),c=i(32022),u=i(34698),d=i(91023),h=i(22842),p=i(5243);const _=(h.enabled("widget_logo"),!1);function m(e,t=null,i=null){let r={};if("number"==typeof e)return{relativePositions:{[e]:{l:t,t:i}},nextElementLeft:e,nextElementTop:e};const[s,...n]=e;if("v"===s){let e=null;for(const s of n){const n=m(s,t,i);r={...r,...n.relativePositions},i=n.nextElementTop,e=n.nextElementLeft}t=e}if("h"===s){let e=null;for(const s of n){const n=m(s,t,i);r={...r,...n.relativePositions},t=n.nextElementLeft,e=n.nextElementTop}i=e}return{relativePositions:r,nextElementTop:i,nextElementLeft:t}}const f=function(e){const t={};for(const i of Object.keys(e)){const r=m(e[i]).relativePositions;t[i]=r}return t}(d);function g(e,t,i,r){return(0,a.drawScaled)(e,r,()=>{e.fillText(i,t.x/r,t.y/r)}),e.measureText(i).width*r}function v(e){return e.map(e=>({...e,title:""}))}function S(e,t){const i=[{text:e.trim()}];for(const e of t)e.visible&&(""!==i[i.length-1].text&&i.push({text:"  "}),e.title&&i.push({text:e.title}),i.push({text:e.value,color:e.color}));return i}class y{constructor(e,t){this._logoTextColor=null,this._snapshotData=e,t=t||{},this._options={backgroundColor:u.themes[e.theme].getThemedColor("color-bg-primary"),borderColor:u.themes[e.theme].getThemedColor("color-border"),
font:l.CHART_FONT_FAMILY,fontSize:12,legendMode:"vertical",hideResolution:!1,header:void 0,...t};const i=f[e.layout],r=e.charts.map(e=>function(e){const t=e.panes[0],i=t.canvas.width+t.leftAxis.canvas.width+t.rightAxis.canvas.width;let r=0;for(const t of e.panes)r+=t.canvas.height;return void 0!==e.timeAxis&&(r+=e.timeAxis.canvas.height),new a.Size(i,r)}(e));if(this._pixelRatio=e.hidpiRatio,this._chartsGeometry=e.charts.map((e,t)=>function e(t,i,r,s){let n=Math.round(10*s),o=Math.round(10*s);const a=r[t];if(null!==a.l){const t=e(a.l,i,r,s);n=t.x+t.width+Math.round(5*s)}if(null!==a.t){const t=e(a.t,i,r,s);o=t.y+t.height+Math.round(5*s)}const l=i[t];return{x:n,y:o,width:l.w,height:l.h}}(t,r,i,this._pixelRatio)),!_){let i=e.theme;void 0!==t.backgroundColor&&(i="black"===(0,s.rgbToBlackWhiteString)((0,s.parseRgb)(t.backgroundColor),150)?n.StdTheme.Dark:n.StdTheme.Light),this._logoTextColor=u.themes[i].getThemedColor("color-text-primary")}this._headerDefaultTextColor=u.themes[e.theme].getThemedColor("color-text-primary")}async getImage(){const e=this._pixelRatio;let t=0,i=0,s=0;if(this._options.header){s=Math.ceil(1.4*this._options.fontSize*e)*this._options.header.length}i+=s;let n=0,o=0;for(const e of this._chartsGeometry)n=Math.max(n,e.x+e.width),o=Math.max(o,e.y+e.height);const u=i;t+=n,i+=o,t+=Math.round(10*e);const d=_?Math.round(10*e):Math.round(35*e),h=i;i+=d;const m=(0,a.createDisconnectedCanvas)(document,new a.Size(t,i),1),f=(0,a.getContext2D)(m);f.font=(0,c.makeFont)(this._options.fontSize,this._options.font),f.textBaseline="top",f.fillStyle=this._options.backgroundColor,f.fillRect(0,0,t,i),this._options.header&&this._drawHeader(f,t,new r.Point(Math.round(10*e),Math.round(10*e)));for(let e=0;e<this._snapshotData.charts.length;++e){const t=this._snapshotData.charts[e],i=this._chartsGeometry[e];this._drawChart(t,i,f,new r.Point(0,u))}if(null!==this._logoTextColor){const t=await function(e,t,i){var r;const s=(new DOMParser).parseFromString(p,"image/svg+xml");null===(r=null==s?void 0:s.firstElementChild)||void 0===r||r.setAttribute("color",i);const n=URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(s)],{type:"image/svg+xml"}));return new Promise(i=>{const r=new Image;r.width=e,r.height=t,r.onload=()=>{i({image:r,width:e,height:t})},r.src=n})}(Math.round(20*e),Math.round(15*e),this._logoTextColor);f.fillStyle=this._logoTextColor,f.font=(0,c.makeFont)(13,l.CHART_FONT_FAMILY);const i=h+Math.round(d/2-t.height/2);!function(e,t,i,r,s){e.save(),e.drawImage(r.image,t,i,r.width,r.height),e.textBaseline="bottom";const n=(t+r.width)/s+3,o=(i+r.height)/s;(0,a.drawScaled)(e,s,()=>{e.fillText("TradingView",n,o)}),e.restore()}(f,Math.round(10*e),i,t,e)}return m}_drawChart(e,t,i,s){i.save(),i.translate(t.x+s.x,t.y+s.y);let n=0;for(const t of e.panes){let s=0;const o=t.leftAxis.canvas.width+Math.round(8*this._pixelRatio),a=n,l=n+Math.round(10*this._pixelRatio);t.leftAxis.contentWidth>0&&(i.drawImage(t.leftAxis.canvas,s,n),s+=t.leftAxis.canvas.width),i.drawImage(t.canvas,s,n),s+=t.canvas.width,
t.rightAxis.contentWidth>0&&i.drawImage(t.rightAxis.canvas,s,n),"pane"===t.type&&(i.fillStyle=e.colors.text,this._drawLegend(t,i,new r.Point(o,l),a)),n+=t.canvas.height}if(void 0!==e.timeAxis){let t=0;e.timeAxis.lhsStub.contentWidth>0&&(i.drawImage(e.timeAxis.lhsStub.canvas,t,n),t+=e.timeAxis.lhsStub.canvas.width),i.drawImage(e.timeAxis.canvas,t,n),t+=e.timeAxis.canvas.width,e.timeAxis.rhsStub.contentWidth>0&&i.drawImage(e.timeAxis.rhsStub.canvas,t,n)}i.strokeStyle=this._options.borderColor,i.strokeRect(0,0,t.width,t.height),i.restore()}_drawHeader(e,t,i){const{header:s}=this._options;if(!s)return;e.save(),e.fillStyle=this._headerDefaultTextColor;const n=Math.ceil(1.4*this._options.fontSize*this._pixelRatio);s.forEach((s,o)=>{this._drawLegendLine(e,new r.Point(i.x,i.y+n*o),t,[{...s,text:s.text.trim()}],!0)}),e.restore()}_drawLegend(e,t,i,s){let n=!0;const o=Math.ceil(1.4*this._options.fontSize*this._pixelRatio);let a=i.x,l=i.y;if(e.mainSeriesText&&l+o<s+e.canvas.height){const i=this._drawLegendLine(t,new r.Point(a,l),e.contentWidth*this._pixelRatio,S(e.mainSeriesText,e.mainSeriesValues),!0);"horizontal"!==this._options.legendMode?l+=o:(a=i+1.4*this._options.fontSize*this._pixelRatio,n=!1)}for(let c=0;c<e.studies.length;++c)if(l+o<s+e.canvas.height){const s=e.studies[c],u=e.studiesValues[c];let d=null;for(;null===d;)d=this._drawLegendLine(t,new r.Point(a,l),e.contentWidth*this._pixelRatio,S(s,v(u)),n),"horizontal"!==this._options.legendMode?l+=o:null===d?(n=!0,a=i.x,l+=o):(a=d+1.4*this._options.fontSize*this._pixelRatio,n=!1)}}_drawLegendLine(e,t,i,s,n){const a=s.map(e=>e.text).join("");let l=t.x;const c=function(e,t,i,r){if(e.measureText(t).width*r<=i)return{text:t,elided:!1};const s=e.measureText("...").width*r,n=[];for(let e=0;e<t.length;++e)n.push(e);const a=(0,o.upperbound)(n,i,(n,o)=>e.measureText(t.slice(0,o+1)).width*r+s>i);return{text:(t=t.slice(0,a)).trim(),elided:!0}}(e,a,i-l,this._pixelRatio);if(c.elided&&!n)return null;const u=[];let d=0;for(const e of s){if(d+e.text.length>c.text.length)break;u.push(e.text),d+=e.text.length}const h=u.join("").trim().length;d=0;for(const i of s){if(d+i.text.length>h)break;i.color&&(e.save(),e.fillStyle=i.color),l+=g(e,new r.Point(l,t.y),i.text,this._pixelRatio),i.color&&e.restore(),d+=i.text.length}return c.elided&&(l+=g(e,new r.Point(l,t.y),"...",this._pixelRatio)),l}}async function b(e,t){return new y(e,t).getImage()}},17515:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ContextMenuManager:()=>r});var r,s=i(87553);!function(e){const t=[];function r(){(0,s.globalCloseMenu)()}e.createMenu=async function(e,s={},n){const o=new((await Promise.all([i.e(37610),i.e(32795),i.e(43894),i.e(60700),i.e(68604),i.e(2359),i.e(47607),i.e(30209),i.e(38602),i.e(73935),i.e(45867),i.e(33289),i.e(88655),i.e(91584)]).then(i.bind(i,96835))).ContextMenuRenderer)(e,s,()=>{const e=t.indexOf(o);-1!==e&&t.splice(e,1),void 0!==n&&n()},r);return t.push(o),o},e.hideAll=r,e.getShown=function(){for(let e=0;e<t.length;e++)if(t[e].isShown())return t[e];return null}}(r||(r={}))},57807:(e,t,i)=>{"use strict";i.d(t,{
showCustomUrlEventDialog:()=>a});var r=i(20220),s=i(79407);const n=(0,r.t)("Ok"),o=(0,r.t)("Cancel");async function a(e){const{onConfirm:t,onClose:i,title:r,placeholderText:a}=e;return(0,s.showRename)({title:r,text:"",placeholder:a,mainButtonText:n,cancelButtonText:o,onRename:({newValue:e,dialogClose:i})=>{t(e),i()},onClose:i})}},63628:(e,t,i)=>{"use strict";i.d(t,{DialogRenderer:()=>n});var r=i(65066),s=i.n(r);class n{constructor(){this._container=document.createElement("div"),this._visibility=new(s())(!1)}visible(){return this._visibility.readonly()}_setVisibility(e){this._visibility.setValue(e)}}},46926:(e,t,i)=>{"use strict";var r;i.d(t,{TabNames:()=>r}),function(e){e.background="Background",e.coordinates="Coordinates",e.drawings="Drawings",e.events="Events",e.eventsAndAlerts="Events & Alerts",e.inputs="Inputs",e.properties="Properties",e.scales="Scales",e.legend="Legend",e.sourceCode="Source Code",e.style="Style",e.symbol="Symbol",e.timezoneSessions="Timezone/Sessions",e.trading="Trading",e.visibility="Visibility",e.text="Text"}(r||(r={}))},26132:(e,t,i)=>{"use strict";i.d(t,{EmbedFooterWidget:()=>n});i(20220);var r=i(11088),s=(i(94066),i(18184));class n{constructor({resizerBridge:e,publishOptions:t}){this._publishOptions=t,e.negotiateHeight(31),e.container.subscribe(this._render.bind(this),{callWithLast:!0})}_render(e){s(e).empty().css("overflow","hidden");const t=s("<div>",e).attr("id","footer-chart-panel").addClass("publish-widget").appendTo(e),i=s("<div>",e).addClass("publish-buttons").appendTo(t);"dailyfx"===this._publishOptions.publishSource&&s('<label class="usage-help">For a guide on using Trading View charts, please click <a target="_blank" href="https://media.dailyfx.com/docs/TradingView.pdf">here</a>.</label>').appendTo(t),s('<a class="publish-chart-button"></a>').html(window.t("Publish Idea")).on("click",e=>{e.preventDefault(),(0,r.publishChartWidget)(this._publishOptions)}).addClass("apply-common-tooltip").attr("title",s.t("Share your idea with the trade community")).appendTo(i)}}},76887:(e,t,i)=>{"use strict";i.d(t,{getPriceAxisNameInfo:()=>o});const r=["Z","Y","X","W","V","U","T","S"],s=["A","B","C","D","E","F","G","H"];class n{constructor(e){this.label=e}equals(e){return null!==e&&this.label===e.label}}function o(e,t){const i="left"===e?r:s;return new n(t<i.length?i[t]:"")}},35252:(e,t,i)=>{"use strict";i.d(t,{CHART_WIDGET_COLLECTION_SERVICE:()=>s,chartWidgetCollectionService:()=>n,CollectionViewMode:()=>o});var r=i(60531);const s={id:"ChartWidgetCollectionService"};function n(){return(0,r.hasService)(s)?(0,r.service)(s):null}var o;!function(e){e.Multichart="multichart",e.ForceFullscreen="force-fullscreen"}(o||(o={}))},94420:(e,t,i)=>{"use strict";i.d(t,{InvalidationLevel:()=>r,InvalidationMask:()=>a,defaultInvalidationLevel:()=>o});var r,s=i(16282);class n{constructor(e=o){this._paneInvalidationLevel=o,this._leftPriceScalesInvalidationMap=new Map,this._rightPriceScalesInvalidationMap=new Map,this._invalidationLevel=e}fullInvalidation(){return this._invalidationLevel}invalidateAll(e){
this._invalidationLevel=Math.max(this._invalidationLevel,e)}invalidatePane(e){this._paneInvalidationLevel=Math.max(this._invalidationLevel,e)}invalidatePriceScale(e,t,i){const r="left"===e?this._leftPriceScalesInvalidationMap:this._rightPriceScalesInvalidationMap,s=r.get(t)||o;r.set(t,Math.max(s,i))}invalidationLevelForPane(){return Math.max(this._paneInvalidationLevel,this._invalidationLevel)}getterForPriceScaleInvalidationLevelBySide(e){const t="left"===e?this._leftPriceScalesInvalidationMap:this._rightPriceScalesInvalidationMap;return e=>Math.max(t.get(e)||o,this._invalidationLevel)}priceScaleSideMaxLevel(e){const t="left"===e?this._leftPriceScalesInvalidationMap:this._rightPriceScalesInvalidationMap;let i=this._invalidationLevel;return t.size>0&&t.forEach(e=>{e>i&&(i=e)}),i}merge(e){this._invalidationLevel=Math.max(this._invalidationLevel,e._invalidationLevel),this._paneInvalidationLevel=Math.max(this._paneInvalidationLevel,e._paneInvalidationLevel),e._leftPriceScalesInvalidationMap.forEach((e,t)=>{const i=this._leftPriceScalesInvalidationMap.get(t)||o;this._leftPriceScalesInvalidationMap.set(t,Math.max(i,e))}),e._rightPriceScalesInvalidationMap.forEach((e,t)=>{const i=this._rightPriceScalesInvalidationMap.get(t)||o;this._rightPriceScalesInvalidationMap.set(t,Math.max(i,e))})}}!function(e){e[e.None=0]="None",e[e.Cursor=1]="Cursor",e[e.Light=2]="Light",e[e.Full=3]="Full"}(r||(r={}));const o=r.None;class a{constructor(e=o){this._panesOrderChanged=!1,this._keepVisibleTimeRangeOnResize=!1,this._timeAxisInvalidationLevel=o,this._invalidatedPanes=new Map,this._additionalActions=[],this._invalidationLevel=e}invalidateAll(e){this._invalidationLevel!==e&&(this._invalidationLevel=Math.max(this._invalidationLevel,e),this._invalidatedPanes.forEach(e=>{e.invalidateAll(this._invalidationLevel)}))}invalidateAllPane(e,t){this._invalidatedPanes.has(e)||this._invalidatedPanes.set(e,new n(this._invalidationLevel)),(0,s.ensureDefined)(this._invalidatedPanes.get(e)).invalidateAll(t)}invalidatePriceScale(e,t,i,r){this._invalidatedPanes.has(e)||this._invalidatedPanes.set(e,new n(this._invalidationLevel)),(0,s.ensureDefined)(this._invalidatedPanes.get(e)).invalidatePriceScale(t,i,r)}invalidateTimeScale(e){this._timeAxisInvalidationLevel=Math.max(this._timeAxisInvalidationLevel,e)}invalidatePanesOrder(){this._panesOrderChanged=!0}lockVisibleTimeRangeOnResize(){this._keepVisibleTimeRangeOnResize=!0}fullInvalidation(){return this._invalidationLevel}maxPaneInvalidation(){const e=[];return this._invalidatedPanes.forEach(t=>{e.push(t.fullInvalidation())}),Math.max(...e,this._invalidationLevel)}invalidateForPane(e){return this._invalidatedPanes.get(e)||new n(this._invalidationLevel)}invalidateForTimeScale(){return Math.max(this._timeAxisInvalidationLevel,this._invalidationLevel)}validationActions(){return this._additionalActions}addValidationAction(e){this._additionalActions.push(e)}merge(e){this._invalidationLevel=Math.max(this._invalidationLevel,e._invalidationLevel),this._panesOrderChanged=this._panesOrderChanged||e._panesOrderChanged,
this._keepVisibleTimeRangeOnResize=this._keepVisibleTimeRangeOnResize||e._keepVisibleTimeRangeOnResize,this._invalidatedPanes.forEach(e=>{e.invalidateAll(this._invalidationLevel)}),e._invalidatedPanes.forEach((e,t)=>{this._invalidatedPanes.has(t)||this._invalidatedPanes.set(t,new n(this._invalidationLevel)),(0,s.ensureDefined)(this._invalidatedPanes.get(t)).merge(e)}),this._timeAxisInvalidationLevel=Math.max(this._timeAxisInvalidationLevel,e._timeAxisInvalidationLevel);for(let t=0;t<e._additionalActions.length;t++)this._additionalActions.push(e._additionalActions[t])}panesOrderInvalidated(){return this._panesOrderChanged}isVisibleTimeRangeLockedOnResize(){return this._keepVisibleTimeRangeOnResize}static cursor(){return new a(r.Cursor)}static light(){return new a(r.Light)}static full(){return new a(r.Full)}static panesOrder(){const e=a.full();return e.invalidatePanesOrder(),e}static validateAction(e){const t=new a;return t._additionalActions.push(e),t}}},2694:(e,t,i)=>{"use strict";i.d(t,{KineticAnimation:()=>o});var r=i(16282);function s(e,t){return e.position-t.position}function n(e,t,i){const r=(e.position-t.position)/(e.time-t.time);return Math.sign(r)*Math.min(Math.abs(r),i)}class o{constructor(e,t,i,r){this._position1=null,this._position2=null,this._position3=null,this._position4=null,this._animationStartPosition=null,this._durationMsecs=0,this._speedPxPerMsec=0,this._terminated=!1,this._minSpeed=e,this._maxSpeed=t,this._dumpingCoeff=i,this._minMove=r}addPosition(e,t){if(null!==this._position1){if(this._position1.time===t)return void(this._position1.position=e);if(Math.abs(this._position1.position-e)<this._minMove)return}this._position4=this._position3,this._position3=this._position2,this._position2=this._position1,this._position1={time:t,position:e}}start(e,t){if(null===this._position1||null===this._position2)return;if(t-this._position1.time>50)return;let i=0;const r=n(this._position1,this._position2,this._maxSpeed),o=s(this._position1,this._position2),a=[r],l=[o];if(i+=o,null!==this._position3){const e=n(this._position2,this._position3,this._maxSpeed);if(Math.sign(e)===Math.sign(r)){const t=s(this._position2,this._position3);if(a.push(e),l.push(t),i+=t,null!==this._position4){const e=n(this._position3,this._position4,this._maxSpeed);if(Math.sign(e)===Math.sign(r)){const t=s(this._position3,this._position4);a.push(e),l.push(t),i+=t}}}}let c=0;for(let e=0;e<a.length;++e)c+=l[e]/i*a[e];Math.abs(c)<this._minSpeed||(this._animationStartPosition={position:e,time:t},this._speedPxPerMsec=c,this._durationMsecs=function(e,t){const i=Math.log(t);return Math.log(1*i/-e)/i}(Math.abs(c),this._dumpingCoeff))}getPosition(e){const t=(0,r.ensureNotNull)(this._animationStartPosition),i=e-t.time;return t.position+this._speedPxPerMsec*(Math.pow(this._dumpingCoeff,i)-1)/Math.log(this._dumpingCoeff)}finished(e){return null===this._animationStartPosition||this._progressDuration(e)===this._durationMsecs}terminated(){return this._terminated}terminate(){this._terminated=!0}_progressDuration(e){const t=e-(0,
r.ensureNotNull)(this._animationStartPosition).time;return Math.min(t,this._durationMsecs)}}},748:(e,t,i)=>{"use strict";i.d(t,{lastEventIsTouch:()=>s,setLastEventIsTouch:()=>n});let r=(0,i(68724).supportTouch)();function s(){return r}function n(e){r=e}},86913:(e,t,i)=>{"use strict";i.d(t,{isMultipleLayout:()=>c,layouts:()=>l});var r=i(91023);function s(e){const t=new Set;if("number"==typeof e)return t.add(e),{indices:t,smallestIndex:e,sizer:e=>e};const i=e[0],r=e.slice(1).map(s);let n=1/0;for(const e of r)for(const i of Array.from(e.indices))i<n&&(n=i),t.add(i);return{indices:t,smallestIndex:n,sizer:(e,t,s,n)=>{let o,a,l=0;for(const e of r)e.smallestIndex>=s||(e.indices.has(t)&&(o=e,a=l),l++);const c=(("h"===i?e.width:e.height)-(l-1)*n)/l,u=a*(c+n),d=Math.round(u),h=Math.round(u+c)-d;let p;return p="h"===i?{top:e.top,left:e.left+d,height:e.height,width:h}:{top:e.top+d,left:e.left,height:h,width:e.width},o.sizer(p,t,s,n)}}}function n(e,t){const i=s(e);return{title:t,count:i.indices.size,sizer:i.sizer}}const o={s:{title:"1 chart",count:1,sizer:(e,t)=>{if(0!==t)throw new RangeError("invalid index");return e}}};let a;a={"2h":n(r["2h"],"2-up Horizontal"),"2v":n(r["2v"],"2-up Vertical"),"2-1":n(r["2-1"],"2 at top and 1 at bottom"),"1-2":n(r["1-2"],"1 at top and 2 at bottom"),"3s":n(r["3s"],"3-up Stacked"),"3r":n(r["3r"],"3-up Stacked Left"),"3h":n(r["3h"],"3-up Horizontal"),"3v":n(r["3v"],"3-up Vertical"),4:n(r[4],"4-up"),"4h":n(r["4h"],"4-up Horizontal"),"4v":n(r["4v"],"4-up Vertical"),"4s":n(r["4s"],"4-up Stacked"),"2-2":n(r["2-2"],"2 at top and 2 at bottom"),"1-3":n(r["1-3"],"1 at top and 3 at bottom"),"1-4":n(r["1-4"],"1 at top and 4 at bottom"),"5s":n(r["5s"],"5-up Stacked"),6:n(r[6],"6-up"),"6c":n(r["6c"],"6-up in two columns"),8:n(r[8],"8-up"),"8c":n(r["8c"],"8-up in two columns")};const l={...o,...a};function c(e){return!function(e){return"s"===e}(e)}},81890:(e,t,i)=>{"use strict";i.d(t,{LoadingScreen:()=>o});var r=i(22842),s=i(74026),n=i(21218);class o{constructor(e,t){this._showed=!1,this._cw=e,this._element=document.createElement("div"),this._element.classList.add("chart-loading-screen"),this._shield=document.createElement("div"),this._shield.classList.add("chart-loading-screen-shield"),this._element.appendChild(this._shield),t.appendChild(this._element),this._cw.withModel(this,this._connectToModel)}show(){this._cw.setInLoadingState(!0),this._showed||(this._showed=!0,this._show())}hide(){this._cw.setInLoadingState(!1),this._showed&&this._hide()}isShown(){return this._showed}_connectToModel(){const e=this._cw.model().mainSeries().dataEvents();e.symbolError().subscribe(this,e=>{e!==n.permissionDenied&&this.hide()}),e.seriesError().subscribe(this,()=>{(0,r.enabled)("hide_loading_screen_on_series_error")&&this.hide()}),e.completed().subscribe(this,this.hide)}_show(){const e=this._cw.properties().childs().paneProperties.childs();let t;if(e.backgroundType.value()===s.ColorType.Solid)t=e.background.value();else{t=`linear-gradient(${e.backgroundGradientStartColor.value()},${e.backgroundGradientEndColor.value()})`}
this._shield.style.background=t,this._element.classList.add("fade")}_hide(){this._showed=!1,this._element.classList.remove("fade")}}},46202:(e,t,i)=>{"use strict";i.d(t,{LollipopGroupIcons:()=>r,LollipopTooltipContentRow:()=>c});var r,s=i(67294),n=i(94184),o=i.n(n),a=i(40539),l=i(34811);function c(e){const{name:t,value:i,style:r,valueRightIcon:n}=e;return s.createElement("div",{key:t,className:l.groupRow,style:r},s.createElement("div",{className:l.groupCell},s.createElement("span",{className:l.text},t)),s.createElement("div",{className:l.groupCell},s.createElement("span",{className:l.text},i),n&&s.createElement(a.Icon,{icon:n.iconContent,className:o()(l.groupIcon,n.iconClass,"apply-common-tooltip"),title:n.tooltipText})))}!function(e){e[e.BeforeMarketOpen=l.beforeMarketOpen]="BeforeMarketOpen",e[e.AfterMarketClose=l.afterMarketClose]="AfterMarketClose"}(r||(r={}))},10595:(e,t,i)=>{"use strict";i.d(t,{MouseEventHandler:()=>u});var r=i(68724),s=i(16282),n=i(31565),o=i(93207),a=i(748);const l=r.isSafari?"click":"auxclick",c={treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!1};class u{constructor(e,t,i){this._clickCount=0,this._clickTimeoutId=null,this._clickPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartPosition=null,this._touchMoveStartPosition=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddlePoint=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!r.CheckMobile.iOS(),this._onFirefoxOutsideMouseUp=e=>{this._mouseUpHandler(e)},this._onMobileSafariDoubleClick=e=>{if(this._firesTouchEvents(e)){const t=this._makeCompatEvent(e);if(++this._tapCount,this._tapTimeoutId&&this._tapCount>1){const{manhattanDistance:i}=this._touchMouseMoveWithDownInfo(d(e),this._tapPosition);i<30&&!this._cancelTap&&this._processTouchEvent(t,this._handler.doubleTapEvent),this._resetTapTimeout()}}else{const t=this._makeCompatEvent(e);if(++this._clickCount,this._clickTimeoutId&&this._clickCount>1){const{manhattanDistance:i}=this._touchMouseMoveWithDownInfo(d(e),this._clickPosition);i<5&&!this._cancelClick&&this._processMouseEvent(t,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()}}},this._target=e,this._handler=t,this._options=(0,n.merge)((0,n.clone)(c),i||{}),this._init()}destroy(){null!==this._unsubscribeOutsideMouseEvents&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),null!==this._unsubscribeOutsideTouchEvents&&(this._unsubscribeOutsideTouchEvents(),
this._unsubscribeOutsideTouchEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),null!==this._unsubscribeMobileSafariEvents&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()}_mouseEnterHandler(e){this._unsubscribeMousemove&&this._unsubscribeMousemove();const t=this._mouseMoveHandler.bind(this);if(this._unsubscribeMousemove=()=>{this._target.removeEventListener("mousemove",t)},this._target.addEventListener("mousemove",t),this._firesTouchEvents(e))return;const i=this._makeCompatEvent(e);this._processMouseEvent(i,this._handler.mouseEnterEvent),this._acceptMouseLeave=!0}_resetClickTimeout(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_resetTapTimeout(){null!==this._tapTimeoutId&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_mouseMoveHandler(e){if(this._mousePressed||null!==this._touchMoveStartPosition)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handler.mouseMoveEvent),this._acceptMouseLeave=!0}_touchMoveHandler(e){const t=_(e.changedTouches,(0,s.ensureNotNull)(this._activeTouchId));if(null===t)return;if(this._lastTouchEventTimeStamp=p(e),null!==this._startPinchMiddlePoint)return;if(this._preventTouchDragProcess)return;this._pinchPrevented=!0;const i=this._touchMouseMoveWithDownInfo(d(t),(0,s.ensureNotNull)(this._touchMoveStartPosition)),{xOffset:r,yOffset:n,manhattanDistance:a}=i;if(this._touchMoveExceededManhattanDistance||!(a<5)){if(!this._touchMoveExceededManhattanDistance){const e=.5*r,t=n>=e&&!this._options.treatVertTouchDragAsPageScroll,i=e>n&&!this._options.treatHorzTouchDragAsPageScroll;t||i||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}if(!this._preventTouchDragProcess){const i=this._makeCompatEvent(e,t);this._processTouchEvent(i,this._handler.touchMoveEvent),(0,o.preventDefault)(e)}}}_mouseMoveWithDownHandler(e){if(0!==e.button)return;const t=this._touchMouseMoveWithDownInfo(d(e),(0,s.ensureNotNull)(this._mouseMoveStartPosition)),{manhattanDistance:i}=t;if(i>=5&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick){const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handler.pressedMouseMoveEvent)}}_touchMouseMoveWithDownInfo(e,t){const i=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return{xOffset:i,yOffset:r,manhattanDistance:i+r}}_touchEndHandler(e){let t=_(e.changedTouches,(0,s.ensureNotNull)(this._activeTouchId))
;if(null===t&&0===e.touches.length&&(t=e.changedTouches[0]),null===t)return;this._activeTouchId=null,this._lastTouchEventTimeStamp=p(e),this._clearLongTapTimeout(),this._touchMoveStartPosition=null,this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);const i=this._makeCompatEvent(e,t);if(this._processTouchEvent(i,this._handler.touchEndEvent),++this._tapCount,this._tapTimeoutId&&this._tapCount>1){const{manhattanDistance:e}=this._touchMouseMoveWithDownInfo(d(t),this._tapPosition);e<30&&!this._cancelTap&&this._processTouchEvent(i,this._handler.doubleTapEvent),this._resetTapTimeout()}else this._cancelTap||(this._processTouchEvent(i,this._handler.tapEvent),this._handler.tapEvent&&(0,o.preventDefault)(e));0===this._tapCount&&(0,o.preventDefault)(e),0===e.touches.length&&this._longTapActive&&(this._longTapActive=!1,(0,o.preventDefault)(e))}_mouseUpHandler(e){if(0!==e.button)return;const t=this._makeCompatEvent(e);if(this._mouseMoveStartPosition=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),r.isFF){this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp)}if(!this._firesTouchEvents(e))if(this._processMouseEvent(t,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId&&this._clickCount>1){const{manhattanDistance:i}=this._touchMouseMoveWithDownInfo(d(e),this._clickPosition);i<5&&!this._cancelClick&&this._processMouseEvent(t,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()}else this._cancelClick||this._processMouseEvent(t,this._handler.mouseClickEvent)}_clearLongTapTimeout(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)}_touchStartHandler(e){if(null!==this._activeTouchId)return;const t=e.changedTouches[0];this._activeTouchId=t.identifier,this._lastTouchEventTimeStamp=p(e);const i=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartPosition=d(t),this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);{const t=this._touchMoveHandler.bind(this),r=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=()=>{i.removeEventListener("touchmove",t),i.removeEventListener("touchend",r)},i.addEventListener("touchmove",t,{passive:!1}),i.addEventListener("touchend",r,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,e),240)}const r=this._makeCompatEvent(e,t);this._processTouchEvent(r,this._handler.touchStartEvent),this._tapTimeoutId||(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapPosition=d(t))}_wheelClickHandler(e){if(1!==e.button)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handler.wheelClickEvent)}_mouseDownHandler(e){
if(0!==e.button)return;const t=this._target.ownerDocument.documentElement;r.isFF&&t.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartPosition=d(e),this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);{const e=this._mouseMoveWithDownHandler.bind(this),i=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=()=>{t.removeEventListener("mousemove",e),t.removeEventListener("mouseup",i)},t.addEventListener("mousemove",e),t.addEventListener("mouseup",i)}if(this._mousePressed=!0,this._firesTouchEvents(e))return;const i=this._makeCompatEvent(e);this._processMouseEvent(i,this._handler.mouseDownEvent),this._clickTimeoutId||(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickPosition=d(e))}_init(){this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));{const e=this._target.ownerDocument,t=e=>{this._handler.mouseDownOutsideEvent&&(e.target&&this._target.contains(e.target)||this._handler.mouseDownOutsideEvent())};this._unsubscribeOutsideTouchEvents=()=>{e.removeEventListener("touchstart",t)},this._unsubscribeOutsideMouseEvents=()=>{e.removeEventListener("mousedown",t)},e.addEventListener("mousedown",t),e.addEventListener("touchstart",t,{passive:!0})}r.CheckMobile.iOS()&&(this._unsubscribeMobileSafariEvents=()=>{this._target.removeEventListener("dblclick",this._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("contextmenu",this._contextMenuHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),(0,o.preventScrollByWheelClick)(this._target),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._target.addEventListener(l,this._wheelClickHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",()=>{},{passive:!1})}_initPinch(){void 0===this._handler.pinchStartEvent&&void 0===this._handler.pinchEvent&&void 0===this._handler.pinchEndEvent||(this._target.addEventListener("touchstart",e=>this._checkPinchState(e.touches),{passive:!0}),this._target.addEventListener("touchmove",e=>{if(2===e.touches.length&&null!==this._startPinchMiddlePoint&&void 0!==this._handler.pinchEvent){const t=h(e.touches[0],e.touches[1])/this._startPinchDistance;this._handler.pinchEvent(this._startPinchMiddlePoint,t),(0,o.preventDefault)(e)}},{passive:!1}),this._target.addEventListener("touchend",e=>{this._checkPinchState(e.touches)}))}_checkPinchState(e){1===e.length&&(this._pinchPrevented=!1),2!==e.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(e)}_startPinch(e){const t=this._target.getBoundingClientRect()||{left:0,top:0};this._startPinchMiddlePoint={
x:(e[0].clientX-t.left+(e[1].clientX-t.left))/2,y:(e[0].clientY-t.top+(e[1].clientY-t.top))/2},this._startPinchDistance=h(e[0],e[1]),void 0!==this._handler.pinchStartEvent&&this._handler.pinchStartEvent(),this._clearLongTapTimeout()}_stopPinch(){null!==this._startPinchMiddlePoint&&(this._startPinchMiddlePoint=null,void 0!==this._handler.pinchEndEvent&&this._handler.pinchEndEvent())}_mouseLeaveHandler(e){if(this._unsubscribeMousemove&&this._unsubscribeMousemove(),this._firesTouchEvents(e))return;if(!this._acceptMouseLeave)return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handler.mouseLeaveEvent),this._acceptMouseLeave=!r.CheckMobile.iOS()}_longTapHandler(e){const t=_(e.touches,(0,s.ensureNotNull)(this._activeTouchId));if(null===t)return;const i=this._makeCompatEvent(e,t);this._processTouchEvent(i,this._handler.longTapEvent),this._processTouchEvent(i,this._handler.touchContextMenuEvent),this._cancelTap=!0,this._longTapActive=!0}_contextMenuHandler(e){if((0,o.preventDefault)(e),null!==this._touchMoveStartPosition)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handler.contextMenuEvent),this._cancelClick=!0}_firesTouchEvents(e){return e.sourceCapabilities&&void 0!==e.sourceCapabilities.firesTouchEvents?e.sourceCapabilities.firesTouchEvents:p(e)<this._lastTouchEventTimeStamp+500}_processTouchEvent(e,t){(0,a.setLastEventIsTouch)(!0),t&&t.call(this._handler,e)}_processMouseEvent(e,t){"mouseleave"!==e.srcType&&(0,a.setLastEventIsTouch)(!1),t&&t.call(this._handler,e)}_makeCompatEvent(e,t){const i=t||e,r=this._target.getBoundingClientRect()||{left:0,top:0};return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-r.left,localY:i.clientY-r.top,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,isTouch:!e.type.startsWith("mouse")&&"contextmenu"!==e.type&&"click"!==e.type,srcType:e.type,target:i.target,view:e.view,preventDefault:()=>{"touchstart"!==e.type&&(0,o.preventDefault)(e)}}}}function d(e){return{x:e.pageX,y:e.pageY}}function h(e,t){const i=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.sqrt(i*i+r*r)}function p(e){return e.timeStamp||performance.now()}function _(e,t){for(let i=0;i<e.length;++i)if(e[i].identifier===t)return e[i];return null}},89150:(e,t,i)=>{"use strict";function r(e,t){let{deltaX:i,deltaY:r}=e;switch(i/=100,r/=100,t.deltaMode){case t.DOM_DELTA_PAGE:i*=120,r*=120;break;case t.DOM_DELTA_LINE:i*=32,r*=32}return{deltaX:i,deltaY:r}}i.d(t,{MouseWheelHelper:()=>s});class s{constructor(){this._totalDeltaX=0,this._totalDeltaY=0,this._prevWheelTime=0}processWheel(e){e.timeStamp-this._prevWheelTime>100&&this._reset(),this._totalDeltaX+=e.deltaX,this._totalDeltaY+=e.deltaY,this._prevWheelTime=e.timeStamp;const t={deltaX:e.deltaX,deltaY:e.deltaY};return 0===this._totalDeltaX||0===this._totalDeltaY||(Math.abs(this._totalDeltaX)>=Math.abs(3*this._totalDeltaY)&&(t.deltaY=0),Math.abs(this._totalDeltaY)>=Math.abs(3*this._totalDeltaX)&&(t.deltaX=0)),
r(t,e)}_reset(){this._totalDeltaX=0,this._totalDeltaY=0}}},28132:(e,t,i)=>{"use strict";i.r(t),i.d(t,{PaneWidgetBase:()=>he});var r=i(20220),s=i(16282),n=i(72927),o=i(68724),a=i(748),l=i(88001),c=i(31565),u=i(21318),d=i(62288),h=i(94209),p=i(17483),_=i(55304),m=i(68793),f=i(87048),g=i(14397),v=i(82870),S=i(96238),y=i(14900),b=i(64348),w=i(11190),P=i(88118),C=i(2694),T=i(65066),x=i.n(T),I=i(68198),L=i(77928),M=i(44913),E=i(88137),A=i(17515),k=i(43854),D=i(82324),R=i(8412),N=i(78815),O=i(98006),V=i(8218),B=i(32719),F=i(46926),W=i(22842),U=i(88558),H=i(94970),z=i(29098),j=i(54281),Y=i(91498),G=i(8273),q=i(11877),X=i(94420),$=i(54255);function K(e){return"startMoving"in e&&"move"in e&&"endMoving"in e&&"convertYCoordinateToPriceForMoving"in e}const J=(0,O.isFeatureEnabled)("custom_moving_select_first_then_move"),Z=parseInt(Y["css-value-pane-controls-padding-left"]),Q=parseInt(Y["css-value-pane-controls-padding-right"]);function ee(e){return!(null===e||!(0,_.isStudy)(e))&&"Volume@tv-basicstudies"===e.metaInfo().id}function te(e,t,i){e.drawBackground&&e.drawBackground(t,i)}function ie(e,t,i){e.draw(t,i)}function re(e,t){return e.paneViews(t)}function se(e,t){return e.topPaneViews()}function ne(e,t){return e.labelPaneViews(t)}function oe(e,t){const i=e.strategyOrdersPaneView();return null===i?null:[i]}function ae(e,t){return null===e||null===e.hittest||e.source!==t?null:e.hittest.data()}function le(e,t,i,r,s){var n,o;const a=null!==(o=null===(n=e.hittest)||void 0===n?void 0:n.result())&&void 0!==o?o:0;t.result()>a&&(e.hittest=t,e.source=i,e.renderer=r,e.isCustom=s)}const ce={contextMenuEnabled:!0,contextMenu:E.defaultContextMenuOptions,priceScaleContextMenuEnabled:!0,legendWidgetEnabled:!0,controlsEnabled:!0,propertyPagesEnabled:!0,sourceSelectionEnabled:!0,countdownEnabled:!0},ue=new Map([[d.AreaName.Text,"Text"],[d.AreaName.Style,"Style"]]),de=!W.enabled("display_legend_on_all_charts");class he{constructor(e,t,i,r){this._legendWidget=null,this._paneControls=null,this._isDestroyed=!1,this._trackCrosshairOnlyAfterLongTap=(0,a.lastEventIsTouch)(),this._startTrackPoint=null,this._exitTrackingModeOnNextTry=!1,this._startMoveSourceParams=null,this._startChangeLineToolParams=null,this._preventSourceChange=!1,this._clonningAtMoveLineTools=null,this._startCloningPoint=null,this._size=new y.Size(0,0),this._themedTopColor=null,this._themedBottomColor=null,this._initCrossHairPosition=null,this._firstZoomPoint=null,this._editDialog=null,this._processing=!1,this._touchMove=!1,this._startTouchPoint=null,this._isSelecting=!1,this._prevHoveredHittest=null,this._contextMenuX=0,this._contextMenuY=0,this._startScrollingPos=null,this._isScrolling=!1,this._scrollPriceScale=null,this._scrollXAnimation=null,this._scrollYAnimation=null,this._prevPinchScale=1,this._pinching=!1,this._wasPinched=!1,this._longTap=!1,this._contextMenuOpenedOnLastTap=!1,this._paneControlsResizeObserver=null,this._hideNotMainSourcesInLegendSpawn=null,this._hideWholeLegend=null,this._lastClickedSource=null,this._customLegendWidgetsFactoryMap=new Map,
this._prevMoveEventPosition=null,this._onMagnetStateChangedListener=this._onMagnetStateChanged.bind(this),this._onShiftKeyStateChangedListener=this._onShiftKeyStateChanged.bind(this),this._currentCursorClassName="",this._lastFinishedToolId=null,this._needResetMeasureLater=!1,this._currentChangingLineToolHitTest=null,this._currentMovingHitTest=null,this._lastCommonTooltipData=null,this._canvasConfiguredHandler=()=>this._state&&this._chartModel().lightUpdate(),this._topCanvasConfiguredHandler=()=>this._state&&this._chartModel().lightUpdate(),this._recalculateLegendVisibility=()=>{const e=(0,s.ensureNotNull)(this._hideWholeLegend),t=this._chartModel().crossHairSource().measurePane();null!==t?e.setValue(t===this._state):e.setValue((0,g.toolIsMeasure)(g.tool.value()))},this._chart=e,this._state=t,this._options=(0,c.merge)((0,c.clone)(ce),i),this._paneWidgetsSharedState=r,this._state&&(this._state.onDestroyed().subscribe(this,this._onStateDestroyed,!0),this._state.dataSourcesCollectionChanged().subscribe(this,this._onDataSourcesCollectionChanged));const n={contextMenuEnabled:this._options.priceScaleContextMenuEnabled,pressedMouseMoveScale:this._options.handleScale.axisPressedMouseMove.price,mouseWheelScale:this._options.handleScale.mouseWheel,currencyConversionEnabled:this._options.currencyConversionEnabled,unitConversionEnabled:this._options.unitConversionEnabled,countdownEnabled:this._options.countdownEnabled,croppedTickMarks:this._options.croppedTickMarks};void 0!==this._options.priceScaleContextMenu&&(n.contextMenu=this._options.priceScaleContextMenu);const o=(e,t,i,r,s)=>new P.PriceAxisWidget(this,this._chartUndoModel(),i,t,e,n,r,s),l=e.properties().childs().scalesProperties,u=this._chartModel().rendererOptionsProvider(),d={backgroundBasedTheme:e.backgroundBasedTheme(),rendererOptionsProvider:u,getBackgroundTopColor:()=>this._chartModel().backgroundTopColor().value(),getBackgroundBottomColor:()=>this._chartModel().backgroundColor().value()},h={showLabels:!1};this._lhsPriceAxisesContainer=new w.PriceAxisesContainer(l,"left",o,d,h),this._rhsPriceAxisesContainer=new w.PriceAxisesContainer(l,"right",o,d,h),this._paneCell=document.createElement("td"),this._paneCell.classList.add("chart-markup-table","pane"),this._div=document.createElement("div"),this._div.classList.add("chart-gui-wrapper"),this._paneCell.appendChild(this._div),this._canvasBinding=(0,y.createBoundCanvas)(this._div,new y.Size(16,16)),this._canvasBinding.subscribeCanvasConfigured(this._canvasConfiguredHandler);const p=this._canvasBinding.canvas;p.style.position="absolute",p.style.left="0",p.style.top="0",this._topCanvasBinding=(0,y.createBoundCanvas)(this._div,new y.Size(16,16)),this._topCanvasBinding.subscribeCanvasConfigured(this._topCanvasConfiguredHandler);const _=this._topCanvasBinding.canvas;_.style.position="absolute",_.style.left="0",_.style.top="0",this._rowElement=document.createElement("tr"),this._rowElement.appendChild(this._lhsPriceAxisesContainer.getElement()),this._rowElement.appendChild(this._paneCell),
this._rowElement.appendChild(this._rhsPriceAxisesContainer.getElement()),this._options.legendWidgetEnabled&&(this._options.customLegendWidgetFactories&&(this._customLegendWidgetsFactoryMap=this._options.customLegendWidgetFactories),this._loadAndCreateLegendWidget()),this._state&&!this._chart.readOnly()&&this._options.controlsEnabled&&this._loadAndCreatePaneControlsWidget(),(0,G.magnetEnabled)().subscribe(this._onMagnetStateChangedListener),(0,$.shiftPressed)().subscribe(this._onShiftKeyStateChangedListener),this._paneCell.addEventListener("dragover",e=>{e.dataTransfer&&Array.from(e.dataTransfer.files).some(N.blobImageFilter)&&e.preventDefault()}),this._paneCell.addEventListener("drop",e=>{if(window.user.id&&e.dataTransfer&&this._state){const t=Array.from(e.dataTransfer.files).find(N.blobImageFilter);if(t){e.preventDefault();const i=(0,N.uploadImage)(t),r=URL.createObjectURL(t);this._chartUndoModel().pasteImageAsLineTool(i,r,this._state)}}})}destroy(){this._chart.onPaneWidgetDestroyed(this),this._customLegendWidgetsFactoryMap.clear(),this._topCanvasBinding.unsubscribeCanvasConfigured(this._topCanvasConfiguredHandler),this._topCanvasBinding.destroy(),this._canvasBinding.unsubscribeCanvasConfigured(this._canvasConfiguredHandler),this._canvasBinding.destroy(),null!==this._hideNotMainSourcesInLegendSpawn&&this._hideNotMainSourcesInLegendSpawn.destroy(),this._legendWidget&&(this._legendWidget.destroy(),this._legendWidget=null),null!==this._paneControlsResizeObserver&&this._paneControlsResizeObserver.disconnect(),null!==this._paneControls&&(this._paneControls.destroy(),this._paneControls=null),this._lhsPriceAxisesContainer.destroy(),this._rhsPriceAxisesContainer.destroy(),this.hasState()&&(this.state().onDestroyed().unsubscribeAll(this),this.state().dataSourcesCollectionChanged().unsubscribeAll(this)),(0,G.magnetEnabled)().unsubscribe(this._onMagnetStateChangedListener),(0,$.shiftPressed)().unsubscribe(this._onShiftKeyStateChangedListener),this._paneWidgetsSharedState.onPaneDestroyed(this),null!==this._hideWholeLegend&&(g.tool.unsubscribe(this._recalculateLegendVisibility),this._chartModel().crossHairSource().measuringEnabled().unsubscribeAll(this))}size(){return this._size}setSize(e){(0,s.assert)(e.w>=0&&e.h>=0,"Try to set invalid size to PaneWidget "+JSON.stringify(e)),this._size.equals(e)||(this._size=e,this._canvasBinding.resizeCanvas({width:e.w,height:e.h}),this._topCanvasBinding.resizeCanvas({width:e.w,height:e.h}),this._paneCell.style.width=e.w+"px",this._paneCell.style.height=e.h+"px",this._div.style.width=e.w+"px",this._div.style.height=e.h+"px",this._rowElement.classList.toggle("js-hidden",0===e.h),null!==this._legendWidget&&this._legendWidget.updateWidgetModeBySize(e),null!==this._paneControls&&this._paneControls.updateWidgetModeByWidth(e.w))}width(){return this._size.w}height(){return this._size.h}backgroundColor(){return this._chartModel().backgroundColor().value()}processDoubleClickOnSource(e,t){e instanceof R.AlertLabel?(0,D.getPriceAlertsDispatcher)().then(t=>{t.openEditDialog(e.alert(),{
actionSource:"alert_label_double_click"})}):e.id()!==this._lastFinishedToolId&&this._showEditDialogForSource(e,t)}setCursorForTool(e,t,i){if(t&&t.control()&&e)return void this._setCursorClassName("pointer");if(void 0!==i){switch(i){case U.PaneCursorType.VerticalResize:this._setCursorClassName("ns-resize");break;case U.PaneCursorType.HorizontalResize:this._setCursorClassName("ew-resize");break;case U.PaneCursorType.DiagonalNeSwResize:this._setCursorClassName("nesw-resize");break;case U.PaneCursorType.DiagonalNwSeResize:this._setCursorClassName("nwse-resize");break;case U.PaneCursorType.Default:this._setCursorClassName("default");break;case U.PaneCursorType.Pointer:this._setCursorClassName("pointer");break;case U.PaneCursorType.Grabbing:this._setCursorClassName("grabbing")}return}const r=g.tool.value();if((0,g.toolIsCursor)(r)){if(null!==this._paneWidgetsSharedState.draggingSource()||this._isScrolling||this._chartUndoModel()&&this._chartUndoModel().model().sourcesBeingMoved().length)return void this._setCursorClassName("grabbing");if(e&&this._options.sourceSelectionEnabled)return void this._setCursorClassName("pointer")}if("eraser"===r)return void this._setCursorClassName("eraser");if("zoom"===r)return void this._setCursorClassName("zoom-in");const s=g.cursorTool.value();"dot"!==s?"arrow"!==s?this._setCursorClassName(""):this._setCursorClassName("default"):this._setCursorClassName("dot")}showContextMenuForSelection(e){const t=this._chartUndoModel().selection();if(t.isEmpty())return;const i=t.dataSources().filter(e=>e.hasContextMenu());this.showContextMenuForSources(i,e)}async showContextMenuForSources(e,t,i){if(!e.length)return Promise.resolve(null);const r=e[0],s=(0,c.merge)((0,c.clone)(this._options.contextMenu),i||{}),n=new E.ActionsProvider(this._chart,s);if(r===this._chartUndoModel().crossHairSource())return r.handleContextMenuEvent(t),Promise.resolve(null);{const i=await n.contextMenuActionsForSources(e);return 0===i.length?Promise.resolve(null):A.ContextMenuManager.createMenu(i).then(e=>(e.show(t),e))}}leftPriceAxisesContainer(){return this._lhsPriceAxisesContainer}rightPriceAxisesContainer(){return this._rhsPriceAxisesContainer}setPriceAxisSizes(e,t,i){this._priceAxisesContainer(e).setSizes(t,i)}state(){return(0,s.ensureNotNull)(this._state)}hasState(){return null!==this._state}setState(e){this._state!==e&&(this.hasState()&&(this.state().onDestroyed().unsubscribeAll(this),this.state().dataSourcesCollectionChanged().unsubscribeAll(this)),this._state=e,this.hasState()&&(this.state().onDestroyed().subscribe(this,this._onStateDestroyed,!0),this.state().dataSourcesCollectionChanged().subscribe(this,this._onDataSourcesCollectionChanged),this.updatePriceAxisWidgets()))}getScreenshotData(e){const t=[],i=[];let r,s=[];const n=this.state().sourcesByGroup().allExceptSpecialSources().slice().reverse(),o=this._chart.properties().childs().paneProperties.childs().legendProperties.childs();for(const a of n){const n=a.statusView();if((0,_.isStudy)(a)&&(o.showLegend.value()||(null==e?void 0:e.showCollapsedStudies))){
const r=o.showStudyTitles.value(),s=!0;a.properties().visible.value()&&n&&s&&(t.push(r?a.statusProvider(null==e?void 0:e.status).text():""),i.push(a.valuesProvider().getValues(null)))}else a===this._chartModel().mainSeries()&&n&&o.showSeriesTitle.value()&&(r=a.statusProvider((null==e?void 0:e.status)||{}).text(),s=a.valuesProvider().getValues(null))}return{type:"pane",leftAxis:this._lhsPriceAxisesContainer.getScreenshotData(),rightAxis:this._rhsPriceAxisesContainer.getScreenshotData(),content:this._canvasBinding.canvas.toDataURL(),canvas:this._canvasBinding.canvas,contentWidth:this._size.w,contentHeight:this._size.h,studies:t,studiesValues:i,containsMainSeries:this.containsMainSeries(),mainSeriesText:r,mainSeriesValues:s}}hardResetCanvas(){this._size.equals(new y.Size(0,0))||((0,y.hardResizeCanvas)(this._canvasBinding,this._size),(0,y.hardResizeCanvas)(this._topCanvasBinding,this._size),this._lhsPriceAxisesContainer.hardResetCanvas(),this._rhsPriceAxisesContainer.hardResetCanvas())}updatePriceAxisWidgets(){if(!this.hasState())return;const e=this._chartModel(),t=e.paneForSource(e.mainSeries());if(!t)return;const i=e.priceScaleSlotsCount(),r=this.state(),s=r.visibleLeftPriceScales(),n=r.visibleRightPriceScales();this._lhsPriceAxisesContainer.setScales(s,i.left,t.leftPriceScales().length,i.left+i.right),this._rhsPriceAxisesContainer.setScales(n,i.right,t.rightPriceScales().length,i.left+i.right)}update(){this.hasState()&&(this._lhsPriceAxisesContainer.update(),this._rhsPriceAxisesContainer.update(),null!==this._legendWidget&&this._legendWidget.update(),this.updateControls())}updateStatusWidget(e=X.InvalidationLevel.None){this.hasState()&&null!==this._legendWidget&&(e===X.InvalidationLevel.Full?this._legendWidget.updateLayout():this._legendWidget.update())}updateControls(){this.hasState()&&null!==this._paneControls&&this._paneControls.update()}updateThemedColors(e,t){this._themedTopColor=e,this._themedBottomColor=t,this._updateByThemedColors()}statusWidget(){return this._legendWidget}getElement(){return this._rowElement}canvasElement(){return this._canvasBinding.canvas}hasCanvas(e){return this._canvasBinding.canvas===e||this._topCanvasBinding.canvas===e}pinchStartEvent(){null===this._paneWidgetsSharedState.scrollingPane()&&null===this._paneWidgetsSharedState.pinchingPane()&&(this._onTouchEvent(),this._options.handleScale.pinch&&(this._terminateActiveAnimations(),this._prevPinchScale=1,this._pinching=!0,this._wasPinched=!0,this._paneWidgetsSharedState.setPinchingPane(this)))}pinchEvent(e,t){if(null!==this._paneWidgetsSharedState.scrollingPane()||this._paneWidgetsSharedState.pinchingPane()!==this)return;if(this._onTouchEvent(),!this._options.handleScale.pinch)return;const i=10*(t-this._prevPinchScale);this._prevPinchScale=t,this._chartModel().zoomTime(e.x,i,!0),this._prevPinchScale=t}pinchEndEvent(){null===this._paneWidgetsSharedState.scrollingPane()&&this._paneWidgetsSharedState.pinchingPane()===this&&(this._onTouchEvent(),this._pinching=!1,this._paneWidgetsSharedState.setPinchingPane(null))}mouseClickEvent(e){
this._onMouseEvent(),this._mouseClickOrTapEvent(e)}tapEvent(e){this._preventTouchEventsExceptPinch()||(this._onTouchEvent(),this._mouseClickOrTapEvent(e))}mouseDownEvent(e){this._onMouseEvent(),this.hasState()&&this._mouseDownOrTouchStartEvent(e,(0,s.ensureNotNull)(this._dataSourceAtPoint(e.localX,e.localY)))}touchStartEvent(e){if(this._paneWidgetsSharedState.startTouch(this),this._preventTouchEventsExceptPinch())return;const t=this._chartModel().crossHairSource(),i=!this._trackCrosshairOnlyAfterLongTap&&t.pane===this._state&&Number.isFinite(t.originX())&&Number.isFinite(t.originY())&&Math.abs(t.originX()-e.localX)+Math.abs(t.originY()-e.localY)<5;this._onTouchEvent(),this._chart.setActivePaneWidget(this);const r=(0,s.ensureNotNull)(this._dataSourceAtPoint(e.localX,e.localY));i&&(r.source===t||t.selectPointMode().value()?this.startTrackingMode(new n.Point(e.localX,e.localY),new n.Point(e.localX,e.localY)):!this._chart.readOnly()&&((0,f.isLineTool)(r.source)&&r.source.userEditEnabled()||r.source instanceof R.AlertLabel)&&this._chartUndoModel().selectionMacro(e=>{var t;e.clearSelection(),e.addSourceToSelection(r.source,null===(t=r.hittest)||void 0===t?void 0:t.data())})),this._mouseDownOrTouchStartEvent(e,r),this._mouseOrTouchMoveEvent(e)}mouseUpEvent(e){this._onMouseEvent(),this._mouseUpOrTouchEndEvent(e)}touchEndEvent(e){this._paneWidgetsSharedState.endTouch(this),this._preventTouchEventsExceptPinch()||(this._onTouchEvent(),this._mouseOrTouchLeaveEvent(e),this._mouseUpOrTouchEndEvent(e))}mouseMoveEvent(e){this._onMouseEvent(),this._mouseOrTouchMoveEvent(e)}pressedMouseMoveEvent(e){this._onMouseEvent(),this._pressedMouseOrTouchMoveEvent(e)}touchMoveEvent(e){this._preventTouchEventsExceptPinch()||(this._onTouchEvent(),this._pressedMouseOrTouchMoveEvent(e))}mouseLeaveEvent(e){this._onMouseEvent(),this._mouseOrTouchLeaveEvent(e)}mouseDoubleClickEvent(e){this._onMouseEvent(),this._mouseDoubleClickOrDoubleTapEvent(e)}wheelClickEvent(e){var t,i;if(this._chart.readOnly())return;const r=this._dataSourceAtPoint(e.localX,e.localY);if(null===r||r.isCustom||null===r.source)return;if(((null===(t=r.hittest)||void 0===t?void 0:t.result())||0)<=d.HitTestResult.MOVEPOINT_BACKGROUND)return;const n=new p.EnvironmentState(e),o=null===(i=r.hittest)||void 0===i?void 0:i.eraseMarker();if(n.control()&&void 0!==o&&r.source.processErase)return void r.source.processErase(this._chartUndoModel(),o);const a=this._chartUndoModel();a.selection().isSelected(r.source)||a.selectionMacro(e=>{e.clearSelection();const t=(0,s.ensureNotNull)(r.source);e.addSourceToSelection(t,ae(r,t))}),this._chart.removeSelectedSources()}doubleTapEvent(e){this._preventTouchEventsExceptPinch()||(this._onTouchEvent(),this._mouseDoubleClickOrDoubleTapEvent(e))}longTapEvent(e){if(null===this._state||this._preventTouchEventsExceptPinch())return;if(this._onTouchEvent(),this._longTap=!0,null!==this._startTrackPoint||!this._trackingModeShouldBeActive())return;const t=this._chartModel().selection();if(!t.isEmpty()){const i=(0,
s.ensureNotNull)(this._dataSourceAtPoint(e.localX,e.localY));if(null!==i.source&&t.isSelected(i.source))return}this.startTrackingMode(new n.Point(e.localX,e.localY),new n.Point(e.localX,e.localY),new p.EnvironmentState(e))}mouseEnterEvent(e){this._onMouseEvent(),this.hasState()&&(this._chart.setActivePaneWidget(this),this._setCursorPosition(e.localX,e.localY,new p.EnvironmentState(e)))}contextMenuEvent(e){this._onMouseEvent(),this._contextMenuEvent(e)}touchContextMenuEvent(e){this._preventTouchEventsExceptPinch()||(this._onTouchEvent(),this._contextMenuEvent(e))}mouseDownOutsideEvent(){this._processOutsideClick({hittest:null,isCustom:!1,renderer:null,source:null})}cancelZoom(){this._chartModel().crossHairSource().clearSelection(),this._firstZoomPoint=null,this._preventCrossHairMove()&&this._clearCursorPosition()}startTrackingMode(e,t,i){this._startChangeLineToolParams=null,this._startMoveSourceParams=null,this._currentChangingLineToolHitTest=null,this._currentMovingHitTest=null,this._chartUndoModel().selectionMacro(e=>e.clearSelection()),this._startTrackPoint=e,this._exitTrackingModeOnNextTry=!1,this._setCursorPosition(t.x,t.y,i),this._initCrossHairPosition=this._chartModel().crossHairSource().currentPoint()}setDragToAnotherPaneCursor(){this._setCursorClassName("grabbing")}cloneLineTools(e,t){return this._chartUndoModel().cloneLineTools(e,t)}exitTrackingMode(){null!==this._state&&null!==this._startTrackPoint&&(this._exitTrackingModeOnNextTry=!0,this._tryExitTrackingMode())}trackingModeEnabled(){return null!==this._state&&null!==this._startTrackPoint}addCustomWidgetToLegend(e,t){this._options.legendWidgetEnabled&&(this._customLegendWidgetsFactoryMap.set(e,t),null!==this._legendWidget&&this._legendWidget.addCustomWidgetToLegend(e,t))}containsMainSeries(){return!!this.hasState()&&this.state().containsMainSeries()}paint(e,t){if(!this._chartUndoModel()||!this.hasState())return;this._state&&(e.priceScaleSideMaxLevel("left")>X.InvalidationLevel.Cursor||e.priceScaleSideMaxLevel("right")>X.InvalidationLevel.Cursor)&&(this._recalculatePriceScales(),this._chartModel().updateCrosshairPositionByOriginCoords());const i=e.fullInvalidation();if(i>X.InvalidationLevel.Cursor){const e=this._chartModel().crossHairSource(),t=e.originX(),i=e.originY();if(e.pane===this._state&&Number.isFinite(t)&&Number.isFinite(i)){const e=this._dataSourceAtPoint(t,i);null!==e&&this._updateHoveredSource(e,(0,$.globalEnvironmentState)())}}if(this._lhsPriceAxisesContainer.paint(e.getterForPriceScaleInvalidationLevelBySide("left")),this._rhsPriceAxisesContainer.paint(e.getterForPriceScaleInvalidationLevelBySide("right")),i!==X.InvalidationLevel.None){if(i>X.InvalidationLevel.Cursor){const e=(0,s.ensureNotNull)(this._canvasBinding.canvas.getContext("2d"));e.setTransform(1,0,0,1,0,0);const i=this._canvasRenderParams();this._drawBackground(e,i),this._state&&this._drawSources(e,i,t)}if(this._state){const e=(0,s.ensureNotNull)(this._topCanvasBinding.canvas.getContext("2d"));e.setTransform(1,0,0,1,0,0);const t=this._topCanvasRenderParams()
;e.clearRect(0,0,Math.ceil(this._size.w*t.pixelRatio),Math.ceil(this._size.h*t.pixelRatio)),this._drawSeriesTopViews(e,t),this._drawCrossHair(e,t),this._drawActiveLineTools(e,t)}}}cancelCreatingLineTool(){const e=this._chartUndoModel(),t=this._chartUndoModel().lineBeingCreated();if(t)if(t.pointsCount()<=0){const i=t.points();if(i.length>2){const r=i[i.length-2];e.continueCreatingLine(r),this._finishTool(t)}else e.cancelCreatingLine()}else e.cancelCreatingLine();null!==this._firstZoomPoint&&this.cancelZoom(),this.setCursorForTool()}drawRightThere(e){if((0,f.isLineToolName)(e)&&this.hasState()){const t=this._chartUndoModel(),i=t.crossHairSource(),r=t.model().magnet().align(i.price,i.index,this.state());t.createLineTool(this.state(),{index:i.index,price:r},e)}}cancelMeasuring(){this._chartUndoModel().crossHairSource().clearMeasure(),(0,g.resetToCursor)(),this.setCursorForTool()}_topCanvasRenderParams(){return{pixelRatio:this._topCanvasBinding.pixelRatio,physicalWidth:this._topCanvasBinding.canvas.width,physicalHeight:this._topCanvasBinding.canvas.height,cssWidth:this._chartModel().timeScale().width(),cssHeight:this.height()}}_canvasRenderParams(){return{pixelRatio:this._canvasBinding.pixelRatio,physicalWidth:this._canvasBinding.canvas.width,physicalHeight:this._canvasBinding.canvas.height,cssWidth:this._chartModel().timeScale().width(),cssHeight:this.height()}}_tryExitTrackingMode(e){this._exitTrackingModeOnNextTry&&(this._startTrackPoint=null,e||this._clearCursorPosition())}_tryStartMeasure(e,t,i,r,s){return!(!(0,g.toolIsMeasure)(g.tool.value())||t.startMeasurePoint())&&(e.isTouch||this._preventCrossHairMove()||this._setCursorPosition(e.localX,e.localY,i),r=this._chartModel().magnet().align(r,s,this.state()),t.startMeasuring({price:r,index:s},this.state()),!0)}_tryFinishMeasure(e,t){if(t.startMeasurePoint()&&!t.endMeasurePoint()){let i=t.price;const r=t.index;return i=this._chartModel().magnet().align(i,r,this.state()),t.finishMeasure({price:i,index:r}),e.isTouch?(0,g.resetToCursor)():this._needResetMeasureLater=!0,this._preventCrossHairMove()&&this._clearCursorPosition(),!0}return!1}_tryStartZoom(e,t,i,r){const s=this._chart.model().model().zoomEnabled();if("zoom"===g.tool.value()&&s){const s=this._chartUndoModel(),n=s.timeScale().indexToCoordinate(i)-.5*s.timeScale().barSpacing();return this._firstZoomPoint={price:t,index:i,x:n,y:e.localY},this._preventCrossHairMove()||this._setCursorPosition(e.localX,e.localY,r),this._chartModel().crossHairSource().startSelection(this.state()),!0}return!1}_finishZoom(e){const t=this.state(),i=t.defaultPriceScale(),r=(0,s.ensureNotNull)(t.mainDataSource()).firstValue(),n=i.coordinateToPrice(e.localY,(0,s.ensureNotNull)(r)),o=this._chartUndoModel(),a=Math.round(o.timeScale().coordinateToIndex(e.localX)),l=(0,s.ensureNotNull)(this._firstZoomPoint);a!==l.index&&o.zoomToViewport(l.index,a,l.price,n,t),this._chartModel().crossHairSource().clearSelection(),this._firstZoomPoint=null,(0,g.resetToCursor)(),this._preventCrossHairMove()&&this._clearCursorPosition()}_tryFinishZoom(e){
return null!==this._firstZoomPoint&&(this._finishZoom(e),!0)}_tryHandleEraserMouseDown(e,t){if(e.source&&"eraser"===g.tool.value()&&!e.isCustom&&(!(i=e.source)||!i.customization||!i.customization.disableErasing)){const i=this._chartUndoModel();if(null!==e.hittest&&((0,f.isLineTool)(e.source)||(0,_.isStudy)(e.source))){const r=e.hittest.eraseMarker();return t.control()&&void 0!==r&&e.source.processErase?e.source.processErase(i,r):i.removeSource(e.source,!1),!0}}var i;return!1}_tryStartChangingLineTool(e,t,i,r){var n,o;if(e.isTouch&&null!==this._startTrackPoint)return!1;const a=t.hittest;if((!e.isTouch||!this._preventSourceChange)&&a&&(0,f.isLineTool)(t.source)&&a.result()===d.HitTestResult.CHANGEPOINT){const l=this._chartUndoModel(),c=(0,s.ensure)(null===(n=this.state().mainDataSource())||void 0===n?void 0:n.firstValue()),u=(0,s.ensureNotNull)(t.source.priceScale()).coordinateToPrice(e.localY,c);l.selectionMacro(e=>{e.clearSelection(),e.addSourceToSelection(t.source,a.data())});const d=l.model().magnet().align(u,r,this.state()),h=null===(o=a.data())||void 0===o?void 0:o.pointIndex;return this._startChangeLineToolParams={source:t.source,startPoint:{index:r,price:d},screenPoint:{x:e.localX,y:e.localY},pointIndex:h,envState:i},!0}return this._startChangeLineToolParams=null,!1}_tryStartCloning(e,t,i,r){if(i.control()){const t=this._chartUndoModel().selection().dataSources().filter(e=>e.cloneable());if(r&&r.cloneable()&&t.push(r),t.length>0)return this._clonningAtMoveLineTools=t.map(e=>e.id()),this._startCloningPoint=new n.Point(e.localX,e.localY),!0}return!1}_tryFinishClonning(e,t,i){const r=this._chartUndoModel(),o=this._chartModel();if(t.control()&&this._clonningAtMoveLineTools){const a=new n.Point(e.localX,e.localY),l=(0,s.ensureNotNull)(this._startCloningPoint).subtract(a).length(),c=[];for(const e of this._clonningAtMoveLineTools){const t=o.dataSourceForId(e);null!==t&&c.push(t)}if(0===c.length)return!1;if(l>8){const o=this.cloneLineTools(c,!0).map(e=>(0,s.ensureNotNull)(r.model().dataSourceForId(e)));r.selectionMacro(e=>{e.clearSelection();let t=null;o.forEach(r=>{null===t&&(t=ae(i,r)),e.addSourceToSelection(r,t)})});const a=new n.Point(e.localX,e.localY),l=(0,s.ensureNotNull)(o[0].priceScale()),u=(0,s.ensureNotNull)(this.state().mainDataSource()).firstValue(),d={index:r.timeScale().coordinateToIndex(e.localX),price:l.coordinateToPrice(e.localY,(0,s.ensureNotNull)(u))};r.startMovingSources(o,{logical:d,screen:a},null,t),this._clonningAtMoveLineTools=null,this._startCloningPoint=null}return!0}return!1}_mouseDownEventForLineTool(e,t,i,r){var o,a;const l=g.tool.value();if(!this.hasState()||(0,B.isLineToolDrawWithoutPoints)(l))return;const c=this._chartUndoModel();let u=!1,d=null;(0,g.hideAllDrawings)().value()&&(0,g.hideAllIndicators)().setValue(!1),(0,g.hideAllDrawings)().setValue(!1),(0,g.lockDrawings)().setValue(!1),e.isTouch&&((0,f.isLineToolName)(l)&&!(0,B.isLineDrawnWithPressedButton)(l)||c.lineBeingCreated())&&this._initToolCreationModeParams(e);const h=c.lineBeingCreated();if(h&&!(0,
B.isLineDrawnWithPressedButton)(h.toolname)){const l=(0,s.ensure)(null===(o=h.ownerSource())||void 0===o?void 0:o.firstValue());if(e.isTouch){if(!this._startTouchPoint){this._startTouchPoint=new n.Point(e.pageX,e.pageY);const t=h.points(),i=t[t.length-1],r=c.timeScale().indexToCoordinate(i.index),o=(0,s.ensureNotNull)(h.priceScale()).priceToCoordinate(i.price,l);return void(this._initCrossHairPosition=new n.Point(r,o))}}else{d=h;const n=c.model().paneForSource(h);if(n!==this._state&&null!==n){const i=this._externalPaneXCoord(n,e.localX),r=this._externalPaneYCoord(n,e.localY);u=c.continueCreatingLine({index:Math.round(c.timeScale().coordinateToIndex(i)),price:(0,s.ensure)(null===(a=h.priceScale())||void 0===a?void 0:a.coordinateToPrice(r,l))},t)}else{const e=c.model().magnet().align(r,i,this.state());u=c.continueCreatingLine({index:i,price:e},t)}}}else if(!e.isTouch||(0,B.isLineDrawnWithPressedButton)(l)){const e={index:i,price:c.model().magnet().align(r,i,this.state())};d=c.createLineTool(this.state(),e,l),c.lineBeingCreated()||(u=!0)}const p=(0,s.ensureNotNull)(this._dataSourceAtPoint(e.localX,e.localY));d&&c.selectionMacro(e=>{var t;return e.addSourceToSelection((0,s.ensureNotNull)(d),null===(t=p.hittest)||void 0===t?void 0:t.data())}),u&&d&&(this._finishTool(d,p),e.preventDefault())}_handleSelectionMouseDownAndGetJustDeselectedSource(e,t,i){const r=this._chartUndoModel();let s=null;if(null===t.source||t.source.isSelectionEnabled()){let n=e.isTouch?Boolean(t.hittest&&t.hittest.result()>=d.HitTestResult.MOVEPOINT_BACKGROUND):Boolean(t.hittest&&t.hittest.result()>d.HitTestResult.MOVEPOINT_BACKGROUND);this._preventSourceChange&&(n=!1),r.selectionMacro(e=>{var r;n&&t.source?(i.control()||e.selection().isSelected(t.source)||e.clearSelection(),i.control()&&e.selection().isSelected(t.source)?(s=t.source,e.removeSourceFromSelection(t.source)):e.addSourceToSelection(t.source,null===(r=t.hittest)||void 0===r?void 0:r.data()),e.selection().allSources().length>1&&(0,z.trackEvent)("GUI","Multiselect","Click Select")):i.control()||e.clearSelection()})}return s}_processMouseMoveWhileZoom(e,t){this._preventCrossHairMove()||this._setCursorPosition(e.localX,e.localY,t)}_updateCommonTooltip(e,t){let i=null;if(null!==e&&null!==e.hittest){const t=e.hittest.data();t&&(i=t.tooltip||null)}const r=this._lastCommonTooltipData;if(null===r&&null===i)return;if(null===i||""===i.text)return this._lastCommonTooltipData=null,void(0,H.hide)(t);if(r&&i.text===r.text&&i.rect&&r.rect&&i.rect.x===r.rect.x&&i.rect.y===r.rect.y&&i.rect.w===r.rect.w&&i.rect.h===r.rect.h)return;this._lastCommonTooltipData=i;const s=(0,c.clone)(i);if(void 0!==s.rect){const e=this._paneCell.getBoundingClientRect();s.rect.x+=e.left,s.rect.y+=e.top}(0,H.show)(s)}_setCursorPositionOnExternalPane(e,t,i,r){t=this._externalPaneXCoord(e,t),i=this._externalPaneYCoord(e,i);this._chart.paneByState(e)._setCursorPosition(t,i,r)}_setCursorPosition(e,t,i){this._chartModel().setAndSaveCurrentPosition(this._correctXCoord(e),this._correctYCoord(t),this.state(),i)}_setCursorClassName(e){
let t="";e&&(t="pane--cursor-"+e),this._currentCursorClassName!==t&&(this._currentCursorClassName&&this._paneCell.classList.remove(this._currentCursorClassName),t&&this._paneCell.classList.add(t),this._currentCursorClassName=t,this._paneCell.style.cursor)}_processMouseUpOrTouchEndHandler(e){var t;null===(t=(0,s.ensureNotNull)(this._dataSourceAtPoint(e.localX,e.localY)).hittest)||void 0===t||t.tryCallMouseUpOrTouchEndHandler(e)}_crossHairShouldBeVisible(){const e=this._chartModel().crossHairSource();return(0,f.isLineToolName)(g.tool.value())||(0,g.toolIsMeasure)(g.tool.value())||e.startMeasurePoint()&&!e.endMeasurePoint()||null!==this._firstZoomPoint||null!==this._chartModel().lineBeingEdited()||null!==this._chartModel().lineBeingCreated()}_clearCursorPosition(){this._chartModel().clearCurrentPosition()}_dataSourceAtPoint(e,t){if(!this.hasState())return null;const i={source:null,hittest:null,isCustom:!1,renderer:null},r=this._chartUndoModel();if((0,f.isLineToolName)(g.tool.value())||null!==r.lineBeingCreated())return i;if(this._currentChangingLineToolHitTest)return this._currentChangingLineToolHitTest;if(this._currentMovingHitTest)return this._currentMovingHitTest;const s=this.state(),o=s.height(),a=s.width(),l=le.bind(null,i),c=this._canvasRenderParams(),u=new n.Point(e,t),d=s.sourcesByGroup(),p=r.selection();this._hitTestSources(c,p.dataSources(),u,l,!1),this._hitTestSources(c,p.customSources(),u,l,!0);const _=new Set(p.allSources().map(e=>e.id()));this._hitTestSources(c,[r.crossHairSource()],u,l,!1,_),this._hitTestSources(c,s.customSources(h.CustomSourceLayer.Topmost),u,l,!0,_),this._hitTestSources(c,d.tradingSources(),u,l,!1,_),this._hitTestSources(c,s.customSources(h.CustomSourceLayer.Foreground),u,l,!0,_);const m=[...this._chartModel().multiPaneSources(s),...d.hitTestSources()];if(this._hitTestSources(c,m,u,l,!1,_),this.containsMainSeries()){const e=r.barsMarksSources();for(let t=0;t<e.length;++t){const r=e[t],n=r.paneViews(s)||[];let l,d;for(let e=0;e<n.length;e++)l=n[e].renderer(o,a),null!==l&&(d=l.hitTest(u,c),d&&le(i,d,r,l,!1))}const t=r.activeStrategySource().value();if(null!==t){const e=t.strategyOrdersPaneView();if(null!==e){const r=e.renderer(o,a);if(null!==r){const e=r.hitTest(u,c);e&&le(i,e,t,r,!1)}}}}return null===i.source&&this._hitTestSources(c,s.customSources(h.CustomSourceLayer.Background),u,l,!0,_),i}_hitTestSources(e,t,i,r,n,o){const a=(0,s.ensureNotNull)(this._state),l=a.height(),c=a.width();for(let s=t.length-1;s>=0;--s){const u=t[s];if(void 0!==o&&o.has(u.id()))continue;const d=u.paneViews(a);if(null!==d&&0!==d.length)for(let t=d.length-1;t>=0;--t){const s=d[t].renderer(l,c);if(s&&s.hitTest){const t=s.hitTest(i,e);null!==t&&r(t,u,s,n)}}}}_tryStartMovingLineTool(e,t,i,r){var o,a;if(null===t.source||!t.source.movable()||null!==this._startTrackPoint)return!1;if(!this._preventSourceChange){const l=this._chartUndoModel(),c=(0,s.ensureNotNull)((0,s.ensureNotNull)(this._state).mainDataSource()).firstValue(),u=(0,s.ensureNotNull)(t.source.priceScale()).coordinateToPrice(e.localY,(0,
s.ensureNotNull)(c)),d=(t.source.isSelectionEnabled()?l.selection().allSources():[t.source]).filter(K),h=new n.Point(e.localX,e.localY),p={index:r,price:u},_=null===(a=null===(o=t.hittest)||void 0===o?void 0:o.data())||void 0===a?void 0:a.activeItem;return this._startMoveSourceParams={source:d,startPoint:{logical:p,screen:h},activeItem:void 0===_?null:_,envState:i},!0}return this._startMoveSourceParams=null,!1}_chartModel(){return this._chart.model().model()}_chartUndoModel(){return this._chart.model()}_externalPaneXCoord(e,t){t+=this._div.getBoundingClientRect().left+document.body.scrollLeft;const i=(0,s.ensureNotNull)(this._chart.paneByState(e)),r=i._div.getBoundingClientRect().left+document.body.scrollLeft;return i._correctXCoord(t-r)}_externalPaneYCoord(e,t){t+=this._div.getBoundingClientRect().top+document.body.scrollTop;const i=(0,s.ensureNotNull)(this._chart.paneByState(e)),r=i._div.getBoundingClientRect().top+document.body.scrollTop;return i._correctYCoord(t-r)}_correctXCoord(e){return Math.max(0,Math.min(e,this._size.w-1))}_correctYCoord(e){return Math.max(0,Math.min(e,this._size.h-1))}_processScroll(e){if(!this._chart.model().model().scrollEnabled())return;const t=Date.now();this._startScrollingPos||this._preventScroll()||(this._startScrollingPos={x:e.clientX,y:e.clientY,timestamp:t,localX:e.localX,localY:e.localY}),null!==this._scrollXAnimation&&this._scrollXAnimation.addPosition(e.localX,t),null!==this._scrollYAnimation&&this._scrollYAnimation.addPosition(e.localY,t);const i=this._chartUndoModel();let r=this.state().defaultPriceScale();if(this._startScrollingPos&&!this._isScrolling&&(this._startScrollingPos.x!==e.clientX||this._startScrollingPos.y!==e.clientY))return i.beginUndoMacro("scroll").setCustomFlag("doesnt_affect_save",!0),null===this._scrollXAnimation&&this._options.useKineticScroll&&(this._scrollXAnimation=new C.KineticAnimation(.2,7,.997,15),this._scrollXAnimation.addPosition(this._startScrollingPos.localX,this._startScrollingPos.timestamp),this._scrollXAnimation.addPosition(e.localX,t)),this._scrollYAnimation,i.selection().isEmpty()||(r=i.selection().allSources()[0].priceScale()),null===r||r.isEmpty()||(this._scrollPriceScale=r,i.startScrollPrice(this.state(),r,e.localY)),i.startScrollTime(e.localX),this._isScrolling=!0,this.setCursorForTool(),void this._paneWidgetsSharedState.setScrollingPane(this);this._isScrolling&&(null!==this._scrollPriceScale&&i.scrollPriceTo(this.state(),this._scrollPriceScale,e.localY),i.scrollTimeTo(e.localX))}_finishScroll(){const e=this._chartUndoModel();e.endScrollTime(),null!==this._scrollPriceScale&&e.endScrollPrice(this.state(),this._scrollPriceScale),e.endUndoMacro(),this._isScrolling=!1,this._startScrollingPos=null,this._scrollPriceScale=null,this.setCursorForTool(),this._paneWidgetsSharedState.setScrollingPane(null)}_endScroll(e){if(!this._isScrolling)return!1;const t=this._isScrolling&&this._scrollUndoCommandInStack();if(this._isScrolling){const i=Date.now();null!==this._scrollXAnimation&&this._scrollXAnimation.start(e.localX,i),
null!==this._scrollYAnimation&&this._scrollYAnimation.start(e.localY,i);const r=this._chartUndoModel(),s=null===this._scrollXAnimation||this._scrollXAnimation.finished(i),n=null===this._scrollYAnimation||this._scrollYAnimation.finished(i);if(s&&n)return this._finishScroll(),t;s?(r.endScrollTime(),this._paneWidgetsSharedState.setScrollingPane(null)):n&&(this._scrollPriceScale&&r.endScrollPrice(this.state(),this._scrollPriceScale),this._scrollPriceScale=null);const o=r.timeScale(),a=this._scrollXAnimation,l=this._scrollYAnimation,c=()=>{if((null===a||a.terminated())&&(null===l||l.terminated()))return;const e=Date.now();let t=null===a||a.finished(e);const i=null===l||l.finished(e);if(null!==a&&!a.terminated()){const i=o.rightOffset();r.scrollTimeTo(a.getPosition(e)),i===o.rightOffset()&&(t=!0,this._scrollXAnimation=null)}null===l||l.terminated()||null===this._scrollPriceScale||r.scrollPriceTo(this.state(),this._scrollPriceScale,l.getPosition(e)),t&&i?this._finishScroll():requestAnimationFrame(c)};requestAnimationFrame(c)}return t}_terminateActiveAnimations(){const e=Date.now(),t=null===this._scrollXAnimation||this._scrollXAnimation.finished(e),i=null===this._scrollYAnimation||this._scrollYAnimation.finished(e);null===this._scrollXAnimation&&null===this._scrollYAnimation||t&&i||this._finishScroll(),null!==this._scrollXAnimation&&(this._scrollXAnimation.terminate(),this._scrollXAnimation=null),null!==this._scrollYAnimation&&(this._scrollYAnimation.terminate(),this._scrollYAnimation=null)}_preventScroll(){return this._trackCrosshairOnlyAfterLongTap&&this._longTap||this._contextMenuOpenedOnLastTap||(0,f.isLineToolName)(g.tool.value())||Boolean(this._chartUndoModel().lineBeingCreated())||null!==this._startTrackPoint}_isSelectPointModeEnabled(){return this._chartUndoModel().crossHairSource().selectPointMode().value()}_preventCrossHairMove(){return!!this._trackCrosshairOnlyAfterLongTap&&(null===this._chart.trackingModePaneWidget()&&(!!this._contextMenuOpenedOnLastTap||!this._crossHairShouldBeVisible()&&null===this._startTrackPoint))}_finishTool(e,t=null){const i=this._chartUndoModel(),r=g.tool.value();if((0,g.resetToCursor)(),this._preventCrossHairMove()&&this._clearCursorPosition(),i.selectionMacro(i=>{i.addSourceToSelection(e,ae(t,e))}),(0,B.isTextToolName)(r)){const t=i.createUndoCheckpoint();this._chart.showChartPropertiesForSource(e,F.TabNames.text,void 0,t)}this._lastFinishedToolId=e.id(),(0,V.trackDrawingCreated)(e)}_alignSourcesThatBeingMoved(e,t,i,r){const s=this._chartUndoModel(),o=s.timeScale().coordinateToIndex(t);s.model().sourcesBeingMoved().forEach(e=>{var a,l;let c=o,u=e.convertYCoordinateToPriceForMoving(i,this.state().mainDataSource());if(null!==u){if((0,_.isStudy)(e)){const e=s.mainSeries(),t=e.bars().firstIndex(),i=e.bars().lastIndex();null!==t&&null!==i&&(c=Math.min(Math.max(o,t),i)),u=this._chartModel().magnet().align(u,o,this.state())}
null!==this._currentMovingHitTest&&void 0!==(null===(l=null===(a=this._currentMovingHitTest.hittest)||void 0===a?void 0:a.data())||void 0===l?void 0:l.cursorType)||this.setCursorForTool(),s.moveSources({screen:new n.Point(t,i),logical:{index:c,price:u}},r)}})}_resetMeasureIfRequired(){this._needResetMeasureLater&&((0,g.resetToCursor)(),this._needResetMeasureLater=!1)}_drawBackground(e,t){const i=Math.ceil(t.pixelRatio*this._size.w),r=Math.ceil(t.pixelRatio*this._size.h),s=this._chartModel(),n=s.backgroundTopColor().value(),o=s.backgroundColor().value();n===o?(0,y.clearRect)(e,0,0,i+1,r+1,o):(0,b.clearRectWithGradient)(e,0,0,i+1,r+1,n,o)}_drawWatermark(e,t){const i=this._chartModel().watermarkSource();if(null===i)return;const r=this.state();if(!r.containsMainSeries())return;const s=i.paneViews(),n=r.height(),o=r.width();for(const i of s){e.save();const r=i.renderer(n,o);r&&r.draw(e,t),e.restore()}}_drawCrossHair(e,t){const i=this._chartUndoModel().crossHairSource();!i.visible&&(0,g.lockTimeAxis)().value()&&(i.setLockedPosition((0,s.ensureNotNull)(this._state)),i.updateAllViews()),this._drawSourceImpl(e,t,re,ie,i)}_drawActiveLineTools(e,t){const i=this._chartModel(),r=[i.lineBeingCreated(),i.lineBeingEdited(),...i.sourcesBeingMoved(),i.customSourceBeingMoved()].filter(e=>!!e);for(const s of r){(i.paneForSource(s)===this.state()||(0,m.isDataSource)(s)&&s.isMultiPaneEnabled())&&this._drawSourceImpl(e,t,re,ie,s)}}_drawSeriesTopViews(e,t){this.state().containsMainSeries()&&this._drawSourceImpl(e,t,se,ie,this._chartUndoModel().mainSeries())}_drawSources(e,t,i){const r=this.state(),s=r.model(),n=r.sourcesByGroup(),o=n.tradingSources(),a=[...s.multiPaneSources(r),...n.generalSources()],l=n.phantomSources(),u=r.customSources(h.CustomSourceLayer.Background).slice(),d=r.customSources(h.CustomSourceLayer.Foreground).slice(),p=r.customSources(h.CustomSourceLayer.Topmost).slice();this._drawSourceImpl(e,t,re,ie,s.gridSource()),this._drawWatermark(e,t);for(const i of u)this._drawSourceImpl(e,t,re,te,i);for(const i of a)this._drawSourceImpl(e,t,re,te,i);for(const i of d)this._drawSourceImpl(e,t,re,te,i);for(const i of l)this._drawSourceImpl(e,t,re,te,i);const _=new Set;[s.lineBeingCreated(),s.lineBeingEdited(),...s.sourcesBeingMoved(),s.customSourceBeingMoved()].filter(c.notNull).forEach(e=>_.add(e.id()));let f=s.hoveredSource();null!==f&&(ee(f)||_.has(f.id())||(0,m.isDataSource)(f)&&!a.includes(f)?f=null:_.add(f.id()));const g=s.selection().allSources().filter(e=>!((0,m.isDataSource)(e)&&!a.includes(e))&&(!_.has(e.id())&&!ee(e)));g.forEach(e=>_.add(e.id()));{for(const i of u)this._drawSourceImpl(e,t,re,ie,i,_);for(const i of a)this._drawSourceImpl(e,t,re,ie,i,_);for(const i of d)this._drawSourceImpl(e,t,re,ie,i,_);const i=s.activeStrategySource().value();i&&this.containsMainSeries()&&this._drawSourceImpl(e,t,oe,ie,i)}for(const i of o)this._drawSourceImpl(e,t,re,te,i);for(const i of p)this._drawSourceImpl(e,t,re,te,i);for(const i of o)this._drawSourceImpl(e,t,re,te,i);for(const i of p)this._drawSourceImpl(e,t,re,te,i)
;for(const i of a)this._drawSourceImpl(e,t,ne,ie,i,_);for(const i of d)this._drawSourceImpl(e,t,ne,ie,i,_);this._drawBarsMarks(e,t,i);for(const i of o)this._drawSourceImpl(e,t,re,ie,i,_);for(const i of p)this._drawSourceImpl(e,t,re,ie,i,_);for(const i of g)this._drawSourceImpl(e,t,re,ie,i);for(const i of g)this._drawSourceImpl(e,t,ne,ie,i);f&&(this._drawSourceImpl(e,t,re,ie,f),this._drawSourceImpl(e,t,ne,ie,f));for(const i of l)this._drawSourceImpl(e,t,re,ie,i,_)}_drawSourceImpl(e,t,i,r,s,n){if(n&&n.has(s.id()))return;const o=this.state(),a=o.height(),l=o.width(),c=i(s,this.state());if(c)for(const i of c){const s=i.renderer(a,l);s&&(e.save(),r(s,e,t),e.restore())}}_drawBarsMarks(e,t,i){if(this.containsMainSeries()&&!i){const i=this._chartUndoModel().barsMarksSources();for(const r of i)this._drawSourceImpl(e,t,re,ie,r)}}_updateByThemedColors(){null!==this._legendWidget&&this._legendWidget.updateThemedColors(this._themedTopColor),null!==this._paneControls&&this._paneControls.updateThemedColors(this._themedTopColor)}_scrollUndoCommandInStack(){const e=this._chartUndoModel().undoHistory().undoStack();if(e.isEmpty())return!1;const t=e.head();if(!(t instanceof v.UndoMacroCommand))return!1;if(t.isEmpty())return!1;const i=t.commands()[0];return i instanceof M.PriceScaleChangeUndoCommand||i instanceof L.TimeScaleChangeUndoCommand}_onStateDestroyed(){this.setState(null)}_getHideNotMainSourcesValue(){return de&&!this._chart.isActive()&&!this._chart.crossHairSyncEnabled()}_onDataSourcesCollectionChanged(){this._startMoveSourceParams=null}_processMouseEnterLeaveMoveHandlers(e,t){var i,r,s,n;null!==this._prevHoveredHittest&&this._prevHoveredHittest.renderer!==e.renderer&&((0,d.tryCallHandler)(t,null===(r=null===(i=this._prevHoveredHittest.hittest)||void 0===i?void 0:i.data())||void 0===r?void 0:r.mouseLeaveHandler),this._prevHoveredHittest=null),t.isTouch||(e.hittest&&(null===(s=this._prevHoveredHittest)||void 0===s?void 0:s.renderer)!==e.renderer&&(e.hittest.tryCallMouseEnterHandler(t),this._prevHoveredHittest=e),null===(n=e.hittest)||void 0===n||n.tryCallMouseMoveHandler(t))}_startChangeOrMoveLineToolIfNeeded(){if(null!==this._startChangeLineToolParams){const e=this._startChangeLineToolParams;this._chartUndoModel().startChangingLinetool(e.source,e.startPoint,e.pointIndex,e.envState)}if(null!==this._startMoveSourceParams){const e=this._startMoveSourceParams;this._chartUndoModel().startMovingSources(e.source,e.startPoint,e.activeItem,e.envState)}this._startMoveSourceParams=null,this._startChangeLineToolParams=null}_trackingModeShouldBeActive(){return!(!this._trackCrosshairOnlyAfterLongTap||this._contextMenuOpenedOnLastTap||this._crossHairShouldBeVisible())&&this._longTap}_processOutsideClick(e){let t=null;const i=this._chartModel();if(e.source&&(t=e.isCustom?i.customSourceName(e.source):e.source.id()),null!==this._lastClickedSource&&this._lastClickedSource.id!==t){const e=this._lastClickedSource.id;let t=this._lastClickedSource.isCustom?i.customSourceForName(e):i.dataSourceForId(e)
;null!==t||this._lastClickedSource.isCustom||(t=this._chartUndoModel().barMarksSourceForId(e)),null!==t&&t.onClickOutside&&(t.onClickOutside(),this._chartModel().updateSource(t))}this._lastClickedSource=null!==t?{id:t,isCustom:e.isCustom}:null}_mouseClickOrTapEvent(e){var t,i,r;if(!this.hasState())return;const n=this._dataSourceAtPoint(e.localX,e.localY),o=n&&n.source,a=this._chartUndoModel(),c=Boolean(null===(i=null===(t=null==n?void 0:n.hittest)||void 0===t?void 0:t.data())||void 0===i?void 0:i.hideCrosshairLinesOnHover);this._processOutsideClick((0,s.ensureNotNull)(n)),!this._isSelectPointModeEnabled()||c||e.isTouch&&this.trackingModeEnabled()&&!this._exitTrackingModeOnNextTry||a.crossHairSource().trySelectCurrentPoint(),(null===(r=null==n?void 0:n.hittest)||void 0===r?void 0:r.tryCallClickOrTapHandler(e))&&a.model().updateSource((0,s.ensureNotNull)(o)),!e.isTouch||this._isSelectPointModeEnabled()||n&&n.source===a.crossHairSource()||this._tryExitTrackingMode(),o instanceof S.BarsMarksContainer&&n&&n.hittest&&n.hittest.data()&&o.onClicked((0,s.ensureNotNull)(n.hittest).data()),o&&(0,f.isLineTool)(o)&&(0,l.emit)("drawing_event",o.id(),"click"),this._resetMeasureIfRequired()}_mouseDownOrTouchStartEvent(e,t){var i,r,o,c,u,h,_,m;if(e.isTouch&&(this._longTap=!1,this._exitTrackingModeOnNextTry=null!==this._startTrackPoint,this._paneWidgetsSharedState.clearDraggingSource()),this._contextMenuOpenedOnLastTap=!1,this._lastFinishedToolId=null,this._terminateActiveAnimations(),e.isTouch&&this._switchTrackingModeFromAnotherPaneIfNeeded(e),document.activeElement!==document.body&&document.activeElement!==document.documentElement)document.activeElement&&document.activeElement.blur?document.activeElement.blur():document.body.focus();else{const e=document.getSelection();null!==e&&e.removeAllRanges()}(0,l.emit)("mouse_down",{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY}),this._updateCommonTooltip(null);const v=this._chartUndoModel(),S=new p.EnvironmentState(e);v.mainSeries().clearGotoDateResult(),this.hideInplaceEditor();const y=this.state().defaultPriceScale();if(y.isEmpty()||v.timeScale().isEmpty())return;const b=v.crossHairSource();if(!e.isTouch&&!(0,B.isLineDrawnWithPressedButton)(g.tool.value())){const t=v.lineBeingCreated(),i=null!==t?v.model().paneForSource(t):null;null!==i&&i!==this._state?this._setCursorPositionOnExternalPane(i,e.localX,e.localY,S):this._setCursorPosition(e.localX,e.localY,S)}e.isTouch&&(0,f.isLineToolName)(g.tool.value())&&((0,B.isLineDrawnWithPressedButton)(g.tool.value())||null!==b.pane?(0,B.isLineDrawnWithPressedButton)(g.tool.value())&&this._clearCursorPosition():this._chart.updateCrossHairPositionIfNeeded());const w=(0,s.ensureNotNull)(this.state().mainDataSource()).firstValue();if(null===w)return void(this._chart.readOnly()||(this._handleSelectionMouseDownAndGetJustDeselectedSource(e,t,S),t.source&&t.source instanceof k.PriceDataSource&&t.source.isDraggable()&&this._paneWidgetsSharedState.trySetDraggingSource(t.source,this)))
;let P=y.coordinateToPrice(e.localY,w),C=this._chartModel().timeScale().coordinateToIndex(e.localX);if(b.startMeasurePoint()&&b.endMeasurePoint()&&b.clearMeasure(),S.shift()&&!(null===(o=null===(r=null===(i=t.hittest)||void 0===i?void 0:i.data())||void 0===r?void 0:r.hasOwnShortcutsBehaviourFor)||void 0===o?void 0:o.shiftKey)&&(0,g.toolIsCursor)(g.tool.value())&&v.selection().isEmpty()&&g.tool.setValue("measure"),(e.isTouch||!this._tryStartMeasure(e,b,S,P,C))&&(e.isTouch||!this._tryFinishMeasure(e,b))&&!this._tryFinishZoom(e)&&!this._tryStartZoom(e,P,C,S)){if(e.isTouch&&(null!==this._startTrackPoint?(this._initCrossHairPosition=b.currentPoint(),this._startTrackPoint=new n.Point(e.localX,e.localY)):this._isSelectPointModeEnabled()&&null===this._chart.trackingModePaneWidget()&&this.startTrackingMode(new n.Point(e.localX,e.localY),new n.Point(e.localX,e.localY),new p.EnvironmentState(e))),e.isTouch&&(this._preventSourceChange=null===t.source||!v.selection().isSelected(t.source)),!this._isSelectPointModeEnabled()&&!this._isScrolling){if(e.isTouch&&((0,g.toolIsMeasure)(g.tool.value())||null!==b.measurePane()))return void this._initToolCreationModeParams(e);if((0,f.isLineToolName)(g.tool.value())||v.lineBeingCreated())return S.shift()||v.selectionMacro(e=>e.clearSelection()),void this._mouseDownEventForLineTool(e,S,C,P)}if(null===(c=t.hittest)||void 0===c||c.tryCallMouseDownOrTouchStartHandler(e),!this._chart.readOnly()){const i=this._handleSelectionMouseDownAndGetJustDeselectedSource(e,t,S);if(t.hittest&&t.source&&(!this._preventSourceChange||!J)){const i=t.hittest.data();if(t.isCustom){if(t.hittest.hasPressedMoveHandler(e))return v.model().setMovingCustomSource(t.source,i),this._currentMovingHitTest=t,void v.selectionMacro(e=>{e.clearSelection(),e.addSourceToSelection((0,s.ensureNotNull)(t.source),(0,s.ensureNotNull)(i))})}else if((null==i?void 0:i.areaName)===d.AreaName.SourceItemMove){const r=null==i?void 0:i.activeItem;if(void 0!==r)return v.startCustomMoving(t.source,r,e),this._currentMovingHitTest=t,void v.selectionMacro(e=>{e.clearSelection(),e.addSourceToSelection((0,s.ensureNotNull)(t.source),(0,s.ensureNotNull)(i))})}}if(this._tryHandleEraserMouseDown(t,S))return;const r=t.source&&(0,f.isLineTool)(t.source)&&t.source.isLocked&&t.source.isLocked();if(!((0,g.lockDrawings)().value()||r)&&!t.isCustom){if(t.source&&!t.source.userEditEnabled())return;const r=null===(h=null===(u=t.hittest)||void 0===u?void 0:u.data())||void 0===h?void 0:h.snappingPrice,s=null===(m=null===(_=t.hittest)||void 0===_?void 0:_.data())||void 0===m?void 0:m.snappingIndex;let n=e.localY,o=e.localX;if(void 0!==r&&(n=y.priceToCoordinate(r,w),P=r),void 0!==s&&(o=this._chartModel().timeScale().indexToCoordinate(s),C=s),n===e.localY&&o===e.localX||(e={...e,localY:n,localX:o},this._setCursorPosition(e.localX,e.localY,S)),this._tryStartChangingLineTool(e,t,S,C))return void(this._currentChangingLineToolHitTest=t);if(this._currentChangingLineToolHitTest=null,
t.hittest&&((T=t.hittest.result())===d.HitTestResult.MOVEPOINT||T===d.HitTestResult.MOVEPOINT_BACKGROUND&&(0,a.lastEventIsTouch)())){if(this._tryStartCloning(e,t,S,i))return;if(this._tryStartMovingLineTool(e,t,S,C))return void(this._currentMovingHitTest=t);this._currentMovingHitTest=null}}if(t.source&&t.source instanceof k.PriceDataSource&&t.source.isDraggable()&&this._paneWidgetsSharedState.trySetDraggingSource(t.source,this))return}var T;t&&t.hittest&&t.hittest.result()===d.HitTestResult.REGULAR||(this._processing=!0)}}_mouseUpOrTouchEndEvent(e){var t,i;if(!this.hasState())return;const r=e.isTouch&&null!==this._startTrackPoint,n=e.isTouch&&this._wasPinched;e.isTouch&&(this._wasPinched=!1,this._longTap=!1),this._startMoveSourceParams=null,this._startChangeLineToolParams=null,this._currentChangingLineToolHitTest=null,this._currentMovingHitTest=null;const o=this._chartUndoModel(),c=o.model().customSourceMovingHitTestData();null!==c||o.customMoveBeingProcessed()||this._processMouseUpOrTouchEndHandler(e),this._isSelecting=!1;const u=o.model(),h=u.crossHairSource(),_=this._dataSourceAtPoint(e.localX,e.localY),m=null==_?void 0:_.hittest;if(h.selection()&&null===this._firstZoomPoint){const e=this.state().lineToolsForArea(h.selection());o.selectionMacro(t=>{let i=null;e.forEach(e=>{null===i&&(i=ae(_,e)),t.addSourceToSelection(e,i)})}),h.clearSelection(),(0,z.trackEvent)("GUI","Multiselect","Area Select")}(0,l.emit)("mouse_up",{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY});const v=e.isTouch&&this._touchMove;e.isTouch&&(this._touchMove=!1);const S=new p.EnvironmentState(e),y=g.tool.value();if(e.isTouch&&!v&&((0,g.toolIsMeasure)(y)||null!==h.measurePane())){if(null===h.measurePane()&&h.pane!==this._state)return void this._setCursorPosition(e.localX,e.localY);if(this._tryStartMeasure(e,h,S,h.price,h.index))return;if(this._tryFinishMeasure(e,h))return}if(e.isTouch&&!v&&!(0,B.isLineDrawnWithPressedButton)(y)&&(0,f.isLineToolName)(y)&&!o.lineBeingCreated()){if(this._chart.justActivated())return;if(h.pane!==this._state)return void this._setCursorPosition(e.localX,e.localY,S);const i=h.currentPoint(),r=this.state().defaultPriceScale(),n=(0,s.ensure)(null===(t=this.state().mainDataSource())||void 0===t?void 0:t.firstValue()),a={index:Math.round(o.timeScale().coordinateToIndex(i.x)),price:r.coordinateToPrice(i.y,n)},l=(0,s.ensureNotNull)(o.createLineTool(this.state(),a,y));return o.selectionMacro(e=>{e.addSourceToSelection(l)}),o.lineBeingCreated()||(this._finishTool(l,_),e.preventDefault()),void(this._startTouchPoint=null)}const b=o.lineBeingCreated();if(b&&!(0,B.isLineDrawnWithPressedButton)(b.toolname)&&e.isTouch&&this._startTouchPoint){if(this._startTouchPoint=null,!v){const t=b.points()[b.points().length-1],i=o.continueCreatingLine({index:t.index,price:t.price},new p.EnvironmentState(e));this._initCrossHairPosition=null,i&&(this._finishTool(b,_),e.preventDefault())}return}if(null!==this._firstZoomPoint&&this._firstZoomPoint.draggingMode)return void this._finishZoom(e)
;if(this._processing=!1,o.customMoveBeingProcessed())return void o.endCustomMoving();if(null!==c)return c.beingMoved&&((0,d.tryCallHandler)(e,c.mouseUpHandler,c.touchEndHandler),this.setCursorForTool()),void u.setMovingCustomSource(null,null);if(u.lineBeingEdited())return o.endChangingLinetool(!1),void(this._preventCrossHairMove()&&this._clearCursorPosition());if((0,B.isLineDrawnWithPressedButton)(y)&&!this._isSelectPointModeEnabled()){const t=o.lineBeingCreated();null!==t&&((0,V.trackDrawingCreated)(t),t.finish());const r=this.state().defaultPriceScale();if(r.isEmpty())return;if(!t)return;const n=(0,s.ensure)(null===(i=t.ownerSource())||void 0===i?void 0:i.firstValue()),a=r.coordinateToPrice(e.localY,n),l={index:Math.round(o.timeScale().coordinateToIndex(e.localX)),price:a};return void o.continueCreatingLine(l)}if(u.sourcesBeingMoved().length)return o.endMovingSource(!1),u.sourcesBeingMoved().filter(f.isLineTool).forEach(e=>{this.setCursorForTool(e)}),void u.invalidate(X.InvalidationMask.cursor());if(!this._chart.readOnly()){const t=e.localX>=0&&e.localX<this._size.w;if((!_||_.source!==h)&&t){const t=o.timeScale().coordinateToIndex(e.localX);u.onSyncScrollNeeded(t)}}const w=this._isScrolling,P=this._endScroll(e),C=this._paneWidgetsSharedState.draggingSource();if(null!==C){const t=e.target,i=this._chart.paneByCanvas(t);i&&i!==this&&(P&&o.undoHistory().undo(),o.mergeToPane(C,i.state()));if(this._chart.timeAxisByCanvas(t))if(u.isUnmergeAvailableForSource(C))P&&o.undoHistory().undo(),o.unmergeToNewBottomPane(C);else{const e=u.panes(),t=(0,s.ensureNotNull)(u.paneForSource(C)),i=e.indexOf(t);i!==e.length-1&&(P&&o.undoHistory().undo(),t.isMaximized()&&this._chart.toggleMaximizePane(),o.movePane(i,e.length-1))}this._paneWidgetsSharedState.clearDraggingSource();const r=this._chart.getTimeScale();r&&r.restoreDefaultCursor();const n=this._chart.paneWidgets();for(let e=0;e<n.length;e++){const t=n[e];t===this&&_&&!_.isCustom?t.setCursorForTool(_.source||void 0):t.setCursorForTool(),t.leftPriceAxisesContainer().restoreDefaultCursor(),t.rightPriceAxisesContainer().restoreDefaultCursor()}}this._chart.readOnly()||r||S.control()||w||n||null!==this._lastFinishedToolId||_&&_.source&&(m&&m.result()>d.HitTestResult.MOVEPOINT_BACKGROUND||(0,a.lastEventIsTouch)())&&o.selectionMacro(e=>{e.clearSelection();const t=(0,s.ensureNotNull)(_.source);e.addSourceToSelection(t,ae(_,t))}),e.isTouch&&(this._touchMove=!1)}_mouseOrTouchMoveEvent(e){if(!this.hasState())return;this._resetMeasureIfRequired();const t=(0,s.ensureNotNull)(this._dataSourceAtPoint(e.localX,e.localY));this._processMouseEnterLeaveMoveHandlers(t,e);const i=this._chartUndoModel();if(!i)return;const r=e.localX,o=e.localY;this._prevMoveEventPosition=new n.Point(r,o);const a=new p.EnvironmentState(e);if(null===this._firstZoomPoint){if(this._updateHoveredSource(t,a,e),!e.isTouch&&i.lineBeingCreated()){const e=i.lineBeingCreated(),t=null===e?null:i.model().paneForSource(e);if(null!==t&&t!==this._state)return void this._setCursorPositionOnExternalPane(t,r,o,a)}
e.isTouch||this._setCursorPosition(r,o,a)}else this._processMouseMoveWhileZoom(e,a)}_pressedMouseOrTouchMoveEvent(e){var t;if(!this.hasState()||this._pinching||e.isTouch&&this._contextMenuOpenedOnLastTap)return;this._resetMeasureIfRequired(),this._startChangeOrMoveLineToolIfNeeded(),e.isTouch&&(this._touchMove=!0,this._preventSourceChange=!1);const i=new p.EnvironmentState(e),r=this._chartUndoModel(),o=r.crossHairSource(),a=e.localX,l=e.localY;if(this._prevMoveEventPosition=new n.Point(a,l),null!==this._firstZoomPoint)return this._processMouseMoveWhileZoom(e),void(this._firstZoomPoint.draggingMode=!0);const c=g.tool.value();if(e.isTouch&&this._startTouchPoint&&(0,f.isLineToolName)(c)&&!(0,B.isLineDrawnWithPressedButton)(c)&&!r.lineBeingCreated()&&!this._isSelectPointModeEnabled())return void this._updateCrosshairPositionInToolCreationMode(e,this.state());const u=o.measurePane();if(e.isTouch&&this._startTouchPoint&&((0,g.toolIsMeasure)(c)||null!==u))return void this._updateCrosshairPositionInToolCreationMode(e,u||this.state());const h=r.lineBeingCreated();if(e.isTouch&&h&&!(0,B.isLineDrawnWithPressedButton)(h.toolname)){if(this._startTouchPoint){const t=(0,s.ensureNotNull)(r.lineBeingCreated()),i=(0,s.ensureNotNull)(r.model().paneForSource(t));this._updateCrosshairPositionInToolCreationMode(e,i)}return}if(e.isTouch&&null!==this._startTrackPoint){this._exitTrackingModeOnNextTry=!1;const e=(0,s.ensureNotNull)(this._initCrossHairPosition),t=new n.Point(a,l).subtract(this._startTrackPoint),r=e.add(t);this._setCursorPosition(r.x,r.y,i)}else e.isTouch&&this._preventCrossHairMove()||this._setCursorPosition(a,l,i);const _=this._isSelectPointModeEnabled();if((0,f.isLineToolName)(c)&&!(0,B.isLineDrawnWithPressedButton)(c)&&!_&&!i.control())return;if((0,B.isLineDrawnWithPressedButton)(c)&&!_){const i=this.state().defaultPriceScale();if(i.isEmpty())return;const o=r.lineBeingCreated();if(!o)return;const a=new n.Point(e.localX,e.localY),l=(0,s.ensure)(null===(t=o.ownerSource())||void 0===t?void 0:t.firstValue());return a.price=i.coordinateToPrice(e.localY,l),a.index=Math.round(r.timeScale().coordinateToIndex(e.localX)),void r.continueCreatingLine(a)}if(null!==this._paneWidgetsSharedState.draggingSource()){const t=e.target,i=this._chart.paneByCanvas(t);i&&(i!==this?i.setDragToAnotherPaneCursor():i.setCursorForTool());const r=this._chart.timeAxisByCanvas(t);r&&r.setCursor("grabbing")}if(r.timeScale().isEmpty())return;const m=this._options.handleScroll;if((!m.pressedMouseMove||e.isTouch)&&(!m.horzTouchDrag&&!m.vertTouchDrag||!e.isTouch))return;if(r.customMoveBeingProcessed())return void r.processCustomMove(e);const v=r.model().customSourceMovingHitTestData();if(null!==v&&(this._updateCommonTooltip(null,!0),r.model().processingCustomSourceMove(),(0,d.tryCallHandler)(e,v.pressedMouseMoveHandler,v.touchMoveHandler),!(0,d.shouldDefaultActionBeExecuted)(e,v,"pressedMouseMoveHandler","touchMoveHandler")))return;if(r.model().lineBeingEdited())return void this._setCursorPosition(a,l,i)
;if(r.model().sourcesBeingMoved().length)return void this._alignSourcesThatBeingMoved(r.model().sourcesBeingMoved(),e.localX,e.localY,i);const S=this._dataSourceAtPoint(e.localX,e.localY);if(this._tryFinishClonning(e,new p.EnvironmentState(e),S))return;const y=(0,g.toolIsMeasure)(c)||o.startMeasurePoint()&&o.endMeasurePoint();this._chart.readOnly()||!i.control()||(0,f.isLineToolName)(c)||y||_?(this._processScroll(e),this._preventScroll()&&!this._preventCrossHairMove()&&null===this._startTrackPoint&&this._setCursorPosition(e.localX,e.localY,new p.EnvironmentState(e))):this._isSelecting||(o.startSelection(this.state()),this._isSelecting=!0)}_mouseOrTouchLeaveEvent(e){var t,i;if(!this.hasState())return;const r=this._chartUndoModel();if(!r)return;const s=r.crossHairSource();e.isTouch||null!==s.measurePane()&&null===s.endMeasurePoint()||this._clearCursorPosition(),r.model().setHoveredSource(null,null),null!==this._prevHoveredHittest&&((0,d.tryCallHandler)(e,null===(i=null===(t=this._prevHoveredHittest.hittest)||void 0===t?void 0:t.data())||void 0===i?void 0:i.mouseLeaveHandler),this._prevHoveredHittest=null),this._updateCommonTooltip(null),this._chart.unsetActivePaneWidget()}_mouseDoubleClickOrDoubleTapEvent(e){var t;if(!this.hasState())return;const i=!this._chart.readOnly()&&!(0,f.isLineToolName)(g.tool.value())&&(0,s.ensureNotNull)(this._dataSourceAtPoint(e.localX,e.localY))||null;if(null===i)return;if(i.isCustom)return void(null===(t=i.hittest)||void 0===t||t.tryCallDblClickOrDblTapHandler(e));let r=i.hittest&&i.source||null;r&&i.hittest&&i.hittest.result()<=d.HitTestResult.MOVEPOINT_BACKGROUND&&!e.isTouch&&(r=null),r&&!r.isSelectionEnabled()&&(r=null),r?this.processDoubleClickOnSource(r,i.hittest?i.hittest:void 0):this._chart.readOnly()||(0,f.isLineToolName)(g.tool.value())||this._chartUndoModel().lineBeingCreated()||!this._chartUndoModel().selection().isEmpty()||this._chart.toggleMaximizePane(this)}_contextMenuEvent(e){var t;const i=this._chartUndoModel();if(i.crossHairSource().startMeasurePoint()&&!this._trackCrosshairOnlyAfterLongTap)return i.crossHairSource().clearMeasure(),void(0,g.resetToCursor)(!0);if(this._pinching)return;if(null===this._firstZoomPoint||this._trackCrosshairOnlyAfterLongTap||this.cancelZoom(),this.hideInplaceEditor())return;if(!(0,g.toolIsCursor)(g.tool.value())||this._isSelectPointModeEnabled()){if(e.isTouch)return;return(0,g.resetToCursor)(!0),this.setCursorForTool(),void(i.lineBeingCreated()&&i.cancelCreatingLine())}if(!this._options.contextMenuEnabled)return;const r=this._dataSourceAtPoint(e.localX,e.localY),s=r?r.source:null;if(e.isTouch&&null!==this._startTrackPoint){if(this._preventSourceChange)return;this._clearCursorPosition()}e.isTouch&&(this._contextMenuOpenedOnLastTap=!0,this._startTrackPoint=null),this._contextMenuX=e.localX,this._contextMenuY=e.localY;const n=r&&r.hittest?r.hittest.result():0,o=n>=d.HitTestResult.REGULAR||n>=d.HitTestResult.MOVEPOINT_BACKGROUND&&e.isTouch;this._chart.updateActions(),i.selectionMacro(t=>{null!==s&&o?t.selection().isSelected(s)||(t.clearSelection(),
t.addSourceToSelection(s,ae(r,s))):(this._options.contextMenu.general&&this._contextMenu(e).then(t=>{t.show(e)}),t.clearSelection())}),r&&o&&null!==s&&((0,m.isDataSource)(s)&&s.hasContextMenu()?s.isSelectionEnabled()?this.showContextMenuForSelection(e):this.showContextMenuForSources([s],e):null===(t=r.hittest)||void 0===t||t.tryCallContextMenuHandler(e))}_onMouseEvent(){this._preventSourceChange=!1,this._startTrackPoint=null,this._trackCrosshairOnlyAfterLongTap=!1}_onTouchEvent(){this._trackCrosshairOnlyAfterLongTap=!0}_switchTrackingModeFromAnotherPaneIfNeeded(e){const t=this._chart.trackingModePaneWidget();if(null!==t&&t!==this){const i=this._chartModel().crossHairSource().currentPoint();t._exitTrackingModeOnNextTry=!0,t._tryExitTrackingMode(!0),this.startTrackingMode(new n.Point(e.localX,e.localY),new n.Point(i.x,e.localY),new p.EnvironmentState(e))}}_contextMenu(e){const t=e=>e instanceof j.Separator,i=this._customActions(),r=this._initActions(e).filter(e=>null!==e);i.remove.forEach(e=>{for(let t=0;t<r.length;t++){const i=r[t];if(i instanceof j.Action&&i.getLabel()===e){r.splice(t,1);break}}});const s=i.top.concat(r).concat(i.bottom);for(let e=s.length-1;e>0;e--)t(s[e])&&t(s[e-1])&&s.splice(e,1);return s.length&&t(s[0])&&s.splice(0,1),s.length&&t(s[s.length-1])&&s.splice(s.length-1,1),A.ContextMenuManager.createMenu(s,{statName:"ChartContextMenu"})}_initActions(e){var t,i;const n=this._chart.actions(),o=[];if(o.push(n.chartReset),o.push(new j.Separator),W.enabled("datasource_copypaste")&&!this.state().isEmpty()&&(o.push(new j.Action({label:(0,r.t)("Paste %s").replace("%s","").trim(),shortcutHint:(0,q.humanReadableHash)(q.Modifiers.Mod+86),statName:"Paste",onExecute:()=>this._chart.chartWidgetCollection().clipboard.uiRequestPaste(this.state())})),o.push(new j.Separator)),W.enabled("alerts")&&(o.length&&o.push(new j.Separator),(0,s.ensureNotNull)(this.state().mainDataSource()).alertCreationAvailable())){const t=(0,E.createActionAddAlert)(this._chart,{e,pane:this.state()});null!==t&&o.push(t)}this._options.contextMenu.mainSeriesTrade&&this.containsMainSeries()&&o.push((0,E.createActionTrade)(this._chart,this.state(),e)),o[o.length-1]instanceof j.Separator||o.push(new j.Separator);return Boolean(null===(t=window.widgetbar)||void 0===t?void 0:t.widget("watchlist"))&&n.addToWatchlist&&o.push(n.addToWatchlist),W.enabled("text_notes")&&o.push(n.addToTextNotes),o[o.length-1]instanceof j.Separator||o.push(new j.Separator),n.moveChartAction&&!n.moveChartAction.isDisabled()&&o.push(n.moveChartAction,new j.Separator),o.push(this._createLockTimeAxisAction(e)),o.push(new j.Separator),n.paneObjectTree&&o.push(n.paneObjectTree),o.push((0,E.createLinesAction)(this._chart)),W.enabled("charting_library_base")||o.push(n.applyColorTheme),o[o.length-1]instanceof j.Separator||o.push(new j.Separator),this._chart.applyIndicatorsToAllChartsAvailable()&&(o.push(n.applyStudiesToAllCharts),o.push(new j.Separator)),o.push(n.paneRemoveAllDrawingTools),o.push(n.paneRemoveAllStudies),o.push(new j.Separator),
(null===(i=window.pro)||void 0===i?void 0:i.hasPackage("mtp-mtpredictor"))&&this.state().containsMainSeries()&&o.push((0,E.createMTPredictorActions)(this._chart,this.state(),this._contextMenuX,this._contextMenuY),new j.Separator),W.enabled("show_chart_property_page")&&o.push(n.chartProperties),o[o.length-1]instanceof j.Separator&&o.pop(),o}_loadAndCreateLegendWidget(){Promise.all([i.e(23876),i.e(43894),i.e(60700),i.e(47607),i.e(30209),i.e(20597),i.e(18078),i.e(89189),i.e(73935),i.e(1529),i.e(38676),i.e(52146),i.e(807),i.e(33289),i.e(25155),i.e(5093)]).then(i.bind(i,19324)).then(e=>{if(this._isDestroyed)return;const t=e.LegendWidget,i=(0,u.deepExtend)({},this._options.legendWidget);i.canShowSourceCode=!this._chart.onWidget()&&!o.CheckMobile.any(),i.readOnlyMode=i.readOnlyMode||this._chart.readOnly(),i.statusesWidgets={sourceStatusesEnabled:this._options.sourceStatusesWidgetEnabled,sourceStatuses:this._options.sourceStatusesWidget||{},marketStatusEnabled:this._options.marketStatusWidgetEnabled,dataUpdateModeEnabled:this._options.chartWarningWidgetEnabled,dataUpdateMode:this._options.chartWarningWidget||{},dataProblemEnabled:this._options.dataProblemWidgetEnabled};const r=new(x())(this._getHideNotMainSourcesValue());this._hideNotMainSourcesInLegendSpawn=(0,I.combine)(()=>({}),this._chart.chartWidgetCollection().activeChartWidget,this._chart.chartWidgetCollection().lock.crosshair),this._hideNotMainSourcesInLegendSpawn.subscribe(()=>{r.setValue(this._getHideNotMainSourcesValue())}),this._hideWholeLegend=new(x())(!1),g.tool.subscribe(this._recalculateLegendVisibility),this._chartModel().crossHairSource().measuringEnabled().subscribe(this,this._recalculateLegendVisibility),this._legendWidget=new t(this._chartUndoModel(),this,this._chart.backgroundTopTheme(),r,this._hideWholeLegend,i,{showContextMenuForSelection:this.showContextMenuForSelection.bind(this),showContextMenuForSources:this.showContextMenuForSources.bind(this),updateActions:this._chart.updateActions.bind(this._chart),showChartPropertiesForSource:this._chart.showChartPropertiesForSource.bind(this._chart),showGeneralChartProperties:this._chart.showGeneralChartProperties.bind(this._chart),showObjectsTreeDialog:this._chart.showObjectsTreeDialog.bind(this._chart)}),this._div.appendChild(this._legendWidget.getElement()),this._legendWidget.updateLayout(),this._legendWidget.updateWidgetModeBySize(this._size),this._legendWidget.updateThemedColors(this._themedTopColor);for(const e of Array.from(this._customLegendWidgetsFactoryMap.keys()))this._legendWidget.addCustomWidgetToLegend(e,(0,s.ensureDefined)(this._customLegendWidgetsFactoryMap.get(e)))})}_loadAndCreatePaneControlsWidget(){
Promise.all([Promise.all([i.e(23876),i.e(43894),i.e(60700),i.e(47607),i.e(30209),i.e(20597),i.e(18078),i.e(89189),i.e(73935),i.e(1529),i.e(38676),i.e(52146),i.e(807),i.e(33289),i.e(25155),i.e(5093)]).then(i.bind(i,93527)),Promise.all([i.e(23876),i.e(43894),i.e(60700),i.e(47607),i.e(30209),i.e(20597),i.e(18078),i.e(89189),i.e(73935),i.e(1529),i.e(38676),i.e(52146),i.e(807),i.e(33289),i.e(25155),i.e(5093)]).then(i.bind(i,1529))]).then(([e,t])=>{if(this._isDestroyed)return;const i=e.PaneControlsWidget;this._paneControls=new i(this._chartUndoModel(),this,{backgroundThemeName:this._chart.backgroundTopTheme()},{toggleMaximizePane:this._chart.toggleMaximizePane.bind(this._chart)},this._div),this._paneControls.updateWidgetModeByWidth(this._size.w),this._paneControls.updateThemedColors(this._themedTopColor),this._paneControlsResizeObserver=new t.default(this._handleRestrictLegendWidth.bind(this)),this._paneControlsResizeObserver.observe(this._paneControls.getElement())})}_handleRestrictLegendWidth(e){if(null===this._legendWidget||null===this._paneControls)return;const t=e[e.length-1].contentRect.width,i=0===t?0:t+Z+Q;this._legendWidget.addMargin(i)}_onMagnetStateChanged(){this._chart.isActive()&&(this._isSelectPointModeEnabled()||this._isToolActionActiveOnPane(!0))&&this._chartModel().crossHairSource().visible&&this._updateLineToolUsingMagnetOrShift()}_onShiftKeyStateChanged(){this._chart.isActive()&&this._isToolActionActiveOnPane(!1)&&this._chartModel().crossHairSource().visible&&this._updateLineToolUsingMagnetOrShift(p.EnvironmentState.create((0,$.shiftPressed)().value()))}_isToolActionActiveOnPane(e){const t=this._chartModel(),i=t.lineBeingCreated()||t.lineBeingEdited()||t.sourcesBeingMoved().length>0&&t.sourcesBeingMoved()[0];return i?t.paneForSource(i)===this._state:e&&(0,f.isLineToolName)(g.tool.value())&&t.crossHairSource().pane===this._state}_updateLineToolUsingMagnetOrShift(e){if(null===this._prevMoveEventPosition)return;const{x:t,y:i}=this._prevMoveEventPosition,r=this._chartModel().sourcesBeingMoved();r.length>0?(g.isStudyEditingNow.value()&&this._setCursorPosition(t,i,e),this._alignSourcesThatBeingMoved(r,t,i,e)):this._setCursorPosition(t,i,e)}_showEditDialogForSource(e,t){if(this._options.propertyPagesEnabled&&e.userEditEnabled())if(e===this._chartUndoModel().mainSeries())this._chart.showGeneralChartProperties(F.TabNames.symbol);else if((0,f.isLineTool)(e)||(0,_.isStudy)(e)){let i;const r=null==t?void 0:t.data();if(null!=r){const e=r.areaName;void 0!==e&&(i=ue.get(e))}this._chart.showChartPropertiesForSource(e,i).then(e=>{this._editDialog=e})}}_initToolCreationModeParams(e){this._startTouchPoint=new n.Point(e.pageX,e.pageY),this._initCrossHairPosition=this._chartModel().crossHairSource().currentPoint()}_updateCrosshairPositionInToolCreationMode(e,t){if(t!==this._state){const i=this._chart.paneByState(t);return i._startTouchPoint=this._startTouchPoint,i._initCrossHairPosition=this._initCrossHairPosition,void i._updateCrosshairPositionInToolCreationMode(e,t)}const i=this._chartModel().crossHairSource()
;this._chart.justActivated()&&(this._initCrossHairPosition=i.currentPoint());const r=e.pageX,o=e.pageY,a=(0,s.ensureNotNull)(this._initCrossHairPosition),l=new n.Point(r,o).subtract((0,s.ensureNotNull)(this._startTouchPoint)),c=a.add(l);this._setCursorPosition(c.x,c.y,new p.EnvironmentState(e))}_priceAxisesContainer(e){return"left"===e?this._lhsPriceAxisesContainer:this._rhsPriceAxisesContainer}_recalculatePriceScales(){const e=this.state();for(const t of e.leftPriceScales())e.recalculatePriceScale(t);for(const t of e.rightPriceScales())e.recalculatePriceScale(t);for(const t of e.sourcesByGroup().overlayPriceScaleSources())(0,f.isLineTool)(t)||e.recalculatePriceScale(t.priceScale())}_createLockTimeAxisAction(e){const t=(0,g.lockTimeAxis)().value();return new j.Action({label:(0,r.t)("Lock Vertical Line On Time Axis"),statName:"LockCursorInTime",checkable:!0,checked:t,onExecute:()=>this._toggleLockTimeAxis(e.localX,!t)})}_toggleLockTimeAxis(e,t){if(t){const t=this._chartUndoModel().timeScale(),i=t.coordinateToIndex(e),r=t.points().roughTime(i);null!==r&&g.lockTimeAxisTime.setValue(r)}(0,g.lockTimeAxis)().setValue(t)}_preventTouchEventsExceptPinch(){return this._paneWidgetsSharedState.hasTouchesOnOtherPanes(this)||null!==this._paneWidgetsSharedState.pinchingPane()}_updateHoveredSource(e,t,i){var r,s,n;const o=this._chartUndoModel(),a=o.model();let l=!1;const c=e&&e.source,u=this._chart.readOnly();if(u&&!(0,f.isLineTool)(e.source)||this._editDialog&&this._editDialog.visible().value())u&&(a.setHoveredSource(null,null),this.setCursorForTool());else{const h=g.tool.value();let p=null;if(!this._processing&&((0,g.toolIsCursor)(h)||"eraser"===h&&!u||t.control()||!o.lineBeingCreated())){const{hittest:t}=e;l=Boolean(null===(r=null==t?void 0:t.data())||void 0===r?void 0:r.hideCrosshairLinesOnHover),t&&t.result()>d.HitTestResult.MOVEPOINT_BACKGROUND?(p=c,!(null==c?void 0:c.isHoveredEnabled())||"eraser"===h&&c===o.mainSeries()?a.setHoveredSource(null,null):a.setHoveredSource(c,null==t?void 0:t.data())):a.setHoveredSource(null,null)}u?this.setCursorForTool(p,t,U.PaneCursorType.Default):this._options.sourceSelectionEnabled&&(this._isSelectPointModeEnabled()?this._setCursorClassName("pointer"):this.setCursorForTool(p,t,null===(n=null===(s=null==e?void 0:e.hittest)||void 0===s?void 0:s.data())||void 0===n?void 0:n.cursorType));const _=a.customSourceBeingMoved(),m=null!==_?[_]:a.sourcesBeingMoved(),f=e.source;if((!m.length||null!==f&&-1===m.indexOf(f))&&this._updateCommonTooltip(e),!u&&null!==e.hittest&&i&&e.hittest.hasPressedMoveHandler(i)){switch((e.hittest.data()||{}).cursorType){case U.PaneCursorType.VerticalResize:this._setCursorClassName("ns-resize");break;case U.PaneCursorType.HorizontalResize:this._setCursorClassName("we-resize");break;case U.PaneCursorType.DiagonalNeSwResize:this._setCursorClassName("nesw-resize");break;case U.PaneCursorType.DiagonalNwSeResize:this._setCursorClassName("nwse-resize")}}}this._preventCrossHairMove()&&this._clearCursorPosition(),a.crossHairSource().setLinesShouldBeHidden(l)}}},1658:(e,t,i)=>{
"use strict";var r=i(65066),s=i(22842);i(93801),i(20220);var n=i(28132).PaneWidgetBase,o=i(88118).scaleRatioForContextMenuTransformer(7),a=i(26377).ActionBinder,l=i(54281),c=l.Action,u=l.Separator,d=i(14397),h=i(88001),p=i(10595).MouseEventHandler;e.exports.PaneWidget=class extends n{constructor(e,t,i,s){super(e,t||null,i,s),this.setCursorForTool(),this._mouseEventHandler=new p(this._topCanvasBinding.canvas,this,{treatVertTouchDragAsPageScroll:!this._options.handleScroll.vertTouchDrag,treatHorzTouchDragAsPageScroll:!this._options.handleScroll.horzTouchDrag}),this.actions=[],this.readonlyActions=[],this._prevHoveredHittest=null,this._chart.withModel(this,(function(){var e=this._chartUndoModel();e.onSimpleZoomIn().subscribe(this,this._updateCrosshairOnZoom),e.onSimpleZoomOut().subscribe(this,this._updateCrosshairOnZoom)})),this._highlightedPriceAxis=new r({owner:"",axis:null}),this._highlightedPriceAxis.subscribe(function(e){this._highlightPriceAxisByLabel(e.axis)}.bind(this)),this._prevPinchScale=0,this._isDestroyed=!1}destroy(){for(var e in super.destroy(),this._prevHoveredHittest=null,this._mouseEventHandler.destroy(),this._rowElement.parentElement.removeChild(this._rowElement),this)delete this[e];this._isDestroyed=!0}_highlightPriceAxisByLabel(e){this._lhsPriceAxisesContainer.highlightPriceAxisByLabel(e),this._rhsPriceAxisesContainer.highlightPriceAxisByLabel(e)}chart(){return this._chart}stretchFactor(){return this._state?this._state._stretchFactor:0}setStretchFactor(e){this.hasState()&&(this._state._stretchFactor=e)}hideInplaceEditor(){return!!this._inplaceEditor&&(this._inplaceEditor.remove(),this._inplaceEditor=void 0,!0)}createRemoveMenu(){var e=this._chart.actions();return new c({label:window.t("Remove"),statName:"Remove",subItems:[e.paneRemoveAllStudies,e.paneRemoveAllDrawingTools,e.paneRemoveAllStudiesDrawingTools]})}_customActions(){var e={top:[],bottom:[],remove:[]},t=this._chartUndoModel().timeScale(),i=this._state&&this._state.defaultPriceScale();if(!s.enabled("custom_items_in_context_menu"))return e;var r,n=t.isEmpty()?void 0:t.indexToUserTime(t.coordinateToIndex(this._contextMenuX));if(i&&!i.isEmpty()){var o=this._state.mainDataSource().firstValue();r=i.coordinateToPrice(this._contextMenuY,o)}return h.emit("onContextMenu",{unixtime:n?n/1e3:void 0,price:r,callback:function(t){[].concat(t).forEach((function(t){var i;t.text&&(t.text.length>1&&"-"===t.text[0]?e.remove.push(t.text.slice(1)):(i="-"===t.text?new u:new c({label:t.text,onExecute:t.click}),t.position&&"top"===t.position?e.top.push(i):e.bottom.push(i)))}))}}),e}update(){this._lhsPriceAxisesContainer.update(),this._rhsPriceAxisesContainer.update(),null!==this._legendWidget&&this._legendWidget.update(),this.updateControls()}createActionLockScale(e){if(!(e instanceof TradingView.Series))return null;var t=o(e.priceScale(),this._chartUndoModel().model().mainSeriesScaleRatio()),i=new c({checkable:e.priceScale().isLockScale(),label:window.t("Lock Scale")+" "+t,statName:"LockScale"})
;return i._binding=new a(i,e.priceScale().properties().lockScale,this._chartUndoModel(),"Lock Scale",(function(){var t={lockScale:this.value()};this._undoModel.setPriceScaleMode(t,e.priceScale(),this._undoText)})),i}_updateCrosshairOnZoom(){if(d.lockTimeAxis().value()){var e=this._chartUndoModel().crossHairSource();e.setPosition(e.index,e.price,this.state())}}highlightedPriceAxis(){return this._highlightedPriceAxis}}},11575:(e,t,i)=>{"use strict";i.d(t,{PriceAxisWidgetBase:()=>I});var r=i(16282),s=i(20220),n=i(34698),o=i(10595),a=i(94420),l=i(14900),c=i(31565),u=i(99438),d=i(8412),h=i(54567),p=i(32022),_=i(29098),m=i(39304),f=i(61581),g=i(64348),v=i(84162),S=i(5195),y=i(28429);class b{constructor(){this._width=null,this._currencyInfo=null,this._unitInfo=null,this._fontSize=0,this._currencyAndUnitLabelsWrapper=document.createElement("div"),this._currencyAndUnitLabelsWrapper.className=y["price-axis-currency-label-wrapper"],this._controlsContainer=document.createElement("table"),this._controlsContainer.className=y["price-axis-currency-label"],this._currencyAndUnitLabelsWrapper.appendChild(this._controlsContainer),this._currencyLabelTr=document.createElement("tr"),this._currencyLabelTr.className=y["price-axis-currency-label-dropdown"],this._currencyLabelTr.classList.add("apply-common-tooltip"),(0,f.setTooltipData)(this._currencyLabelTr,"text",e=>this._currencyTooltipContent());const e=document.createElement("td");this._currencyText=document.createElement("span"),this._currencyText.className=y["price-axis-currency-label-text"],e.appendChild(this._currencyText),this._currencyLabelTr.appendChild(e);const t=document.createElement("td");this._currencyArrowDown=document.createElement("span"),this._currencyArrowDown.className=y["price-axis-currency-label-arrow-down"],this._currencyArrowDown.innerHTML=S,t.appendChild(this._currencyArrowDown),this._currencyLabelTr.appendChild(t),this._unitLabelTr=document.createElement("tr"),this._unitLabelTr.className=y["price-axis-currency-label-dropdown"],this._unitLabelTr.classList.add("apply-common-tooltip"),(0,f.setTooltipData)(this._unitLabelTr,"text",e=>this._unitTooltipContent());const i=document.createElement("td");this._unitText=document.createElement("span"),this._unitText.className=y["price-axis-currency-label-text"],i.appendChild(this._unitText),this._unitLabelTr.appendChild(i);const r=document.createElement("td");this._unitArrowDown=document.createElement("span"),this._unitArrowDown.className=y["price-axis-currency-label-arrow-down"],this._unitArrowDown.innerHTML=S,r.appendChild(this._unitArrowDown),this._unitLabelTr.appendChild(r),this._controlsContainer.appendChild(this._currencyLabelTr),this._controlsContainer.appendChild(this._unitLabelTr),this.hideCurrency(),this.hideUnit()}element(){return this._currencyAndUnitLabelsWrapper}currencyLabelElement(){return this._currencyLabelTr}unitLabelElement(){return this._unitLabelTr}isVisible(){return this.currencyLabelVisible()||this.unitLabelVisible()}width(){if(null!==this._width)return this._width;let e=0
;if(this.currencyLabelVisible()){const t=this._currencyLabelTr.getBoundingClientRect();e=Math.max(e,t.right-t.left+1+8)}if(this.unitLabelVisible()){const t=this._unitLabelTr.getBoundingClientRect();e=Math.max(e,t.right-t.left+1+8)}return this._width=e,e}drawLabel(e,t,i,r){if(!this.isVisible())return;const s=this.currencyLabelVisible()?this._currencyText.textContent||"":this._unitText.textContent||"",n=this._unitText.textContent||"";e.font=(0,p.makeFont)(this._fontSize,m.CHART_FONT_FAMILY);const o=new h.TextWidthCache,a=2*Number(y.css_value_currency_label_text_horizontal_padding)+Math.max(o.measureText(e,s),o.measureText(e,n)),c=o.yMidCorrection(e,s),u=o.yMidCorrection(e,n),d=Math.round(t/2*i),_=(0,v.ceiledEven)(a*i/2),f=this._controlsContainer.style,S=Math.round(this.labelTop()*i),b=Math.round(this.labelBottom()*i),w=b-S,P=Math.round(Number(y.css_value_currency_label_radius)*i);(0,g.drawRoundRect)(e,d-_,S,2*_,w,P),e.fillStyle=f.backgroundColor,e.fill();const C=Math.max(1,Math.floor(i));e.lineWidth=C,e.strokeStyle=r?y.css_value_border_color_dark:y.css_value_border_color_light,(0,g.drawRoundRect)(e,d-_+C/2,S+C/2,2*_-C,w-C,P),e.stroke();const T=S+(b-S-1)/2,x=this._isMultiLine();x&&(0,g.drawHorizontalLine)(e,Math.floor(T+C/2),d-_,d+_);const I=this._oneLineHeight()/2*i,L=x?Math.ceil(T-I):T,M=Math.ceil(T+I);e.fillStyle=f.color,e.textBaseline="middle",e.textAlign="center",(0,l.drawScaled)(e,i,()=>e.fillText(s,d/i,(L+c)/i)),x&&(0,l.drawScaled)(e,i,()=>e.fillText(n,d/i,(M+u)/i))}showCurrency(){this._currencyLabelTr.classList.remove("js-hidden"),this._width=null,this._updateMultiLine(),this._updateVisibility()}hideCurrency(){this._currencyLabelTr.classList.add("js-hidden"),this._width=null,this._updateMultiLine(),this._updateVisibility()}showUnit(){this._unitLabelTr.classList.remove("js-hidden"),this._width=null,this._updateMultiLine(),this._updateVisibility()}hideUnit(){this._unitLabelTr.classList.add("js-hidden"),this._width=null,this._updateMultiLine(),this._updateVisibility()}currencyLabelVisible(){return!this._currencyLabelTr.classList.contains("js-hidden")}unitLabelVisible(){return!this._unitLabelTr.classList.contains("js-hidden")}setCurrencyInfo(e){if(this._currencyInfo===e)return!1;this._currencyInfo=e;const t=null===e.selectedCurrency?(0,s.t)("Mixed"):(0,r.ensureDefined)(e.displayedValues.get(e.selectedCurrency));return this._currencyText.textContent!==t&&(this._currencyText.textContent=t,this._width=null),this._currencyArrowDown.classList.contains("js-hidden")!==e.readOnly&&(this._currencyArrowDown.classList.toggle("js-hidden",e.readOnly),this._currencyLabelTr.classList.toggle(y.readonly,e.readOnly),this._width=null),!0}setUnitInfo(e){if(null!==this._unitInfo&&this._unitInfo.selectedUnit===e.selectedUnit&&0===this._unitInfo.availableGroups.size==(0===e.availableGroups.size)&&this._unitInfo.originalUnits.size===e.originalUnits.size)return this._unitInfo=e,!1;this._unitInfo=e;const t=null===e.selectedUnit?(0,s.t)("Mixed"):(0,r.ensureDefined)(e.names.get(e.selectedUnit))
;return this._unitText.textContent!==t&&(this._unitText.textContent=t,this._width=null),this._unitArrowDown.classList.contains("js-hidden")!==(0===e.availableGroups.size)&&(this._unitArrowDown.classList.toggle("js-hidden",0===e.availableGroups.size),this._unitLabelTr.classList.toggle(y.readonly,0===e.availableGroups.size),this._width=null),!0}updateColors(e,t){const i=this._controlsContainer.style;i.background=e,i.color=t}currencyInfo(){return this._currencyInfo}unitInfo(){return this._unitInfo}setFontSize(e){this._fontSize!==e&&(this._fontSize=e,this._currencyLabelTr.style.fontSize=e+"px",this._unitLabelTr.style.fontSize=e+"px",this._width=null,this._setLineHeight(this._oneLineHeight()))}labelTop(){return Number(y.css_value_currency_label_top)}labelBottom(){const e=this.labelTop(),t=this._oneLineHeight();let i=e+t;return this._isMultiLine()&&(i+=t+1),i}_currencyTooltipContent(){const e=this._currencyInfo;return null===e?"":null===e.selectedCurrency?Array.from(e.currencies).map(t=>(0,r.ensureDefined)(e.displayedValues.get(t))).join(", "):""}_unitTooltipContent(){const e=this._unitInfo;return null===e?"":null===e.selectedUnit?Array.from(e.units).map(t=>(0,r.ensureDefined)(e.names.get(t))).join(", "):e.descriptions.get(e.selectedUnit)||""}_setLineHeight(e){this._currencyLabelTr.style.lineHeight=e+"px",this._unitLabelTr.style.lineHeight=e+"px"}_updateMultiLine(){this._controlsContainer.classList.toggle(y.multiline,this._isMultiLine())}_updateVisibility(){this._currencyAndUnitLabelsWrapper.classList.toggle("js-hidden",!this.isVisible())}_oneLineHeight(){return 7+this._fontSize}_isMultiLine(){return this.unitLabelVisible()&&this.currencyLabelVisible()}}async function w(e,t,r){const[s,n]=await Promise.all([Promise.all([i.e(23876),i.e(26822),i.e(69756),i.e(88278),i.e(37610),i.e(52802),i.e(76473),i.e(33996),i.e(94595),i.e(94269),i.e(55442),i.e(26992),i.e(63537),i.e(53684),i.e(18270),i.e(73935),i.e(43424),i.e(45867),i.e(27420),i.e(32704)]).then(i.bind(i,25527)),t()]);return s.showUnitConversion(e,r,n)}var P=i(17515);var C=i(24940),T=i(89150);const x={contextMenuEnabled:!0,currencyConversionEnabled:!1,unitConversionEnabled:!1,countdownEnabled:!0,contextMenu:{general:!0,source:!0},pressedMouseMoveScale:!0,mouseWheelScale:!0,croppedTickMarks:!0};class I{constructor(e,t,i,r,s,n,a){this._priceScale=null,this._widthCache=new h.TextWidthCache(1e3),this._color=null,this._fontSize=null,this._currencyFontSize=0,this._currencyLabelWidth=null,this._isVisible=!0,this._updateTimeout=null,this._currencyMenu=null,this._unitMenu=null,this._prevOptimalWidth=0,this._size=new l.Size(-1,-1),this._currentCursorClassName="",this._mouseDown=!1,this._destroyed=!1,this._highlighted=!1,this._mouseWheelHelper=null,this._dragScaleActive=!1,this._pane=e,this._undoModel=t,this._properties=i,this._isLeft="left"===r,this._options=(0,c.merge)((0,c.clone)(x),s),this._rendererOptionsProvider=n,this._backgroundBasedTheme=a,this._cell=document.createElement("div"),this._cell.className="price-axis",this._cell.style.width="25px",this._cell.style.left="0",
this._canvasConfiguredHandler=()=>{this._undoModel.model().lightUpdate()},this._canvasBinding=(0,l.createBoundCanvas)(this._cell,new l.Size(16,16)),this._canvasBinding.subscribeCanvasConfigured(this._canvasConfiguredHandler);const u=this._canvasBinding.canvas;u.style.position="absolute",u.style.zIndex="1",u.style.left="0",u.style.top="0",this._topCanvasConfiguredHandler=()=>this._undoModel.model().lightUpdate(),this._topCanvasBinding=(0,l.createBoundCanvas)(this._cell,new l.Size(16,16)),this._topCanvasBinding.subscribeCanvasConfigured(this._topCanvasConfiguredHandler);const d=this._topCanvasBinding.canvas;d.style.position="absolute",d.style.zIndex="2",d.style.left="0",d.style.top="0",this._mouseEventHandler=new o.MouseEventHandler(this._cell,this,{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0}),this._options.currencyConversionEnabled||this._options.unitConversionEnabled?(this._currencyLabel=new b,this._cell.appendChild(this._currencyLabel.element())):this._currencyLabel=null,this._properties.childs().fontSize.subscribe(this,this._onFontSizeChanged),this._options.mouseWheelScale&&(this._mouseWheelHelper=new T.MouseWheelHelper,this._cell.addEventListener("wheel",this._onMousewheel.bind(this),{passive:!1}))}getElement(){return this._cell}onOptimalWidthNeedToBeRecalculated(e){const t=this.optimalWidth();(this._prevOptimalWidth<t||e)&&null===this._updateTimeout&&(this._updateTimeout=setTimeout(()=>{this._undoModel.model().fullUpdate(),this._updateTimeout=null},100)),this._prevOptimalWidth=t}optimalWidth(){var e;if(!this.isVisible())return 0;let t=0;const i=this.rendererOptions();if(this._pane.hasState()){const i=(0,l.getContext2D)(this._canvasBinding.canvas);(0,u.setFont)(i,this.baseFont());const r=this.backLabels(!0);for(let e=r.length;e--;){if(!r[e].isAxisLabelVisible())continue;const s=this._widthCache.measureText(i,r[e].text());t=Math.max(t,s);const n=r[e].secondLineText();n&&(t=Math.max(t,this._widthCache.measureText(i,n)));const o=r[e].thirdLineText();o&&(t=Math.max(t,this._widthCache.measureText(i,o)))}const s=this.priceScale(),n=s.marks();n.length>0&&(t=Math.max(t,this._widthCache.measureText(i,n[0].label),this._widthCache.measureText(i,n[n.length-1].label)));const o=(null===(e=s.mainSource())||void 0===e?void 0:e.firstValue())||null;if(null!==o){const e=s.coordinateToPrice(1,o),r=s.coordinateToPrice(this._size.h-2,o);t=Math.max(t,this._widthCache.measureText(i,s.formatPrice(Math.floor(Math.min(e,r))+.11111111111111,o)),this._widthCache.measureText(i,s.formatPrice(Math.ceil(Math.max(e,r))-.11111111111111,o)))}}let s=0;this._isCurrencyLabelVisible()&&(null===this._currencyLabelWidth&&(this._currencyLabelWidth=(0,r.ensureNotNull)(this._currencyLabel).width()),s=this._currencyLabelWidth);const n=t||34;let o=Math.max(s,Math.ceil(i.borderSize+i.offsetSize+i.paddingInner+i.paddingOuter+n+4));return o+=o%2,o}backLabels(e){const t=[],i=this._grouppedSources(),r=r=>{for(const s of r){if(!e&&i.topLevelSources.has(s))continue;const r=s.priceAxisViews(this._pane.state(),this.priceScale())
;if(r)for(const e of r)t.push(e)}};return r(i.sources),r(this._pane.state().customSources()),t}getImage(){const e=this._size,t=(0,l.createDisconnectedCanvas)(document,e);if((0,l.getPrescaledContext2D)(t).drawImage(this._canvasBinding.canvas,0,0,e.w,e.h),null!==this._currencyLabel&&this._currencyLabel.isVisible()){const i=this._undoModel.model().isDark();this._currencyLabel.drawLabel((0,l.getContext2D)(t),e.w,(0,l.getCanvasDevicePixelRatio)(t),i)}return t}paint(e){if(this._isVisible&&e!==a.InvalidationLevel.None){if(e>a.InvalidationLevel.Cursor){const e=(0,l.getContext2D)(this._canvasBinding.canvas);this._alignLabels(),this._drawBackground(e,this._canvasBinding.pixelRatio),this._drawBorder(e,this._canvasBinding.pixelRatio),this._pane.hasState()&&(this._updateCurrencyLabel(),this._drawTickMarks(e,this._canvasBinding.pixelRatio),this._drawBackLabels(e,this._canvasBinding.pixelRatio))}if(this._pane.hasState()){const e=(0,l.getContext2D)(this._topCanvasBinding.canvas),t=this._topCanvasBinding.pixelRatio;e.clearRect(0,0,Math.ceil(this._size.w*t)+1,Math.ceil(this._size.h*t)+1),this._drawCrossHairLabel(e,t)}}}priceScale(){return(0,r.ensureNotNull)(this._priceScale)}setPriceScale(e){this._priceScale!==e&&(null!==this._priceScale&&(this._priceScale.onMarksChanged().unsubscribe(this,this.onOptimalWidthNeedToBeRecalculated),this._priceScale.modeChanged().unsubscribeAll(this)),this._priceScale=e,null!==e&&(e.onMarksChanged().subscribe(this,this.onOptimalWidthNeedToBeRecalculated),e.modeChanged().subscribe(this,()=>this.onOptimalWidthNeedToBeRecalculated(!0))))}isVisible(){return this._isVisible}setVisible(e){(e=!!e)!==this._isVisible&&(this._cell.style.display=e?"table-cell":"none",this._isVisible=e)}destroy(){null!==this._currencyMenu&&(this._currencyMenu.close(),this._currencyMenu=null),null!==this._unitMenu&&(this._unitMenu.close(),this._unitMenu=null),this._topCanvasBinding.unsubscribeCanvasConfigured(this._topCanvasConfiguredHandler),this._topCanvasBinding.destroy(),this._canvasBinding.unsubscribeCanvasConfigured(this._canvasConfiguredHandler),this._canvasBinding.destroy(),null!==this._priceScale&&(this._priceScale.onMarksChanged().unsubscribe(this,this.onOptimalWidthNeedToBeRecalculated),this._priceScale.modeChanged().unsubscribeAll(this)),this._priceScale=null,this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=null),this._mouseEventHandler.destroy(),this._properties.childs().fontSize.unsubscribe(this,this._onFontSizeChanged),this._destroyed=!0}setHighlighted(e){this._highlighted=e}backgroundColor(){return this._pane.state().model().backgroundColor().value()}backgroundTopColor(){return this._pane.state().model().backgroundTopColor().value()}lineColor(){return this._properties.childs().lineColor.value()}textColor(){return this._properties.childs().textColor.value()}fontSize(){return this._properties.childs().fontSize.value()}baseFont(){return(0,p.makeFont)(this.fontSize(),m.CHART_FONT_FAMILY,"")}rendererOptions(){let e=this._rendererOptionsProvider.options()
;return this._color===e.color&&this._fontSize===e.fontSize||(this._color=e.color),this._fontSize!==e.fontSize&&(this._widthCache.reset(),this._fontSize=e.fontSize,this._currencyLabelWidth=null,this._currencyFontSize=0,this._updateCurrencyLabelFont(),this.onOptimalWidthNeedToBeRecalculated()),this._hasAlertLabel()&&(e=Object.assign({},e,{paddingInner:Math.max(e.paddingInner,d.ALERT_LABEL_WIDTH)})),e}mouseEnterEvent(e){this._mouseEnterOrTouchStartEvent(e)}mouseMoveEvent(e){this._mouseOrTouchMoveEvent(e)}mouseDownEvent(e){this._mouseDownOrTouchStartEvent(e)}touchStartEvent(e){this._mouseOrTouchMoveEvent(e),this._mouseEnterOrTouchStartEvent(e),this._mouseDownOrTouchStartEvent(e)}pressedMouseMoveEvent(e){this._pressedMouseOrTouchMoveEvent(e)}touchMoveEvent(e){this._pressedMouseOrTouchMoveEvent(e)}mouseDownOutsideEvent(){if(this._dragScaleActive){const e=this._pane.state(),t=this.priceScale();this._mouseDown&&(this._mouseDown=!1,this._undoModel.endScalePrice(e,t),this.restoreDefaultCursor()),this._dragScaleActive=!1}}mouseUpEvent(e){this._mouseUpOrTouchEndEvent(e)}touchEndEvent(e){this._mouseLeaveOrTouchEndEvent(e),this._mouseUpOrTouchEndEvent(e)}mouseClickEvent(e){this._mouseClickOrTapEvent(e)}tapEvent(e){this._mouseClickOrTapEvent(e)}mouseLeaveEvent(e){this._mouseLeaveOrTouchEndEvent(e)}mouseDoubleClickEvent(e){this._mouseDoubleClickOrDoubleTapEvent(e)}doubleTapEvent(e){this._mouseDoubleClickOrDoubleTapEvent(e)}contextMenuEvent(e){this._contextMenuOrTouchContextMenuEvent(e)}touchContextMenuEvent(e){this._contextMenuOrTouchContextMenuEvent(e)}reset(){const e=this._pane.state(),t=this.priceScale();this._undoModel.resetPriceScale(e,t),this.onOptimalWidthNeedToBeRecalculated(!0)}sizeReady(){return this.getWidth()>=this.optimalWidth()&&null===this._updateTimeout}_grouppedSources(){var e;const t=this._pane,i=t.state().model(),r=this._sameSideSources().slice(),s=t.state(),n=this.priceScale(),o=new Set,a=null!==(e=i.lineBeingEdited())&&void 0!==e?e:i.lineBeingCreated();a&&o.add(a);const l=i.customSourceBeingMoved();null!==l&&o.add(l),i.sourcesBeingMoved().forEach(e=>o.add(e)),i.selection().allSources().forEach(e=>o.add(e));const c=i.hoveredSource();null!==c&&o.add(c);if(n===s.defaultPriceScale()){const e=this._pane.state().dataSources();for(const t of e)s.isOverlay(t)&&r.push(t)}return{sources:r,topLevelSources:o}}_isCurrencyLabelVisible(){return null!==this._currencyLabel&&this._currencyLabel.isVisible()}_updateCurrencyLabel(){if(null!==this._currencyLabel){if(this._options.currencyConversionEnabled){const e=this.priceScale().currency(this._undoModel.model().availableCurrencies());null!==e&&this._properties.childs().showCurrency.value()?(this._currencyLabel.showCurrency(),this._currencyLabel.updateColors(this.backgroundTopColor(),this.textColor()),this._currencyLabel.setCurrencyInfo(e)&&(this._currencyLabelWidth=null,this.onOptimalWidthNeedToBeRecalculated())):this._currencyLabel.hideCurrency()}if(this._options.unitConversionEnabled){const e=this.priceScale().unit(this._undoModel.model().availableUnits())
;null!==e&&this._properties.childs().showUnit.value()?(this._currencyLabel.showUnit(),this._currencyLabel.updateColors(this.backgroundTopColor(),this.textColor()),this._currencyLabel.setUnitInfo(e)&&(this._currencyLabelWidth=null,this.onOptimalWidthNeedToBeRecalculated())):this._currencyLabel.hideUnit()}this._updateCurrencyLabelFont()}}_updateCurrencyLabelFont(){if(null===this._currencyLabel)return;const e=this.fontSize();e!==this._currencyFontSize&&(this._currencyLabel.setFontSize(e),this._currencyFontSize=e,this._currencyLabelWidth=null,this.onOptimalWidthNeedToBeRecalculated())}_alignLabels(){const e=this._size.h;let t=e/2;const i=[],r=this.priceScale(),s=r.orderedSources().slice(),n=this._pane.state(),o=this.rendererOptions();if(r===n.defaultPriceScale()){const e=n.priceDataSources();for(let t=0;t<e.length;t++)n.isOverlay(e[t])&&s.push(e[t])}const a=r.mainSource();for(const l of[s,n.customSources()])for(let s=0;s<l.length;++s){const c=l[s],u=c.priceAxisViews(n,r);if(u){const r=u.filter(t=>{if(t.ignoreAlignment()||!t.isVisible())return!1;const i=t.height(o),r=t.floatCoordinate();return r>-i&&r<e+i});if(!r.length)continue;i.push(...r),a===c&&(t=r[0].floatCoordinate())}}const l=i.filter(e=>e.floatCoordinate()<=t),c=i.filter(e=>e.floatCoordinate()>t);l.sort((e,t)=>t.floatCoordinate()-e.floatCoordinate()),l.length>0&&c.length>0&&c.push(l[0]),c.sort((e,t)=>e.floatCoordinate()-t.floatCoordinate());for(const e of i)e.setFixedCoordinate(e.coordinate());if(r.properties().childs().alignLabels.value()){for(let e=1;e<l.length;e++){const t=l[e],i=l[e-1],r=t.height(o),s=t.coordinate(),n=i.getFixedCoordinate();s>n-r&&t.setFixedCoordinate(n-r)}for(let e=1;e<c.length;e++){const t=c[e],i=c[e-1],r=i.height(o),s=t.coordinate(),n=i.getFixedCoordinate();s<n+r&&t.setFixedCoordinate(n+r)}}}_drawTickMarks(e,t){const i=this.priceScale().marks();e.save(),(0,u.setFont)(e,this.baseFont());const s=this.rendererOptions(),n=this._isLeft?Math.floor((this._size.w-s.offsetSize)*t):0,o=this._isLeft?Math.round(n-s.paddingInner*t):Math.round(n+(s.offsetSize+s.paddingInner)*t),a=this.fontSize(),c=this._isCurrencyLabelVisible()?(0,r.ensureNotNull)(this._currencyLabel).labelBottom():0,d=i.map(t=>{if(this._options.croppedTickMarks)return{visible:!0,yCorrection:this._widthCache.yMidCorrection(e,t.label)};const i=t.coord-a/2,r=t.coord+a/2,s=!(r>this._size.h||i<c);return{visible:!(r>this._size.h||i<c),yCorrection:s?this._widthCache.yMidCorrection(e,t.label):0}});e.fillStyle=this.textColor(),e.textAlign=this._isLeft?"right":"left",e.textBaseline="middle",(0,l.drawScaled)(e,t,()=>{for(let r=i.length;r--;){if(!d[r].visible)continue;const s=i[r];e.fillText(s.label,o/t,s.coord+d[r].yCorrection)}}),e.restore()}_hasAlertLabel(){return this.priceScale().dataSources().some(e=>e instanceof d.AlertLabel)}_showCurrenciesContextMenu(){if(null!==this._currencyMenu&&this._currencyMenu.isOpened())return void this._currencyMenu.close();(0,_.trackEvent)("GUI","Currency conversion");w((0,s.t)("Currencies"),()=>async function(e,t,r){
return(await Promise.all([i.e(23876),i.e(26822),i.e(69756),i.e(88278),i.e(37610),i.e(52802),i.e(76473),i.e(33996),i.e(94595),i.e(94269),i.e(55442),i.e(26992),i.e(63537),i.e(53684),i.e(18270),i.e(73935),i.e(43424),i.e(45867),i.e(27420),i.e(32704)]).then(i.bind(i,2396))).currencyActions(e,t,r)}(this._undoModel,(0,r.ensureNotNull)(this._currencyLabel).currencyInfo(),this.priceScale()),(0,r.ensureNotNull)(this._currencyLabel).currencyLabelElement()).then(e=>{this._destroyed?e.close():this._currencyMenu=e})}_showUnitsContextMenu(){if(null!==this._unitMenu&&this._unitMenu.isOpened())return void this._unitMenu.close();(0,_.trackEvent)("GUI","Unit conversion");w((0,s.t)("Units"),()=>async function(e,t,r){return(await Promise.all([i.e(23876),i.e(26822),i.e(69756),i.e(88278),i.e(37610),i.e(52802),i.e(76473),i.e(33996),i.e(94595),i.e(94269),i.e(55442),i.e(26992),i.e(63537),i.e(53684),i.e(18270),i.e(73935),i.e(43424),i.e(45867),i.e(27420),i.e(32704)]).then(i.bind(i,91668))).unitActions(e,t,r)}(this._undoModel,(0,r.ensureNotNull)(this._currencyLabel).unitInfo(),this.priceScale()),(0,r.ensureNotNull)(this._currencyLabel).unitLabelElement()).then(e=>{this._destroyed?e.close():this._unitMenu=e})}_onFontSizeChanged(){this._currencyLabelWidth=null,this._currencyFontSize=0,this._updateCurrencyLabelFont(),this.onOptimalWidthNeedToBeRecalculated()}_mouseOrTouchMoveEvent(e){if(!this._priceScale)return;this.dataSourceAtPoint(e.localX,e.localY)?this._setCursorClassName("pointer"):this._setResizeCursor()}_mouseDownOrTouchStartEvent(e){this._zoomAvailable()&&this._options.pressedMouseMoveScale&&(this._mouseDown=!0,this._undoModel.startScalePrice(this._pane.state(),this.priceScale(),e.localY),this._dragScaleActive=!0)}_mouseEnterOrTouchStartEvent(e){this._setResizeCursor()}_pressedMouseOrTouchMoveEvent(e){if(this._dragScaleActive){const t=this.priceScale();this._undoModel.scalePriceTo(this._pane.state(),t,e.localY)}}_mouseUpOrTouchEndEvent(e){if(this._dragScaleActive){const e=this.priceScale();this._mouseDown=!1,this._undoModel.endScalePrice(this._pane.state(),e),this.restoreDefaultCursor(),this._dragScaleActive=!1}}_mouseClickOrTapEvent(e){if(this._currencyLabel){if(this._currencyLabel.currencyLabelElement().contains(e.target))return void this._showCurrenciesContextMenu();if(this._currencyLabel.unitLabelElement().contains(e.target))return void this._showUnitsContextMenu()}const t=this.dataSourceAtPoint(e.localX,e.localY);t&&this._undoModel.selectionMacro(e=>{e.selection().isSelected(t)||(e.clearSelection(),e.addSourceToSelection(t))})}_mouseLeaveOrTouchEndEvent(e){this._setCursorClassName("")}_mouseDoubleClickOrDoubleTapEvent(e){const t=this.dataSourceAtPoint(e.localX,e.localY);t?this._pane.processDoubleClickOnSource(t):(this.reset(),(0,_.trackEvent)("GUI","Double click price scale"))}_contextMenuOrTouchContextMenuEvent(e){if(this._options.contextMenuEnabled){const t=this.dataSourceAtPoint(e.localX,e.localY);if(null!==t&&this._options.contextMenu.source){return void this._undoModel.model().selectionMacro(i=>{
i.selection().isSelected(t)||(i.clearSelection(),i.addSourceToSelection(t)),this._pane.showContextMenuForSelection(e)})}this._options.contextMenu.general&&P.ContextMenuManager.createMenu(this.getContextMenuActions(),{statName:"PriceScaleContextMenu"}).then(t=>t.show(e))}}_setResizeCursor(){const e=this.priceScale();e.isPercentage()||e.isIndexedTo100()?this._setCursorClassName(""):this._zoomAvailable()&&(this._options.pressedMouseMoveScale||this._options.mouseWheelScale)&&this._setCursorClassName("ns-resize")}_setCursorClassName(e){let t="";e&&(t="price-axis--cursor-"+e),this._currentCursorClassName!==t&&(this._currentCursorClassName&&this._cell.classList.remove(this._currentCursorClassName),t&&this._cell.classList.add(t),this._currentCursorClassName=t)}_zoomAvailable(){return!this.priceScale().isEmpty()&&this._undoModel.model().zoomEnabled()}_onMousewheel(e){if(!this._zoomAvailable()||!this._options.mouseWheelScale)return;const t=(0,r.ensureNotNull)(this._mouseWheelHelper).processWheel(e).deltaY;if(0===t)return;e.cancelable&&e.preventDefault();const i=this._undoModel,s=this._pane.state(),n=this.priceScale(),o=this._cell.getBoundingClientRect(),a=e.clientY-o.top,l=a+15*t;i.startScalePrice(s,this.priceScale(),a,!0),i.scalePriceTo(s,n,l),i.endScalePrice(s,n),e.stopPropagation()}_drawCrossHairLabel(e,t){var i,r;e.save();const s=this._pane.state(),n=s.model(),o=this.priceScale(),a=[],l=this.priceScale()===s.defaultPriceScale(),c=null!==(i=n.lineBeingEdited())&&void 0!==i?i:n.lineBeingCreated();if(c&&(c.priceScale()===o||l&&s.isOverlay(c))){const e=c.priceAxisViews(s,o);e&&e.length&&a.push(e)}const u=n.customSourceBeingMoved();this._addViewsOrMaxMin(null===u?[]:[u],a),this._addViewsOrMaxMin(n.sourcesBeingMoved(),a),this._addViewsOrMaxMin(n.selection().allSources(),a);const d=n.hoveredSource();if(d){const e=s.customSources().includes(d)?o:d.priceScale();if(!n.selection().isSelected(d)&&(this._isFromSameSide(e)||l&&s.isOverlay(d))){const e=null===(r=n.hoveredSource())||void 0===r?void 0:r.priceAxisViews(s,o);e&&e.length&&a.push(e)}}const h=n.crossHairSource().priceAxisViews(s,o);h&&h.length&&a.push(h);const p=this.rendererOptions(),_=this._isLeft?"right":"left";a.forEach(i=>{i.forEach(i=>{e.save(),i.renderer().draw(e,p,this._widthCache,this._size.w,this._size.h,_,t),e.restore()})}),e.restore()}_drawBackground(e,t){const i=Math.ceil(this._size.w*t),r=Math.ceil(this._size.h*t),s=this.backgroundTopColor(),o=this.backgroundColor();if(s===o?(0,l.clearRect)(e,0,0,i+1,r+1,this.backgroundColor()):(0,g.clearRectWithGradient)(e,0,0,i+1,r+1,s,o),this._highlighted){e.globalAlpha=.5;const t=n.themes[this._backgroundBasedTheme.value()].getThemedColor("color-price-axis-highlight");(0,l.fillRect)(e,0,0,i+1,r+1,t),e.globalAlpha=1}const a=this._pane.state().model(),c=this.priceScale(),u=a.selection().lineDataSources().filter(e=>e.priceScale()===c).reduce((e,t)=>{const i=t.priceAxisPoints();return 0===i.length?e:e.concat(i)},[]);u.length>0&&this._hightlightBackground(e,u,this.priceScale().mainSource(),t);const d=a.crossHairSource()
;d.startMeasurePoint()&&this._hightlightBackground(e,d.measurePoints(),this.priceScale().mainSource(),t)}_drawBorder(e,t){e.save(),e.fillStyle=this.lineColor();const i=Math.max(1,Math.floor(this.rendererOptions().borderSize*t)),r=this._isLeft?Math.floor(this._size.w*t)-i:0;e.fillRect(r,0,i,Math.ceil(this._size.h*t)+1),e.restore()}_drawBackLabels(e,t){e.save();const i=this.backLabels(),r=this.rendererOptions(),s=this._isLeft?"right":"left";for(const n of i)n.isAxisLabelVisible()&&(e.save(),n.renderer().draw(e,r,this._widthCache,this._size.w,this._size.h,s,t),e.restore());e.restore()}_hightlightBackground(e,t,i,r){if(!i)return;const s=i.firstValue();if(null===s)return;let n=t[0].price,o=t[0].price;for(let e=1;e<t.length;e++)n=Math.min(n,t[e].price),o=Math.max(o,t[e].price);const a=this.priceScale(),c=Math.floor(a.priceToCoordinate(n,s)*r),u=Math.ceil(a.priceToCoordinate(o,s)*r);(0,l.fillRect)(e,Math.floor(r),c,Math.ceil((this._size.w-1)*r)+1,u-c,C.axesHighlightColor)}_addViewsOrMaxMin(e,t){const i=this._pane.state(),r=this.priceScale();if(r!==i.defaultPriceScale()&&(e=e.filter(e=>i.isOverlay(e)||this._isFromSameSide(e.priceScale()))),0!==e.length)if(1===e.length){const s=e[0].priceAxisViews(i,r);s&&s.length&&t.push(s)}else t.push(this._minMaxViews(e))}_minMaxViews(e){const t=this._pane.state(),i=this.priceScale(),r=[];let s=1/0,n=-1/0,o=null,a=null;for(const r of e){const e=r.priceAxisViews(t,i);if(e&&e.length)for(let t=0;t<e.length;t++){const i=e[t],r=i.coordinate();r>=n&&(n=r,a=i),r<=s&&(s=r,o=i)}}return a&&r.push(a),o&&r.push(o),r}_isFromSameSide(e){return null!==e&&(this._isLeft?this._pane.state().leftPriceScales():this._pane.state().rightPriceScales()).includes(e)}_sameSideSources(){const e=this._pane.state().sourcesByGroup();return this._isLeft?e.leftPriceScalesSources():e.rightPriceScalesSources()}}},11190:(e,t,i)=>{"use strict";i.d(t,{PriceAxisesContainer:()=>T});var r=i(16282),s=i(14900),n=i(64348),o=i(94420),a=i(72927),l=i(32022),c=i(34698),u=i(8835),d=i(92175),h=i(39304);const p=parseInt(d.labelheight),_=parseInt(d.bottommargin);function m(e){return e/11}class f{constructor(){this._wrapper=document.createElement("div"),this._element=document.createElement("div"),this._labelElement=document.createElement("div"),this._gearElement=document.createElement("div"),this._currentScale=1,this._info=null,this._mode="auto",this._wrapper.appendChild(this._element),this._wrapper.classList.add(d.wrapper),this._element.classList.add(d.label),this._labelElement.className=d.symbol,this._element.appendChild(this._labelElement),this._gearElement.className=d.gear,this._gearElement.innerHTML=u,this._element.appendChild(this._gearElement)}getElement(){return this._wrapper}setMode(e){this._mode!==e&&(this._mode=e)}align(e,t){const i=m(t);Math.abs(i-this._currentScale)>.1&&(this._currentScale=i,Math.abs(this._currentScale-1)>.1?this._element.style.transform=`scale(${this._currentScale})`:(this._currentScale=1,this._element.style.transform=""))}drawLabelForScreenshot(e,t){if(null===this._info||"gear"===this._mode)return;const i=(0,
l.makeFont)(t.fontSize,h.CHART_FONT_FAMILY);e.fillStyle=c.themes[t.theme].getThemedColor("color-price-axis-label-back"),e.globalAlpha=.5,e.beginPath();const r=m(t.fontSize)*p/2,s=(0,a.point)(t.offset+t.width/2,t.height/2);e.arc(s.x,s.y,r,0,2*Math.PI,!0),e.fill(),e.globalAlpha=1,e.fillStyle=c.themes[t.theme].getThemedColor("color-price-axis-label-text"),e.textAlign="center",e.font=i,e.textBaseline="middle",e.fillText(this._info.label,s.x,s.y)}setAxisNameInfo(e){this._info=e,null!==e&&(this._labelElement.textContent=e.label)}static height(e){return(p+_)*e}}var g=i(96276),v=i.n(g),S=i(10595),y=i(17515),b=i(61581);const w={enableTooltip:!0,showLabels:!0,enableMenu:!0,enableHighlight:!0};class P{constructor(e,t,i,r,n){this._invalidated=!0,this._size=new s.Size(0,0),this._offset=0,this._axisInfo=null,this._onLabelHovered=new(v()),this._highlighted=!1,this._labelMode="auto",this._fixedLabelMode=null,this._canvasConfiguredHandler=()=>this.update(),this._isLeft="left"===e,this._rendererOptionsProvider=r.rendererOptionsProvider,this._sourcesTitlesProvider=r.sourcesTitlesProvider,this._contextMenuItemsProvider=r.contextMenuItemsProvider,this._backgroundBasedTheme=r.backgroundBasedTheme,this._getBackgroundTopColor=r.getBackgroundTopColor,this._getBackgroundBottomColor=r.getBackgroundBottomColor,this._showHorizontalBorder=Boolean(r.showHorizontalBorder),this._properties=t,this._axisInfo=i,this._labelOptions={...w,...n},this._properties.lineColor.subscribe(this,this._onPropertyChanged),this._cell=document.createElement("div"),this._cell.classList.add(d["price-axis-stub"]),this._labelOptions.enableTooltip&&this._cell.classList.add("apply-common-tooltip"),this._cell.style.width="25px",this._cell.style.height="100%",this._cell.style.position="absolute",this._cell.style.left="0",this._cell.style.overflow="hidden",this._labelOptions.showLabels?(this._label=new f,this._label.setAxisNameInfo(this._axisInfo),this._cell.appendChild(this._label.getElement()),this._labelOptions.enableTooltip&&(0,b.setTooltipData)(this._cell,"text",e=>this._tooltipContent())):this._label=null,this._mouseEventHandler=new S.MouseEventHandler(this._cell,this,{treatHorzTouchDragAsPageScroll:!0,treatVertTouchDragAsPageScroll:!0}),this._canvasBinding=(0,s.createBoundCanvas)(this._cell,new s.Size(16,16)),this._canvasBinding.subscribeCanvasConfigured(this._canvasConfiguredHandler);const o=this._canvasBinding.canvas;o.style.position="absolute",o.style.left="0",o.style.top="0"}destroy(){this._canvasBinding.unsubscribeCanvasConfigured(this._canvasConfiguredHandler),this._canvasBinding.destroy(),this._properties.lineColor.unsubscribe(this,this._onPropertyChanged),this._mouseEventHandler.destroy()}mouseEnterEvent(e){this._mouseOrTouchEnterEvent(e)}touchStartEvent(e){this._mouseOrTouchEnterEvent(e)}mouseLeaveEvent(e){this._mouseOrTouchLeaveEvent(e)}touchEndEvent(e){this._mouseOrTouchLeaveEvent(e)}mouseClickEvent(e){this._mouseClickOrTapEvent(e)}tapEvent(e){this._mouseClickOrTapEvent(e)}update(){this._invalidated=!0}getElement(){return this._cell}onLabelHovered(){
return this._onLabelHovered}setSizeAndOffset(e,t){if(e.w<0||e.h<0)throw new Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(e));this._size.equals(e)||(this._size=e,this._canvasBinding.resizeCanvas({width:e.w,height:e.h}),this._cell.style.width=e.w+"px",this._cell.style.minWidth=e.w+"px",this._cell.style.height=e.h+"px",this._invalidated=!0),this._offset!==t&&(this._offset=t,this._cell.style.left=t+"px")}paint(e){if(e<o.InvalidationLevel.Full&&!this._invalidated)return;if(0===this._size.w||0===this._size.h)return;this._invalidated=!1;const t=(0,s.getContext2D)(this._canvasBinding.canvas);this._drawBackground(t,this._canvasBinding.pixelRatio),this._drawVerticalBorder(t,this._canvasBinding.pixelRatio),this._showHorizontalBorder&&this._drawHorizontalBorder(t,this._canvasBinding.pixelRatio)}hardResetCanvas(){(0,s.hardResizeCanvas)(this._canvasBinding,this._size)}getWidth(){return this._size.w}getImage(){const e=(0,s.createDisconnectedCanvas)(document,this._size),t=(0,s.getPrescaledContext2D)(e),i=this._getBackgroundTopColor(),r=this._getBackgroundBottomColor();return i===r?(0,s.clearRect)(t,0,0,this._size.w,this._size.h,i):(0,n.clearRectWithGradient)(t,0,0,this._size.w,this._size.h,i,r),t.drawImage(this._canvasBinding.canvas,0,0,this._size.w,this._size.h),null!==this._label&&this._label.drawLabelForScreenshot(t,{offset:0,width:this._size.w,height:this._size.h,fontSize:this._properties.fontSize.value(),theme:this._backgroundBasedTheme.value()}),e}setLabelMode(e){e!==this._labelMode&&(this._labelMode=e,null!==this._label&&this._label.setMode(e),this._cell.classList.toggle(d["fixed-gear"],"gear"===e),this._cell.classList.toggle(d["fixed-symbol"],"symbol"===e),this._cell.classList.toggle("apply-common-tooltip","symbol"!==e&&this._labelOptions.enableTooltip))}_setHighlighted(e){this._labelOptions.enableHighlight&&(this._onLabelHovered.fire("stubButton",e),this._highlighted!==e&&(this._highlighted=e,this._invalidated=!0))}_onPropertyChanged(){this._invalidated=!0}_drawVerticalBorder(e,t){const i=this._size.w;e.save(),e.fillStyle=this._properties.lineColor.value();const r=Math.max(1,Math.floor(this._rendererOptionsProvider.options().borderSize*t)),s=this._isLeft?Math.floor(i*t)-r:0,n=Math.ceil(this._size.h*t);e.fillRect(s,0,r,n+1),e.restore()}_drawHorizontalBorder(e,t){e.save(),e.fillStyle=this._properties.lineColor.value();const i=Math.max(1,Math.floor(this._rendererOptionsProvider.options().borderSize*t)),r=Math.ceil(this._size.w*t),s=this._isLeft?0:i;e.fillRect(s,0,r-i,i),e.restore()}_drawBackground(e,t){const i=Math.ceil(t*this._size.w),r=Math.ceil(t*this._size.h),o=this._getBackgroundTopColor(),a=this._getBackgroundBottomColor();if(o===a?(0,s.clearRect)(e,0,0,i+1,r+1,o):(0,n.clearRectWithGradient)(e,0,0,i+1,r+1,o,a),this._highlighted){const t=c.themes[this._backgroundBasedTheme.value()].getThemedColor("color-price-axis-highlight");(0,s.fillRect)(e,0,0,i+1,r+1,t),e.globalAlpha=1}}_tooltipContent(){return this._sourcesTitlesProvider().join("\n")}_mouseOrTouchEnterEvent(e){
null!==this._label&&"symbol"!==this._labelMode&&this._labelOptions.enableHighlight&&this._setHighlighted(!0)}_mouseOrTouchLeaveEvent(e){"symbol"!==this._labelMode&&this._setHighlighted(!1)}_mouseClickOrTapEvent(e){e.preventDefault(),null===this._fixedLabelMode&&"symbol"!==this._labelMode&&this._labelOptions.enableMenu&&this._labelOptions.showLabels?(this._fixedLabelMode=this._labelMode,this.setLabelMode("gear"),y.ContextMenuManager.createMenu(this._contextMenuItemsProvider(),{statName:"PriceScaleLabelContextMenu"},()=>{this.setLabelMode((0,r.ensureNotNull)(this._fixedLabelMode)),this._fixedLabelMode=null}).then(e=>e.show((e,t)=>{const i=this._cell.getBoundingClientRect();return{clientX:this._isLeft?i.left:i.right-e,clientY:i.top-Math.min(t,i.top),overrideHeight:i.top<t?i.top:void 0}},this.getElement(),!0))):y.ContextMenuManager.hideAll()}}var C=i(76887);class T{constructor(e,t,i,r,n){this._axises=[],this._stubs=[],this._size=new s.Size(0,0),this._onLabelHovered=new(v()),this._scalesProperties=e,this._priceAxisWidgetFactory=i,this._rendererOptionsProvider=r.rendererOptionsProvider,this._titlesProvider=r.titlesProvider,this._stubContextMenuProvider=r.stubContextMenuProvider,this._backgroundBasedTheme=r.backgroundBasedTheme,this._getBackgroundTopColor=r.getBackgroundTopColor,this._getBackgroundBottomColor=r.getBackgroundBottomColor,this._showHorisontalBorder=Boolean(r.showHorizontalBorder),this._labelsOptions={...w,...n};const o=this._scalesProperties.childs();this._stubProperties={lineColor:o.lineColor,fontSize:o.fontSize},this._side=t,this._cell=document.createElement("td"),this._cell.classList.add("chart-markup-table","price-axis-container"),this._cell.style.width="25px",this._cell.style.position="relative"}destroy(){this.setScales([],0,0,0)}onLabelHovered(){return this._onLabelHovered}setScales(e,t,i,s){for(;e.length>this._axises.length&&this._axises.length<t;){const e=(0,C.getPriceAxisNameInfo)(this._side,this._axises.length),t=this._priceAxisWidgetFactory(this._side,this._rendererOptionsProvider,this._scalesProperties,e,this._backgroundBasedTheme);this._axises.push(t),this._cell.appendChild(t.getElement())}for(;e.length<this._axises.length;){const e=(0,r.ensureDefined)(this._axises.pop());this._cell.removeChild(e.getElement()),e.destroy()}for(let t=0;t<this._axises.length;++t)this._axises[t].setPriceScale(e[t]);const n=t-e.length,o=Math.max(0,n);for(;this._stubs.length>o;){const e=(0,r.ensureDefined)(this._stubs.pop());e.onLabelHovered().unsubscribeAll(this),this._cell.removeChild(e.getElement()),e.destroy()}for(;this._stubs.length<n;){const e=this._labelsOptions.showLabels?(0,C.getPriceAxisNameInfo)(this._side,this._stubs.length):null,t=this._stubs.length,i=new P(this._side,this._stubProperties,e,this._stubParams(t),this._labelsOptions);i.onLabelHovered().subscribe(this,(t,i)=>{this._labelsOptions.showLabels&&this._labelsOptions.enableHighlight&&this._onLabelHovered.fire({owner:t,axis:(0,r.ensureNotNull)(e)},i)}),this._stubs.push(i),this._cell.appendChild(i.getElement())}const a=this._labelsOptions.enableMenu
;1===s?this._stubs.forEach((e,t)=>e.setLabelMode(a?"gear":"symbol")):this._stubs.forEach((e,t)=>e.setLabelMode(t<i&&a?"auto":"symbol"))}getElement(){return this._cell}optimalWidths(){return this._axises.map(e=>e.optimalWidth())}setSizes(e,t){this._size=new s.Size(t.reduce((e,t)=>e+t,0),e),this._cell.style.width=this._size.w+"px",this._cell.style.minWidth=this._size.w+"px",this._cell.style.height=this._size.h+"px",t.length!==this._axises.length+this._stubs.length&&(0,r.assert)(t.length===this._axises.length+this._stubs.length,"Widgets count should be the same as widths one");let i=0;this._forEachWidgetFromLeft((r,n)=>{const o=t[n];r.setSizeAndOffset(new s.Size(o,e),i),i+=o})}update(){this._axises.forEach(e=>e.update()),this._stubs.forEach(e=>e.update())}paint(e){this._axises.forEach((t,i)=>t.paint(e(i))),this._stubs.forEach((t,i)=>t.paint(e(i)))}paintStubs(e){this._stubs.forEach(t=>t.paint(e))}hardResetCanvas(){this._axises.forEach(e=>e.hardResetCanvas()),this._stubs.forEach(e=>e.hardResetCanvas())}restoreDefaultCursor(){this._axises.forEach(e=>e.restoreDefaultCursor())}getWidth(){return this._size.w}findAxisWidgetForScale(e){const t=this._axises.find(t=>t.priceScale()===e);return void 0===t?null:t}getScreenshotData(){const e=this._getImage();return{content:e.toDataURL(),canvas:e,contentHeight:this._size.h,contentWidth:this._size.w}}getImage(){return this._getImage()}slotsCount(){return this._axises.length+this._stubs.length}highlightPriceAxisByLabel(e){this._axises.forEach(t=>{const i=t.axisInfo();t.setHighlighted(null!==i&&i.equals(e))})}axes(){return this._axises}_stubParams(e){return{rendererOptionsProvider:this._rendererOptionsProvider,backgroundBasedTheme:this._backgroundBasedTheme,sourcesTitlesProvider:()=>this._titlesProvider(this._side,e),contextMenuItemsProvider:()=>this._stubContextMenuProvider(this._side,e),getBackgroundTopColor:this._getBackgroundTopColor,getBackgroundBottomColor:this._getBackgroundBottomColor,showHorizontalBorder:this._showHorisontalBorder}}_getImage(){const e=(0,s.createDisconnectedCanvas)(document,this._size),t=(0,s.getPrescaledContext2D)(e);let i=0;return this._forEachWidgetFromLeft((e,r)=>{const s=e.getWidth();0!==s&&(t.drawImage(e.getImage(),i,0,s,this._size.h),i+=s)}),e}_forEachWidgetFromLeft(e){const t=[...this._axises,...this._stubs],i="left"===this._side,r=i?-1:t.length,s=i?-1:1;for(let n=i?t.length-1:0;n!==r;n+=s)e(t[n],n,t)}}},88118:(e,t,i)=>{"use strict";i(95411);var r=i(72927).Point,s=i(11877),n=i(68724).CheckMobile,o=i(54281),a=o.Action,l=o.Separator,c=i(14900).hardResizeCanvas,u=i(26377).ActionBinder,d=i(95872).LimitedPrecisionNumericFormatter,h=i(88137).createLinesAction,p=i(98006).isFeatureEnabled,_=i(11575).PriceAxisWidgetBase,m=i(22842),f=window.t("Merge All Scales Into One");class g extends _{constructor(e,t,i,r,s,n,o,a){super(e,t,i,s,n,r,a),this._axisInfo=o,this._offset=0,this.restoreDefaultCursor(),this.update(),this.contextMenu=null,this.actions=null}destroy(){null!==this.actions&&this.actions.reset&&this.actions.reset.destroy(),super.destroy()}
dataSourceAtPoint(e,t){var i=this._grouppedSources(),s=i.sources.concat(Array.from(i.topLevelSources)).concat(this._pane.state().customSources()),n=null,o=null;if(!this._priceScale)return null;function a(e,t){var i=o?o.result():0;e.result()>i&&(o=e,n=t)}for(var l=new r(e,t),c=this._pane.state(),u=s.length-1;u>=0;--u){var d=s[u],h=d.priceAxisViews(c,this._priceScale);if(h&&0!==h.length)for(var p=h.length-1;p>=0;--p){var _=h[p].renderer();if(null!==_&&void 0!==_.hitTest){var m=_.hitTest(l,this._size.w,this._isLeft?"left":"right");null!==m&&a(m,d)}}}return n}_initActions(e){if(this._pane.hasState()&&null===this.actions){this.actions={};var t=this,r=this._pane.chart().model();this.actions.reset=new a({label:window.t("Reset Price Scale"),icon:i(77624),shortcutHint:s.humanReadableHash(s.Modifiers.Alt+82),statName:"ResetScale",onExecute:g.prototype.reset.bind(this)}),this.actions.setAutoScale=new a({label:window.t("Auto (Fits Data To Screen)"),checkable:!0,checked:!0,statName:"ToggleAutoScale",onExecute:function(){r.togglePriceScaleAutoScaleMode(t.priceScale()),t._updateScalesActions()}}),this.actions.setPercentage=new a({label:window.t("Percent",{context:"scale_menu"}),checkable:!0,checked:this.priceScale().isPercentage(),statName:"TogglePercantage",onExecute:function(){r.togglePriceScalePercentageScaleMode(t.priceScale()),t._updateScalesActions()}}),this.actions.setIndexedTo100=new a({label:window.t("Indexed to 100",{context:"scale_menu"}),checkable:!0,checked:this.priceScale().isIndexedTo100(),statName:"ToggleIndexedTo100",onExecute:function(){r.togglePriceScaleIndexedTo100ScaleMode(t.priceScale()),t._updateScalesActions()}}),this.actions.setLog=new a({label:window.t("Logarithmic",{context:"scale_menu"}),checkable:!0,checked:this.priceScale().isLog(),statName:"ToggleLogScale",onExecute:function(){r.togglePriceScaleLogScaleMode(t.priceScale()),t._updateScalesActions()}}),this.actions.setRegular=new a({label:window.t("Regular",{context:"scale_menu"}),checkable:!0,checked:this.priceScale().isRegular(),statName:"ToggleRegularScale",onExecute:function(){r.setPriceScaleRegularScaleMode(t.priceScale()),t._updateScalesActions()}}),this.actions.alignLabels=new a({label:window.t("No Overlapping Labels",{context:"scale_menu"}),checkable:!0,checked:!1,statName:"TogglePreciseLabels"}),this.actions.alignLabels.binding=new u(this.actions.alignLabels,this.priceScale().properties().alignLabels,this._pane.chart().model(),"No Overlapping Labels"),this.actions.invertScale=new a({label:window.t("Invert Scale",{context:"scale_menu"}),checkable:!0,checked:this.priceScale().isInverted(),statName:"Invert Scale",onExecute:function(){r.invertPriceScale(t.priceScale()),t._updateScalesActions()}}),this._updateScalesActions()}}_logAction(){return this._isMainSeriesAxis()?this._pane.chart().actions().logSeriesScale:this.actions.setLog}_percentageAction(){return this._isMainSeriesAxis()?this._pane.chart().actions().percentSeriesScale:this.actions.setPercentage}_indexedTo100Action(){
return this._isMainSeriesAxis()?this._pane.chart().actions().indexedTo100SeriesScale:this.actions.setIndexedTo100}_autoScaleAction(){return this._isMainSeriesAxis()?this._pane.chart().actions().autoSeriesScale:this.actions.setAutoScale}_regularScaleAction(){return this._isMainSeriesAxis()?this._pane.chart().actions().regularSeriesScale:this.actions.setRegular}_lockScaleAction(){var e=this._pane.chart().actions().lockSeriesScale,t=S(this.priceScale(),this._pane.chart().model().model().mainSeriesScaleRatio());return e.update({hint:t}),e}_invertAction(){return this._isMainSeriesAxis()?this._pane.chart().actions().invertSeriesScale:this.actions.invertScale}_isMainSeriesAxis(){return this.priceScale().hasMainSeries()}_updateMainSeriesScalesActions(){this._isMainSeriesAxis()&&null!==this.actions&&this._updateScalesActions()}_updateScalesActions(){var e=this.priceScale(),t=this._isMainSeriesAxis(),i=e.mainSource().properties(),r=t&&e.isLockScale(),s=t&&i.style.value()===TradingView.Series.STYLE_PNF;this.actions.setRegular.update({checked:e.isRegular(),disabled:r||s}),this.actions.setPercentage.update({checked:e.isPercentage(),disabled:r||s}),this.actions.setIndexedTo100.update({checked:e.isIndexedTo100(),disabled:r||s}),this.actions.setLog.update({checked:e.isLog(),disabled:r||s}),this.actions.setAutoScale.update({checked:e.isAutoScale(),disabled:e.properties().autoScaleDisabled.value()})}_createMergeScalesAction(){var e=this._pane.chart().actions(),t=this._pane.chart().model().model().priceScaleSlotsCount();if(t.left+t.right===1)return 0===t.left?e.moveScaleToLeft:e.moveScaleToRight;var i=[];return i.push(e.mergeLeftScalesAction),i.push(e.mergeRightScalesAction),new a({label:f,subItems:i})}getContextMenuActions(){this._initActions();var e=this._pane.chart().actions(),t=[];if(t.push(this.actions.reset,new l,this._autoScaleAction()),this._isMainSeriesAxis()&&t.push(this._lockScaleAction()),t.push(e.scaleSeriesOnly,this._invertAction(),new l,this._regularScaleAction(),this._percentageAction(),this._indexedTo100Action(),this._logAction(),new l),n.any()||(t.push(this._createMergeScalesAction()),t.push(new l)),!m.enabled("fundamental_widget")){var i=p("financials_button");t.push(new a({label:window.t("Labels"),subItems:[e.showSymbolLabelsAction,e.showSeriesLastValue,e.showSeriesPrevCloseValue,e.showPrePostMarketPriceLabel,e.showHighLowPriceLabels,e.showAverageClosePriceLabel,this._undoModel.model().hasCustomSource("bidask")&&e.showBidAskLabels,e.showStudyPlotNamesAction,e.showStudyLastValue,i?e.showFundamentalNamesAction:null,i?e.showFundamentalsLastValueAction:null,this.actions.alignLabels].filter(Boolean)}))}return t.push(h(this._pane.chart())),this._options.countdownEnabled&&t.push(e.showCountdown),this._options.currencyConversionEnabled&&t.push(e.showCurrency),this._options.unitConversionEnabled&&t.push(e.showUnit),this._pane.chart().model().crossHairSource().isMenuEnabled()&&t.push(e.addPlusButton),
!TradingView.onWidget()&&m.enabled("show_chart_property_page")&&m.enabled("chart_property_page_scales")&&e.scalesProperties&&t.push(new l,e.scalesProperties),t}setSizeAndOffset(e,t){if(e.w<0||e.h<0)throw new Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(e));this._size.equals(e)||(this._size=e,this._canvasBinding.resizeCanvas({width:e.w,height:e.h}),this._topCanvasBinding.resizeCanvas({width:e.w,height:e.h}),this._cell.style.width=e.w+"px",this._cell.style.height=e.h+"px",this._cell.style.minWidth=e.w+"px"),this._offset!==t&&(this._offset=t,this._cell.style.left=t+"px")}getWidth(){return this._size.w}update(){}hardResetCanvas(){null!==this._size&&(c(this._canvasBinding,this._size),c(this._topCanvasBinding,this._size))}_isMainPane(){return this._pane.state().containsMainSeries()}restoreDefaultCursor(){this.setCursor("")}setCursor(e){var t="";"grabbing"!==e&&"ns-resize"!==e||(t="price-axis--cursor-"+e),this._currentCursorClassName!==t&&(this._currentCursorClassName&&this._cell.classList.remove(this._currentCursorClassName),t&&this._cell.classList.add(t),this._currentCursorClassName=t,this._cell.style.cursor)}axisInfo(){return this._axisInfo}}function v(e){var t=new d(e);return function(e,i){return isNumber(i)&&!e.isLog()?t.format(i):""}}var S=v(4);e.exports={PriceAxisWidget:g,scaleRatioForContextMenuTransformer:v}},26377:(e,t,i)=>{"use strict";i.d(t,{ActionBinder:()=>r});class r{constructor(e,t,i,r,s=null){this._property=t,this._undoModel=i,this._undoText=r,this._action=e,this.setValue(t.value()),t.subscribe(this,this._propertyChanged),null!==s?e.update({onExecute:s.bind(this)}):e.update({onExecute:this._onActionCallback.bind(this)})}destroy(){this._property.unsubscribe(this,this._propertyChanged)}value(){return this._action.isChecked()}setValue(e){this._action.update({checked:Boolean(e)})}_onActionCallback(){this._undoModel.setProperty(this._property,this.value(),this._undoText)}_propertyChanged(e){this.setValue(e.value())}}},96155:(e,t,i)=>{"use strict";i.d(t,{isCustomStudy:()=>s});const r={LinearRegression:!0,PivotPointsHighLow:!0,VbPSessions:!0,VbPFixed:!0,ZigZag:!0,PivotPointsStandard:!0,VbPVisible:!0};function s(e){return e in r}},7767:(e,t,i)=>{"use strict";i.d(t,{MetaInfoHelper:()=>p});var r=i(16282),s=i(84234),n=i.n(s),o=i(55782),a=i(31565),l=i(87380);const c=["first_visible_bar_time","last_visible_bar_time"];function u(e){return!e.groupId&&!e.isHidden&&!c.includes(e.id)}var d=i(96155);const h=(0,l.getLogger)("Platform.GUI.PropertyDialog.Indicators.MetaInfo");class p{constructor(e){this._metaInfo=e}hasUserEditableInputs(){return this._metaInfo.inputs.some(u)}getUserEditableInputs(){return this._metaInfo.inputs.filter(u)}hasUserEditableProperties(){return n().isScriptStrategy(this._metaInfo)}hasUserEditableStyles(){const e=this._metaInfo;return e.plots.length>0||void 0!==e.bands||void 0!==e.filledAreas||(0,d.isCustomStudy)(e.shortId)||n().isScriptStrategy(this._metaInfo)||Object.values(e.graphics).some(e=>void 0!==e)}getUserEditablePlots(){const e=new Set,t=this._metaInfo
;return t.plots.filter(i=>{if((0,o.isColorerPlot)(i)||(0,o.isTextColorerPlot)(i)||(0,o.isDataOffsetPlot)(i)||(0,o.isOhlcColorerPlot)(i)||(0,o.isAlertConditionPlot)(i))return!1;if((0,o.isOhlcPlot)(i)){const s=i.target;if(e.has(s))return!1;e.add(s);const n=(0,r.ensureDefined)(t.ohlcPlots);return!(0,r.ensureDefined)(n[s]).isHidden}{const e=t.styles?t.styles[i.id]:void 0;return void 0===e||!e.isHidden}})}hasUserEditableOptions(){return this.hasUserEditableInputs()||this.hasUserEditableProperties()||this.hasUserEditableStyles()}getStrategyProperties(){const e=this._metaInfo,t=e.inputs.filter(m),i={..._};for(const r of t){const t=r.internalID;i[t]=r,_.hasOwnProperty(t)||h.logWarn(`Unknown strategy input internal id ${t} in ${e.fullId}`)}return(0,a.clone)(i)}}const _={currency:void 0,backtest_fill_limits_assumption:void 0,calc_on_every_tick:void 0,calc_on_order_fills:void 0,commission_value:void 0,commission_type:void 0,initial_capital:void 0,pyramiding:void 0,slippage:void 0,default_qty_type:void 0,default_qty_value:void 0,margin_long:void 0,margin_short:void 0};function m(e){return"strategy_props"===e.groupId}},60744:(e,t,i)=>{"use strict";i.d(t,{showMarketOpenStatusProperty:()=>o,restoreShowMarketOpenStatusProperty:()=>a});var r=i(64297),s=i(42098);function n(){return s.getBool("Chart.ShowMarketOpenStatus",!0)}const o=(0,r.createPrimitiveProperty)(n());function a(){o.setValue(!0),s.remove("Chart.ShowMarketOpenStatus")}s.onSync.subscribe(null,()=>o.setValue(n())),o.subscribe(null,()=>s.setValue("Chart.ShowMarketOpenStatus",o.value()))},17442:(e,t,i)=>{"use strict";i.d(t,{marketStatusText:()=>s});var r=i(5295);function s(e){const t=e.value();if(null!==t){const e=r.titleMap.get(t);if(void 0!==e)return e}return""}},55471:(e,t,i)=>{"use strict";i.d(t,{isBats:()=>h,firstReplacedByBatsExchange:()=>p,isEod:()=>_,isDelay:()=>m,witoutRealtime:()=>f,isTickByTick:()=>g,isDelayForGuest:()=>v,isDelayWithoutMarketAgreement:()=>S,getExchange:()=>y});var r=i(16282),s=i(73715),n=i.n(s),o=i(5803),a=i(3851),l=i(97786);const c=["DJ","CBOE","JSE"],u=["NZX"],d=["ICESG"];function h(e){return n().hasBatsSymbols(e.full_name)}function p(e){const t=n().getExchanges(e.pro_name),i=n().getExchanges(e.full_name);for(let e=0;e<i.length;++e)if("BATS"===i[e].toUpperCase())return t[e];return null}function _(e,t){return n().hasEodSymbols(e.full_name)||t===l.STATUS_EOD}function m(e){return void 0!==e&&e>0}function f(e){return"index"===e.type&&c.includes(e.listed_exchange)||"futures"===e.type&&u.includes(e.listed_exchange)}function g(e,t){return!((0,a.enabled)(o.ProductFeatures.TICK_BY_TICK_PUSH_DATA)||m(e.delay)||_(e,t)||function(e){return"bitcoin"===e.type||"crypto"===e.type}(e))}function v(e,t){return t.listed_exchange===e&&!window.is_authenticated}function S(e){return d.includes(e.listed_exchange)}async function y(e){{const t=(0,r.ensureDefined)(window.pro);await new Promise(e=>{t.runOrUpdate(e)});const i=t.getProduct(function(e){return"exchange-"+e.pro_perm}(e)),s=function(e){let t;{if(!window.pro)throw new Error("Pro module not defined")
;const i=window.pro.getProductsByType(window.pro.PRODUCT_TYPES.exchange);t=i.find(t=>Boolean(t.included_exchanges&&t.included_exchanges.includes(e)))}return t||null}(i.exchange||"");return s&&"cme-full"===s.exchange?i:s||i}}},5295:(e,t,i)=>{"use strict";i.d(t,{iconMap:()=>A,classNameMap:()=>k,tooltipMap:()=>D,titleMap:()=>R,titleColorMap:()=>N,marketStatusDescription:()=>O,countdownFnMap:()=>W,actionMap:()=>U});var r=i(93669),s=i(20220),n=i(75394),o=i(5161),a=i(9658),l=i(98822),c=i(34632),u=i(54276),d=i(80910),h=i(19406),p=i(34104);const _=(0,s.t)("Market open"),m=(0,s.t)("Pre-market"),f=(0,s.t)("Post-market"),g=(0,s.t)("Market closed"),v=(0,s.t)("Holiday"),S=(0,s.t)("All's well — Market is open."),y=(0,s.t)("Morning. Market is open for pre-market trading."),b=(0,s.t)("Evening. Market is open for post-market trading."),w=(0,s.t)("Time for a walk — this market is closed."),P=(0,s.t)("Market is currently on holiday. Lucky them."),C=(0,s.t)("less than 1 minute"),T=(0,s.t)("{days} and {hours}"),x=(0,s.t)("{hours} and {minutes}"),I=(0,s.t)("Market opens in {remainingTime}."),L=(0,s.t)("Market closes in {remainingTime}."),M=(0,s.t)("It'll go to post-market trading in {remainingTime}."),E=(0,s.t)("It'll open for pre-market trading in {remainingTime}."),A=new Map([["market",new Map([["small",o],["large",a]])],["pre_market",new Map([["small",d],["large",h]])],["post_market",new Map([["small",c],["large",u]])],["out_of_session",new Map([["small",n],["large",n]])],["holiday",new Map([["small",l],["large",l]])]]),k=new Map([["market",p.marketStatusOpen],["pre_market",p.marketStatusPre],["post_market",p.marketStatusPost],["out_of_session",p.marketStatusClose],["holiday",p.marketStatusHoliday]]),D=new Map([["market",_],["pre_market",m],["post_market",f],["out_of_session",g],["holiday",v]]),R=new Map([["market",_],["pre_market",m],["post_market",f],["out_of_session",g],["holiday",v]]),N=new Map([["market",r.colorsPalette["color-market-open"]],["pre_market",r.colorsPalette["color-pre-market"]],["post_market",r.colorsPalette["color-post-market"]],["out_of_session",r.colorsPalette["color-market-closed"]],["holiday",r.colorsPalette["color-market-holiday"]]]),O={market:S,pre_market:y,post_market:b,out_of_session:w,holiday:P};function V(e){return(0,s.t)("{number} minute",{plural:"{number} minutes",count:e}).format({number:e.toString()})}function B(e){return(0,s.t)("{number} hour",{plural:"{number} hours",count:e}).format({number:e.toString()})}function F(e){const t=Math.floor(e/86400),i=Math.floor((e-86400*t)/3600),r=Math.floor((e-86400*t-3600*i)/60);return 0===t&&0===i&&0===r?C:t>0?T.format({days:(n=t,(0,s.t)("{number} day",{plural:"{number} days",count:n}).format({number:n.toString()})),hours:B(i)}):i>0?x.format({hours:B(i),minutes:V(r)}):V(r);var n}const W={market:e=>("post_market"===e.status?M:L).format({remainingTime:F(e.remainingSeconds)}),pre_market:e=>I.format({remainingTime:F(e.remainingSeconds)}),post_market:e=>L.format({remainingTime:F(e.remainingSeconds)}),out_of_session:e=>("pre_market"===e.status?E:I).format({
remainingTime:F(e.remainingSeconds)}),holiday:e=>("pre_market"===e.status?E:I).format({remainingTime:F(e.remainingSeconds)})},U=new Map([["market",null],["pre_market",null],["post_market",null],["out_of_session",null],["holiday",null]])},63951:(e,t,i)=>{"use strict";i.d(t,{parseIntervalValue:()=>l,intervalIsSupported:()=>c,canShowSpreadActions:()=>u,globalKeypressMatches:()=>d});var r=i(22842),s=i(19453),n=i(52946),o=i(2459),a=i(56598);new RegExp("^"+a.types.QUANDL,"i");function l(e){let t;t=/^[,\s]*(^[1-9][0-9]*)?\s*([hdwmsr]?)\s*$/i;const i=t.exec(e)||[],r=~~i[1],s=i[2]&&i[2].toUpperCase()||null,n={qty:!r&&s?1:r,unit:s};return n.error=!r&&!s,n.intraday=!(n.error||n.unit&&"H"!==n.unit&&"S"!==n.unit&&"T"!==n.unit),n}function c(e){if(r.enabled("allow_supported_resolutions_set_only")){const t=o.Interval.normalize(e);return null!==t&&(0,s.isAvailable)(t)}{const t=l(e);if(t.error)return!1;if(t.intraday)return n.linking.intraday.value();{const e=n.linking.supportedResolutions.value();return!e||null!==t.unit&&!!~e.indexOf(t.unit)}}}function u(){let e=!1;return e="cme"!==window.TradingView.widgetCustomer&&"bovespa"!==window.TradingView.widgetCustomer,e}function d(e){if(e.ctrlKey)return!1;if(e.metaKey)return!1;if(!e.charCode)return!1;if(!e.which||e.which<=32)return!1;if(null!==e.target&&/^(input|textarea)$/i.test(e.target.tagName))return!1;{const e=i.c[87840];if(e&&e.exports.TVOldDialogs.modalDialog)return!1;const t=i.c[58530];if(t&&t.exports.isOpenedModals())return!1}return!0}},60780:(e,t,i)=>{"use strict";function r(){return Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(88278),i.e(32795),i.e(52802),i.e(33996),i.e(94595),i.e(94269),i.e(87936),i.e(55442),i.e(26992),i.e(96271),i.e(93228),i.e(57373),i.e(25913),i.e(63660),i.e(28099),i.e(73935),i.e(43424),i.e(1529),i.e(36982),i.e(27420),i.e(9881),i.e(45080),i.e(38676),i.e(9622),i.e(27274),i.e(9394),i.e(73715),i.e(59963),i.e(12503),i.e(19453),i.e(20356),i.e(52146),i.e(38140),i.e(807),i.e(5131),i.e(80208),i.e(39998),i.e(63347),i.e(21754)]).then(i.bind(i,16659))}i.d(t,{loadNewSymbolSearch:()=>r})},6493:(e,t,i)=>{"use strict";i.r(t),i.d(t,{copyToClipboardImageOfChart:()=>s,getImageOfChartSilently:()=>n,copyToClipboardClientScreenshot:()=>o,downloadClientScreenshot:()=>a});const r=()=>Promise.all([i.e(53617),i.e(54389)]).then(i.bind(i,83118));function s(e,t={}){return r().then(i=>i.copyToClipboardImageOfChart(e,t))}function n(e,t={}){return r().then(i=>i.getImageOfChartSilently(e,t))}function o(e){return r().then(t=>t.copyToClipboardClientScreenshot(e))}function a(e){return r().then(t=>t.downloadClientScreenshot(e))}},20233:(e,t,i)=>{"use strict";i.d(t,{takeChartSnapshotPromise:()=>o,takeChartSnapshot:()=>a,makeSnapshotRequest:()=>l});i(68421),i(20220);var r=i(22842),s=i(30060),n=i(85864);function o(e,t={}){return new Promise((i,r)=>{a(e,i,r,t)})}async function a(e,t,i,r={}){var s;const n=new FormData;if(void 0!==r.previews)for(const e of r.previews)n.append("previews[]",e);void 0!==r.cme&&n.append("cme",String(r.cme)),void 0!==r.wl&&n.append("wl",String(r.wl)),
void 0!==r.onWidget&&n.append("onWidget",String(r.onWidget)),r.isReport&&n.append("isReport",String(r.isReport)),r.asyncSave&&n.append("asyncSave",String(r.asyncSave));const o=window.urlParams;o&&o.locale&&n.append("language",o.locale);const a=e.activeChartWidget.value(),c=a.widgetCustomer();void 0!==c&&n.append("customer",c);let u=a.properties().childs().timezone.value();if("exchange"===u&&(u=(null===(s=a.model().mainSeries().symbolInfo())||void 0===s?void 0:s.timezone)||u),n.append("timezone",u),n.append("symbol",a.model().mainSeries().symbol()),r.sendClientImage){const t=await e.clientSnapshot(),i=await new Promise(e=>t.toBlob(e));null!==i&&n.append("preparedImage",i)}else n.append("images",JSON.stringify(e.images(),(e,t)=>t instanceof HTMLCanvasElement?null:t));l(n,t,i,r)}async function l(e,t,o,a={}){const l=r.enabled("charting_library_base")?a.snapshotUrl||"https://www.tradingview.com/snapshot/":"/snapshot/";try{const r=await(0,n.fetch)(l,{body:e,method:"POST",credentials:"same-origin"}),c=await r.text();if(r.ok)t(c);else{if("suspicious_chart_snapshots_error"===c){const e=window.t("Snapshot seems to contain prohibited content. Please contact {start_link}our support team{end_link} if you have received this by mistake.").format({start_link:'<a class="tv-dialog__link js-send-report-link" href="#" data-issue-type="other">',end_link:"</a>"});a.onInvalidSnapshotImage&&a.onInvalidSnapshotImage();return(0,s.createErrorDialog)({title:window.t("Your snapshot was flagged as suspicious"),content:e,btnType:"danger"}).then(e=>{e.on("afterOpen",()=>{i.e(1484).then(i.bind(i,27017)).then(({bugDialogCreationHandler:t})=>{t(),e.$el.find(".js-send-report-link").click(()=>{e.close()})})}),e.open()})}o()}}catch(e){o()}}},99909:(e,t,i)=>{"use strict";i.d(t,{TextImageCachesContainer:()=>o});var r=i(16282),s=i(61991),n=i(10175);class o extends s.AbstractMapContainer{constructor(e){super(),this._maxSize=e,this._keysQueue=[]}get(e){const{fontSize:t,text:i,align:r,lineSpacing:o=0}=e;if(!i||!t||!r)return null;const a=(0,s.getDefault3)(this._map,o,r,t,new Map);let l=a.get(i);return void 0!==l||(this._size>=this._maxSize?this._deleteFirstKey():++this._size,this._keysQueue.push([t,r,o,i]),l=new n.TextImageCache(i,e.bold,e.italic,e.font,t,r,o),a.set(i,l)),l}_deleteFirstKey(){const e=this._keysQueue.shift(),[t,i,s,n]=e,o=(0,r.ensureDefined)(this._map.get(s)),a=(0,r.ensureDefined)(o.get(i)),l=(0,r.ensureDefined)(a.get(t));l.delete(n),0===l.size&&a.delete(t),0===a.size&&o.delete(i),0===o.size&&this._map.delete(s)}}},10175:(e,t,i)=>{"use strict";i.d(t,{HorizontalAlign:()=>r,VerticalAlign:()=>s,TextImageCache:()=>c});var r,s,n=i(16282),o=i(32022),a=i(14900);!function(e){e.Left="left",e.Right="right",e.Center="center"}(r||(r={})),function(e){e.Top="top",e.Bottom="bottom",e.Middle="middle"}(s||(s={}));const l=(0,a.createDisconnectedCanvas)(document,new a.Size(0,0),1);class c{constructor(e,t,i,r,s,a="center",c=0){this._lines=e.split(/[^\S\r\n]*(?:\r\n|\r|\n)/),this._font=function(e,t,i,r){return(0,o.makeFont)(r,i,`${e?"bold ":""}${t?"italic ":""}`)
}(t,i,r,s),this._fontSize=s,this._verticalPadding=~~(s/6),this._textAlign=a,this._lineSpacing=c;const u=(0,n.ensureNotNull)(l.getContext("2d"));u.font=this._font;let d=0;for(const e of this._lines){const t=u.measureText(e).width;d=Math.max(d,t)}this.textImageWidth=d+1,this.textImageHeight=this._lines.length*s+(this._lines.length-1)*this._lineSpacing+this._verticalPadding}paintTo(e,t,i,r,s,n,o){e.save();const l=t.pixelRatio;let c;switch(e.translate(Math.round(function(e,t,i){let r=e;switch(t){case"left":break;case"right":r-=i;break;case"center":r-=i/2}return Math.round(r)}(r,n,this.textImageWidth)*l),Math.round(function(e,t,i){let r=e;switch(t){case"top":break;case"bottom":r-=i;break;case"middle":r-=i/2}return Math.round(r)}(s,o,this.textImageHeight)*l)),e.textBaseline="top",e.font=this._font,e.fillStyle=i,this._textAlign){case"left":c=0,e.textAlign="left";break;case"right":c=this.textImageWidth-1,e.textAlign="right";break;default:c=this.textImageWidth/2,e.textAlign="center"}let u=this._verticalPadding;(0,a.drawScaled)(e,l,()=>{for(const t of this._lines)e.fillText(t,c,u),u+=this._fontSize,u+=this._lineSpacing}),e.restore()}}},81319:(e,t,i)=>{"use strict";i.d(t,{TimeAxisWidget:()=>w});var r=i(16282),s=i(32022),n=i(10595),o=i(14900),a=i(94420),l=i(31565),c=i(54567),u=i(39304),d=i(96276),h=i.n(d),p=i(11190),_=i(84434),m=i(54281),f=i(24940),g=i(68793),v=i(29098),S=i(17515),y=i(88444);i(46596);const b={contextMenuEnabled:!0,timezoneMenuEnabled:!0,pressedMouseMoveScale:!0};class w{constructor(e,t,i,r,s){this._rendererOptions=null,this._onLabelHovered=new(h()),this._mousedown=!1,this._currentCursorClassName="invalid",this._options=(0,l.merge)((0,l.clone)(b),t||{}),this.chart=e,this._properties=e.properties().childs().scalesProperties,this._element=document.createElement("tr"),this._backgroundBasedTheme=s;const a=()=>this.backgroundColor(),c=()=>{throw new Error("Time axis does not support real price scales")},u={titlesProvider:i,stubContextMenuProvider:(e,t)=>{const i=this.getContextMenuActions(!0);let s=r(e,t);if(s[s.length-1]===this.chart.actions().scalesProperties){const e=[new m.Separator].concat(i);Array.prototype.splice.apply(s,[s.length-2,0,...e])}else s.push(new m.Separator),s=s.concat(i);return s},backgroundBasedTheme:s,rendererOptionsProvider:e.model().model().rendererOptionsProvider(),getBackgroundTopColor:a,getBackgroundBottomColor:a,showHorizontalBorder:!0};this._lhsStubContainer=new p.PriceAxisesContainer(this._properties,"left",c,u,this._options.priceAxisLabelsOptions),this._lhsStubContainer.onLabelHovered().subscribe(this,(e,t)=>{this._onLabelHovered.fire(e,t)}),this._rhsStubContainer=new p.PriceAxisesContainer(this._properties,"right",c,u,this._options.priceAxisLabelsOptions),this._rhsStubContainer.onLabelHovered().subscribe(this,(e,t)=>{this._onLabelHovered.fire(e,t)}),this._element.appendChild(this._lhsStubContainer.getElement()),this._cell=document.createElement("td"),this._element.appendChild(this._cell),this._cell.classList.add("chart-markup-table","time-axis"),this._cell.style.height="25px",
this._dv=document.createElement("div"),this._dv.style.width="100%",this._dv.style.height="100%",this._dv.style.position="relative",this._dv.style.overflow="hidden",this._cell.appendChild(this._dv),this._canvasConfiguredHandler=()=>this.chart.model().model().lightUpdate(),this._canvasBinding=(0,o.createBoundCanvas)(this._dv,new o.Size(16,16)),this._canvasBinding.subscribeCanvasConfigured(this._canvasConfiguredHandler);const d=this._canvasBinding.canvas;d.style.position="absolute",d.style.zIndex="1",d.style.left="0",d.style.top="0",this._topCanvasConfiguredHandler=()=>this.chart.model().model().lightUpdate(),this._topCanvasBinding=(0,o.createBoundCanvas)(this._dv,new o.Size(16,16)),this._topCanvasBinding.subscribeCanvasConfigured(this._topCanvasConfiguredHandler);const f=this._topCanvasBinding.canvas;f.style.position="absolute",f.style.zIndex="2",f.style.left="0",f.style.top="0",this._element.appendChild(this._rhsStubContainer.getElement()),this.restoreDefaultCursor(),this.update(),this._minVisibleSpan=_.MINUTE_SPAN,this._mouseEventHandler=new n.MouseEventHandler(this._topCanvasBinding.canvas,this,{treatVertTouchDragAsPageScroll:!0,treatHorzTouchDragAsPageScroll:!1}),this.size=new o.Size(0,0)}destroy(){this._mouseEventHandler.destroy(),this._topCanvasBinding.unsubscribeCanvasConfigured(this._topCanvasConfiguredHandler),this._topCanvasBinding.destroy(),this._canvasBinding.unsubscribeCanvasConfigured(this._canvasConfiguredHandler),this._canvasBinding.destroy(),this._rhsStubContainer.onLabelHovered().unsubscribeAll(this),this._lhsStubContainer.onLabelHovered().unsubscribeAll(this),this._lhsStubContainer.destroy(),this._rhsStubContainer.destroy(),this.chart.properties().childs().paneProperties.childs().background.unsubscribeAll(this)}setCursor(e){let t="";"grabbing"!==e&&"ew-resize"!==e||(t="time-axis--cursor-"+e),this._currentCursorClassName!==t&&(this._currentCursorClassName&&this._cell.classList.remove(this._currentCursorClassName),t&&this._cell.classList.add(t),this._currentCursorClassName=t,this._cell.style.cursor)}restoreDefaultCursor(){this.setCursor("")}getElement(){return this._element}optimalHeight(){const e=this.rendererOptions();return Math.ceil(e.borderSize+e.offsetSize+e.fontSize+e.paddingTop+e.paddingBottom+e.labelBottomOffset)}setSizes(e,t,i){this.size&&this.size.equals(e)||(this.size=e,this._canvasBinding.resizeCanvas({width:e.w,height:e.h}),this._topCanvasBinding.resizeCanvas({width:e.w,height:e.h}),this._cell.style.width=e.w+"px",this._cell.style.height=e.h+"px"),this._lhsStubContainer.setSizes(e.h,t),this._rhsStubContainer.setSizes(e.h,i)}hardResetCanvas(){this.size&&((0,o.hardResizeCanvas)(this._canvasBinding,this.size),(0,o.hardResizeCanvas)(this._topCanvasBinding,this.size))}rendererOptions(){if(!this._rendererOptions||this._rendererOptions.fontSize!==this.fontSize()){const e=this.fontSize();this._rendererOptions={borderSize:1,offsetSize:5,fontSize:e,font:(0,s.makeFont)(e,u.CHART_FONT_FAMILY,""),widthCache:new c.TextWidthCache,paddingTop:3*e/12,paddingBottom:3*e/12,paddingHorizontal:9*e/12,
labelBottomOffset:4*e/12}}return this._rendererOptions}backgroundColor(){return this.chart.model().model().backgroundColor().value()}lineColor(){return this._properties.childs().lineColor.value()}textColor(){return this._properties.childs().textColor.value()}fontSize(){return this._properties.childs().fontSize.value()}baseFont(){return(0,s.makeFont)(this.fontSize(),u.CHART_FONT_FAMILY)}baseBoldFont(){return(0,s.makeFont)(this.fontSize(),u.CHART_FONT_FAMILY,"","bold")}hasCanvas(e){return this._canvasBinding.canvas===e||this._topCanvasBinding.canvas===e}onLabelHovered(){return this._onLabelHovered}getScreenshotData(){return{content:this._canvasBinding.canvas.toDataURL(),canvas:this._canvasBinding.canvas,contentWidth:this.size.w,contentHeight:this.size.h,lhsStub:this._lhsStubContainer.getScreenshotData(),rhsStub:this._rhsStubContainer.getScreenshotData()}}getContextMenuActions(e){var t;const i=this.chart;i.updateActions();const r=i.actions(),s=[];if(e||s.push(r.timeScaleReset,new m.Separator),this._options.timezoneMenuEnabled&&s.push(r.applyTimeZone),s.push(r.sessionBreaks),!i.model().mainSeries().isDWM()){const e=null===(t=i.model())||void 0===t?void 0:t.mainSeries().symbolInfo();if(e){const t=i.model().mainSeries().properties().childs().sessionId,r=(e.subsessions||[]).filter(e=>!e.private).map(e=>new m.Action({label:(0,y.translateSessionDescription)(e.description),checkable:!0,checked:t.value()===e.id,statName:"SetSession",onExecute:()=>{i.model().setProperty(t,e.id,"Changed Session")}})),n=new m.Action({label:window.t("Session"),statName:"SetSession",subItems:r});s.push(n)}}return s}update(){if(!this.chart.hasModel())return;const e=this.chart.model().timeScale().marks();if(e){this._minVisibleSpan=_.YEAR_SPAN;for(const t of e)this._minVisibleSpan=Math.min(t.span,this._minVisibleSpan)}}updatePriceAxisStubs(){const e=this.chart.model().model(),t=this.chart.isMaximizedPane()?(0,r.ensureNotNull)(this.chart.maximizedPaneWidget()).state():e.paneForSource(e.mainSeries());if(!t)return;const i=e.priceScaleSlotsCount();this._lhsStubContainer.setScales([],i.left,t.leftPriceScales().length,i.left+i.right),this._rhsStubContainer.setScales([],i.right,t.rightPriceScales().length,i.left+i.right)}paint(e){if(e===a.InvalidationLevel.None)return;const t=(0,o.getContext2D)(this._topCanvasBinding.canvas);if(e>a.InvalidationLevel.Cursor){const i=(0,o.getContext2D)(this._canvasBinding.canvas),r=this._canvasBinding.pixelRatio;this.drawBackground(i,r),this.chart.hasModel()&&(this.drawBorder(i,r),this.drawTickMarks(i,r),this.drawBackLabels(i,r),this.drawCrossHairLabel(t,r)),this._lhsStubContainer.paintStubs(e),this._rhsStubContainer.paintStubs(e)}this.drawCrossHairLabel(t,this._topCanvasBinding.pixelRatio)}drawBackground(e,t){if((0,o.clearRect)(e,0,0,Math.ceil(this.size.w*t)+1,Math.ceil(this.size.h*t)+1,this.backgroundColor()),!this.chart.hasModel())return;const i=this.chart.model();if(!i.timeScale().isEmpty()){const r=i.model().selection().lineDataSources().reduce((e,t)=>{const i=t.timeAxisPoints();return 0===i.length?e:e.concat(i)},[])
;r.length>0&&this._hightlightBackground(e,r,t)}const r=i.model().crossHairSource();r.startMeasurePoint()&&this._hightlightBackground(e,r.measurePoints(),t)}drawBorder(e,t){e.save(),e.fillStyle=this.lineColor();const i=Math.max(1,Math.floor(this.rendererOptions().borderSize*t)),r=Math.ceil(this.size.w*t);e.fillRect(0,0,r+1,i),e.restore()}drawTickMarks(e,t){const i=this.chart.model().timeScale().marks();if(!i||0===i.length)return;let r=i.reduce((e,t)=>e.span>t.span?e:t,i[0]).span;r>30&&r<40&&(r=30),e.save(),e.strokeStyle=this.lineColor();const s=this.rendererOptions(),n=s.borderSize+s.offsetSize+s.paddingTop+s.fontSize/2;e.textAlign="center",e.textBaseline="middle",e.fillStyle=this.textColor(),(0,o.drawScaled)(e,t,()=>{e.font=this.baseFont();for(let t=0;t<i.length;t++){const s=i[t];s.span<r&&e.fillText(s.label,s.coord,n)}e.font=this.baseBoldFont();for(let t=0;t<i.length;t++){const s=i[t];s.span>=r&&e.fillText(s.label,s.coord,n)}}),e.restore()}drawBackLabels(e,t){var i;e.save();const r=new Set,s=this.chart.model().model();let n=s.dataSources();const o=s.selection().allSources();for(const e of o)r.add(e);s.hoveredSource()&&r.add(s.hoveredSource());for(const e of s.sourcesBeingMoved())r.add(e);const a=s.customSourceBeingMoved();null!==a&&r.add(a);const l=null!==(i=s.lineBeingEdited())&&void 0!==i?i:s.lineBeingCreated();l&&r.add(l),r.add(this.chart.model().crossHairSource()),n=n.concat(s.customSources());const c=this.rendererOptions();for(let i=0;i<n.length;i++){const s=n[i];if(!r.has(s)&&s.timeAxisViews){const i=s.timeAxisViews();if(i)for(let r=0;r<i.length;r++)i[r].renderer().draw(e,c,t)}}e.restore()}drawCrossHairLabel(e,t){var i;e.save(),e.clearRect(0,0,Math.ceil(this.size.w*t)+1,Math.ceil(this.size.h*t)+1);const r=this.chart.model().model(),s=[],n=null!==(i=r.lineBeingEdited())&&void 0!==i?i:r.lineBeingCreated();if(n&&n.timeAxisViews){const e=n.timeAxisViews();e&&e.length&&s.push(e)}const o=r.customSourceBeingMoved();this._addViewsOrMaxMin(null===o?[]:[o],s),this._addViewsOrMaxMin(r.sourcesBeingMoved(),s),this._addViewsOrMaxMin(r.selection().allSources(),s);const a=r.hoveredSource();if(a&&(0,g.isDataSource)(a)&&!r.selection().isSelected(a)&&a.timeAxisViews){const e=a.timeAxisViews();e&&e.length&&s.push(e)}const l=r.crossHairSource(),c=l.timeAxisViews&&l.timeAxisViews();c&&c.length&&s.push(c);const u=this.rendererOptions();for(const i of s)for(const r of i)e.save(),r.renderer().draw(e,u,t),e.restore();e.restore()}mouseDownEvent(e){this._mouseDownOrTouchStartEvent(e)}touchStartEvent(e){this._mouseOrTouchEnterEvent(e),this._mouseDownOrTouchStartEvent(e)}mouseDownOutsideEvent(){this._zoomAvailable()&&this._mousedown&&(this._mousedown=!1,this.chart.model().endScaleTime(),this.restoreDefaultCursor())}pressedMouseMoveEvent(e){this._pressedMouseOrTouchMoveEvent(e)}touchMoveEvent(e){this._pressedMouseOrTouchMoveEvent(e)}mouseUpEvent(e){this._mouseUpOrTouchEndEvent(e)}touchEndEvent(e){this._mouseUpOrTouchEndEvent(e),this._mouseOrTouchLeaveEvent(e)}contextMenuEvent(e){this._contextMenuOrTouchContextMenuEvent(e)}
touchContextMenuEvent(e){this._contextMenuOrTouchContextMenuEvent(e)}mouseEnterEvent(e){this._mouseOrTouchEnterEvent(e)}mouseLeaveEvent(e){this._mouseOrTouchLeaveEvent(e)}mouseDoubleClickEvent(e){this._mouseDoubleClickOrDoubleTapEvent(e)}doubleTapEvent(e){this._mouseDoubleClickOrDoubleTapEvent(e)}_hightlightBackground(e,t,i){const r=this.chart.model().timeScale();let s=t[0].index,n=t[0].index;for(let e=1;e<t.length;e++)s=Math.min(s,t[e].index),n=Math.max(n,t[e].index);const a=Math.floor(r.indexToCoordinate(s)*i),l=Math.ceil(r.indexToCoordinate(n)*i);(0,o.fillRect)(e,a,0,l-a,Math.ceil(this.size.h*i)+1,f.axesHighlightColor)}_addViewsOrMaxMin(e,t){if(e.length<=1){for(const i of e)if(i.timeAxisViews){const e=i.timeAxisViews();e&&e.length&&t.push(e)}}else t.push(this._minMaxViews(e))}_minMaxViews(e){const t=[];let i=1/0,r=-1/0,s=null,n=null;for(const t of e)if(t.timeAxisViews){const e=t.timeAxisViews();if(e&&e.length)for(let t=0;t<e.length;++t){const o=e[t],a=o.coordinate();a>=r&&(r=a,n=o),a<=i&&(i=a,s=o)}}return n&&t.push(n),s&&t.push(s),t}_zoomAvailable(){return!this.chart.model().timeScale().isEmpty()&&this.chart.model().model().zoomEnabled()&&this._options.pressedMouseMoveScale}_mouseDownOrTouchStartEvent(e){if(this._mousedown||!this._zoomAvailable())return;this._mousedown=!0;const t=this.chart.model();t.timeScale().isEmpty()||t.startScaleTime(e.localX)}_pressedMouseOrTouchMoveEvent(e){this._zoomAvailable()&&this.chart.model().scaleTimeTo(e.localX)}_mouseUpOrTouchEndEvent(e){this._zoomAvailable()&&(this._mousedown=!1,this.chart.model().endScaleTime(),this.restoreDefaultCursor())}_contextMenuOrTouchContextMenuEvent(e){this._options.contextMenuEnabled&&this._createContextMenu().then(t=>t.show(e))}_mouseOrTouchEnterEvent(e){this._zoomAvailable()&&this.setCursor("ew-resize")}_mouseOrTouchLeaveEvent(e){this.restoreDefaultCursor()}_mouseDoubleClickOrDoubleTapEvent(e){(0,v.trackEvent)("GUI","Double click time scale"),this.chart.model().resetTimeScale()}_createContextMenu(){return S.ContextMenuManager.createMenu(this.getContextMenuActions(),{statName:"TimeScaleContextMenu"})}}},27366:(e,t,i)=>{"use strict";i.d(t,{TimingsMeter:()=>d});var r=i(87380),s=i(94420);const n=(0,r.getLogger)("TimingsMeter.Service"),o=(0,r.getLogger)("TimingsMeter.Stats",{maxCount:160});function a(){return{[s.InvalidationLevel.None]:{count:0,lastTime:0,maxTime:0,totalTime:0},[s.InvalidationLevel.Cursor]:{count:0,lastTime:0,maxTime:0,totalTime:0},[s.InvalidationLevel.Light]:{count:0,lastTime:0,maxTime:0,totalTime:0},[s.InvalidationLevel.Full]:{count:0,lastTime:0,maxTime:0,totalTime:0}}}function l(e,t){e.lastTime=t,e.totalTime+=t,++e.count,t>e.maxTime&&(e.maxTime=t)}function c(e){return e.toFixed(2)}function u(e){const t=e.count;if(0===t)return"no events";const i=e.totalTime/t,r=c(e.maxTime);return`count=${t}, last=${c(e.lastTime)}, max=${r}, avg=${c(i)}`}class d{constructor(e){this._waitDrawStartTime=-1,this._startDrawTime=-1,this._currentDrawLevel=s.InvalidationLevel.Full,this._currentDrawItems=a(),this._currentWaitingItem={count:0,lastTime:0,
maxTime:0,totalTime:0},this._dumpTimingsStatsInterval=0,this._logPrefix=`[${e}]`}destroy(){this.stopCollect()}startCollect(){0!==this._dumpTimingsStatsInterval&&(n.logWarn(this._logPrefix+" Multiple start detected"),this.stopCollect()),this._clearCurrentState(),this._dumpTimingsStatsInterval=setInterval(this._dumpTimingsStats.bind(this),15e3),n.logNormal(this._logPrefix+" Collecting started")}stopCollect(){0!==this._dumpTimingsStatsInterval&&(clearInterval(this._dumpTimingsStatsInterval),this._dumpTimingsStatsInterval=0,n.logNormal(this._logPrefix+" Collecting stopped. Dumping last state..."),this._dumpTimingsStats())}startWaitingDraw(){this._waitDrawStartTime=window.performance.now()}startDraw(e){this._startDrawTime=window.performance.now(),this._currentDrawLevel=e}stopDraw(){const e=window.performance.now();if(-1===this._startDrawTime||-1===this._waitDrawStartTime)return;const t=this._startDrawTime-this._waitDrawStartTime;l(this._currentWaitingItem,t),this._waitDrawStartTime=-1;const i=e-this._startDrawTime;l(this._currentDrawItems[this._currentDrawLevel],i),this._startDrawTime=-1}_dumpTimingsStats(){const e=[this._logPrefix," awaiting:",u(this._currentWaitingItem),"; cursor:",u(this._currentDrawItems[s.InvalidationLevel.Cursor]),"; light:",u(this._currentDrawItems[s.InvalidationLevel.Light]),"; full:",u(this._currentDrawItems[s.InvalidationLevel.Full])].join("");o.logNormal(e),this._clearCurrentState()}_clearCurrentState(){this._currentDrawItems=a(),this._currentWaitingItem={count:0,lastTime:0,maxTime:0,totalTime:0}}}},8279:(e,t,i)=>{"use strict";i.d(t,{ToastsFactory:()=>r});class r{constructor(e,t){this._chartToastsPromise=null,this._resizerBridge=e,this._bottomToolbarOffsetHeightProvider=t}async getChartToasts(){return null!==this._chartToastsPromise||(this._chartToastsPromise=async function(){return Promise.all([Promise.all([i.e(49531),i.e(35507),i.e(84872),i.e(73935),i.e(28139),i.e(53088)]).then(i.bind(i,24715)),Promise.all([i.e(35507),i.e(64466),i.e(73935),i.e(28139),i.e(94291)]).then(i.bind(i,99037))]).then(e=>[e[0].ChartToasts,e[1].globalToasts])}().then(e=>{const t=e[0],i=e[1];return new t(this._resizerBridge,this._resizerBridge.container.value(),i,this._bottomToolbarOffsetHeightProvider())})),this._chartToastsPromise}}},91293:(e,t,i)=>{"use strict";i.d(t,{createTradeContext:()=>s});var r=i(16282);async function s(e,t){let i=NaN,s=NaN,n="";const o=e.proSymbol(),a=(e.symbolInfo()||{name:null}).name||o,l=e.priceScale();if(t){const r=e.firstValue();i=null!==r?l.coordinateToPrice(t,r):null,n=null!==i?e.formatter().format(i):""}const c=e.bars().last();null!==c&&(s=(0,r.ensure)(c.value[TradingView.CLOSE_PLOT]));return{symbol:o,displaySymbol:a,value:i,formattedValue:n,last:s,symbolInfoTradable:!!(e.symbolInfo()||{is_tradable:!1}).is_tradable}}},11377:(e,t,i)=>{"use strict";var r,s,n,o,a,l,c,u,d,h,p,_,m;i.r(t),i.d(t,{CONNECTSTATUSES:()=>r,ORDERTYPE:()=>s,SIDE:()=>n,ORDERSTATUS:()=>o,ORDERSTATUSFILTER:()=>a,PARENTTYPE:()=>l,BracketType:()=>c,TICKETFOCUS:()=>u,NOTIFICATION:()=>d,OrderOrPositionMessageType:()=>h,
AccountType:()=>p,DisconnectType:()=>_,PipValueType:()=>m}),function(e){e[e.CONNECTED=1]="CONNECTED",e[e.CONNECTING=2]="CONNECTING",e[e.DISCONNECTED=3]="DISCONNECTED",e[e.ERROR=4]="ERROR"}(r||(r={})),function(e){e[e.LIMIT=1]="LIMIT",e[e.MARKET=2]="MARKET",e[e.STOP=3]="STOP",e[e.STOPLIMIT=4]="STOPLIMIT"}(s||(s={})),function(e){e[e.BUY=1]="BUY",e[e.SELL=-1]="SELL"}(n||(n={})),function(e){e[e.CANCELED=1]="CANCELED",e[e.FILLED=2]="FILLED",e[e.INACTIVE=3]="INACTIVE",e[e.PLACING=4]="PLACING",e[e.REJECTED=5]="REJECTED",e[e.WORKING=6]="WORKING"}(o||(o={})),function(e){e[e.ALL=0]="ALL",e[e.CANCELED=1]="CANCELED",e[e.FILLED=2]="FILLED",e[e.INACTIVE=3]="INACTIVE",e[e.REJECTED=5]="REJECTED",e[e.WORKING=6]="WORKING"}(a||(a={})),function(e){e[e.ORDER=1]="ORDER",e[e.POSITION=2]="POSITION"}(l||(l={})),function(e){e[e.StopLoss=0]="StopLoss",e[e.TakeProfit=1]="TakeProfit",e[e.TrailingStop=2]="TrailingStop"}(c||(c={})),function(e){e[e.LIMITPRICE=1]="LIMITPRICE",e[e.STOPPRICE=2]="STOPPRICE",e[e.TAKEPROFIT=3]="TAKEPROFIT",e[e.STOPLOSS=4]="STOPLOSS"}(u||(u={})),function(e){e[e.ERROR=0]="ERROR",e[e.SUCCESS=1]="SUCCESS"}(d||(d={})),function(e){e.Information="information",e.Warning="warning",e.Error="error"}(h||(h={})),function(e){e.Demo="demo",e.Live="live"}(p||(p={})),function(e){e[e.LogOut=0]="LogOut",e[e.FailedRestoring=1]="FailedRestoring",e[e.Offline=2]="Offline",e[e.APIError=3]="APIError",e[e.TwoFactorRequired=4]="TwoFactorRequired",e[e.CancelAuthorization=5]="CancelAuthorization",e[e.TimeOutForAuthorization=6]="TimeOutForAuthorization",e[e.OauthError=7]="OauthError",e[e.BrokenConnection=8]="BrokenConnection"}(_||(_={})),function(e){e[e.None=0]="None",e[e.Pips=1]="Pips",e[e.Ticks=2]="Ticks"}(m||(m={}))},42258:(e,t,i)=>{"use strict";i.d(t,{tradingService:()=>n,waitTradingService:()=>o});var r=i(60531);const s={id:"TradingService"};function n(){return(0,r.hasService)(s)?(0,r.service)(s):null}function o(){return(0,r.waitServiceRegistered)(s)}},60185:(e,t,i)=>{"use strict";i.d(t,{WatchlistWithSubmenuAction:()=>f});var r=i(20220),s=i(11585),n=i(11877),o=i(5803),a=i(79200),l=i(54281),c=i(16282),u=i(80276);function d(e,t){return{...t,icon:u,statName:"AddToWatchlist",hotkeyHash:n.Modifiers.Alt+87,onExecute:()=>{window.runOrSignIn(()=>{var t;if(window.widgetbar){const i=null===(t=(0,c.ensureNotNull)(window.widgetbar.setPage("base")).widget("watchlist"))||void 0===t?void 0:t.widgetObject;if(!i)return;i.addSymbols([e.getSymbol()])}},{source:"add symbol to watchlist"})}}}var h=i(7434),p=i(88028),_=i(10786),m=i(22842);class f extends l.Action{constructor(e,t){super({...d(e,t),subItems:[new l.Loader]}),this._controller=new AbortController,this._hadSymbolOnInit=!1,this._isMobile=(0,_.isMobile)(),this._onRequest=null,this._chart=e,this._load()}updateLabel(e){this.update({label:(0,r.t)("Add {symbol} to Watchlist").format({symbol:e})})}request(){var e;this._hadSymbolOnInit=!1,this._isMobile=(0,_.isMobile)(),this.update({subItems:[new l.Loader]}),null===(e=this._onRequest)||void 0===e||e.call(this)}destroy(){super.destroy(),this._controller.abort(),
this._chart=null,this._onRequest=null,this._options={}}async _load(){const[e,t,c,d,_,f,g]=await Promise.all([Promise.resolve().then(i.t.bind(i,67294,19)),(0,h.initSymbolListService)(),Promise.all([i.e(45080),i.e(38676),i.e(59963),i.e(52146),i.e(807),i.e(80208),i.e(39998),i.e(38611),i.e(1026)]).then(i.bind(i,94176)),Promise.all([i.e(45080),i.e(38676),i.e(59963),i.e(52146),i.e(807),i.e(80208),i.e(39998),i.e(38611),i.e(1026)]).then(i.bind(i,40383)),Promise.all([i.e(23876),i.e(99459),i.e(69756),i.e(29448),i.e(37610),i.e(32795),i.e(63193),i.e(61212),i.e(76473),i.e(85597),i.e(43894),i.e(45266),i.e(33996),i.e(60700),i.e(87936),i.e(13940),i.e(55313),i.e(19843),i.e(68604),i.e(96637),i.e(52951),i.e(18277),i.e(43972),i.e(53617),i.e(10446),i.e(47607),i.e(97757),i.e(60959),i.e(63660),i.e(30209),i.e(20597),i.e(18078),i.e(56864),i.e(502),i.e(31629),i.e(46333),i.e(6767),i.e(23104),i.e(73935),i.e(45867),i.e(1529),i.e(19894),i.e(64011),i.e(9881),i.e(40953),i.e(45080),i.e(38676),i.e(38464),i.e(59963),i.e(91712),i.e(37703),i.e(52146),i.e(807),i.e(80208),i.e(33289),i.e(39998),i.e(25155),i.e(13066),i.e(38611),i.e(38012),i.e(3766),i.e(91196)]).then(i.bind(i,57952)),Promise.all([i.e(23876),i.e(99459),i.e(69756),i.e(29448),i.e(37610),i.e(32795),i.e(63193),i.e(61212),i.e(76473),i.e(85597),i.e(43894),i.e(45266),i.e(33996),i.e(60700),i.e(87936),i.e(13940),i.e(55313),i.e(19843),i.e(68604),i.e(96637),i.e(52951),i.e(18277),i.e(43972),i.e(53617),i.e(10446),i.e(47607),i.e(97757),i.e(60959),i.e(63660),i.e(30209),i.e(20597),i.e(18078),i.e(56864),i.e(502),i.e(31629),i.e(46333),i.e(6767),i.e(23104),i.e(73935),i.e(45867),i.e(1529),i.e(19894),i.e(64011),i.e(9881),i.e(40953),i.e(45080),i.e(38676),i.e(38464),i.e(59963),i.e(91712),i.e(37703),i.e(52146),i.e(807),i.e(80208),i.e(33289),i.e(39998),i.e(25155),i.e(13066),i.e(38611),i.e(38012),i.e(3766),i.e(91196)]).then(i.bind(i,39686)),Promise.all([i.e(23876),i.e(99459),i.e(69756),i.e(29448),i.e(37610),i.e(32795),i.e(63193),i.e(61212),i.e(76473),i.e(85597),i.e(43894),i.e(45266),i.e(33996),i.e(60700),i.e(87936),i.e(13940),i.e(55313),i.e(19843),i.e(68604),i.e(96637),i.e(52951),i.e(18277),i.e(43972),i.e(53617),i.e(10446),i.e(47607),i.e(97757),i.e(60959),i.e(63660),i.e(30209),i.e(20597),i.e(18078),i.e(56864),i.e(502),i.e(31629),i.e(46333),i.e(6767),i.e(23104),i.e(73935),i.e(45867),i.e(1529),i.e(19894),i.e(64011),i.e(9881),i.e(40953),i.e(45080),i.e(38676),i.e(38464),i.e(59963),i.e(91712),i.e(37703),i.e(52146),i.e(807),i.e(80208),i.e(33289),i.e(39998),i.e(25155),i.e(13066),i.e(38611),i.e(38012),i.e(3766),i.e(91196)]).then(i.bind(i,1780))]);if(this._controller.signal.aborted)return;const{store:v}=t;this._onRequest=()=>v.dispatch(c.getCustomWatchlistsThunk(null));const S=v.subscribe(()=>{if(!this._chart)return;const t=v.getState();if(null===_.getCustomListsState(t).timestamp)return;const i=this._chart.getSymbol(),c=_.getCustomLists(t),{activeSymbolList:h}=t,S=c.find(e=>e.id===h);this._hadSymbolOnInit||(this._hadSymbolOnInit=!!S&&S.symbols.includes(i))
;const y=m.enabled("multiple_watchlists")?c.filter(e=>e.id!==h).sort(f.sortComparator):[],b=(S?[S,...y]:y).map(t=>{const r=t.symbols.includes(i);return new l.Action({jsxLabel:e.createElement(g.ContextMenuWatchlistItem,{title:t.name,isChecked:r,isSmallSize:this._isMobile}),shortcutHint:t.id===h?(0,n.humanReadableHash)(n.Modifiers.Alt+87):void 0,invisibleHotkey:t.id===h?r:void 0,doNotCloseOnClick:!0,onExecute:()=>{const e=r?d.removeSymbolsThunk(p.WATCHLIST_WIDGET_ID,i,t.id):d.addSymbolsToCustomListThunk(p.WATCHLIST_WIDGET_ID,t.id,[i]);t.id!==h||window.is_authenticated||this._hadSymbolOnInit?v.dispatch(e):window.runOrSignIn(()=>{v.dispatch(e)},{source:"Chart context menu"})}})}),w=new l.Action({label:(0,s.appendEllipsis)((0,r.t)("Create new list")),icon:this._isMobile?u:void 0,onExecute:()=>{(0,a.runOrGoPro)(()=>{v.dispatch(d.userCreateWatchlistThunk(null,{symbols:[i]}))},o.ProductFeatures.MULTIPLE_WATCHLISTS,{feature:"multipleWatchLists",featureLocation:"moveSymbolsToNew"})}});this.update({subItems:[...b,new l.Separator,w]})});this._controller.signal.addEventListener("abort",()=>S(),{once:!0})}}},23939:(e,t,i)=>{"use strict";i.d(t,{addPlusButtonProperty:()=>o,restoreAddPlusButtonSettingsValue:()=>a});var r=i(42098),s=i(64297);function n(){return r.getBool("add_plus_button",!0)}const o=(0,s.createPrimitiveProperty)(n());function a(){o.setValue(!0),r.remove("add_plus_button")}r.onSync.subscribe(null,()=>o.setValue(n())),o.listeners().subscribe(null,()=>r.setValue("add_plus_button",o.value()))},86472:(e,t,i)=>{"use strict";i.d(t,{defaultSettings:()=>u,getSettingsProperty:()=>p});var r=i(42098),s=i(31565),n=i(3707),o=i(68981),a=i(27937),l=i.n(a);let c;const u={visible:!0,color:"rgba( 245, 124, 0, 1)",highlightColor:"rgba( 245, 124, 0, 1)",hoverColor:"rgba( 245, 124, 0, 1)",line:{visible:!0,style:n.LINESTYLE_DASHED,width:1}};function d(){let e=(0,r.getJSON)("alertLabels",null);if(null===e){const t=(0,o.defaults)("chartproperties");t&&t.alertsProperties&&t.alertsProperties.labels&&(e=t.alertsProperties.labels)}return null===e&&(e=(0,s.clone)(u)),e}function h(){c&&(0,r.setJSON)("alertLabels",c.state())}function p(){return c||(c=new(l())(d()),c.listeners().subscribe(null,h),r.onSync.subscribe(null,()=>{c.merge(d())}),c)}},8412:(e,t,i)=>{"use strict";i.d(t,{ALERT_LABEL_WIDTH:()=>O,AlertLabel:()=>V});var r=i(16282),s=i(52946),n=i(96861),o=i(70734),a=i(27937),l=i.n(a),c=i(2459),u=i(20554),d=i(86472),h=i(72927),p=i(56288),_=i(62288),m=i(26184),f=i(99438),g=i(64348),v=i(34250),S=i(29295);class y extends S.ScaledPaneRenderer{constructor(e){super(),this._data=e}hitTest(e,t){const i=(0,v.interactionTolerance)().line;return this._data.item.points.reduce((t,r,s)=>Math.abs(r.y-e.y)<=i?new _.HitTestResult(_.HitTestResult.MOVEPOINT,{activeItem:s,hideCrosshairLinesOnHover:!0}):t,null)}_drawImpl(e,t){e.lineWidth=this._data.lineWidth,e.strokeStyle=this._data.color,(0,f.setLineStyle)(e,this._data.lineStyle),this._data.item.points.forEach(t=>(0,g.drawHorizontalLine)(e,t.y,0,t.x))}}var b=i(34698),w=i(39304);const P=(0,
b.getThemedColor)("color-bg-primary"),C=(0,b.getThemedColor)("color-alert-text");class T extends S.ScaledPaneRenderer{constructor(e){super(),this._data=e}hitTest(){return null}_drawImpl(e,t){let i;const r=["Alert: "+(this._data.item.alert.get("name")||this._data.item.alert.get("description"))];e.font="12px "+w.CHART_FONT_FAMILY;const s=r.reduce((t,i)=>Math.max(e.measureText(i).width,t),0),n=40+s,o=12*r.length+16+8*(r.length-1);if(2===this._data.item.points.length){const e=this._data.item.points[0],t=this._data.item.points[1];let r,s;this._data.cursor.x<e.x-this._data.labelWidth?(r=this._data.cursor.x,s=Math.abs(t.y-this._data.cursor.y)<Math.abs(e.y-this._data.cursor.y)?t.y:e.y):(r=e.x,s=this._data.cursor.y,s=Math.min(t.y,s),s=Math.max(e.y,s)),i=new h.Point(r,s)}else i=new h.Point(this._data.cursor.x,this._data.item.points[0].y);const a={x:i.x-20-5-n,y:i.y-o/2};e.lineWidth=1,e.strokeStyle=this._data.borderColor,e.fillStyle=P,e.translate(a.x,a.y),e.beginPath(),e.moveTo(0,0),e.lineTo(n,0),e.lineTo(n,o/2-5),e.lineTo(n+5,o/2),e.lineTo(n,o/2+5),e.lineTo(n,o),e.lineTo(0,o),e.lineTo(0,0),e.stroke(),e.fill(),e.textBaseline="bottom",e.fillStyle=C,e.textAlign="center";const l=20+s/2;let c=0;for(let t=0;t<r.length;t++)c+=20,e.fillText(r[t],l,c);e.translate(-a.x,-a.y)}}class x{constructor(e,t){this._invalidated=!0,this._hovered=!1,this._labelWidth=10,this._item=null,this._selectionData=null,this._updateHoverCallback=this._updateHover.bind(this),this._alertLabel=e,this._model=t,this._alertLabel.alert().on("change:hovered",this._updateHoverCallback)}stop(){this._alertLabel.alert().off("change:hovered",this._updateHoverCallback)}update(){this._invalidated=!0}invalidate(){this._model.lightUpdate()}renderer(){if(this._invalidated&&(this._updateImpl(),this._invalidated=!1),!this._item)return null;const e=this._alertLabel,t=this._model,i={item:this._item,height:this._hovered?12:10,width:this._hovered?this._labelWidth+2:this._labelWidth,connectingLineWidth:this._hovered?3:1,color:this._alertLabel.color(),lineWidth:this._lineWidth(),lineStyle:this._lineStyle(),cursor:t.crossHairSource().currentPoint(),borderColor:"",labelWidth:0},r=new p.CompositeRenderer;e.drawHorzLine()&&r.append(new y(i));e===t.hoveredSource()&&r.append(new T(i));return t.selection().isSelected(e)&&this._selectionData&&r.append(new m.SelectionRenderer(this._selectionData)),r}_updateHover(e,t){this._hovered=!!t,this.update(),this.invalidate()}_updateImpl(){const e=this._alertLabel.alert(),t=(0,r.ensureDefined)(e.get("extra")),i=[],s=(0,r.ensureNotNull)(this._model.paneForSource(this._alertLabel)),n=(0,r.ensureNotNull)(s.mainDataSource()).firstValue();if(null===n)return;const o=e=>(0,r.ensureNotNull)(this._alertLabel.priceScale()).priceToCoordinate(e,n);if(!this._alertLabel.canDrawLabelForAlert())return void(this._item=null);const a=s.width()-this._labelWidth/2-1;if(t.conditionData().isChannel){const e=t.price(),r=o(e.upper),s=o(e.lower);i.push(new h.Point(a,r)),i.push(new h.Point(a,s))}else{const e=o(t.price());i.push(new h.Point(a,e))}if(this._item={alert:e,points:i},
this._model.selection().isSelected(this._alertLabel)){const e=s.height(),t=i.map(t=>this._model.backgroundColorAtYPercentFromTop(t.y/e));this._selectionData={points:i,hittestResult:_.HitTestResult.MOVEPOINT,bgColors:t,visible:!0,barSpacing:this._model.timeScale().barSpacing()}}else this._selectionData=null}_lineWidth(){let e=d.defaultSettings.line.width;return this._hovered&&(e+=2),e}_lineStyle(){return d.defaultSettings.line.style}}var I=i(50946),L=i(71044);class M{constructor(e){this._data=e}hitTest(e,t,i){const r=[],s=this._data.items[0],n=this._data.items[1],o=this._claculateTriangleHeight(s,n),a=this._data.connectingLineWidth,l=this._data.lineWidth/2;"right"===i?(r.push((0,h.box)((0,h.point)(1,s-l),(0,h.point)(1+this._data.width,s+o))),r.push((0,h.box)((0,h.point)(1,n+l),(0,h.point)(1+this._data.width,n-o))),n>s&&r.push((0,h.box)((0,h.point)(1+this._data.width-a,n),(0,h.point)(1+this._data.width+a,s)))):(r.push((0,h.box)((0,h.point)(t-1,s-l),(0,h.point)(t-1-this._data.width,s+o))),r.push((0,h.box)((0,h.point)(t-1,n+l),(0,h.point)(t-1-this._data.width,n-o))),n>s&&r.push((0,h.box)((0,h.point)(t-1-this._data.width-a,n),(0,h.point)(t-1-this._data.width+a,s))));const c=(0,v.interactionTolerance)().line;return r.map(e=>(0,h.box)(e.min.subtract((0,h.point)(c,c)),e.max.add((0,h.point)(c,c)))).some(t=>(0,L.pointInBox)(e,t))?new _.HitTestResult(_.HitTestResult.REGULAR):null}draw(e,t,i,r,s,n,o){const a=this._data.items[0],l=this._data.items[1],c=this._claculateTriangleHeight(a,l),u=this._data.connectingLineWidth,d=this._data.lineWidth/2;e.save(),e.fillStyle=this._data.color,e.strokeStyle=this._data.color,e.lineWidth=u,(0,f.setLineStyle)(e,this._data.lineStyle);const h=Math.round(1*o),p=Math.round(r*o),_=Math.round(d*o),m=Math.round(this._data.width*o),g=Math.round(c*o),v=Math.round(l*o),S=Math.round(a*o);if("left"===n){if(e.beginPath(),e.moveTo(h,S-_),e.lineTo(h+m,S-_),e.lineTo(h+m,S+g),e.closePath(),e.fill(),e.beginPath(),e.moveTo(h,v+_),e.lineTo(h+m,v+_),e.lineTo(h+m,v-g),e.closePath(),e.fill(),v<S)return;e.beginPath(),e.moveTo(h+m,v),e.lineTo(h+m,S),e.stroke()}else{if(e.beginPath(),e.moveTo(p-h,S-_),e.lineTo(p-h-m,S-_),e.lineTo(p-h-m,S+g),e.closePath(),e.fill(),e.beginPath(),e.moveTo(p-h,v+_),e.lineTo(p-h-m,v+_),e.lineTo(p-h-m,v-g),e.closePath(),e.fill(),v<S)return;e.beginPath(),e.moveTo(p-h-m,v),e.lineTo(p-h-m,S),e.stroke()}e.restore()}height(){return 0}setData(e,t){}_claculateTriangleHeight(e,t){let i=this._data.height;return e<=t&&(i=Math.min(i,Math.abs(e-t)/2)),i}}class E{constructor(e){this._data=e}draw(e,t,i,r,s,n,o){e.save(),e.fillStyle=this._data.color;const a=this._data.items[0],l=Math.round(1*o),c=Math.round(a*o),u=Math.round(5*o),d=Math.round(5*o),h=Math.round(2*o),p=Math.round(r*o);"left"===n?(e.beginPath(),e.moveTo(l,c),e.lineTo(l+u,c-d),e.lineTo(l+u+h,c-d),e.lineTo(l+u+h,c+d),e.lineTo(l+u,c+d),e.closePath(),e.fill()):(e.beginPath(),e.moveTo(p-l,c),e.lineTo(p-l-u,c-d),e.lineTo(p-l-u-h,c-d),e.lineTo(p-l-u-h,c+d),e.lineTo(p-l-u,c+d),e.closePath(),e.fill()),e.restore()}hitTest(e,t,i){
const r=this._data.items[0];let s=null;s="right"===i?(0,h.box)((0,h.point)(1,r-5),(0,h.point)(8,r+5)):(0,h.box)((0,h.point)(t-1-1,r-5),(0,h.point)(t-1-5-2-1,r+5));const n=(0,v.interactionTolerance)().line;return s=(0,h.box)(s.min.subtract((0,h.point)(n,n)),s.max.add((0,h.point)(n,n))),(0,L.pointInBox)(e,s)?new _.HitTestResult(_.HitTestResult.REGULAR,{hideCrosshairLinesOnHover:!0}):null}height(){return 0}setData(e,t){}}class A{constructor(e){this._bases=e}draw(e,t,i,r,s,n,o){this._bases.forEach(a=>a.draw(e,t,i,r,s,n,o))}height(){return 0}setData(e,t){}}class k{constructor(e,t){this._data=null,this._invalidated=!0,this._hovered=!1,this._updateHoverCallback=this._updateHover.bind(this),this._alertLabel=e,this._model=t,this._invalidated=!0,this._alertLabel.alert().on("change:hovered",this._updateHoverCallback)}stop(){this._alertLabel.alert().off("change:hovered",this._updateHoverCallback)}coordinate(){return null===this._data?0:this._data.items.length>0?this._data.items[0]:0}floatCoordinate(){return 0}getFixedCoordinate(){return 0}height(){return 0}isVisible(){return!!this._data&&this._data.visible}isAxisLabelVisible(){return this._invalidated&&(this._updateImpl(),this._invalidated=!0),!!this._data&&this._data.visible}paneRenderer(){return new A([])}setFixedCoordinate(){}text(){return""}update(){this._invalidated=!0}generateTextColor(e){return(0,I.colorFromBackground)(e)}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!0),null===this._data||0===this._data.items.length?new A([]):1===this._data.items.length?new E(this._data):2===this._data.items.length?new M(this._data):new A([])}secondLineText(){}thirdLineText(){}ignoreAlignment(){return!1}_updateHover(e,t){this._hovered=t,this.update()}_updateImpl(){this._data=null;if(null===this._model.paneForSource(this._alertLabel))return;const e=(0,r.ensureNotNull)((0,r.ensureNotNull)(this._model.paneForSource(this._alertLabel)).mainDataSource()).firstValue();if(null===e)return;const t=t=>(0,r.ensureNotNull)(this._alertLabel.priceScale()).priceToCoordinate(t,e),i=this._alertLabel.alert(),s=(0,r.ensureDefined)(i.get("extra"));if(this._alertLabel.canDrawLabelForAlert())if(this._data={visible:!0,width:7,height:7,color:this._alertLabel.color(),items:[],connectingLineWidth:this._hovered?3:1,lineWidth:(0,d.getSettingsProperty)().childs().line.childs().width.value()+(this._hovered?2:0),lineStyle:(0,d.getSettingsProperty)().childs().line.childs().style.value()},s.conditionData().isChannel){const e=s.price(),i=t(e.upper),r=t(e.lower);this._data.items.push(i),this._data.items.push(r)}else{const e=t(s.price());this._data.items.push(e)}}}var D=i(26274);class R extends k{constructor(e,t){super(e,t),this._renderers=[],this._renderers=[],this._compositeRenderer=new A(this._renderers)}renderer(){if(this._invalidated&&(this._updateImpl(),this._invalidated=!1),null===this._data||!this._data.visible)return new A([]);const e={visible:this._data.visible,linewidth:this._data.lineWidth,linestyle:this._data.lineStyle,text:"",separatorVisible:!1,borderVisible:!1,ignoreOffset:!0}
;for(let t=this._renderers.length;t<this._data.items.length;t++){const i={textColor:this._data.color,coordinate:this._data.items[t],background:"",additionalPaddingBottom:0,additionalPaddingTop:0};this._renderers.push(new D.PriceLineAxisRenderer(e,i))}return this._renderers.length>this._data.items.length&&this._renderers.splice(this._data.items.length),this._data.items.forEach((t,i)=>{const s={textColor:(0,r.ensureNotNull)(this._data).color,coordinate:t,background:"",additionalPaddingBottom:0,additionalPaddingTop:0};this._renderers[i].setData(e,s)}),this._compositeRenderer}ignoreAlignment(){return!0}_updateImpl(){this._alertLabel.drawHorzLine()||!this._data?super._updateImpl():this._data.visible=!1}}const N=o.sortSourcesPreOrdered.AlertLabel,O=5;class V extends n.DataSource{constructor(e,t,i,s){super(),this._highlighted=!1,this._highlightCallback=this._highlight.bind(this),this._resetUserEditEnabledCallback=this._resetUserEditEnabled.bind(this),this._propertyMock=new(l()),this._startMovingPoint=null,this._currentMovingPoint=null,this._propertyMock.addProperty("visible",!0),this._model=e,this._alert=t,this._alertOwnerSource=i,this._paneView=new x(this,e),this._priceAxisView=new k(this,e),this._priceLinePriceAxisView=new R(this,e),this._invokeAlertEditor=s,this._resetUserEditEnabled(),this.hasAlert.setValue(!0),this._chartModelLightUpdate=e.lightUpdate.bind(e),this._alertSeriesId=(0,r.ensureDefined)((0,r.ensureDefined)(t.get("extra")).alertSeries()).id,t.on("change:id",this._resetUserEditEnabledCallback),t.on("change:extra",this._resetUserEditEnabledCallback),t.on("change:extra",this._chartModelLightUpdate),t.on("change:isBeingEdited",this._resetUserEditEnabledCallback),this.alert().on("fired",this._highlightCallback)}zorder(){return N}alertOwnerSource(){return this._alertOwnerSource}alertSeriesId(){return this._alertSeriesId}isSpeciallyZOrderedSource(){return!0}stop(){this._alert.off("change:id",this._resetUserEditEnabledCallback),this._alert.off("change:extra",this._resetUserEditEnabledCallback),this._alert.off("change:extra",this._chartModelLightUpdate),this._alert.off("change:isBeingEdited",this._resetUserEditEnabledCallback),this._alert.off("fired",this._highlightCallback),this._paneView.stop(),this._priceAxisView.stop()}alert(){return this._alert}alertId(){return this.alert().id}getAlert(){return Promise.resolve(this._alert)}getAlertSync(){return this._alert}movable(){return!0}color(){let e;return e=this._highlighted?(0,d.getSettingsProperty)().childs().highlightColor.value():this._alert.isNew()?"rgba( 119, 119, 119, 1)":d.defaultSettings.color,e}convertYCoordinateToPriceForMoving(e,t){const i=this.priceScale();if(!t||!i||i.isEmpty())return null;const r=t.firstValue();return null===r?null:i.coordinateToPrice(e,r)}isSynchronizable(){return!1}state(){const e=this.alert().get("extra"),t=[];if(e)if(e.conditionData().isChannel){const i=e.price();t.push({price:i.upper}),t.push({price:i.lower})}else t.push({price:e.price()});return{id:this._id,type:"AlertLabel",zorder:this.zorder(),points:t}}restorePoints(e){const t=(0,
r.ensureDefined)(this.alert().get("extra"));t.conditionData().isChannel?t.price({upper:e[0].price,lower:e[1].price}):t.price(e[0].price)}createServerPoints(){}properties(){return this._propertyMock}paneViews(){return window.TradingView.printing?null:this.labelVisible()?[this._paneView]:null}dataWindowView(){return null}priceAxisViews(e,t){return window.TradingView.printing?[]:this.labelVisible()?e.findTargetPriceAxisViews(this,t,[this._priceAxisView],[this._priceLinePriceAxisView]):[]}statusView(){return null}updateAllViews(){this._paneView.update(),this._priceAxisView.update(),this._priceLinePriceAxisView.update()}pointsCount(){return 0}title(){return this.alert().title()}startMoving(e,t,i,r){var s;this._userEditEnabled=!1,this._startMovingPoint=null!==(s=e.logical)&&void 0!==s?s:null,this.alert().saveState()}move(e,t,i,s){if(!e.logical||null===t)return;let n=e.logical.price;const o=(0,r.ensureDefined)(this.alert().get("extra"));o.conditionData().isChannel&&(0===t?n={upper:n}:1===t&&(n={lower:n})),o.price(n),this._currentMovingPoint=e.logical}endMoving(){const e=this._startMovingPoint,t=this._currentMovingPoint;if(this._userEditEnabled=!0,this._startMovingPoint=null,this._currentMovingPoint=null,!e||!t||e===t)return;this._invokeAlertEditor({dataSourceHub:this._model,alert:this.alert(),type:"edit_alert",onEditCancel:()=>{setTimeout(()=>{this.alert().restoreState()},0)},actionSource:"alert_label_move"})}showInObjectTree(){return!1}isRemovedByStudyTemplates(){return!1}isUserDeletable(){return!1}doesMovingAffectsUndo(){return!1}drawHorzLine(){return this.labelLineVisible()}canDrawLabelForAlert(){const e=this.alert(),t=e.get("extra"),i=t&&t.getMainSeries(),r=i&&i.getStyle&&i.getStyle(),n=this._model.mainSeries(),o=n&&n.properties().childs(),a=o&&o.style&&o.style.value(),l=c.Interval.isEqual(e.get("resolution"),s.linking.interval.value())||e.get("crossInterval"),d=!e.isRangeBasedStyle()&&!(0,u.isRangeBasedStyle)(n.style())||r===a;return e.isPrice()&&l&&d}labelVisible(){const e=this._alertOwnerSource.symbolSource();return(!e||!e.isConvertedToOtherCurrency()&&!e.isConvertedToOtherUnit())&&d.defaultSettings.visible}labelLineVisible(){return(0,d.getSettingsProperty)().childs().line.childs().visible.value()}_highlight(){const e=()=>{this._highlighted=!1,this._paneView.update(),this._paneView.invalidate()},t=()=>{this._highlighted=!0,this._paneView.update(),this._paneView.invalidate(),setTimeout(e,500)};t(),setTimeout(t,1e3)}_resetUserEditEnabled(){const e=this._alert;this._userEditEnabled=!(e.get("isBeingEdited")||e.isNew()||!e.isPrice()||!e.get("extra"))}}},13054:(e,t,i)=>{"use strict";i.d(t,{AppliedTimeFrame:()=>s});var r=i(96131);class s{constructor(e){this._appliedTimeFrame=new r.WatchedObject(null),this._appliedTimeFrameInfo=null,this._appliedTimeFrameChangedBound=this._appliedTimeFrameChanged.bind(this),this._model=e,e.mainSeries().dataEvents().seriesTimeFrame().subscribe(this,this._onSeriesTimeFrame),this._appliedTimeFrame.subscribe(this._appliedTimeFrameChangedBound)}destroy(){
this._appliedTimeFrame.unsubscribe(this._appliedTimeFrameChangedBound),this._model.timeScale().logicalRangeChanged().unsubscribeAll(this),this._model.mainSeries().dataEvents().seriesTimeFrame().unsubscribeAll(this)}appliedTimeFrame(){return this._appliedTimeFrame}_appliedTimeFrameChanged(){this._model.timeScale().logicalRangeChanged().unsubscribe(this,this._invalidateAppliedTimeFrame)}_onSeriesTimeFrame(e,t,i,r){if(r){const e=this._model.timeScale();this._appliedTimeFrameInfo={logicalRange:e.logicalRange(),baseIndex:e.baseIndex()},e.logicalRangeChanged().subscribe(this,this._invalidateAppliedTimeFrame)}}_invalidateAppliedTimeFrame(){if(null===this._appliedTimeFrameInfo)return;const e=this._model.timeScale(),t=e.logicalRange(),i=e.baseIndex(),r=this._appliedTimeFrameInfo.logicalRange,s=this._appliedTimeFrameInfo.baseIndex;(null===t||null===r||Math.abs(i-t.left()-(s-r.left()))>=.01||Math.abs(i-t.right()-(s-r.right()))>=.01)&&this._appliedTimeFrame.setValue(null)}}},44079:(e,t,i)=>{"use strict";i.d(t,{defaultsPreferencesByWhiteList:()=>I,preferencesByWhiteList:()=>x});var r=i(31565),s=i(94209);var n=i(87380),o=i(57086),a=i(68981),l=i(42461),c=i(21318),u=i(74026),d=i(93669);const h={visible:!1,lineStyle:i(3707).LINESTYLE_DOTTED,lineWidth:1,bidLineColor:d.colorsPalette["color-tv-blue-500"],askLineColor:"#EF5350"};var p=i(83748);const _=(0,n.getLogger)("Chart.ApplyPreferencesToAllCharts"),m={color:"",style:0},f={autoScale:!1,autoScaleDisabled:!1,lockScale:!1,percentage:!1,percentageDisabled:!1,log:!1,logDisabled:!1,alignLabels:!1,isInverted:!1,indexedTo100:!1},g={backgroundType:u.ColorType.Solid,background:"",backgroundGradientStartColor:"",backgroundGradientEndColor:"",topMargin:0,bottomMargin:0,rightOffset:0,horzGridProperties:(0,c.deepExtend)({},m),vertGridProperties:(0,c.deepExtend)({},m),crossHairProperties:(0,c.deepExtend)({},{color:"",style:0,transparency:0,width:0}),legendProperties:(0,c.deepExtend)({},{showStudyArguments:!1,showStudyTitles:!1,showStudyValues:!1,showSeriesTitle:!1,showSeriesOHLC:!1,showLegend:!1,showBarChange:!0,showBackground:!0,backgroundTransparency:0}),axisProperties:(0,c.deepExtend)({},f)},v={lineColor:"",textColor:"",fontSize:0,scaleSeriesOnly:!1,showSeriesLastValue:!1,seriesLastValueMode:o.PriceAxisLastValueMode.LastValueAccordingToScale,showSeriesPrevCloseValue:!1,showStudyLastValue:!1,showSymbolLabels:!1,showStudyPlotLabels:!1,showBidAskLabels:!1,showPrePostMarketPriceLabel:!0,showFundamentalLastValue:!1,showFundamentalNameLabel:!1,showCurrency:!0,showUnit:!0},S={...v},y={visible:!1,futureOnly:!1,breaks:(0,c.deepExtend)({},{color:"",visible:!1,style:0,width:0})},b={style:0,minTick:"",showPriceLine:!1,priceLineWidth:0,priceLineColor:"",baseLineColor:"",showPrevClosePriceLine:!1,showCountdown:!0,prevClosePriceLineWidth:0,sessionId:"regular",prevClosePriceLineColor:"",esdShowDividends:!1,esdShowSplits:!1,esdShowEarnings:!1,esdShowBreaks:!1,dividendsAdjustment:!1,backAdjustment:!1,settlementAsClose:!0,statusViewStyle:(0,c.deepExtend)({},{fontSize:16,showExchange:!0,showInterval:!0,
symbolTextSource:"description"}),priceAxisProperties:(0,c.deepExtend)({},f),bidAsk:(0,c.deepExtend)({},h),prePostMarket:(0,c.deepExtend)({},p.defaultPrePostMarketPreferences),highLowAvgPrice:(0,c.deepExtend)({},{highLowPriceLinesVisible:!1,highLowPriceLabelsVisible:!1,averageClosePriceLineVisible:!1,averageClosePriceLabelVisible:!1}),candleStyle:(0,c.deepExtend)({},{upColor:"",downColor:"",drawWick:!1,drawBorder:!1,drawBody:!0,borderColor:"",borderUpColor:"",borderDownColor:"",wickColor:"",wickUpColor:"",wickDownColor:"",barColorsOnPrevClose:!1}),hollowCandleStyle:(0,c.deepExtend)({},{upColor:"",downColor:"",drawWick:!1,drawBorder:!1,drawBody:!0,borderColor:"",borderUpColor:"",borderDownColor:"",wickColor:"",wickUpColor:"",wickDownColor:""}),barStyle:(0,c.deepExtend)({},{upColor:"",downColor:"",barColorsOnPrevClose:!1,dontDrawOpen:!1,thinBars:!0}),lineStyle:(0,c.deepExtend)({},{color:"",linestyle:0,linewidth:0,styleType:0}),areaStyle:(0,c.deepExtend)({},{color1:"",color2:"",linecolor:"",linestyle:0,linewidth:0,transparency:0}),baselineStyle:(0,c.deepExtend)({},{topFillColor1:"",topFillColor2:"",bottomFillColor1:"",bottomFillColor2:"",topLineColor:"",bottomLineColor:"",baselineColor:"",topLineWidth:0,bottomLineWidth:0,transparency:0,baseLevelPercentage:0}),hiloStyle:(0,c.deepExtend)({},{color:"",showBorders:!1,borderColor:"",showLabels:!1,labelColor:"",fontSize:0,drawBody:!0}),haStyle:(0,c.deepExtend)({},{upColor:"",downColor:"",drawWick:!1,drawBorder:!1,drawBody:!0,borderColor:"",borderUpColor:"",borderDownColor:"",wickColor:"",wickUpColor:"",wickDownColor:"",showRealLastPrice:!1,barColorsOnPrevClose:!1,inputs:{}}),renkoStyle:(0,c.deepExtend)({},{upColor:"",downColor:"",borderUpColor:"",borderDownColor:"",upColorProjection:"",downColorProjection:"",borderUpColorProjection:"",borderDownColorProjection:"",wickUpColor:"",wickDownColor:"",inputs:{boxSize:0,style:"",atrLength:0,wicks:!1,sources:"",source:""}}),pbStyle:(0,c.deepExtend)({},{upColor:"",downColor:"",borderUpColor:"",borderDownColor:"",upColorProjection:"",downColorProjection:"",borderUpColorProjection:"",borderDownColorProjection:"",inputs:{source:"",lb:0}}),kagiStyle:(0,c.deepExtend)({},{upColor:"",downColor:"",upColorProjection:"",downColorProjection:"",inputs:{style:"",atrLength:0,reversalAmount:0}}),pnfStyle:(0,c.deepExtend)({},{upColor:"",downColor:"",upColorProjection:"",downColorProjection:"",inputs:{reversalAmount:0,boxSize:0,style:"",atrLength:0}}),rangeStyle:(0,c.deepExtend)({},{upColor:"",downColor:"",upColorProjection:"",downColorProjection:"",thinBars:!1,inputs:{range:0,phantomBars:!1}})},w={priceScaleSelectionStrategyName:"auto",timeScale:(0,c.deepExtend)({},{defaultRightOffset:0}),mainSeries:(0,c.deepExtend)({},b),sessions:(0,c.deepExtend)({},l.sessionsPreferencesDefault),paneProperties:(0,c.deepExtend)({},g),chartEventsSourceProperties:(0,c.deepExtend)({},y),tradingProperties:(0,c.deepExtend)({},s.tradingPreferencesDefault)},P={timezone:"",scalesProperties:(0,c.deepExtend)({},S),...w},C={scalesProperties:(0,c.deepExtend)({},v),...w}
;function T(e,t,i,s,n=!0){if(void 0===t[e])return _.logDebug(`We haven't had this property ${s}.${e} yet, please, remove it from whiteList`),null;if((0,r.isObject)(i[e])){const r=Object.keys(i[e]);let o="";return r.map(r=>({[r]:T(r,t[e],i[e],`${s}.${e}`,n)})).reduce((e,t)=>(o=Object.keys(t)[0],e[o]=t[o],e),{})}return n?t[e].value():t[e]}function x(e,t,i=P){const r={timezone:"",priceScaleSelectionStrategyName:"auto",timeScale:{defaultRightOffset:e.timeScale().defaultRightOffsetProperty().value()},mainSeries:{},sessions:{},paneProperties:{},scalesProperties:{},chartEventsSourceProperties:{},tradingProperties:{}},s=["timeScale","mainSeries","sessions"],n=i.mainSeries,o=Object.keys(i),a=Object.keys(n),l=t.properties(),c=e.properties(),u=i.sessions,d=Object.keys(u),h=e.sessions().properties();return a.forEach(e=>{r.mainSeries[e]=T(e,l,n,"mainSeries")}),d.forEach(e=>{r.sessions[e]=T(e,h,u,"sessions")}),o.forEach(e=>{s.includes(e)||(r[e]=T(e,c,i,"preferences"))}),r}function I(e,t,i=C){const r={timeScale:{defaultRightOffset:e.timeScale().rightOffsetDefaultValue()},mainSeries:{},sessions:(0,c.deepExtend)({},l.sessionsPreferencesDefault),paneProperties:{},scalesProperties:{},chartEventsSourceProperties:{},tradingProperties:{},priceScaleSelectionStrategyName:"auto"},s=["timeScale","mainSeries","sessions"],n=i.mainSeries,o=Object.keys(i),u=Object.keys(n),d=(0,a.factoryDefaults)("chartproperties.mainSeriesProperties"),h=(0,a.factoryDefaults)("chartproperties");return u.forEach(e=>{r.mainSeries[e]=T(e,d,n,"mainSeries",!1)}),o.forEach(e=>{s.includes(e)||(r[e]=T(e,h,i,"preferences",!1))}),r}},53021:(e,t,i)=>{"use strict";i.d(t,{axisLabelBackgroundColor:()=>r});const r={common:i(93669).colorsPalette["color-tv-blue-500"],active:"#143EB3"}},81994:(e,t,i)=>{"use strict";i.d(t,{createTimeToBarTimeAligner:()=>a});i(4033);var r=i(22842),s=(i(2459),i(56553)),n=i(43175);new s.SessionInfo("Etc/UTC","0000-0000:1234567");function o(){return!r.enabled("disable_resolution_rebuild")}function a(e,t){if(!o())return e=>e;const i=new s.SessionInfo(t.timezone,t.session,t.session_holidays,t.corrections),r=(0,n.newBarBuilder)(e,i,i,!1);return e=>r.alignTimeIfPossible(e)}},56553:(e,t,i)=>{"use strict";i.d(t,{SessionInfo:()=>o,BarBuilderBase:()=>a});var r=i(4033),s=i(96566),n=i(37796);class o{constructor(e,t,i,r){this.init(e,t,i,r)}init(e,t,i,s){this.timezone=r.get_timezone(e),this.spec=new n.SessionSpec(e,t,i,s)}}class a{alignTime(e){if(isNaN(e))return NaN;let t=this.indexOfBar(e);return t===s.SessionStage.POST_SESSION&&(this.moveTo(e),t=this.indexOfBar(e)),t<0?NaN:this.startOfBar(t)}}},43175:(e,t,i)=>{"use strict";i.d(t,{SessionInfo:()=>o.SessionInfo,newBarBuilder:()=>S});var r=i(4033),s=i(2459),n=i(84162),o=i(56553),a=i(96566);class l extends o.BarBuilderBase{constructor(e,t){super(),this._sessionStartMs=-Number.MAX_VALUE,this._sessionEndMs=-Number.MAX_VALUE,this._periodSec=e,this._session=t}alignTimeIfPossible(e){const t=this.alignTime(e);return isNaN(t)?e:t}indexOfBar(e){
return e<this._sessionStartMs?a.SessionStage.PRE_SESSION:e>=this._sessionEndMs?a.SessionStage.POST_SESSION:(0,n.toInt)(r.time_seconds_diff(e,this._sessionStartMs)/this._periodSec)}startOfBar(e){if(e===a.SessionStage.PRE_SESSION){const e=r.get_cal_from_unix_timestamp_ms(this._session.timezone,this._sessionStartMs-1),t=this._session.spec.alignToNearestSessionEnd(e,-1);return r.cal_to_utc(this._session.timezone,t)}if(e===a.SessionStage.POST_SESSION)return this._sessionEndMs;if(e<0)throw new Error("Negative offset is not supported");return this._sessionStartMs+r.time_seconds(this._periodSec*e)}endOfBar(e){if(e<0)throw new Error("Index cannot be negative");const t=this.startOfBar(e)+1e3*this._periodSec;return t>this._sessionEndMs?this._sessionEndMs:t}isLastBar(e,t){return t>=this._sessionStartMs+r.time_seconds(this._periodSec*(e+1)-1)}moveTo(e){const t=this._session.timezone,i=r.utc_to_cal(t,e),s=this._session.spec.alignToSessionStart(i);this._sessionStartMs=r.cal_to_utc(t,i),r.add_minutes(i,s),this._sessionEndMs=r.cal_to_utc(t,i)}indexOfLastBarInSession(){return(0,n.toInt)((this._sessionEndMs-1-this._sessionStartMs)/1e3/this._periodSec)}moveNext(){this.moveTo(this._sessionEndMs)}}var c=i(56048);function u(e,t){const i=r.clone(t),s=e.businessDaysToCalendarDays(i,1);s>1&&r.add_date(i,s-1);const n=e.leftBorderOfDailyBar(i);if(null===n)throw new Error("Cannot calculate left border of daily bar");return r.cal_to_utc(r.get_timezone(e.timezone()),n)}class d extends o.BarBuilderBase{constructor(e,t,i,r,s=!1){super(),this._periodStart=-Number.MAX_VALUE,this._periodEnd=-Number.MAX_VALUE,this._periodLastBarStart=-Number.MAX_VALUE,this._periodStartDay=new c.BusinessDay(0,0,0),this._periodEndDay=new c.BusinessDay(0,0,0),this._period=i,this._sessionTgt=e,this._builder=r,this._useBusinessDays=s,this._sessionSrc=s?new o.SessionInfo("Etc/UTC","24x7"):t||e}builder(){return this._builder}alignTimeIfPossible(e){return this.tradingDayToSessionStart(e)}tradingDayToSessionStart(e){return this.moveTo(e),this.startOfBar(0)}indexOfBar(e){if(this._useBusinessDays){const t=c.BusinessDay.fromCalendar(r.get_cal_from_unix_timestamp_ms(this._sessionSrc.timezone,e));return t.before(this._periodStartDay)?a.SessionStage.PRE_SESSION:this._periodEndDay.before(t)?a.SessionStage.POST_SESSION:0}return e<this._periodStart?a.SessionStage.PRE_SESSION:e>=this._periodEnd?a.SessionStage.POST_SESSION:0}startOfBar(e){if(e===a.SessionStage.PRE_SESSION){const e=r.get_cal_from_unix_timestamp_ms(this._sessionTgt.timezone,this._periodStart-1),t=this._sessionTgt.spec.alignToNearestSessionEnd(e,-1);return r.cal_to_utc(this._sessionTgt.timezone,t)-1}return e===a.SessionStage.POST_SESSION||e>0?this._periodEnd:e===a.SessionStage.LASTBAR_SESSION?this._periodLastBarStart:this._periodStart}moveTo(e){const t=r.get_cal_from_unix_timestamp_ms(this._sessionSrc.timezone,e);this._sessionSrc.spec.correctTradingDay(t);const i=r.get_year(t),s=this._indexOfPeriodInYear(t),n=s+this._period,o=this._sessionTgt.spec,a=this._sessionTgt.timezone,l=this._builder.startOfPeriod(a,s,i)
;this._periodStart=u(o,l);const d=r.clone(l),h=o.businessDaysToCalendarDays(d,1);h>1&&r.add_date(d,h-1),this._periodStartDay=c.BusinessDay.fromCalendar(d);const p=this._builder.startOfPeriod(a,n,i);this._periodEnd=u(o,p);const _=r.clone(p);for(r.add_date(_,-1);o.isCalWeekEnd(_);)r.add_date(_,-1);this._periodEndDay=c.BusinessDay.fromCalendar(_),r.add_date(p,-1),function(e,t){for(;e.isCalWeekEnd(t);)r.add_date(t,-1)}(this._sessionTgt.spec,p),this._periodLastBarStart=u(o,p),(this._periodLastBarStart<this._periodStart||this._periodLastBarStart===this._periodEnd)&&(this._periodLastBarStart=this._periodStart)}endOfBar(e){if(0!==e)throw new Error("index should be 0");return this._periodEnd}isLastBar(e,t){if(0!==e)throw new Error("index should be 0");return t>=this._periodLastBarStart}currentRange(){return{from:this._periodStartDay,to:this._periodEndDay}}indexOfBarInYear(e){const t=r.get_cal_from_unix_timestamp_ms(this._sessionSrc.timezone,e),i=r.get_year(t),s=this._builder.indexOfPeriod(t),o=this._sessionTgt.timezone;let a=this._builder.startOfPeriod(o,s,i),l=u(this._sessionTgt.spec,a);return a=r.get_cal_from_unix_timestamp_ms(r.get_timezone("Etc/UTC"),l),i<r.get_year(a)?(a=this._builder.startOfPeriod(o,s-1,i),l=u(this._sessionTgt.spec,a),{index:(s-1)/this._period,time:l}):{index:(0,n.toInt)(s/this._period),time:l}}sessionSrc(){return this._sessionSrc}_indexOfPeriodInYear(e){const t=this._builder.indexOfPeriod(e);let i=(0,n.toInt)(t/this._period)*this._period;return-1===t&&(i=-this._period),i}}function h(e,t){const i=r.get_day_of_week(t)-e.firstDayOfWeek();return i<0?i+7:i}function p(e,t){const i=r.get_day_of_year(t)-1;let s=h(e,t)-i%7;return 0===s?(0,n.toInt)(i/7):(s>=0&&(s-=7),(0,n.toInt)((s+i)/7))}class _{indexOfPeriod(e){return r.get_day_of_year(e)-1}startOfPeriod(e,t,i){const s=r.days_per_year(i);return r.get_cal(r.get_timezone("Etc/UTC"),i,r.JANUARY,1+Math.min(t,s))}}class m extends _{constructor(e){super(),this._sessionsSpec=e}indexOfPeriod(e){return super.indexOfPeriod(e)-function(e,t){const i=p(e,t),s=r.get_cal(r.get_timezone("Etc/UTC"),r.get_year(t),r.JANUARY,1);r.add_date(s,7*i);const n=i*e.weekEndsCount()+e.holidaysFromYearStart(s),o=r.get_day_of_year(t)-r.get_day_of_year(s);return n+o-e.calendarDaysToBusinessDays(s,o)}(this._sessionsSpec,e)}startOfPeriod(e,t,i){const s=7-this._sessionsSpec.weekEndsCount(),o=Math.max(0,(0,n.toInt)(t/s)-1),a=r.get_cal(r.get_timezone("Etc/UTC"),i,r.JANUARY,1),l=r.get_days_per_year(a);if(r.add_date(a,7*o),(t-=s*o-this._sessionsSpec.holidaysFromYearStart(a))>0){const e=this._sessionsSpec.businessDaysToCalendarDays(a,t);r.add_date(a,e)}let c=r.get_day_of_year(a)-1;return i<r.get_year(a)&&(c+=l),super.startOfPeriod(e,c,i)}}class f{constructor(e){this._builder=null,this._initialized=!1,this._session=e}indexOfPeriod(e){return this._getBuilder().indexOfPeriod(e)}startOfPeriod(e,t,i){return this._getBuilder().startOfPeriod(e,t,i)}_getBuilder(){return null!==this._builder&&this._initialized||(this._builder=this._session.spec.hasWeekEnds()?new m(this._session.spec):new _,
this._initialized=!0),this._builder}}class g{constructor(e){this._session=e}indexOfPeriod(e){let t=p(this._session.spec,e);if(0===t){const i=r.get_timezone(this._session.spec.timezone());e<this.startOfPeriod(i,0,r.get_year(e))&&(t=-1)}return t}startOfPeriod(e,t,i){if(t<0){i--;const s=r.get_cal(r.get_timezone("Etc/UTC"),i,r.DECEMBER,31,23,59,59),o=this.indexOfPeriod(s),a=-1*t,l=(0,n.toInt)(o/a)*a;return this.startOfPeriod(e,l,i)}const s=r.get_cal(r.get_timezone("Etc/UTC"),i,r.JANUARY,1),o=h(this._session.spec,s),a=0===o?7*t:7*(t+1)-o;return a>r.get_days_per_year(s)?this.startOfPeriod(e,0,i+1):(r.add_date(s,a),s)}}class v{indexOfPeriod(e){return r.get_month(e)}startOfPeriod(e,t,i){if(t<0){const e=(0,n.toInt)((11-t)/12);i-=e,t+=12*e}else t>r.DECEMBER&&(i++,t=r.JANUARY);return r.get_cal(r.get_timezone("Etc/UTC"),i,t,1)}}function S(e,t,i,r=!1){const n=s.Interval.parse(e),o=n.multiplier();return n.isMinutes()?new l(60*o,t):n.isSeconds()?new l(o,t):n.isTicks()?new l(1,t):n.isRange()?new l(60*o,t):new d(t,i,o,function(e,t){switch(e){case s.ResolutionKind.Days:return new f(t);case s.ResolutionKind.Weeks:return new g(t);case s.ResolutionKind.Months:return new v}throw new Error("Unknown dwm resolution: "+e)}(n.kind(),t),r)}},56048:(e,t,i)=>{"use strict";i.d(t,{BusinessDay:()=>s});var r=i(4033);class s{constructor(e,t,i){this.year=e,this.month=t,this.day=i}toString(){return`${this.year}-${this.month}-${this.day}`}compareTo(e){return this.year>e.year||this.year===e.year&&this.month>e.month||this.year===e.year&&this.month===e.month&&this.day>e.day?1:this.year===e.year&&this.month===e.month&&this.day===e.day?0:-1}before(e){return-1===this.compareTo(e)}toCalendar(e){return r.get_cal(r.get_timezone("Etc/UTC"),this.year,this.month-1,this.day)}addDays(e){const t=this.toCalendar(r.get_timezone("Etc/UTC"));return r.add_date(t,e),s.fromCalendar(t)}static fromCalendar(e){return new s(r.get_year(e),r.get_month(e)+1,r.get_day_of_month(e))}}},96566:(e,t,i)=>{"use strict";var r;i.d(t,{SessionStage:()=>r}),function(e){e[e.PRE_SESSION=-1]="PRE_SESSION",e[e.POST_SESSION=-2]="POST_SESSION",e[e.LASTBAR_SESSION=-3]="LASTBAR_SESSION"}(r||(r={}))},37796:(e,t,i)=>{"use strict";i.d(t,{SessionEntry:()=>_,SessionSpec:()=>g,compareSessionEntries:()=>p,workingDays:()=>u,workingDaysAndWeekEnds:()=>d});var r=i(4033),s=i(4543),n=i(87380),o=i(56048);const a=(0,n.getLogger)("Chart.Model.SessionSpec");function l(e){return e>=48&&e<=57}class c{constructor(){this.entries=[],this.firstDayOfWeek=r.MONDAY,this.weekEndsCount=-1}parseSessions(e,t){if(this._clear(),this.timezone=e,"24x7"===(t=this._parseFirstDayOfWeek(t)).toLowerCase())for(const e of d)this.entries.push(c._createSessionEntry(e,0,0,0,0));else{let e=!1;const i=new Map;for(const r of t.split("|")){const t=r.split(":");if(1!==t.length&&2!==t.length){a.logError("Bad session section: "+r);continue}const s=1===t.length;if(s){if(e){a.logError("Duplicated default section: "+r);continue}e=!0}const n=s?u:c._parseWorkingDays(t[1]);for(const e of n)s&&i.has(e)||i.set(e,t[0])}for(const e of d){const t=i.get(e)
;if(void 0!==t)for(const i of t.split(","))this.entries.push(c._parseSessionEntry(e,i))}}this.entries.sort(p);const i=new Set;for(const e of this.entries)i.add(e.dayOfWeek());this.weekEndsCount=7-i.size}static parseHolidaysAndCorrections(e,t,i){const s=new Map,n=new Map,o=e=>{const t=this._parseDay(e),i=t.toString(),r=n.get(i);return void 0!==r?r:(n.set(i,t),t)};if(""!==t){const e=[];for(const i of t.split(",")){if(8!==i.length)throw new Error("bad holiday date: "+i);const t=o(i);s.set(t,e)}}if(""===i)return s;const a=r.get_timezone("Etc/UTC");for(const e of i.split(";")){const t=e.split(":");if(2!==t.length)throw new Error("bad correction section: "+e);const i=[];if("dayoff"!==t[0])for(const e of t[0].split(","))i.push(this._parseSessionEntry(1,e));for(const e of t[1].split(",")){if(8!==e.length)throw new Error("bad correction date: "+e);const t=o(e),n=r.get_day_of_week(r.get_cal(a,t.year,t.month-1,t.day)),l=[];for(const e of i)l.push(new _(n,e.startOffset(),e.length()));s.set(t,l)}}return s}_clear(){this.entries=[],this.timezone="",this.firstDayOfWeek=r.MONDAY,this.weekEndsCount=-1}_parseFirstDayOfWeek(e){const t=e.split(";");if(t.length>2)return a.logError("Only one `first day` specification expected @ session "+e),e;if(1===t.length)return e;let i=1;let s=t[0].indexOf("-")>=0?NaN:parseInt(t[0]);return isNaN(s)&&(i=0,s=parseInt(t[1])),s<r.SUNDAY||s>r.SATURDAY?(a.logError(`Unexpected day index @ session: ${e}; day index ${s}`),e):(this.firstDayOfWeek=s,t[i])}static _parseDay(e){const t=parseInt(e.substring(0,4)),i=parseInt(e.substring(4,6)),r=parseInt(e.substring(6,8));return new o.BusinessDay(t,i,r)}static _parseSessionEntry(e,t){let i=t.split("-");2!==i.length&&(a.logError("Bad sessions entry: "+t),i=["0000","0000"]);let r=0,s=i[0];if(s.includes("F")){const e=s.split("F");s=e[0],r=""!==e[1]?parseInt(e[1]):1}let n=0,o=i[1];if(o.includes("F")){const e=o.split("F");o=e[0],n=""!==e[1]?parseInt(e[1]):1}if(!this._isCorrectSession(s)||!this._isCorrectSession(o))throw new Error("Incorrect entry syntax: "+t);const l=s,u=o;return this._createSessionEntry(e,c._minutesFromHHMM(l),c._minutesFromHHMM(u),r,n)}static _isCorrectSession(e){return 4===e.length&&l(e.charCodeAt(0))&&l(e.charCodeAt(1))&&l(e.charCodeAt(2))&&l(e.charCodeAt(3))}static _parseWorkingDays(e){const t=[];for(let i=0;i<e.length;i++){const r=+e[i];-1===t.indexOf(r)&&t.push(r)}return t}static _minutesFromHHMM(e){return r.get_minutes_from_hhmm(e)}static _createSessionEntry(e,t,i,s,n){0===i&&(i=r.minutesPerDay),s===n&&i<=t&&(s+=1),s>0&&(t-=s*r.minutesPerDay),n>0&&(i-=n*r.minutesPerDay);return new _(e,t,i-t)}}const u=[r.MONDAY,r.TUESDAY,r.WEDNESDAY,r.THURSDAY,r.FRIDAY],d=[r.SUNDAY,r.MONDAY,r.TUESDAY,r.WEDNESDAY,r.THURSDAY,r.FRIDAY,r.SATURDAY];function h(e,t){return e.compareTo(t)<0}function p(e,t){return e.compareTo(t)}class _{constructor(e,t,i){this._dayOfWeek=e,this._start=t,this._length=i}start(){return this._start+r.minutesPerDay*this.sessionStartDaysOffset()}startOffset(){return this._start}sessionStartDaysOffset(){
return this._start>=0?0:this._start%r.minutesPerDay==0?-Math.ceil(this._start/r.minutesPerDay):-Math.floor(this._start/r.minutesPerDay)}sessionEndDaysOffset(){const e=this._start+this._length;return e>=0?0:e%r.minutesPerDay==0?-Math.ceil(e/r.minutesPerDay):-Math.floor(e/r.minutesPerDay)}isOvernight(){return this._start<0}dayOfWeek(){return this._dayOfWeek}sessionStartDayOfWeek(){let e=this._dayOfWeek-this.sessionStartDaysOffset();return e<r.SUNDAY&&(e+=7),e}sessionEndDayOfWeek(){let e=this.sessionStartDayOfWeek()+this.sessionEndDaysOffset();return e>r.SATURDAY&&(e=1),e}length(){return this._length}weight(){return this._dayOfWeek*r.minutesPerDay+this._start}compareTo(e){const t=this.weight(),i=t+this._length,r=e.weight(),s=r+e._length;return t<=r&&r<i||r<=t&&t<s?0:t>r?1:-1}contains(e){const t=60*r.get_hours(e)+r.get_minutes(e);let i=r.get_day_of_week(e)-this._dayOfWeek;i>0&&(i-=7);const s=i*r.minutesPerDay+t;return s>=this._start&&s<this._start+this._length}}class m{constructor(e,t,i){this.weekIndex=e,this.entryIndex=t,this.entries=i}getEntry(){return this.entries[this.entryIndex]}}function f(e,t){const i=(0,s.lowerbound)(e,t,(e,t)=>-1===e.day.compareTo(t));return i===e.length?null:e[i]}class g{constructor(e="Etc/UTC",t="0000-0000",i="",s=""){this._entries=[],this._firstDayOfWeek=r.MONDAY,this._entriesHash=new Map,this._holidayAndCorrectionMap=new Map,this._holidaySessions=[];const n=new c;n.parseSessions(e,t),this._entries=n.entries,this._timezone=n.timezone,this._spec=t,this._firstDayOfWeek=n.firstDayOfWeek,this._weekEndsCount=n.weekEndsCount;const o=c.parseHolidaysAndCorrections(e,i,s),a=r.get_timezone(e);this._isThereCorrections=""!==i||""!==s,o.forEach((e,t)=>{this._holidayAndCorrectionMap.set(t.toString(),e),this._holidaySessions.push({day:t,sessions:e});const i=this.getWeekIndex(t.toCalendar(a));this._entriesHash.set(i,null)}),this._holidaySessions.sort((e,t)=>e.day.compareTo(t.day))}entries(){return this._entries}timezone(){return this._timezone}spec(){return this._spec}firstDayOfWeek(){return this._firstDayOfWeek}addSessionEntry(e,t,i,s,n){0===i&&(i=r.minutesPerDay),s===n&&i<=t&&(s+=1),s>0&&(t-=s*r.minutesPerDay),n>0&&(i-=n*r.minutesPerDay);const o=i-t;this._entries.push(new _(e,t,o))}longestSessionLength(){let e=0,t=0;for(const t of this._holidaySessions)t.sessions.forEach(t=>{e=Math.max(e,t.length())});return this._entries.forEach(e=>{t=Math.max(t,e.length())}),Math.max(e,t)}isWeekEnd(e){const t=(0,s.lowerbound)(this._entries,new _(e,0,0),(e,t)=>e.dayOfWeek()<t.dayOfWeek());return t>this._entries.length-1||this._entries[t].dayOfWeek()!==e}isCalWeekEnd(e){const t=r.get_day_of_week(e);if(!this._isThereCorrections)return this.isWeekEnd(t);const i=o.BusinessDay.fromCalendar(e),s=this._holidayAndCorrectionMap.get(i.toString());return void 0===s?this.isWeekEnd(t):0===s.length}hasWeekEnds(){return this.weekEndsCount()>0}weekEndsCount(){return this._weekEndsCount}holidaysFromYearStart(e){if(!this._isThereCorrections)return 0
;const t=r.get_timezone(this._timezone),i=new o.BusinessDay(r.get_year(e),r.JANUARY,1),s=o.BusinessDay.fromCalendar(e);let n=0;const a=this._selectHolidays(i,s);for(let e=0;e<a.length;e++){const i=a[e].day.toCalendar(t);this.isWeekEnd(r.get_day_of_week(i))?n+=0===a[e].sessions.length?0:-1:n+=0===a[e].sessions.length?1:0}return n}intradayCanBeBuiltFrom24x7(e){return this._entries.every(t=>t.start()%e==0&&t.length()%e==0)}indexOfSession(e,t,i){const n=this._getEntriesForWeek(e);let o=(0,s.lowerbound)(n,new _(t,i,0),h);if(o!==n.length)return new m(e,o,n);let a=e;const l=7-t+this._firstDayOfWeek-1;for(i=-(r.minutesPerDay-i+l*r.minutesPerDay);;){a++;const e=this._getEntriesForWeek(a);if(0!==e.length)return o=(0,s.lowerbound)(e,new _(this._firstDayOfWeek,i,0),h),new m(a,o,e)}}findSession(e,t,i,r=0){const s=this.indexOfSession(e,t,i),n=s.entries;let o=s.entryIndex;if(0!==r){const e=n[o].dayOfWeek(),t=r>0?1:-1;for(;;){const i=o+t;if(i<0||i>=n.length||n[i].dayOfWeek()!==e)break;o=i}}return new m(s.weekIndex,o,n)}getWeekIndex(e){if(!this._isThereCorrections)return 0;const t=r.get_day_of_week(e)-r.SUNDAY,i=r.get_timezone("Etc/UTC"),s=r.get_cal(i,r.get_year(e),r.get_month(e),r.get_day_of_month(e)-t);return Math.floor((s.getTime()+621672192e5)/1e3/86400/7)}correctTradingDay(e){const t=r.get_day_of_week(e),i=60*r.get_hours(e)+r.get_minutes(e),s=this.getWeekIndex(e),n=this.findSession(s,t,i,0),o=n.getEntry().dayOfWeek()-t+7*(n.weekIndex-s);return 0!==o&&r.add_date(e,o),e}alignToSessionStart(e,t=0){const i=r.get_day_of_week(e),s=60*r.get_hours(e)+r.get_minutes(e),n=this.getWeekIndex(e),o=this.findSession(n,i,s,t),a=o.getEntry(),l=a.dayOfWeek()-i+7*(o.weekIndex-n);0!==l&&r.add_date(e,l);const c=a.startOffset();return r.set_hms(e,c/60,c%60,0,0,r.get_timezone(this._timezone)),a.length()}businessDaysToCalendarDays(e,t){let i=this.getWeekIndex(e),s=r.get_day_of_week(e),n=0,o=0;for(;o<t;){const e=this._getEntriesForWeek(i);let a=0;for(let i=s;i<=r.SATURDAY;i++){n++;let r=!0;for(;a<e.length&&!(e[a].dayOfWeek()>i);)e[a].dayOfWeek()<i||r&&(r=!1,o++),a++;if(o>=t)return n}i++,s=r.SUNDAY}return n}calendarDaysToBusinessDays(e,t){let i=this.getWeekIndex(e),s=r.get_day_of_week(e),n=0,o=0;for(;n<t;){const e=this._getEntriesForWeek(i);let a=0;for(let i=s;i<=r.SATURDAY;i++){n++;let r=!0;for(;a<e.length&&!(e[a].dayOfWeek()>i);)e[a].dayOfWeek()<i||r&&(r=!1,o++),a++;if(n>=t)return o}i++,s=r.SUNDAY}return o}alignToNearestSessionStart(e,t){return this._alignToNearestSessionValue(e,t,this._entrySessionStart.bind(this))}alignToNearestSessionEnd(e,t){return this._alignToNearestSessionValue(e,t,this._entrySessionEnd.bind(this))}leftBorderOfDailyBar(e){const t=this._getEntriesForDay(e);return 0===t.length?null:(t.sort(p),this._getLeftEntryBorder(e,t[0]))}bordersOfDailyBar(e){const t=this._getEntriesForDay(e);if(0===t.length)return null;t.sort(p);const i=this._getLeftEntryBorder(e,t[0]),s=t[t.length-1],n=r.clone(e);let o=60*(s.startOffset()+s.length())-1;const a=Math.floor(o/3600);return o-=3600*a,r.set_hms(n,a,o/60,o%60,0,r.get_timezone(this._timezone)),{
from:i,to:n}}getEntriesForWeekByCalendar(e){const t=this.getWeekIndex(e);return this._getEntriesForWeek(t)}_getEntriesForWeek(e){let t=this._entriesHash.get(e);if(void 0===t)return this._entries;if(null!==t)return t;const i=r.get_timezone(this._timezone);t=this._entries.slice();const s=this._weekIndexToCalendar(e),n=this._weekIndexToCalendar(e+1),a=o.BusinessDay.fromCalendar(s),l=o.BusinessDay.fromCalendar(n),c=this._selectHolidays(a,l);for(const e of c){const s=e.day.toCalendar(i),n=r.get_day_of_week(s);t=t.filter(e=>e.dayOfWeek()!==n),t=t.concat(e.sessions)}return t.sort(p),this._entriesHash.set(e,t),t}_selectHolidays(e,t){const i=[];let r=e;for(;;){const e=f(this._holidaySessions,r);if(null===e)return i;if(!e.day.before(t))return i;i.push(e),r=e.day.addDays(1)}}_weekIndexToCalendar(e){const t=1e3*(86400*e*7+86400)-621672192e5,i=r.get_cal_from_unix_timestamp_ms(r.get_timezone("Etc/UTC"),t),s=r.get_timezone("Etc/UTC");return r.get_cal(s,r.get_year(i),r.get_month(i),r.get_day_of_month(i))}_alignToNearestSessionValue(e,t,i){const s=r.get_day_of_week(e),n=60*r.get_hours(e)+r.get_minutes(e),o=this.getWeekIndex(e);let a=this.findSession(o,s,n);if(a.getEntry().contains(e)&&o===a.weekIndex||1===t)return i(a,r.clone(e),t);let l=a.entryIndex-1;if(l<0){let e=a.weekIndex,t=a.entries;for(;l<0;)e--,t=this._getEntriesForWeek(e),l+=t.length;a=new m(e,l,t)}else a=new m(a.weekIndex,l,a.entries);return i(a,r.clone(e),t)}_entrySessionStart(e,t,i){return this._entrySessionValue(e,t,i,e=>60*e.start())}_entrySessionEnd(e,t,i){return this._entrySessionValue(e,t,i,e=>60*(e.start()+e.length())-1)}_entrySessionValue(e,t,i,s){let n=r.get_day_of_week(t);const o=e.getEntry();let a=o.dayOfWeek()-o.sessionStartDaysOffset();const l=this.getWeekIndex(t);let c=e.weekIndex-l,u=!1;if(a<r.SUNDAY&&(c<=0?u=!0:c--,a+=7),(c>0&&i>=0||c<0&&i<0)&&r.add_date(t,7*c),!o.contains(t)){let e=a-n;u&&i<0&&(e=-(7-a+n)),r.add_date(t,e),n=r.get_day_of_week(t)}o.isOvernight()&&n===o.dayOfWeek()&&r.add_date(t,-o.sessionStartDaysOffset());let d=s(o);const h=Math.floor(d/3600);return d-=3600*h,r.set_hms(t,h,d/60,d%60,0,r.get_timezone(this._timezone)),t}_getEntriesForDay(e){const t=r.get_day_of_week(e);return this._getEntriesForWeek(this.getWeekIndex(e)).filter(e=>e.dayOfWeek()===t)}_getLeftEntryBorder(e,t){const i=r.clone(e),s=t.startOffset();return r.set_hms(i,s/60,s%60,0,0,r.get_timezone(this._timezone)),i}}},10611:(e,t,i)=>{"use strict";i.d(t,{UserDefinedBarsMarks:()=>c});var r=i(14397),s=i(96238),n=i(16282),o=i(45963);class a extends o.BarMarksTooltip{constructor(){super(...arguments),this._layoutText=null}_createLayout(){this._layout=document.createElement("div"),this._layout.classList.add("bar-mark-tooltip"),this._layoutText=document.createElement("div"),this._layoutText.classList.add("text"),this._layout.appendChild(this._layoutText)}_updatePlate(e){this._currentId=e.id;const t=(0,n.ensureNotNull)(this._layout);t.style.borderColor=e.theme.border,t.style.marginTop=e.tooltipMargin+"px";const i=(0,n.ensureNotNull)(this._layoutText);i.innerHTML=e.text,t.appendChild(i)}}
var l=i(78776);class c extends s.BarsMarksContainer{constructor(e){super(e),this.toolname="UserDefinedBarsMarks",(0,r.hideMarksOnBars)().subscribe(this,()=>{this.properties().childs().visible.setValue(!(0,r.hideMarksOnBars)().value())})}destroy(){(0,r.hideMarksOnBars)().unsubscribeAll(this),super.destroy()}userEditEnabled(){return!1}onClicked(e){var t,i,r;const s=null===(t=null==e?void 0:e.activeItem)||void 0===t?void 0:t.id;null===(r=(i=this._marks[s]).onClicked)||void 0===r||r.call(i)}clearMarks(){super.clearMarks(),this.onNeedRepaint.fire()}updatePlateData(e,t){return{...t,barWidth:this.barWidth(),text:e.text,tooltipMargin:-1*Math.max(e.minSize/2,.4*this.barWidth())}}hasContextMenu(){return!1}calcIsActualCurrency(){this._isActualCurrency=!0}calcIsActualUnit(){this._isActualUnit=!0}_initialize(){this.properties().childs().visible.setValue(!0)}_plateViewData(e){const t={text:e.text};return"object"==typeof e.color&&(t.theme="user_defined_theme",t.overridedTheme={},t.overridedTheme.border=e.color.border,t.overridedTheme.background=e.color.background),t}_getData(e){const t=this._model.mainSeries().symbolInfo();if(!t)return;const i=this.roundRange(this._rangeDifference(e)),r=this._model.mainSeries().properties().childs().interval.value();window.ChartApiInstance.getMarks(t,i.start,i.end,t=>{for(const e of t)this._marks[e.id]=e;this._loadedRange=this._rangeUnion(e,this._loadedRange),this.onNeedRepaint.fire()},r)}_createTooltipRenderer(){return new l.TooltipRenderer(()=>new a,this)}}},51095:(e,t,i)=>{"use strict";i.d(t,{UserDefinedTimescaleMarks:()=>_});var r=i(16282),s=i(88001),n=i(96238),o=i(14397),a=i(72927),l=i(84667),c=i(50946),u=i(3707),d=i(32022),h=i(39304);class p extends l.LollipopPaneView{constructor(e,t,i){super(e,t,i),this.stylesCache={},this.templatesCache={},this._itemIndexToId=new Map,this.source=t}createTooltipContent(e){return e.items?{title:e.items[0],subTitle:e.items[1],style:{color:e.color}}:null}clearCaches(){this.clearLastClicked(),this._lollipops={},this._lollipopsCounter=0}update(){this._invalidated=!0}renderer(e,t){return this._invalidated&&(this._createLollipops(t,e),this._invalidated=!1),this._renderer}getStyle(e){const t=e.active?"active":e.hovered?"hovered":"default";return this._generateStyle(t,e.color,e.label)}hasTooltip(e){return Boolean(e.items&&e.items.length)}getLollipopIdByIndex(e){return this._itemIndexToId.get(e)}_createLollipops(e,t){const i=this._model.timeScale(),r=super._getY(),s=this._model.lastHittestData(),n=this._model.hoveredSource(),o=this.source.marks();Object.keys(o).forEach(e=>{const t=o[e],l=t.id,c=t.index;if(null!=c){const e=l===this.getLastClickedLollipopId(),o=this._lollipops[l],u=void 0!==o?o.itemIndex:this._lollipopsCounter++;this._itemIndexToId.has(u)||this._itemIndexToId.set(u,l);const d=n===this.source&&null!==s&&s.activeItem===u;this._lollipops[l]={id:l,itemIndex:u,basePoint:new a.Point(i.indexToCoordinate(c)+1,r),hovered:d,active:e,barY:null,label:t.label,color:t.color,items:t.tooltip,visible:!0}}}),super._createRenderers(e,t)}_generateStyle(e,t,i){const r=e+t+i
;if(!(r in this.stylesCache)){const s="hovered"===e;let n="active"===e;const o=s||n;let a="white";n?a=t:s&&(a=(0,c.generateColor)(t,85),a===t&&(n=!0));const l={barLine:{lineStyle:u.LINESTYLE_DASHED,lineWidth:1,strokeStyle:t},lollipop:{width:23,height:23,lineWidth:1.5,bottom:2,fillStyle:a,fillCircle:o,strokeStyle:t,text:{label:i,strokeStyle:n?"white":t,font:(0,d.makeFont)(12,h.CHART_FONT_FAMILY)}}};this.stylesCache[r]=l}return this.stylesCache[r]}}class _ extends n.BarsMarksContainer{constructor(e){super(e),this.toolname="UserDefinedTimescaleMarks",this._requestedPointsets=new Set,(0,o.hideMarksOnBars)().subscribe(this,()=>this._properties.childs().visible.setValue(!(0,o.hideMarksOnBars)().value())),this._paneView=new p(e,this,this._showTooltip.bind(this))}destroy(){(0,o.hideMarksOnBars)().unsubscribeAll(this),super.destroy()}userEditEnabled(){return!1}onClicked(e){if(null!==e){const t=this._paneView.getLollipopIdByIndex(e.activeItem);(0,s.emit)("onTimescaleMarkClick",t)}}clearMarks(){const e=this._model.chartApi();e.isConnected().value()&&Object.keys(this._marks).forEach(t=>{const i=this._getPointsetId(t);e.removePointset(i)}),this._requestedPointsets.clear(),super.clearMarks(),this._paneView.clearCaches(),this.onNeedRepaint.fire()}updatePlateData(e,t){return{...t,barWidth:this.barWidth(),text:e.text,tooltipMargin:-1*Math.max(e.minSize/2,.4*this.barWidth())}}hasContextMenu(){return!1}paneViews(){return this._properties.childs().visible.value()?[this._paneView]:[]}updateAllViews(){this._paneView.update()}onClickOutside(e){this._paneView.onClickOutside(e)}_createTooltipRenderer(){return null}_initialize(){this._properties.childs().visible.setValue(!0)}_plateViewData(e){return{text:e.text}}_getData(e){const t=this._model.mainSeries().symbolInfo();if(!t)return;const i=this.roundRange(this._rangeDifference(e)),s=this._model.mainSeries(),n=s.seriesSource().symbolInstanceId(),o=s.properties().childs().interval.value();window.ChartApiInstance.getTimescaleMarks(t,i.start,i.end,t=>{const i=this._model.chartApi();for(const e of t){e.index=null;const t=e.id,s=this._getPointsetId(t.toString()),a=this._marks[t];if(a&&null!==a.index&&(a.tickmark===e.tickmark?e.index=a.index:this._requestedPointsets.has(s)&&i.isConnected().value()&&(i.removePointset(s),this._requestedPointsets.delete(s))),this._marks[t]=e,null===e.index&&i.isConnected().value()){this._requestedPointsets.add(s);const t=[[e.tickmark,0]];i.createPointset(s,"turnaround",(0,r.ensureNotNull)(n),o,t,e=>this._onPointsetData(e))}}this._loadedRange=this._rangeUnion(e,this._loadedRange),this.updateAllViews(),this.onNeedRepaint.fire()},o)}_getPointsetId(e){return"pointsetMark_"+e}_onPointsetData(e){if("data_update"===e.method){const t=e.params.customId.split("_")[1],i=this._marks[t],r=e.params.plots;i&&1===r.length&&(i.index=r[0].value[0])}this.updateAllViews()}async _showTooltip(e,t){const r=t();if(!r)return;const s=this._model.timeScale(),n=[s.onScroll(),s.barSpacingChanged(),this._model.mainSeries().onSymbolIntervalChanged()],o=this.onClickOutside.bind(this)
;(await Promise.all([i.e(37610),i.e(43894),i.e(24115),i.e(73935),i.e(45867),i.e(49039)]).then(i.bind(i,80834))).showLollipopTooltip({items:r,position:e,customCloseSubscriptions:n,onClickOutside:o})}}},66786:(e,t,i)=>{"use strict";var r=i(40989).PlotRowSearchMode,s=i(50946).rgbaFromInteger;function n(){this.backColorers=[]}function o(e){n.call(this),this._series=e}function a(e,t){n.call(this),this._study=e,this._plotIndex=t}n.prototype.barStyle=function(e,t,i){for(var r={},s=this.backColorers.length-1;s>=0;s--)this.backColorers[s].applyBarStyle(e,t,r,i);return this.applyBarStyle(e,t,r,i),r},n.prototype.pushBackBarColorer=function(e){this.backColorers.push(e)},n.prototype.applyBarStyle=function(e,t,i){throw new Error("This function is supposed to be reimplemented in a subclass")},inherit(o,n),o.upColor=function(e,t){var i=e.style.value();switch(i){case TradingView.Series.STYLE_LINE:return e.lineStyle.color.value();case TradingView.Series.STYLE_AREA:return e.areaStyle.linecolor.value();case TradingView.Series.STYLE_BARS:return e.barStyle.upColor.value();case TradingView.Series.STYLE_CANDLES:return e.candleStyle.upColor.value();case TradingView.Series.STYLE_HOLLOW_CANDLES:return e.hollowCandleStyle.upColor.value();case TradingView.Series.STYLE_HEIKEN_ASHI:return e.haStyle.upColor.value();case TradingView.Series.STYLE_BASELINE:return e.baselineStyle.topLineColor.value();case TradingView.Series.STYLE_HILO:return e.hiloStyle.color.value()}switch(i){case TradingView.Series.STYLE_RENKO:return t?e.renkoStyle.upColorProjection.value():e.renkoStyle.upColor.value();case TradingView.Series.STYLE_PB:return t?e.pbStyle.upColorProjection.value():e.pbStyle.upColor.value();case TradingView.Series.STYLE_KAGI:return t?e.kagiStyle.upColorProjection.value():e.kagiStyle.upColor.value();case TradingView.Series.STYLE_PNF:return t?e.pnfStyle.upColorProjection.value():e.pnfStyle.upColor.value()}if(TradingView.Series.STYLE_RANGE===i)return t?e.rangeStyle.upColorProjection.value():e.rangeStyle.upColor.value();throw new Error("Unknown series style")},o.downColor=function(e,t){var i=e.style.value();switch(i){case TradingView.Series.STYLE_LINE:return e.lineStyle.color.value();case TradingView.Series.STYLE_AREA:return e.areaStyle.linecolor.value();case TradingView.Series.STYLE_BARS:return e.barStyle.downColor.value();case TradingView.Series.STYLE_CANDLES:return e.candleStyle.downColor.value();case TradingView.Series.STYLE_HOLLOW_CANDLES:return e.hollowCandleStyle.downColor.value();case TradingView.Series.STYLE_HEIKEN_ASHI:return e.haStyle.downColor.value();case TradingView.Series.STYLE_BASELINE:return e.baselineStyle.bottomLineColor.value();case TradingView.Series.STYLE_HILO:return e.hiloStyle.color.value()}switch(i){case TradingView.Series.STYLE_RENKO:return t?e.renkoStyle.downColorProjection.value():e.renkoStyle.downColor.value();case TradingView.Series.STYLE_PB:return t?e.pbStyle.downColorProjection.value():e.pbStyle.downColor.value();case TradingView.Series.STYLE_KAGI:return t?e.kagiStyle.downColorProjection.value():e.kagiStyle.downColor.value()
;case TradingView.Series.STYLE_PNF:return t?e.pnfStyle.downColorProjection.value():e.pnfStyle.downColor.value()}if(TradingView.Series.STYLE_RANGE===i)return t?e.rangeStyle.downColorProjection.value():e.rangeStyle.downColor.value();throw new Error("Unknown series style")},o.prototype._applyLineStyle=function(e,t,i,r,s){i.barColor=o.upColor(s)},o.prototype._applyAreaStyle=function(e,t,i,r,s){i.barColor=o.upColor(s)},o.prototype._applyBarStyle=function(e,t,i,r,s){var n=o.upColor(s),a=o.downColor(s),l=this.findBar(e,!1,r);if(s.barStyle.barColorsOnPrevClose.value()){var c=this.findPrevBar(e,!1,r);i.barColor=c[TradingView.CLOSE_PLOT]<=l[TradingView.CLOSE_PLOT]?n:a,i.barBorderColor=c[TradingView.CLOSE_PLOT]<=l[TradingView.CLOSE_PLOT]?n:a}else i.barColor=l[TradingView.OPEN_PLOT]<=l[TradingView.CLOSE_PLOT]?n:a,i.barBorderColor=l[TradingView.OPEN_PLOT]<=l[TradingView.CLOSE_PLOT]?n:a},o.prototype._applyRangeStyle=function(e,t,i,r,s){var n=o.upColor(s,t),a=o.downColor(s,t),l=this.findBar(e,!1,r);i.barColor=l[TradingView.OPEN_PLOT]<=l[TradingView.CLOSE_PLOT]?n:a,i.barBorderColor=i.barColor},o.prototype._applyCandleStyle=function(e,t,i,r,s){var n,a=o.upColor(s,t),l=o.downColor(s,t),c=s.candleStyle.borderUpColor?s.candleStyle.borderUpColor.value():s.candleStyle.borderColor.value(),u=s.candleStyle.borderDownColor?s.candleStyle.borderDownColor.value():s.candleStyle.borderColor.value(),d=s.candleStyle.wickUpColor?s.candleStyle.wickUpColor.value():s.candleStyle.wickColor.value(),h=s.candleStyle.wickDownColor?s.candleStyle.wickDownColor.value():s.candleStyle.wickColor.value(),p=this.findBar(e,!1,r);s.candleStyle.barColorsOnPrevClose.value()&&this._series.data().first().index!==e?n=this.findPrevBar(e,!1,r)[TradingView.CLOSE_PLOT]<=p[TradingView.CLOSE_PLOT]:n=p[TradingView.OPEN_PLOT]<=p[TradingView.CLOSE_PLOT];i.barColor=n?a:l,i.barBorderColor=n?c:u,i.barWickColor=n?d:h},o.prototype._applyHollowCandleStyle=function(e,t,i,r,s){var n,a=o.upColor(s,t),l=o.downColor(s,t),c=s.hollowCandleStyle.borderUpColor?s.hollowCandleStyle.borderUpColor.value():s.hollowCandleStyle.borderColor.value(),u=s.hollowCandleStyle.borderDownColor?s.hollowCandleStyle.borderDownColor.value():s.hollowCandleStyle.borderColor.value(),d=s.hollowCandleStyle.wickUpColor?s.hollowCandleStyle.wickUpColor.value():s.hollowCandleStyle.wickColor.value(),h=s.hollowCandleStyle.wickDownColor?s.hollowCandleStyle.wickDownColor.value():s.hollowCandleStyle.wickColor.value(),p=this.findBar(e,!1,r),_=this.findPrevBar(e,!1,r);n=this._series.data().first().index!==e?_[TradingView.CLOSE_PLOT]<=p[TradingView.CLOSE_PLOT]:p[TradingView.OPEN_PLOT]<=p[TradingView.CLOSE_PLOT],i.barColor=n?a:l,i.barBorderColor=n?c:u,i.barWickColor=n?d:h,i.isBarHollow=p[TradingView.OPEN_PLOT]<=p[TradingView.CLOSE_PLOT]},o.prototype._applyHAStyle=function(e,t,i,r,s){var n,a=o.upColor(s,t),l=o.downColor(s,t),c=s.haStyle.borderUpColor.value(),u=s.haStyle.borderDownColor.value(),d=s.haStyle.wickUpColor.value(),h=s.haStyle.wickDownColor.value(),p=this.findBar(e,t,r)
;s.haStyle.barColorsOnPrevClose.value()?n=this.findPrevBar(e,t,r)[TradingView.CLOSE_PLOT]<=p[TradingView.CLOSE_PLOT]:n=p[TradingView.OPEN_PLOT]<=p[TradingView.CLOSE_PLOT];i.barColor=n?a:l,i.barBorderColor=n?c:u,i.barWickColor=n?d:h},o.prototype._applyRenkoStyle=function(e,t,i,r,s){var n=this.findBar(e,t,r),a=n[TradingView.OPEN_PLOT]<=n[TradingView.CLOSE_PLOT],l=o.upColor(s,t),c=o.downColor(s,t),u=t?s.renkoStyle.borderUpColorProjection.value():s.renkoStyle.borderUpColor.value(),d=t?s.renkoStyle.borderDownColorProjection.value():s.renkoStyle.borderDownColor.value(),h=s.renkoStyle.wickUpColor.value(),p=s.renkoStyle.wickDownColor.value();i.barColor=a?l:c,i.barBorderColor=a?u:d,i.barWickColor=a?h:p,i.isBarUp=a},o.prototype._applyPBStyle=function(e,t,i,r,s){i.barColor=o.upColor(s);var n=this.findBar(e,t,r),a=n[TradingView.OPEN_PLOT]<=n[TradingView.CLOSE_PLOT],l=o.upColor(s,t),c=o.downColor(s,t),u=t?s.pbStyle.borderUpColorProjection.value():s.pbStyle.borderUpColor.value(),d=t?s.pbStyle.borderDownColorProjection.value():s.pbStyle.borderDownColor.value();i.barColor=a?l:c,i.barBorderColor=a?u:d,i.isBarUp=a},o.prototype._applyKagiStyle=function(e,t,i,r,s){i.upColor=o.upColor(s,t),i.downColor=o.downColor(s,t);var n=null,a=this.findBar(e,t,r);a[TradingView.LOW_PLOT]<a[TradingView.ADT_PLOT]&&a[TradingView.ADT_PLOT]<a[TradingView.HIGH_PLOT]?(n=a[TradingView.OPEN_PLOT]<=a[TradingView.CLOSE_PLOT],i.isTwoColorBar=!0):(n=a[TradingView.OPEN_PLOT]<=a[TradingView.CLOSE_PLOT]?a[TradingView.OPEN_PLOT]===a[TradingView.ADT_PLOT]:a[TradingView.OPEN_PLOT]!==a[TradingView.ADT_PLOT],i.isTwoColorBar=!1),i.barColor=n?i.upColor:i.downColor,i.isBarUp=a[TradingView.OPEN_PLOT]<=a[TradingView.CLOSE_PLOT]},o.prototype._applyPnfStyle=function(e,t,i,r,s){var n=this.findBar(e,t,r)[TradingView.ADT_PLOT],a=n>0,l=o.upColor(s,t),c=o.downColor(s,t);i.isBarUp=a,i.isMergedBar=2===Math.abs(n),i.upColor=l,i.downColor=c,i.barColor=a?l:c},o.prototype._applyBaseLineStyle=function(e,t,i,r,s){var n=this.findBar(e,t,r),a=s.baselineStyle,l=this._series.priceScale(),c=Math.round(l.height()*(Math.abs(100-a.baseLevelPercentage.value())/100)),u=this._series.firstValue(),d=l.coordinateToPrice(c,u);n[TradingView.CLOSE_PLOT]>d?i.barColor=o.upColor(s,t):i.barColor=o.downColor(s,t)},o.prototype._applyHiLoStyle=function(e,t,i,r,s){i.barColor=o.upColor(s,t),i.barBorderColor=s.hiloStyle.borderColor.value()},o.prototype.applyBarStyle=function(e,t,i,r){i||(i={}),i.barColor=null,i.barBorderColor=null,i.barWickColor=null,i.isBarHollow=null,i.isBarUp=null,i.upColor=null,i.downColor=null,i.isTwoColorBar=null,i.isMergedBar=null;var s=this._series.properties(),n=s.style.value();switch(n){case TradingView.Series.STYLE_LINE:this._applyLineStyle(e,t,i,r,s);break;case TradingView.Series.STYLE_AREA:this._applyAreaStyle(e,t,i,r,s);break;case TradingView.Series.STYLE_BARS:this._applyBarStyle(e,t,i,r,s);break;case TradingView.Series.STYLE_CANDLES:this._applyCandleStyle(e,t,i,r,s);break;case TradingView.Series.STYLE_HOLLOW_CANDLES:this._applyHollowCandleStyle(e,t,i,r,s);break
;case TradingView.Series.STYLE_HEIKEN_ASHI:this._applyHAStyle(e,t,i,r,s);break;case TradingView.Series.STYLE_BASELINE:this._applyBaseLineStyle(e,t,i,r,s);break;case TradingView.Series.STYLE_HILO:this._applyHiLoStyle(e,t,i,r,s)}switch(n){case TradingView.Series.STYLE_RENKO:this._applyRenkoStyle(e,t,i,r,s);break;case TradingView.Series.STYLE_PB:this._applyPBStyle(e,t,i,r,s);break;case TradingView.Series.STYLE_KAGI:this._applyKagiStyle(e,t,i,r,s);break;case TradingView.Series.STYLE_PNF:this._applyPnfStyle(e,t,i,r,s)}return TradingView.Series.STYLE_RANGE===n&&this._applyRangeStyle(e,t,i,r,s),i},o.prototype.getSeriesBars=function(e){return e?this._series.nsBars():this._series.bars()},o.prototype._findBarFieldValue=function(e,t,i){var r=this.getSeriesBars(i).valueAt(e);if(null!==r)return r[t]},o.prototype.findBar=function(e,t,i){return i?i.value:this.getSeriesBars(t).valueAt(e)||[]},o.prototype.findPrevBar=function(e,t,i){if(i&&i.previousValue)return i.previousValue;var s=this._series.bars().search(e-1,r.NearestLeft,TradingView.CLOSE_PLOT);return null!==s?s.value:[]},inherit(a,n),a.prototype.getBars=function(){return this._study.series().bars()},a.prototype.firstColoredBar=function(e){for(var t=e,i=0;i<this.backColorers.length;i++)t=Math.min(t,this.backColorers[i].firstColoredBar(e));var r=this.getOffset(this._plotIndex);t=Math.min(t,e+r);var s=this.getBars().firstIndex();return Math.max(t,s)},a.prototype.getOffset=function(){var e=this._study.metaInfo().plots[this._plotIndex];return this._study.offset(e.id)},a.prototype.applyBarStyle=function(e,t,i){if(i||(i={}),t)return i;var r=this._study.properties();if(!r.visible.value())return i;var n=this._study.metaInfo(),o=this._study.data();if(!o||0===o.size())return i;var a=n.plots[this._plotIndex],l=this.getOffset();if(this._study.getMinFirstBarIndexForPlot(a.id)>e+l)return i;var c=r.styles[a.id];if(c.visible&&!c.visible.value())return i;var u=o.valueAt(e-l);if(null===u)return i;var d=u[this._plotIndex+1];if(null==d)return i;if(d=Math.round(d),n.isRGB)i.barColor=s(d),i.upColor=i.barColor,i.downColor=i.barColor;else{var h=n.plots[this._plotIndex].palette,p=r.palettes[h],_=n.palettes[h].valToIndex?n.palettes[h].valToIndex[d]:d,m=p.colors[_].color.value();i.barColor=m,i.upColor=m.color,i.downColor=m.color}return i},t.SeriesBarColorer=o,t.StudyBarColorer=a},87504:(e,t,i)=>{"use strict";i.d(t,{BarsRange:()=>s});var r=i(16282);class s{constructor(e,t){(0,r.assert)(e<=t,"The last bar in the bars range should be greater than or equal to the first bar"),this._firstBar=e,this._lastBar=t}firstBar(){return this._firstBar}lastBar(){return this._lastBar}count(){return this._lastBar-this._firstBar+1}contains(e){return this._firstBar<=e&&e<=this._lastBar}equals(e){return this._firstBar===e.firstBar()&&this._lastBar===e.lastBar()}static compare(e,t){return null===e||null===t?e===t:e.equals(t)}}},5991:(e,t,i)=>{"use strict";i.d(t,{ChartEventsSource:()=>O,supportedCurrenciesForChartEvents:()=>D})
;var r=i(16282),s=i(96861),n=i(70734),o=i(27937),a=i.n(o),l=i(54059),c=i(72927),u=i(93669),d=i(72777),h=i(2441),p=i(14900),_=i(3707),m=i(62288),f=i(56288),g=i(72543),v=i(59503),S=i(833),y=i(71044),b=i(64348);class w{constructor(){this._data=null,this._hitTest=null}setData(e){this._data=e}setHitTest(e){this._hitTest=e}draw(e,t){const i=this._data;if(null===i)return;const r=i.centerPoint.x,s=i.centerPoint.y,n=i.diameter,o=n/2;e.fillStyle=i.backColor,(0,p.drawScaled)(e,t.pixelRatio,()=>{(0,b.createCircle)(e,r,s,o-1),e.fill(),e.drawImage(i.template,r-o,s-o,n,n)})}hitTest(e,t){const i=this._data;return null!==i&&(0,y.pointInCircle)(e,new c.Point(i.centerPoint.x,i.centerPoint.y),i.diameter/2)?this._hitTest:null}}var P=i(4033);const C=u.colorsPalette["color-banana-yellow-500"],T=u.colorsPalette["color-tan-orange-500"],x=u.colorsPalette["color-ripe-red-500"],I=(0,d.getLogoUrlResolver)();function L(e){const t=v.dateFormatProperty.value();return new S.DateTimeFormatter({dateFormat:t,timeFormat:"%h:%m",dateTimeSeparator:"   "}).format(e)}class M{constructor(e,t,i){this._renderer=new f.CompositeRenderer,this._invalidated=!1,this._templatesCache=null,this._clickedSource=null,this._series=e,this._source=t,this._showTooltipHandler=i}update(){this._invalidated=!0}renderer(e,t){return this._invalidated&&(this._updateImpl(e,t),this._invalidated=!1),this._renderer}onClickOutside(){this.clearLastClicked()}clearLastClicked(){this._clickedSource=null}_updateImpl(e,t){this._createTemplates();const i=(0,r.ensureNotNull)(this._templatesCache);this._renderer.clear();const s=this._source.getAllGroups();if(null===s)return;const n=this._series.model().lastHittestData(),o=this._source.properties().childs().breaks,a=o.childs().visible.value();if(a)for(let t=0;t<s.length;t++){const i=new g.VerticalLineRenderer;i.setData({color:o.childs().color.value(),linestyle:o.childs().style.value(),linewidth:o.childs().width.value(),x:s[t].x,top:0,bottom:e-2-22*s[t].groups.length}),this._renderer.append(i)}const l=new p.Size(t,e),u=this._chartEventBackgroundColor();let d,h;for(let t=s.length-1;t>=0;t--){const o=s[t];for(let p=o.groups.length-1;p>=0;p--){const f=o.groups[p],v=f.items[0].currency,S=f.maxImportance,y=new w;let b=!1;if(this._series.model().hoveredSource()===this._source&&null!==n){const e=n.activeItem;b=e.groupIndex===s[t].index&&e.itemIndex===p}const P=this._clickedSource&&this._clickedSource.groupIndex===o.index&&this._clickedSource.itemIndex===p;let C;C=b||P?i.hovered.get(v):S<-.5?i.low.get(v):S<.5?i.mid.get(v):i.hi.get(v);const T=new c.Point(o.x,e-2-22*(p+1)+11),x={template:(0,r.ensureDefined)(C),centerPoint:T,diameter:22,backColor:u},I={activeItem:{groupIndex:o.index,itemIndex:p},clickHandler:this._chartEventMouseClickHandler.bind(this,o,p,T,l),tapHandler:this._chartEventMouseClickHandler.bind(this,o,p,T,l)};y.setData(x),y.setHitTest(new m.HitTestResult(m.HitTestResult.CUSTOM,I)),P?(d=y,a||(h=new g.VerticalLineRenderer,h.setData({color:"#535353",linestyle:_.LINESTYLE_DASHED,linewidth:1,x:o.x,top:0,bottom:e-2-22*o.groups.length
}))):this._renderer.append(y)}}h&&this._renderer.append(h),d&&this._renderer.append(d)}_chartEventBackgroundColor(){return this._series.model().isDark()?u.colorsPalette["color-cold-gray-900"]:u.colorsPalette["color-white"]}_chartEventMouseClickHandler(e,t,i,r,s){if(null!==this._clickedSource&&this._clickedSource.groupIndex===e.index&&this._clickedSource.itemIndex===t)return void(this._clickedSource=null);this._clickedSource={groupIndex:e.index,itemIndex:t};const n={target:s.target,targetSize:r,point:new c.Point(i.x,i.y-11-10),marginTop:15};this._showTooltipHandler(n,()=>{const i=e.groups[t].items.slice(),r=this._source.timezone();return i.sort((e,t)=>{var i,r;const s=null!==(i=e.importance)&&void 0!==i?i:0;return(null!==(r=t.importance)&&void 0!==r?r:0)-s}).map(e=>this._createTooltipContentForItem(e,r))})}_createTooltipContentForItem(e,t){let i;const r=e.importance;return i=!Number.isFinite(r)||r<0?C:r<1?T:x,{title:e.indicator,subTitle:L((0,P.utc_to_cal)(t,e.timestamp)),content:[{content:[{name:"Actual",value:null!==e.actual?e.actual.toString():"—"},{name:"Forecast",value:null!==e.forecast?e.forecast.toString():"—"},{name:"Previous",value:null!==e.previous?e.previous.toString():"—"}]}],style:{color:i}}}_createTemplates(){if(!this._templatesCache){this._templatesCache={hi:new Map,hovered:new Map,low:new Map,mid:new Map};for(let e=0;e<D.length;e++){const t=D[e];this._createTemplateCircle(this._templatesCache.low,t,C),this._createTemplateCircle(this._templatesCache.mid,t,T),this._createTemplateCircle(this._templatesCache.hi,t,x),this._createTemplateCircle(this._templatesCache.hovered,t,u.colorsPalette["color-brand-hover"])}}}_createTemplateCircle(e,t,i){const r=(0,p.createDisconnectedCanvas)(document,new p.Size(44,44)),s=(0,p.getPrescaledContext2D)(r);e.set(t,r);const n=()=>{const i=new Image;i.onload=()=>{e.set(t,i)},i.src=r.toDataURL()},o=Math.floor(22),a=()=>{s.beginPath(),s.arc(o,o,20.5,0,2*Math.PI),s.closePath(),s.lineWidth=3,s.strokeStyle=i,s.stroke()},l=t.slice(0,2);if((0,h.isCountryCode)(l)){const e=new Image;e.onload=()=>{(e=>{e.width=32,e.height=32,s.drawImage(e,o-16,o-16,32,32),s.globalCompositeOperation="destination-in",s.beginPath(),s.arc(o,o,16,0,2*Math.PI),s.closePath(),s.fillStyle="white",s.fill(),s.globalCompositeOperation="source-over"})(e),a(),n(),this._source.invalidate()},e.crossOrigin="anonymous",e.src=I.getCountryFlagUrl(l,d.LogoSize.Medium)+"?resetCache=true"}else a(),n()}}var E=i(2459),A=i(37796),k=i(51136);const D=["EUR","USD","JPY","GBP","CHF","AUD","CAD","NZD","CNY"],R=n.sortSourcesPreOrdered.ChartEventsSource;function N(e,t,i){return i?e.getTime():(0,P.cal_to_utc)(t,e)}class O extends s.DataSource{constructor(e,t){if(super(),this.toolname="ChartEventsSource",this._distribution=null,this._coordinates=null,this._timezone=(0,P.get_timezone)("invalid"),this._chartEvents=null,this._cachedTimescaleState=null,this._minImportance=null,this._symbolName=null,this._sessionSpecCache=null,this._series=e,t&&t.fixedData){this._distribution=t.fixedData
;const i=e.model().properties().chartEventsSourceProperties.state();i.visible=!0,this._properties=new(a())(i)}else this._chartEvents=new l.ChartEvents({minImportance:1}),this._properties=e.model().properties().chartEventsSourceProperties;this.setOwnerSource(e),this._paneView=new M(this._series,this,this._showTooltip.bind(this)),this._series.dataEvents().completed().subscribe(this,this._recalcDistribution),this._chartEvents&&this._chartEvents.changed.subscribe(this,this._recalcDistribution),this._properties.subscribe(this,this._recalcDistribution),this._recalcDistribution()}getAllGroups(){return this._coordinates||this._recalcCoordinates(),this._coordinates}timezone(){return this._timezone}destroy(){this._series.dataEvents().completed().unsubscribeAll(this),this._properties.unsubscribeAll(this)}zorder(){return R}isSpeciallyZOrderedSource(){return!0}title(){return"Chart Events"}showInObjectTree(){return!1}onClickOutside(){this._paneView.onClickOutside()}properties(){return this._properties}updateAllViews(){const e=this._series.model().timeScale();if(!e)return;this._paneView.update();const t={width:e.width(),barSpacing:e.barSpacing(),logicalRange:e.logicalRange()};this._cachedTimescaleState&&this._cachedTimescaleState.width===t.width&&this._cachedTimescaleState.barSpacing===t.barSpacing&&k.LogicalRange.compare(this._cachedTimescaleState.logicalRange,t.logicalRange)||(this._cachedTimescaleState=t,this._coordinates=null)}paneViews(){if(!this._properties.childs().visible.value())return null;const e=this._series.symbolInfo();return!e||"bitcoin"!==e.type&&"crypto"!==e.type?[this._paneView]:null}invalidate(){this._series.model().updateSource(this)}isUserDeletable(){return!1}isSavedInChart(e){return!!e}state(e){if(this._distribution||this._recalcDistribution(),!this._distribution)return null;const t={type:"ChartEventsSource",id:this.id(),state:null,zorder:this.zorder()};if(e){const e={},i=Object.keys(this._distribution).map(Number).filter(isFinite).sort((e,t)=>t-e);let r=1/0;const s=this._series.model().timeScale().visibleBarsStrictRange();null!==s&&(r=s.firstBar());let n=0;for(let t=0;t<i.length&&!(n>300);t++){const s=i[t];if(s<r)break;e[s]=[];const o=this._distribution[s];for(let t=0;t<o.length&&!(n>400);t++){e[s][t]=[];const i=this._distribution[s][t];for(let r=0;r<i.items.length&&!(n>400);r++)e[s][t][r]=i.items[r],n++}}t.state={distribution:e}}return t}static createFromState(e,t,i){var r,s,n,o,a;if(!t)return null;const l=i.mainSeries();if(!l)return null;const c=e&&e.state&&e.state.distribution;if(!c)return null;const u={};for(const e of Object.keys(c)){const t=e,i=c[t];u[t]=[];for(const e of Object.keys(i)){const l=i[e],c=l.reduce((e,t)=>e.importance>t.importance?e:t).importance;u[t].push({items:l,maxImportance:c});for(const e of l)e.actual=null!==(r=e.actual)&&void 0!==r?r:null,e.forecast=null!==(s=e.forecast)&&void 0!==s?s:null,e.previous=null!==(n=e.previous)&&void 0!==n?n:null,e.title=null!==(o=e.title)&&void 0!==o?o:"",e.importance=null!==(a=e.importance)&&void 0!==a?a:0}}return new O(l,{fixedData:u})}
_recalcDistribution(){const e=this._series.symbolInfo();if(null===e)return;let t=this._series.model().timezone();t&&"exchange"!==t||(t=e.timezone);const i=(0,P.get_timezone)(t);if(this._timezone=i,!this._chartEvents)return;if(this._coordinates=null,this._distribution=null,!this._properties.childs().visible.value())return;if(!e||!e.name||e.name.length<6)return;if("forex"!==e.type&&"cfd"!==e.type&&"bitcoin"!==e.type&&"crypto"!==e.type)return;const s=this._series.model().timeScale().tickMarks(),n=s.maxIndex;if(void 0===n)return;const o=this._series.data().bars(),a=o.firstIndex(),l=o.lastIndex();if(null===a||null===l)return;let c=null;const u=e.name;let d,h=0;for(let t=0;t<2;t++){let t;"bitcoin"!==e.type&&"crypto"!==e.type||"DOGE"!==u.substr(h,4).toUpperCase()?(t=u.substr(h,3).toUpperCase(),h+=3):(t="DOGE",h+=4),-1!==D.indexOf(t)&&(c||(c={}),c[t]=!0)}if(!c)return;const p=E.Interval.parse(this._series.interval());if(!p.isValid())return;let _=NaN;switch(p.kind()){case E.ResolutionKind.Weeks:_=168*p.multiplier();break;case E.ResolutionKind.Days:_=24*p.multiplier();break;case E.ResolutionKind.Minutes:_=p.multiplier()/60;break;case E.ResolutionKind.Seconds:_=p.multiplier()/3600;break;default:return}if(_<4)d=-1;else if(_<48)d=0;else{if(!(_<672))return;d=1}this._minImportance===d&&this._symbolName===u||(this._chartEvents.reset({minImportance:d,currencyFilter:Object.keys(c)}),this._minImportance=d,this._symbolName=u);const m=this._chartEvents.items(),f={};this._distribution=f;let g=a;if(this._properties.childs().futureOnly.value()&&(g=Math.max(g,l)),!isFinite(g))return;const v=n,S=m.length;let y=0;const b=p.isDWM(),w=s.indexToTime(v);if(w){const e=N(w,i,b);for(;y<m.length&&!(m[y].timestamp<=e);y++);}const C=N((0,r.ensureNotNull)(s.indexToTime(g)),i,b),T=this._getSessionSpec(e);for(let e=v;e>=g;e--){const t=s.indexToTime(e);if(!t)continue;const r=N(t,i,b);for(;;y++){if(y>=S)return void(this._chartEvents.minObtainedTimestamp>C&&this._chartEvents.requestMore({from:C}));const t=m[y];if(c&&!c[t.currency])continue;let s,n=t.timestamp;if(b){const e=(0,P.utc_to_cal)(i,n);T.correctTradingDay(e),(0,P.set_hms)(e,0,0,0,0),n=e.getTime()}if(t.timestamp<r)break;for(f[e]||(f[e]=[]),s=f[e].length;s--;){const i=f[e][s];if(i.items[0].currency===t.currency){i.items.push(t),t.importance>i.maxImportance&&(i.maxImportance=t.importance);break}}s<0&&f[e].push({items:[t],maxImportance:t.importance})}}}_recalcCoordinates(){this._distribution||this._recalcDistribution(),this._coordinates=null;const e=this._distribution;if(!e)return;const t=this._series.model().timeScale(),i=t.visibleBarsStrictRange();if(null===i)return;const r=i.lastBar(),s=[];for(let n=i.firstBar();n<=r;n++)e[n]&&s.push({x:t.indexToCoordinate(n),groups:e[n],index:n});this._coordinates=s.length>0?s:null}async _showTooltip(e,t){
const r=this._series.model().timeScale(),s=[r.onScroll(),r.barSpacingChanged(),this._series.onSymbolIntervalChanged()],n=this.onClickOutside.bind(this),o=this._paneView.clearLastClicked.bind(this._paneView),a=await Promise.all([i.e(37610),i.e(43894),i.e(24115),i.e(73935),i.e(45867),i.e(49039)]).then(i.bind(i,80834));a.showLollipopTooltip({items:t(),position:e,customCloseSubscriptions:s,onClickOutside:n,onCustomClose:o,showScrollFades:!0,cardType:a.LollipopCardType.Minimal})}_getSessionSpec(e){return null!==this._sessionSpecCache&&this._sessionSpecCache.session===e.session&&this._sessionSpecCache.timezone===e.timezone&&this._sessionSpecCache.holidays===e.session_holidays&&this._sessionSpecCache.corrections===e.corrections||(this._sessionSpecCache={sessionSpec:new A.SessionSpec(e.timezone,e.session,e.session_holidays,e.corrections),session:e.session,timezone:e.timezone,holidays:e.session_holidays,corrections:e.corrections}),this._sessionSpecCache.sessionSpec}}window.TradingView.ChartEventsSource=O},98853:(e,t,i)=>{"use strict";i.d(t,{ChartModelBase:()=>li});var r=i(99479),s=i(16282),n=i(72927),o=i(14563),a=i(93669),l=i(87479),c=i(29098),u=i(54917),d=i(57137),h=i(88001),p=i(94209),_=i(68793),m=i(4543),f=i(87048);class g{constructor(){this._items=[],this._set=new Set,this._dataSourcesCache=null,this._customSourcesCache=null,this._lineSourcesCache=null}isEmpty(){return 0===this._items.length}add(e){if(this._items.length>0&&!(0,f.isLineTool)(this._items[0])&&this.clear(),(0,f.isLineTool)(e)){const t=(0,m.lowerbound)(this._items,e,(e,t)=>e.zorder()<t.zorder());this._items.splice(t,0,e)}else this.clear(),this._items=[e];this._set.add(e),this._invalidateCache()}canBeAddedToSelection(e){return 0===this._items.length||(0,f.isLineTool)(this._items[0])&&(0,f.isLineTool)(e)}isSelected(e){return this._set.has(e)}allSources(){return this._items.slice(0)}dataSources(){return null===this._dataSourcesCache&&(this._dataSourcesCache=this._items.filter(_.isDataSource)),this._dataSourcesCache}lineDataSources(){return null===this._lineSourcesCache&&(this._lineSourcesCache=this._items.filter(f.isLineTool)),this._lineSourcesCache}customSources(){return null===this._customSourcesCache&&(this._customSourcesCache=this._items.filter(e=>!(0,_.isDataSource)(e))),this._customSourcesCache}checkLineToolSelection(){this._items.forEach(e=>(0,f.isLineTool)(e)&&e.calcIsActualSymbol()),this._items=this._items.filter(e=>!(0,f.isLineTool)(e)||e.isActualSymbol()),this._invalidateCache()}remove(e){this._items=this._items.filter(t=>t!==e),this._set.delete(e),this._invalidateCache()}clear(){this._items=[],this._set.clear(),this._invalidateCache()}_invalidateCache(){this._customSourcesCache=null,this._dataSourcesCache=null,this._lineSourcesCache=null}}var v=i(95294),S=i.n(v),y=i(97133),b=i(2459),w=i(1771),P=i(27937),C=i.n(P),T=i(32022),x=i(39304);class I{constructor(e){this._rendererOptions={borderSize:1,offsetSize:5,fontSize:NaN,font:"",color:"",paneBackgroundColor:"",paddingBottom:0,paddingInner:0,paddingOuter:0,paddingTop:0,lineSpacing:0},this._chartModel=e}
options(){const e=this._rendererOptions,t=this._chartModel.properties(),i=t.scalesProperties.fontSize.value();return e.fontSize!==i&&(e.fontSize=i,e.font=(0,T.makeFont)(i,x.CHART_FONT_FAMILY,""),e.paddingTop=2.5/12*i,e.paddingBottom=e.paddingTop,e.paddingInner=i/12*e.offsetSize,e.paddingOuter=i/12*e.offsetSize,e.lineSpacing=2/12*i),e.color=t.scalesProperties.textColor.value(),e.paneBackgroundColor=t.paneProperties.background.value(),this._rendererOptions}}var L=i(31570),M=i(67642),E=i(11228),A=i(91513),k=i(22842),D=i(20554),R=i(42461);const N=new E.PriceFormatter;class O extends A.CustomSourceBase{constructor(e,t,i){super(e,t),this._studySource=null,this._paneViews=[],this._metaInfo=null,this._destroyed=!1,this._isStarted=!1,this._loadedGraphics=null,this._doubleClickHandler=i;const r=t.mainSeries();this._properties=new w.DefaultProperty("sessions"),this._removeDuplicateProperties(),this._properties.subscribe(this,this._onPropertiesChanged),t.studyMetaInfoRepository().findById({type:"java",studyId:"Sessions@tv-basicstudies"}).then(e=>{this._destroyed||null===this._loadedGraphics&&(this._setMetaInfo(e),null!==this._metaInfo&&(this._studySource=new L.StudyDataSource(t.chartApi(),r.seriesSource(),"sessions_",this._metaInfo),this._createPaneViews(),this._studySource.dataCleared().subscribe(this,this.updateAllViews),this._studySource.dataUpdated().subscribe(this,this.updateAllViews),this._studySource.setInputs({}),this._processHibernate()))}),t.timeScale().onReset().subscribe(this,this._clearData),t.timeScale().logicalRangeChanged().subscribe(this,this.updateAllViews),t.mainSeries().sessionIdProxyProperty().subscribe(this,this._updateVisibleOfPreAndPostMarketBackground),t.mainSeries().properties().childs().interval.subscribe(this,this._processHibernate),this._updateVisibleOfPreAndPostMarketBackground(t.mainSeries().properties().childs().sessionId)}start(){this._isStarted=!0,this._processHibernate()}restart(){this._clearData(),k.enabled("stop_study_on_restart")&&this.stop(),this.start()}isStarted(){return this._isStarted}stop(){this._isStarted=!1,null!==this._studySource&&this._studySource.stop()}isHoveredEnabled(){return!1}paneViews(e){return this._paneViews}updateAllViews(){this._paneViews.forEach(e=>e.update())}updateViewsForPane(e){this.updateAllViews()}destroy(){this._destroyed=!0,null!==this._studySource&&(this._studySource.dataCleared().unsubscribeAll(this),this._studySource.dataUpdated().unsubscribeAll(this),this._studySource.destroy(),this._studySource=null),this._model.timeScale().logicalRangeChanged().unsubscribeAll(this),this._model.timeScale().onReset().unsubscribeAll(this),this._model.mainSeries().sessionIdProxyProperty().unsubscribeAll(this),this._model.mainSeries().properties().childs().interval.unsubscribeAll(this),this._properties.unsubscribeAll(this)}series(){return this._model.mainSeries()}priceScale(){return this.series().priceScale()}graphics(){return this._loadedGraphics||(0,s.ensureNotNull)(this._studySource).graphics()}properties(){return this._properties}graphicsInfo(){return(0,
s.ensureNotNull)(this._metaInfo).graphics}firstValue(e){return this._model.mainSeries().firstValue()}formatter(){return N}state(e){const t={properties:this._properties.state()};return e&&null!==this._metaInfo&&(t.data={graphics:(0,M.saveStudyGraphics)(this.graphics()),metaInfo:this._metaInfo}),t}restoreState(e,t){const i=e.properties;this._migrateOutOfSessionProperty(i),this._properties.mergeAndFire(i),this._removeDuplicateProperties(),this._updateVisibleOfPreAndPostMarketBackground(this._model.mainSeries().properties().childs().sessionId),void 0!==e.data&&t&&(this._loadStudyGraphics(e.data.graphics),this._setMetaInfo(e.data.metaInfo),this._createPaneViews())}restoreOldState(e,t){const i={properties:{graphics:e.state.graphics}};void 0!==e.data&&void 0!==e.metaInfo&&t&&(i.data={metaInfo:e.metaInfo,graphics:e.data.graphics}),this.restoreState(i,t)}applyPreferences(e){this._properties.mergePreferences(e)}metaInfo(){return(0,s.ensureNotNull)(this._metaInfo)}_loadStudyGraphics(e){const t=e.backgrounds;if(void 0!==t){const e=t.findIndex(e=>"inSession"===e.styleId);-1!==e&&t.splice(e,1)}this._loadedGraphics=(0,M.loadStudyGraphics)(e)}_setMetaInfo(e){const t=e.graphics.backgrounds;void 0!==t&&void 0!==t.inSession&&delete t.inSession,this._metaInfo=e}_updateVisibleOfPreAndPostMarketBackground(e){const t=!(0,D.isRegularSessionId)(e.value());this._outOfSessionVisibilityProperty().setValue(t),this._preMarketVisibilityProperty().setValue(t),this._postMarketVisibilityProperty().setValue(t)}_clearData(){null!==this._studySource&&this._studySource.clearData()}_createPaneViews(){const e={doubleClickHandler:this._doubleClickHandler};(0,M.createGraphicsPaneViews)(this,this._model,e).then(e=>{this._paneViews=e,this._model.lightUpdate()})}_onPropertiesChanged(){this._processHibernate(),this.updateAllViews()}_processHibernate(){if(null!==this._studySource){const e=this._canBeHibernated(),t=this._isHibernated(),i=this._studySource.isStarted();!t&&e&&i?this._studySource.stop():!t||e||i||this._studySource.start()}}_canBeHibernated(){const e=this._model.mainSeries(),t=this._preMarketVisibilityProperty().value()&&this._postMarketVisibilityProperty().value()&&this._outOfSessionVisibilityProperty().value();return e.isDWM()||!t&&!this._vertLinesVisibleProperty().value()}_isHibernated(){return this._isStarted&&(null===this._studySource||!this._studySource.isStarted())}_outOfSessionVisibilityProperty(){return this._properties.childs().graphics.childs().backgrounds.childs().outOfSession.childs().visible}_preMarketVisibilityProperty(){return this._properties.childs().graphics.childs().backgrounds.childs().preMarket.childs().visible}_postMarketVisibilityProperty(){return this._properties.childs().graphics.childs().backgrounds.childs().postMarket.childs().visible}_vertLinesVisibleProperty(){return this._properties.childs().graphics.childs().vertlines.childs().sessBreaks.childs().visible}_removeDuplicateProperties(){this._properties.hasChild("properties")&&(this._properties.removeProperty("properties"),(0,w.saveDefaultProperties)(!0),
this._properties.childChanged("",null),(0,w.saveDefaultProperties)(!1))}_migrateOutOfSessionProperty(e){const t=e.graphics.backgrounds;if(void 0!==t){const i=t.outOfSession;i.color===(0,s.ensureDefined)(R.sessionsPreferencesDefault.graphics.backgrounds).outOfSession.color||"postMarket"in t||(e.graphics.backgrounds={...t,postMarket:{color:i.color,transparency:i.transparency,visible:i.visible},preMarket:{color:i.color,transparency:i.transparency,visible:i.visible}})}}}var V=i(55304),B=i(96276),F=i.n(B),W=i(65066),U=i.n(W),H=i(94420),z=i(86483),j=i(20220),Y=i(71928),G=i(87380),q=i(68450),X=i(84162),$=i(31565),K=i(21318),J=i(87504),Z=i(51136);const Q=(0,G.getLogger)("Chart.TimePoints");class ee{constructor(){this._zoffset=0,this._items=[]}clear(){this._zoffset=0,this._items=[]}size(){return this._items.length}firstIndex(){return this._offsetToIndex(0)}lastIndex(){return this._offsetToIndex(this._items.length-1)}merge(e,t,i){if(0===i.length)return Q.logError("merge: 'values' does not contain any time points"),[];if(t>this._zoffset&&e+t>0)return Q.logError("merge: when the first time point index is updated, we should fill the time points starting from the first one"),[];if(0===this._items.length)return this._items=i,this._zoffset=t,[{change:"rebuild",index:this._validOffsetToIndex(0)}];const r=e+this._zoffset;if(r<0){const s=Math.abs(r);if(i.length<s)return Q.logError("merge: 'values' does not contain enough time points to fill in the new items. 'index': "+e.toString()+", previous 'zoffset': "+this._zoffset.toString()+", new 'zoffset': "+t.toString()+", 'values.length': "+i.length),[];this._items=new Array(s).concat(this._items),this._zoffset=t;for(let r=0;r<i.length;++r)this._items[e+r+t]=i[r];return[{change:"rebuild",index:this._validOffsetToIndex(0)}]}const s=[];let n=r;for(;n<this._items.length&&n-r<i.length;++n)this._items[n]=i[n-r],s.push({change:"update",index:this._validOffsetToIndex(n),value:i[n-r]});const o=r+i.length;if(o>this._items.length){const e=o-this._items.length;for(let t=n;t<n+e;++t){const e=this._items.length;this._items.push(i[t-r]),s.push({change:"append",index:this._validOffsetToIndex(e),value:i[t-r]})}}else{for(let e=o;e<this._items.length;++e)s.push({change:"remove",index:this._validOffsetToIndex(e),value:this._items[e]});this._items.length=o}return this._zoffset=t,s}addTail(e,t){for(let i=t?1:0;i<e.length;i++)this._items.push(e[i])}remove(e){const t=this._indexToOffset(e);if(null===t)return[];const i=this._items.splice(t),r=[];for(let t=0;t<i.length;t++)r.push({change:"remove",index:e+t,value:i[t]});return r}valueAt(e){const t=this._indexToOffset(e);return null!==t?this._items[t]:null}indexOf(e,t){if(this._items.length<1)return null;if(e>this._items[this._items.length-1])return t?this._validOffsetToIndex(this._items.length-1):null;for(let i=0;i<this._items.length;++i){if(e===this._items[i])return this._validOffsetToIndex(i);if(e<this._items[i])return t?this._validOffsetToIndex(i):null}return null}state(){return{items:this._items,zoffset:this._zoffset}}restoreState(e){
null!==e&&(this._items=e.items,this._zoffset=e.zoffset)}roughTime(e,t=null){const i=this.valueAt(e);if(null!==i)return i;const r=this._items;if(!r.length||r.length<2)return null;const s=r.length-1,n=this._validOffsetToIndex(0),o=this._validOffsetToIndex(s),a=r[0],l=r[s],c=(l-a)/(o-n);if(e<n){return a-(n-e)*c}if(e>o){const i=e-o;if(i<500&&null!=t)return t(l,i);return l+i*c}return null}roughIndex(e,t=null){const i=this._items;if(!i.length||i.length<2)return null;const r=i.length-1,s=this._validOffsetToIndex(0),n=this._validOffsetToIndex(r),o=i[0],a=i[r];if(e>=o&&e<=a)return this.closestIndexLeft(e);const l=(a-o)/(n-s);if(e<o){const t=o-e;return s-Math.round(t/l)}if(e>a){const i=e-a;let r=Math.trunc(i/l);if(r<500&&null!==t){const i=t(a,e);i.success&&(r=i.result)}return n+r}return null}closestIndexLeft(e){const t=this._items;if(!t.length)return null;if(Number.isNaN(e))return null;let i=t.length-1;if(e>=t[i])return this._validOffsetToIndex(i);let r=0;const s=t[r];if(e<s)return null;if(e===s)return this._validOffsetToIndex(r);for(;i>r+1;){const s=r+i>>1,n=t[s];if(n>e)i=s;else{if(!(n<e))return n===e?this._validOffsetToIndex(s):null;r=s}}return this._validOffsetToIndex(r)}_validOffsetToIndex(e){return e-this._zoffset}_offsetToIndex(e){return 0<=e&&e<this.size()?this._validOffsetToIndex(e):null}_indexToOffset(e){const t=e+this._zoffset;return 0<=t&&t<this.size()?t:null}}const te=new Map([[0,.1],[11,.1],[1,.35],[9,.35],[12,.35],[8,.35]]);class ie{constructor(e,t){this._styleSpecificRanges=new Map,this._logicalRange=e,this._defaultStyle=t}strictRange(e){if(null===this._logicalRange)return null;void 0===e&&(e=this._defaultStyle);let t=this._styleSpecificRanges.get(e);if(void 0===t){const i=(te.get(e)||0)/2;t=new J.BarsRange(Math.floor(this._logicalRange.left()+i),Math.ceil(this._logicalRange.right()-i)),this._styleSpecificRanges.set(e,t)}return t}logicalRange(){return this._logicalRange}isValid(){return null!==this._logicalRange}static invalid(){return new ie(null,1)}}var re=i(28901),se=i(84434);class ne{constructor(e,t=50){this._actualSize=0,this._usageTick=1,this._oldestTick=1,this._cache=new Map,this._tick2Labels=new Map,this._format=e,this._maxSize=t}format(e){const t=this._cache.get(e.valueOf());if(void 0!==t)return t.string;if(this._actualSize===this._maxSize){const e=this._tick2Labels.get(this._oldestTick);this._tick2Labels.delete(this._oldestTick),this._cache.delete((0,s.ensureDefined)(e)),this._oldestTick++,this._actualSize--}const i=this._format(e);return this._cache.set(e.valueOf(),{string:i,tick:this._usageTick}),this._tick2Labels.set(this._usageTick,e.valueOf()),this._actualSize++,this._usageTick++,i}}const oe={preserveBarSpacing:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!0,minBarSpacing:.5},ae=k.enabled("low_density_bars"),le=ae?1:2,ce=(0,G.getLogger)("Chart.TimeScale");let ue;class de{constructor(e,t){this._width=0,this._widthChanged=new(F()),this._rightOffset=10,this._rightOffsetChanged=new(F()),this._maxRightOffsetChanged=new(F()),this._defaultRightOffsetProperty=new(C())(10),this._baseIndex=null,
this._leftEdgeIndex=null,this._barSpacingChanged=new(F()),this._barSpacing=6,this._visibleBars=ie.invalid(),this._visibleBarsInvalidated=!0,this._visibleBarsChanged=new(F()),this._logicalRangeChanged=new(F()),this._points=new ee,this._tickMarks=new re.Tickmarks,this._onScroll=new(F()),this._resetDelegate=new(F()),this._scrollStartPoint=null,this._scaleStartPoint=null,this._commonTransitionStartState=null,this._formattedBySpan=new Map,this._requestingMoreData=!1,this._requestedTickmarksCount=0,this._endOfData=!1,this._options=(0,K.deepExtend)({},oe,t),this._model=e,this._scalesProperties=e.properties().scalesProperties,this._defaultRightOffsetProperty.listeners().subscribe(this,e=>{this.setRightOffset(e.value())}),this._options.preserveBarSpacing&&(this._barSpacing=this._scalesProperties.childs().barSpacing.value()||6),this._barSpacingChanged.subscribe(this,this._maxRightOffsetOnChanged),this._widthChanged.subscribe(this,this._maxRightOffsetOnChanged)}destroy(){this._barSpacingChanged.unsubscribeAll(this),this._barSpacingChanged.destroy(),this._widthChanged.unsubscribeAll(this),this._widthChanged.destroy()}isEmpty(){return 0===this._width||0===this._points.size()}update(e,t,i,r){this._visibleBarsInvalidated=!0,i.length>0&&this._points.merge(e,t,i),this._tickMarks.merge(r),this._correctOffset()}addTail(e,t,i){this._tickMarks.removeTail(t);const r=e.params,n=(0,s.ensureDefined)(this._tickMarks.maxIndex)+(i?0:1);for(let e=0;e<r.marks.length;e++)r.marks[e].index=n+e;this._tickMarks.addTail(r.marks),this._points.addTail(r.changes,i);const o=this._rightOffset-r.changes.length;this._updateRightOffset(o)}state(e){const t={m_barSpacing:this.barSpacing(),m_rightOffset:e?this._rightOffset:this._defaultRightOffsetProperty.value()};return e&&(t.points=this._points.state(),t.tickmarks=this._tickMarks.state(),t.width=this._width),t}restoreState(e,t){if(void 0===e.m_barSpacing)return void ce.logDebug("restoreState: invalid state");if(void 0===e.m_rightOffset)return void ce.logDebug("restoreState: invalid state");let i=e.m_barSpacing;const r=e.m_rightOffset<0&&!t?this.rightOffsetDefaultValue():e.m_rightOffset,s=r<0?this.rightOffsetDefaultValue():Math.round(r);this._defaultRightOffsetProperty.setValue(s),this._rightOffset=r,t&&(this._requestedTickmarksCount=1/0,this._endOfData=!0,this._points.restoreState(e.points||null),this._tickMarks.restoreState(e.tickmarks||null),e.width&&this._width>0&&(i*=this._width/e.width)),this._tryToUpdateBarSpacing(this._barSpacing,i),this._correctOffset(),this._rightOffsetChanged.fire(this._rightOffset)}marks(){if(this.isEmpty())return null;const e=this._barSpacing,t=5*((this._scalesProperties.childs().fontSize.value()||0)+4),i=Math.round(t/e),r=(0,s.ensureNotNull)(this.visibleBarsStrictRange()),n=Math.max(r.firstBar(),r.firstBar()-i),o=Math.max(r.lastBar(),r.lastBar()-i),a=this._tickMarks.build(e,t),l=[];for(const e of a){if(!(n<=e.index&&e.index<=o))continue;const t=this._tickMarks.indexToTime(e.index);null!==t&&l.push({coord:this.indexToCoordinate(e.index),label:this.formatLabel(t,e.span),span:e.span,
major:e.label>=se.DAY_SPAN})}return l}visibleBarsStrictRange(){return this._visibleBarsInvalidated&&(this._visibleBarsInvalidated=!1,this._updateVisibleBars()),this._visibleBars.strictRange()}visibleBarsStrictRangeChanged(){return this._visibleBarsChanged}logicalRangeChanged(){return this._logicalRangeChanged}tickMarks(){return this._tickMarks}points(){return this._points}width(){return this._width}setWidth(e,t){if(!Number.isFinite(e)||e<=0)return void ce.logWarn("setWidth: invalid argument: "+e);if(this._width===e)return;if(this._visibleBarsInvalidated=!0,(t||this._options.lockVisibleTimeRangeOnResize)&&this._width){const t=this._barSpacing*e/this._width;this._tryToUpdateBarSpacing(this._barSpacing,t)}else this._width&&this.setBarSpacing(this._barSpacing);if(null!==this._leftEdgeIndex){if((0,s.ensureNotNull)(this.visibleBarsStrictRange()).firstBar()<=this._leftEdgeIndex){const t=this._width-e;this._rightOffset-=Math.round(t/this._barSpacing)+1}}this._width=e,this._widthChanged.fire(e);const i=this._rightOffset;this._correctOffset(),this._rightOffset!==i&&this._rightOffsetChanged.fire(this._rightOffset),this._requestMoreData()}setLeftEdgeFix(e){this._leftEdgeIndex=e;const t=this.visibleBarsStrictRange();if(null===t)return;const i=t.firstBar()-e;if(i<0){const e=this._rightOffset-i-1;this.scrollToOffsetAnimated(e,500)}}indexToCoordinate(e){if(this.isEmpty())return 0;if(!(0,$.isInteger)(e))return 0;const t=this.baseIndex()+this._rightOffset-e;return this._width-(t+.5)*this._barSpacing-1}indexToUserTime(e){return this._tickMarks.indexToTime(e)}timePointToIndex(e){return this._points.indexOf(e,!0)}indexToTimePoint(e){return this._points.valueAt(e)}timeToCoordinate(e){const t=this._points.closestIndexLeft(e);if(null===t)return null;const i=(0,s.ensureNotNull)(this._points.valueAt(t)),r=this.indexToCoordinate(t);if(r<=0||r>=this._width)return null;const n=this.barSpacing(),o=this.baseIndex(),a=r+(e-i)/((0,s.ensureNotNull)(this._points.valueAt(o))-(0,s.ensureNotNull)(this._points.valueAt(o-1)))*n+1;return a<=0||a>=this._width?null:a}barIndexesToCoordinates(e){const t=this.baseIndex();for(const i of e){const e=i.time,r=t+this._rightOffset-e,s=this._width-(r+.5)*this._barSpacing-1;i.time=s,i.exactTime=s}}timedValuesToCoordinates(e){const t=this.baseIndex()+this._rightOffset,i=this._width-t*this._barSpacing-.5*this._barSpacing-1;for(const t of e)t.x=i+t.x*this._barSpacing}indexesToCoordinates(e,t){if(this.isEmpty())return;void 0===t&&(t=e.length);const i=this.baseIndex()+this._rightOffset,r=this._width-i*this._barSpacing-.5*this._barSpacing-1,s=this._barSpacing,n=e;for(let i=0;i<t;++i)(0,$.isInteger)(e[i])?n[i]=r+e[i]*s:n[i]=0}rightOffsetForTimePoint(e){const t=this.timeToCoordinate(e);return null===t?null:this._rightOffsetForCoordinate(t)}scrollToRealtime(e,t){let i=this._defaultRightOffsetProperty.value();i<0&&(i=this.rightOffsetDefaultValue());const r=()=>{void 0!==t&&t(),this._requestMoreData()};if(e){const e=this._rightOffset,t=this.maxRightOffset();t>0&&i>t&&(i=t);const s=this._model;(0,q.doAnimate)({from:e,to:i,
duration:1e3,easing:Y.easingFunc.easeInOutQuint,onComplete:r,onStep:(e,t)=>{this._visibleBarsInvalidated=!0,this._updateRightOffset(t),s.recalculateAllPanes(),s.lightUpdate(),s.recalcVisibleRangeStudies()}})}else this._visibleBarsInvalidated=!0,this._updateRightOffset(i),r()}scrollToFirstBar(){this._model.gotoTime(new Date("1800-01-01").getTime())}scrollToOffsetAnimated(e,t){if(!isFinite(e))throw new RangeError("offset is required and must be finite number");const i=void 0===t?400:t;if(!isFinite(i)||i<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const r=this._rightOffset,s=Date.now(),n=()=>{this._visibleBarsInvalidated=!0;const t=(Date.now()-s)/i;if(t>=1)return this._updateRightOffset(e),this._visibleBarsInvalidated=!0,this._model.recalculateAllPanes(),void this._model.lightUpdate();const o=r+(e-r)*t;this._updateRightOffset(o),this._model.recalculateAllPanes(),setTimeout(n,20)};n()}defaultRightOffsetProperty(){return this._defaultRightOffsetProperty}rightOffsetDefaultValue(){return 10}barSpacing(){return this._barSpacing}setBarSpacing(e){Number.isFinite(e)?(e=this.getValidBarSpacing(e),this._tryToUpdateBarSpacing(this._barSpacing,e)&&(this._correctOffset(),this._options.preserveBarSpacing&&((0,w.saveDefaultProperties)(!0),this._scalesProperties.childs().barSpacing.setValue(this._barSpacing),(0,w.saveDefaultProperties)(!1)))):ce.logWarn("setBarSpacing: invalid argument: "+e)}barSpacingChanged(){return this._barSpacingChanged}getValidBarSpacing(e){return null==e&&(e=this.barSpacing()),e<this.minBarSpacing()?this.minBarSpacing():e>this.maxBarSpacing()?this.maxBarSpacing():e}isValidBarSpacing(e){return e>=this.minBarSpacing()&&e<=this.maxBarSpacing()}preserveBarSpacing(){return this._options.preserveBarSpacing}normalizeBarIndex(e){let t=0,i=0;const r=this.baseIndex(),n=(0,s.ensureNotNull)(this._points.firstIndex());return e<n?(t=(0,s.ensureNotNull)(this._points.valueAt(n)),i=e-n):e>r?(t=(0,s.ensureNotNull)(this._points.valueAt(r)),i=e-r):(t=(0,s.ensureNotNull)(this._points.valueAt(e)),i=0),{time_t:t,offset:i}}denormalizeTimePoint(e){const t=this._points.indexOf(e.time_t,!1);if(null!==t)return t+e.offset}rightOffset(){return this._rightOffset}rightOffsetChanged(){return this._rightOffsetChanged}minRightOffset(){const e=this.points().firstIndex(),t=this._baseIndex;if(null===e||null===t)return null;if(null!==this._leftEdgeIndex){const e=this.width()/this._barSpacing;return this._leftEdgeIndex-t+e-1}return e-t-1+le}maxRightOffset(){return this.width()/this._barSpacing-le}maxRightOffsetChanged(){return this._maxRightOffsetChanged}onReset(){return this._resetDelegate}scrollStartPoint(){return this._scrollStartPoint}baseIndex(){return this._baseIndex||0}zoom(e,t,i){if(!Number.isFinite(e)||!Number.isFinite(t))return void ce.logWarn(`zoom: invalid arguments: ${e}, ${t}, ${i}`);const r=this.coordinateToIndex(e),s=this.barSpacing(),n=s+t*(s/10);this.setBarSpacing(n)
;(void 0!==i?!i:this._options.rightBarStaysOnScroll)||this.setRightOffset(this.rightOffset()-.5+(r-this._coordinateToFloatIndex(e))),this._requestMoreData()}zoomToBarsRange(e,t){if(null!==this._leftEdgeIndex&&(e=Math.max(e,this._leftEdgeIndex)),t<=e)return;const i=this.baseIndex(),r=this._rightOffset;this._rightOffset=t-i;const s=Math.max(t-e+1,le);this.setBarSpacing(this.width()/s),this._visibleBarsInvalidated=!0,this._correctOffset(),this._rightOffset!==r&&this._rightOffsetChanged.fire(this._rightOffset),this._requestMoreData()}coordinateToIndex(e){return Math.ceil(this._coordinateToFloatIndex(e))}coordinateToVisibleIndex(e){let t;t=this._barSpacing<1&&0===e?this.coordinateToIndex(-1)+1:this.coordinateToIndex(e);const i=this.visibleBarsStrictRange();return null===i||i.contains(t)||(t=Math.min(Math.max(i.firstBar(),t),i.lastBar())),t}canZoomIn(){return this.barSpacing()<this.maxBarSpacing()}canZoomOut(){return this.barSpacing()>this._options.minBarSpacing}minBarSpacing(){return this._options.minBarSpacing}maxBarSpacing(){const e=this.width();return ae?e:e/le}resetRightOffset(){this.setRightOffset(this._defaultRightOffsetProperty.value())}reset(){this._visibleBarsInvalidated=!0,this._points=new ee,this._scrollStartPoint=null,this._scaleStartPoint=null,this._clearCommonTransitionsStartState(),this._tickMarks.reset(),this._leftEdgeIndex=null,this._resetDelegate.fire(),this.disconnect()}disconnect(){this._requestingMoreData=!1,this._requestedTickmarksCount=0,this._endOfData=!1}setBaseIndex(e){Number.isFinite(e)?(this._visibleBarsInvalidated=!0,this._baseIndex=e,this._correctOffset()):ce.logDebug("setBaseIndex: invalid argument: "+e)}setRightOffset(e){Number.isFinite(e)?(this._visibleBarsInvalidated=!0,this._updateRightOffset(e)):ce.logWarn("setRightOffset: invalid argument: "+e)}correctBarSpacing(){this.isEmpty()||this.points().size()<this.width()/this.barSpacing()&&(this.setRightOffset(this._defaultRightOffsetProperty.value()),this.setBarSpacing(this.width()/(this.points().size()+this.rightOffset())))}logicalRange(){return this._visibleBarsInvalidated&&(this._visibleBarsInvalidated=!1,this._updateVisibleBars()),this._visibleBars.logicalRange()}restoreDefault(){this._visibleBarsInvalidated=!0,this.setBarSpacing(6),this.resetRightOffset(),this._requestMoreData()}restoreRightOffsetPropertyToDefault(){this._defaultRightOffsetProperty.setValue(this.rightOffsetDefaultValue())}startScale(e){this._scrollStartPoint&&this.endScroll(),null===this._scaleStartPoint&&null===this._commonTransitionStartState&&(this.isEmpty()||(this._scaleStartPoint=e,this._saveCommonTransitionsStartState()))}scaleTo(e){if(null===this._commonTransitionStartState)return;const t=(0,X.clamp)(this._width-e,0,this._width),i=(0,X.clamp)(this._width-(0,s.ensureNotNull)(this._scaleStartPoint),0,this._width);0!==t&&0!==i&&this.setBarSpacing(this._commonTransitionStartState.barSpacing*t/i)}endScale(){null!==this._scaleStartPoint&&(this._scaleStartPoint=null,this._clearCommonTransitionsStartState(),this._requestMoreData())}startScroll(e){
null===this._scrollStartPoint&&null===this._commonTransitionStartState&&(this.isEmpty()||(this._scrollStartPoint=e,this._saveCommonTransitionsStartState()))}scrollTo(e){if(this._visibleBarsInvalidated=!0,null===this._scrollStartPoint)return;const t=(this._scrollStartPoint-e)/this.barSpacing(),i=(0,s.ensureNotNull)(this._commonTransitionStartState).rightOffset+t;this._updateRightOffset(i),this._onScroll.fire()}endScroll(){null!==this._scrollStartPoint&&(this._scrollStartPoint=null,this._clearCommonTransitionsStartState(),this._requestMoreData())}formatLabel(e,t){let i=this._formattedBySpan.get(t);return void 0===i&&(i=new ne(e=>this.formatLabelImpl(e,t)),this._formattedBySpan.set(t,i)),i.format(new Date(e))}formatLabelImpl(e,t){if(!(e&&e instanceof Date))return"incorrect time";const i=this._model.mainSeries().isDWM();return t<se.MINUTE_SPAN&&!i?(0,E.numberToStringWithLeadingZero)(e.getUTCHours(),2)+":"+(0,E.numberToStringWithLeadingZero)(e.getUTCMinutes(),2)+":"+(0,E.numberToStringWithLeadingZero)(e.getUTCSeconds(),2):t<se.DAY_SPAN&&!i?(0,E.numberToStringWithLeadingZero)(e.getUTCHours(),2)+":"+(0,E.numberToStringWithLeadingZero)(e.getUTCMinutes(),2):t<se.WEEK_SPAN||t<se.MONTH_SPAN?e.getUTCDate().toString():t<se.YEAR_SPAN?(void 0===ue&&(ue=[window.t("Jan"),window.t("Feb"),window.t("Mar"),window.t("Apr"),window.t("May",{context:"short"}),window.t("Jun"),window.t("Jul"),window.t("Aug"),window.t("Sep"),window.t("Oct"),window.t("Nov"),window.t("Dec")]),ue)[e.getUTCMonth()]:e.getUTCFullYear().toString()}onScroll(){return this._onScroll}invalidateVisibleBars(){this._visibleBarsInvalidated=!0}onTimeScaleCompleted(e){if(this._requestingMoreData=!1,this._endOfData=e,k.enabled("fix_left_edge")&&this._endOfData){const e=this._points.firstIndex();null!==e&&this.setLeftEdgeFix(e)}this._requestMoreData()}requestMoreHistoryPoints(e){this._model.mainSeries().requestMoreData(e)}_requestMoreData(){this._requestFutureTickmarksIfNeeded(),this._requestHistoryPointsIfNeeded()}_requestFutureTickmarksIfNeeded(){this._model.mainSeries().requestMoreData()}_requestHistoryPointsIfNeeded(){this._model.mainSeries().requestMoreData()}_requestHistoryPoints(e){this._model.chartApi().isConnected().value()&&(this._requestingMoreData?ce.logNormal("Skipping loading more data due active loading"):(this._requestingMoreData=!0,this._model.chartApi().requestMoreData(e)))}_updateVisibleBars(){const e=this._visibleBars;if(this.isEmpty())return void(this._visibleBars.isValid()&&(this._visibleBars=ie.invalid(),this._visibleBarsChanged.fire(null,e.strictRange()),this._logicalRangeChanged.fire(null,e.logicalRange())));const t=this.baseIndex(),i=this.width()/this._barSpacing,r=this._rightOffset+t,s=r-i+1;Number.isFinite(s)&&Number.isFinite(r)?(this._visibleBars=new ie(new Z.LogicalRange(s,r),this._model.mainSeries().style()),J.BarsRange.compare(e.strictRange(),this._visibleBars.strictRange())||this._visibleBarsChanged.fire(this._visibleBars.strictRange(),e.strictRange()),
Z.LogicalRange.compare(e.logicalRange(),this._visibleBars.logicalRange())||this._logicalRangeChanged.fire(this._visibleBars.logicalRange(),e.logicalRange())):ce.logWarn(`updateVisibleBars error: baseIndex: ${t}, barSpacing: ${this._barSpacing}, rightOffset: ${this._rightOffset}`)}_rightOffsetForCoordinate(e){return(this._width-1-e)/this._barSpacing}_correctOffset(){const e=this.maxRightOffset();this._rightOffset>e&&(this._rightOffset=e,this._visibleBarsInvalidated=!0);const t=this.minRightOffset();null!==t&&this._rightOffset<t&&(this._rightOffset=t,this._visibleBarsInvalidated=!0)}_tryToUpdateBarSpacing(e,t){return e!==t&&(this._visibleBarsInvalidated=!0,this._barSpacing=t,this._barSpacingChanged.fire(t),!0)}_coordinateToFloatIndex(e){const t=this._rightOffsetForCoordinate(e),i=this.baseIndex()+this.rightOffset()-t;return Math.round(1e6*i)/1e6}_saveCommonTransitionsStartState(){this._commonTransitionStartState={barSpacing:this.barSpacing(),rightOffset:this.rightOffset()}}_clearCommonTransitionsStartState(){this._commonTransitionStartState=null}_maxRightOffsetOnChanged(){this._maxRightOffsetChanged.fire(this.maxRightOffset())}_updateRightOffset(e){const t=this._rightOffset;this._rightOffset=e,this._correctOffset(),this._rightOffset!==t&&this._rightOffsetChanged.fire(this._rightOffset)}}var he=i(833),pe=i(43389),_e=i(59503),me=i(15055),fe=i(60621),ge=i(14397),ve=i(40142),Se=i(34698),ye=i(64853);var be=i(3898);const we=(0,G.getLogger)("Chart.ESDWatcher"),Pe=new Map([["esdShowDividends","Dividends@tv-basicstudies"],["esdShowSplits","Splits@tv-basicstudies"],["esdShowEarnings","Earnings@tv-basicstudies"]]);class Ce{constructor(e){this._cancellationTokens=new Map,this._model=e,this._subscribeOnProperties(),this.syncESDStudies()}destroy(){Pe.forEach((e,t)=>{this._model.mainSeries().properties().childs()[t].unsubscribeAll(this),this._cancelPendingInsertion(e),this._removeAllStudies(e)})}syncESDStudies(){we.logNormal("Force syncing studies"),Pe.forEach((e,t)=>{this._cancelPendingInsertion(e),this._removeAllStudies(e);this._model.mainSeries().properties().childs()[t].value()&&this._insertStudy(e)})}_subscribeOnProperties(){Pe.forEach((e,t)=>{this._model.mainSeries().properties().childs()[t].subscribe(this,i=>{const r=i.value();we.logNormal(`${t} has been changed to ${r}`);const s=this._getStudy(e);r&&null===s?this._insertStudy(e):r||(this._cancelPendingInsertion(e),null!==s&&(this._model.removeSource(s),we.logNormal(e+" has been removed")))})})}_getStudy(e){return this._model.allStudies().find(t=>t.metaInfo().id===e)||null}_insertStudy(e){this._cancelPendingInsertion(e);const t=this._model.createStudyInserter({type:"java",studyId:e});t.setForceOverlay(!0);const i=function(){const e={cancelled:!1,cancel:()=>{e.cancelled=!0}};return e}();this._cancellationTokens.set(e,i),we.logNormal("Inserting "+e),t.insert(void 0,i).then(()=>{we.logNormal(`Inserting ${e} is succeeded`)}).catch(e=>{e!==be.InsertionErrorCode.Cancelled&&we.logError("Error: "+e)}).then(()=>{this._cancellationTokens.get(e)===i&&this._cancellationTokens.delete(e)})}
_removeAllStudies(e){this._model.allStudies().filter(t=>t.metaInfo().id===e).forEach(e=>this._model.removeSource(e))}_cancelPendingInsertion(e){const t=this._cancellationTokens.get(e);void 0!==t&&(t.cancel(),this._cancellationTokens.delete(e),we.logNormal(`Inserting ${e} has been cancelled`))}}var Te=i(8412),xe=i(59958),Ie=i(43854);class Le{constructor(e){this._alertLabelsBySource=new Map,this._alertsByAlertSeriesId=new Map,this._alertSeriesIdByAlert=new Map,this._alertLabelsOwnerSourcesByAlert=new Map,this._chartModel=e}destroy(){this.removeAllAlertLabels()}removeAllAlertLabels(){const e=this._alertLabelsBySource;this._alertLabelsBySource=new Map,this._alertsByAlertSeriesId.clear(),this._alertSeriesIdByAlert.clear(),this._alertLabelsOwnerSourcesByAlert.clear(),e.forEach(e=>{e.forEach(e=>this._chartModel.removeSource(e))})}removeSourceAlertLabels(e){for(const t of this._getAlertLabelsBySource(e))this.removeAlertLabel(t)}syncSourceAlertLabels(e){if(!(e instanceof Ie.PriceDataSource&&e.hasStateForAlert()))return;for(const t of this._getAlertLabelsBySource(e))t.alertOwnerSource().idForAlert()===t.alertSeriesId()||t.alert().isOHLC()||this.removeAlertLabel(t);const t=this._alertsByAlertSeriesId.get(e.idForAlert()),i=this._getAlertLabelsBySource(e);void 0!==t&&t.forEach(e=>{i.some(t=>t.alert()===e)||this._updateAlertLabelsByAlert(e,(0,s.ensureDefined)(this._alertSeriesIdByAlert.get(e)))});const r=(0,s.ensureNotNull)(this._chartModel.paneForSource(e));for(const t of this._getAlertLabelsBySource(e)){const i=this._chartModel.paneForSource(t);i!==r?(null!==i&&i.removeDataSource(t),r.addDataSource(t,(0,s.ensureNotNull)(e.priceScale()),!1)):e.priceScale()!==t.priceScale()&&r.move(t,(0,s.ensureNotNull)(e.priceScale()))}}detachSourceAlertLabels(e){for(const t of this._getAlertLabelsBySource(e))this._chartModel.detachSource(t)}removeAlertLabel(e){const t=e.alertOwnerSource(),i=this._alertLabelsBySource.get(t);void 0!==i&&(i.delete(e),0===i.size&&this._alertLabelsBySource.delete(t));const r=e.alert(),s=this._alertLabelsOwnerSourcesByAlert.get(r);void 0!==s&&(s.delete(t),0===s.size&&this._alertLabelsOwnerSourcesByAlert.delete(r)),this._chartModel.removeSource(e)}addAlert(e,t){(0,s.assert)(!this._alertSeriesIdByAlert.has(e),"Alert is already added on the chart"),this._alertSeriesIdByAlert.set(e,t);let i=this._alertsByAlertSeriesId.get(t);void 0===i&&(i=new Set,this._alertsByAlertSeriesId.set(t,i)),i.add(e),this._updateAlertLabelsByAlert(e,t)}removeAlert(e){const t=this._alertLabelsOwnerSourcesByAlert.get(e);void 0!==t&&t.forEach(t=>{const i=this._alertLabelsBySource.get(t);void 0!==i&&i.forEach(t=>{t.alert()===e&&this.removeAlertLabel(t)})});const i=(0,s.ensureDefined)(this._alertSeriesIdByAlert.get(e));this._alertSeriesIdByAlert.delete(e);const r=this._alertsByAlertSeriesId.get(i);void 0!==r&&r.delete(e)}_findPanes(e){const t=[];for(const i of this._chartModel.panes()){const r=i.priceDataSources(),s=new Set;for(const t of r)t.hasStateForAlert()&&t.idForAlert()===e&&s.add(t);s.size>0&&t.push({pane:i,sources:s})}return t}
_addLabelToPane(e,t,i,r){const s=new Te.AlertLabel(this._chartModel,e,r,xe.invokeAlertEditor);i.addDataSource(s,r.priceScale(),!1);let n=this._alertLabelsBySource.get(r);void 0===n&&(n=new Set,this._alertLabelsBySource.set(r,n)),n.add(s);let o=this._alertLabelsOwnerSourcesByAlert.get(e);void 0===o&&(o=new Set,this._alertLabelsOwnerSourcesByAlert.set(e,o)),o.add(r)}_updateAlertLabelsByAlert(e,t){const i=this._findPanes(t);if(i.length)for(const r of i)r.sources.forEach(i=>this._addLabelToPane(e,t,r.pane,i));else if(e.isOHLC()){const i=this._chartModel.mainSeries();this._addLabelToPane(e,t,(0,s.ensureNotNull)(this._chartModel.paneForSource(i)),i)}this._chartModel.lightUpdate()}_getAlertLabelsBySource(e){const t=this._alertLabelsBySource.get(e);return void 0===t?[]:Array.from(t)}}var Me=i(83748),Ee=i(98006);function Ae(e){return(0,f.isLineTool)(e)&&e.hasAlert.value()||e instanceof Te.AlertLabel}var ke=i(75443),De=i(50946),Re=i(96238),Ne=i(74026);function Oe(e,t){return e.code<t.code?-1:e.code>t.code?1:0}class Ve{constructor(e){this._convertibleItems=e,this._idsToItems=new Map;for(const t of e)this._idsToItems.set(t.id,t)}convertible(e){return void 0!==this._idsToItems.get(e)}icon(e){var t;return null===(t=this._idsToItems.get(e))||void 0===t?void 0:t.logoid}size(){return this._convertibleItems.length}filterConvertible(e,t){const i=this._convertibleItems.filter(function(e,t){return i=>!e.has(i.id)&&t(i.id)}(e,t));return i.sort(Oe),i}}class Be{constructor(e){this._allGroups=new Set,this._idToName=new Map,this._idToDescription=new Map,this._groupedUnitIds=new Map,this._groupedUnits=new Map,this._groupById=new Map,this._size=0,this._units=e;for(const t in e)if(e.hasOwnProperty(t)){this._allGroups.add(t),this._groupedUnitIds.set(t,new Set(e[t].map(e=>e.id))),this._groupedUnits.set(t,e[t]);for(const i of e[t])this._size++,this._idToName.set(i.id,i.name),this._idToDescription.set(i.id,i.description),this._groupById.set(i.id,t)}}unitsChanged(e){return this._units!==e}size(){return this._size}name(e){return this._idToName.get(e)||e}description(e){return this._idToDescription.get(e)||e}unitGroupById(e){return this._groupById.get(e)||null}allGroups(){return new Set(this._allGroups)}unitsByGroups(e){const t=[];return e.forEach(e=>{const i=this._groupedUnits.get(e);void 0!==i&&t.push({name:e,units:i})}),t}convertible(e,t){for(const i of t){const t=this._groupedUnitIds.get(i);if(void 0!==t&&t.has(e))return!0}return!1}}var Fe=i(75496);class We{constructor(e){this._source=null,this._sourcePane=null,this._currentToolSupportsPhantomMode=!1,this._model=e}destroy(){this._source=null,this._sourcePane=null}source(){return this._source}onToolChanged(){this._removeSource();const e=this._model.currentTool();this._currentToolSupportsPhantomMode=(0,f.isLineToolName)(e)&&(0,f.supportsPhantomMode)(e)}onCursorPositionUpdated(){if(!this._currentToolSupportsPhantomMode)return;const e=this._model.crossHairSource();if(this._sourcePane!==e.pane&&this._removeSource(),null===e.pane||!(0,Fe.isNumber)(e.index)||!(0,
Fe.isNumber)(e.price))return void this._removeSource();const t={index:e.index,price:e.price};null!==this._source?this._source.setPoint(0,t):(this._source=this._model.createLineTool(e.pane,t,this._model.currentTool(),void 0,null),this._sourcePane=e.pane)}_removeSource(){null!==this._source&&(this._model.removeSource(this._source),this._source=null,this._sourcePane=null)}}var Ue=i(40989),He=i(95215),ze=i(8273);class je{align(e,t,i){let r=e;if(!(0,ze.magnetEnabled)().value())return r;const n=i.mainDataSource();if(null===n)return r;const o=n.model().mainSeries();if(n!==o)return r;const a=o.priceScale(),l=o.bars();if(a.isEmpty()||!l.contains(t))return r;const c=l.valueAt(t);if(null===c)return r;const u=[];null!==o.priceSource()?u.push(o.barFunction()(c)):u.push(c[1],c[2],c[3],c[4]);const d=(0,s.ensure)(o.firstValue()),h=u.map(e=>({y:a.priceToCoordinate(e,d),price:e})),p=a.priceToCoordinate(e,d);h.sort((e,t)=>Math.abs(e.y-p)-Math.abs(t.y-p));const _=h[0];return((0,ze.magnetMode)().value()===He.MagnetMode.StrongMagnet||Math.abs(_.y-p)<50)&&(r=_.price),r}}var Ye=i(59757),Ge=i(4033),qe=i(81994),Xe=i(88987),$e=i(89532),Ke=i(96861),Je=i(32552),Ze=i(53021);class Qe extends Je.PriceAxisView{constructor(e,t,i){super(),this._source=e,this._priceScale=t,this._priceProvider=i}setHitTestData(e){this._hitTestData=e}additionalPadding(e){return 0}_updateRendererData(e,t,i){e.visible=!1,t.visible=!1;const r=this._priceScale,s=r.mainSource(),n=null!==s?s.firstValue():null;if(!this._isVisible()||r.isEmpty()||null===n)return;const o=this._priceProvider(r);if(null===o)return;i.background=this._bgColor(),i.textColor=this.generateTextColor(i.background);const a=this.additionalPadding(r.fontSize());i.additionalPaddingTop=a,i.additionalPaddingBottom=a,i.coordinate=r.priceToCoordinate(o,n),e.text=r.formatPrice(o,n),e.visible=!0,t.visible=!0,t.hitTestData=this._hitTestData}}const et={normalBgColor:a.colorsPalette["color-cold-gray-750"],hoveredBgColor:a.colorsPalette["color-cold-gray-600"]},tt={normalBgColor:a.colorsPalette["color-cold-gray-900"],hoveredBgColor:a.colorsPalette["color-cold-gray-650"]};class it extends Qe{additionalPadding(e){return 2/12*e}_isVisible(){return this._source.visible&&null!==this._source.pane}_bgColor(){return this._getThemedColors().normalBgColor}_updateRendererData(e,t,i){const r=t.visible;super._updateRendererData(e,t,i),this._source.isHovered()?t.backgroung=this._getThemedColors().hoveredBgColor:t.backgroung=void 0,r||(t.visible=r)}_getThemedColors(){return this._source.model().isDark()?et:tt}}class rt extends Qe{_isVisible(){return null!==this._source.measurePane()}_bgColor(){return Ze.axisLabelBackgroundColor.common}}var st=i(63956),nt=i(42258),ot=i(91293),at=i(76468),lt=i(54281),ct=i(1073),ut=i(20552),dt=i(18301),ht=i(17515);function pt(e){const t=e.priceScale();return null===t?0:t.isPercentage()||t.isIndexedTo100()?2:1}class _t extends st.PanePriceAxisView{constructor(e,t,i,r,s){super(e,t,r),this._crossHairMenuCachedState=null,this._hasActions=!1,this._tooltipText=null,this._gaOrigin="CH menu",
this._crosshairPriceAxisView=e,e.setPaneRendererLabelIcon(0),this._crosshair=t,this._scale=i,this._options=s,(0,nt.waitTradingService)().then(()=>{this._crossHairMenuCachedState=null})}_updateImpl(e,t){super._updateImpl(e,t);const i=this._crosshair.y,r=this._chartModel.properties().scalesProperties.fontSize.value(),s=this._chartModel.timeScale().width(),n=this._crosshair.model().priceAxisRendererOptions(),o=r+2*this._crosshairPriceAxisView.additionalPadding(r)+n.paddingTop+n.paddingBottom,a=o,l=i-o/2,c=s-a,u=this._crosshair.pane,d=this._mainDataSourceOnPane(),h=d&&d.symbolSource(),p=!!h&&(h.isConvertedToOtherCurrency()||h.isConvertedToOtherUnit());if(null!==d){const e=pt(d),t=d.idForAlert(),i=this._crossHairMenuCachedState;null!==i&&i.id===t&&i.priceScale===e&&i.isCurrencyOrUnitConverted===p||(this._updateTooltipAndActionsAvaliability(d,e,p),this._crossHairMenuCachedState={id:t,priceScale:e,isCurrencyOrUnitConverted:p})}null!==d&&(0,Xe.isSymbolSource)(d)&&d.symbol();const _=this._hasActions;this._crosshairPriceAxisView.setPaneLabelVisible(_);const m=null!==u&&0!==u.leftPriceScales().length&&_,f=null!==u&&0!==u.rightPriceScales().length&&_,g=s-a/2,v=this._tooltipText?{text:this._tooltipText,rect:{x:g,y:l,w:0,h:0}}:void 0;this._data={left:m,right:f,xl:0,xr:c,y:l,containerWidth:a,containerHeight:o,clickHandler:this._handleClick.bind(this),tooltip:v},this._crosshairPriceAxisView.setHitTestData(this._data)}_priceScale(){return this._scale}_updateTooltipAndActionsAvaliability(e,t,i){this._tooltipText=null,this._hasActions=!1;if(!(1===t))return;const r=!i&&e.alertCreationAvailable(),s=!this._options.disableDrawHorizLineMenuAction,n=!i&&e===this._chartModel.mainSeries()&&Boolean((0,nt.tradingService)());let o=0;n&&o++,r&&o++,s&&o++;let a=0;1===o&&(r?(a=1,this._tooltipText=window.t("Add Alert")):this._tooltipText=n?window.t("Create Order"):window.t("Add Horizontal Line")),this._crosshairPriceAxisView.setPaneRendererLabelIcon(a),this._hasActions=0!==o}_handleClick(e,t,i){if(k.enabled("widget")&&k.enabled("referral_program_for_widget_owners"))return void(0,ct.showGoToTradingViewReferralDialog)({feature:"plusMenu"});(0,c.trackEvent)(this._gaOrigin,"click");const r=this._mainDataSourceOnPane(),s=null!==r&&(0,Xe.isSymbolSource)(r)?r.symbol():null,n={pageX:i.pageX,pageY:i.pageY,clientX:i.clientX,clientY:i.clientY,screenX:i.screenX,screenY:i.screenY,price:this._crosshair.price,symbol:s};h.emit("onPlusClick",n),this._getMenuItems(t).then(r=>{const s=r[0];1!==r.length||s.isDisabled()?r.length>0&&this._showContextMenu(r,e,i,t):s.execute()})}_getMenuItems(e){const t=this._options.disableTradingMenuActions?null:(0,nt.tradingService)(),i=(0,s.ensureNotNull)(this._crosshair.pane).mainDataSource()===this._chartModel.mainSeries()&&Boolean(t),r=this._createAlertMenuItems(e),n=i?this._createTradingMenuItems():Promise.resolve([]);return Promise.all([r,n]).then(([e,i])=>{i.length>0&&(0,s.ensureNotNull)(t).trackEvent(this._gaOrigin,"click");const r=this._createAddHorizontalLineMenuItem(),n=e.length>0&&i.length>0
;return[...e,n?new lt.Separator:null,...i,(e.length>0||i.length>0)&&r.length>0?new lt.Separator:null,...r].filter(e=>null!==e)})}_createAlertMenuItems(e){if(null===this._crosshair.pane)return Promise.resolve([]);const t=this._crosshair.pane.mainDataSource();if(null===t)return Promise.resolve([]);const i=t.symbolSource();if(!!i&&i.isConvertedToOtherCurrency())return Promise.resolve([]);const r=this._crosshair.y;if(this._options.menuForMainSourceOnly){if(t.alertCreationAvailable()&&t.isVisible()){const e=this._getActionAddAlert({source:t,y:r,isDisabled:!1});return Promise.resolve(null===e?[]:[e])}return Promise.resolve([])}const n=(0,s.ensureNotNull)(this._crosshair.pane).sourcesByGroup();let o=("left"===e?n.leftPriceScalesSources():n.rightPriceScalesSources()).filter(e=>e instanceof Ie.PriceDataSource&&e.alertCreationAvailable()&&e.isVisible());return o.reverse(),o=(0,m.moveToHead)(o,this._chartModel.mainSeries()),(0,ut.filterAccessibleDataSources)(o).then(e=>{const t=new Set(e),i=[];for(const e of o){const s=this._getActionAddAlert({source:e,y:r,isDisabled:!t.has(e)});null!==s&&i.push(s)}return i})}_createTradingMenuItems(){const e=this._crosshair.y,t=(0,nt.tradingService)();if(null===t||null===this._crosshair.pane)return Promise.resolve([]);const i=this._crosshair.pane.mainDataSource();if(null===i)return Promise.resolve([]);const r=i.symbolSource(),s=!!r&&r.isConvertedToOtherCurrency(),n=pt(i);return s||1!==n?Promise.resolve([]):(0,ot.createTradeContext)(i,e).then(e=>t.chartContextMenuActions(e,{onlyMainActions:!0,gaOrigin:this._gaOrigin}))}_createAddHorizontalLineMenuItem(){if(null===this._crosshair.pane)return[];const e=this._crosshair.pane.mainDataSource();if(null===e)return[];const t=this._crosshair.y,i=this._getActionAddHorizontalLine({source:e,y:t,pane:this._crosshair.pane});return null===i?[]:[i]}_getActionAddAlert(e){const{source:t,y:i,isDisabled:r}=e,s=this._getValue(t,i);if(null===s)return null;const n=this._formatValue(s,t),o=(0,Xe.isSymbolSource)(t)?t.symbolTitle(!0,!0):t.title(!0,{},!0),a={label:window.t("Add Alert For {title}").format({title:o})+` (${n})`,icon:dt};return r?a.disabled=!0:a.onExecute=()=>this._addAlert(s,t),new lt.Action(a)}_getActionAddHorizontalLine(e){if(this._options.disableDrawHorizLineMenuAction)return null;const{source:t,y:i,pane:r}=e,s=this._getValue(t,i);if(null===s)return null;const n=this._formatValue(s,t),o={label:window.t("Draw Horizontal Line on")+" "+n,icon:at};return o.onExecute=()=>this._addHorizontalLineTool(r,s),new lt.Action(o)}_getValue(e,t){const i=e.priceScale(),r=e.firstValue();if(null===i||null===r)return null;return i.isPercentage()||i.isIndexedTo100()?null:i.coordinateToPrice(t,r)}_formatValue(e,t){return t.formatter().format(e)}_addAlert(e,t){window.runOrSignIn(()=>{const i={dataSourceHub:this._chartModel,silent:!0,actionSource:"crosshair_menu"};(0,f.isLineTool)(t)?i.drawing=t:(i.series=t,i.value=e),(0,xe.invokeAlertEditorWithOnlineSeries)(i),(0,c.trackEvent)(this._gaOrigin,"alert")},{source:this._gaOrigin})}_addHorizontalLineTool(e,t){
this._chartModel.undoModel().createLineTool(e,{price:t,index:0},"LineToolHorzLine")}_showContextMenu(e,t,i,r){const n="left"===r;setTimeout(()=>{ht.ContextMenuManager.createMenu(e).then(e=>{e.show((e,t)=>{const r=(0,s.ensureDefined)(this._data),o=(0,s.ensureNotNull)(i.view).innerHeight,a=n?r.xl:r.xr,l=i.localX-a,c={left:i.clientX-l,right:i.clientX-l+r.containerWidth,top:i.clientY-r.containerHeight/2,bottom:i.clientY+r.containerHeight/2};return{clientX:n?c.left:c.right-e,clientY:o<c.bottom+t?c.top-t:c.bottom}})})})}_mainDataSourceOnPane(){const e=this._crosshair.pane;return null!==e?e.mainDataSource():null}}var mt=i(3707),ft=i(748),gt=i(99438),vt=i(62288),St=i(64348);class yt{constructor(e){this._data=e}hitTest(e){return void 0===this._data.clickHandler?null:new vt.HitTestResult(vt.HitTestResult.CUSTOM,{clickHandler:this._data.clickHandler,tapHandler:this._data.clickHandler})}draw(e,t){const i=t.pixelRatio,r=this._data.vertLinesVisible,s=this._data.horzLinesVisible;if(!r&&!s)return;e.save(),e.lineWidth=Math.max(1,Math.floor(this._data.lineWidth*i)),e.strokeStyle=this._data.color,e.fillStyle=this._data.color,e.lineCap="butt",(0,gt.setLineStyle)(e,this._data.lineStyle);const n=Math.round(this._data.x*i),o=Math.round(this._data.y*i),a=Math.ceil(this._data.w*i),l=Math.ceil(this._data.h*i);r&&n>=0&&(0,St.drawVerticalLine)(e,n,0,l),s&&o>=0&&(0,St.drawHorizontalLine)(e,o,0,a),this._data.drawCenter&&(e.beginPath(),e.arc(n,o,Math.round(3*i),0,2*Math.PI,!0),e.fillStyle=this._data.color,e.fill()),e.restore()}}const bt=a.colorsPalette["color-tv-blue-500"];class wt{constructor(e,t){this._rendererData={},this._renderer=new yt(this._rendererData),this._source=e,this._pane=t}update(){}renderer(e,t){const i=this._source.selectPointMode().value(),r=this._source.visible&&(this._source.areLinesVisible||i)&&!this._source.linesShouldBeHidden(),n=this._rendererData;if(!r||null===this._pane)return null;const o=this._source.paneForPointSelect(),a=null!==o?this._source.pane===o&&this._pane===o:this._pane===this._source.pane;if(i&&this._source.isOnHoveredChartWidget()&&a){const e=(0,s.ensureNotNull)(this._source.pointToSelect());n.color=this._source.lineColor()||bt,n.lineWidth=1,n.lineStyle=mt.LINESTYLE_SOLID,n.horzLinesVisible=!0,n.vertLinesVisible=!0,n.drawCenter=!1,"time"===e?n.horzLinesVisible=!1:"price"===e&&(n.vertLinesVisible=!1)}else{const e=this._source.properties(),t=this._source.model().currentTool(),i=(0,ft.lastEventIsTouch)()&&((0,f.isLineToolName)(t)||(0,ge.toolIsMeasure)(t));let r;r=i?bt:e.childs().color.value();const s=e.childs().transparency.value();!i&&s>0&&(r=(0,De.generateColor)(r,s)),n.color=r,n.horzLinesVisible=this._pane===this._source.pane,n.vertLinesVisible=!0,n.lineWidth=e.childs().width.value(),n.lineStyle=e.childs().style.value(),n.drawCenter=i&&this._pane===this._source.pane}return n.w=this._pane.width(),n.h=this._pane.height(),n.x=void 0!==this._source.lockedX&&isFinite(this._source.lockedX)&&this._source.lockedX||this._source.x,n.y=this._source.y,this._renderer}}var Pt=i(90878);const Ct={backgroundColor:(0,
De.generateColor)(a.colorsPalette["color-tv-blue-500"],70),borderColor:(0,De.generateColor)(a.colorsPalette["color-tv-blue-500"],20)};class Tt{constructor(e){this._renderer=new Pt.RectangleRenderer,this._rectangle=null,this._crosshair=e}update(){const e=this._crosshair.selection();null!==e&&null!==this._crosshair.pane?this._rectangle=this._crosshair.pane.logicalRectToPixels(e):this._rectangle=null}renderer(e,t){if(!this._rectangle)return null;const i={backcolor:Ct.backgroundColor,color:Ct.borderColor,fillBackground:!0,linewidth:1,points:[this._rectangle.min,this._rectangle.max],extendLeft:!1,extendRight:!1};return this._renderer.setData(i),this._renderer}}var xt=i(82755),It=i(14704),Lt=i(11386),Mt=i(76712),Et=i(81293),At=i(32579),kt=i(90789),Dt=i(56288),Rt=i(98815);const Nt=(0,j.t)("{count} bars"),Ot=(0,j.t)("Vol"),Vt=new It.PercentageFormatter,Bt=new Mt.TimeSpanFormatter,Ft=new Et.VolumeFormatter,Wt=(0,a.getHexColorByName)("color-tv-blue-500"),Ut={bgColorPositive:(0,De.generateColor)(Wt,80),bgColorNegative:"rgba(239,83,80,0.2)",colorPositive:(0,a.getHexColorByName)("color-tv-blue-600"),colorNegative:"#EF5350",labelBgColorPositive:Wt,labelBgColorNegative:"#EF5350"};class Ht{constructor(e,t){this._pipFormatter=null,this._lastSymbolInfo=null,this._horzTrenRenderer=new At.TrendLineRenderer,this._vertTrenRenderer=new At.TrendLineRenderer,this._bgRenderer=new Pt.RectangleRenderer,this._labelRenderer=new kt.TextRenderer,this._p1=null,this._p2=null,this._label=null,this._source=e,this._pane=t}update(){const[e,t]=this._source.measurePoints();if(void 0===t)return this._p1=null,void(this._p2=null);const i=(0,s.ensureNotNull)(this._source.measurePane()),r=e.price,o=t.price,a=t.price-r,l=t.index-e.index,c=(0,xt.forceLTRStr)(""+l),u=(0,s.ensureNotNull)(i.mainDataSource());let d=(0,s.ensureNotNull)(u.formatter()).format(a);if(Math.abs(r)>1e-8){const e=a/Math.abs(r);d+=" ("+Vt.format(100*e)+")"}const h=(0,xt.forceLTRStr)(d);this._label=h+"\n"+Nt.format({count:c});const p=(0,s.ensureNotNull)(u.firstValue()),_=this._source.model().timeScale().indexToCoordinate(e.index),m=this._source.model().timeScale().indexToCoordinate(t.index),f=i.defaultPriceScale().priceToCoordinate(r,p),g=i.defaultPriceScale().priceToCoordinate(o,p);this._p1=new n.Point(_,f),this._p2=new n.Point(m,g);const v=this._source.model().timeScale().indexToUserTime(e.index),S=this._source.model().timeScale().indexToUserTime(t.index);let y=null;if(null!==v&&null!==S){const e=this._pane.model().mainSeries().symbolInfo();null!==e&&e!==this._lastSymbolInfo&&(this._pipFormatter=new Lt.PipFormatter(e.pricescale,e.minmov,e.type,e.minmove2),this._lastSymbolInfo=e),y=(S.valueOf()-v.valueOf())/1e3}const b=this._pipFormatter?this._pipFormatter.format(a):null,w=null!==b?" , "+b:"",P=null!==y?Bt.format(y):null,C=null!==P?", "+(0,xt.startWithLTR)(P):"";this._label=(0,xt.forceLTRStr)(h+w)+"\n"+Nt.format({count:c})+C;const T=this._source.measureVolume();Number.isNaN(T)||(this._label+=`\n${Ot} ${Ft.format(T)}`)
;const I=o<r?Ut.bgColorNegative:Ut.bgColorPositive,L=o<r?Ut.colorNegative:Ut.colorPositive,M=o<r?Ut.labelBgColorNegative:Ut.labelBgColorPositive,E={points:[this._p1,this._p2],linewidth:0,fillBackground:!0,color:I,backcolor:I,extendLeft:!1,extendRight:!1};this._bgRenderer.setData(E);const A=this._p1.add(this._p2).scaled(.5);{const e=Math.round(A.y),t=new n.Point(this._p1.x,e),i=new n.Point(this._p2.x,e),r={points:[t,i],color:L,linewidth:1,linestyle:mt.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:Rt.LineEnd.Normal,rightend:Math.abs(t.x-i.x)>=50?Rt.LineEnd.Arrow:Rt.LineEnd.Normal};this._horzTrenRenderer.setData(r)}{const e=Math.round(A.x),t=new n.Point(e,this._p1.y),i=new n.Point(e,this._p2.y),r={points:[t,i],color:L,linewidth:1,linestyle:mt.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:Rt.LineEnd.Normal,rightend:Math.abs(t.y-i.y)>=50?Rt.LineEnd.Arrow:Rt.LineEnd.Normal};this._vertTrenRenderer.setData(r)}const k={x:0,y:10},D=.5*(this._p1.x+this._p2.x),R=this._p2.y,N=new n.Point(D,R),O=(V=(0,s.ensureNotNull)(this._label),{points:[N],text:V,color:"#FFFFFF",horzAlign:"center",vertAlign:"middle",font:x.CHART_FONT_FAMILY,offsetX:k.x,offsetY:k.y,bold:!1,italic:!1,fontsize:12,padding:8,highlightBorder:!1,backgroundColor:M,backgroundTransparency:10,backgroundVertInflate:5,backgroundHorzInflate:5,backgroundRoundRect:4});var V;this._labelRenderer.setData(O);const B=this._labelRenderer.measure(),F=(0,kt.calculateLabelPosition)(B,this._p1,this._p2,k,this._pane.height());this._labelRenderer.setPoints([F])}renderer(){if(null===this._p1||null===this._p2)return null;const e=new Dt.CompositeRenderer;return e.append(this._bgRenderer),e.append(this._horzTrenRenderer),e.append(this._vertTrenRenderer),e.append(this._labelRenderer),e}}var zt=i(29295);class jt extends zt.ScaledPaneRenderer{constructor(e){super(),this._data=e}hitTest(e){return null}_drawImpl(e){e.translate(this._data.x-this._data.width/2,this._data.y-this._data.height/2),e.strokeStyle="rgba(153,153,153,.3)",e.lineWidth=2,e.beginPath(),this._drawShackle(e),e.stroke(),e.closePath(),e.strokeStyle="rgba(153,153,153,.7)",e.lineWidth=1,e.beginPath(),e.rect(0,this._data.height-this._data.bodyHeight+.5,this._data.width,this._data.bodyHeight),e.closePath(),e.stroke(),e.translate(0,-1),e.strokeStyle="#777",e.beginPath(),this._drawShackle(e),e.stroke(),e.closePath(),e.fillStyle="rgba(255,255,255,.7)",e.beginPath(),e.rect(1,this._data.height-this._data.bodyHeight+1.5,this._data.width-2,this._data.bodyHeight-2),e.fill(),e.beginPath(),e.rect(.5,this._data.height-this._data.bodyHeight+1,this._data.width-1,this._data.bodyHeight-1),e.stroke(),e.closePath(),e.fillStyle="#777",e.fillRect(this._data.width/2-.5,this._data.height-this._data.bodyHeight/2,1,2)}_drawShackle(e){const t=(this._data.width-3)/2,i=this._data.height-this._data.bodyHeight;e.moveTo(1.5,t),e.arc(this._data.width/2,t,t,Math.PI,2*Math.PI),i>t&&(e.moveTo(1.5,t),e.lineTo(1.5,i),e.moveTo(this._data.width-1.5,t),e.lineTo(this._data.width-1.5,i))}}class Yt{constructor(e,t,i){this._horzVisible=!1,this._source=e,
this._pane=t,this._axis=i||"x"}update(){}renderer(e,t){const i=this._source.visible&&this._source.areLinesVisible,r=(0,ge.lockTimeAxis)().value(),n=i&&this._horzVisible,o=i||r;if("y"===this._axis&&!n||!o)return null;const a="y"===this._axis?this._pane.width()-4.5:(0,s.ensureDefined)(this._source.lockedX)+1,l="y"===this._axis?this._source.y:this._pane.height()-5.5-1;return new jt({x:a,y:l,width:9,height:11,bodyHeight:7})}}var Gt=i(68724),qt=i(23939),Xt=i(51424);const $t=window.t("n/a");class Kt extends Xt.DataWindowView{constructor(e){super(),this._invalidated=!0,this._dateItem=new Xt.DataWindowItem(window.t("Date"),""),this._timeItem=new Xt.DataWindowItem(window.t("Time"),""),this._model=e,this._items.push(this._dateItem),this._items.push(this._timeItem)}update(){this._invalidated=!0}items(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._items}_updateImpl(){const e=this._model.mainSeries().isDWM();if(this._timeItem.setVisible(!e),this._timeItem.setValue($t),this._dateItem.setValue($t),this._model.timeScale().isEmpty())return;let t=this._model.crossHairSource().appliedIndex();if(!(0,Fe.isNumber)(t)){const e=this._model.mainSeries().data().last();if(null===e)return;t=e.index}const i=this._model.timeScale().indexToUserTime(t);null!==i&&(this._dateItem.setValue(this._model.dateFormatter().format(i)),e||this._timeItem.setValue(this._model.timeFormatter().format(i)))}}var Jt=i(81265);class Zt extends Jt.TimeAxisView{constructor(e,t,i=!1){super(e),this._indexProvider=t,this._highlighted=i}_getBgColor(){const e=this._model.isDark();return this._highlighted?Ze.axisLabelBackgroundColor.common:e?a.colorsPalette["color-cold-gray-750"]:a.colorsPalette["color-cold-gray-900"]}_getIndex(){return this._model.crossHairSource().visible?this._indexProvider():null}}var Qt=i(62921);const ei={menuEnabled:!1,menuForMainSourceOnly:!1,disableTradingMenuActions:!1,disableDrawHorizLineMenuAction:!1};class ti extends Ke.DataSource{constructor(e,t,i){super(),this.pane=null,this.price=NaN,this.index=NaN,this.visible=!0,this.areLinesVisible=!0,this.x=NaN,this.y=NaN,this._measuringEnabled=new(F()),this._measurePane=null,this._startMeasurePoint=null,this._endMeasurePoint=null,this._lastValidMeasurePoint=null,this._isOnHoveredChartWidget=!1,this._selectPointMode=new(U())(!1),this._selectionPane=null,this._selectionView=new Tt(this),this._selectionStartPoint=null,this._measurePaneView=null,this._timeLockPaneView=null,this._priceAxisViews=new Map,this._panePriceAxisViews=new Map,this._startMeasurePriceAxisViews=new Map,this._endMeasurePriceAxisViews=new Map,this._originX=NaN,this._originY=NaN,this._subscribed=!1,this._movedDelegate=new(F()),this._pointSelectedDelegate=new(F()),this._requestedPoint=null,this._paneForRequestedPoint=null,this._selectLineColor=null,this._volumeCalculator=null,this._model=e,this._options=Object.assign({},ei,i||{}),this._linesShouldBeHidden=this._model.readOnly(),this._dataWindowView=new Kt(e),this.setSelectionEnabled(!1);const r=e=>t=>t===(0,
s.ensureNotNull)(this._measurePane).defaultPriceScale()?e():null;this._currentPosPriceProvider=e=>{const t=(0,s.ensureNotNull)(this.pane);if(e===t.defaultPriceScale())return this.price;const i=(0,s.ensureNotNull)(t.defaultPriceScale().mainSource()).firstValue();if(null===i)return null;const r=t.defaultPriceScale().priceToCoordinate(this.price,i),n=(0,s.ensureNotNull)(e.mainSource()).firstValue();return null===n?null:e.coordinateToPrice(r,n)},this._startMeasurePriceProvider=r(()=>(0,s.ensureNotNull)(this._startMeasurePoint).price),this._endMeasurePriceProvider=r(()=>(0,s.ensureNotNull)(this._lastMeasurePoint()).price),this._properties=t;this._timeAxisView=new Zt(e,()=>this.appliedIndex(),!1),this._startMeasureTimeAxisView=new Zt(e,()=>(0,s.ensureNotNull)(this._startMeasurePoint).index,!0),this._endMeasureTimeAxisView=new Zt(e,()=>(0,s.ensureNotNull)(this._lastMeasurePoint()).index,!0),e.readOnly()||ge.cursorTool.subscribe(e=>this.areLinesVisible="arrow"!==e,{callWithLast:!0})}destroy(){null!==this._volumeCalculator&&this._volumeCalculator.destroy()}moved(){return this._movedDelegate}originX(){return this._originX}originY(){return this._originY}saveOriginCoords(e,t){this._originX=e,this._originY=t}clearOriginCoords(){this._originX=NaN,this._originY=NaN}currentPoint(){return new n.Point(this.x,this.y)}model(){return this._model}appliedIndex(){return Number.isFinite(this.lockedIndex)?this.lockedIndex:this.index}startMeasurePoint(){return this._startMeasurePoint||null}endMeasurePoint(){return this._endMeasurePoint||null}measureVolume(){if(null===this._volumeCalculator)return NaN;const[e,t]=this.measurePoints();return void 0===t?NaN:this._volumeCalculator.volume(e.index,t.index)}measurePane(){return this._measurePane||null}startMeasuring(e,t){this._startMeasurePoint=e,this._measurePane=t,this._measuringEnabled.fire(!0),t.containsMainSeries()&&((0,s.assert)(null===this._volumeCalculator),this._volumeCalculator=new Qt.SeriesTimeRangeVolumeCalculator(this.model().mainSeries()))}finishMeasure(e){this._endMeasurePoint=e}clearMeasure(){delete this._measurePane,delete this._startMeasurePoint,delete this._endMeasurePoint,delete this._lastValidMeasurePoint,this._model.lightUpdate(),null!==this._volumeCalculator&&(this._volumeCalculator.destroy(),this._volumeCalculator=null),this._measuringEnabled.fire(!1)}measuringEnabled(){return this._measuringEnabled}measurePoints(){this.updateAllViews();const e=[(0,s.ensureNotNull)(this._startMeasurePoint)],t=this._lastMeasurePoint();return null!==t&&e.push(t),e}startSelection(e){this._selectionStartPoint=this.currentLogicalPoint(),this._selectionPane=e}clearSelection(){this._selectionStartPoint=null,this._selectionPane=null}selection(){return this._selectionStartPoint?{p1:this._selectionStartPoint,p2:this.currentLogicalPoint()}:null}currentLogicalPoint(){return{index:this.appliedIndex(),price:this.price}}selectPointMode(){return this._selectPointMode}lineColor(){return this._selectLineColor}cancelRequestSelectPoint(){this._selectPointMode.value()&&this._setSelectPointModeState(!1)}
requestSelectPoint(e){(0,s.assert)(!this._selectPointMode.value(),"Point already requested");const{pointType:t,pane:i,lineColor:r=null}=e;i&&((0,s.assert)(-1!==this._model.panes().indexOf(i),"Chartmodel doesn't contains specified pane"),this._paneForRequestedPoint=i,this._model.panesCollectionChanged().subscribe(this,this._paneCollectionChanged)),this._selectLineColor=r,this._requestedPoint=t,this._setSelectPointModeState(!0)}onPointSelected(){return this._pointSelectedDelegate}trySelectCurrentPoint(){const e=(0,s.ensureNotNull)(this._requestedPoint);if(!this._model.mainSeries().bars().contains(this.index)&&"price"!==e)return;const t=(0,s.ensureNotNull)(this.pane);if(this._paneForRequestedPoint&&this._paneForRequestedPoint!==t)return;let i,r;if("price"===e||(i=this._model.timeScale().indexToTimePoint(this.index),null!==i)){if("time"!==e){const e=t.mainDataSource();if(null===e)return;const i=e.firstValue(),s=e.priceScale();if(null===i||null===s)return;r=s.coordinateToPrice(this.y,i)}this._setSelectPointModeState(!1),this._pointSelectedDelegate.fire({time:i,price:r},t)}}isOnHoveredChartWidget(){return this._isOnHoveredChartWidget}setOnHoveredChartWidget(e){this._isOnHoveredChartWidget=e}clearPosition(){this.visible=!1,this.index=NaN,this.price=NaN,this.x=NaN,this.y=NaN,this.pane=null,this.clearOriginCoords()}setPosition(e,t,i){return this._subscribed||(this._model.mainSeries().onRestarted().subscribe(this,this.clearMeasure),this._subscribed=!0),this.setLockedPosition(i),this.visible=!0,this._tryToUpdateViews(e,t,i)}setLinesShouldBeHidden(e){this._linesShouldBeHidden=e}linesShouldBeHidden(){return this._linesShouldBeHidden}handleContextMenuEvent(e){this._selectPointMode.value()&&this._setSelectPointModeState(!1)}properties(){return this._properties}priceAxisViews(e,t){const i=null===this._requestedPoint||"time"!==this._requestedPoint||!this._isOnHoveredChartWidget,r=[];return this.pane===e&&i&&r.push(this._createPriceAxisViewOnDemand(this._priceAxisViews,this._panePriceAxisViews,e,t,this._currentPosPriceProvider,it,!0)[0]),this._startMeasurePoint&&r.push(this._createPriceAxisViewOnDemand(this._startMeasurePriceAxisViews,null,e,t,this._startMeasurePriceProvider,rt)[0]),this._lastMeasurePoint()&&r.push(this._createPriceAxisViewOnDemand(this._endMeasurePriceAxisViews,null,e,t,this._endMeasurePriceProvider,rt)[0]),r}timeAxisViews(){const e=[],t=null===this._requestedPoint||"price"!==this._requestedPoint||!this._isOnHoveredChartWidget;return!this._linesShouldBeHidden&&(this.visible||(0,ge.lockTimeAxis)().value())&&t&&e.push(this._timeAxisView),this._startMeasurePoint&&e.push(this._startMeasureTimeAxisView),this._lastMeasurePoint()&&e.push(this._endMeasureTimeAxisView),e}paneViews(e){if(void 0===e)return null;const t=[new wt(this,e)];if(e===this._selectionPane&&t.push(this._selectionView),e===this._measurePane&&(null===this._measurePaneView&&(this._measurePaneView=new Ht(this,e)),this._measurePaneView.update(),t.push(this._measurePaneView)),qt.addPlusButtonProperty.value()){
const i=e===this.pane,r=!Gt.CheckMobile.any()||window.screen.width>=320,s=ge.tool.value(),n=(0,f.isLineToolName)(s),o=null!==this._model.lineBeingEdited()||null!==this._model.lineBeingCreated()||this._model.sourcesBeingMoved().length>0||null!==this._model.customSourceBeingMoved()||(0,ge.toolIsMeasure)(s);if(i&&this._isOnHoveredChartWidget&&!this._selectPointMode.value()&&r&&!n&&!o){const i=e.mainDataSource();if(null!==i){const r=i.priceScale();if(null!==r){const i=this._createPriceAxisViewOnDemand(this._priceAxisViews,this._panePriceAxisViews,e,r,this._currentPosPriceProvider,it,!0)[1];null!==i&&t.push(i)}}}}return(0,ge.lockTimeAxis)().value()&&(null===this._timeLockPaneView&&(this._timeLockPaneView=new Yt(this,e)),t.push(this._timeLockPaneView)),t}dataWindowView(){return this._dataWindowView}updateAllViews(){this._priceAxisViews.forEach(e=>{e.forEach(e=>e.update())}),this._panePriceAxisViews.forEach(e=>{e.forEach(e=>e.update())}),this._startMeasurePoint&&(this._startMeasurePriceAxisViews.forEach(e=>{e.forEach(e=>e.update())}),this._startMeasureTimeAxisView.update()),this._lastMeasurePoint()&&(this._endMeasurePriceAxisViews.forEach(e=>{e.forEach(e=>e.update())}),this._endMeasureTimeAxisView.update()),this._timeAxisView.update(),this._selectionView.update(),this._dataWindowView.update()}setLockedPosition(e){delete this.lockedIndex,delete this.lockedX,e!==this._measurePane&&(0,ge.lockTimeAxis)().value()&&(this.lockedIndex=this._model.timeScale().points().roughIndex(ge.lockTimeAxisTime.value()),null!==this.lockedIndex&&(this.lockedX=this._model.timeScale().indexToCoordinate(this.lockedIndex)))}isMenuEnabled(){return this._options.menuEnabled}isHoveredEnabled(){return qt.addPlusButtonProperty.value()}isHovered(){return this._model.hoveredSource()===this}pointToSelect(){return this._requestedPoint}paneForPointSelect(){return this._paneForRequestedPoint}_lastMeasurePoint(){return this._endMeasurePoint?this._endMeasurePoint:(null!==this.pane&&this._measurePane===this.pane&&(this._lastValidMeasurePoint={price:this._model.magnet().align(this.price,this.index,this.pane),index:this.index}),this._lastValidMeasurePoint||null)}_createPriceAxisViewOnDemand(e,t,i,r,n,o,a=!1){let l=e.get(i),c=null!==t?t.get(i):void 0;void 0===l&&(l=new Map,e.set(i,l),this._options.menuEnabled&&null!==t&&(c=new Map,t.set(i,c)),a&&i.onDestroyed().subscribe(this,()=>this._onPaneDestroyed(i)));let u=l.get(r);if(void 0===u){if(u=new o(this,r,n),l.set(r,u),void 0!==c){const e=new _t(u,this,r,this._model,this._options);c.set(r,e)}a&&r.lastSourceRemoved().subscribe(this,()=>this._onPriceScaleCleared(r))}let d=null;return void 0!==c&&(d=(0,s.ensureDefined)(c.get(r))),[u,d]}_onPaneDestroyed(e){e.onDestroyed().unsubscribeAll(this),this._priceAxisViews.delete(e),this._panePriceAxisViews.delete(e),this._startMeasurePriceAxisViews.delete(e),this._endMeasurePriceAxisViews.delete(e)}_onPriceScaleCleared(e){e.lastSourceRemoved().unsubscribeAll(this),this._priceAxisViews.forEach(t=>t.delete(e)),this._panePriceAxisViews.forEach(t=>t.delete(e)),
this._startMeasurePriceAxisViews.forEach(t=>t.delete(e)),this._endMeasurePriceAxisViews.forEach(t=>t.delete(e))}_tryToUpdateViews(e,t,i){return!!this._tryToUpdateData(e,t,i)&&(this.updateAllViews(),this._movedDelegate.fire({index:this.index,price:this.price}),!0)}_tryToUpdateData(e,t,i){const r=this.x,n=this.y,o=this.price,a=this.index,l=this.pane,c=this._priceScaleByPane(i);if(this.index=e,this.x=isNaN(e)?NaN:this._model.timeScale().indexToCoordinate(e),null!==c&&null!==i){this.pane=i,this.price=t;const e=(0,s.ensureNotNull)(i.mainDataSource()).firstValue();this.y=null===e?NaN:c.priceToCoordinate(t,e)}else this.pane=null,this.price=NaN,this.y=NaN;return r!==this.x||n!==this.y||a!==this.index||o!==this.price||l!==this.pane}_priceScaleByPane(e){return e&&!e.defaultPriceScale().isEmpty()?e.defaultPriceScale():null}_setSelectPointModeState(e){e||(this._requestedPoint=null,this._selectLineColor=null,this._paneForRequestedPoint&&(this._paneForRequestedPoint=null,this._model.panesCollectionChanged().unsubscribe(this,this._paneCollectionChanged))),ge.isPointSelectedNow.setValue(e),this._selectPointMode.setValue(e),this._model.lightUpdate()}_paneCollectionChanged(e){const t=this._paneForRequestedPoint;null!==t&&-1===e.indexOf(t)&&this.cancelRequestSelectPoint()}}var ii=i(47658),ri=i(68981);const si=(0,Ee.isFeatureEnabled)("unit_conversion"),ni=(0,G.getLogger)("Chart.ChartModel");function oi(e,t){const i=e.indexOf(t);return-1!==i&&(e.splice(i,1),!0)}const ai={isSnapshot:!1,readOnly:!1,watermarkEnabled:!0,shiftVisibleRangeOnNewBar:!0,currencyConversionEnabled:!1,unitConversionEnabled:!1,countdownEnabled:!0,lastPriceAnimationEnabled:!0,onWidget:!1,hideIdeas:!1};class li{constructor(e,t,i,s,n,o,a,c,u){this._onRearrangePanes=new(F()),this._lineToolsGroupModel=new fe.LineToolsGroupModel,this._sourcesBeingMoved=[],this._activeItemBeingMoved=null,this._lineBeingEdited=null,this._linePointBeingEdited=null,this._linePointBeingChanged=null,this._customSourceBeingMovedHitTestData=null,this._customSourceBeingMoved=null,this._dataSourceCollectionChanged=new(F()),this._sourceProperitesChanged=new(F()),this._sourceZOrderChanged=new(F()),this._symbolSourceResolved=new(F()),this._symbolSourceResolvingActive=new(U())(!1),this._adjustForDividendsAvailability=new(U())(0),this._adjustForDividendsEnabled=new(U())(!1),this._sessions=null,this._currentTool="",this._lineBeingCreated=null,this._paneBeingCreatedLineOn=null,this._lineCancelled=new(F()),this._phantomSourceContainer=new We(this),this._destroyed=!1,this._isSettingsExternalPosition=!1,this._isTimeScrolling=!1,this._magnet=new je,this._scrollingState=null,this._modelIntervals=[],this._rendererOptionsProvider=new I(this),this._panes=[],this._tagsChanged=new(F()),this._strategySources=[],this._strategySourcesChange=new(F()),this._activeStrategySource=new(U())(null),this._panesCollectionChanged=new(F()),this._scrollEnabled=k.enabled("chart_scroll"),this._zoomEnabled=k.enabled("chart_zoom"),this._isScalesResetAvailableChanged=new(F()),this._isScalesResetAvailable=!1,this._esdWatcher=null,
this._alertsWatcher=null,this._hoveredSource=null,this._hoveredSourceChanged=new(F()),this._lastHoveredHittestData=null,this._lastSelectedHittestData=null,this._topmostCustomSources=[],this._fgCustomSources=[],this._bgCustomSources=[],this._allCustomSources=[],this._customSourcesMap=new Map,this._multiPaneSources=[],this._showLegendProperty=new(C()),this._id=(0,ke.guid)(),this._chartSaveTime=null,this._availableCurrenciesList=null,this._availableCurrencies=new Ve([]),this._availableUnitsObject=null,this._availableUnits=new Be({}),this._shouldBeSavedEvenIfHidden=!1,this._watchedThemeSpawn=l.watchedTheme.spawn(),this._gradientColorsCache=null,this._recalcVRStudiesParams={},this._recalcColorStudiesParams={},this._recalcVisibleRangeStudiesImplDebounced=(0,r.default)(this._recalcVisibleRangeStudiesImpl.bind(this,this._recalcVRStudiesParams),500),this._recalcColorStudiesImplDebounced=(0,r.default)(this._recalcColorStudiesImpl.bind(this,this._recalcColorStudiesParams),250),this._width=0,this._resetScales=new(F()),this._chartThemeLoaded=new(F()),this._selection=new g,this._selectedSourceChanged=new(F()),this._symbolSourceCollectionChanged=new(F()),this._gridSource=new $e.Grid,this._clearSelection=()=>{this._lastSelectedHittestData=null,this._selection.clear()},this._removeSourceFromSelection=e=>{this._selection.remove(e)},this._addSourceToSelection=(e,t)=>{const i=this._selection.isSelected(e);i&&this._lastSelectedHittestData===t||e&&!e.isSelectionEnabled()||(this._lastSelectedHittestData=t||null,i||this._selection.add(e))},this._recalcSymbolResolvingActive=()=>{for(const e of this._panes)if(e.symbolSourceResolvingActive().value())return void this._symbolSourceResolvingActive.setValue(!0);this._symbolSourceResolvingActive.setValue(!1)},this._recalcAdjustForDividendsAvailibility=()=>{var e,t,i,r;if(this._symbolSourceResolvingActive.value())return void this._adjustForDividendsAvailability.setValue(0);const s=this.mainSeries();switch(null!==(t=null===(e=s.symbolInfo())||void 0===e?void 0:e.allowed_adjustment)&&void 0!==t?t:"none"){case"dividends":return void this._adjustForDividendsAvailability.setValue(2);case"splits":return void this._adjustForDividendsAvailability.setValue(1);case"any":return void this._adjustForDividendsAvailability.setValue(3)}for(const e of this.symbolSources()){if(e.symbolHibernated().value()||e===s)continue;if("any"===(null!==(r=null===(i=e.symbolInfo())||void 0===i?void 0:i.allowed_adjustment)&&void 0!==r?r:"none"))return void this._adjustForDividendsAvailability.setValue(3)}this._adjustForDividendsAvailability.setValue(0)},this._recalcAdjustForDividendsEnabled=()=>{switch(this._adjustForDividendsAvailability.value()){case 2:return void this._adjustForDividendsEnabled.setValue(!0);case 0:case 1:return void this._adjustForDividendsEnabled.setValue(!1)}this._adjustForDividendsEnabled.setValue(this.mainSeries().properties().childs().dividendsAdjustment.value())},this._chartApi=e,this._invalidateHandler=t,this._undoModel=o,this._properties=i,this._options=(0,$.merge)((0,$.clone)(ai),c),this._collapsedWV=u,
this._studiesMetaInfoRepository=n,this._readOnly=this._options.readOnly,this._isSnapshot=this._options.isSnapshot,this._alertsWatcher=new Le(this),this._chartSaveTime=(new Date).valueOf(),this._backgroundColor=new(U())(this._getBackgroundColor()),this._backgroundTopColor=new(U())(this._getBackgroundColor(!0)),this._properties.childs().paneProperties.childs().background.subscribe(this,this._updateBackgroundColor),this._properties.childs().paneProperties.childs().backgroundType.subscribe(this,this._updateBackgroundColor),this._properties.childs().paneProperties.childs().backgroundGradientStartColor.subscribe(this,this._updateBackgroundColor),this._properties.childs().paneProperties.childs().backgroundGradientEndColor.subscribe(this,this._updateBackgroundColor),this._backgroundColor.subscribe(this.recalcColorStudies.bind(this,!1)),this._backgroundTopColor.subscribe(this.recalcColorStudies.bind(this,!1)),this._watchedThemeSpawn.subscribe(this._updateBackgroundColor.bind(this)),this._symbolSourceResolvingActive.subscribe(this._recalcAdjustForDividendsAvailibility),this.setStudiesMetaData(this._studiesMetaInfoRepository.getInternalMetaInfoArray(),this._studiesMetaInfoRepository.getMigrations()),(0,ge.init)();const d=this._readOnly?new(C())((0,ri.defaults)("chartproperties.paneProperties.crossHairProperties")):this._properties.childs().paneProperties.childs().crossHairProperties;this.m_crossHairSource=new ti(this,d,this._options.crossHair),this.m_crossHairSource.selectPointMode().subscribe(e=>{if(e&&this.lineBeingCreated()){const e=ge.tool.value();this.cancelCreatingLine(),ge.tool.setValue(e)}}),this._tagsChanged=new(F());const h=new w.DefaultProperty("chartproperties.mainSeriesProperties");h.addExclusion("minTick"),h.addExclusion("priceAxisProperties.lockScale"),h.addExclusion("priceAxisProperties.percentage"),h.addExclusion("priceAxisProperties.indexedTo100"),h.addExclusion("priceAxisProperties.isInverted"),h.addExclusion("priceAxisProperties.log"),h.addExclusion("priceAxisProperties.logDisabled"),h.addExclusion("priceAxisProperties.percentageDisabled"),h.addExclusion("priceAxisProperties.autoScaleDisabled"),h.merge(i.mainSeriesProperties.state()),this._timeScale=new de(this,this._options.timeScale);const p={countdownEnabled:this._options.countdownEnabled,lastPriceAnimationEnabled:this._options.lastPriceAnimationEnabled};this.m_mainSeries=new ii.Series(this,h,p,s),this.m_mainSeries.onStyleChanged().subscribe(this._timeScale,this._timeScale.invalidateVisibleBars),this.m_mainSeries.properties().childs().showCountdown.subscribe(this,()=>{this.m_mainSeries.updateAllViews(),this.fullUpdate()}),this._timeScale.visibleBarsStrictRangeChanged().subscribe(this.m_mainSeries,this.m_mainSeries.clearHighLowAvgPriceCache),this.createPane(void 0,{axisProperties:h.childs().priceAxisProperties.state(["autoScale"])}),this._adjustForDividendsAvailability.subscribe(this._recalcAdjustForDividendsEnabled),this.mainSeries().properties().childs().dividendsAdjustment.subscribe(this,this._recalcAdjustForDividendsEnabled),
this._recalcAdjustForDividendsEnabled()}setStudiesMetaData(e,t){this._studiesMetaData=e,this._studyVersioning=new(S())(this._studiesMetaData,t)}version(){return 3}collapsed(){return this._collapsedWV}chartSaveTime(){return this._chartSaveTime}setChartSaveTime(e){this._chartSaveTime=e}destroy(){this._phantomSourceContainer.destroy(),this._hoveredSourceChanged.destroy(),null!==this._watermarkSource&&(this._watermarkSource.destroy(),this._watermarkSource=null),Array.from(this._customSourcesMap.keys()).forEach(this._removeCustomSource,this),(0,s.assert)(0===this._topmostCustomSources.length),(0,s.assert)(0===this._fgCustomSources.length),(0,s.assert)(0===this._bgCustomSources.length),(0,s.assert)(0===this._allCustomSources.length),(0,s.assert)(0===this._customSourcesMap.size),null!==this._esdWatcher&&(this._esdWatcher.destroy(),this._esdWatcher=null),null!==this._alertsWatcher&&(this._alertsWatcher.destroy(),this._alertsWatcher=null),this._properties.childs().paneProperties.childs().background.unsubscribeAll(this),this._properties.childs().paneProperties.childs().backgroundType.unsubscribeAll(this),this._properties.childs().paneProperties.childs().backgroundGradientEndColor.unsubscribeAll(this),this._properties.childs().paneProperties.childs().backgroundGradientStartColor.unsubscribeAll(this),this._watchedThemeSpawn.destroy(),this._lastHoveredHittestData=null,this._lastSelectedHittestData=null,this._destroyed=!0}undoModel(){return this._undoModel}addStrategySource(e){-1===this._strategySources.indexOf(e)&&(this._strategySources.push(e),this._strategySourcesChange.fire(),this.setActiveStrategySource(e))}removeStrategySource(e){const t=this._strategySources.indexOf(e);if(-1!==t){if(this._strategySources.splice(t,1)[0]===this._activeStrategySource.value()&&this.unsetActiveStrategySource(),this._strategySources.length>0){const e=this._strategySources[this._strategySources.length-1];this.setActiveStrategySource(e)}this._strategySourcesChange.fire()}}setActiveStrategySource(e){-1!==this._strategySources.indexOf(e)&&this._activeStrategySource.setValue(e)}unsetActiveStrategySource(){this._activeStrategySource.setValue(null)}activeStrategySource(){return this._activeStrategySource}strategySources(){return this._strategySources}strategySourcesChange(){return this._strategySourcesChange}setScrollEnabled(e){this._scrollEnabled=e}scrollEnabled(){return this._scrollEnabled}setZoomEnabled(e){this._zoomEnabled=e}zoomEnabled(){return this._zoomEnabled}zoomToViewport(e,t,i,r,s){this.setTimeViewport(e,t);let n=Math.min(i,r),o=Math.max(i,r);const a=s.defaultPriceScale();a.isPercentage()||a.setMode({autoScale:!1}),a.isLog()&&(n=a.priceToLogical(n),o=a.priceToLogical(o)),a.setPriceRange(new Ye.PriceRange(n,o)),this.recalculateAllPanes(),this.invalidate(this._paneInvalidationMask(s,H.InvalidationLevel.Light)),this._setScalesResetAvailable(!0)}setTimeViewport(e,t){this.timeScale().zoomToBarsRange(e,t),this.recalculateAllPanes(),this.recalcVisibleRangeStudies(),this.lightUpdate()}onTagsChanged(){return this._tagsChanged}canZoomIn(){
return this._timeScale.canZoomIn()&&this._zoomEnabled}canZoomOut(){return this._timeScale.canZoomOut()&&this._zoomEnabled}onPaneTagsChanged(){this._tagsChanged.fire()}panesCollectionChanged(){return this._panesCollectionChanged}dataSourceCollectionChanged(){return this._dataSourceCollectionChanged}symbolSourceCollectionChanged(){return this._symbolSourceCollectionChanged}symbolSourceResolved(){return this._symbolSourceResolved}symbolSourceResolvingActive(){return this._symbolSourceResolvingActive}adjustForDividendsAvailability(){return this._adjustForDividendsAvailability}adjustForDividendsEnabled(){return this._adjustForDividendsEnabled}sourcePropertiesChanged(){return this._sourceProperitesChanged}sourceZOrderChanged(){return this._sourceZOrderChanged}updateCrosshairPositionByOriginCoords(){const e=this.crossHairSource(),t=e.pane;let i=e.originX(),r=e.originY();if(Number.isFinite(i)||(i=e.x,r=e.y),null!==t&&Number.isFinite(i)&&Number.isFinite(r)){const e=this._timeScale.coordinateToVisibleIndex(i);let n=NaN;const o=t.defaultPriceScale();if(!o.isEmpty()){const e=(0,s.ensureNotNull)(t.mainDataSource()).firstValue();null!==e&&(n=o.coordinateToPrice(r,(0,s.ensureNotNull)(e)))}this.crossHairSource().setPosition(e,n,t)&&this._undoModel.chartWidget().isActive()&&this._syncCrosshair()}}zoomTime(e,t,i){if(!this._zoomEnabled)return;const r=this.timeScale();if(r.isEmpty()||0===t)return;const s=r.width();e=Math.max(1,Math.min(e,s-2)),r.zoom(e,t,i),this.recalculateAllPanes(),this.lightUpdate(),this.recalcVisibleRangeStudies(),this._setScalesResetAvailable(!0)}linePointBeingEdited(){return this._linePointBeingEdited}activeItemBeingMoved(){return this._activeItemBeingMoved}linePointBeingChanged(){return this._linePointBeingChanged}updateAllPaneViews(){for(const e of this._panes)e.updateAllViews();for(const e of this.barsMarksSources())e.updateAllViews()}dataSources(){const e=[this.crossHairSource()];for(const t of this._panes)for(const i of t.dataSources())e.push(i);return e}priceDataSources(){const e=[];for(const t of this._panes)for(const i of t.priceDataSources())e.push(i);return e}symbolSources(){const e=[];for(const t of this._panes)for(const i of t.symbolSources())e.push(i);return e}selection(){return this._selection}selectionMacro(e){const t=this.selection().allSources();e({removeSourceFromSelection:this._removeSourceFromSelection,addSourceToSelection:this._addSourceToSelection,clearSelection:this._clearSelection,selection:this.selection.bind(this)});const i=(0,m.subtract)(t,this.selection().allSources()),r=(0,m.subtract)(this.selection().allSources(),t);r.concat(t).forEach(e=>e.updateAllViews()),i.forEach(e=>{const t=(0,f.isLineTool)(e)&&e.hasAlert.value()&&e.getAlertSync();t&&t.set("selected",!1)}),r.forEach(e=>{const t=(0,f.isLineTool)(e)&&e.hasAlert&&e.hasAlert.value()&&e.getAlertSync();t&&t.set("selected",!0)}),this.lightUpdate(),(i.length>0||r.length>0)&&this._selectedSourceChanged.fire()}onSelectedSourceChanged(){return this._selectedSourceChanged}checkLineToolSelection(){this._selection.checkLineToolSelection()}
lineToolsGroupModel(){return this._lineToolsGroupModel}restoreLineToolsGroups(e){this._lineToolsGroupModel=fe.LineToolsGroupModel.fromState(this,e)}realignLineTools(){for(const e of this._panes)e.realignLineTools()&&this._dataSourceCollectionChanged.fire(e)}isSnapshot(){return this._isSnapshot}onWidget(){return this._options.onWidget}hideIdeas(){return this._options.hideIdeas}updateSource(e){const t=this._invalidationMaskForSource(e);null!==t&&this.invalidate(t)}updateSourcePriceScale(e){const t=this._invalidationMaskForSourcePriceScale(e);null!==t&&this.invalidate(t)}replaceStudyStub(e,t){const i=this.paneForSource(e);if(null===i)return!1;const r=e.priceScale(),s=e.zorder(),n=e.ownerSource();return this.paneForSource(e)===i?i.replaceSource(e,t,r):(i.insertDataSource(t,r,s),this.removeSource(e)),t.setOwnerSource(n),this.dataSources().forEach(i=>{i.ownerSource()===e&&i.setOwnerSource(t)}),t.start(),this.recalculatePane(i),this.fullUpdate(),!0}insertStudyStub(e){const t=this.mainSeries(),i=(0,s.ensureNotNull)(this.paneForSource(t)),r=new y.StudyStub(this,null,e),n=i.createPriceScaleAtPosition("overlay");return i.addDataSource(r,n,!1),this.recalculatePane(i),this.fullUpdate(),r}removeStudyStub(e){const t=this.dataSourceForId(e);return null===t?(ni.logNormal("StudyStub id="+e+" is not found in chart model"),!1):(this.removeSource(t),!0)}setHoveredSource(e,t=null){const i=this._hoveredSource!==e;if(!i&&this._lastHoveredHittestData===t)return;this._lastHoveredHittestData=t;let r=null;if(this._hoveredSource){this._hoveredSource.updateAllViews(),r=new H.InvalidationMask(H.InvalidationLevel.Cursor);const e=this._invalidationMaskForSource(this._hoveredSource,H.InvalidationLevel.Light);if(null!==e&&r.merge(e),i&&Ae(this._hoveredSource)){const e=this._hoveredSource.getAlertSync();null!==e&&e.set("hovered",!1)}}if(this._hoveredSource=e,e){e.updateAllViews(),r||(r=new H.InvalidationMask(H.InvalidationLevel.Cursor));const t=this._invalidationMaskForSource(e,H.InvalidationLevel.Light);if(null!==t&&r.merge(t),i&&Ae(e)){const t=e.getAlertSync();null!==t&&t.set("hovered",!0)}}r&&this.invalidate(r),i&&this._hoveredSourceChanged.fire(e)}disconnect(){this.sessions().stop();for(const e of this.dataSources())e.disconnect&&e.disconnect();this._timeScale.disconnect()}gridSource(){return this._gridSource}hoveredSource(){return this._hoveredSource}hoveredSourceChanged(){return this._hoveredSourceChanged}lastHittestData(){return this._lastHoveredHittestData}lastSelectedHittestData(){return this._lastSelectedHittestData}syncTimeWithModel(e,t){const i=this.mainSeries().syncModel();if(null===i)return;const r=1e3*this.createSyncPoint((0,s.ensureNotNull)(e.mainSeries().syncModel()),i).sourceTimeToTargetTime(t/1e3),n=(0,Ge.get_timezone)(this.timezone());let o=(0,Ge.utc_to_cal)(n,r);this.mainSeries().isDWM()&&(o=i.getSession().spec.correctTradingDay(o),(0,Ge.set_hms)(o,0,0,0,0,(0,Ge.get_timezone)("Etc/UTC"))),this._gotoTimeImpl(o.getTime(),{centerIfVisible:!1})}gotoTime(e){return this._gotoTimeImpl(e,{centerIfVisible:!0})}paneForSource(e){if(!(0,
_.isDataSource)(e))return Array.from(this._customSourcesMap.values()).includes(e)?this.paneForSource(this.mainSeries()):null;for(let t=this._panes.length-1;t>=0;t--)if(this._panes[t].hasDataSource(e))return this._panes[t];return e instanceof Re.BarsMarksContainer?this.paneForSource(this.mainSeries()):null}removeSource(e,t){this.selectionMacro(t=>t.removeSourceFromSelection(e)),this._hoveredSource===e&&(this._hoveredSource=null,this._lastHoveredHittestData=null),this._sourcesBeingMoved.includes(e)&&(this._sourcesBeingMoved=this._sourcesBeingMoved.filter(t=>t!==e),this._sourcesBeingMoved.length||(this._activeItemBeingMoved=null)),e===this._lineBeingEdited&&(this._lineBeingEdited=null,ge.isToolEditingNow.setValue(!1)),e===this._lineBeingCreated&&(this._lineBeingCreated=null,ge.isToolCreatingNow.setValue(!1)),e.stop&&e.stop();(0,s.ensureNotNull)(this.alertsWatcher()).removeSourceAlertLabels(e);const i=this.detachSource(e),r=this.mainSeries().priceScale();return(0,V.isStudy)(e)&&(0,Xe.isSymbolSource)(e)&&e.priceScale()===r&&r.isPercentage()&&1===r.seriesLikeSources().length&&r.setMode({percentage:!1}),this.fullUpdate(),this._invalidateBarColorerCaches(),(0,V.isStudy)(e)&&((0,h.emit)("study_event",e.id(),"remove"),e.isChildStudy()&&e.source().unsetChild(e)),e.destroy&&e.destroy(),(0,f.isLineTool)(e)&&(0,h.emit)("drawing_event",e.id(),"remove"),i}allStudies(e){const t=e?e=>(0,V.isStudy)(e)&&!(0,V.isESDStudy)(e):V.isStudy;return this._getAllSources(t)}findNonOverlayStudyWithGroupingKey(e,t){const i=void 0!==t?[t]:this._panes;for(const t of i){const i=t.dataSources().find(i=>(0,V.isStudy)(i)&&i.metaInfo().groupingKey===e&&!t.isOverlay(i));if(void 0!==i)return{pane:t,study:i}}return null}movePaneUp(e){this.movePane(e,e-1)}movePaneDown(e){this.movePane(e,e+1)}movePane(e,t){const i=this._panes[e];this._panes.splice(e,1),this._panes.splice(t,0,i),this._panesCollectionChanged.fire(this._panes),this._onRearrangePanes.fire(),this.invalidate(H.InvalidationMask.panesOrder())}backgroundColor(){return this._backgroundColor}backgroundTopColor(){return this._backgroundTopColor}backgroundColorAtYPercentFromTop(e){const t=this.backgroundColor().value(),i=this.backgroundTopColor().value();if(t===i)return t;if(e=Math.max(0,Math.min(100,Math.round(100*e))),null===this._gradientColorsCache||this._gradientColorsCache.topColor!==i||this._gradientColorsCache.bottomColor!==t)this._gradientColorsCache={topColor:i,bottomColor:t,colors:new Map};else{const t=this._gradientColorsCache.colors.get(e);if(void 0!==t)return t}const r=(0,De.gradientColorAtPercent)(i,t,e/100);return this._gradientColorsCache.colors.set(e,r),r}backgroundCounterColor(){const e=this.backgroundColor().value();if(void 0===this._lastBackgroundColor||void 0===this._lastOriginalColor||e!==this._lastBackgroundColor){const t=(0,o.rgbToBlackWhiteString)((0,o.parseRgb)(e),150);this._lastBackgroundColor=e,this._lastOriginalColor="black"===t?"white":"black"}return this._lastOriginalColor}isDark(){return"white"===this.backgroundCounterColor()}defaultResolutions(){
return this.chartApi().defaultResolutions()}availableCurrencies(){const e=this._getAvailableCurrencies();return e.length!==this._availableCurrencies.size()&&(this._availableCurrencies=new Ve(e)),this._availableCurrencies}currencyConversionEnabled(){return this._options.currencyConversionEnabled}availableUnits(){const e=this._getAvailableUnits();return this._availableUnits.unitsChanged(e)&&(this._availableUnits=new Be(e)),this._availableUnits}unitConversionEnabled(){return this._options.unitConversionEnabled}studyTemplate(e,t,i){const r={panes:[],version:this.version()};for(const e of this.panes())r.panes.push(e.state(!0,!1,!0));const s=this.mainSeries();return e&&(r.symbol=s.symbol(),i&&(r.currency=s.currency()),si&&i&&(r.unit=s.unit())),t&&(r.interval=s.interval()),r}restoreLineToolState(e,t){e.restorePoints(t.points,t.indexes||[]),e.properties().merge(t.state),e.restoreData&&e.restoreData(t),e.linkKey().setValue(t.linkKey||null),e.createServerPoints(),this.fullUpdate();const i=e.linkKey().value();null!==i&&(0,ge.restoreLineToolState)({model:this,linkKey:i,state:t})}updateLineTools(){for(const e of this.dataSources())(0,f.isLineTool)(e)&&(e.tryCreateServerPoints(),e.checkAlert&&e.checkAlert())}onResetScales(){return this._resetScales}startMovingSources(e,t,i,r,n,o){this._sourcesBeingMoved=e,this._activeItemBeingMoved=i;let a=!1;if(this._sourcesBeingMoved.forEach(e=>{!a&&(0,V.isStudy)(e)&&(a=!0);const l=(0,s.ensureNotNull)(this.paneForSource(e)),c=(0,f.isLineTool)(e),u=c&&e.linkKey().value();if(!1!==u&&null!==u&&r.has(u)&&c&&e.isFixed()){const t=(0,s.ensureDefined)(r.get(u)),a={screen:this._percentPositionToPoint(t,l)};e.startMoving(a,i,n,o)}else e.startMoving(t,i,n,o);const d=this._paneInvalidationMask(l,H.InvalidationLevel.Light);this.invalidate(d)}),!o){const r=e.filter(f.isLineTool).filter(e=>e.linkKey().value()&&e.isSynchronizable()).map(e=>e.linkKey().value());if(r.length&&t.logical){const o=this.externalTimeStamp(t.logical.index),a={linkKeys:r,model:this,symbol:this.mainSeries().symbol(),point:{price:t.logical.price,timeStamp:o},activeItem:null!==i?i:void 0,envState:n,pointPositionPercents:new Map};e.forEach(e=>{if((0,f.isLineTool)(e)){const i=e.linkKey().value();if(i&&e.isSynchronizable()&&e.isFixed()){const r=(0,s.ensureNotNull)(this.paneForSource(e));a.pointPositionPercents.set(i,this._pointToPercentPosition((0,s.ensureDefined)(t.screen),r))}}}),(0,ge.startMovingLineTool)(a)}}ge.isToolMovingNow.setValue(!0),a&&ge.isStudyEditingNow.setValue(!0)}moveSources(e,t,i,r){if(this._sourcesBeingMoved.filter(e=>!e.isLocked||!e.isLocked()).forEach(n=>{const o=(0,f.isLineTool)(n)?n.linkKey().value():null;if(null!==o&&t.has(o)){const e=(0,s.ensureNotNull)(this.paneForSource(n)),a=(0,s.ensureDefined)(t.get(o)),l={screen:this._percentPositionToPoint(a,e)};n.move(l,this._activeItemBeingMoved,i,r)}else n.move(e,this._activeItemBeingMoved,i,r)}),this.lightUpdate(),!r&&e.logical){
const t=this._sourcesBeingMoved.filter(f.isLineTool).filter(e=>e.isSynchronizable()&&!!e.linkKey().value()).map(e=>e.linkKey().value()),r=this.externalTimeStamp(e.logical.index),n={linkKeys:t,model:this,point:{price:e.logical.price,timeStamp:r},envState:i,pointPositionPercents:new Map};this._sourcesBeingMoved.filter(f.isLineTool).forEach(t=>{if(t.linkKey().value()&&t.isSynchronizable()&&t.isFixed()){const i=(0,s.ensureNotNull)(this.paneForSource(t));n.pointPositionPercents.set(t.linkKey().value(),this._pointToPercentPosition((0,s.ensureDefined)(e.screen),i))}}),(0,ge.moveLineTool)(n)}}endMovingSources(e,t){const i=this._sourcesBeingMoved.map(i=>{const r=(0,s.ensureNotNull)(this.paneForSource(i)),n=i.endMoving(e,t),o=this._paneInvalidationMask(r,H.InvalidationLevel.Light);return o.invalidateAll(H.InvalidationLevel.Light),this.invalidate(o),n}),r=this._sourcesBeingMoved.filter(f.isLineTool).filter(e=>e.isSynchronizable()&&!!e.linkKey().value()).map(e=>e.linkKey().value()),n=this._sourcesBeingMoved.filter(f.isLineTool).filter(e=>e.isSynchronizable()&&!!e.linkKey).map(e=>{const t={points:e.normalizedPoints(),interval:this.mainSeries().interval()};return e.isFixed()&&(t.pointPositionPercents=e.calcPositionPercents()),t});r.length&&(0,ge.finishMovingLineTool)({linkKeys:r,model:this,finalStates:n,changes:i}),this._sourcesBeingMoved=[],this._activeItemBeingMoved=null,ge.isToolMovingNow.setValue(!1),ge.isStudyEditingNow.setValue(!1)}sourcesBeingMoved(){return this._sourcesBeingMoved}setMovingCustomSource(e,t){this._customSourceBeingMoved=e,this._customSourceBeingMovedHitTestData=null!==t?{beingMoved:!1,...t}:null}processingCustomSourceMove(){null!==this._customSourceBeingMovedHitTestData&&(this._customSourceBeingMovedHitTestData.beingMoved=!0)}customSourceMovingHitTestData(){return this._customSourceBeingMovedHitTestData}customSourceBeingMoved(){return null!==this._customSourceBeingMovedHitTestData&&this._customSourceBeingMovedHitTestData.beingMoved?this._customSourceBeingMoved:null}width(){return this._width}setWidth(e,t){this._width=e,this._timeScale.setWidth(e,t);for(const t of this._panes)t.setWidth(e);this.recalculateAllPanes(),this.recalcVisibleRangeStudies()}setPaneHeight(e,t){e.setHeight(t),this.recalculateAllPanes(),this.lightUpdate()}isScalesResetAvailableChanged(){return this._isScalesResetAvailableChanged}isScalesResetAvailable(){return this._isScalesResetAvailable}panes(){return this._panes}paneForId(e){return this._panes.find(t=>t.id()===e)||null}createPane(e,t,i){const r=this._undoModel.chartWidget();r.isMaximizedPane()&&r.toggleMaximizePane();const s=this._properties.childs().paneProperties;t&&s.merge(t);const n=new z.Pane(this._timeScale,s,this,i);return void 0!==e?this._panes.splice(e,0,n):this._panes.push(n),n.onTagsChanged().subscribe(this,li.prototype.onPaneTagsChanged),n.dataSourcesCollectionChanged().subscribe(this,()=>this._dataSourceCollectionChanged.fire(n)),n.symbolSourceCollectionChanged().subscribe(this,()=>this._onSymbolSourceCollectionChanged(n)),
n.sourcePropertiesChanged().subscribe(this,e=>this._sourceProperitesChanged.fire(n,e)),n.sourceZOrderChanged().subscribe(this,e=>this._sourceZOrderChanged.fire(n,e)),n.symbolSourceResolved().subscribe(this,e=>this._symbolSourceResolved.fire(n,e)),n.symbolSourceResolvingActive().subscribe(this._recalcSymbolResolvingActive),this._panesCollectionChanged.fire(this._panes),this.invalidate(H.InvalidationMask.panesOrder()),n}removePane(e){const t=this._undoModel.chartWidget();t.isMaximizedPane()&&t.toggleMaximizePane();const i=e;i.destroy();const r=this._panes.indexOf(i);-1!==r&&(this._panes.splice(r,1),e.dataSourcesCollectionChanged().unsubscribeAll(this),e.symbolSourceCollectionChanged().unsubscribeAll(this),e.sourcePropertiesChanged().unsubscribeAll(this),e.onTagsChanged().unsubscribeAll(this),e.symbolSourceResolved().unsubscribeAll(this),i.symbolSourceResolvingActive().unsubscribe(this._recalcSymbolResolvingActive));this.crossHairSource().pane===e&&this.clearCurrentPosition(),this._panesCollectionChanged.fire(this._panes),this.invalidate(H.InvalidationMask.panesOrder())}changePanesHeight(e,t){if(this._panes.length<2)return;(0,s.assert)(e>=0&&e<this._panes.length,"Invalid pane index");const i=this._panes[e],r=this._panes.reduce((e,t)=>e+t.stretchFactor(),0),n=this._panes.reduce((e,t)=>e+t.height(),0),o=n-30*(this._panes.length-1);t=Math.min(o,Math.max(30,t));const a=r/n,l=i.height();i.setStretchFactor(t*a);let c=t-l,u=this._panes.length-1;for(const e of this._panes)if(e!==i){const t=Math.min(o,Math.max(30,e.height()-c/u));c-=e.height()-t,u-=1;const i=t*a;e.setStretchFactor(i)}this.fullUpdate()}clearCurrentPosition(){const e=this.crossHairSource();e.clearPosition(),(0,s.ensureNotNull)(e.dataWindowView()).update();const t=this._panes;for(let e=t.length;e--;){const i=t[e].dataSources();for(let e=i.length;e--;){const t=i[e].dataWindowView();t&&t.update();const r=i[e].legendView();r&&r.update()}}this.invalidate(H.InvalidationMask.cursor());const i=this._undoModel.chartWidget();i.chartWidgetCollection().syncCrosshair(null,i),this._phantomSourceContainer.onCursorPositionUpdated()}setAndSaveCurrentPosition(e,t,i,r){this.crossHairSource().saveOriginCoords(e,t),this.setCurrentPosition(e,t,i,r)}setCurrentPosition(e,t,i,r){let n=NaN;const o=this._timeScale.coordinateToVisibleIndex(e),a=i.defaultPriceScale();let l=null;!a.isEmpty()&&Number.isFinite(t)&&(l=(0,s.ensureNotNull)(i.mainDataSource()).firstValue(),null!==l&&(n=a.coordinateToPrice(t,l)));const c=this.crossHairSource(),u=c.selectPointMode().value(),d=this.currentTool(),h=this.mainSeries(),p=u||ge.isStudyEditingNow.value(),_=this._lineBeingCreated||this._lineBeingEdited||(0,f.isLineToolName)(d)||(0,ge.toolIsMeasure)(d)||p;!this._isSettingsExternalPosition&&_&&(n=this._magnet.align(n,o,i),null!==l&&c.saveOriginCoords(c.originX(),a.priceToCoordinate(n,l)));let m=null;if(isNaN(n)||(m=i),this._isTimeScrolling){if(!this._isSettingsExternalPosition&&u){const e=h.bars().firstIndex(),t=h.bars().lastIndex();if(null!==e&&null!==t){const r=Math.min(Math.max(o,e),t)
;r!==o&&this._setCorrectedPositionToCrosshair(r,n,l,i)}}else c.setPosition(c.index,n,m);return}c.setOnHoveredChartWidget(!0),c.setPosition(o,n,m),(0,s.ensureNotNull)(c.dataWindowView()).update();const g=this._panes;for(let e=g.length;e--;){const t=g[e].dataSources();for(let e=t.length;e--;){const i=t[e].dataWindowView();i&&i.update();const r=t[e].legendView();r&&r.update()}}const v=h.syncModel();if(this.crossHairSource().startMeasurePoint()||this._lineBeingCreated?this.lightUpdate():this.invalidate(H.InvalidationMask.cursor()),this._lineBeingCreated){const e=this._lineBeingCreated.linkKey().value();if(!this._isSettingsExternalPosition){this._lineBeingCreated.setLastPoint({index:o,price:n},r),this._lineBeingCreated.updateAllViews();const t=(0,s.ensureNotNull)(this._lineBeingCreated.lastPoint());if(t.price===n&&t.index===o||this._setCorrectedPositionToCrosshair(t.index,t.price,l,i),v&&e){const i=this._timeScale.points().roughTime(t.index,v.projectTime.bind(v));(0,ge.setLineToolLastPoint)({model:this,linkKey:e,point:{timeStamp:(0,s.ensureNotNull)(i),price:t.price}})}}}if(!this._isSettingsExternalPosition&&null!==this._lineBeingEdited&&null!==this._linePointBeingEdited){this.changeLinePoint({index:o,price:n},r);const e=this._lineBeingEdited.getPoint(this._linePointBeingEdited);null!==e&&this._setCorrectedPositionToCrosshair(e.index,e.price,l,i)}if(!this._isSettingsExternalPosition&&p){const e=h.bars().firstIndex(),t=h.bars().lastIndex();if(null!==e&&null!==t){const r=Math.min(Math.max(o,e),t);r!==o&&this._setCorrectedPositionToCrosshair(r,n,l,i)}}this._syncCrosshair(r)}setExternalPosition(e,t){let i;const r=this.crossHairSource();if(r.setOnHoveredChartWidget(!1),null!==e&&(0,$.isNumber)(e.timeStamp)){const t=this.mainSeries().syncModel();if(t){const r=this.createSyncPoint(e.syncModel,t).sourceTimeToTargetTime(e.timeStamp);i=this._timeScale.points().roughIndex(r,t.distance.bind(t))}}if(null!==e&&null!=i&&Number.isFinite(i)){this._isSettingsExternalPosition=!0;const n=(0,s.ensureNotNull)(this.paneForSource(this.mainSeries())),o=this._timeScale.indexToCoordinate(i),a=(0,s.ensureNotNull)(n.mainDataSource()).firstValue();if(null!==a){let i=NaN;void 0!==e.price&&Number.isFinite(e.price)&&(i=this.mainSeries().priceScale().priceToCoordinate(e.price,a)),r.clearOriginCoords(),this.setCurrentPosition(o,i,n,t)}return r.setOnHoveredChartWidget(!1),void(this._isSettingsExternalPosition=!1)}r.clearPosition(),(0,s.ensureNotNull)(r.dataWindowView()).update();const n=this.dataSources();for(let e=n.length;e--;){const t=n[e].dataWindowView();t&&t.update();const i=n[e].legendView();i&&i.update()}this.invalidate(H.InvalidationMask.cursor())}startScaleTime(e){this._timeScale.startScale(e)}scaleTimeTo(e){this._timeScale.scaleTo(e),this.recalculateAllPanes(),this.lightUpdate(),this._setScalesResetAvailable(!0)}endScaleTime(){this._timeScale.endScale(),this.lightUpdate(),this.recalcVisibleRangeStudies()}resetTimeScale(){this._timeScale.restoreDefault(),this.recalculateAllPanes(),this.recalcVisibleRangeStudies(),this.lightUpdate(),
this._resetScales.fire(),this._setScalesResetAvailable(!1)}startScalePrice(e,t,i){e.startScalePrice(t,i)}scalePriceTo(e,t,i){e.scalePriceTo(t,i),this.mainSeries().priceScale().isLockScale()?this.lightUpdate():this.invalidate(this._paneInvalidationMask(e,H.InvalidationLevel.Light)),this._setScalesResetAvailable(!0)}endScalePrice(e,t){e.endScalePrice(t),this.invalidate(this._paneInvalidationMask(e,H.InvalidationLevel.Light))}resetPriceScale(e,t){this._setScalesResetAvailable(!1),e.resetPriceScale(t),this.invalidate(this._paneInvalidationMask(e,H.InvalidationLevel.Light))}restorePriceScaleState(e,t,i){e.restorePriceScaleState(t,i),this.invalidate(this._paneInvalidationMask(e,H.InvalidationLevel.Light))}currentTool(){return this._currentTool}setCurrentTool(e){this._currentTool!==e&&((0,f.isLineToolName)(e)&&this.selectionMacro(e=>{e.clearSelection()}),this._currentTool=e,this._phantomSourceContainer.onToolChanged())}detachSource(e){const t=this.paneForSource(e);return!!t&&(t.removeDataSource(e),t.isEmpty()?(this._lineBeingCreated&&t===this._paneBeingCreatedLineOn&&this.cancelCreatingLine(),this.removePane(t),!0):(this.fullUpdate(),!1))}onRearrangePanes(){return this._onRearrangePanes}finishLineTool(e){const t=e.linkKey().value();(0,ge.drawOnAllCharts)().value()&&null!==t&&e.isSynchronizable()&&(0,ge.finishLineTool)({linkKey:t,model:this})}startChangingLinetool(e,t,i,r,n){this._lineBeingEdited=e,this._linePointBeingChanged=t||null,this._linePointBeingEdited=void 0===i?null:i,ge.isToolEditingNow.setValue(!0),this._lineBeingEdited.startChanging(i,t,n);const o=(0,s.ensureNotNull)(this.paneForSource(e));this._lineBeingEdited.startDragPoint&&void 0!==i&&void 0!==t&&this._lineBeingEdited.startDragPoint(i,t),n||void 0===i||void 0===t||this._lineBeingEdited.setPoint(i,t,r,n),this._lineBeingEdited.updateAllViews();const a=this._paneInvalidationMask(o,H.InvalidationLevel.Light);this.invalidate(a);const l=e.linkKey().value();if(l&&e.isSynchronizable()&&void 0!==i&&void 0!==t){const e=(0,s.ensureNotNull)(this.externalTimeStamp(t.index));(0,ge.startChangingLineTool)({linkKey:l,model:this,symbol:this.mainSeries().symbol(),point:{price:t.price,timeStamp:e},pointIndex:i,envState:r||null})}}createLineTool(e,t,i,r,o,a){if((0,s.assert)((0,f.isLineToolName)(i),"Cannot create unknown line tool: "+i),"LineToolExecution"!==i&&(0,c.trackEvent)("drawings","Study_Drawing_"+i),r){const e=r.state();r=(0,f.createLineToolProperties)(i,e,this)}const l=(0,f.createLineTool)(i,this,r,null),u=!l.linkKey().value()&&!o;(0,ge.drawOnAllCharts)().value()?l.linkKey().setValue(o||(0,ke.randomHash)()):l.linkKey().setValue(o),a=a||(0,s.ensureNotNull)(e.mainDataSource()),r||(0,f.prepareLineToolPropertiesByOwnerSource)(l.properties(),a),l.setOwnerSource(a);const d=a.priceScale();let h;if(e.addDataSource(l,d,!1),l.isFixed()){const i=(0,s.ensureNotNull)((0,s.ensureNotNull)(e.mainDataSource()).firstValue()),r=this._timeScale.indexToCoordinate(t.index),o=(0,s.ensureNotNull)(d).priceToCoordinate(t.price,i);h=l.addFixedPoint(new n.Point(r,o))}else h=l.addPoint(t)
;return h||(this._lineBeingCreated=l,this._paneBeingCreatedLineOn=e,ge.isToolCreatingNow.setValue(!0)),u&&l.enableCurrentIntervalVisibility(),this.fullUpdate(),l}endChangingLinetool(e,t){const i=(0,s.ensureNotNull)(this._lineBeingEdited),r=i.endChanging(!1,e);this._lineBeingEdited=null,ge.isToolEditingNow.setValue(!1),this._linePointBeingEdited=null,this._linePointBeingChanged=null,this.lightUpdate();const n={points:i.normalizedPoints(),interval:this.mainSeries().interval()},o=i.linkKey().value();null!==o&&i.isSynchronizable()&&(0,ge.finishChangingLineTool)({model:this,linkKey:o,symbol:this.mainSeries().symbol(),finalState:n,changes:r})}continueCreatingLine(e,t,i,r){const n=(0,s.ensureNotNull)(this._lineBeingCreated),o=n.addPoint(e,t,i);n.updateAllViews();const a=new H.InvalidationMask(H.InvalidationLevel.Light);return o&&(this._paneBeingCreatedLineOn=null,this._lineBeingCreated=null,ge.isToolCreatingNow.setValue(!1)),this.invalidate(a),o}cancelCreatingLine(){if(!this._lineBeingCreated)return;const e=this._lineBeingCreated;this.removeSource(this._lineBeingCreated),this._lineBeingCreated=null,this._lineCancelled.fire(),ge.isToolCreatingNow.setValue(!1),(0,ge.drawOnAllCharts)().value()&&e.isSynchronizable()&&(0,ge.cancelLineTool)({model:this})}lineBeingCreated(){return this._lineBeingCreated}paneBeingCreatedLineOn(){return this._paneBeingCreatedLineOn}lineCancelled(){return this._lineCancelled}isPhantomLine(e){return this._phantomSourceContainer.source()===e}changeLinePoint(e,t,i){const r=(0,s.ensureNotNull)(this._lineBeingEdited),n=(0,s.ensureNotNull)(this._linePointBeingEdited);let o=e.price,a=e.index;if(r.setPoint(n,e,t),!i){const e=r.getPoint(n);null!==e&&(a=e.index,o=e.price)}r.updateAllViews(),this.lightUpdate();const l=r.linkKey().value();if(!i&&null!==l&&r.isSynchronizable()){const e=(0,s.ensureNotNull)(this._linePointBeingChanged),i={indexesChanged:a!==e.index,pricesChanged:o!==e.price},c=r.getChangePointForSync(n);if(null!==c){const e=this.externalTimeStamp(a);null!==e&&(o=c.price,(0,ge.changeLineTool)({linkKey:l,model:this,symbol:this.mainSeries().symbol(),point:{price:o,timeStamp:e},envState:t,changes:i}))}}}changeLinePoints(e,t,i){const r=e.points(),n=e.linkKey().value();!i&&n&&e.isSynchronizable()&&t.forEach((t,i)=>{const o=r[i],a=o.price!==t.price,l=o.index!==t.index;if(e.getChangePointForSync(i)){const e=(0,s.ensureNotNull)(this.externalTimeStamp(t.index));(0,ge.changeLineTool)({linkKey:n,model:this,symbol:this.mainSeries().symbol(),point:{price:t.price,timeStamp:e},changes:{pricesChanged:a,indexesChanged:l}})}}),e.setPoints(t),e.updateAllViews(),this.lightUpdate()}addCustomSource(e,t,i=p.CustomSourceLayer.Foreground){this._customSourcesMap.has(e)&&ni.logWarn(`Attempt to add the same custom source multiple time "${e}"`),ni.logNormal(`Adding custom source "${e}"`);const r=t(e,this);switch(i){case p.CustomSourceLayer.Background:this._bgCustomSources.push(r);break;case p.CustomSourceLayer.Foreground:this._fgCustomSources.push(r);break;case p.CustomSourceLayer.Topmost:this._topmostCustomSources.push(r)
;break;default:throw new Error("Unknown custom sources layer "+i)}this._allCustomSources.push(r),this._customSourcesMap.set(e,r),this.lightUpdate()}removeCustomSource(e){this._removeCustomSource(e),this.lightUpdate()}hasCustomSource(e){return this._customSourcesMap.has(e)}customSourceForName(e){return this._customSourcesMap.get(e)||null}customSourceName(e){let t=null;return this._customSourcesMap.forEach((i,r)=>{i===e&&(t=r)}),t}customSources(e){switch(e){case p.CustomSourceLayer.Background:return this._bgCustomSources;case p.CustomSourceLayer.Foreground:return this._fgCustomSources;case p.CustomSourceLayer.Topmost:return this._topmostCustomSources;default:return this._allCustomSources}}addMultiPaneSource(e){this._multiPaneSources.push(e),this.lightUpdate()}removeMultiPaneSource(e){const t=this._multiPaneSources.indexOf(e);-1===t?ni.logWarn("Attempt to remove multi-pane source which does not exist in the model"):this._multiPaneSources.splice(t,1),this.lightUpdate()}multiPaneSources(e){return this._multiPaneSources.filter(t=>!e.hasDataSource(t))}dateTimeFormatter(){return this._dateTimeFormatter}dateFormatter(){return this._dateFormatter}timeFormatter(){return this._timeFormatter}sessions(){return(0,s.ensureNotNull)(this._sessions)}createSessions(e){(0,s.assert)(null===this._sessions,"Sessions are already created"),this.addCustomSource("sessions",(t,i)=>(this._sessions=new O(t,i,e),this._sessions.start(),this._sessions),p.CustomSourceLayer.Background)}createPrePostMarket(e){this.addCustomSource("prePostMarket",(t,i)=>new Me.PrePostMarket(t,i,e))}theme(){const e=this.properties().paneProperties.state();delete e.topMargin,delete e.bottomMargin;const t=this.mainSeries().state().state;t&&(delete t.symbol,delete t.interval,delete t.currencyId,delete t.unitId);const i={mainSourceProperties:t,sessions:this.sessions().properties().state(),chartProperties:{paneProperties:e,scalesProperties:this.properties().scalesProperties.state()}};return i.version=this.version(),i}onChartThemeLoaded(){return this._chartThemeLoaded}chartThemeLoaded(){this._chartThemeLoaded.fire()}shouldBeSavedEvenIfHidden(){return this._shouldBeSavedEvenIfHidden}setShouldBeSavedEvenIfHidden(e){this._shouldBeSavedEvenIfHidden=e}externalTimeStamp(e){const t=this.mainSeries().syncModel();return this.timeScale().points().roughTime(e,t&&t.projectTime.bind(t))}syncESD(){null!==this._esdWatcher&&this._esdWatcher.syncESDStudies()}recalcVisibleRangeStudies(e){this._recalcVRStudiesParams.force=this._recalcVRStudiesParams.force||Boolean(e),this._recalcVisibleRangeStudiesImplDebounced()}recalcColorStudies(e){this._recalcColorStudiesParams.force=this._recalcColorStudiesParams.force||Boolean(e),this._recalcColorStudiesImplDebounced()}alertsWatcher(){return this._alertsWatcher}showLegend(){return this._showLegendProperty}id(){return this._id}recalculatePriceRangeOnce(){const e=this.mainSeries();for(const t of this._panes)for(const i of t.priceDataSources())i.symbolSource()===e&&i.disablePriceRangeReady()}invalidate(e){var t
;null===(t=this._invalidateHandler)||void 0===t||t.call(this,e)}appliedTimeFrame(){return this._appliedTimeFrame.appliedTimeFrame()}barsMarksSources(){return this._barsMarksSources}barMarksSourceForId(e){for(const t of this._barsMarksSources)if(t.id()===e)return t;return null}_createESDWatcher(){this._esdWatcher=new Ce(this)}_updateDateTimeFormatter(){const e=_e.dateFormatProperty.value(),t=new pe.DateFormatter(e);if(this._dateFormatter=t,this.mainSeries().isDWM())this._dateTimeFormatter=t,this._timeFormatter=new me.TimeFormatter("%h:%m");else{const t=b.Interval.parse(this.mainSeries().interval()),i=t.isSeconds()||t.isTicks()?"%h:%m:%s":"%h:%m";this._dateTimeFormatter=new he.DateTimeFormatter({dateFormat:e,timeFormat:i,dateTimeSeparator:"   "}),this._timeFormatter=new me.TimeFormatter(i)}}_setScalesResetAvailable(e){this._isScalesResetAvailable!==e&&(this._isScalesResetAvailable=e,this._isScalesResetAvailableChanged.fire())}_invalidationMaskForSource(e,t=H.InvalidationLevel.Light){if(e===this.crossHairSource())return H.InvalidationMask.cursor();if(this._watermarkSource===e)return this._paneInvalidationMask((0,s.ensureNotNull)(this.paneForSource(this.mainSeries())),t);if(-1!==this._allCustomSources.indexOf(e)){const e=new H.InvalidationMask;return e.invalidateAll(t),e}if(!(0,_.isDataSource)(e))return null;if(e.isMultiPaneEnabled())return new H.InvalidationMask(t);const i=this.paneForSource(e);return null!==i?this._paneInvalidationMask(i,t):null}_paneInvalidationMask(e,t=H.InvalidationLevel.Light){const i=new H.InvalidationMask,r=this._panes.indexOf(e);return i.invalidateAllPane(r,t),i}_invalidationMaskForSourcePriceScale(e,t=H.InvalidationLevel.Light){if(!(0,_.isDataSource)(e))return new H.InvalidationMask(t);const i=this.paneForSource(e);if(null===i)return null;let r=e.priceScale();if(null===r)return null;const s=this._panes.indexOf(i);let n=i.priceScalePosition(r);if("overlay"===n){const e=this._panes[s].defaultPriceScale();r=e,n=i.priceScalePosition(e)}const o=i.priceScaleIndex(r,n);if(void 0===o)return null;const a=new H.InvalidationMask;return a.invalidatePriceScale(s,n,o,t),a}_removeCustomSource(e){const t=this._customSourcesMap.get(e);if(void 0===t)return void ni.logWarn(`Attempt to remove custom source which does not exist in the model - "${e}"`);ni.logNormal(`Removing custom source "${e}"`),this.selectionMacro(e=>{e.removeSourceFromSelection(t)}),this._hoveredSource===t&&this.setHoveredSource(null),this._customSourceBeingMoved===t&&this.setMovingCustomSource(null,null);const i=oi(this._bgCustomSources,t),r=oi(this._fgCustomSources,t),n=oi(this._topmostCustomSources,t),o=oi(this._allCustomSources,t);(0,s.assert)(i||r||n,"Source should be presented in one of the layers"),(0,s.assert)(o,"Source should be presented in the array"),this._customSourcesMap.delete(e),t.destroy()}_updateShowLegendProperty(){const e=this._properties.childs().paneProperties.childs().legendProperties.childs().showLegend,t=this._showLegendProperty;if(e.value())t.setValue(!0);else{for(const e of this._panes){let i=0
;for(const r of e.dataSources())if(r!==this.mainSeries()&&null!==r.statusView()&&(i++,i>1))return void t.setValue(!1)}t.setValue(!0)}}_pointToPercentPosition(e,t){return{x:e.x/this._timeScale.width(),y:e.y/(0,s.ensureNotNull)((0,s.ensureNotNull)(t.mainDataSource()).priceScale()).height()}}_percentPositionToPoint(e,t){const i=e.x*this._timeScale.width(),r=e.y*(0,s.ensureNotNull)((0,s.ensureNotNull)(t.mainDataSource()).priceScale()).height();return new n.Point(i,r)}_recalcVisibleRangeStudiesImpl(e){var t;if(e.timerId=null,this.timeScale().isEmpty())return;const i=this.timeScale().visibleBarsStrictRange();if(null===i)return;const r=this.mainSeries().nearestData(i.firstBar(),Ue.PlotRowSearchMode.NearestRight),s=this.mainSeries().nearestData(i.lastBar(),Ue.PlotRowSearchMode.NearestLeft),n=this.mainSeries().bars().lastIndex(),o=r?r.index:void 0,a=s?s.index:void 0,l=o===e.oldStartVisibleIndex,c=a===e.oldEndVisibleIndex;if(l&&c&&!e.force)return;e.force=!1,e.oldStartVisibleIndex=void 0!==o?o:NaN,e.oldEndVisibleIndex=void 0!==a?a:NaN;const u={first_visible_bar_time:1e3*Math.floor(r&&r.value?r.value[0]:0),last_visible_bar_time:1e3*Math.floor(s&&s.value?s.value[0]:0),subscribeRealtime:s&&s.index===n},d=null!==(t=e.studies)&&void 0!==t?t:this.priceDataSources();e.studies=void 0;for(const e of d)if((0,V.isStudy)(e)){const t=e.metaInfo().inputs,i=[];for(const e of t)u.hasOwnProperty(e.id)&&i.push(e.id);const r=e.properties().inputs;for(const e of i)r[e].setValueSilently(u[e]);i.length>0&&r.listeners().fire(r)}}_recalcColorStudiesImpl(e){var t;if(e.timerId=null,this.timeScale().isEmpty())return;const i=this.backgroundColorAtYPercentFromTop(.5),r=this.isDark()?a.colorsPalette["color-cold-gray-200"]:a.colorsPalette["color-cold-gray-900"],s=i===e.oldBgColor,n=r===e.oldFgColor;if(s&&n&&!e.force)return;e.force=!1,e.oldBgColor=i,e.oldFgColor=r;const o={__chart_bgcolor:i,__chart_fgcolor:r},l=null!==(t=e.studies)&&void 0!==t?t:this.priceDataSources();e.studies=void 0;for(const e of l)if((0,V.isStudy)(e)){const t=e.metaInfo().inputs,i=[];for(const e of t)o.hasOwnProperty(e.id)&&i.push(e.id);const r=e.properties().inputs;for(const e of i)r[e].setValueSilently(o[e]);i.length>0&&r.listeners().fire(r)}}_getAllSources(e){const t=[];for(const i of this._panes){const r=i.sourcesByGroup().all();for(const i of r)e(i)&&t.push(i)}return t}_invalidateBarColorerCaches(){this.mainSeries().invalidateBarColorerCache()}_getAvailableCurrencies(){return this._options.currencyConversionEnabled?(0,$.isArray)(this._availableCurrenciesList)?this._availableCurrenciesList:(null!==this._availableCurrenciesList||(this._availableCurrenciesList=this.chartApi().availableCurrencies(),this._availableCurrenciesList.then(e=>{this._destroyed||(e=e.map(e=>{const t={...e};return void 0!==t.logoid&&(t.logoid=(0,u.resolveLogoUrls)({logoid:t.logoid})[0]),t}),this._availableCurrenciesList=e,this.lightUpdate())}).catch(e=>{ni.logWarn("An error occurred while getting currencies config: "+e)})),[]):[]}_getAvailableUnits(){
return si&&this._options.unitConversionEnabled?this._availableUnitsObject instanceof Promise||null===this._availableUnitsObject?(null!==this._availableUnitsObject||(this._availableUnitsObject=this.chartApi().availableUnits(),this._availableUnitsObject.then(e=>{this._destroyed||(this._availableUnitsObject=e,this.lightUpdate())}).catch(e=>{ni.logWarn("An error occurred while getting units config: "+e)})),{}):this._availableUnitsObject:{}}_getBackgroundColor(e){const t=this._properties.childs().paneProperties.childs();if(t.backgroundType.value()===Ne.ColorType.Gradient){const i=t.backgroundGradientStartColor.value(),r=t.backgroundGradientEndColor.value();return function(e,t,i){if((0,Se.getCurrentTheme)().name===ye.StdTheme.Dark&&(0,ve.isOnMobileAppPage)("old")){if((0,Se.isStdThemedDefaultValue)("chartProperties.paneProperties.backgroundGradientStartColor",e,ye.StdTheme.Dark)&&(0,Se.isStdThemedDefaultValue)("chartProperties.paneProperties.backgroundGradientEndColor",t,ye.StdTheme.Dark))return"#000000"}return i?e:t}(i,r,Boolean(e))}const i=t.background.value();return function(e){if((0,Se.getCurrentTheme)().name===ye.StdTheme.Dark&&(0,ve.isOnMobileAppPage)("old")){if((0,Se.isStdThemedDefaultValue)("chartProperties.paneProperties.background",e,ye.StdTheme.Dark))return"#000000"}return e}(i)}_updateBackgroundColor(){this._backgroundColor.setValue(this._getBackgroundColor()),this._backgroundTopColor.setValue(this._getBackgroundColor(!0))}_syncCrosshair(e){if(!this._isSettingsExternalPosition){const t=this._undoModel.chartWidget(),i=this._undoModel.mainSeries(),r=i.syncModel(),s=this._undoModel.crossHairSource(),n=s.pane;if(null!==r&&null!==n){const o={timeStamp:this._timeScale.points().roughTime(s.index,r.projectTime.bind(r)),syncModel:r};n.mainDataSource()===i&&(o.price=s.price,o.symbol=i.symbol()),o.syncModel=r;let a=this._lineBeingCreated||null!==this._linePointBeingEdited||Boolean(this._sourcesBeingMoved.length);a=a&&(0,ge.drawOnAllCharts)().value(),t.chartWidgetCollection().syncCrosshair(o,t,a,e)}this._phantomSourceContainer.onCursorPositionUpdated()}}_gotoTimeImpl(e,t){const i=this.timeScale(),r=this.mainSeries();let n;if(void 0!==e){if(this._scrollingState&&this._scrollingState.deferred.reject(),n=(0,d.createDeferredPromise)(),!r.isDWM()){const t=r.symbolInfo();if(null!==t){let i=this.properties().timezone.value();"exchange"===i&&(i=t.timezone);const s=(0,Ge.cal_to_utc)((0,Ge.get_timezone)(i),new Date(e)),n=(0,qe.createTimeToBarTimeAligner)(r.interval(),t)(s);e=(0,Ge.utc_to_cal)((0,Ge.get_timezone)(i),n).getTime()}}this._scrollingState={targetDate:e,deferred:n,centerIfVisible:t.centerIfVisible}}else{if(!this._scrollingState)return ni.logError("scrollTo called without an argument"),Promise.reject();e=this._scrollingState.targetDate,n=this._scrollingState.deferred}if(void 0===i.tickMarks().minIndex)return n.resolve(void 0),n.promise;let o=((e,t)=>{if((e=>(0,s.ensureNotNull)(i.tickMarks().indexToTime((0,s.ensureDefined)(i.tickMarks().minIndex))).valueOf()-e)(t)<0){let n=i.tickMarks().nearestIndex(t)
;const o=r.bars().lastIndex();if(null===o)return null;n=Math.min(n,o);let a=(0,s.ensureNotNull)(i.tickMarks().indexToTime(n)).valueOf();for(;a<t&&n<o;)n++,a=(0,s.ensureNotNull)(i.tickMarks().indexToTime(n)).valueOf();const l=(0,s.ensureNotNull)(i.visibleBarsStrictRange()),c=l.lastBar()-l.firstBar();return!e&&l.contains(n)||i.zoomToBarsRange(n-c/2,n+c/2),{timestamp:(0,s.ensureNotNull)(i.indexToTimePoint(n))}}return null})(this._scrollingState.centerIfVisible,this._scrollingState.targetDate);if(!o){const t=(0,s.ensureDefined)(i.tickMarks().minIndex),n=(0,s.ensureNotNull)(i.visibleBarsStrictRange()),a=n.lastBar()-n.firstBar();if(r.endOfData())i.zoomToBarsRange(t-a/2,t+a/2),o={timestamp:(0,s.ensureNotNull)(i.indexToTimePoint(t)),eod:!0};else{const t=i.tickMarks().estimateLeft(e);i.requestMoreHistoryPoints(Math.ceil(t+a/2))}}return o&&(this.fullUpdate(),this._scrollingState=null,n.resolve(o)),n.promise}_setCorrectedPositionToCrosshair(e,t,i,r){const n=this.crossHairSource();n.setPosition(e,t,r);const o=this._timeScale.indexToCoordinate(e),a=r.defaultPriceScale().priceToCoordinate(t,(0,s.ensureNotNull)(i));n.saveOriginCoords(o,a)}_onSymbolSourceCollectionChanged(e){this._recalcAdjustForDividendsAvailibility(),this._symbolSourceCollectionChanged.fire(e)}}},5417:(e,t,i)=>{"use strict";i.d(t,{japaneseChartStyles:()=>n,commonChartStyles:()=>o,allChartStyles:()=>a});var r=i(98006),s=i(22842);function n(){const e=[8];return s.enabled("japanese_chart_styles")&&(e.push(4,7,5,6),e.push(11)),e}function o(){const e=[0,1,9,2,3,10];return(0,r.isFeatureEnabled)("chart_style_hilo")&&e.push(12),e}function a(){return o().concat(n())}},51755:(e,t,i)=>{"use strict";i.d(t,{ChartUndoModelBase:()=>wt});var r=i(16282),s=i(72927),n=i(6450),o=i(94795),a=i.n(o),l=i(84234),c=i.n(l),u=i(87380);const d=window.t("Move All Scales To Left"),h=window.t("Move All Scales To Right"),p=(0,u.getLogger)("Chart.MergeAllScales");var _=i(51506),m=i(36270);class f extends m.UndoCommand{constructor(e,t,i,r,s,n){super(n),this._model=e,this._paneIndex=e.panes().indexOf(t),this._targetPosition=r,this._targetIndex=s,this._scaleId=i.id(),this._sourcePosition=t.priceScalePosition(i),"overlay"!==this._sourcePosition&&(this._sourceIndex=t.priceScaleIndex(i,this._sourcePosition))}redo(){const e=this._model.panes()[this._paneIndex],t=(0,r.ensureNotNull)(e.getPriceScaleById(this._scaleId));e.movePriceScale(t,this._targetPosition,this._targetIndex),this._model.fullUpdate()}undo(){const e=this._model.panes()[this._paneIndex],t=(0,r.ensureNotNull)(e.getPriceScaleById(this._scaleId));e.movePriceScale(t,this._sourcePosition,this._sourceIndex),this._model.fullUpdate()}}var g=i(87048);class v extends m.UndoCommand{constructor(e,t,i,r){super(r),this._createdIds=[],this._model=e,this._withoutShift=i,this._origStates=t.map(e=>e.state(!0));const s=e.lineToolsGroupModel();this._origGroups=t.map(e=>{const t=s.groupForLineTool(e);return t&&t.id})}redo(){const e=this._model.lineToolsGroupModel(),t=this._origStates.map((t,i)=>{const s=(0,
r.ensureNotNull)(this._model.dataSourceForId(t.id)),n=0===this._createdIds.length?void 0:(0,r.ensureDefined)(this._createdIds[i]),o=(0,g.cloneLineTool)(this._model,s,!this._withoutShift,n),a=(0,r.ensureNotNull)(s.priceScale());(0,r.ensureNotNull)(this._model.paneForSource(s)).addDataSource(o,a,!1);const l=this._origGroups[i];if(null!==l){const t=e.groupForId(l);t&&t.addLineTools([o])}return this._model.updateSource(o),o});0===this._createdIds.length&&(this._createdIds=t.map(e=>e.id())),this._model.selectionMacro(e=>{e.clearSelection(),t.forEach(t=>{e.addSourceToSelection(t)})}),this._model.setShouldBeSavedEvenIfHidden(!0)}undo(){const e=this._model.lineToolsGroupModel();this._createdIds.forEach(t=>{const i=(0,r.ensureNotNull)(this._model.dataSourceForId(t)),s=e.groupForLineTool(i);null!==s&&s.excludeLineTool(i),this._model.removeSource(i)})}newIds(){return this._createdIds}}var S=i(77903),y=i(31654),b=i(31565),w=i(55304);class P extends m.UndoCommand{constructor(e,t,i,r=!0){super(i,r),this._newStates=[],this._model=e,this._savedStates=t.map(e=>e.state(!1))}redo(){this._applyState(this._newStates)}undo(){0===this._newStates.length&&this.saveNewState(),this._applyState(this._savedStates)}saveNewState(){const e=this._savedStates.filter(b.notNull).map(e=>(0,r.ensureNotNull)(this._model.dataSourceForId(e.id)));this._newStates=e.map(e=>e.state(!1))}_applyState(e){for(const t of e)if(null!==t){const e=this._model.dataSourceForId(t.id);if(null!==e)if((0,w.isStudy)(e)){const i=t.state.inputs,r=e.properties().inputs;for(const e in i)r[e]&&r[e].setValue(i[e])}else this._model.restoreLineToolState(e,t)}}}class C extends m.UndoCommand{constructor(e,t,i){super(i),this._chartModel=e,this._sourceId=t.id();const s=(0,r.ensureNotNull)(t.priceScale());this._initialPriceScaleId=s.id(),this._initialPriceScaleState=(0,r.ensureNotNull)(t.priceScale()).state();const n=(0,r.ensureNotNull)(e.paneForSource(t));this._initialPriceScalePosition=n.priceScalePosition(s),this._initialPriceScaleIndex=n.priceScaleIndex(s,this._initialPriceScalePosition),this._initialPaneIndex=e.panes().indexOf(n)}_newPriceScaleState(e){const t={...this._initialPriceScaleState};return delete t.m_isLockScale,delete t.id,delete t.m_topMargin,delete t.m_bottomMargin,t}_originalPriceScaleState(){return this._initialPriceScaleState}}class T extends C{constructor(e,t,i){super(e,t,i)}redo(){const e=(0,r.ensureNotNull)(this._chartModel.dataSourceForId(this._sourceId)),t=(0,r.ensureNotNull)(this._chartModel.paneForSource(e)),i=this._chartModel.children(e,!0);t.bulkActionMacro(()=>{i.forEach(e=>this._chartModel.detachSource(e)),this._chartModel.detachSource(e)});const s=this._chartModel.createPane(this.targetPaneIndex()),n=s.findSuitableScale(e);s.bulkActionMacro(()=>{s.addDataSource(e,n,!1),i.forEach(e=>s.addDataSource(e,n,!1))}),(0,r.ensureNotNull)(e.priceScale()).restoreState(this._newPriceScaleState(s.isOverlay(e))),this._chartModel.fullUpdate(),this._chartModel.setShouldBeSavedEvenIfHidden(!0)}undo(){const e=(0,
r.ensureNotNull)(this._chartModel.dataSourceForId(this._sourceId)),t=(0,r.ensureNotNull)(this._chartModel.paneForSource(e)),i=this._chartModel.children(e,!0);t.bulkActionMacro(()=>{i.forEach(e=>this._chartModel.detachSource(e));const t=this._chartModel.detachSource(e);(0,r.assert)(t,"Undo of detaching must remove pane")});const s=this._chartModel.panes()[this._initialPaneIndex];let n=s.getPriceScaleById(this._initialPriceScaleId);null===n&&(n=s.createPriceScaleAtPosition(this._initialPriceScalePosition,this._initialPriceScaleIndex)),s.bulkActionMacro(()=>{s.addDataSource(e,n,!0),i.forEach(e=>s.addDataSource(e,n,!1))}),(0,r.ensureNotNull)(e.priceScale()).restoreState(this._originalPriceScaleState()),this._chartModel.fullUpdate()}}class x extends T{constructor(e,t,i){super(e,t,i)}targetPaneIndex(){return this._initialPaneIndex+1}}class I extends T{constructor(e,t,i){super(e,t,i)}targetPaneIndex(){return this._initialPaneIndex}}class L extends T{constructor(e,t,i){super(e,t,i)}targetPaneIndex(){return this._chartModel.panes().length}}class M extends C{constructor(e,t,i){super(e,t,i),this._restorePane=!1}redo(){const e=this._chartModel.panes().length,t=this._chartModel.panes()[this._targetPaneIndex()],i=(0,r.ensureNotNull)(this._chartModel.dataSourceForId(this._sourceId)),s=(0,r.ensureNotNull)(this._chartModel.paneForSource(i)),n=this._chartModel.children(i,!0);s.bulkActionMacro(()=>{n.forEach(e=>this._chartModel.detachSource(e)),this._restorePane=this._chartModel.detachSource(i)});const o="overlay"===this._initialPriceScalePosition?this._initialPriceScalePosition:void 0,a=t.findSuitableScale(i,void 0,o),l=0===a.dataSources().length;if(t.bulkActionMacro(()=>{t.addDataSource(i,a,!1),n.forEach(e=>t.addDataSource(e,a,!1))}),i===this._chartModel.mainSeries()){const e=t.priceScalePosition(a);t.movePriceScale(a,e,0)}if(l){(0,r.ensureNotNull)(i.priceScale()).restoreState(this._newPriceScaleState(t.isOverlay(i)))}this._chartModel.fullUpdate(),e!==this._chartModel.panes().length&&this._chartModel.setShouldBeSavedEvenIfHidden(!0)}undo(){let e;e=this._restorePane?this._chartModel.createPane(this._initialPaneIndex):this._chartModel.panes()[this._initialPaneIndex];const t=(0,r.ensureNotNull)(this._chartModel.dataSourceForId(this._sourceId)),i=(0,r.ensureNotNull)(this._chartModel.paneForSource(t)),s=this._chartModel.children(t,!0);i.bulkActionMacro(()=>{s.forEach(e=>this._chartModel.detachSource(e)),this._chartModel.detachSource(t)});let n=e.getPriceScaleById(this._initialPriceScaleId);null===n&&(n=e.createPriceScaleAtPosition(this._initialPriceScalePosition,this._initialPriceScaleIndex)),e.bulkActionMacro(()=>{e.addDataSource(t,n,!0),s.forEach(t=>e.addDataSource(t,n,!1))}),(0,r.ensureNotNull)(t.priceScale()).restoreState(this._originalPriceScaleState()),this._chartModel.fullUpdate()}}class E extends M{constructor(e,t,i){super(e,t,i)}_targetPaneIndex(){return this._initialPaneIndex-1}}class A extends M{constructor(e,t,i){super(e,t,i)}_targetPaneIndex(){return this._initialPaneIndex+1}}class k extends M{constructor(e,t,i,r){
super(e,t,r),this._targetPane=i}_targetPaneIndex(){return this._targetPane}}var D=i(70734),R=i(40089);class N extends m.UndoCommand{constructor(e,t,i,r,s=!0){super("Create "+R.lineToolsLocalizedNames[i],!1),this._lineId=null,this._lineState=null,this._model=e,this._paneIndex=e.panes().indexOf(t),this._lineTool=i,this._ownerSourceId=r.id(),this._drawOnAllCharts=s}startCreatingLine(e,t,i){const r=this._model.panes()[this._paneIndex],s=this._model.dataSourceForId(this._ownerSourceId),n=this._model.createLineTool(r,e,this._lineTool,t,i,s);return this._lineId=n.id(),!this._model.lineBeingCreated()}continueCreatingLine(e,t,i,r){const s=this._model.continueCreatingLine(e,t,i,r);return s&&this._model.setShouldBeSavedEvenIfHidden(!0),s}line(){return null===this._lineId?null:this._model.dataSourceForId(this._lineId)}undo(){const e=this.line();null!==e&&(this._lineState=e.state(!1),this._model.removeSource(e),this._lineId=null)}redo(){if(null===this._lineState)return;const e=this._model.restoreSource(!1,this._paneIndex,null,(0,r.ensureNotNull)(this._lineState),null);null!==e&&(this._lineId=e.id(),this._lineState=null)}drawOnAllCharts(){return this._drawOnAllCharts}}var O=i(49992);class V extends m.UndoCommand{constructor(e,t,i){super(i),this._sourcesByPanes=new Map,this._originalState=new Map,this._model=e,t.forEach(t=>{const i=(0,r.ensureNotNull)(e.paneForSource(t)),s=e.panes().indexOf(i),n=this._sourcesByPanes.get(s)||[];n.push(t.id()),this._sourcesByPanes.set(s,n)}),Array.from(this._sourcesByPanes.keys()).forEach(t=>{const i=e.panes()[t],r=new Map;i.sourcesByGroup().allIncludingHidden().forEach(e=>{r.set(e.id(),e.zorder())}),this._originalState.set(t,r)})}undo(){this._originalState.forEach((e,t)=>{const i=this._model.panes()[t],s=new Map;e.forEach((e,t)=>{const n=(0,r.ensureNotNull)(i.dataSourceForId(t));s.set(n,e)}),i.setZOrders(s)})}redo(){this._sourcesByPanes.forEach((e,t)=>{const i=this._model.panes()[t],s=e.map(e=>(0,r.ensureNotNull)(i.dataSourceForId(e)));this._paneOperation(i,s)})}}class B extends V{constructor(e,t){super(e,t,`Bring ${t[0].title()} to front`)}_paneOperation(e,t){e.bringToFront(t)}}class F extends V{constructor(e,t){super(e,t,`Send ${t[0].title()} to back`)}_paneOperation(e,t){e.sendToBack(t)}}class W extends V{constructor(e,t,i,r){super(e,t,r),this._targetSource=i}_paneOperation(e,t){e.insertAfter(t,this._targetSource)}}class U extends W{constructor(e,t,i){super(e,t,i,`Insert ${t[0].title()} after ${i.title()}`)}}class H extends V{constructor(e,t,i,r){super(e,t,r),this._targetSource=i}_paneOperation(e,t){e.insertBefore(t,this._targetSource)}}class z extends H{constructor(e,t,i){super(e,t,i,`Insert ${t[0].title()} before ${i.title()}`)}}function j(e,t){const i=t[0],r=e.sourcesByGroup().all().filter(e=>e.zorder()<i.zorder());if(0===r.length)throw new Error("Cannot move backward source that alreadt on back");let s=r[r.length-1];if((0,g.isLineTool)(s)){const t=e.model().lineToolsGroupModel().groupForLineTool(s);null!==t&&(s=t.lineTools()[0])}return s}class Y extends H{constructor(e,t,i){
super(e,i,j(t,i),`Send ${i[0].title()} backward`)}}function G(e,t){const i=t[t.length-1],r=e.sourcesByGroup().allExceptSpecialSources().filter(e=>e.zorder()>i.zorder());if(0===r.length)throw new Error("Cannot bring forward source that alreadt on back");let s=r[0];if((0,g.isLineTool)(s)){const t=e.model().lineToolsGroupModel().groupForLineTool(s);if(null!==t){const e=t.lineTools();s=e[e.length-1]}}return s}class q extends W{constructor(e,t,i){super(e,i,G(t,i),`Send ${i[0].title()} backward`)}}function X(e,t){return(0,r.ensureNotNull)(e.paneForSource(t.lineTools()[0]))}class $ extends H{constructor(e,t){super(e,t.lineTools(),j(X(e,t),t.lineTools()),`Send Group ${t.name()} backward`)}}class K extends W{constructor(e,t){super(e,t.lineTools(),G(X(e,t),t.lineTools()),`Bring Group ${t.name()} backward`)}}class J extends m.UndoCommand{constructor(e,t,i){super("Rearrange panes"),this._chartModel=e,this._index=t,(0,b.isNumber)(i)?this._dstIndex=i:this._dstIndex="up"===i?t-1:t+1}redo(){this._checkIndices()&&this._chartModel.movePane(this._index,this._dstIndex)}undo(){this._checkIndices()&&this._chartModel.movePane(this._dstIndex,this._index)}_checkIndices(){const e=this._chartModel.panes().length;return this._index>=0&&this._index<e&&this._dstIndex>=0&&this._dstIndex<e}}var Z=i(77928),Q=i(8218),ee=i(1771),te=i(20554),ie=i(52946),re=i(19453);class se extends m.UndoCommand{constructor(e,t,i,r,s,n){super(r),this._prevPriceAxisProps={},this._property=e,this._mainSeries=i,this._value=t,this._model=s,this._chartWidget=n}redo(){const e=this._mainSeries,t=e.properties().childs();t.style===this._property&&e.isNeedRestart(this._value)&&this._chartWidget.screen.show(),this._prevResolution=t.interval.value(),this._prevValue=this._property.value(),this._storePriceAxisProps(),(0,ee.saveDefaultProperties)(!0);const i=t.interval.value(),r=this._model.defaultResolutions(),s=(0,re.getResolutionByChartStyle)(this._value,i,r);ie.linking.interval.setValue(s),e.setChartStyleWithIntervalIfNeeded(this._value,s),(0,te.setLastUsedStyle)(this._value,e.symbolInfo()),(0,te.preparePriceAxisProperties)(t),(0,ee.saveDefaultProperties)(!1),this._invalidateModel()}undo(){const e=this._mainSeries;e.properties().childs().style===this._property&&e.isNeedRestart(this._value)&&this._chartWidget.screen.show(),(0,ee.saveDefaultProperties)(!0),e.setChartStyleWithIntervalIfNeeded(this._prevValue,this._prevResolution),this._restorePriceAxisProps(),ie.linking.interval.setValue(this._prevResolution),(0,ee.saveDefaultProperties)(!1),this._invalidateModel()}_storePriceAxisProps(){const e=this._mainSeries.priceScale();this._prevPriceAxisProps=e.mode()}_restorePriceAxisProps(){this._mainSeries.priceScale().setMode(this._prevPriceAxisProps)}_invalidateModel(){this._model&&(this._model.recalculateAllPanes(),this._model.lightUpdate())}}var ne=i(71004),oe=i(2459);class ae extends m.UndoCommand{constructor(e,t){super("Change date range"),this._modelsData=[],this._rangeOptions=t,this._modelsData.push({model:e,prevResolution:e.mainSeries().properties().childs().interval.value(),
barSpacing:e.timeScale().barSpacing(),rightOffset:e.timeScale().rightOffset(),rangeOptions:e.appliedTimeFrame().value()})}redo(){const e=[];for(const t of this._modelsData){const i=t.model.mainSeries(),r=i.properties().childs().interval;oe.Interval.isEqual(this._rangeOptions.res,r.value())?i.loadDataTo(this._rangeOptions.val):(e.push(r),i.setDefaultTimeframe(this._rangeOptions.val),r.setValueSilently(this._rangeOptions.res))}for(const t of e)t.listeners().fire(t)}undo(){const e=[];for(const t of this._modelsData){const i=t.model.mainSeries(),r=i.properties().childs().interval;t.prevResolution!==r.value()?(e.push(r),null!==t.rangeOptions&&i.setDefaultTimeframe(t.rangeOptions.val),r.setValueSilently(t.prevResolution)):null!==t.rangeOptions&&i.loadDataTo(t.rangeOptions.val);const s=t.model.timeScale();s.setBarSpacing(t.barSpacing),s.setRightOffset(t.rightOffset)}for(const t of e)t.listeners().fire(t)}canMerge(e){return e instanceof ae&&(0,ne.rangesAreEqual)(e._rangeOptions,this._rangeOptions)}merge(e){if(!(e instanceof ae))throw new Error("Invalid command to merge");this._modelsData=this._modelsData.concat(e._modelsData)}}var le=i(68450),ce=i(89931);i(20220),i(68421);class ue extends m.UndoCommand{constructor(e,t,i){super(i),this._model=e,this._groupId=t.id,this._groupName=t.name(),this._lineToolsIds=t.lineTools().map(e=>e.id())}redo(){const e=(0,r.ensureNotNull)(this._model.lineToolsGroupModel().groupForId(this._groupId));this._model.lineToolsGroupModel().removeGroup(e)}undo(){const e=this._lineToolsIds.map(e=>this._model.dataSourceForId(e)),t=new ce.LineToolsGroup(e,this._groupName,this._groupId);this._model.lineToolsGroupModel().addGroup(t)}}const de=window.t("Create line tools group");class he extends m.UndoCommand{constructor(e,t){super(de),this._groupId=null,this._model=e,this._sourcesIds=t.map(e=>e.id())}redo(){const e=this._sourcesIds.map(e=>this._model.dataSourceForId(e)),t=null===this._groupId?void 0:this._groupId;this._groupId=this._model.lineToolsGroupModel().createGroup(e,this._title,t).id}undo(){const e=(0,r.ensureNotNull)(this._model.lineToolsGroupModel().groupForId((0,r.ensureNotNull)(this._groupId)));this._model.lineToolsGroupModel().removeGroup(e)}createdGroupId(){return this._groupId}}const pe=window.t("Add line tool(s) {lineTool} to group {group}");class _e extends m.UndoCommand{constructor(e,t,i){super(pe.format({group:t.name()})),this._model=e,this._groupId=t.id,this._lineToolsIds=i.map(e=>e.id())}redo(){const e=(0,r.ensureNotNull)(this._model.lineToolsGroupModel().groupForId(this._groupId)),t=this._lineToolsIds.map(e=>this._model.dataSourceForId(e));e.addLineTools(t)}undo(){const e=this._lineToolsIds.map(e=>this._model.dataSourceForId(e));(0,r.ensureNotNull)(this._model.lineToolsGroupModel().groupForId(this._groupId)).excludeLineTools(e)}}class me extends m.UndoCommand{constructor(e,t,i,r,s){super(i),this._targetObj=e,this._newValue=t,this._oldValue=this._targetObj.value(),this._model=r,s&&this.setCustomFlag("doesnt_affect_save",!0)}redo(){(0,ee.saveDefaultProperties)(!0),
this._targetObj.setValue(this._newValue),(0,ee.saveDefaultProperties)(!1),this._model.recalculateAllPanes(),this._model.lightUpdate()}undo(){(0,ee.saveDefaultProperties)(!0),this._targetObj.setValue(this._oldValue),(0,ee.saveDefaultProperties)(!1),this._model.recalculateAllPanes(),this._model.lightUpdate()}}class fe extends m.UndoCommand{constructor(e,t,i,r){super(r),this._chartModel=e,this._groupId=t.id,this._oldName=t.name(),this._newName=i}redo(){(0,r.ensureNotNull)(this._chartModel.lineToolsGroupModel().groupForId(this._groupId)).setName(this._newName)}undo(){(0,r.ensureNotNull)(this._chartModel.lineToolsGroupModel().groupForId(this._groupId)).setName(this._oldName)}}var ge=i(14397);const ve=window.t("Create line tools group from selection"),Se=window.t("Removing line tools group {name}"),ye=window.t("Add line tool {lineTool} to group {name}"),be=window.t("Make group {group} visible"),we=window.t("Make group {group} invisible"),Pe=window.t("Lock group {group}"),Ce=window.t("Unlock group {group}"),Te=window.t("Rename group {group} to {newName}");class xe{constructor(e){this._environment=e}createGroupFromSelection(){const e=this._environment.model();(0,r.assert)(!e.selection().isEmpty(),"Cannot create group from empty selection");const t=(0,D.sortSources)(e.selection().lineDataSources());(0,r.assert)(t.length===e.selection().allSources().length,"A group could contain line tools only");const i=t.length>1||null!==this._environment.model().lineToolsGroupModel().groupForLineTool(t[0]),s=t.reduce((e,t)=>e.zorder()>t.zorder()?e:t,t[0]);let n=s;const o=e.lineToolsGroupModel().groupForLineTool(s);if(null!==o){const e=o.lineTools();n=e[e.length-1]}this._environment.beginUndoMacro(ve);const a=new Map,l=new Set;t.forEach(t=>{const i=this._groupForLineTool(t);if(null===i)return;const s=a.get(i)||[];s.push(t),a.set(i,s);const n=(0,r.ensureNotNull)(e.paneForSource(t));l.add(n)}),(0,r.assert)(l.size<=1,"All selected sources should be on the same pane"),a.forEach((t,i)=>{const r=new y.ExcludeLineToolsFromGroupUndoCommand(e,i,t);this._environment.pushUndoCommand(r)});const c=new he(e,(0,D.sortSources)(t));if(this._environment.pushUndoCommand(c),i){const i=new U(e,t,n);this._environment.pushUndoCommand(i)}this._environment.endUndoMacro();const u=(0,r.ensureNotNull)(c.createdGroupId());return(0,r.ensureNotNull)(e.lineToolsGroupModel().groupForId(u))}removeGroup(e){const t=this._environment.model(),i=e.lineTools();this._environment.beginUndoMacro(Se.format({name:e.name()}));const s=new ue(t,e,"");this._environment.pushUndoCommand(s);const n=new S.RemoveSourcesCommand(t,i,"");this._environment.pushUndoCommand(n);const o=t.mainSeries().symbol();i.forEach(e=>{null!==e.linkKey().value()&&(0,ge.removeLineTool)({withUndo:!0,model:t,symbol:o,sourceTitle:e.title(),lineToolState:e.state(!1),linkKey:(0,r.ensureNotNull)(e.linkKey().value())})}),this._environment.endUndoMacro()}groups(){return this._environment.model().lineToolsGroupModel().groups()}excludeLineToolFromGroup(e,t){
const i=this._environment.model(),r=new y.ExcludeLineToolsFromGroupUndoCommand(i,e,[t]);this._environment.pushUndoCommand(r)}addLineToolToGroup(e,t){const i=this._environment.model(),r=i.lineToolsGroupModel().groupForLineTool(t);if(r===e)return;const s=ye.format({lineTool:t.title(),name:e.name()});this._environment.beginUndoMacro(s),null!==r&&this._environment.pushUndoCommand(new y.ExcludeLineToolsFromGroupUndoCommand(i,r,[t])),this._environment.pushUndoCommand(new _e(i,e,[t])),this._environment.endUndoMacro()}bringToFront(e){const t=this._environment.model(),i=new B(t,e.lineTools());this._environment.pushUndoCommand(i),this._environment.emitEvent("changeZOrder",[e.lineTools()])}sendToBack(e){const t=this._environment.model(),i=new F(t,e.lineTools());this._environment.pushUndoCommand(i),this._environment.emitEvent("changeZOrder",[e.lineTools()])}bringForward(e){const t=this._environment.model(),i=new K(t,e);this._environment.pushUndoCommand(i),this._environment.emitEvent("changeZOrder",[e.lineTools()])}sendBackward(e){const t=this._environment.model(),i=new $(t,e);this._environment.pushUndoCommand(i),this._environment.emitEvent("changeZOrder",[e.lineTools()])}insertAfter(e,t){const i=this._environment.model();let r;if(t instanceof ce.LineToolsGroup){const e=t.lineTools();r=e[e.length-1]}else r=t;const s=new U(i,e.lineTools(),r);this._environment.pushUndoCommand(s),this._environment.emitEvent("changeZOrder",[e.lineTools()])}insertBefore(e,t){const i=this._environment.model();let r;if(t instanceof ce.LineToolsGroup){r=t.lineTools()[0]}else r=t;const s=new z(i,e.lineTools(),r);this._environment.pushUndoCommand(s),this._environment.emitEvent("changeZOrder",[e.lineTools()])}availableZOrderOperations(e){const t=this._environment.model(),i=e.lineTools(),s=i[0],n=i[i.length-1],o=(0,r.ensureNotNull)(t.paneForSource(i[0])).sourcesByGroup().allExceptSpecialSources(),a=o[0],l=o[o.length-1];return{bringForwardEnabled:n!==l,bringToFrontEnabled:n!==l,sendBackwardEnabled:s!==a,sendToBackEnabled:s!==a}}setGroupVisibility(e,t){const i=(t?be:we).format({group:e.name()}),r=this._environment.model();this._environment.beginUndoMacro(i),e.lineTools().forEach(e=>{const i=e.properties().visible,s=new me(i,t,"",r);this._environment.pushUndoCommand(s)}),this._environment.endUndoMacro()}setGroupLock(e,t){const i=(t?Pe:Ce).format({group:e.name()}),r=this._environment.model();this._environment.beginUndoMacro(i),e.lineTools().forEach(e=>{const i=e.properties().frozen,s=new me(i,t,"",r);this._environment.pushUndoCommand(s)}),this._environment.endUndoMacro()}setGroupName(e,t){const i=this._environment.model(),r=Te.format({group:e.name(),newName:t}),s=new fe(i,e,t,r);this._environment.pushUndoCommand(s)}canBeGroupped(e){const t=this._environment.model();return new Set(e.map(e=>t.paneForSource(e))).size<=1}_groupForLineTool(e){return this._environment.model().lineToolsGroupModel().groups().find(t=>t.containsLineTool(e))||null}}var Ie=i(77371),Le=i(5877),Me=i(93006);const Ee=window.t("Apply study template {template}");class Ae extends m.UndoCommand{
constructor(e,t,i){super(Ee.format({template:i})),this._model=e,this._templateContent=t,this._initialState=e.studyTemplate(!0,!0,!0),this._initialGroupsState=e.lineToolsGroupModel().state()}redo(){const e=this._merge(this._templateContent).filter(g.isLineTool);this._model.lineToolsGroupModel().removeLineTools(e),this._model.mainSeries().onChartStyleChanged();const t=this._model.mainSeries().properties();(0,te.preparePriceAxisProperties)(t),this._model.recalcVisibleRangeStudies(!0),this._model.setShouldBeSavedEvenIfHidden(!0)}undo(){this._merge(this._initialState),this._model.mainSeries().onChartStyleChanged()}_merge(e){const t=e.version||0,i=this._model,s=i.mainSeries(),n=s.id();s.priceScale().properties().childs().lockScale.setValue(!1);const o=s.properties().childs();if(this._initialState.symbol&&e.symbol&&(o.currencyId.setValue(e.currency||null),o.unitId.setValue(e.unit||null),o.symbol.setValue(e.symbol)),this._initialState.symbol&&e.interval){const t=(0,te.getChartStyleByResolution)(e.interval,o.style.value());s.setChartStyleWithIntervalIfNeeded(t,e.interval)}const a=i.panes(),l=[];for(let e=a.length;e--;){const t=a[e],i=t.containsMainSeries(),r=t.dataSources();for(let e=r.length;e--;){const t=r[e];(!i||(0,w.isStudy)(t)&&t.isRemovedByStudyTemplates())&&l.push(t)}}i.resetDeferredStudies();const c=(0,Ie.closeSourcesSet)(i,l);for(let e=0;e<c.length;++e)i.removeSource(c[e]);const u=e.panes;for(let e=0;e<u.length;e++){let s=-1;const n=(0,b.clone)(u[e]);n.sources.sort((e,t)=>e.zorder-t.zorder);for(let e=0;e<n.sources.length;e++){const t=n.sources[e];if((0,Le.isMainSeriesState)(t)){delete t.state,s=e;break}}const o=s>-1,l=o?a[e]:i.createPane(e);if(o&&t<3&&(0,Me.reorderDataSourcesStateZOrder)(n.sources),l.restoreState(n,!1,t),null!==l.mainDataSource()){const e=(0,r.ensureNotNull)(this._model.alertsWatcher());for(const t of l.dataSources())e.syncSourceAlertLabels(t)}else i.removePane(l)}return(0,r.ensureNotNull)(i.paneForSource(s)).changeSourceId(s,n),i.syncESD(),s.priceScale().setMode({autoScale:!0}),i.startNotStartedStudies(),i.recalculateAllPanes(),i.fullUpdate(),c}}var ke=i(75443),De=i(88987);const Re=(0,u.getLogger)("Chart.ChartUndoModel");class Ne extends m.UndoCommand{constructor(e,t,i,s,n){super("Paste Drawing"),this._needCopyToOtherCharts=!1,this._sourceState=null,this._model=e,this._clipboardData=t,this._paneIndex=this._model.panes().indexOf(i||(0,r.ensureNotNull)(this._model.paneForSource(this._model.mainSeries()))),this._pasteWithData=!!s,this._keepZIndex=!!n}redo(){const e=this._model.panes()[this._paneIndex],t=(0,r.ensureNotNull)(e.clipboardLineToolOwnerSource(this._clipboardData.source.id));null===this._sourceState&&(this._sourceState=this._getSourceState(t));const i=e.restoreLineTool(this._sourceState,this._pasteWithData,this._keepZIndex);this._clipboardData.centeredOnChart&&i.centerPosition&&i.centerPosition();const s=(0,r.ensureNotNull)(t.priceScale());i.setOwnerSource(t),i.setPriceScale(s),s.addDataSource(i),i.restoreFixedPoints(),(0,g.prepareLineToolPropertiesByOwnerSource)(i.properties(),t),
i.calcIsActualSymbol(),i.createServerPoints();const n=(0,De.isSymbolSource)(t)||t.metaInfo().is_price_study;this._needCopyToOtherCharts=Boolean(n&&((0,ge.drawOnAllCharts)().value()||i.linkKey().value()&&i.isSynchronizable())),this._model.setShouldBeSavedEvenIfHidden(!0)}undo(){if(!this._sourceState)return void Re.logError("This command was never executed - nothing to undo");const e=this.source();this._clipboardData.centeredOnChart&&(this._clipboardData.centeredOnChart=!1,this._sourceState.points=e.normalizedPoints()),this._model.removeSource(e)}source(){return(0,r.ensureNotNull)(this._model.dataSourceForId((0,r.ensureNotNull)(this._sourceState).id))}needCopyToOtherCharts(){return this._needCopyToOtherCharts}_getSourceState(e){const t=(0,b.clone)(this._clipboardData.source);delete t.state.symbol,null!=t.linkKey&&(t.linkKey=(0,ke.randomHash)());const i=(0,r.ensureNotNull)(e.priceScale()),n=this._model;let o=!1;this._clipboardData.source.state.symbol===(0,r.ensureNotNull)(e.symbolSource()).symbol()&&((0,De.isSymbolSource)(e)?o=!0:(0,w.isStudy)(e)&&(o=Boolean(e.metaInfo().is_price_study)));const a=e=>{const t=e.x*n.timeScale().width(),r=e.y*i.height()-40;return new s.Point(t,r)},l=(0,r.ensureNotNull)(e.firstValue());if(this._model.id()===this._clipboardData.modelId||!o)for(let e=0;e<this._clipboardData.geometry.length;++e){const r=a(this._clipboardData.geometry[e]),s=n.timeScale().coordinateToIndex(r.x),c=n.timeScale().normalizeBarIndex(s);if(o){const r=i.priceToCoordinate(t.points[e].price,l)+-40;c.price=i.coordinateToPrice(r,l)}else c.price=i.coordinateToPrice(r.y,l);t.points[e]=c}return t.id=(0,ke.guid)(),t}}class Oe extends m.UndoCommand{constructor(e,t,i,s){super(s),this._newSourcesCurrencies=new Map,this._oldSourcesCurrencies=new Map,this._showFade=!1,this._chartWidget=i;const n=i.model().mainSeries();for(const i of e.seriesLikeSources()){if(!i.isVisible())continue;const e=t||(0,te.symbolOriginalCurrency)((0,r.ensureNotNull)(i.symbolInfo()));this._newSourcesCurrencies.set(i.id(),e),this._oldSourcesCurrencies.set(i.id(),i.currency()),this._showFade=this._showFade||i===n&&i.currency()!==e}}redo(){this._applyCurrencies(this._newSourcesCurrencies)}undo(){this._applyCurrencies(this._oldSourcesCurrencies)}_applyCurrencies(e){this._showFade&&this._chartWidget.screen.show();const t=this._chartWidget.model().model();e.forEach((e,i)=>{(0,r.ensureNotNull)(t.dataSourceForId(i)).setCurrency(e)}),this._chartWidget.model().selectionMacro(e=>{e.clearSelection()})}}class Ve extends m.UndoCommand{constructor(e,t,i,s){super(s),this._newSourcesUnits=new Map,this._oldSourcesUnits=new Map,this._showFade=!1,this._chartWidget=i;const n=i.model().mainSeries();for(const i of e.seriesLikeSources()){if(!i.isVisible())continue;const e=t||(0,te.symbolOriginalUnit)((0,r.ensureNotNull)(i.symbolInfo()));this._newSourcesUnits.set(i.id(),e),this._oldSourcesUnits.set(i.id(),i.unit()),this._showFade=this._showFade||i===n&&i.unit()!==e}}redo(){this._applyUnits(this._newSourcesUnits)}undo(){this._applyUnits(this._oldSourcesUnits)}_applyUnits(e){
this._showFade&&this._chartWidget.screen.show();const t=this._chartWidget.model().model();e.forEach((e,i)=>{(0,r.ensureNotNull)(t.dataSourceForId(i)).setUnit(e)}),this._chartWidget.model().selectionMacro(e=>{e.clearSelection()})}}class Be extends C{constructor(e,t,i,r){super(e,t,r),this._sourcePaneRemoved=!1,this._targetPaneIndex=e.panes().indexOf(i)}redo(){const e=this._chartModel.panes()[this._initialPaneIndex],t=this._chartModel.panes()[this._targetPaneIndex],i=e!==t,s=this._targetPriceScale(t),n=(0,r.ensureNotNull)(this._chartModel.dataSourceForId(this._sourceId)),o=this._chartModel.children(n,!0);for(const e of o)i?(this._chartModel.detachSource(e),t.addDataSource(e,s,!1)):t.move(e,s);i?(this._sourcePaneRemoved=this._chartModel.detachSource(n),t.addDataSource(n,s,!1)):t.move(n,s);const a=t.priceScalePosition(s);t.movePriceScale(s,a,this._targetPriceScaleIndex(n)),this._chartModel.fullUpdate()}undo(){this._sourcePaneRemoved&&this._chartModel.createPane(this._initialPaneIndex);const e=this._chartModel.panes()[this._initialPaneIndex],t=e!==this._chartModel.panes()[this._targetPaneIndex],i=(0,r.ensureNotNull)(this._chartModel.dataSourceForId(this._sourceId));let s=e.getPriceScaleById(this._initialPriceScaleId);null===s&&(s=e.createPriceScaleAtPosition(this._initialPriceScalePosition,this._initialPriceScaleIndex));const n=this._chartModel.children(i,!0);for(const i of n)t?(this._chartModel.detachSource(i),e.addDataSource(i,s,!1)):e.move(i,s);t?(this._chartModel.detachSource(i),e.addDataSource(i,s,!1)):e.move(i,s),(0,r.ensureNotNull)(i.priceScale()).restoreState(this._originalPriceScaleState()),this._chartModel.fullUpdate()}}class Fe extends Be{constructor(e,t,i,r,s){super(e,t,i,s),this._targetPriceScalePosition=r}_targetPriceScale(e){const t=e.createPriceScaleAtPosition(this._targetPriceScalePosition);return t.restoreState(this._newPriceScaleState("overlay"===this._targetPriceScalePosition)),t}_targetPriceScaleIndex(e){return e===this._chartModel.mainSeries()?0:void 0}}class We extends Be{constructor(e,t,i,r,s){super(e,t,i,s),this._targetPriceScaleId=r.id()}_targetPriceScale(e){return(0,r.ensureNotNull)(e.getPriceScaleById(this._targetPriceScaleId))}_targetPriceScaleIndex(e){}}class Ue extends m.UndoCommand{constructor(e,t,i){super("Change Symbol"),this._sourceId=e.id(),this._newSymbolParams={symbol:t,currency:null,unit:null},this._prevSymbolParams={symbol:e.symbol(),currency:e.currency(),unit:e.unit(),interval:e.interval(),style:e.style()},this._chartWidget=i,this._showFade=e===i.model().mainSeries()}redo(){this._showFade&&this._chartWidget.screen.show();this._symbolSource().setSymbolParams(this._newSymbolParams)}undo(){this._showFade&&this._chartWidget.screen.show();this._symbolSource().setSymbolParams(this._prevSymbolParams)}_symbolSource(){return(0,r.ensureNotNull)(this._chartWidget.model().model().dataSourceForId(this._sourceId))}}var He=i(29098),ze=i(65904);const je=(0,u.getLogger)("Chart.ChartUndoModel");class Ye extends m.UndoCommand{constructor(e,t,i){super("Paste Indicator"),this._sourceState=null,
this._model=e,this._clipboardData=t,this._paneId=i}redo(){if(!this._sourceState){const e=(0,b.clone)(this._clipboardData.source);e.id=(0,ke.guid)(),this._sourceState=e}let e,t;e=this._paneId?(0,r.ensureNotNull)(this._model.paneForId(this._paneId)):this._sourceState.metaInfo.is_price_study?(0,r.ensureNotNull)(this._model.paneForSource(this._model.mainSeries())):this._model.createPane();const i=!e.mainDataSource();this._sourceState.zorder=e.newStudyZOrder();const s=e.restoreStudy(this._sourceState,!1);this._sourceState.metaInfo.linkedToSeries&&s.setOwnerSource(this._model.mainSeries()),i||(t=this._sourceState.metaInfo.is_price_study?t=this._model.mainSeries().priceScale():this._paneId?e.findSuitableScale(s):e.defaultPriceScale(),t!==s.priceScale()&&e.move(s,t)),(0,w.isStudy)(s)&&s.start()}undo(){if(null===this._sourceState)return void je.logError("This command was never executed - nothing to undo");const e=(0,r.ensureNotNull)(this._model.dataSourceForId(this._sourceState.id));this._model.removeSource(e)}state(){return this._sourceState}}class Ge extends m.UndoCommand{constructor(e,t,i,r,s){super("",!1),this._model=e,this._paneA=t,this._paneB=i,this._prevStretchA=r,this._currStretchA=s}redo(){const e=this._paneA.stretchFactor()+this._paneB.stretchFactor();this._paneA.setStretchFactor(this._currStretchA),this._paneB.setStretchFactor(e-this._currStretchA),this._model.fullUpdate()}undo(){const e=this._paneA.stretchFactor()+this._paneB.stretchFactor();this._paneA.setStretchFactor(this._prevStretchA),this._paneB.setStretchFactor(e-this._prevStretchA),this._model.fullUpdate()}}var qe=i(17483);class Xe extends m.UndoCommand{constructor(e,t,i,r){super("Move",!1),this._endEvent=null,this._model=e,this._sourceId=t.id(),this._itemIndex=i,this._startEvent=r}move(e){this._endEvent=e,this._move(e)}hasChanges(){return null!==this._endEvent}undo(){this._move(this._startEvent)}redo(){this._move((0,r.ensureNotNull)(this._endEvent))}_move(e){const t=(0,r.ensureNotNull)(this._model.dataSourceForId(this._sourceId));(0,r.assert)(void 0!==t.moveItem,'The method "moveItem" is not defined'),t.moveItem&&t.moveItem(new s.Point(e.localX,e.localY),this._itemIndex,new qe.EnvironmentState(e))}}var $e=i(2001);class Ke extends m.UndoCommand{constructor(e,t,i,r,s,n,o,a,l,c,u,d){super(d),this._studyId=null,this._paneState=null,this._chartModel=e,this._studyMetaInfo=t,this._props=r,this._addAsOverlay=s,this._parentId=null==n?null:n.id(),this._inputs=i,this._targetZOrder=u,this._preferredPriceScale=o,this._allowChangeCurrency=a,this._allowChangeUnit=l,this._paneSize=c}redo(){const e=null===this._parentId?void 0:this._chartModel.dataSourceForId(this._parentId),t=this._chartModel.insertStudyWithParams(this._studyMetaInfo,this._inputs,this._targetZOrder,this._props,this._addAsOverlay,e,this._preferredPriceScale,this._allowChangeCurrency,this._allowChangeUnit,this._paneSize,null===this._studyId?void 0:this._studyId);if(this._studyId=t.id(),t.childStudyByRebind().subscribe(null,()=>(0,He.trackEvent)("SOS","Apply SOS","Rebind SOS")),(0,$e.trackStudies)(t,"add"),
this._chartModel.setShouldBeSavedEvenIfHidden(!0),null!==this._paneState){(0,r.ensureNotNull)(this._chartModel.paneForSource(t)).restoreState(this._paneState,!1,this._chartModel.version()),this._paneState=null}}undo(){const e=(0,r.ensureNotNull)(this._chartModel.dataSourceForId((0,r.ensureNotNull)(this._studyId))),t=(0,r.ensureNotNull)(this._chartModel.paneForSource(e)).state();this._chartModel.removeSource(e)&&(this._paneState=t)}insertedStudy(){return this._chartModel.dataSourceForId((0,r.ensureNotNull)(this._studyId))}}var Je=i(66597),Ze=i(16569),Qe=i.n(Ze),et=i(64547),tt=i(44913),it=i(22842),rt=i(51397),st=i(1479);var nt=i(78815);class ot extends m.UndoCommand{constructor(e,t,i,r,s,n){super(e),this._chartModel=t,this._lineToolsSynchronizer=i,this._linkKey=r,this._symbol=s,this._state=n}redo(){const e=(0,g.lineToolByLinkKey)(this._chartModel,this._linkKey);e?new S.RemoveSourcesCommand(this._chartModel,[e],"").redo():this._lineToolsSynchronizer.markSyncedLineToolAsDeleted(this._linkKey,this._symbol).then(e=>{if(null!==e){this._state.id=e;const t=(0,g.lineToolByLinkKey)(this._chartModel,this._linkKey);null!==t&&t.setId(e)}})}undo(){if(null===(0,g.lineToolByLinkKey)(this._chartModel,this._linkKey)){const e=(0,r.ensureNotNull)(this._chartModel.paneForSource(this._chartModel.mainSeries())),t=this._chartModel.panes().indexOf(e);this._chartModel.restoreSource(!1,t,null,this._state,null)}}}var at=i(17117);class lt extends m.UndoCommand{constructor(e,t,i,r,s,n){super("Zoom"),this._barSpacing=null,this._rightBarsOffset=null,this._leftBarsOffset=null,this._priceMode=null,this._model=e,this._startBar=t,this._endBar=i,this._startPrice=r,this._endPrice=s,this._pane=n}redo(){const e=(0,r.ensureNotNull)(this._model.timeScale().visibleBarsStrictRange());this._leftBarsOffset=e.firstBar()-this._startBar,this._rightBarsOffset=e.lastBar()-this._endBar,this._barSpacing=this._model.timeScale().barSpacing(),this._priceMode=this._pane.defaultPriceScale().mode(),this._model.zoomToViewport(this._startBar,this._endBar,this._startPrice,this._endPrice,this._pane)}undo(){const e=this._model.timeScale(),t=this._pane.defaultPriceScale(),i=(0,r.ensureNotNull)(e.visibleBarsStrictRange());e.setBarSpacing((0,r.ensureNotNull)(this._barSpacing)),e.zoomToBarsRange(i.firstBar()+(0,r.ensureNotNull)(this._leftBarsOffset),i.lastBar()+(0,r.ensureNotNull)(this._rightBarsOffset)),t.setMode((0,r.ensureNotNull)(this._priceMode)),t.recalculatePriceRange((0,r.ensureNotNull)(e.visibleBarsStrictRange())),this._model.recalculateAllPanes(),this._model.lightUpdate()}}const ct=(0,u.getLogger)("Chart.ChartUndoModel");class ut extends m.UndoCommand{constructor(e,t,i){super("Zoom"),this._baseCmd=e,this._zoomStack=t,this._inOut=i}undo(){if(this._inOut){if(this._baseCmd!==this._zoomStack.head())return void ct.logDebug("zoom stack inconsistency");this._baseCmd.undo(),this._zoomStack.pop()}else this._baseCmd.redo(),this._zoomStack.push(this._baseCmd)}redo(){if(this._inOut)this._baseCmd.redo(),this._zoomStack.push(this._baseCmd);else{
if(this._baseCmd!==this._zoomStack.head())return void ct.logDebug("zoom stack inconsistency");this._baseCmd.undo(),this._zoomStack.pop()}}}class dt extends m.UndoCommand{constructor(e,t){super("Stop Syncing Drawing"),this._model=e,this._sourceId=t.id(),this._linkKey=t.linkKey().value()}redo(){(0,r.ensureNotNull)(this._model.dataSourceForId(this._sourceId)).linkKey().setValue(null)}undo(){(0,r.ensureNotNull)(this._model.dataSourceForId(this._sourceId)).linkKey().setValue(this._linkKey)}}class ht extends m.UndoCommand{constructor(e,t,i="Restore Defaults"){super(i),this._chartModel=e,this._defaultProperty=t,this._state=t.state()}redo(){this._chartModel.restoreFactoryDefaults(this._defaultProperty)}undo(){this._defaultProperty.mergeAndFire(this._state),this._chartModel.mainSeries().onChartStyleChanged()}}var pt=i(45087);class _t extends ht{redo(){this._defaultProperty.hasChild("intervalsVisibilities")&&this._defaultProperty.childs().intervalsVisibilities.mergeAndFire(pt.intervalsVisibilitiesDefaults),super.redo()}}class mt extends _t{redo(){super.redo(),this._chartModel.recalcColorStudies(!0)}undo(){super.undo(),this._chartModel.recalcColorStudies(!0)}}var ft=i(53423);const gt=window.t("Send {title} backward"),vt=window.t("Bring {title} forward"),St=window.t("Insert {title} after {target}"),yt=window.t("Insert {title} before {target}");function bt(e,t){return{bringForwardEnabled:e.bringForwardEnabled||t.bringForwardEnabled,bringToFrontEnabled:e.bringToFrontEnabled||t.bringToFrontEnabled,sendBackwardEnabled:e.sendBackwardEnabled||t.sendBackwardEnabled,sendToBackEnabled:e.sendToBackEnabled||t.sendToBackEnabled}}class wt extends(a()){constructor(e,t,i,r,s,n,o,a,l,c){super(),this._createLineCommand=null,this._initialTimeScrollState=null,this._initialTimeScrollPos=null,this._currentSourceMoveCommand=null,this._currentLineChangeCommand=null,this._currentCustomMoveCommand=null,this._zoomStack=new _.UndoStack,this._chartWidget=n,this.m_model=new(Qe())(e,t,i,r,s,this,a,l,c),this._undoHistory=o,this._lineToolsGroupController=new xe({model:this._model.bind(this),pushUndoCommand:this._pushUndoCommand.bind(this),beginUndoMacro:this._undoHistory.beginUndoMacro.bind(this._undoHistory),endUndoMacro:this._undoHistory.endUndoMacro.bind(this._undoHistory),emitEvent:this.emitEvent.bind(this)})}undoHistory(){return this._undoHistory}lineToolsGroupController(){return this._lineToolsGroupController}mergeAllScales(e){!function(e,t){e.beginUndoMacro("left"===t?d:h),e.model().panes().forEach(i=>{const r="left"===t?i.rightPriceScales():i.leftPriceScales(),s=("left"===t?i.leftPriceScales():i.rightPriceScales()).concat(r),n="overlay"===i.priceScalePosition(i.defaultPriceScale())?s[0]:i.defaultPriceScale();e.movePriceScale(i,n,t,0),s.forEach(t=>{if(t===n)return;let r=t.mainSource();for(;null!==r;){e.moveToScale(r,i,n,"",!0);const s=t.mainSource();if(s===r){p.logError("Loop detected while trying to merge scales");break}r=s}})}),e.endUndoMacro(),e.model().fullUpdate()}(this,e)}movePriceScale(e,t,i,r){
const s=new f(this._model(),e,t,i,r,window.t("Move scale"));this._pushUndoCommand(s)}createLineTool(e,t,i,s,o,a,l){const c="Create "+R.lineToolsLocalizedNames[i];if(("LineToolRegressionTrend"===i||"LineToolAnchoredVWAP"===i)&&!this.canCreateStudy())return(0,n.showTooManyStudiesNotice)(),null;this.beginUndoMacro(c);const u=!l;this._createLineCommand=new N(this._model(),e,i,a||(0,r.ensureNotNull)(e.mainDataSource()),(0,ge.drawOnAllCharts)().value());const d=this._createLineCommand.startCreatingLine(t,s,o||null),h=(0,r.ensureNotNull)(this._createLineCommand.line());let p=null;if(d&&(u&&this.finishLineTool(h),this._pushUndoCommand(this._createLineCommand),this._createLineCommand=null,p={points:h.normalizedPoints(),interval:this.mainSeries().interval()}),u&&void 0===o&&(0,ge.drawOnAllCharts)().value()&&h.isSynchronizable()){const e=(0,r.ensureNotNull)(this.model().externalTimeStamp(t.index)),s={point:{price:t.price,timeStamp:e},linetool:i,properties:h.properties(),symbol:this.mainSeries().symbol(),model:this.model(),linkKey:(0,r.ensureNotNull)(h.linkKey().value()),finalState:p};h.isFixed()&&(s.pointPositionPercents=h.calcPositionPercents()[0]),(0,ge.createLineTool)(s)}return this.endUndoMacro(),h}continueCreatingLine(e,t,i,s){const n=(0,r.ensureNotNull)(this._createLineCommand);this.beginUndoMacro(n.text());const o=(0,r.ensureNotNull)(this._model().lineBeingCreated()),a=n.continueCreatingLine(e,t,i,s);let l=null;if(a&&(this.finishLineTool(o),this._pushUndoCommand(n),this._createLineCommand=null,l={points:o.normalizedPoints(),interval:this.mainSeries().interval()}),n.drawOnAllCharts()&&o.isSynchronizable()){const i=(0,r.ensureNotNull)(this._model().externalTimeStamp(e.index));(0,ge.continueLineTool)({point:{price:e.price,timeStamp:i},envState:t,finalState:l,model:this._model()})}return this.endUndoMacro(),a}continueExternalLine(e,t,i){const s=(0,r.ensureNotNull)(this._createLineCommand),n=s.continueCreatingLine(e,t,i);return n&&(this._pushUndoCommand(s),this._createLineCommand=null),n}finishLineTool(e){this._model().finishLineTool(e)}pasteImageAsLineTool(e,t,i){const s=this._model().timeScale(),n=s.width(),o=i.height(),a=i.defaultPriceScale(),l=(0,r.ensureNotNull)((0,r.ensureNotNull)(a.mainSource()).firstValue()),c={price:a.coordinateToPrice(o/2,l),index:s.coordinateToIndex(n/2)},u=(0,g.createLineToolProperties)("LineToolImage",void 0,this.model()),d=(0,r.ensureNotNull)(a.mainSource());(0,g.prepareLineToolPropertiesByOwnerSource)(u,d);const h=this.createLineTool(i,c,"LineToolImage",u);return h&&(h.setBlobImageUrl(t),this.selectionMacro(e=>{e.clearSelection(),e.addSourceToSelection(h,null)}),e.then(e=>{h.properties().childs().url.setValue(e)}).catch(e=>{const t=h.linkKey().value(),i=this.model();throw null!==t&&(0,ge.removeLineTool)({withUndo:!1,model:i,linkKey:t,symbol:h.symbol(),sourceTitle:h.title(),lineToolState:h.state(!1)}),i.removeSource(h),e})),h}loadRange(e){this._pushUndoCommand(new ae(this._model(),e))}unlinkLines(e){const t=this.model();this.beginUndoMacro("Stop syncing line tool(s)")
;for(const i of e)null!==i.linkKey().value()&&(0,ge.removeLineTool)({withUndo:!0,model:this.model(),symbol:i.symbol(),linkKey:(0,r.ensureNotNull)(i.linkKey().value()),sourceTitle:i.title(),lineToolState:i.state(!1)}),this._pushUndoCommand(new dt(t,i));this.endUndoMacro()}zoomFromViewport(){const e=new ut((0,r.ensureDefined)(this._zoomStack.head()),this._zoomStack,!1);this._pushUndoCommand(e)}zoomToViewport(e,t,i,r,s){const n=new lt(this.m_model,e,t,i,r,s),o=new ut(n,this._zoomStack,!0);this._pushUndoCommand(o)}zoomStack(){return this._zoomStack}hoveredSource(){return this.m_model.hoveredSource()}setProperty(e,t,i,r){if(e&&e.value()!==t){const s=new me(e,t,i,this.m_model,r);this._pushUndoCommand(s),this.emitEvent("setProperty")}}withMacro(e,t){const i=this.beginUndoMacro(e);try{t()}finally{this.endUndoMacro()}return i}barsMarksSources(){return this.m_model.barsMarksSources()}barMarksSourceForId(e){return this.m_model.barMarksSourceForId(e)}canZoomIn(){return this.model().canZoomIn()}canZoomOut(){return this.model().canZoomOut()}zoomOut(){const e=this.timeScale().width();if(this.canZoomOut()){try{this.beginUndoMacro("Zoom Out")}catch(e){return}(0,le.doAnimate)({to:e/5,onStep:e=>{this.startScaleTime(0),this.scaleTimeTo(e),this.endScaleTime()},onComplete:()=>this.endUndoMacro()})}}zoomIn(){const e=this.timeScale().width();if(this.canZoomIn()){try{this.beginUndoMacro("Zoom In")}catch(e){return}(0,le.doAnimate)({to:e/5,onStep:e=>{this.startScaleTime(e),this.scaleTimeTo(0),this.endScaleTime()},onComplete:()=>this.endUndoMacro()})}}startMovingSources(e,t,i,r){e.filter(e=>e.doesMovingAffectsUndo()).length&&(this._currentSourceMoveCommand=new P(this.model(),e,"Move Drawing(s)",!1)),this.model().startMovingSources(e,t,i,new Map,r)}moveSources(e,t){this.model().moveSources(e,new Map,t)}endMovingSource(e){this.model().endMovingSources(e),null!==this._currentSourceMoveCommand&&(this._currentSourceMoveCommand.saveNewState(),this._pushUndoCommand(this._currentSourceMoveCommand)),this._currentSourceMoveCommand=null}startChangingLinetool(e,t,i,r,s){this._currentLineChangeCommand=new P(this.model(),[e],"Change "+i+" point",!1),this.model().startChangingLinetool(e,t,i,r,s)}changeLinePoint(e,t){this.model().changeLinePoint(e,t)}endChangingLinetool(e){this.model().endChangingLinetool(e),null!==this._currentLineChangeCommand&&(this._currentLineChangeCommand.saveNewState(),this._pushUndoCommand(this._currentLineChangeCommand)),this._currentLineChangeCommand=null}setChartStyleProperty(e,t,i){if(e.value()!==t){const r=new se(e,t,this.mainSeries(),i,this.model(),this.chartWidget());this._pushUndoCommand(r),this.emitEvent("setChartStyleProperty"),(0,Q.trackChartStyleChanged)(e.value())}}restorePropertiesForSource(e){(0,g.isLineTool)(e)?this._restoreLineToolFactoryDefaults(e):this._restoreStudyFactoryDefaults(e)}restoreState(e,t,i){return this.m_model.restoreState(e,t,i)}async clipboardCopy(e,t=this.selection().dataSources()){if(!(0,it.enabled)("datasource_copypaste"))return;const i=t.filter(e=>e.copiable());if(0===i.length)return
;for(const e of i)if((0,w.isStudy)(e)&&e.isChildStudy())throw new Error("Can not copy child study");const r=(0,O.clipboardDataForSources)(this._model().id(),i);return null!==r?e.write({app:JSON.stringify(r),text:r.title}):void 0}async clipboardCut(e,t=this.selection().dataSources()){if(!(0,it.enabled)("datasource_copypaste"))return;const i=t.filter(e=>e.copiable());if(0===i.length)return;await this.clipboardCopy(e,i);const r=i.filter(e=>e.isUserDeletable());if(0===r.length)return;const s=1===r.length?"Cut "+r[0].title:"Cut sources";this.beginUndoMacro(s),this.m_model.selectionMacro(()=>{this.removeSources(r,!1,s)}),this.endUndoMacro()}async clipboardPaste(e,t){let i=null;if((0,it.enabled)("datasource_copypaste")&&(i=i||await e.read(),i.app)){const e=JSON.parse(i.app);if(null!==this.pasteSourceFromClip(t,e))return}await this._processSpecialLineToolsContents(e,i,t)}applyStudyTemplate(e,t){const i=new Ae(this._model(),e,t);this._pushUndoCommand(i)}startCustomMoving(e,t,i){this._currentCustomMoveCommand=new Xe(this.model(),e,t,i)}customMoveBeingProcessed(){return null!==this._currentCustomMoveCommand}processCustomMove(e){(0,r.ensureNotNull)(this._currentCustomMoveCommand).move(e)}endCustomMoving(){null!==this._currentCustomMoveCommand&&this._currentCustomMoveCommand.hasChanges()&&(this._pushUndoCommand(this._currentCustomMoveCommand),this._currentCustomMoveCommand=null)}cloneLineTools(e,t){for(let t=0;t<Math.min(5,e.length);++t)(0,Q.trackDrawingCloned)(e[t]);this.beginUndoMacro(window.t("Clone line tools"));const i=new v(this._model(),e,t,window.t("Clone line tools"));if(this._pushUndoCommand(i),(0,ge.drawOnAllCharts)().value()){const e=i.newIds().map(e=>(0,r.ensureNotNull)(this.model().dataSourceForId(e)));this.copyToOtherCharts(e)}return this.endUndoMacro(),this.emitEvent("cloneLineTools"),i.newIds()}removeSource(e,t,i){if(this.lineBeingCreated()===e)return void this.cancelCreatingLine();const r="Remove "+e.title();this.removeSources([e],t,r,i)}removeSelectedSources(){const e=this._model().selection().dataSources();if(!e.length)return;const t=e.length>1?"Remove drawings group":"Remove "+e[0].title();this.removeSources(e,!1,t)}removeSources(e,t,i,s){s||(e=e.filter(e=>e.isUserDeletable()));const n=this._model(),o=n.lineToolsGroupModel();this.beginUndoMacro(i),n.selectionMacro(s=>{const a=new Map;e.forEach(e=>{if((0,g.isLineTool)(e)){const t=o.groupForLineTool(e);if(null!==t){const i=a.get(t)||[];i.push(e),a.set(t,i)}null!==e.linkKey().value()&&(0,ge.removeLineTool)({withUndo:!0,model:this.model(),linkKey:(0,r.ensureNotNull)(e.linkKey().value()),symbol:this.model().mainSeries().symbol(),lineToolState:e.state(!1),sourceTitle:e.title()})}}),a.forEach((e,t)=>{const i=new y.ExcludeLineToolsFromGroupUndoCommand(n,t,e);this._pushUndoCommand(i)});const l=new S.RemoveSourcesCommand(n,e,i),c=l.removedIds();this._pushUndoCommand(l),!t&&c.length>0&&(1===c.length?this.emitEvent("removeSource",[c[0]]):this.emitEvent("removeSources",[c]))}),this.endUndoMacro()}removeUnloadedLineTool(e,t,i,r,s,n){
const o=new ot("Remove "+t,this._model(),e,i,r,s);n?this._pushUndoCommand(o):o.redo()}mergeSourceUp(e){const t=new E(this._model(),e,"Merge up");this._mergeUnmergeSource(e,t)}mergeSourceDown(e){const t=new A(this._model(),e,"Merge down");this._mergeUnmergeSource(e,t)}mergeToPane(e,t){const i=this._model().panes().indexOf(t),r=new k(this._model(),e,i,"Merge to pane");this._mergeUnmergeSource(e,r)}unmergeSourceUp(e){const t=new I(this._model(),e,"Unmerge up");this._mergeUnmergeSource(e,t)}unmergeSourceDown(e){const t=new x(this._model(),e,"Unmerge down");this._mergeUnmergeSource(e,t)}unmergeToNewBottomPane(e){const t=new L(this._model(),e,"Unmerge to new bottom pane");this._mergeUnmergeSource(e,t)}availableZOrderOperations(e){const t=this._model().lineToolsGroupModel(),i=e.filter(g.isLineTool),s=i.map(e=>t.groupForLineTool(e));(0,r.assert)(new Set(s).size<=1,"Cannot move line tools from different group");const n=0===s.length?null:s[0];let o={bringForwardEnabled:!1,bringToFrontEnabled:!1,sendBackwardEnabled:!1,sendToBackEnabled:!1};const a=new Set(i);for(const t of(0,D.sortSources)(e)){if((0,g.isLineTool)(t)&&null!==n){const e=(0,D.sortSources)(n.lineTools().filter(e=>!a.has(e)||e===t));o=bt(o,{bringForwardEnabled:t!==e[e.length-1],bringToFrontEnabled:t!==e[e.length-1],sendBackwardEnabled:t!==e[0],sendToBackEnabled:t!==e[0]});continue}const e=(0,r.ensureNotNull)(this._model().paneForSource(t)).sourcesByGroup().allExceptSpecialSources();if(0===e.length)continue;const i=t.zorder(),s=e[0].zorder(),l=e[e.length-1].zorder();o=bt(o,{bringForwardEnabled:i!==l,bringToFrontEnabled:i!==l,sendBackwardEnabled:i!==s,sendToBackEnabled:i!==s})}return o}sendToBack(e){if(!this.availableZOrderOperations(e).sendToBackEnabled)throw new Error("Send to back operation is unavailable");let t=null;const i=e[0];if((0,g.isLineTool)(i)){const r=this._model().lineToolsGroupModel().groupForLineTool(i);if(null!==r){const i=r.lineTools();t=new z(this.model(),(0,D.sortSources)(e),i[0])}}null===t&&(t=new F(this.model(),(0,D.sortSources)(e))),this._pushUndoCommand(t),this.emitEvent("changeZOrder",[e])}bringToFront(e){if(!this.availableZOrderOperations(e).bringToFrontEnabled)throw new Error("Bring to front operation is unavailable");let t=null;const i=e[0];if((0,g.isLineTool)(i)){const r=this._model().lineToolsGroupModel().groupForLineTool(i);if(null!==r){const i=r.lineTools();t=new U(this.model(),(0,D.sortSources)(e),i[i.length-1])}}null===t&&(t=new B(this.model(),(0,D.sortSources)(e))),this._pushUndoCommand(t),this.emitEvent("changeZOrder",[e])}sendBackward(e){if(!this.availableZOrderOperations(e).sendBackwardEnabled)throw new Error("Send backward operation is unavailable");const t=gt.format({title:e[0].title()});this._sendBackOrBringForward(t,(0,D.sortSources)(e),(e,t)=>new Y(this.model(),e,t))}bringForward(e){if(!this.availableZOrderOperations(e).bringForwardEnabled)throw new Error("Bring forward operation is unavailable");const t=vt.format({title:e[0].title()});this._sendBackOrBringForward(t,(0,D.sortSources)(e),(e,t)=>new q(this.model(),e,t))}
insertAfter(e,t){e=(0,D.sortSources)(e);const i=St.format({title:e[0].title(),target:t.title()});this._insertAfterOrBefore(i,e,t,()=>new U(this.model(),e,t))}insertBefore(e,t){e=(0,D.sortSources)(e);const i=yt.format({title:e[0].title(),target:t.title()});this._insertAfterOrBefore(i,e,t,()=>new z(this.model(),e,t))}detachToRight(e,t){(0,He.trackEvent)("Chart","Move to new right scale");const i=window.t("Move {title} To New Price Scale").format({title:e.title()}),r=new Fe(this.model(),e,t,"right",i);this._pushUndoCommand(r),this.emitEvent("moveSource",[e])}detachToLeft(e,t){(0,He.trackEvent)("Chart","Move to new left scale");const i=window.t("Move {title} To New Left Scale").format({title:e.title()}),r=new Fe(this.model(),e,t,"left",i);this._pushUndoCommand(r),this.emitEvent("moveSource",[e])}detachNoScale(e,t){(0,He.trackEvent)("Chart","Make source no scale");const i=window.t("Make {title} No Scale (Full Screen)").format({title:e.title()}),r=new Fe(this.model(),e,t,"overlay",i);this._pushUndoCommand(r),this.emitEvent("moveSource",[e])}moveToScale(e,t,i,r,s){(0,He.trackEvent)("Chart","Move source to target scale"),this.beginUndoMacro(r);const n=new We(this.model(),e,t,i,r),o=s?null:(0,ze.sourceNewCurrencyOnPinningToPriceScale)(e,i,this._model()),a=s?null:(0,et.sourceNewUnitOnPinningToPriceScale)(e,i,this._model());this._pushUndoCommand(n),null!==o&&this.setPriceScaleCurrency(i,o),null!==a&&this.setPriceScaleUnit(i,a),this.endUndoMacro(),this.emitEvent("moveSource",[e])}startScrollTime(e){const t=this.timeScale();this._initialTimeScrollState={rightOffset:t.rightOffset(),barSpacing:t.barSpacing()},this._initialTimeScrollPos=e,this.model().startScrollTime(e)}scrollTimeTo(e){let t=!1;return null!==this._initialTimeScrollPos&&null!==this._initialTimeScrollState&&Math.abs(e-this._initialTimeScrollPos)>20&&(this._pushUndoCommand(new Z.TimeScaleChangeUndoCommand(this.model(),this._initialTimeScrollState,"Scroll Time")),this._initialTimeScrollPos=null,this._initialTimeScrollState=null,t=!0),this.model().scrollTimeTo(e),t}endScrollTime(){this.model().endScrollTime(),this._initialTimeScrollPos=null,this._initialTimeScrollState=null}startScaleTime(e){const t=this.timeScale(),i={rightOffset:t.rightOffset(),barSpacing:t.barSpacing()};this._pushUndoCommand(new Z.TimeScaleChangeUndoCommand(this.model(),i,"Scale Time")),this.model().startScaleTime(e)}scaleTimeTo(e){this.model().scaleTimeTo(e)}endScaleTime(){this.model().endScaleTime()}resetTimeScale(){const e=this.timeScale(),t={rightOffset:e.rightOffset(),barSpacing:e.barSpacing()};this._pushUndoCommand(new Z.TimeScaleChangeUndoCommand(this.model(),t,"Reset Time Scale")),this.model().resetTimeScale()}startScalePrice(e,t,i,r){this._pushUndoCommand(new tt.PriceScaleChangeUndoCommand(this.model(),e,t,t.state(),r)),this.model().startScalePrice(e,t,i)}scalePriceTo(e,t,i){this.model().scalePriceTo(e,t,i)}endScalePrice(e,t){this.model().endScalePrice(e,t)}resetPriceScale(e,t){this._pushUndoCommand(new tt.PriceScaleChangeUndoCommand(this.m_model,e,t,t.state())),
this.model().resetPriceScale(e,t)}rearrangePanes(e,t){const i=new J(this._model(),e,t);this._pushUndoCommand(i)}movePane(e,t){const i=new J(this._model(),e,t);this._pushUndoCommand(i)}pasteSourceFromClip(e,t,i){const s=t;if(!s||0===s.sources.length)return null;const n=e||(0,r.ensureNotNull)(this.model().paneForSource(this.mainSeries()));if(!s.sources.some(e=>"drawing"!==e.type||null!==n.clipboardLineToolOwnerSource(e.source.id)))return null;this.beginUndoMacro("Paste "+s.title);let o=0;const a=[],l=[];for(const t of s.sources)if("drawing"===t.type&&null!==n.clipboardLineToolOwnerSource(t.source.id)){const e=this.pasteLineTool(n,t);o<5&&((0,Q.trackDrawingPasted)(e),o+=1),l.push(e),a.push(e)}else"study"===t.type&&t.source&&t.source.metaInfo&&this.checkIfFeatureAvailable(new(c())(t.source.metaInfo))&&a.push(this.pasteStudy(t,i?e:void 0));return l.length&&this.selectionMacro(e=>{e.clearSelection(),l.forEach(t=>{e.addSourceToSelection(t,null)})}),this.endUndoMacro(),a}pasteLineTool(e,t,i,r){t.source.state.intervalsVisibilities=(0,ft.mergeIntervalVisibilitiesDefaults)(t.source.state.intervalsVisibilities),(0,ft.makeIntervalsVisibilitiesVisibleAtInterval)(t.source.state.intervalsVisibilities,oe.Interval.parse(this.model().mainSeries().interval()));const s=new Ne(this.model(),t,e,i,r);this._pushUndoCommand(s);const n=s.source();return s.needCopyToOtherCharts()&&this.copyToOtherCharts([n]),this.selectionMacro(e=>{e.clearSelection(),e.addSourceToSelection(n,null)}),n}pasteStudy(e,t){const i=new Ye(this.model(),e,null==t?void 0:t.id());this._pushUndoCommand(i);const s=(0,r.ensureNotNull)(i.state()).id;return(0,r.ensureNotNull)(this._model().dataSourceForId(s))}setPriceScaleCurrency(e,t){const i=new Oe(e,t,this.chartWidget(),"Change currency");this._pushUndoCommand(i)}setPriceScaleUnit(e,t){const i=new Ve(e,t,this.chartWidget(),"Change unit");this._pushUndoCommand(i)}setSymbol(e,t){e.symbol()!==t&&this._pushUndoCommand(new Ue(e,t,this.chartWidget()))}copyToOtherCharts(e){const t=this.mainSeries(),i=t.syncModel(),s=this.timeScale();if(i)for(const n of e){if(!n.isSynchronizable())continue;const e=n.linkKey().value()||(0,ke.randomHash)();n.linkKey().setValue(e);const o=n.state(!1),a=n.normalizedPoints(),l=n.properties().interval.value(),c=t.interval();let u;if(oe.Interval.isEqual(l,c))u=a.map(e=>{const t=(0,r.ensureNotNull)(s.timePointToIndex(e.time_t))+e.offset;return{price:e.price,timeStamp:(0,r.ensureNotNull)(this.model().externalTimeStamp(t))}});else{const e=i.createNewModelWithResolution(l);u=a.map(t=>({price:t.price,timeStamp:0===t.offset?t.time_t:e.projectTime(t.time_t,t.offset)}))}const d={...o,linkKey:e,points:u,linetool:n.toolname,model:this.model(),symbol:t.symbol(),finalState:{points:a,interval:l}};n.isFixed()&&(d.pointPositionPercents=n.calcPositionPercents()),(0,ge.copyLineTool)(d)}}addPaneStretchFactorUndoCommand(e,t,i,r){const s=new Ge(this.model(),e,t,i,r);this._pushUndoCommand(s)}paneForSource(e){return this.m_model.paneForSource(e)}moveSelectedToolsLeft(){return this._moveSelectedTools(2)}moveSelectedToolsUp(){
return this._moveSelectedTools(0)}moveSelectedToolsRight(){return this._moveSelectedTools(3)}moveSelectedToolsDown(){return this._moveSelectedTools(1)}insertStudyWithoutCheck(e,t){return this._insertStudy(e,t,{},!1,void 0,void 0,void 0,void 0,void 0,null,void 0)}saveLineToolState(e,t){this._pushUndoCommand(new P(this.m_model,[e],t))}resetScales(){this.beginUndoMacro("Reset scales"),this.resetTimeScale();for(const e of this.m_model.panes()){for(const t of e.leftPriceScales())this.resetPriceScale(e,t);for(const t of e.rightPriceScales())this.resetPriceScale(e,t)}this.endUndoMacro(),this.m_model.recalculateAllPanes()}_mergeUnmergeSource(e,t){this.beginUndoMacro(t.text());const i=(0,r.ensureNotNull)(this._model().paneForSource(e)),s=new Set(i.sourcesByGroup().lineSources().filter(t=>t.ownerSource()===e));this._model().lineToolsGroupModel().groups().filter(e=>{const t=e.lineTools().some(e=>s.has(e)),i=e.lineTools().some(e=>!s.has(e));return t&&i}).forEach(e=>{this._pushUndoCommand(new y.ExcludeLineToolsFromGroupUndoCommand(this._model(),e,e.lineTools()))}),this._pushUndoCommand(t),this.endUndoMacro()}_insertStudy(e,t,i,s,n,o,a,l,c,u,d){const h="Insert "+e.description;this.beginUndoMacro(h);const p=new Ke(this.model(),e,t,i,s,n,o,a,l,c,u||null,h);this._pushUndoCommand(p);const _=p.insertedStudy();if(void 0!==d){const e=new Je.SetPriceScaleModeCommand(d,(0,r.ensureNotNull)(_.priceScale()),"",this.model());this._pushUndoCommand(e)}return this.endUndoMacro(),_}async _processSpecialLineToolsContents(e,t,i){if(t=t||await e.read(),window.user.id&&t.files){const e=Array.from(t.files).find(nt.blobImageFilter);if(e){const t=URL.createObjectURL(e),s=(0,nt.uploadImage)(e);void 0===i&&(i=(0,r.ensureNotNull)(this._model().paneForSource(this.mainSeries()))),this.pasteImageAsLineTool(s,t,i)}}t.text&&(window.user.id&&(0,rt.isTwitterUrl)(t.text)?(0,rt.createTweetLineToolByUrl)(t.text,this):window.user.id&&(0,at.isIdeaUrl)(t.text)?(0,at.createIdeaLineToolByUrl)(t.text,this):function(e,t){if(null===t.timeScale().logicalRange())return null;const i=t.mainSeries(),s=i.priceScale(),n=t.timeScale(),o=(0,r.ensureNotNull)(t.model().paneForSource(i)),a=(0,r.ensureNotNull)((0,r.ensureNotNull)(s.mainSource()).firstValue()),l=n.coordinateToIndex(t.timeScale().width()/2),c=o.height()/2,u={price:s.coordinateToPrice(c,a),time_t:(0,r.ensureNotNull)(n.indexToTimePoint(l)),offset:0},d=o.newLineToolZOrder(!0),h=st.LineToolText.createProperties().state();h.text=e;const p={type:"drawing",source:{id:(0,ke.randomHashN)(6),zorder:d,type:"LineToolText",state:{interval:i.interval(),...h},symbol:i.symbol(),ownerSource:i.id(),points:[u]},geometry:[],modelId:t.model().id(),centeredOnChart:!0};t.pasteLineTool(o,p,!1,!1)}(t.text,this))}_insertAfterOrBefore(e,t,i,s){const n=(0,r.ensureNotNull)(this._model().paneForSource(i));if(t.some(e=>(0,g.isLineTool)(e)&&this._model().paneForSource(e)!==n))throw new Error("Cannot insert line tool after target on another pane");this.beginUndoMacro(e),t.forEach(e=>{(0,
r.ensureNotNull)(this.model().paneForSource(e))!==n&&this.mergeToPane(e,n)});const o=s();this._pushUndoCommand(o),this.emitEvent("changeZOrder",[t]),this.endUndoMacro()}_sendBackOrBringForward(e,t,i){const s=new Map;t.forEach(e=>{const t=(0,r.ensureNotNull)(this._model().paneForSource(e)),i=s.get(t)||[];i.push(e),s.set(t,i)}),this.beginUndoMacro(e),s.forEach((e,t)=>{this._pushUndoCommand(i(t,e))}),this.endUndoMacro(),this.emitEvent("changeZOrder",[t])}_moveSelectedTools(e){const t=this.model().selection().lineDataSources();if(0===t.length)return!1;if((0,ge.lockDrawings)().value())return!0;const i=this.timeScale().visibleBarsStrictRange();if(null===i)return!1;const r=function(e){const t=new Map;for(const i of e){const e=i.ownerSource();if(null===e)continue;let r=t.get(e);if(void 0===r){const i=e.priceScale(),s=e.priceStep(),n=e.firstValue();if(null===i||null===s||null===n)continue;const o=i.priceRange();if(null===o)continue;r={sources:[],priceScale:i,priceStep:s,startPrice:o.minValue(),firstValue:n},t.set(e,r)}r.sources.push(i)}return t}(t);if(0===r.size)return!1;this.beginUndoMacro(window.t("Move Drawing(s)"));const n=i.firstBar(),o=this.timeScale().indexToCoordinate(n),a=n+(3===e?1:2===e?-1:0),l=this.timeScale().indexToCoordinate(a);return ge.isDirectionalMovementActive.setValue(!0),r.forEach(t=>{const{startPrice:i,priceStep:r,priceScale:c,firstValue:u}=t,d=i+(0===e?r:1===e?-r:0),h=c.priceToCoordinate(i,u),p=c.priceToCoordinate(d,u),_={logical:{index:n,price:i},screen:new s.Point(o,h)},m={logical:{index:a,price:d},screen:new s.Point(l,p)};this.startMovingSources(t.sources,_,null),this.moveSources(m),this.endMovingSource(!1)}),ge.isDirectionalMovementActive.setValue(!1),this.endUndoMacro(),!0}_restoreStudyFactoryDefaults(e){const t=new mt(this.m_model,e.properties());this._pushUndoCommand(t)}_restoreLineToolFactoryDefaults(e){const t="Load default drawing template";this.beginUndoMacro(t),this.saveLineToolState(e,t);const i=new _t(this.m_model,e.properties(),t);this._pushUndoCommand(i),this.saveLineToolState(e,t),this.endUndoMacro(),this.model().updateSource(e)}}},54059:(e,t,i)=>{"use strict";i.d(t,{ChartEvents:()=>d});i(18184);var r=i(4516),s=i.n(r),n=i(10164),o=i(87380),a=i(96276),l=i.n(a),c=i(18184);const u=(0,o.getLogger)("ReutersCalendar");class d{constructor(e){if(this.changed=new(l()),this._pendingDfd=null,this._pushstreamHandler=e=>{const t=this._mergeItems([].concat(e));(t.changed.length||t.added.length)&&this.changed.fire(t)},!(this instanceof d))throw new Error("ChartEvents is a constructor");this.reset(e),s().on("chartevents-reuters",this._pushstreamHandler)}get defaultSelectionTimeAmount(){return 6048e5}items(){return this._items}reset(e){var t;this._pendingDfd&&(this._pendingDfd.reject(),this._pendingDfd=null),this._items=[],this._itemsById={},this.minObtainedTimestamp=1/0,this._noResults=!1,e&&null!=e.from?this.from=Number(e.from):this.from=Date.now()-864e5,this._historyLimit=e&&e.historyLimit,this._maxItems=1/0,e&&void 0!==e.maxItems&&e.maxItems>0&&(this._maxItems=+e.maxItems),
e&&null!=e.to?this.to=e.to:this.to=this.from+this.defaultSelectionTimeAmount,this.from=this.cacheFriendlyTimestamp(this.from),this.to=this.cacheFriendlyTimestamp(this.to),this.currencyFilter=null!==(t=null==e?void 0:e.currencyFilter)&&void 0!==t?t:[],e&&void 0!==e.minImportance&&isFinite(+e.minImportance)?this.minImportance=Math.max(-1,Math.min(1,Math.floor(e.minImportance))):this.minImportance=-1}cacheFriendlyTimestamp(e){return e-e%36e5}formatTimestampForRequest(e){return new Date(e).toISOString()}requestMore(e){if(this._pendingDfd)return this._pendingDfd.promise();if(isFinite(this.minObtainedTimestamp)&&void 0!==this._historyLimit&&Number(new Date(this.from))<this._historyLimit&&(this._noResults=!0),this._items.length>=this._maxItems&&(this._noResults=!0),this._noResults)return c.Deferred().resolve({added:[],changed:[],noResults:!0}).promise();const t=c.Deferred();this._pendingDfd=t,t.always(()=>{this._pendingDfd=null});const i=new URL(window.CHARTEVENTS_URL?window.CHARTEVENTS_URL+"events":"/chartevents/");-1!==this.minImportance&&i.searchParams.set("minImportance",this.minImportance.toString()),isFinite(this.minObtainedTimestamp)&&(this.to=this.from,this.from=this.from-this.defaultSelectionTimeAmount),e&&e.from&&e.from<this.minObtainedTimestamp&&(this.from=this.cacheFriendlyTimestamp(e.from)),i.searchParams.set("from",this.formatTimestampForRequest(this.from)),i.searchParams.set("to",this.formatTimestampForRequest(this.to)),this.currencyFilter.length&&i.searchParams.set("currencies",this.currencyFilter.toString());const r=Date.now(),s=c.ajax({method:"GET",url:i.toString(),dataType:"json"}).done((e,i,s)=>{const o=Date.now()-r;if(n.telemetry.sendReport("calendars","chartevents_http_status",{value:s.status,additional:{source:"ChartEvents"}}),n.telemetry.sendReport("calendars","chartevents_response_time_frame",{value:o,additional:{source:"ChartEvents"}}),t!==this._pendingDfd)return;if(!e||!e.status||"error"===e.status){n.telemetry.sendReport("calendars","chartevents_error");const i=e&&e.errmsg||"invalid response";return u.logError(i),void t.reject(new Error(i))}n.telemetry.sendReport("calendars","chartevents_ok"),this.minObtainedTimestamp=this.from,"no_data"===e.status&&(this._noResults=!0,this.minObtainedTimestamp=-1/0);const a=this._mergeItems(e.result||[]);t.resolve(a),this.changed.fire(a)}).fail((e,s)=>{if(t===this._pendingDfd&&"abort"!==s){u.logWarn("ChartEvents error on request {0}, status: {1}, status text: {2}".format(i.toString(),e.status,e.statusText));const t=Date.now()-r;n.telemetry.sendReport("calendars","chartevents_error"),n.telemetry.sendReport("calendars","chartevents_http_status",{value:e.status||400,additional:{source:"ChartEvents"}}),n.telemetry.sendReport("calendars","chartevents_response_time_frame",{value:t,additional:{source:"ChartEvents"}})}t.reject(e)});return t.fail(()=>{s.abort()}),t.promise()}destroy(){s().off("chartevents-reuters",this._pushstreamHandler),this._items=[],this.reset()}_mergeItems(e){var t;const i=[],r=[],s=this._noResults,n=[];for(let i=e.length;i--;){const r=e[i]
;-1!==this.minImportance&&this.minImportance>(null!==(t=r.importance)&&void 0!==t?t:1/0)||(r.timestamp=Date.parse(r.date),void 0!==this._historyLimit&&r.timestamp<this._historyLimit||n.push(r))}for(let e=0;e<n.length;e++){const t=n[e];if(this._itemsById[t.id]){let e=!1;const i=this._itemsById[t.id];for(const r of Object.keys(t)){const s=r;i[s]!==t[s]&&(i[s]=t[s],e=!0)}e&&r.push(i)}else this._items.length===this._maxItems&&(delete this._itemsById[this._items[0].id],this._items.shift(),i.shift()),this._itemsById[t.id]=t,this._items.push(t),i.push(t)}return{added:i,changed:r,noResults:s}}}},16569:(e,t,i)=>{"use strict";var r=i(96276),s=i(16282).ensureNotNull,n=i(42098),o=i(98853).ChartModelBase,a=i(87048),l=a.isLineTool,c=a.isStudyLineTool,u=i(37594).Watermark,d=i(68724).CheckMobile,h=i(63145).PublishedChartsTimeline,p=i(759),_=i(82324).getPriceAlertsDispatcher,m=i(36989).isAlertResolutionEqual,f=i(94420).InvalidationMask,g=i(94420).InvalidationLevel,v=i(14127),S=v.Study,y=i(24322).NonSeriesStudy,b=i(55304),w=b.createStudy,P=b.isStudy,C=b.isFundamentalStudy,T=v.prepareStudyProperties,x=i(14397),I=i(1771).saveDefaultProperties,L=i(55760).TimeSynchronizer,M=i(87380).getLogger("Chart.ChartModel"),E=i(54876).MainSeriesScaleRatioProperty,A=i(940).scaleRatio,k=i(9193).StudyInserter,D=i(59503).dateFormatProperty,R=i(88987).isSymbolSource,N=i(65904).sourceNewCurrencyOnPinningToPriceScale,O=i(64547).sourceNewUnitOnPinningToPriceScale,V=i(88001),B=i(43948).StudyColorRotatorFactory,F=i(22842),W=i(13054).AppliedTimeFrame,U=!F.enabled("widget")||F.enabled("esdonwidget"),H=F.enabled("auto_enable_symbol_labels"),z=F.enabled("fix_left_edge");class j extends o{constructor(e,t,i,s,n,o,a,l,c){super(e,t,i,s,n,o,a,l,c);var d=this,h=this.m_mainSeries.properties(),p=this._panes[0];p.setStretchFactor(2*p.stretchFactor()),this._properties.listeners().subscribe(this,j.prototype.propertyChangeHandler),this._properties.timezone.listeners().subscribe(null,(function(){d._chartApi&&d._chartApi.isConnected().value()&&d._chartApi.switchTimezone(d.timezone())})),this._timeScale.defaultRightOffsetProperty().listeners().subscribe(null,(function(){d.recalculateAllPanes()})),p.addDataSource(this.m_mainSeries,this._panes[0].findSuitableScale(this.m_mainSeries)),this._mainSeriesScaleRatioProperty=new E(this),this.m_mainSeries.dataEvents().completed().subscribe(this,function(){if(this._scrollingState&&this.gotoTime(),z&&this.m_mainSeries.endOfData()){var e=this.m_mainSeries.bars().first();null!==e&&this._timeScale.setLeftEdgeFix(e.index)}}.bind(this)),this.m_mainSeries.onIntervalChanged().subscribe(this,(function(){this._recalcVRStudiesParams.oldStartVisibleIndex=NaN,this._recalcVRStudiesParams.oldEndVisibleIndex=NaN})),this.m_mainSeries.dataEvents().barReceived().subscribe(this,j.prototype.updateTimeScaleBaseIndex),this._readOnly||(h.addChild("priceAxisProperties",this.m_mainSeries.m_priceScale.properties()),this._properties.paneProperties.legendProperties.showStudyTitles.listeners().subscribe(this,(function(e){
e.value()||d._properties.paneProperties.legendProperties.showStudyArguments.setValue(!1)}))),this._barsMarksSources=a(this);for(var _=0;_<this._barsMarksSources.length;_++)this._barsMarksSources[_].setOwnerSource(this.m_mainSeries);this._syncPointCache={},this._watermarkSource=this._options.watermarkEnabled?new u(this,this.m_mainSeries):null,x.hideAllDrawings().subscribe(this,this._onDrawingsVisibilityChanged),x.hideAllIndicators().subscribe(this,this._onIndicatorsVisibilityChanged),this._properties.scalesProperties.listeners().subscribe(this,j.prototype.fullUpdate),this._studyInserted=new r,this._studyShiftColorStartOffset=void 0,this._linePointBeingEdited=null,this._lineBeingEdited=null,D.subscribe(this,this._updateDateTimeFormatter),this.mainSeries().properties().interval.subscribe(this,this._updateDateTimeFormatter),this._updateDateTimeFormatter(),this._studyColorRotatorFactory=new B(this),U&&this._options.esdEnabled&&this._createESDWatcher(),this._undoModel._chartWidget.onWidget()||this._initAlertsList(),this._dataSourceCollectionChanged.subscribe(this,this._updateShowLegendProperty.bind(this)),this._properties.paneProperties.legendProperties.showLegend.subscribe(this,this._updateShowLegendProperty),this._appliedTimeFrame=new W(this),this.mainSeries().onTimeFrameApplied().subscribe(this,(function(e){var t=null!==e?{res:this.mainSeries().interval(),val:e}:null;this.appliedTimeFrame().setValue(t)}))}applyPreferences(e){for(var t in e)void 0!==this._properties[t]&&"m_mainSeries"!==this._properties[t]&&this._properties[t].mergeAndFire(e[t]);void 0!==e.timeScale&&this._timeScale.defaultRightOffsetProperty().setValue(e.timeScale.defaultRightOffset),this._properties.saveDefaults(),this.m_mainSeries.applyPreferences(e.mainSeries),this.sessions().applyPreferences(e.sessions),this.recalculateAllPanes(),this.fullUpdate()}timezone(){return this._properties.timezone.value()}initConnection(){this._chartApi.switchTimezone(this.timezone())}updatePane(e){var t=this._paneInvalidationMask(e);this.invalidate(t)}fullUpdate(){this.invalidate(f.full())}lightUpdate(){this.invalidate(f.light())}studiesMetaData(){return this._studiesMetaData}studyVersioning(){return this._studyVersioning}restart(){this.initConnection(),this._timeScale.reset(),this.m_mainSeries.restart();for(var e,t=this.dataSources(),i=0;i<t.length;i++)(e=t[i]).restart&&e!==this.m_mainSeries&&e.restart();this.sessions().restart()}startNotStartedStudies(){if(!this.m_mainSeries.isStarted())throw new Error("Cannot start studies: main series is not started");for(var e=this.dataSources(),t=0;t<e.length;t++)P(e[t])&&!e[t].isStarted()&&e[t].restart&&e[t]!==this.m_mainSeries&&e[t].restart()}readOnly(){return this._readOnly}properties(){return this._properties}chartApi(){return this._chartApi}propertyChangeHandler(){this.lightUpdate()}_onDrawingsVisibilityChanged(e){for(var t=!1===e.value(),i=this.dataSources(),r=0;r<i.length;r++){var s=i[r],n=l(s)&&s.properties().visible.value();t&&n?V.emit("drawing_event",s.id(),"show"):!t&&n&&V.emit("drawing_event",s.id(),"hide")}
this.selectionMacro((function(e){e.clearSelection()}))}_onIndicatorsVisibilityChanged(){var e=this.allStudies().filter((function(e){return e.properties().visible.value()&&e.canBeHiddenByGlobalFlag()}));if(0!==e.length){for(var t=!1,i=0;i<e.length;i++)if(this.selection().isSelected(e[i])){t=!0;break}t?this.selectionMacro((function(e){e.clearSelection()})):this.lightUpdate()}}mainSeries(){return this.m_mainSeries}timeScale(){return this._timeScale}watermarkSource(){return this._watermarkSource}crossHairSource(){return this.m_crossHairSource}publishedChartsTimelineSource(){for(var e=0;e<this._barsMarksSources.length;++e)if(this._barsMarksSources[e]instanceof h)return this._barsMarksSources[e];return null}priceScaleSlotsCount(){var e=0,t=0;this._panes.forEach((function(i){e=Math.max(i.leftPriceScales().length,e),t=Math.max(i.rightPriceScales().length,t)}));var i=e+t;if(d.any()){var r=this.paneForSource(this.mainSeries()),s=r.priceScalePosition(this.mainSeries().priceScale()),n="right"===s;return"overlay"===s&&(n=r.rightPriceScales().length>0),n?{left:0,right:1,totallySlots:i}:{left:1,right:0,totallySlots:i}}return{left:e,right:t,totallySlots:e+t}}startScrollPrice(e,t,i){e.startScrollPrice(t,i)}scrollPriceTo(e,t,i){e.scrollPriceTo(t,i),this.invalidate(this._paneInvalidationMask(e,g.Light))}endScrollPrice(e,t){e.endScrollPrice(t),this.invalidate(this._paneInvalidationMask(e,g.Light))}setPriceAutoScale(e,t,i){e.setPriceAutoScale(t,i),this.invalidate(this._paneInvalidationMask(e,g.Light))}updateScales(e,t){this._undoModel._chartWidget._updateScalesActions()}mainSeriesScaleRatioProperty(){return this._mainSeriesScaleRatioProperty}mainSeriesScaleRatioPropertyOnChanged(){this._mainSeriesScaleRatioProperty.listeners().fire(this._mainSeriesScaleRatioProperty)}mainSeriesScaleRatio(){return A(this._timeScale,this.m_mainSeries.priceScale())}setMainSeriesScaleRatio(e){this.paneForSource(this.m_mainSeries).applyPriceScaleRatio(this.m_mainSeries.priceScale(),e)}startScrollTime(e){this._timeScale.startScroll(e),this._isTimeScrolling=!0}scrollTimeTo(e){this._timeScale.scrollTo(e),this.recalculateAllPanes(),this.lightUpdate(),this._setScalesResetAvailable(!0)}endScrollTime(){this._timeScale.endScroll(),this.lightUpdate(),this.recalcVisibleRangeStudies(),this._isTimeScrolling=!1}recalcStudyBasedLineTools(){this.dataSources().forEach((function(e){c(e)&&e.recalcStudyIfNeeded&&e.recalcStudyIfNeeded()}))}restoreTimeScaleState(e){this._timeScale.restoreState(e),this.recalculateAllPanes(),this.lightUpdate(),this._setScalesResetAvailable(!0)}restoreFactoryDefaults(e){e.restoreFactoryDefaults(),this.recalcVisibleRangeStudies(!0)}orderedDataSources(e){var t=[];t.push(this.m_crossHairSource);for(var i=0;i<this._panes.length;i++){var r=this._panes[i].sourcesByGroup().all().slice();e&&r.reverse(),t=t.concat(r)}return t}dataSourceForId(e){for(var t,i=0;i<this._panes.length;++i)if(t=this._panes[i].dataSourceForId(e))return t;return null}children(e,t){return this.dataSources().filter((function(i){
return(!0!==t||!P(i)||!i.isChildStudy())&&i.ownerSource()===e}))}onSyncScrollNeeded(e){var t=this._undoModel._chartWidget;if(t._chartWidgetCollection){var i=this.mainSeries().syncModel();if(i){var r=1e3*this._timeScale.points().roughTime(e,i.projectTime.bind(i));t._chartWidgetCollection.syncScroll(r,this)}}}createSyncPoint(e,t){var i=this._syncPointCache[e.uniqueId()];if(i){var r=i[t.uniqueId()];if(r)return r}else this._syncPointCache[e.uniqueId()]={};var s=new L(e,t);return this._syncPointCache[e.uniqueId()][t.uniqueId()]=s,s}updateTimeScale(e,t,i,r,s,n,o){if(o){this._timeScale.reset();for(var a=this.dataSources(),l=0;l<a.length;l++)a[l].clearData&&a[l].clearData()}if(r.length>0)for(a=this.dataSources(),l=0;l<a.length;l++)a[l].moveData&&a[l].moveData(r);var c=this._timeScale.indexToTimePoint(this._timeScale.baseIndex());this._timeScale.update(e,t,i,n);var u="ChartModel.prototype.updateTimeScale("+e+","+t+","+i.length+","+r.length+","+n.length+","+o+")";if(u+="TimeScale: {first:"+this._timeScale.points().firstIndex()+",last:"+this._timeScale.points().lastIndex()+"}",void 0!==s){var d=this._timeScale.indexToTimePoint(s),h=null!==c&&null!==d&&d>c;this._updateBaseIndex(s,h)}M.logDebug(u),this.recalculateAllPanes(),this.lightUpdate()}updateTimeScaleBaseIndex(e){var t=this.mainSeries().bars();t.isEmpty()||this._updateBaseIndex(s(t.lastIndex()),e&&e.index>0)}_updateBaseIndex(e,t){var i=this.timeScale(),r=i.baseIndex(),s=i.visibleBarsStrictRange(),n=i.logicalRange();if(null!==n&&t){var o=n.contains(r),a=e-r,l=o?null:i.rightOffset()-a;if(!this._options.shiftVisibleRangeOnNewBar&&o){var c=i.indexToCoordinate(r)+i.barSpacing()/2+1,u=r-n.left()+a,d=c/u;if(d>=i.minBarSpacing())i.setBarSpacing(d),l=i.width()/d-u;else s.lastBar()!==r&&(l=i.rightOffset()-a)}null!==l&&i.setRightOffset(l)}i.setBaseIndex(e)}recalculatePane(e){e&&e.recalculate()}recalculateAllPanes(){for(var e=0;e<this._panes.length;++e)this._panes[e].recalculate();this.updateAllPaneViews(),this.crossHairSource().updateAllViews()}createStudyInserter(e){return new k(e,this._studiesMetaInfoRepository,{createStudy:this.insertStudyWithParams.bind(this)})}insertStudyWithParams(e,t,i,r,s,o,a,l,c,u,d){null==o&&(o=this.mainSeries());var h=null;if(!s&&void 0!==e.groupingKey){var p=this.findNonOverlayStudyWithGroupingKey(e.groupingKey);null!==p&&(h=p.pane)}null===h&&(s||e.is_price_study?h=this.paneForSource(o):(h=this.createPane(),void 0!==u&&h.setPaneSize(u))),"Compare@tv-basicstudies"===e.id&&this.m_mainSeries.priceScale().setMode({log:!1,percentage:!0});var _=Object.assign({},r,{inputs:t}),m=T(e,_,h,this.studyVersioning(),o),f=w(this,m,o,e,d);this._recalcVisibleRangeStudiesImpl({studies:[f],oldEndVisibleIndex:-1,oldStartVisibleIndex:-1,force:!0,timerId:null});var g=h.findSuitableScale(f,o,a);if(g===this.mainSeries().priceScale()&&R(f)){var v=l?N(f,g,this,!0):null,S=c?O(f,g,this,!0):null;null===v&&null===S||f.setSymbolParams({currency:v||void 0,unit:S||void 0})}
return R(f)&&h.hasDataSource(this.mainSeries())&&H&&!n.getBool("enable_symbol_labels_on_inserting_compare_once",!1)&&(I(!0),this.properties().scalesProperties.showSymbolLabels.setValue(!0),I(!1),n.setValue("enable_symbol_labels_on_inserting_compare_once",!0)),f.start(),null!==i&&h.id()===i.paneId?h.insertDataSource(f,g,i.zorder):h.addDataSource(f,g),f.properties().linkedToSeries&&f.properties().linkedToSeries.value()&&f.setOwnerSource(this.mainSeries()),this.recalculatePane(h),this.fullUpdate(),this._invalidateBarColorerCaches(),this._recalcVisibleRangeStudiesImpl({studies:[f],force:!0}),this._recalcColorStudiesImpl({studies:[f],force:!0}),this._studyInserted.fire(f),this.alertsWatcher().syncSourceAlertLabels(f),f}studyInserted(){return this._studyInserted}_unmergeAvailable(e){return e===this.m_mainSeries||TradingView.isInherited(e.constructor,S)&&!e.isLinkedToSeries()&&!TradingView.isInherited(e.constructor,y)&&e.showInObjectTree()}isMergeUpAvailableForSource(e){return!!this._unmergeAvailable(e)&&this.paneForSource(e)!==this.panes()[0]}isMergeDownAvailableForSource(e){if(!this._unmergeAvailable(e))return!1;var t=this.paneForSource(e),i=this.panes();return t!==i[i.length-1]}isUnmergeAvailableForSource(e){return!!this._unmergeAvailable(e)&&this.paneForSource(e).dataSources().filter(this._unmergeAvailable,this).length>1}lineBeingEdited(){return this._lineBeingEdited}linePointBeingEdited(){return this._linePointBeingEdited}calculateDefaultTags(){for(var e=[],t=this.dataSources(),i=0;i<t.length;i++){var r=t[i];r.tags&&(e=e.concat(r.tags()))}return e}_sendTo(e,t){var i={},r=this;for(var s in e.forEach((function(e){var t=r.paneForSource(e),s=r._panes.indexOf(t);i[s]||(i[s]=[]),i[s].push(e)})),i){t(r._panes[s],i[s])}this.fullUpdate()}sendToBack(e){this._sendTo(e,(function(e,t){e.sendToBack(t)}))}bringToFront(e){this._sendTo(e,(function(e,t){e.bringToFront(t)}))}clearAllStudies(){for(var e=this.dataSources(),t=0;t<e.length;t++)e[t].clearData&&e[t].clearData()}allLineTools(){return this._getAllSources(l)}getStudyById(e){var t=this.dataSourceForId(e);return null!==t&&P(t)?t:null}getLineToolById(e){var t=this.dataSourceForId(e);return null!==t&&l(t)?t:null}_initAlertsList(){var e=this;return e._alertsListPromise||(e._alertsListPromise=_().then((function(t){function i(t){e.mainSeries().dataEvents().symbolResolved()[t](e,r),e.mainSeries().dataEvents().symbolError()[t](e,e._removeAllAlertLabelsFromChart),e.mainSeries().properties().interval[t](e,r)}function r(){t.ensureFullAlertsList({success:function(){e._alertsList.syncCollections()},error:function(){e._alertsList.reset()}})}return e._alertsList=new p([],{observableCollection:t.alerts,syncEvents:["change:active","change:crossInterval","change:resolution","change:symbol"],validator:function(t){return(t.get("active")||t.isNew())&&m(t,e.mainSeries().interval())&&t.get("symbol")===e.mainSeries().actualSymbol()}}),e._alertsList.on("add",e._addAlertLabelToChart.bind(e)),e._alertsList.on("remove",e._removeAlertLabelFromChart.bind(e)),e._alertsList.on("reset",(function(){
e.resetAlertList()})),e._alertsList.on("change:alertSeries",(function(t){e._removeAlertLabelFromChart(t),e._addAlertLabelToChart(t)})),e._alertsList.syncCollections(),loginStateChange.subscribe(e,(function(){i(window.is_authenticated?"subscribe":"unsubscribe")})),window.is_authenticated&&(i("subscribe"),r()),e._alertsList}))),this._alertsListPromise}_addAlertLabelToChart(e){if(e.get("extra")){var t=e.get("extra").alertSeries().id;this.alertsWatcher().addAlert(e,t)}}_removeAlertLabelFromChart(e){this.alertsWatcher().removeAlert(e)}_removeAllAlertLabelsFromChart(){this.alertsWatcher().removeAllAlertLabels()}getAlertsList(){return this.readOnly()?Promise.resolve(null):this._alertsList?Promise.resolve(this._alertsList):this._initAlertsList()}resetAlertList(){if(this._alertsList){var e=this._alertsList.models;this._removeAllAlertLabelsFromChart();for(var t=e.length-1;t>=0;t--)this._addAlertLabelToChart(e[t])}}setInterval(e,t){var i=setInterval(e,t);return this._modelIntervals.push(i),i}clearInterval(e){clearInterval(e);var t=this._modelIntervals.indexOf(e);t>-1&&this._modelIntervals.splice(t,1)}clearIntervals(){for(var e=0;e<this._modelIntervals.length;e++)clearInterval(this._modelIntervals[e]);this._modelIntervals=[]}destroy(){this.mainSeries().properties().childs().showCountdown.unsubscribeAll(this),this.mainSeries().onTimeFrameApplied().unsubscribeAll(this),this._appliedTimeFrame.destroy();for(var e=0;e<this._barsMarksSources.length;e++)this._barsMarksSources[e].destroy();this.clearIntervals(),x.hideAllDrawings().unsubscribe(this,this._onDrawingsVisibilityChanged),x.hideAllIndicators().unsubscribe(this,this._onIndicatorsVisibilityChanged),this.resetDeferredStudies();for(e=0;e<this._barsMarksSources.length;e++)this._barsMarksSources[e].destroy();for(e=0;e<this._panes.length;e++)this._panes[e].destroy();this._panes.length=0,this._sessions=null,this.m_mainSeries.onStyleChanged().unsubscribe(this._timeScale,this._timeScale.invalidateVisibleBars),this._timeScale.visibleBarsStrictRangeChanged().unsubscribe(this.m_mainSeries,this.m_mainSeries.clearHighLowAvgPriceCache),this._timeScale.destroy(),D.unsubscribe(this,this._updateDateTimeFormatter),this.mainSeries().properties().interval.unsubscribe(this,this._updateDateTimeFormatter),this._trendLineStatsCache&&this._trendLineStatsCache.destroy(),this._fibRetracementLabelsCache&&this._fibRetracementLabelsCache.destroy(),this._alertsList&&this._alertsList.destroy(),loginStateChange.unsubscribeAll(this),this._properties.paneProperties.legendProperties.showLegend.unsubscribeAll(this),this._dataSourceCollectionChanged.unsubscribeAll(this),this.m_crossHairSource.destroy(),super.destroy()}listUserStudies(e){var t=[];e=e||{};for(var i=0;i<this._panes.length;i++)for(var r=this._panes[i].dataSources(),s=0;s<r.length;s++){var n=r[s];if(P(n)&&!C(n)&&n.showInObjectTree()){var o=n.metaInfo&&n.metaInfo();if(o){var a=o.id;if(e.dontCountVolume&&"Volume@tv-basicstudies"===a)continue;if(e.dontCountCompare&&"Compare@tv-basicstudies"===a)continue
;if(e.dontCountOverlay&&"Overlay@tv-basicstudies"===a)continue}t.push(o.shortDescription)}}return t}isJustClonedChart(){return this._undoModel.isJustClonedChart()}restoreSource(e,t,i,r,s){var n,o;n=e?this.createPane(t):this.panes()[t];var a=r.type.toLowerCase().startsWith("study");if(!(o=a?n.restoreStudy(r):n.restoreLineTool(r)))return null;var l=null;r.ownerSource&&(l=n.dataSourceForId(r.ownerSource)),o.setOwnerSource(l);var c=null;if(s?c=n.getPriceScaleById(s.id):o.ownerSource()&&(c=o.ownerSource().priceScale()),c)o.setPriceScale(c),c.addDataSource(o);else{c=n.createPriceScaleAtPosition(s.position,s.priceScaleIndex);s&&s.id&&c.setId(s.id),o.setPriceScale(c),c.addDataSource(o)}if(!e&&i&&i.overlayPriceScales){var u=this.dataSources().filter((function(e){return void 0!==i.overlayPriceScales[e.id()]}));u.forEach(n.removeSourceFromPriceScale.bind(n));var d=new Map;u.forEach((function(e){var t,r=i.overlayPriceScales[e.id()];d.has(r.id)?t=d.get(r.id):((t=n.createPriceScaleAtPosition("overlay")).restoreState(r),d.set(r.id,t)),t.addDataSource(e),e.setPriceScale(t)}))}return o.start(),o.restore&&o.restore(),e&&n.restoreState(i,!1,this.version()),a&&(this.recalculateAllPanes(),this.mainSeries().invalidateBarColorerCache(),this.fullUpdate()),a&&this.alertsWatcher().syncSourceAlertLabels(o),o}selectPointMode(){return this.m_crossHairSource.selectPointMode()}cancelRequestSelectPoint(){this.m_crossHairSource.cancelRequestSelectPoint()}requestSelectPoint(e){return this.m_crossHairSource.requestSelectPoint(e)}onPointSelected(){return this.m_crossHairSource.onPointSelected()}isSeriesStyleSupported(e){return this.m_mainSeries.isStyleSupported(e)}getStudyShiftColorStartOffset(){return this._studyShiftColorStartOffset}setStudyShiftColorStartOffset(e){this._studyShiftColorStartOffset=e}isInReplay(){return this.m_mainSeries.isInReplay()}onInReplayStateChanged(){return this.m_mainSeries.onInReplayStateChanged()}switchToReplay(e,t){this.m_mainSeries.switchToReplay(e,t)}switchToRealtime(){this.m_mainSeries.switchToRealtime(),this._timeScale.resetRightOffset()}rendererOptionsProvider(){return this._rendererOptionsProvider}priceAxisRendererOptions(){return this._rendererOptionsProvider.options()}magnet(){return this._magnet}isPriceScaleVisible(e){var t=this.paneForSource(e.mainSource()),i=t.priceScalePosition(e);if("overlay"===i)return!0;var r=this.priceScaleSlotsCount();return t.priceScaleIndex(e,i)<r[i]}studyMetaInfoRepository(){return this._studiesMetaInfoRepository}studiesColorRotatorFactory(){return this._studyColorRotatorFactory}}e.exports=j},47859:(e,t,i)=>{"use strict";var r=i(32022).makeFont,s=i(32022).parseFont,n=(0,i(87380).getLogger)("Model.ChartTradingUtils"),o={_fontHeightCache:{},_parsedColorCache:{},_parseColor:function(e){if(this._parsedColorCache[e])return this._parsedColorCache[e];var t=document.createElement("div");t.style.color=e;var i=t.style.color.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i)||t.style.color.match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d*\.?\d+)\s*\)$/i),r={r:i[1],g:i[2],b:i[3],
a:i[4]||"1"};return this._parsedColorCache[e]=r,r},getColorFromProperties:function(e,t){var i=1-t.value()/100,r=this._parseColor(e.value());return"rgba("+r.r+","+r.g+","+r.b+","+i+")"},setColorToProperties:function(e,t,i){var r=this._parseColor(e);t.setValue("rgb("+r.r+","+r.g+","+r.b+")");var s=100*(1-r.a);i.setValue(Math.max(0,Math.min(s,100)))},getFontFromProperties:function(e,t,i,s){return r(t.value(),e.value(),s.value()?"italic":"",i.value()?"bold":"")},setFontToProperties:function(e,t,i,r,o){var a=s(e);null!==a?(a.family.length>0&&t.setValue(a.family),i.setValue(a.size),r.setValue(a.bold),o.setValue(a.italic)):n.logError("Invalid font: "+e)},fontHeight:function(e){if(!this._fontHeightCache[e]){var t=document.createElement("span");t.appendChild(document.createTextNode("height")),document.body.appendChild(t),t.style.cssText="font: "+e+"; white-space: nowrap; display: inline;";var i=t.offsetHeight;document.body.removeChild(t),this._fontHeightCache[e]=Math.ceil(i)}return this._fontHeightCache[e]},drawPolyHoverOrPress:function(e,t,i,r){r?(e.save(),e.fillStyle="rgba(0, 0, 0, 0.15)",CanvasEx.drawPoly(e,t,!0),e.restore()):i&&(e.save(),e.fillStyle="rgba(0, 0, 0, 0.1)",CanvasEx.drawPoly(e,t,!0),e.restore())},repaint:function(e){e.lightUpdate()},roundToMinTick:function(e,t){var i=1/e.mainSource().base();return i*Math.round(t/i)}};e.exports=o},25658:(e,t,i)=>{"use strict";var r=i(96276),s=i(73371).LineDataSource,n=i(1073).showGoToTradingViewReferralDialog,{trackGoProFeature:o}=i(82655),a=i(5803).ProductFeatures,l=i(3851).getConfig,c=i(3851).enabled,u=i(23946).createGoProDialog,d=i(55304).isFundamentalStudyMetaInfo,h=i(8276).ProPlans,p=i(42926).PredefinedAction,_=i(68450).doAnimate,m=i(51755).ChartUndoModelBase,f=i(1771).saveDefaultProperties,g=i(14127).Study,v=i(97133).StudyStub,S=i(6450).showTooManyStudiesNotice,y=i(36270).UndoCommand,b=i(5617).ApplyLineToolTemplateUndoCommand,w=i(95277).SetResolutionUndoCommand,P=i(14022).SetPriceScaleSelectionStrategyCommand,C=i(1626).SetScaleRatioPropertiesCommand,T=i(9193).StudyInserter,x=i(29098).trackEvent,I=i(87380).getLogger("Chart.ChartUndoModel"),L=i(82386).RestoreDefaultsPreferencesUndoCommand,M=i(66597).SetPriceScaleModeCommand,E=i(44913).PriceScaleChangeUndoCommand,A=i(2459).Interval,k=i(50543).ChartLoadThemeUndoCommand,D=i(44079).preferencesByWhiteList;class R extends y{constructor(e,t){super("Apply All Chart Properties"),this._model=e,this._undoModel=e.undoModel(),this._newProperties=t,function(e,t){var i={hollowCandle:{related:"candle"}};for(var r in["candleStyle","hollowCandleStyle","haStyle"].forEach((function(t){e[t].wickUpColor=e[t].wickUpColor||e[t].wickColor,e[t].wickDownColor=e[t].wickDownColor||e[t].wickColor})),t.vertGridProperties=t.vertGridProperties||t.gridProperties,t.horzGridProperties=t.horzGridProperties||t.gridProperties,i)if(!e[r+"Style"]){var s=e[i[r].related+"Style"];e[r+"Style"]=TradingView.clone(s)}}(this._newProperties.mainSeries,this._newProperties.paneProperties),this._oldProperties=D(e,e.mainSeries())}_merge(e){f(!0),
this._model.applyPreferences(e),f(!1)}redo(){this._merge(this._newProperties),this._model.mainSeries().onChartStyleChanged(),this._model.updateScales()}undo(){this._merge(this._oldProperties),this._model.mainSeries().onChartStyleChanged(),this._model.updateScales()}}t.ChartUndoModel=class extends m{constructor(e,t,i,s,n,o,a,l,c,u){super(e,t,i,s,n,o,a,l,c,u),this._onSimpleZoomIn=new r,this._onSimpleZoomOut=new r,this.beginUndoMacro=a.beginUndoMacro.bind(a),this.endUndoMacro=a.endUndoMacro.bind(a),this.createUndoCheckpoint=a.createUndoCheckpoint.bind(a),this.undoToCheckpoint=a.undoToCheckpoint.bind(a)}version(){return this.m_model.version()}onData(e){switch(e.method){case"timescale_update":var t=e.params;this.m_model.updateTimeScale(t.index,t.zoffset,t.changes,t.index_diff,t.baseIndex,t.marks,t.clear);break;case"timescale_completed":var i=e.params[0];this.m_model.timeScale().onTimeScaleCompleted(i)}}createPane(e){return this.m_model.createPane(e)}readOnly(){return this.m_model.readOnly()}restart(){this.m_model.restart()}disconnect(){this.m_model.disconnect()}studiesMetaData(){return this.m_model.studiesMetaData()}studyVersioning(){return this.m_model.studyVersioning()}chartModel(){return this._model()}_model(){return this.m_model}pushUndoCommand(e){this._pushUndoCommand(e)}_pushUndoCommand(e){this._undoHistory.pushUndoCommand(e)}startScrollPrice(e,t,i){t.isAutoScale()||(this._initialPriceScrollState=t.state(),this._initialPriceScrollPos=i,this.chartModel().startScrollPrice(e,t,i))}scrollPriceTo(e,t,i){t.isAutoScale()||(this._initialPriceScrollPos&&Math.abs(this._initialPriceScrollPos-i)>20&&(this.pushUndoCommand(new E(this.m_model,e,t,this._initialPriceScrollState)),delete this._initialPriceScrollState,delete this._initialPriceScrollPos),this.chartModel().scrollPriceTo(e,t,i))}endScrollPrice(e,t){t.isAutoScale()||(delete this._initialPriceScrollState,delete this._initialPriceScrollPos,this.chartModel().endScrollPrice(e,t))}setPriceAutoScale(e,t,i){this.pushUndoCommand(new E(this.m_model,e,t,t.state())),this.chartModel().setPriceAutoScale(e,t,i)}setWidth(e){this.m_model.setWidth(e)}setPaneHeight(e,t){this.m_model.setPaneHeight(e,t)}gridSource(){return this.m_model.gridSource()}watermarkSource(){return this.m_model.watermarkSource()}addAlertsSource(e){return this.m_model.addAlertsSource(e)}alertsSources(){return this.m_model.alertsSources()}publishedChartsTimelineSource(){return this.m_model.publishedChartsTimelineSource()}crossHairSource(){return this.m_model.crossHairSource()}model(){return this.m_model}chartWidget(){return this._chartWidget}mainSeries(){return this.m_model.m_mainSeries}mainSeriesScaleRatioProperty(){return this.m_model.mainSeriesScaleRatioProperty()}panes(){return this.m_model.panes()}timeScale(){return this.m_model.timeScale()}selectionMacro(e){return this.m_model.selectionMacro(e)}setHoveredSource(e,t){this.m_model.setHoveredSource(e,t)}selection(){return this.m_model.selection()}onSelectedSourceChanged(){return this.m_model.onSelectedSourceChanged()}activeStrategySource(){
return this.m_model.activeStrategySource()}invalidate(e){this.m_model.invalidate(e)}setCurrentPosition(e,t,i,r){this.m_model.setCurrentPosition(e,t,i,r)}setAndSaveCurrentPosition(e,t,i,r){this.m_model.setAndSaveCurrentPosition(e,t,i,r)}canCreateStudy(e){return this.model().chartApi().chartApi().isCanCreateStudy(e)}_isCountedStudy(e){return!["Volume@tv-basicstudies","Compare@tv-basicstudies","Overlay@tv-basicstudies"].includes(e.id)&&!d(e)}checkIfFeatureAvailable(e,t){var i=this.canCreateStudy(),r=t&&t instanceof g;if(!this.readOnly()&&r&&(i=this.canCreateStudy(!0)),!i)return r?u({feature:"studyOnStudy"}):S(),!1;if(!this._isCountedStudy(e))return!0;var s=this.m_model.listUserStudies({dontCountVolume:!0,dontCountOverlay:!0,dontCountCompare:!0}),d=c(a.INDICATORS_ON_CHART)?l(a.INDICATORS_ON_CHART).limit:1/0;return s.length<d||(TradingView.onWidget()?n({feature:"indicators"}):(o("studyLimit"),u({feature:"studyLimit",customParams:s,actions:[h.ProPremium,h.ProPremiumTrial].includes(window.user.pro_plan)?[{text:window.t("Cheers"),action:p.Close}]:void 0})),!1)}createStudyInserter(e,t,i){var r=this,s=null,n={createStudy:function(e,t,i,n,o,a,l,c,u,d,h){return r.checkIfFeatureAvailable(e,a)?(x("studies","Study_"+e.id),"Compare@tv-basicstudies"===e.id&&x("compare","symbol:"+t.symbol),r._insertStudy(e,t,n,o,a,l,c,u,d,s,h)):(I.logNormal("Cannot insert study "+e.id),null)}};void 0!==i&&(n.createStub=function(){var e=r.m_model.insertStudyStub(i);return s={targetPaneId:r.m_model.paneForSource(e).id(),targetZOrder:e.zorder()},e.id()},n.removeStub=function(e){return r.m_model.removeStudyStub(e)});var o=new T(e,this.m_model._studiesMetaInfoRepository,n);return o.setParentSource(t),o}setProperties(e,t,i){var r=this;this.beginUndoMacro(i),this.m_model.selectionMacro((function(){for(var s=0;s<e.length;s++)r.setProperty(e[s],t[s],i)})),this.endUndoMacro()}setPriceScaleMode(e,t,i){for(var r=Object.keys(e),s=t.mode(),n=!1,o=0;o<r.length;o++)if(s[r[o]]!==e[r[o]]){n=!0;break}if(n){var a=new M(e,t,i,this.m_model);this.pushUndoCommand(a)}}setPriceScaleSelectionStrategy(e){if(this.m_model.properties().priceScaleSelectionStrategyName.value()!==e){x("Chart","Change PriceScale Selection Strategy");var t="Set Price Scale Selection Stretegy to "+e;this.beginUndoMacro(t),this.setProperty(this.m_model.properties().priceScaleSelectionStrategyName,e,t);var i=new P(this.m_model,e,t);this.pushUndoCommand(i),this.endUndoMacro()}}setScaleRatioProperty(e,t,i){if(e.value()!==t){var r=new C(e,t,i,this.m_model);this.pushUndoCommand(r)}}setResolutionProperty(e,t,i,r){if(!A.isEqual(e.value(),t)){var s=new w(e,t,i,r);this.pushUndoCommand(s)}}lineBeingCreated(){return this.m_model.lineBeingCreated()}paneBeingCreatedLineOn(){return this.m_model.paneBeingCreatedLineOn()}cancelCreatingLine(){this.m_model.cancelCreatingLine()}lineCancelled(){return this.m_model.lineCancelled()}lineBeingEdited(){return this.m_model.lineBeingEdited()}sourcesBeingMoved(){return this.m_model.sourcesBeingMoved()}dataSources(){return this.m_model.dataSources()}orderedDataSources(e){
return this.m_model.orderedDataSources(e)}dataSourceForId(e){return this.m_model.dataSourceForId(e)}state(e,t,i,r){return this.m_model.state(e,t,i,r)}asyncState(){return this.m_model.asyncState()}calculateDefaultTags(){return this.m_model.calculateDefaultTags()}onTagsChanged(){return this.m_model.onTagsChanged()}_removeAllStudiesImpl(){for(var e=this.m_model.dataSources(),t=0;t<e.length;t++){var i=e[t];(TradingView.isInherited(i.constructor,g)&&!i.isChildStudy()&&i.removeByRemoveAllStudies()||TradingView.isInherited(i.constructor,v))&&this.removeSource(i)}}removeAllStudies(){this.beginUndoMacro(window.t("Remove all studies")),this._removeAllStudiesImpl(),this.endUndoMacro()}_removeAllDrawingToolsImpl(e){var t=this;this.selectionMacro((function(){t.lineBeingCreated()&&t.cancelCreatingLine();for(var i=t.dataSources(),r=0;r<i.length;r++){var n=i[r];TradingView.isInherited(n.constructor,s)&&n.isActualSymbol()&&n.isUserDeletable()&&(e&&e!==n.toolname||t.removeSource(n))}}))}removeAllDrawingTools(e){this.beginUndoMacro(window.t("Remove Drawings")),this._removeAllDrawingToolsImpl(),this.endUndoMacro()}removeAllStudiesAndDrawingTools(){this.beginUndoMacro(window.t("Remove all studies and drawing tools")),this._removeAllDrawingToolsImpl(),this._removeAllStudiesImpl(),this.endUndoMacro()}moveLeft(){try{this.beginUndoMacro("Move Left")}catch(e){return}var e=this.m_model.timeScale().width(),t=this;_({to:e/5,onStep:function(e){t.startScrollTime(e),t.scrollTimeTo(0),t.endScrollTime()},onComplete:function(){t.endUndoMacro()}})}moveRight(){try{this.beginUndoMacro("Move Right")}catch(e){return}var e=this.m_model.timeScale().width(),t=this;_({to:e/5,onStep:function(e){t.startScrollTime(0),t.scrollTimeTo(e),t.endScrollTime()},onComplete:function(){t.endUndoMacro()}})}scrollChart(e){this.m_model.scrollEnabled()&&(this.startScrollTime(0),this.scrollTimeTo(e),this.endScrollTime())}scrollChartByBar(e){if(this.m_model.scrollEnabled()){var t=e*this.m_model.timeScale().barSpacing();this.startScrollTime(0),this.scrollTimeTo(t),this.endScrollTime()}}restorePreferences(){var e=new L(this.model());this.pushUndoCommand(e)}applyPreferences(e){var t=new R(this.model(),e);this.pushUndoCommand(t)}chartLoadTheme(e,t,i,r){var s=new k(e,t,i);r?s.redo():this.pushUndoCommand(s)}applyLineToolTemplate(e,t,i){this.beginUndoMacro(i),this.saveLineToolState(e,i);var r=new b(e,t,i);this.pushUndoCommand(r),this.saveLineToolState(e,i),this.endUndoMacro(),this.model().updateSource(e)}onSimpleZoomIn(){return this._onSimpleZoomIn}onSimpleZoomOut(){return this._onSimpleZoomOut}getAlertsList(){return this.m_model.getAlertsList()}isJustClonedChart(){return this._chartWidget.isJustClonedChart()}trackTime(){return this._chartWidget.trackTime()}isInReplay(){return this.m_model.isInReplay()}switchToReplay(e,t){this._undoHistory.clearStack(),this.m_model.switchToReplay(e,t)}switchToRealtime(){this._undoHistory.clearStack(),this.m_model.switchToRealtime()}togglePriceScaleAutoScaleMode(e){var t={autoScale:!e.isAutoScale()};this.setPriceScaleMode(t,e,"Auto Scale")}
togglePriceScaleLockScaleMode(e){var t={lockScale:!e.isLockScale()};this.setPriceScaleMode(t,e,"Lock Scale")}setPriceScaleRegularScaleMode(e){this.setPriceScaleMode({log:!1,percentage:!1,indexedTo100:!1},e,"Regular")}togglePriceScaleIndexedTo100ScaleMode(e){var t={indexedTo100:!e.isIndexedTo100()};this.setPriceScaleMode(t,e,"Indexed to 100")}togglePriceScalePercentageScaleMode(e){var t={percentage:!e.isPercentage()};this.setPriceScaleMode(t,e,"Percent")}togglePriceScaleLogScaleMode(e){var t={log:!e.isLog()};this.setPriceScaleMode(t,e,"Logarithmic")}invertPriceScale(e){var t=e.properties().isInverted;this.setProperty(t,!t.value(),"Invert Scale")}removePane(e){var t=this.m_model.panes()[e].dataSources().slice();this.removeSources(t,!1,"Remove pane")}destroy(){this.model().destroy()}}},74026:(e,t,i)=>{"use strict";var r;i.d(t,{ColorType:()=>r}),function(e){e.Solid="solid",e.Gradient="gradient"}(r||(r={}))},65904:(e,t,i)=>{"use strict";i.d(t,{sourceNewCurrencyOnPinningToPriceScale:()=>s});var r=i(88987);function s(e,t,i,s){let n=null;if(i.currencyConversionEnabled()&&(0,r.isSymbolSource)(e)){const r=i.availableCurrencies(),o=t.currency(r),a=e.currency();null!==o&&null!==o.selectedCurrency&&!o.allCurrenciesAreOriginal&&o.selectedCurrency!==a&&(s&&null===a||null!==a&&r.convertible(a))&&(n=o.selectedCurrency)}return n}},91513:(e,t,i)=>{"use strict";i.d(t,{CustomSourceBase:()=>r});class r{constructor(e,t){this._id=e,this._model=t}id(){return this._id}isHoveredEnabled(){return!0}isSelectionEnabled(){return!1}priceScale(){return null}paneViews(e){return[]}labelPaneViews(e){return[]}priceAxisViews(e,t){return[]}updateViewsForPane(e){e.containsMainSeries()&&this.updateAllViews()}}},5877:(e,t,i)=>{"use strict";i.r(t),i.d(t,{isMainSeriesState:()=>s,isStudyState:()=>n,isLineToolState:()=>o,isZOrderedSourceState:()=>a});var r=i(87048);function s(e){return"MainSeries"===e.type}function n(e){return Boolean(e.type)&&e.type.toLowerCase().startsWith("study")}function o(e){return Boolean(e.type)&&(0,r.isLineToolName)(e.type)}function a(e){return s(e)||n(e)||o(e)}},96861:(e,t,i)=>{"use strict";i.d(t,{DataSource:()=>c});var r=i(22842),s=i(65066),n=i.n(s),o=i(75443),a=i(96276),l=i.n(a);class c{constructor(){this.hasAlert=new(n())(!1),this._zorder=0,this.m_priceScale=null,this._id=(0,o.randomHashN)(6),this._ownerSource=null,this._userEditEnabled=!0,this._onPriceScaleChanged=new(l()),this._isSelectionEnabled=!0,this._instanceId=(0,o.randomHashN)(6),this._ownerSourceChanged=new(l()),this._zOrderChanged=new(l())}id(){return this._id}instanceId(){return this._instanceId}preferNoScale(){return!1}setId(e){this._id=e}zorder(){return this._zorder}setZorder(e){"number"==typeof e&&this._zorder!==e&&(this._zorder=e,this._zOrderChanged.fire(e))}isSpeciallyZOrderedSource(){return!1}title(){throw new Error("Implement this fun in a subclass")}priceScale(){return this.m_priceScale}setPriceScale(e){this.m_priceScale=e,this._onPriceScaleChanged.fire()}ownerSource(){return this._ownerSource}setOwnerSource(e){this._ownerSource=e,this._ownerSourceChanged.fire()}
ownerSourceChanged(){return this._ownerSourceChanged}zOrderChanged(){return this._zOrderChanged}isSavedInChart(e){return!0}isSavedInStudyTemplates(){return!0}isRemovedByStudyTemplates(){return!0}hasContextMenu(){return!0}showInObjectTree(){return!0}setUserEditEnabled(e){this._userEditEnabled=e}userEditEnabled(){return this._userEditEnabled}canBeHidden(){return this.userEditEnabled()}isUserDeletable(){return this.userEditEnabled()}properties(){throw new Error("Implement this fun in a subclass")}isVisible(){return this.properties().visible.value()}statusView(){return null}dataWindowView(){return null}legendView(){return null}marketStatusModel(){return null}dataUpdatedModeModel(){return null}dataProblemModel(){return null}priceAxisViews(e,t){return null}timeAxisViews(){return null}updateAllViews(){}paneViews(){return null}labelPaneViews(){return null}isFailed(){return!1}isLoading(){return!1}isPhantom(){return!1}isChildStudy(){return!1}hasChildren(){return!1}canHaveChildren(){return!1}onClickOutside(){}getSourceIcon(){return null}state(e){throw new Error("Implement this fun in a subclass")}onPriceScaleChanged(){return this._onPriceScaleChanged}doesMovingAffectsUndo(){return!0}isMultiPaneAvailable(){return!1}isMultiPaneEnabled(){return!1}copiable(){return!1}cloneable(){return!1}movable(){return!1}isIncludedInAutoScale(){return!1}isHoveredEnabled(){return this.isSelectionEnabled()}isSelectionEnabled(){return this._isSelectionEnabled}setSelectionEnabled(e){this._isSelectionEnabled=e}firstValue(){return null}priceRange(e,t){return null}autoScaleInfo(e,t){return{range:this.priceRange(e,t)}}stateForAlert(){return null}canHasAlert(){return!1}alertCreationAvailable(){return this.hasStateForAlert()}hasStateForAlert(){return r.enabled("alerts")}idForAlert(){return this._id}}},81704:(e,t,i)=>{"use strict";i.d(t,{getDataVendorString:()=>s});var r=i(22842);function s(e){return null==e||r.enabled("bovespa_widget")?null:"QUANDL"===e.exchange?"Quandl.com":["BMFBOVESPA","BME","NAG","TSE","TFX","NZX","BCBA","TWSE","TASE","EURONEXT","TOCOM","BMV","SIX","SGX","GPW","SWB","BCS","WB","SZSE","BELEX","BAHRAIN","EGX","TADAWUL","BVL","LUXSE","DFM","BVC","NSENG","IDX","HSI","QSE","OSE"].includes(e.exchange)?"ICE Data Services":null}},51424:(e,t,i)=>{"use strict";i.d(t,{DataWindowItem:()=>r,DataWindowView:()=>s});class r{constructor(e,t){this._visible=!0,this._title=e,this._value=t}title(){return this._title}setTitle(e){this._title=e}text(){return this._value}value(){return this._value}setValue(e){this._value=e}visible(){return this._visible}setVisible(e){this._visible=e}color(){return this._color}setColor(e){this._color=e}}class s{constructor(){this._items=[],this._header="",this._title=""}header(){return this._header}title(){return this._title}items(){return this._items}update(){}}},59503:(e,t,i)=>{"use strict";i.d(t,{dateFormatProperty:()=>a,restoreDateFormatSettingsValue:()=>l});var r=i(42098),s=i(64297),n=i(10934);function o(){return r.getValue("date_format",(0,n.defaultDateFormat)())}const a=(0,s.createPrimitiveProperty)(o());function l(){
a.setValue((0,n.defaultDateFormat)()),r.remove("date_format")}r.onSync.subscribe(null,()=>a.setValue(o())),a.listeners().subscribe(null,()=>r.setValue("date_format",a.value()))},1771:(e,t,i)=>{"use strict";var r=i(96276),s=i(59440).default,n=i(68981),o=i(27937);function a(e,t,i,r){var s=e?n.defaults:n.factoryDefaults,o=t.startsWith("study_")?TradingView.clone(s("study")):{},a=TradingView.clone(s(t,r));return t.startsWith("study_")&&a.inputs&&delete a.inputs.symbol,"linetoolicon"===t&&e&&(a.icon=n.defaults(t).icon),a=l(a,i),TradingView.merge(o,a),o}function l(e,t){const i=TradingView.clone(e);return t.forEach(e=>s(i,e.split("."))),i}function c(e,t,i,s){var n;void 0===s&&(s=!0),this._defaultName=e,i?n=t:(n=a(s,e,[],null),t&&TradingView.merge(n,t)),o.call(this,n),this._defaultName=e,this._useUserPreferences=s,this.listeners().subscribe(this,c.prototype.onPropertyChanged),this._exclusions=[],this._restoreFactoryDefaultsEvent=new r}inherit(c,o),c._saveDefaults=!1,c.prototype.preferences=function(){return this.state(this._exclusions)},c.prototype.mergePreferences=function(e){this.mergeAndFire(l(e,this._exclusions))},c.prototype.addExclusion=function(e){this._exclusions.indexOf(e)<0&&this._exclusions.push(e)},c.prototype.restoreFactoryDefaults=function(){var e=a(!1,this._defaultName,this._exclusions,null);this.mergeAndFire(e),this._defaultName.startsWith("study_")&&!this._defaultName.startsWith("study_VbPFixed")||this.saveDefaults(),this._restoreFactoryDefaultsEvent.fire()},c.prototype.onRestoreFactoryDefaults=function(){return this._restoreFactoryDefaultsEvent},c.prototype.onPropertyChanged=function(){!c._saveDefaults||this._defaultName.startsWith("study_")&&!this._defaultName.startsWith("study_VbPFixed")||this.saveDefaults()},c.prototype.saveDefaults=function(){this._useUserPreferences&&n.saveDefaults(this._defaultName,this.preferences())},c.prototype.clone=function(e){for(var t=new c(this._defaultName,this.state(),e&&e.replaceByState,this._useUserPreferences),i=0;i<this._exclusions.length;++i)t.addExclusion(this._exclusions[i]);return t},t.DefaultProperty=c,t.saveDefaultProperties=function(e){c._saveDefaults=e},t.createDefaultsState=a},68981:(e,t,i)=>{"use strict";var r=i(94209).PositionPLDisplay;const{getHexColorByName:s}=i(93669),{generateColor:n}=i(50946);var o=i(94209).TradingSourcesHorizontalAlignment,a=i(97786),l=i(53995).LineToolPitchforkStyle,c=i(91491).LineToolBarsPatternMode,u=i(55782).LineStudyPlotStyle,d=i(84434),h=i(57086).PriceAxisLastValueMode,p=i(93441).StoriesTimeLineItemType,_=i(95215).MagnetMode,m=i(98815).LineEnd,f=i(74026).ColorType,g=i(93828).StatsPosition,v=i(42461).sessionsPreferencesDefault,S=i(87380).getLogger("Chart.Defaults"),y=i(39304).CHART_FONT_FAMILY;const b=s("color-tv-blue-500"),w=s("color-tv-blue-600");var P=function(e){var t=function(e,t){return{color:e,visible:t}},i=function(e,t,i){return{coeff:e,color:t,visible:i}},s=function(e,t,i,r,s){return{coeff:e,color:t,visible:i,linestyle:void 0===r?CanvasEx.LINESTYLE_SOLID:r,linewidth:void 0===s?1:s}},S=function(e,t,i){return{color:e,width:i,
visible:t}},P=function(e,t,i,r,s){return{color:e,visible:t,width:i,x:r,y:s}},C=function(e,t,i,r,s,n){return{coeff1:e,coeff2:t,color:i,visible:r,linestyle:void 0===s?CanvasEx.LINESTYLE_SOLID:s,linewidth:void 0===n?1:n}};if(void 0===TradingView.defaultProperties){var I;switch(window.locale){case"ar_AE":I="Asia/Dubai";break;case"au":I="Australia/Sydney";break;case"br":I="America/Sao_Paulo";break;case"ca":I="America/Toronto";break;case"de_DE":case"it":I="Europe/Berlin";break;case"es":I="Europe/Madrid";break;case"fa_IR":I="Asia/Tehran";break;case"fr":case"sv_SE":I="Europe/Paris";break;case"he_IL":case"tr":I="Europe/Athens";break;case"hu_HU":case"pl":I="Europe/Warsaw";break;case"id":case"th_TH":case"vi_VN":I="Asia/Bangkok";break;case"in":I="Asia/Kolkata";break;case"ja":case"kr":I="Asia/Tokyo";break;case"ms_MY":I="Asia/Singapore";break;case"ru":I="Europe/Moscow";break;case"uk":I="Europe/London";break;case"zh_CN":case"zh_TW":I="Asia/Shanghai";break;default:I="Etc/UTC"}TradingView.defaultProperties={chartproperties:{timezone:I,priceScaleSelectionStrategyName:"auto",dataWindowProperties:{background:"rgba( 255, 254, 206, 0.2)",border:"rgba( 96, 96, 144, 1)",font:"Verdana",fontBold:!1,fontItalic:!1,fontSize:10,transparency:80,visible:!0},paneProperties:{backgroundType:f.Solid,background:"#ffffff",backgroundGradientStartColor:"#ffffff",backgroundGradientEndColor:"#ffffff",vertGridProperties:{color:"rgba(42, 46, 57, 0.06)",style:CanvasEx.LINESTYLE_SOLID},horzGridProperties:{color:"rgba(42, 46, 57, 0.06)",style:CanvasEx.LINESTYLE_SOLID},crossHairProperties:{color:"#9598A1",style:CanvasEx.LINESTYLE_DASHED,transparency:0,width:1},topMargin:10,bottomMargin:8,axisProperties:{autoScale:!0,autoScaleDisabled:!1,lockScale:!1,percentage:!1,percentageDisabled:!1,indexedTo100:!1,log:!1,logDisabled:!1,alignLabels:!0,isInverted:!1},legendProperties:{showStudyArguments:!0,showStudyTitles:!0,showStudyValues:!0,showSeriesTitle:!0,showSeriesOHLC:!0,showLegend:!0,showBarChange:!0,showBackground:!0,backgroundTransparency:50}},scalesProperties:{backgroundColor:"#ffffff",lineColor:"rgba(42, 46, 57, 0.14)",textColor:"#131722",fontSize:12,scaleSeriesOnly:!1,showSeriesLastValue:!0,seriesLastValueMode:h.LastValueAccordingToScale,showSeriesPrevCloseValue:!1,showStudyLastValue:!1,showSymbolLabels:!1,showStudyPlotLabels:!1,showBidAskLabels:!1,showPrePostMarketPriceLabel:!0,showFundamentalNameLabel:!1,showFundamentalLastValue:!1,barSpacing:d.DEFAULT_BAR_SPACING,showCurrency:!0,showUnit:!0},mainSeriesProperties:{style:a.STYLE_CANDLES,esdShowDividends:!0,esdShowSplits:!0,esdShowEarnings:!0,esdShowBreaks:!1,esdFlagSize:2,showCountdown:!0,bidAsk:{visible:!1,lineStyle:CanvasEx.LINESTYLE_DOTTED,lineWidth:1,bidLineColor:b,askLineColor:"#EF5350"},prePostMarket:{visible:!0,lineStyle:CanvasEx.LINESTYLE_DOTTED,lineWidth:1,preMarketColor:"#fb8c00",postMarketColor:b},highLowAvgPrice:{highLowPriceLinesVisible:!1,highLowPriceLabelsVisible:!1,averageClosePriceLineVisible:!1,averageClosePriceLabelVisible:!1},showInDataWindow:!0,visible:!0,showPriceLine:!0,priceLineWidth:1,
priceLineColor:"",baseLineColor:"#B2B5BE",showPrevClosePriceLine:!1,prevClosePriceLineWidth:1,prevClosePriceLineColor:"rgba( 85, 85, 85, 1)",minTick:"default",dividendsAdjustment:!1,backAdjustment:!1,settlementAsClose:!0,sessionId:"regular",sessVis:!1,statusViewStyle:{fontSize:16,showExchange:!0,showInterval:!0,symbolTextSource:"description"},candleStyle:{upColor:"#26a69a",downColor:"#ef5350",drawWick:!0,drawBorder:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350",barColorsOnPrevClose:!1,drawBody:!0},hollowCandleStyle:{upColor:"#26a69a",downColor:"#ef5350",drawWick:!0,drawBorder:!0,borderColor:"rgba( 55, 134, 88, 1)",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"rgba( 115, 115, 117, 1)",wickUpColor:"#26a69a",wickDownColor:"#ef5350",drawBody:!0},haStyle:{upColor:"#26a69a",downColor:"#ef5350",drawWick:!0,drawBorder:!0,borderColor:"rgba( 55, 134, 88, 1)",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"rgba( 115, 115, 117, 1)",wickUpColor:"#26a69a",wickDownColor:"#ef5350",showRealLastPrice:!1,barColorsOnPrevClose:!1,inputs:{},inputInfo:{},drawBody:!0},barStyle:{upColor:"#26a69a",downColor:"#ef5350",barColorsOnPrevClose:!1,dontDrawOpen:!1,thinBars:!0},hiloStyle:{color:b,showBorders:!0,borderColor:b,showLabels:!0,labelColor:b,fontSize:7,drawBody:!0},lineStyle:{color:b,linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:2,priceSource:"close",styleType:a.STYLE_LINE_TYPE_SIMPLE},areaStyle:{color1:n(b,72),color2:b,linecolor:b,linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:2,priceSource:"close",transparency:100},priceAxisProperties:{autoScale:!0,autoScaleDisabled:!1,lockScale:!1,percentage:!1,percentageDisabled:!1,indexedTo100:!1,log:!1,logDisabled:!1,isInverted:!1,alignLabels:!0},renkoStyle:{upColor:"#26a69a",downColor:"#ef5350",borderUpColor:"#26a69a",borderDownColor:"#ef5350",upColorProjection:"rgba( 169, 220, 195, 1)",downColorProjection:"rgba( 245, 166, 174, 1)",borderUpColorProjection:"rgba( 169, 220, 195, 1)",borderDownColorProjection:"rgba( 245, 166, 174, 1)",wickUpColor:"#26a69a",wickDownColor:"#ef5350",inputs:{source:"close",sources:"Close",boxSize:3,style:"ATR",atrLength:14,wicks:!0},inputInfo:{source:{name:"Source"},sources:{name:"Source"},boxSize:{name:"Box size"},style:{name:"Style"},atrLength:{name:"ATR length"},wicks:{name:"Wicks"}}},pbStyle:{upColor:"#26a69a",downColor:"#ef5350",borderUpColor:"#26a69a",borderDownColor:"#ef5350",upColorProjection:"rgba( 169, 220, 195, 1)",downColorProjection:"rgba( 245, 166, 174, 1)",borderUpColorProjection:"rgba( 169, 220, 195, 1)",borderDownColorProjection:"rgba( 245, 166, 174, 1)",inputs:{source:"close",lb:3},inputInfo:{source:{name:"Source"},lb:{name:"Number of line"}}},kagiStyle:{upColor:"#26a69a",downColor:"#ef5350",upColorProjection:"rgba( 169, 220, 195, 1)",downColorProjection:"rgba( 245, 166, 174, 1)",inputs:{source:"close",style:"ATR",atrLength:14,reversalAmount:1},inputInfo:{source:{name:"Source"},style:{name:"Style"},atrLength:{name:"ATR length"},
reversalAmount:{name:"Reversal amount"}}},pnfStyle:{upColor:"#26a69a",downColor:"#ef5350",upColorProjection:"rgba( 169, 220, 195, 1)",downColorProjection:"rgba( 245, 166, 174, 1)",inputs:{sources:"Close",reversalAmount:3,boxSize:1,style:"ATR",atrLength:14,oneStepBackBuilding:!1},inputInfo:{sources:{name:"Source"},boxSize:{name:"Box size"},reversalAmount:{name:"Reversal amount"},style:{name:"Style"},atrLength:{name:"ATR length"},oneStepBackBuilding:{name:"One step back building"}}},baselineStyle:{baselineColor:"rgba( 117, 134, 150, 1)",topFillColor1:"rgba( 38, 166, 154, 0.28)",topFillColor2:"rgba( 38, 166, 154, 0.05)",bottomFillColor1:"rgba( 239, 83, 80, 0.05)",bottomFillColor2:"rgba( 239, 83, 80, 0.28)",topLineColor:"rgba( 38, 166, 154, 1)",bottomLineColor:"rgba( 239, 83, 80, 1)",topLineWidth:2,bottomLineWidth:2,priceSource:"close",transparency:50,baseLevelPercentage:50},rangeStyle:{upColor:"#26a69a",downColor:"#ef5350",thinBars:!0,upColorProjection:"rgba( 169, 220, 195, 1)",downColorProjection:"rgba( 245, 166, 174, 1)",inputs:{range:10,phantomBars:!1},inputInfo:{range:{name:"Range"},phantomBars:{name:"Phantom bars"}}}},chartEventsSourceProperties:{visible:!0,futureOnly:!0,breaks:{color:"rgba(85, 85, 85, 1)",visible:!1,style:CanvasEx.LINESTYLE_DASHED,width:1}},tradingProperties:{showPositions:!0,positionPL:{visibility:!0,display:r.Money},showOrders:!0,showTPSL:!0,showExecutions:!0,showReverse:!0,horizontalAlignment:o.Right,extendLeft:!0,lineWidth:1,lineStyle:CanvasEx.LINESTYLE_SOLID},editorFontsList:["Verdana","Courier New","Times New Roman","Arial"],volumePaneSize:"large"},sessions:v,drawings:{magnet:!1,magnetMode:_.WeakMagnet,stayInDrawingMode:!1,drawOnAllCharts:!0},linetoolorder:{extendLeft:"inherit",lineLength:"inherit",lineColor:"rgba( 255, 0, 0, 1)",lineActiveBuyColor:"rgb(64,148,232)",lineInactiveBuyColor:"rgba(64,148,232,.5)",lineActiveSellColor:"rgb(231,86,86)",lineInactiveSellColor:"rgba(231,86,86,.5)",lineStyle:"inherit",lineWidth:"inherit",bodyBorderActiveBuyColor:"rgb(64,148,232)",bodyBorderInactiveBuyColor:"rgba(64,148,232,.5)",bodyBorderActiveSellColor:"rgb(231,86,86)",bodyBorderInactiveSellColor:"rgba(231,86,86,.5)",bodyBackgroundColor:"rgba( 255, 255, 255, 0.75)",bodyBackgroundTransparency:25,bodyTextInactiveLimitColor:"rgba(38,140,2,.5)",bodyTextActiveLimitColor:"rgb(38,140,2)",bodyTextInactiveStopColor:"rgba(231,86,86,.5)",bodyTextActiveStopColor:"rgb(231,86,86)",bodyTextInactiveBuyColor:"rgba(64,148,232,.5)",bodyTextActiveBuyColor:"rgb(64,148,232)",bodyTextInactiveSellColor:"rgba(231,86,86,.5)",bodyTextActiveSellColor:"rgb(231,86,86)",bodyFontFamily:"Verdana",bodyFontSize:9,bodyFontBold:!0,bodyFontItalic:!1,quantityBorderActiveBuyColor:"rgb(64,148,232)",quantityBorderInactiveBuyColor:"rgba(64,148,232,.5)",quantityBorderActiveSellColor:"rgb(231,86,86)",quantityBorderInactiveSellColor:"rgba(231,86,86,.5)",quantityBackgroundInactiveBuyColor:"rgba(64,148,232,.5)",quantityBackgroundActiveBuyColor:"rgb(64,148,232)",quantityBackgroundInactiveSellColor:"rgba(231,86,86,.5)",
quantityBackgroundActiveSellColor:"rgb(231,86,86)",quantityTextColor:"rgba( 255, 255, 255, 1)",quantityTextTransparency:0,quantityFontFamily:"Verdana",quantityFontSize:9,quantityFontBold:!0,quantityFontItalic:!1,cancelButtonBorderActiveBuyColor:"rgb(64,148,232)",cancelButtonBorderInactiveBuyColor:"rgba(64,148,232,.5)",cancelButtonBorderActiveSellColor:"rgb(231,86,86)",cancelButtonBorderInactiveSellColor:"rgba(231,86,86,.5)",cancelButtonBackgroundColor:"rgba( 255, 255, 255, 0.75)",cancelButtonBackgroundTransparency:25,cancelButtonIconActiveBuyColor:"rgb(64,148,232)",cancelButtonIconInactiveBuyColor:"rgba(64,148,232,.5)",cancelButtonIconActiveSellColor:"rgb(231,86,86)",cancelButtonIconInactiveSellColor:"rgba(231,86,86,.5)",tooltip:"",modifyTooltip:"",cancelTooltip:""},linetoolposition:{extendLeft:"inherit",lineLength:"inherit",lineBuyColor:"rgb(64,148,232)",lineSellColor:"rgb(231,86,86)",lineStyle:"inherit",lineWidth:"inherit",bodyBorderBuyColor:"rgb(64,148,232)",bodyBorderSellColor:"rgb(231,86,86)",bodyBackgroundColor:"rgba( 255, 255, 255, 0.75)",bodyBackgroundTransparency:25,bodyTextPositiveColor:"rgb(38,140,2)",bodyTextNeutralColor:"rgb(100,100,100)",bodyTextNegativeColor:"rgb(231,86,86)",bodyFontFamily:"Verdana",bodyFontSize:9,bodyFontBold:!0,bodyFontItalic:!1,quantityBorderBuyColor:"rgb(64,148,232)",quantityBorderSellColor:"rgb(231,86,86)",quantityBackgroundBuyColor:"rgb(64,148,232)",quantityBackgroundSellColor:"rgb(231,86,86)",quantityTextColor:"rgba( 255, 255, 255, 1)",quantityTextTransparency:0,quantityFontFamily:"Verdana",quantityFontSize:9,quantityFontBold:!0,quantityFontItalic:!1,reverseButtonBorderBuyColor:"rgb(64,148,232)",reverseButtonBorderSellColor:"rgb(231,86,86)",reverseButtonBackgroundColor:"rgba( 255, 255, 255, 0.75)",reverseButtonBackgroundTransparency:25,reverseButtonIconBuyColor:"rgb(64,148,232)",reverseButtonIconSellColor:"rgb(231,86,86)",closeButtonBorderBuyColor:"rgb(64,148,232)",closeButtonBorderSellColor:"rgb(231,86,86)",closeButtonBackgroundColor:"rgba( 255, 255, 255, 0.75)",closeButtonBackgroundTransparency:25,closeButtonIconBuyColor:"rgb(64,148,232)",closeButtonIconSellColor:"rgb(231,86,86)",tooltip:"",protectTooltip:"",closeTooltip:"",reverseTooltip:""},linetoolexecution:{direction:"buy",arrowHeight:8,arrowSpacing:1,arrowBuyColor:"#4094e8",arrowSellColor:"#e75656",text:"",textColor:"rgba( 0, 0, 0, 1)",textTransparency:0,fontFamily:"Verdana",fontSize:10,fontBold:!1,fontItalic:!1,tooltip:""},linetoolicon:{color:b,size:40,icon:61720,angle:.5*Math.PI,scale:1},linetoolimage:{transparency:0,cssWidth:0,cssHeight:0,angle:0},linetoolbezierquadro:{linecolor:b,linewidth:1,fillBackground:!1,backgroundColor:n(b,80),transparency:50,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!1,extendRight:!1,leftEnd:m.Normal,rightEnd:m.Normal},linetoolbeziercubic:{linecolor:"#00bcd4",linewidth:1,fillBackground:!1,backgroundColor:"rgba(0, 188, 212, 0.2)",transparency:50,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!1,extendRight:!1,leftEnd:m.Normal,rightEnd:m.Normal},linetooltrendline:{linecolor:b,linewidth:1,
linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!1,extendRight:!1,leftEnd:m.Normal,rightEnd:m.Normal,showLabel:!1,horzLabelsAlign:"center",vertLabelsAlign:"bottom",font:"Verdana",textcolor:b,fontsize:14,bold:!1,italic:!1,alwaysShowStats:!1,showMiddlePoint:!1,showPriceLabels:!1,showPriceRange:!1,showBarsRange:!1,showDateTimeRange:!1,showDistance:!1,showAngle:!1,statsPosition:g.Right},linetoolinfoline:{linecolor:b,linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!1,extendRight:!1,leftEnd:m.Normal,rightEnd:m.Normal,font:"Verdana",showLabel:!1,horzLabelsAlign:"center",vertLabelsAlign:"bottom",textcolor:b,fontsize:14,bold:!1,italic:!1,alwaysShowStats:!0,showMiddlePoint:!1,showPriceLabels:!1,showPriceRange:!0,showBarsRange:!0,showDateTimeRange:!0,showDistance:!0,showAngle:!0,statsPosition:g.Center},linetooltimecycles:{linecolor:"rgba(21, 153, 128, 1)",linewidth:1,fillBackground:!0,backgroundColor:"rgba(106, 168, 79, 0.5)",transparency:50,linestyle:CanvasEx.LINESTYLE_SOLID},linetoolsineline:{linecolor:"rgba( 21, 153, 128, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},linetooltrendangle:{linecolor:b,linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,font:"Verdana",textcolor:b,fontsize:12,bold:!1,italic:!1,alwaysShowStats:!1,showMiddlePoint:!1,showPriceLabels:!1,showPriceRange:!1,showBarsRange:!1,extendRight:!1,extendLeft:!1,statsPosition:g.Right},linetooldisjointangle:{linecolor:"rgba(0, 150, 136, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,fillBackground:!0,backgroundColor:"rgba(0, 150, 136, 0.2)",transparency:20,extendLeft:!1,extendRight:!1,leftEnd:m.Normal,rightEnd:m.Normal,font:"Verdana",textcolor:"rgba(0, 150, 136, 1)",fontsize:12,bold:!1,italic:!1,showPrices:!1,showPriceRange:!1,showDateTimeRange:!1,showBarsRange:!1},linetoolflatbottom:{linecolor:"rgba(171, 71, 188, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,fillBackground:!0,backgroundColor:"rgba(171, 71, 188, 0.2)",transparency:20,extendLeft:!1,extendRight:!1,leftEnd:m.Normal,rightEnd:m.Normal,font:"Verdana",textcolor:"rgba(171, 71, 188, 1)",fontsize:12,bold:!1,italic:!1,showPrices:!1,showPriceRange:!1,showDateTimeRange:!1,showBarsRange:!1},linetoolfibspiral:{counterclockwise:!1,linecolor:"rgba(0, 150, 136, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},linetooldaterange:{linecolor:b,linewidth:1,font:y,textcolor:"rgba( 255, 255, 255, 1)",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:n(b,10),fillBackground:!0,backgroundColor:n(b,80),backgroundTransparency:60,drawBorder:!1,borderColor:n(b,10),extendTop:!1,extendBottom:!1,showLabel:!0},linetoolpricerange:{linecolor:b,linewidth:1,font:y,textcolor:"rgba( 255, 255, 255, 1)",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:n(b,10),fillBackground:!0,backgroundColor:n(b,80),backgroundTransparency:60,drawBorder:!1,borderColor:n(b,10),extendLeft:!1,extendRight:!1,showLabel:!0},linetooldateandpricerange:{linecolor:b,linewidth:1,font:y,textcolor:"rgba( 255, 255, 255, 1)",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:n(b,10),fillBackground:!0,backgroundColor:n(b,80),
backgroundTransparency:60,borderWidth:1,drawBorder:!1,borderColor:b,showLabel:!0},linetoolriskrewardshort:{linecolor:"rgba(120, 123, 134, 1)",linewidth:1,font:"Verdana",textcolor:"rgba(255, 255, 255, 1)",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:"rgba( 88, 88, 88, 1)",fillBackground:!0,stopBackground:"rgba(244, 67, 54, 0.2)",profitBackground:"rgba(0, 150, 136, 0.2)",stopBackgroundTransparency:80,profitBackgroundTransparency:80,drawBorder:!1,borderColor:"rgba( 102, 123, 139, 1)",compact:!1,riskDisplayMode:"percents",accountSize:1e3,lotSize:1,risk:25,alwaysShowStats:!1,showPriceLabels:!0},linetoolriskrewardlong:{linecolor:"rgba(120, 123, 134, 1)",linewidth:1,font:"Verdana",textcolor:"rgba(255, 255, 255, 1)",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:"rgba( 88, 88, 88, 1)",fillBackground:!0,stopBackground:"rgba(244, 67, 54, 0.2)",profitBackground:"rgba(0, 150, 136, 0.2)",stopBackgroundTransparency:80,profitBackgroundTransparency:80,drawBorder:!1,borderColor:"rgba( 102, 123, 139, 1)",compact:!1,riskDisplayMode:"percents",accountSize:1e3,lotSize:1,risk:25,alwaysShowStats:!1,showPriceLabels:!0},linetoolarrow:{linecolor:b,linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!1,extendRight:!1,leftEnd:m.Normal,rightEnd:m.Arrow,font:"Verdana",showLabel:!1,horzLabelsAlign:"center",vertLabelsAlign:"bottom",textcolor:b,fontsize:14,bold:!1,italic:!1,alwaysShowStats:!1,showMiddlePoint:!1,showPriceLabels:!1,showPriceRange:!1,showBarsRange:!1,showDateTimeRange:!1,showDistance:!1,showAngle:!1,statsPosition:g.Right},linetoolray:{linecolor:b,linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!1,extendRight:!0,leftEnd:m.Normal,rightEnd:m.Normal,font:"Verdana",showLabel:!1,horzLabelsAlign:"center",vertLabelsAlign:"bottom",textcolor:b,fontsize:14,bold:!1,italic:!1,alwaysShowStats:!1,showMiddlePoint:!1,showPriceLabels:!1,showPriceRange:!1,showBarsRange:!1,showDateTimeRange:!1,showDistance:!1,showAngle:!1,statsPosition:g.Right},linetoolextended:{linecolor:b,linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!0,extendRight:!0,leftEnd:m.Normal,rightEnd:m.Normal,font:"Verdana",showLabel:!1,horzLabelsAlign:"center",vertLabelsAlign:"bottom",textcolor:b,fontsize:14,bold:!1,italic:!1,alwaysShowStats:!1,showMiddlePoint:!1,showPriceLabels:!1,showPriceRange:!1,showBarsRange:!1,showDateTimeRange:!1,showDistance:!1,showAngle:!1,statsPosition:g.Right},linetoolhorzline:{linecolor:b,linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,showPrice:!0,showLabel:!1,font:"Verdana",textcolor:b,fontsize:12,bold:!1,italic:!1,horzLabelsAlign:"center",vertLabelsAlign:"top"},linetoolhorzray:{linecolor:b,linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,showPrice:!0,showLabel:!1,font:"Verdana",textcolor:b,fontsize:12,bold:!1,italic:!1,horzLabelsAlign:"center",vertLabelsAlign:"top"},linetoolvertline:{linecolor:b,linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendLine:!0,showTime:!0,showLabel:!1,horzLabelsAlign:"right",vertLabelsAlign:"top",font:"Verdana",textcolor:b,textOrientation:"vertical",fontsize:14,bold:!1,italic:!1},
linetoolcrossline:{linecolor:b,linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,showPrice:!0,showTime:!0},linetoolcirclelines:{trendline:{visible:!0,color:"rgba( 128, 128, 128, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},linecolor:"rgba( 128, 204, 219, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},linetoolfibtimezone:{horzLabelsAlign:"right",vertLabelsAlign:"bottom",baselinecolor:"rgba( 128, 128, 128, 1)",linecolor:"rgba( 0, 85, 219, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,showLabels:!0,font:y,fillBackground:!1,transparency:80,trendline:{visible:!0,color:"rgba( 128, 128, 128, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},level1:s(0,"rgba(120, 123, 134, 1)",!0),level2:s(1,b,!0),level3:s(2,b,!0),level4:s(3,b,!0),level5:s(5,b,!0),level6:s(8,b,!0),level7:s(13,b,!0),level8:s(21,b,!0),level9:s(34,b,!0),level10:s(55,b,!0),level11:s(89,b,!0)},linetooltext:{color:b,font:"Verdana",fontsize:14,fillBackground:!1,backgroundColor:"rgba( 91, 133, 191, 0.3)",backgroundTransparency:70,drawBorder:!1,borderColor:"rgba( 102, 123, 139, 1)",bold:!1,italic:!1,fixedSize:!0,wordWrap:!1,wordWrapWidth:200},linetooltextabsolute:{color:b,font:"Verdana",fontsize:14,fillBackground:!1,backgroundColor:"rgba( 155, 190, 213, 0.3)",backgroundTransparency:70,drawBorder:!1,borderColor:"rgba( 102, 123, 139, 1)",bold:!1,italic:!1,fixedSize:!1,wordWrap:!1,wordWrapWidth:200},linetoolballoon:{color:"#ffffff",backgroundColor:"rgba(156, 39, 176, 0.7)",borderColor:"rgba(156, 39, 176, 0.0)",fontsize:14,transparency:30},linetoolbrush:{linecolor:"#00bcd4",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,smooth:5,fillBackground:!1,backgroundColor:"rgba(0, 188, 212, 0.5)",transparency:50,leftEnd:m.Normal,rightEnd:m.Normal},linetoolhighlighter:{linecolor:"rgba(236, 64, 122, 0.15)",smooth:5,transparency:85},linetoolpolyline:{linecolor:"#7e57c2",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,fillBackground:!0,backgroundColor:"rgba(126, 87, 194, 0.2)",transparency:50,filled:!1},linetoolsignpost:{itemType:p.Emoji,emoji:"🙂",showImage:!1,plateColor:b,fontSize:12,bold:!1,italic:!1},linetoolpath:{lineColor:b,lineWidth:2,lineStyle:CanvasEx.LINESTYLE_SOLID,leftEnd:m.Normal,rightEnd:m.Arrow},linetoolarrowmarkleft:{color:b,arrowColor:b,fontsize:14,font:y,bold:!1,italic:!1,showLabel:!0},linetoolarrowmarkup:{color:"#009688",arrowColor:"#009688",fontsize:14,font:y,bold:!1,italic:!1,showLabel:!0},linetoolarrowmarkright:{color:b,arrowColor:b,fontsize:14,font:y,bold:!1,italic:!1,showLabel:!0},linetoolarrowmarkdown:{color:"#E53935",arrowColor:"#E53935",fontsize:14,font:y,bold:!1,italic:!1,showLabel:!0},linetoolflagmark:{flagColor:b},linetoolnote:{markerColor:b,textColor:"#ffffff",backgroundColor:n(b,30),backgroundTransparency:0,borderColor:b,font:"Verdana",fontSize:14,bold:!1,italic:!1,fixedSize:!0},linetoolnoteabsolute:{markerColor:b,textColor:"#ffffff",backgroundColor:n(b,30),backgroundTransparency:0,borderColor:b,font:"Verdana",fontSize:14,bold:!1,italic:!1,fixedSize:!0},linetoolpricelabel:{color:"#ffffff",backgroundColor:b,borderColor:b,
fontWeight:"bold",fontsize:14,font:y,transparency:0},linetoolpricenote:{showLabel:!1,horzLabelsAlign:"center",vertLabelsAlign:"bottom",textColor:b,fontSize:14,bold:!1,italic:!1,lineColor:b,priceLabelBackgroundColor:b,priceLabelBorderColor:b,priceLabelTextColor:"#ffffff",priceLabelFontSize:12,priceLabelBold:!1,priceLabelItalic:!1},linetoolarrowmarker:{backgroundColor:w,textColor:w,font:y,bold:!0,italic:!1,fontsize:16,showLabel:!0},linetoolrectangle:{color:"#9c27b0",fillBackground:!0,backgroundColor:"rgba(156, 39, 176, 0.2)",linewidth:1,transparency:50,showLabel:!1,horzLabelsAlign:"left",vertLabelsAlign:"bottom",textColor:"#9c27b0",fontSize:14,bold:!1,italic:!1,extendLeft:!1,extendRight:!1},linetoolrotatedrectangle:{color:"#4caf50",fillBackground:!0,backgroundColor:"rgba(76, 175, 80, 0.2)",transparency:50,linewidth:1},linetoolellipse:{color:"#e91e63",fillBackground:!0,backgroundColor:"rgba(233, 30, 99, 0.2)",transparency:50,linewidth:1},linetoolarc:{color:"#ab47bc",fillBackground:!0,backgroundColor:"rgba(171, 71, 188, 0.2)",transparency:50,linewidth:1},linetoolprediction:{linecolor:b,linewidth:1,sourceBackColor:b,sourceTextColor:"rgba(255, 255, 255, 1)",sourceStrokeColor:b,targetStrokeColor:b,targetBackColor:b,targetTextColor:"rgba(255, 255, 255, 1)",successBackground:"rgba(76, 175, 80, 1)",successTextColor:"rgba(255, 255, 255, 1)",failureBackground:"rgba(244, 67, 54, 1)",failureTextColor:"rgba(255, 255, 255, 1)",intermediateBackColor:"rgba(234, 210, 137, 1)",intermediateTextColor:"rgba(109, 77, 34, 1)",transparency:10,centersColor:"rgba( 32, 32, 32, 1)"},linetooltriangle:{color:"#f57c00",fillBackground:!0,backgroundColor:"rgba(245, 124, 0, 0.2)",transparency:50,linewidth:1},linetoolcallout:{color:"#ffffff",backgroundColor:"rgba(0, 151, 167, 0.7)",transparency:50,linewidth:1,fontsize:14,font:"Verdana",bordercolor:"rgba(0, 151, 167, 1)",bold:!1,italic:!1,wordWrap:!1,wordWrapWidth:200},linetoolparallelchannel:{linecolor:b,linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendLeft:!1,extendRight:!1,fillBackground:!0,backgroundColor:n(b,80),transparency:20,showMidline:!0,midlinecolor:b,midlinewidth:1,midlinestyle:CanvasEx.LINESTYLE_DASHED},linetoolelliottimpulse:{degree:7,showWave:!0,color:"rgba( 61, 133, 198, 1)",linewidth:1},linetoolelliotttriangle:{degree:7,showWave:!0,color:"rgba( 255, 152, 0, 1)",linewidth:1},linetoolelliotttriplecombo:{degree:7,showWave:!0,color:"rgba( 106, 168, 79, 1)",linewidth:1},linetoolelliottcorrection:{degree:7,showWave:!0,color:"rgba( 61, 133, 198, 1)",linewidth:1},linetoolelliottdoublecombo:{degree:7,showWave:!0,color:"rgba( 106, 168, 79, 1)",linewidth:1},linetoolbarspattern:{color:b,mode:c.Bars,mirrored:!1,flipped:!1},linetoolghostfeed:{averageHL:20,variance:50,candleStyle:{upColor:"rgba(178, 223, 219, 1)",downColor:"rgba(239, 154, 154, 1)",drawWick:!0,drawBorder:!0,borderColor:"#378658",borderUpColor:"rgba(0, 150, 136, 1)",borderDownColor:"rgba(244, 67, 54, 1)",wickColor:"rgba(120, 123, 134, 1)"},transparency:50},study:{inputs:{},styles:{},palettes:{},bands:{},area:{},graphics:{},
showInDataWindow:!0,visible:!0,showStudyArguments:!0,precision:"default"},linetoolpitchfork:{fillBackground:!0,transparency:80,style:l.Original,median:{visible:!0,color:"rgba(244, 67, 54, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},extendLines:!1,level0:s(.25,"rgba(255, 183, 77, 1)",!1),level1:s(.382,"rgba(129, 199, 132, 1)",!1),level2:s(.5,"rgba(76, 175, 80, 1)",!0),level3:s(.618,"rgba(0, 150, 136, 1)",!1),level4:s(.75,"rgba(100, 181, 246, 1)",!1),level5:s(1,b,!0),level6:s(1.5,"rgba(156, 39, 176, 1)",!1),level7:s(1.75,"rgba(233, 30, 99, 1)",!1),level8:s(2,"rgba(229, 115, 115, 1)",!1)},linetoolpitchfan:{fillBackground:!0,transparency:80,median:{visible:!0,color:"rgba(244, 67, 54, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},level0:s(.25,"rgba(255, 183, 77, 1)",!1),level1:s(.382,"rgba(129, 199, 132, 1)",!1),level2:s(.5,"rgba(76, 175, 80, 1)",!0),level3:s(.618,"rgba(0, 150, 136, 1)",!1),level4:s(.75,"rgba(100, 181, 246, 1)",!1),level5:s(1,b,!0),level6:s(1.5,"rgba(156, 39, 176, 1)",!1),level7:s(1.75,"rgba(233, 30, 99, 1)",!1),level8:s(2,"rgba(229, 115, 115, 1)",!1)},linetoolgannfan:{showLabels:!0,font:"Verdana",fillBackground:!0,transparency:80,level1:C(1,8,"rgba(255, 183, 77, 1)",!0),level2:C(1,4,"rgba(129, 199, 132, 1)",!0),level3:C(1,3,"rgba(76, 175, 80, 1)",!0),level4:C(1,2,"rgba(0, 150, 136, 1)",!0),level5:C(1,1,"rgba(100, 181, 246, 1)",!0),level6:C(2,1,b,!0),level7:C(3,1,"rgba(156, 39, 176, 1)",!0),level8:C(4,1,"rgba(233, 30, 99, 1)",!0),level9:C(8,1,"rgba(229, 115, 115, 1)",!0)},linetoolganncomplex:{fillBackground:!1,arcsBackground:{fillBackground:!0,transparency:80},reverse:!1,scaleRatio:"",showLabels:!0,labelsStyle:{font:y,fontSize:12,bold:!1,italic:!1},levels:[S("rgba(120, 123, 134, 1)",!0,1),S("rgba(255, 152, 0, 1)",!0,1),S("rgba(129, 199, 132, 1)",!0,1),S("rgba(76, 175, 80, 1)",!0,1),S("rgba(0, 150, 136, 1)",!0,1),S("rgba(120, 123, 134, 1)",!0,1)],fanlines:[P("rgba(179, 157, 219, 1)",!1,1,8,1),P("rgba(244, 67, 54, 1)",!1,1,5,1),P("rgba(120, 123, 134, 1)",!1,1,4,1),P("rgba(255, 152, 0, 1)",!1,1,3,1),P("rgba(129, 199, 132, 1)",!0,1,2,1),P("rgba(76, 175, 80, 1)",!0,1,1,1),P("rgba(0, 150, 136, 1)",!0,1,1,2),P("rgba(0, 150, 136, 1)",!1,1,1,3),P(b,!1,1,1,4),P("rgba(149, 117, 205, 1)",!1,1,1,5),P("rgba(179, 157, 219, 1)",!1,1,1,8)],arcs:[P("rgba(255, 152, 0, 1)",!0,1,1,0),P("rgba(255, 152, 0, 1)",!0,1,1,1),P("rgba(255, 152, 0, 1)",!0,1,1.5,0),P("rgba(129, 199, 132, 1)",!0,1,2,0),P("rgba(129, 199, 132, 1)",!0,1,2,1),P("rgba(76, 175, 80, 1)",!0,1,3,0),P("rgba(76, 175, 80, 1)",!0,1,3,1),P("rgba(0, 150, 136, 1)",!0,1,4,0),P("rgba(0, 150, 136, 1)",!0,1,4,1),P(b,!0,1,5,0),P(b,!0,1,5,1)]},linetoolgannfixed:{fillBackground:!1,arcsBackground:{fillBackground:!0,transparency:80},reverse:!1,levels:[S("rgba(120, 123, 134, 1)",!0,1),S("rgba(255, 152, 0, 1)",!0,1),S("rgba(129, 199, 132, 1)",!0,1),S("rgba(76, 175, 80, 1)",!0,1),S("rgba(0, 150, 136, 1)",!0,1),S("rgba(120, 123, 134, 1)",!0,1)],
fanlines:[P("rgba(179, 157, 219, 1)",!1,1,8,1),P("rgba(244, 67, 54, 1)",!1,1,5,1),P("rgba(120, 123, 134, 1)",!1,1,4,1),P("rgba(255, 152, 0, 1)",!1,1,3,1),P("rgba(129, 199, 132, 1)",!0,1,2,1),P("rgba(76, 175, 80, 1)",!0,1,1,1),P("rgba(0, 150, 136, 1)",!0,1,1,2),P("rgba(0, 150, 136, 1)",!1,1,1,3),P(b,!1,1,1,4),P("rgba(149, 117, 205, 1)",!1,1,1,5),P("rgba(179, 157, 219, 1)",!1,1,1,8)],arcs:[P("rgba(255, 152, 0, 1)",!0,1,1,0),P("rgba(255, 152, 0, 1)",!0,1,1,1),P("rgba(255, 152, 0, 1)",!0,1,1.5,0),P("rgba(129, 199, 132, 1)",!0,1,2,0),P("rgba(129, 199, 132, 1)",!0,1,2,1),P("rgba(76, 175, 80, 1)",!0,1,3,0),P("rgba(76, 175, 80, 1)",!0,1,3,1),P("rgba(0, 150, 136, 1)",!0,1,4,0),P("rgba(0, 150, 136, 1)",!0,1,4,1),P(b,!0,1,5,0),P(b,!0,1,5,1)]},linetoolgannsquare:{color:"rgba( 21, 56, 153, 0.8)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,font:y,showTopLabels:!0,showBottomLabels:!0,showLeftLabels:!0,showRightLabels:!0,fillHorzBackground:!0,horzTransparency:80,fillVertBackground:!0,vertTransparency:80,reverse:!1,fans:t("rgba(149, 152, 161, 1)",!1),hlevel1:i(0,"rgba(120, 123, 134, 1)",!0),hlevel2:i(.25,"rgba(245, 124, 0, 1)",!0),hlevel3:i(.382,"rgba(129, 199, 132, 1)",!0),hlevel4:i(.5,"rgba(76, 175, 80, 1)",!0),hlevel5:i(.618,"rgba(0, 150, 136, 1)",!0),hlevel6:i(.75,b,!0),hlevel7:i(1,"rgba(120, 123, 134, 1)",!0),vlevel1:i(0,"rgba(120, 123, 134, 1)",!0),vlevel2:i(.25,"rgba(245, 124, 0, 1)",!0),vlevel3:i(.382,"rgba(129, 199, 132, 1)",!0),vlevel4:i(.5,"rgba(76, 175, 80, 1)",!0),vlevel5:i(.618,"rgba(0, 150, 136, 1)",!0),vlevel6:i(.75,b,!0),vlevel7:i(1,"rgba(120, 123, 134, 1)",!0)},linetoolfibspeedresistancefan:{fillBackground:!0,transparency:80,grid:{color:"rgba( 21, 56, 153, 0.8)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,visible:!0},linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,font:y,showTopLabels:!0,showBottomLabels:!0,showLeftLabels:!0,showRightLabels:!0,reverse:!1,hlevel1:i(0,"rgba(120, 123, 134, 1)",!0),hlevel2:i(.25,"rgba(245, 124, 0, 1)",!0),hlevel3:i(.382,"rgba(129, 199, 132, 1)",!0),hlevel4:i(.5,"rgba(76, 175, 80, 1)",!0),hlevel5:i(.618,"rgba(0, 150, 136, 1)",!0),hlevel6:i(.75,b,!0),hlevel7:i(1,"rgba(120, 123, 134, 1)",!0),vlevel1:i(0,"rgba(120, 123, 134, 1)",!0),vlevel2:i(.25,"rgba(245, 124, 0, 1)",!0),vlevel3:i(.382,"rgba(129, 199, 132, 1)",!0),vlevel4:i(.5,"rgba(76, 175, 80, 1)",!0),vlevel5:i(.618,"rgba(0, 150, 136, 1)",!0),vlevel6:i(.75,b,!0),vlevel7:i(1,"rgba(120, 123, 134, 1)",!0)},linetoolfibretracement:{showCoeffs:!0,showPrices:!0,font:y,fillBackground:!0,transparency:80,extendLines:!1,extendLinesLeft:!1,horzLabelsAlign:"left",vertLabelsAlign:"bottom",reverse:!1,coeffsAsPercents:!1,fibLevelsBasedOnLogScale:!1,trendline:{visible:!0,color:"rgba(120, 123, 134, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},levelsStyle:{linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},level1:i(0,"rgba(120, 123, 134, 1)",!0),level2:i(.236,"rgba(244, 67, 54, 1)",!0),level3:i(.382,"rgba(129, 199, 132, 1)",!0),level4:i(.5,"rgba(76, 175, 80, 1)",!0),level5:i(.618,"rgba(0, 150, 136, 1)",!0),
level6:i(.786,"rgba(100, 181, 246, 1)",!0),level7:i(1,"rgba(120, 123, 134, 1)",!0),level8:i(1.618,b,!0),level9:i(2.618,"rgba(244, 67, 54, 1)",!0),level10:i(3.618,"rgba(156, 39, 176, 1)",!0),level11:i(4.236,"rgba(233, 30, 99, 1)",!0),level12:i(1.272,"rgba(129, 199, 132, 1)",!1),level13:i(1.414,"rgba(244, 67, 54, 1)",!1),level16:i(2,"rgba(0, 150, 136, 1)",!1),level14:i(2.272,"rgba(129, 199, 132, 1)",!1),level15:i(2.414,"rgba(76, 175, 80, 1)",!1),level17:i(3,"rgba(100, 181, 246, 1)",!1),level18:i(3.272,"rgba(120, 123, 134, 1)",!1),level19:i(3.414,b,!1),level20:i(4,"rgba( 204, 40, 40, 1)",!1),level21:i(4.272,"rgba(156, 39, 176, 1)",!1),level22:i(4.414,"rgba(233, 30, 99, 1)",!1),level23:i(4.618,"rgba(129, 199, 132, 1)",!1),level24:i(4.764,"rgba(0, 150, 136, 1)",!1)},linetoolfibchannel:{showCoeffs:!0,showPrices:!0,font:y,fillBackground:!0,transparency:80,extendLeft:!1,extendRight:!1,horzLabelsAlign:"left",vertLabelsAlign:"middle",coeffsAsPercents:!1,levelsStyle:{linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},level1:i(0,"rgba(120, 123, 134, 1)",!0),level2:i(.236,"rgba(244, 67, 54, 1)",!0),level3:i(.382,"rgba(129, 199, 132, 1)",!0),level4:i(.5,"rgba(76, 175, 80, 1)",!0),level5:i(.618,"rgba(0, 150, 136, 1)",!0),level6:i(.786,"rgba(100, 181, 246, 1)",!0),level7:i(1,"rgba(120, 123, 134, 1)",!0),level8:i(1.618,b,!0),level9:i(2.618,"rgba(244, 67, 54, 1)",!0),level10:i(3.618,"rgba(156, 39, 176, 1)",!0),level11:i(4.236,"rgba(233, 30, 99, 1)",!0),level12:i(1.272,"rgba(129, 199, 132, 1)",!1),level13:i(1.414,"rgba(244, 67, 54, 1)",!1),level16:i(2,"rgba(0, 150, 136, 1)",!1),level14:i(2.272,"rgba(129, 199, 132, 1)",!1),level15:i(2.414,"rgba(76, 175, 80, 1)",!1),level17:i(3,"rgba(100, 181, 246, 1)",!1),level18:i(3.272,"rgba(120, 123, 134, 1)",!1),level19:i(3.414,b,!1),level20:i(4,"rgba( 204, 40, 40, 1)",!1),level21:i(4.272,"rgba(156, 39, 176, 1)",!1),level22:i(4.414,"rgba(233, 30, 99, 1)",!1),level23:i(4.618,"rgba(129, 199, 132, 1)",!1),level24:i(4.764,"rgba(0, 150, 136, 1)",!1)},linetoolprojection:{showCoeffs:!0,font:"Verdana",fillBackground:!0,transparency:80,color1:n(b,80),color2:"rgba(156, 39, 176, 0.2)",linewidth:1,trendline:{visible:!0,color:"rgba(149, 152, 161, 1)",linestyle:CanvasEx.LINESTYLE_SOLID},level1:s(1,"rgba( 128, 128, 128, 1)",!0)},linetool5pointspattern:{color:b,textcolor:"rgba( 255, 255, 255, 1)",fillBackground:!0,backgroundColor:b,font:"Verdana",fontsize:12,bold:!1,italic:!1,transparency:85,linewidth:1},linetoolcypherpattern:{color:b,textcolor:"#FFFFFF",fillBackground:!0,backgroundColor:b,font:"Verdana",fontsize:12,bold:!1,italic:!1,transparency:85,linewidth:1},linetooltrianglepattern:{color:"#673AB7",textcolor:"#FFFFFF",fillBackground:!0,backgroundColor:"#673AB7",font:"Verdana",fontsize:12,bold:!1,italic:!1,transparency:85,linewidth:1},linetoolabcd:{color:"#009688",textcolor:"rgba( 255, 255, 255, 1)",font:"Verdana",fontsize:12,bold:!1,italic:!1,linewidth:1},linetoolthreedrivers:{color:"#673AB7",textcolor:"rgba( 255, 255, 255, 1)",fillBackground:!0,backgroundColor:"rgba( 149, 40, 204, 0.5)",font:"Verdana",
fontsize:12,bold:!1,italic:!1,transparency:50,linewidth:1},linetoolheadandshoulders:{color:"#009688",textcolor:"rgba( 255, 255, 255, 1)",fillBackground:!0,backgroundColor:"#009688",font:"Verdana",fontsize:12,bold:!1,italic:!1,transparency:85,linewidth:1},linetoolfibwedge:{showCoeffs:!0,font:y,fillBackground:!0,transparency:80,trendline:{visible:!0,color:"rgba( 128, 128, 128, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},level1:s(.236,"rgba(244, 67, 54, 1)",!0),level2:s(.382,"rgba(129, 199, 132, 1)",!0),level3:s(.5,"rgba(76, 175, 80, 1)",!0),level4:s(.618,"rgba(0, 150, 136, 1)",!0),level5:s(.786,"rgba(100, 181, 246, 1)",!0),level6:s(1,"rgba(120, 123, 134, 1)",!0),level7:s(1.618,b,!1),level8:s(2.618,"rgba(244, 67, 54, 1)",!1),level9:s(3.618,"rgba(103, 58, 183, 1)",!1),level10:s(4.236,"rgba(233, 30, 99, 1)",!1),level11:s(4.618,"rgba(233, 30, 99, 1)",!1)},linetoolfibcircles:{showCoeffs:!0,font:y,fillBackground:!0,transparency:80,coeffsAsPercents:!1,trendline:{visible:!0,color:"rgba(120, 123, 134, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},level1:s(.236,"rgba(244, 67, 54, 1)",!0),level2:s(.382,"rgba(129, 199, 132, 1)",!0),level3:s(.5,"rgba(76, 175, 80, 1)",!0),level4:s(.618,"rgba(0, 150, 136, 1)",!0),level5:s(.786,"rgba(100, 181, 246, 1)",!0),level6:s(1,"rgba(120, 123, 134, 1)",!0),level7:s(1.618,b,!0),level8:s(2.618,"rgba(244, 67, 54, 1)",!0),level9:s(3.618,"rgba(103, 58, 183, 1)",!0),level10:s(4.236,"rgba(233, 30, 99, 1)",!0),level11:s(4.618,"rgba(233, 30, 99, 1)",!0)},linetoolfibspeedresistancearcs:{showCoeffs:!0,font:y,fillBackground:!0,transparency:80,fullCircles:!1,trendline:{visible:!0,color:"rgba(120, 123, 134, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},level1:s(.236,"rgba(244, 67, 54, 1)",!0),level2:s(.382,"rgba(129, 199, 132, 1)",!0),level3:s(.5,"rgba(76, 175, 80, 1)",!0),level4:s(.618,"rgba(0, 150, 136, 1)",!0),level5:s(.786,"rgba(100, 181, 246, 1)",!0),level6:s(1,"rgba(120, 123, 134, 1)",!0),level7:s(1.618,b,!0),level8:s(2.618,"rgba(244, 67, 54, 1)",!0),level9:s(3.618,"rgba(103, 58, 183, 1)",!0),level10:s(4.236,"rgba(233, 30, 99, 1)",!0),level11:s(4.618,"rgba(233, 30, 99, 1)",!0)},linetooltrendbasedfibextension:{showCoeffs:!0,showPrices:!0,font:y,fillBackground:!0,transparency:80,extendLines:!1,extendLinesLeft:!1,horzLabelsAlign:"left",vertLabelsAlign:"bottom",reverse:!1,coeffsAsPercents:!1,fibLevelsBasedOnLogScale:!1,trendline:{visible:!0,color:"rgba(120, 123, 134, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},levelsStyle:{linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},level1:i(0,"rgba(120, 123, 134, 1)",!0),level2:i(.236,"rgba(244, 67, 54, 1)",!0),level3:i(.382,"rgba(129, 199, 132, 1)",!0),level4:i(.5,"rgba(76, 175, 80, 1)",!0),level5:i(.618,"rgba(0, 150, 136, 1)",!0),level6:i(.786,"rgba(100, 181, 246, 1)",!0),level7:i(1,"rgba(120, 123, 134, 1)",!0),level8:i(1.618,b,!0),level9:i(2.618,"rgba(244, 67, 54, 1)",!0),level10:i(3.618,"rgba(156, 39, 176, 1)",!0),level11:i(4.236,"rgba(233, 30, 99, 1)",!0),level12:i(1.272,"rgba(129, 199, 132, 1)",!1),
level13:i(1.414,"rgba(244, 67, 54, 1)",!1),level16:i(2,"rgba(0, 150, 136, 1)",!1),level14:i(2.272,"rgba(129, 199, 132, 1)",!1),level15:i(2.414,"rgba(76, 175, 80, 1)",!1),level17:i(3,"rgba(100, 181, 246, 1)",!1),level18:i(3.272,"rgba(120, 123, 134, 1)",!1),level19:i(3.414,b,!1),level20:i(4,"rgba( 204, 40, 40, 1)",!1),level21:i(4.272,"rgba(156, 39, 176, 1)",!1),level22:i(4.414,"rgba(233, 30, 99, 1)",!1),level23:i(4.618,"rgba(129, 199, 132, 1)",!1),level24:i(4.764,"rgba(0, 150, 136, 1)",!1)},linetooltrendbasedfibtime:{showCoeffs:!0,font:"Verdana",fillBackground:!0,transparency:80,horzLabelsAlign:"right",vertLabelsAlign:"bottom",trendline:{visible:!0,color:"rgba(120, 123, 134, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED},level1:s(0,"rgba(120, 123, 134, 1)",!0),level2:s(.382,"rgba(244, 67, 54, 1)",!0),level3:s(.5,"rgba(129, 199, 132, 1)",!1),level4:s(.618,"rgba(76, 175, 80, 1)",!0),level5:s(1,"rgba(0, 150, 136, 1)",!0),level6:s(1.382,"rgba(100, 181, 246, 1)",!0),level7:s(1.618,"rgba(120, 123, 134, 1)",!0),level8:s(2,b,!0),level9:s(2.382,"rgba(244, 67, 54, 1)",!0),level10:s(2.618,"rgba(156, 39, 176, 1)",!0),level11:s(3,"rgba(233, 30, 99, 1)",!0)},linetoolschiffpitchfork:{fillBackground:!0,transparency:80,style:l.Schiff,median:{visible:!0,color:"rgba(244, 67, 54, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},extendLines:!1,level0:s(.25,"rgba(255, 183, 77, 1)",!1),level1:s(.382,"rgba(129, 199, 132, 1)",!1),level2:s(.5,"rgba(76, 175, 80, 1)",!0),level3:s(.618,"rgba(0, 150, 136, 1)",!1),level4:s(.75,"rgba(100, 181, 246, 1)",!1),level5:s(1,b,!0),level6:s(1.5,"rgba(156, 39, 176, 1)",!1),level7:s(1.75,"rgba(233, 30, 99, 1)",!1),level8:s(2,"rgba(229, 115, 115, 1)",!1)},linetoolschiffpitchfork2:{fillBackground:!0,transparency:80,style:l.Schiff2,median:{visible:!0,color:"rgba(244, 67, 54, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},extendLines:!1,level0:s(.25,"rgba(255, 183, 77, 1)",!1),level1:s(.382,"rgba(129, 199, 132, 1)",!1),level2:s(.5,"rgba(76, 175, 80, 1)",!0),level3:s(.618,"rgba(0, 150, 136, 1)",!1),level4:s(.75,"rgba(100, 181, 246, 1)",!1),level5:s(1,b,!0),level6:s(1.5,"rgba(156, 39, 176, 1)",!1),level7:s(1.75,"rgba(233, 30, 99, 1)",!1),level8:s(2,"rgba(229, 115, 115, 1)",!1)},linetoolinsidepitchfork:{fillBackground:!0,transparency:80,style:l.Inside,median:{visible:!0,color:"rgba(244, 67, 54, 1)",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID},extendLines:!1,level0:s(.25,"rgba(255, 183, 77, 1)",!1),level1:s(.382,"rgba(129, 199, 132, 1)",!1),level2:s(.5,"rgba(76, 175, 80, 1)",!0),level3:s(.618,"rgba(0, 150, 136, 1)",!1),level4:s(.75,"rgba(100, 181, 246, 1)",!1),level5:s(1,b,!0),level6:s(1.5,"rgba(156, 39, 176, 1)",!1),level7:s(1.75,"rgba(233, 30, 99, 1)",!1),level8:s(2,"rgba(229, 115, 115, 1)",!1)},linetoolregressiontrend:{linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,styles:{upLine:{visible:!0,color:n(b,70),linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},downLine:{visible:!0,color:n(b,70),linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},baseLine:{visible:!0,color:"rgba(244, 67, 54, 0.3)",
linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},extendLines:!1,showPearsons:!0,transparency:70}}},T(TradingView.defaultProperties.chartproperties),x()}if(void 0===TradingView.defaultProperties["study_MA@tv-basicstudies"]&&(TradingView.defaultProperties["study_MA@tv-basicstudies"]={description:"Moving Average",shortDescription:"MA",inputs:{length:9,source:"close"},styles:{MovAvg:{visible:!0,color:b,linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:u.Line,histogramBase:0,title:"MA"}}}),void 0===TradingView.defaultProperties["study_PivotPointsHighLow@tv-basicstudies"]&&(TradingView.defaultProperties["study_PivotPointsHighLow@tv-basicstudies"]={font:"Arial",fontsize:10,borderColor:b,backColor:"#E3EFFD",textColor:"#131722"}),void 0===TradingView.defaultProperties["study_PivotPointsStandard@tv-basicstudies"]){TradingView.defaultProperties["study_PivotPointsStandard@tv-basicstudies"]={_hardCodedDefaultsVersion:1,font:"Arial",fontsize:11,levelsStyle:{showLabels:!0,visibility:{P:!0,"S1/R1":!0,"S2/R2":!0,"S3/R3":!0,"S4/R4":!0,"S5/R5":!0},colors:{P:"#FB8C00","S1/R1":"#FB8C00","S2/R2":"#FB8C00","S3/R3":"#FB8C00","S4/R4":"#FB8C00","S5/R5":"#FB8C00"},widths:{P:1,"S1/R1":1,"S2/R2":1,"S3/R3":1,"S4/R4":1,"S5/R5":1}}}}if(void 0===TradingView.defaultProperties["study_ZigZag@tv-basicstudies"]&&(TradingView.defaultProperties["study_ZigZag@tv-basicstudies"]={color:b,linewidth:2}),void 0===TradingView.defaultProperties["study_ElliottWave@tv-basicstudies"]&&(TradingView.defaultProperties["study_ElliottWave@tv-basicstudies"]={inputs:{},level0:t("rgba( 255, 0, 0, 1)",!1),level1:t("rgba( 0, 128, 0, 1)",!1),level2:t("rgba( 0, 0, 255, 1)",!1),level3:t("rgba( 255, 0, 255, 1)",!1),level4:t("rgba( 0, 128, 255, 1)",!0),level5:t("rgba( 255, 0, 0, 1)",!0),level6:t("rgba( 0, 128, 0, 1)",!0),level7:t("rgba( 0, 0, 255, 1)",!0),level8:t("rgba( 255, 0, 255, 1)",!0)}),void 0===TradingView.defaultProperties["study_LinearRegression@tv-basicstudies"]&&(TradingView.defaultProperties["study_LinearRegression@tv-basicstudies"]={styles:{upLine:{visible:!0,color:n(b,70),linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},downLine:{visible:!0,color:n(b,70),linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},baseLine:{visible:!0,color:"rgba(244, 67, 54, 0.3)",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1},extendLines:!0,showPearsons:!0,backgroundColor:"rgba( 153, 21, 21, 0.3)",transparency:70}}),void 0===TradingView.defaultProperties["study_Compare@tv-basicstudies"]&&(TradingView.defaultProperties["study_Compare@tv-basicstudies"]={minTick:"default"}),void 0===TradingView.defaultProperties["study_Overlay@tv-basicstudies"]){TradingView.defaultProperties["study_Overlay@tv-basicstudies"]={style:a.STYLE_LINE,allowExtendTimeScale:!1,showPriceLine:!1,minTick:"default",candleStyle:{upColor:"rgba( 107, 165, 131, 1)",downColor:"rgba( 215, 84, 66, 1)",drawWick:!0,drawBorder:!0,drawBody:!0,borderColor:"rgba( 55, 134, 88, 1)",borderUpColor:"rgba( 34, 84, 55, 1)",borderDownColor:"rgba( 91, 26, 19, 1)",wickColor:"rgba( 115, 115, 117, 1)",wickUpColor:"rgba( 115, 115, 117, 1)",
wickDownColor:"rgba( 115, 115, 117, 1)",barColorsOnPrevClose:!1},hollowCandleStyle:{upColor:"rgba( 107, 165, 131, 1)",downColor:"rgba( 215, 84, 66, 1)",drawWick:!0,drawBorder:!0,drawBody:!0,borderColor:"rgba( 55, 134, 88, 1)",borderUpColor:"rgba( 34, 84, 55, 1)",borderDownColor:"rgba( 91, 26, 19, 1)",wickColor:"rgba( 115, 115, 117, 1)",wickUpColor:"rgba( 115, 115, 117, 1)",wickDownColor:"rgba( 115, 115, 117, 1)",barColorsOnPrevClose:!1},barStyle:{upColor:"rgba( 107, 165, 131, 1)",downColor:"rgba( 215, 84, 66, 1)",barColorsOnPrevClose:!1,dontDrawOpen:!1,thinBars:!0},lineStyle:{color:"#FF6D00",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:2,priceSource:"close",styleType:a.STYLE_LINE_TYPE_SIMPLE},areaStyle:{color1:b,color2:b,linecolor:b,linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:2,priceSource:"close",transparency:95},baselineStyle:{baselineColor:"rgba( 117, 134, 150, 1)",topFillColor1:"rgba( 83, 185, 135, 0.05)",topFillColor2:"rgba( 83, 185, 135, 0.05)",bottomFillColor1:"rgba( 235, 77, 92, 0.05)",bottomFillColor2:"rgba( 235, 77, 92, 0.05)",topLineColor:"rgba( 83, 185, 135, 1)",bottomLineColor:"rgba( 235, 77, 92, 1)",topLineWidth:2,bottomLineWidth:2,priceSource:"close",transparency:50,baseLevelPercentage:50},styles:{open:{visible:!0,color:"rgba( 255, 0, 0, 1)",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:u.Line,histogramBase:0},high:{visible:!0,color:"rgba( 255, 0, 0, 1)",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:u.Line,histogramBase:0},low:{visible:!0,color:"rgba( 255, 0, 0, 1)",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:u.Line,histogramBase:0},close:{visible:!0,color:"rgba( 255, 0, 0, 1)",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:1,plottype:u.Line,histogramBase:0}}}}for(var L=e.split("."),M=TradingView.defaultProperties,E=0;E<L.length;E++)M&&(M=M[L[E]]);return null!=M?TradingView.clone(M):{}};function C(e,t,i,r,s){if(r)for(var n in r){var o=n.split("."),a=c(o[0]),l=void 0!==s&&s===o[0];0!==o.length&&l&&(a=c((o=o.slice(1))[0])),0!==o.length&&e.hasOwnProperty(a)?u(e,o,r[n])||d(n):l&&d(n)}function c(e){return t&&t[e]?t[e]:e}function u(e,t,i,r){var s=c(t[0]);return!!e.hasOwnProperty(s)&&(t.length>1?u(e[s],t.slice(1),i):(e[s]&&e[s].setValue?e[s].setValue(i):e[s]=i,!0))}function d(e){i||S.logWarn("Path `"+e+"` does not exist.")}}function T(e,t,i,r){window.__defaultsOverrides&&C(e,t,i,window.__defaultsOverrides,r)}function x(){var e=/^linetool.+/;Object.keys(TradingView.defaultProperties).forEach((function(t){e.test(t)&&T(TradingView.defaultProperties[t],null,!1,t)}))}function I(e,t){return t?function(e,t){var i=P(e);if(!window._UNIT_TESTS){var r=TradingView.clone(TVSettings.getJSON(e,null));if(function(e){var t=new Set(["linetoolregressiontrend"]);return e.startsWith("study_")||t.has(e)}(e)&&r&&function(e){if(!e)return!1;e=e.toString();var t=new RegExp("\\d+").exec(e);return null!==t&&t[0]===e}(r.version)){var s=r.inputs,n=t.updateStudyInputs(r.id,r.version,"last",s,null);r.inputs=n;var o=t.updateStudyState(r,r);r=o}TradingView.merge(i,r)}return i}(e,t):function(e){var t=P(e)
;if(!window._UNIT_TESTS){var i=TradingView.clone(TVSettings.getJSON(e,null));i&&TradingView.merge(t,i)}return t}(e)}I.create=function(e,t){if(t){var i=P(e);TradingView.defaultProperties[e]=Object.assign(t,i)}},I.remove=function(e){TradingView.defaultProperties[e]=void 0},TradingView.saveDefaults=function(e,t){TVSettings.setJSON(e,t)},TradingView.factoryDefaults=P,window.applyDefaultOverridesToLinetools=x,window.applyDefaultsOverrides=T,window.applyPropertiesOverrides=C,window.defaults=I,t.applyDefaultOverridesToLinetools=x,t.applyDefaultsOverrides=T,t.applyPropertiesOverrides=C,t.defaults=I,t.factoryDefaults=P,t.saveDefaults=TradingView.saveDefaults},14397:(e,t,i)=>{"use strict";i.r(t),i.d(t,{toolIsCursor:()=>h,toolIsMeasure:()=>p,resetToCursor:()=>_,lockTimeAxisTime:()=>b,tool:()=>w,iconTool:()=>P,cursorTool:()=>C,isToolCreatingNow:()=>T,isToolEditingNow:()=>x,isToolMovingNow:()=>I,isDirectionalMovementActive:()=>L,createdLineTool:()=>M,continuedLineTool:()=>E,cancelledLineTool:()=>A,beenSetLineToolLastPoint:()=>k,startedMovingLineTool:()=>D,movedLineTool:()=>R,finishedMovingLineTool:()=>N,startedChangingLineTool:()=>O,changedLineTool:()=>V,finishedChangingLineTool:()=>B,removedLineTool:()=>F,finishedLineTool:()=>W,changedLineStyle:()=>U,copiedLineTool:()=>H,restoredLineTool:()=>z,restoredLineToolState:()=>j,isPointSelectedNow:()=>Y,isStudyEditingNow:()=>G,createLineTool:()=>$,continueLineTool:()=>K,cancelLineTool:()=>J,setLineToolLastPoint:()=>Z,startMovingLineTool:()=>Q,moveLineTool:()=>ee,finishMovingLineTool:()=>te,startChangingLineTool:()=>ie,changeLineTool:()=>re,finishChangingLineTool:()=>se,removeLineTool:()=>ne,finishLineTool:()=>oe,changeLineStyle:()=>ae,copyLineTool:()=>le,restoreLineTool:()=>ce,restoreLineToolState:()=>ue,init:()=>pe,runOnDrawingStateReady:()=>_e,properties:()=>me,hideAllDrawings:()=>fe,hideAllIndicators:()=>ge,lockDrawings:()=>ve,hideMarksOnBars:()=>Se,drawOnAllCharts:()=>ye,lockTimeAxis:()=>be});var r=i(16282),s=i(64297),n=i(1771),o=i(65066),a=i.n(o),l=i(96276),c=i.n(l),u=i(42098),d=i(88001);function h(e){return"cursor"===e||"arrow"===e||"dot"===e}function p(e){return"measure"===e}function _(e=!1){if(!e&&m){if(m.childs().stayInDrawingMode.value())return}w.setValue(C.value())}let m=null,f=null,g=null,v=null,S=null,y=null;const b=new(a()),w=new(a()),P=new(a()),C=new(a()),T=new(a())(!1),x=new(a())(!1),I=new(a())(!1),L=new(a())(!1),M=new(c()),E=new(c()),A=new(c()),k=new(c()),D=new(c()),R=new(c()),N=new(c()),O=new(c()),V=new(c()),B=new(c()),F=new(c()),W=new(c()),U=new(c()),H=new(c()),z=new(c()),j=new(c()),Y=new(a())(!1),G=new(a())(!1);function q(e,t){const i=t||{value:!1};return t=>{i.value||(i.value=!0,e.fire(t),i.value=!1)}}const X={value:!1},$=q(M,X),K=q(E,X),J=q(A,X),Z=q(k,X),Q=q(D),ee=q(R),te=q(N),ie=q(O),re=q(V),se=q(B),ne=q(F),oe=q(W),ae=q(U,X),le=q(H,X),ce=q(z),ue=q(j);let de=!1,he=[];function pe(){de||(w.setValue(u.getValue("chart.cursorPreference","cursor")),w.subscribe(e=>h(e)&&C.setValue(e),{callWithLast:!0}),C.subscribe(e=>{e&&u.setValue("chart.cursorPreference",e)}),
m=new n.DefaultProperty("drawings"),f=(0,s.createPrimitiveProperty)(),g=(0,s.createPrimitiveProperty)(),v=(0,s.createPrimitiveProperty)(),S=(0,s.createPrimitiveProperty)(),y=(0,s.createPrimitiveProperty)(),f.setValue(!1),g.setValue(!1),v.setValue(!1),S.setValue(!1),y.setValue(!1),w.subscribe(()=>{(0,d.emit)("onSelectedLineToolChanged")}),de=!0,he.forEach(e=>e()),he=[])}function _e(e){de?e():he.push(e)}function me(){return(0,r.ensureNotNull)(m)}function fe(){return(0,r.ensureNotNull)(f)}function ge(){return(0,r.ensureNotNull)(g)}function ve(){return(0,r.ensureNotNull)(v)}function Se(){return(0,r.ensureNotNull)(S)}function ye(){return me().childs().drawOnAllCharts}function be(){return(0,r.ensureNotNull)(y)}},17483:(e,t,i)=>{"use strict";i.d(t,{EnvironmentState:()=>s});var r=i(68724);class s{constructor(e){this._shift=!1,this._control=!1,this._alt=!1,void 0!==e&&(this._shift=Boolean(e.shiftKey),this._control=Boolean((0,r.isMac)()?e.metaKey:e.ctrlKey),this._alt=Boolean(e.altKey))}shift(){return this._shift}control(){return this._control}alt(){return this._alt}shiftOnly(){return this._shift&&!this._control&&!this._alt}controlOnly(){return this._control&&!this._shift&&!this._alt}altOnly(){return this._alt&&!this._shift&&!this._control}controlShift(){return this._shift&&this._control&&!this._alt}static create(e=!1,t=!1,i=!1){return new s({shiftKey:e,ctrlKey:t,metaKey:t,altKey:i})}}},18748:(e,t,i)=>{"use strict";i.r(t),i.d(t,{DividendsPaneView:()=>me,EarningsPaneView:()=>ae,SplitsPaneView:()=>de});var r=i(24194),s=i(16282),n=i(72927),o=i(93669),a=i(20220),l=i(46202),c=i(82755),u=i(1694),d=i(31565),h=i(50946),p=i(32022),_=i(14704),m=i(81293),f=i(39304),g=i(2459),v=i(72543),S=i(62288),y=i(4033),b=i(43389),w=i(59503),P=i(3707),C=i(4456),T=i(99438);class x extends C.LollipopRenderer{_drawLollipop(e,t,i){const r=i.pixelRatio,s=this._data.style;e.save(),e.translate(t.x-s.lollipop.width*r/2,t.y-s.lollipop.height*r/2),e.scale(r,r);const n=this._createPaths();s.lollipop.fillCircle&&s.lollipop.backgroundColor&&(e.fillStyle=s.lollipop.backgroundColor,e.fill(n.fillPath)),e.strokeStyle=s.lollipop.strokeStyle,e.lineWidth=Math.round(s.lollipop.lineWidth*r)/r,(0,T.setLineStyle)(e,P.LINESTYLE_SOLID),s.lollipop.fillCircle&&s.lollipop.fillStyle&&(e.fillStyle=s.lollipop.fillStyle,e.fill(n.strokePath)),e.stroke(n.strokePath),e.restore()}_createPaths(){let e,t;switch(this._data.style.type){case"Positive":e=new Path2D("M8.961.92a3 3 0 0 1 3.078 0l7.5 4.48A3 3 0 0 1 21 7.975V20a3 3 0 0 1-3 3H3a3 3 0 0 1-3-3V7.975A3 3 0 0 1 1.461 5.4l7.5-4.48z"),t=new Path2D("M9.867 2.742c.39-.23.875-.23 1.266 0l7.5 4.406c.382.225.617.635.617 1.078V20c0 .69-.56 1.25-1.25 1.25H3c-.69 0-1.25-.56-1.25-1.25V8.226c0-.443.235-.853.617-1.078l7.5-4.406z");break;case"Negative":e=new Path2D("M8.961 22.08a3 3 0 0 0 3.078 0l7.5-4.48A3 3 0 0 0 21 15.025V3a3 3 0 0 0-3-3H3a3 3 0 0 0-3 3v12.025A3 3 0 0 0 1.461 17.6l7.5 4.48z"),
t=new Path2D("M9.866 20.257c.391.23.877.23 1.268 0l7.5-4.414a1.25 1.25 0 0 0 .616-1.078V3c0-.69-.56-1.25-1.25-1.25H3c-.69 0-1.25.56-1.25 1.25v11.765c0 .443.234.853.616 1.078l7.5 4.414z");break;default:e=new Path2D("M3 0h15c1.662 0 3 1.338 3 3v15c0 1.662-1.338 3-3 3H3c-1.662 0-3-1.338-3-3V3c0-1.662 1.338-3 3-3z"),t=new Path2D("M3 1.75h15c.693 0 1.25.557 1.25 1.25v15c0 .693-.557 1.25-1.25 1.25H3c-.692 0-1.25-.558-1.25-1.25V3c0-.692.558-1.25 1.25-1.25z")}return{fillPath:e,strokePath:t}}}var I=i(79187),L=i(44560),M=i(84667),E=i(70541),A=i(32411),k=i(57115),D=i(86350),R=i(29393),N=i(4402),O=i(47595),V=i(80910),B=i(34632);const F=(0,a.t)("Earnings & Revenue"),W=(0,a.t)("Earnings"),U=(0,a.t)("Standardized"),H=(0,a.t)("Reported"),z=(0,a.t)("Estimate"),j=(0,a.t)("Surprise"),Y=(0,a.t)("Split"),G=(0,a.t)("Dividends"),q=(0,a.t)("Net"),X=(0,a.t)("Gross"),$=(0,a.t)("Date"),K=(0,a.t)("Period Ending"),J=(0,a.t)("Payment Date"),Z=(0,a.t)("Revenue"),Q=(0,a.t)("Before market open"),ee=(0,a.t)("After market close");class te extends M.LollipopPaneView{constructor(){super(...arguments),this._hideLollipops=!1,this._stackStudies=[]}addLollipop(e,t,i,r,o,a,l){const c=a[0],u=this._model.mainSeries().symbolInfo();if(!u)return;const d=u.name;let h=null;const p=this._source.metaInfo().id+"_"+c+"_"+d,_=this._lollipops[p],m=void 0!==_?_.itemIndex:this._lollipopsCounter++,f=this._model.lastHittestData(),g=p===this.getLastClickedLollipopId(),v=this._model.hoveredSource()===this._source&&null!==f&&f.activeItem===m;if(v||g){const e=t.valueAt(o);if(null!==e){const t=e[3],i=(0,s.ensureNotNull)(this._model.mainSeries().firstValue());h=r.priceToCoordinate(t,i)}}this._lollipops[p]={id:p,itemIndex:m,visible:!0,basePoint:new n.Point(i.indexToCoordinate(o),e),hovered:v,active:g,barY:h,stack:l,...this.extraData(a)}}renderer(e,t){return this._invalidated&&(this._updateImpl(t,e),this._invalidated=!1),this._hideLollipops?null:this._renderer}_updateImpl(e,t){this._setStackStudies();const i=this._source.data(),r=this._model.timeScale(),n=r.visibleBarsStrictRange(),o=this._model.mainSeries().bars(),a=this._source.priceScale(),l=this._model.mainSeries().firstBar();if(!a||a.isEmpty()||r.isEmpty()||!l||!i||null===n)return;if(r.barSpacing()/23<2/3&&g.Interval.parse(this._model.mainSeries().interval()).inMilliseconds()>=432e6)return this._hideLollipops=!0,void this.clearLastClicked();this._hideLollipops=!1;for(const e in this._lollipops)this._lollipops.hasOwnProperty(e)&&((0,s.ensureDefined)(this._lollipops[e]).visible=!1);const c=this._getY(),u=n.firstBar(),d=n.lastBar();i.range(u,d).each((e,t)=>{let i=0;for(let t=0;t<this._stackStudies.length;++t)this._stackStudies[t].data().contains(e)&&++i;return e>u&&e<d&&this.addLollipop(c,o,r,a,e,t,i),!1}),this.afterUpdate(c,o,r,a),this._createRenderers(e,t)}_formatDate(e,t){let i,r=!0;if(r=L.Version.parse(this._source.metaInfo().version).isLessOrEqual(new L.Version(137,0)),r){let t="Etc/UTC";const r=this._model.mainSeries();if(!r.isDWM()&&(t=this._model.properties().timezone.value(),"exchange"===t)){const e=r.symbolInfo()
;t=e&&e.timezone||""}const s=(0,y.get_timezone)(t);i=(0,y.utc_to_cal)(s,e)}else i=new Date(e);return(t?"≈ ":"")+new b.DateFormatter(w.dateFormatProperty.value()).format(i)}_setStackStudies(){if(this._stackStudies=[],!(this._source instanceof A.study_ESD$TV_EARNINGS))for(const e of this._model.dataSources())(e instanceof A.study_ESD$TV_EARNINGS||e instanceof A.study_ESD$TV_SPLITS&&this._source instanceof A.study_ESD$TV_DIVIDENDS)&&this._stackStudies.push(e)}_getMoreFinancialsLink(){var e,t;return{text:(0,a.t)("More {symbol} financials",{replace:{symbol:null!==(t=null===(e=this._model.mainSeries().symbolInfo())||void 0===e?void 0:e.name)&&void 0!==t?t:""}}),onClick:()=>(0,E.showFinancialsDialog)({initialTabId:"income statements"})}}}const ie={positive:o.colorsPalette["color-minty-green-600"],negative:o.colorsPalette["color-ripe-red-600"],future:o.colorsPalette["color-grapes-purple-a400"],unknown:o.colorsPalette["color-cold-gray-350"]},re={positive:o.colorsPalette["color-minty-green-500"],negative:o.colorsPalette["color-ripe-red-500"],future:o.colorsPalette["color-grapes-purple-a200"],unknown:o.colorsPalette["color-cold-gray-700"]};function se(e){return e?ie:re}const ne=new _.PercentageFormatter,oe=new m.VolumeFormatter;class ae extends te{constructor(e,t,i){super(e,t,i)}styles(e){return e?{positive:o.colorsPalette["color-minty-green-600"],negative:o.colorsPalette["color-ripe-red-600"],future:o.colorsPalette["color-grapes-purple-a400"],unknown:o.colorsPalette["color-cold-gray-350"]}:{positive:o.colorsPalette["color-minty-green-500"],negative:o.colorsPalette["color-ripe-red-500"],future:o.colorsPalette["color-grapes-purple-a200"],unknown:o.colorsPalette["color-cold-gray-700"]}}extraData(e){const t=e[8],i=14===t,r=e[1],s=e[2],n=e[3],o=e[4],a=i?null:e[5],l=null!=a&&null!=s?a-s:null,c=e[6],u=i?null:e[7];let d;return null!=t?t<20?d="Future":null!==l&&(d=l<0?"Negative":"Positive"):null!==l?d=l<0?"Negative":"Positive":o>Date.now()&&(d="Future"),{standardized:r,reported:a,estimate:s,revenueValue:u,revenueEstimate:c,period:n,date:o,type:d,timeType:null!=t?t:void 0}}afterUpdate(e,t,i,r){const s=this._source.getEstimate();if(s){const n=s.value.slice();n[4]*=1e3,this.addLollipop(e,t,i,r,s.index,n)}}createTooltipContent(e){const t=e.standardized,i=null!=t,n=e.reported,o=null!=n,a=e.estimate,u=null!=a,d=o&&u?n-a:null;let h=e.revenueEstimate,p=!1;null!=h&&(p=!0,h*=1e6);let _=e.revenueValue,m=!1;null!=_&&(m=!0,_*=1e6);const f=m&&p?_-h:null,g=se(this._model.isDark());let v,S,y,b,w;switch(e.type){case"Future":S=g.future,v=R;break;case"Negative":S=g.negative,v=D;break;case"Positive":S=g.positive,v=k;break;default:S=g.unknown,v=R}switch(e.timeType){case 12:case 22:y=B,b=l.LollipopGroupIcons.AfterMarketClose,w=ee;break;case 11:case 21:y=V,b=l.LollipopGroupIcons.BeforeMarketOpen,w=Q}const P=10===e.timeType||14===e.timeType,C={name:$,value:this._formatDate(e.date,P)};y&&(C.valueRightIcon={iconContent:y,iconClass:b,tooltipText:w});const T=[C];e.period&&T.push({name:K,value:r.unix(e.period).format("MMM 'YY")});const x={title:m||p?F:W,
subTitle:T,tooltipIcon:v,style:{color:S},content:[],anchor:this._getMoreFinancialsLink()},L={title:W,content:[]};if(i&&L.content.push({name:U,value:(0,I.roundToFirstValuable)(t),style:{fontWeight:"bold"}}),o&&L.content.push({name:H,value:(0,I.roundToFirstValuable)(n)}),u&&L.content.push({name:z,value:(0,I.roundToFirstValuable)(a)}),null!==d){const e=100*Math.abs(d/a);let t=(0,I.roundToFirstValuable)(d);isFinite(e)&&(t+=" ("+ne.format(e)+")"),L.content.push({name:j,value:(0,c.forceLTRStr)(t),style:{fontWeight:"bold",color:S}})}if((0,s.ensureDefined)(x.content).push(L),m||p){const e={title:Z,content:[]};if(m&&e.content.push({name:H,value:oe.format(_)}),p&&e.content.push({name:z,value:oe.format(h)}),null!==f){const t=100*Math.abs(f/h);let i=oe.format(f);isFinite(t)&&(i+=" ("+ne.format(t)+")"),e.content.push({name:j,value:(0,c.forceLTRStr)(i),style:{fontWeight:"bold",color:f>=0?g.positive:g.negative}})}(0,s.ensureDefined)(x.content).push(e)}return x}showBarLine(){return!this._model.mainSeries().properties().childs().esdShowBreaks.value()}renderer(e,t){const i=super.renderer(e,t);if(null===i)return null;if(this._model.mainSeries().properties().childs().esdShowBreaks.value())for(const e in this._lollipops)if(this._lollipops.hasOwnProperty(e)){const t=(0,s.ensureDefined)(this._lollipops[e]);if(t.visible){const e=this.getStyle(t),{strokeStyle:r,lineStyle:s,lineWidth:n}=e.barLine,o={color:r,linestyle:s,linewidth:n,x:t.basePoint.x,top:0,bottom:t.basePoint.y-e.lollipop.bottom-e.lollipop.height},a=new v.VerticalLineRenderer;a.setData(o),i.insert(a,0)}}return i}getStyle(e){if(void 0===e.type)return super.getStyle(e);const t=e.active?"active":e.hovered?"hovered":"default";let i=t;e.stack&&(i+="_stack:"+e.stack);let r=this._getStyleObject(e.type,i);if(null!==r)return r;if(this._stylesCache||(this._stylesCache={}),!this._stylesCache[i]){r=this._getStyleObject(e.type,t);const s=(0,d.clone)(r);s&&(e.stack&&(s.lollipop.incHeight=25*e.stack),this._stylesCache[i]=s)}return this._stylesCache[i]}_createRendererForLollipop(e,t){return new x(e,new S.HitTestResult(S.HitTestResult.CUSTOM,t),this._textWidthCache)}_recreateStyles(e){const t=e.isDark(),i=se(t),r=i.unknown,s={barLine:{lineStyle:P.LINESTYLE_DASHED,lineWidth:1,strokeStyle:r},lollipop:{width:21,height:21,bottom:2,lineWidth:1.5,importance:"earnings",strokeStyle:r,backgroundColor:t?o.colorsPalette["color-cold-gray-900"]:o.colorsPalette["color-white"],fillCircle:!0,text:{label:"E",strokeStyle:r,font:(0,p.makeFont)(12,f.CHART_FONT_FAMILY,"bold")}}},n={lollipop:{fillStyle:(0,h.generateColor)(r,85)}},a={lollipop:{fillStyle:r,text:{strokeStyle:o.colorsPalette["color-cold-gray-50"]}}};this.defaultStyle=(0,u.deepCopy)(s),this.hoveredStyle=(0,d.merge)((0,u.deepCopy)(s),n),this.activeStyle=(0,d.merge)((0,u.deepCopy)(s),a);const l=(e,t)=>{const i=(0,u.deepCopy)(s);return i.barLine.strokeStyle=e,i.lollipop.strokeStyle=e,i.lollipop.text.strokeStyle=e,i.type=t,n.lollipop.fillStyle=(0,h.generateColor)(e,85),a.lollipop.fillStyle=e,{default:i,hovered:(0,d.merge)((0,u.deepCopy)(i),n),active:(0,
d.merge)((0,u.deepCopy)(i),a)}};a.lollipop.text.strokeStyle=o.colorsPalette["color-grapes-purple-50"];const c=l(i.future,"Future");s.lollipop.height=23,s.lollipop.text.deltaY=1,a.lollipop.text.strokeStyle=o.colorsPalette["color-minty-green-50"];const _=l(i.positive,"Positive");s.lollipop.bottom=.5,s.lollipop.text.deltaY=-.5,a.lollipop.text.strokeStyle=o.colorsPalette["color-ripe-red-50"];const m=l(i.negative,"Negative");this._earningTypeStyles={Future:c,Positive:_,Negative:m},this._stylesCache=null}_getStyleObject(e,t){const i=this._earningTypeStyles[e];switch(t){case"default":return i.default;case"hovered":return i.hovered;case"active":return i.active}return null}}const le=o.colorsPalette["color-tan-orange-600"],ce=o.colorsPalette["color-tan-orange-500"];function ue(e){return e?le:ce}class de extends te{extraData(e){const t=e[1];return{numerator:e[2],denominator:t,date:e[3]}}createTooltipContent(e){let t=Y;return(0,d.isNumber)(e.numerator)&&(0,d.isNumber)(e.denominator)&&(t+=": "+e.numerator+"/"+e.denominator),{title:t,subTitle:this._formatDate(e.date),tooltipIcon:N,style:{color:ue(this._model.isDark())},anchor:this._getMoreFinancialsLink()}}_recreateStyles(e){const t=e.isDark(),i=ue(t),r={barLine:{lineStyle:P.LINESTYLE_DASHED,lineWidth:1,strokeStyle:i},lollipop:{width:23,height:23,bottom:1,lineWidth:1.5,importance:"splits",strokeStyle:i,backgroundColor:t?o.colorsPalette["color-cold-gray-900"]:o.colorsPalette["color-white"],fillCircle:!0,text:{label:"S",strokeStyle:i,font:(0,p.makeFont)(12,f.CHART_FONT_FAMILY,"bold")}}},s={lollipop:{fillStyle:(0,h.generateColor)(i,85)}},n={lollipop:{fillStyle:i,text:{strokeStyle:o.colorsPalette["color-tan-orange-50"]}}};this.defaultStyle=r,this.hoveredStyle=(0,d.merge)((0,u.deepCopy)(r),s),this.activeStyle=(0,d.merge)((0,u.deepCopy)(r),n),this._stylesCache=null}}const he=o.colorsPalette["color-tv-blue-600"],pe=o.colorsPalette["color-tv-blue-500"];function _e(e){return e?he:pe}class me extends te{extraData(e){return{grossDividends:e[1],netDividends:e[3],date:e[2],paymentDate:e[4]}}createTooltipContent(e){const t=[{name:$,value:this._formatDate(e.date)}],i=+e.netDividends;isFinite(i)&&0!==i&&t.push({name:q,value:(0,I.roundToFirstValuable)(i)});const r=+e.grossDividends;isFinite(r)&&t.push({name:X,value:(0,I.roundToFirstValuable)(r)});const s=+e.paymentDate;return isFinite(s)&&t.push({name:J,value:this._formatDate(s)}),{title:G,subTitle:t,tooltipIcon:O,style:{color:_e(this._model.isDark())},anchor:this._getMoreFinancialsLink()}}_recreateStyles(e){const t=e.isDark(),i=_e(t),r={barLine:{lineStyle:P.LINESTYLE_DASHED,lineWidth:1,strokeStyle:i},lollipop:{width:23,height:23,bottom:1,lineWidth:1.5,importance:"dividends",strokeStyle:i,backgroundColor:t?o.colorsPalette["color-cold-gray-900"]:o.colorsPalette["color-white"],fillCircle:!0,text:{label:"D",strokeStyle:i,font:(0,p.makeFont)(12,f.CHART_FONT_FAMILY,"bold")}}},s={lollipop:{fillStyle:(0,h.generateColor)(i,85)}},n={lollipop:{fillStyle:i,text:{strokeStyle:o.colorsPalette["color-tv-blue-50"]}}};this.defaultStyle=r,this.hoveredStyle=(0,
d.merge)((0,u.deepCopy)(r),s),this.activeStyle=(0,d.merge)((0,u.deepCopy)(r),n),this._stylesCache=null}}},43607:(e,t,i)=>{"use strict";function r(e){return Boolean(e.inputs)||function(e){return Boolean(e.replay)}(e)||e.session||e.adjustment||e["currency-id"]||e["unit-id"]?function(e){return"="+JSON.stringify(e)}(e):e.symbol}function s(e){if("="!==e[0])return{symbol:e};try{return JSON.parse(e.slice(1))}catch(t){return{symbol:e}}}i.d(t,{encodeExtendedSymbolOrGetSimpleSymbolString:()=>r,decodeExtendedSymbol:()=>s})},10934:(e,t,i)=>{"use strict";i.d(t,{monthFormatFunction:()=>p,dateFormatFunctions:()=>_,availableDateFormats:()=>m,defaultDateFormat:()=>f});var r=i(20220),s=i(11228);const n={1:()=>(0,r.t)("Jan"),2:()=>(0,r.t)("Feb"),3:()=>(0,r.t)("Mar"),4:()=>(0,r.t)("Apr"),5:()=>(0,r.t)("May",{context:"short"}),6:()=>(0,r.t)("Jun"),7:()=>(0,r.t)("Jul"),8:()=>(0,r.t)("Aug"),9:()=>(0,r.t)("Sep"),10:()=>(0,r.t)("Oct"),11:()=>(0,r.t)("Nov"),12:()=>(0,r.t)("Dec")},o=(e,t)=>(t?e.getMonth():e.getUTCMonth())+1,a=(e,t)=>t?e.getFullYear():e.getUTCFullYear(),l=(e,t)=>(0,s.numberToStringWithLeadingZero)(((e,t)=>t?e.getDate():e.getUTCDate())(e,t),2),c=(e,t)=>n[o(e,t)](),u=(e,t)=>(0,s.numberToStringWithLeadingZero)(o(e,t),2),d=(e,t)=>(0,s.numberToStringWithLeadingZero)(a(e,t)%100,2),h=(e,t)=>(0,s.numberToStringWithLeadingZero)(a(e,t),4),p=(e,t)=>c(e,t),_={"dd MMM 'yy":(e,t)=>`${l(e,t)} ${c(e,t)} '${d(e,t)}`,"MMM dd, yyyy":(e,t)=>`${c(e,t)} ${l(e,t)}, ${h(e,t)}`,"MMM dd":(e,t)=>`${c(e,t)} ${l(e,t)}`,"yyyy-MM-dd":(e,t)=>`${h(e,t)}-${u(e,t)}-${l(e,t)}`,"yy-MM-dd":(e,t)=>`${d(e,t)}-${u(e,t)}-${l(e,t)}`,"yy/MM/dd":(e,t)=>`${d(e,t)}/${u(e,t)}/${l(e,t)}`,"yyyy/MM/dd":(e,t)=>`${h(e,t)}/${u(e,t)}/${l(e,t)}`,"dd-MM-yyyy":(e,t)=>`${l(e,t)}-${u(e,t)}-${h(e,t)}`,"dd-MM-yy":(e,t)=>`${l(e,t)}-${u(e,t)}-${d(e,t)}`,"dd/MM/yy":(e,t)=>`${l(e,t)}/${u(e,t)}/${d(e,t)}`,"dd/MM/yyyy":(e,t)=>`${l(e,t)}/${u(e,t)}/${h(e,t)}`,"MM/dd/yy":(e,t)=>`${u(e,t)}/${l(e,t)}/${d(e,t)}`,"MM/dd/yyyy":(e,t)=>`${u(e,t)}/${l(e,t)}/${h(e,t)}`},m=Object.keys(_),f=()=>-1!==["ja","ko","zh","zh_TW"].indexOf(window.language||"")?"yyyy-MM-dd":"dd MMM 'yy"},43389:(e,t,i)=>{"use strict";i.d(t,{DateFormatter:()=>n});var r=i(11228),s=i(10934);class n{constructor(e="yyyy-MM-dd"){this._dateFormatFunc=s.dateFormatFunctions[e]}format(e){return r.customFormatters&&r.customFormatters.dateFormatter?r.customFormatters.dateFormatter.format(e):this._dateFormatFunc(e,!1)}formatLocal(e){return r.customFormatters.dateFormatter?r.customFormatters.dateFormatter.formatLocal?r.customFormatters.dateFormatter.formatLocal(e):r.customFormatters.dateFormatter.format(e):this._dateFormatFunc(e,!0)}}},833:(e,t,i)=>{"use strict";i.d(t,{DateTimeFormatter:()=>o});var r=i(15055),s=i(43389);const n={dateFormat:"yyyy-MM-dd",timeFormat:"%h:%m:%s",dateTimeSeparator:" "};class o{constructor(e={}){const t=Object.assign({},n,e);this._dateFormatter=new s.DateFormatter(t.dateFormat),this._timeFormatter=new r.TimeFormatter(t.timeFormat),this._separator=t.dateTimeSeparator}format(e){
return`${this._dateFormatter.format(e)}${this._separator}${this._timeFormatter.format(e)}`}formatLocal(e){return`${this._dateFormatter.formatLocal(e)}${this._separator}${this._timeFormatter.formatLocal(e)}`}}},82948:(e,t,i)=>{"use strict";i.d(t,{DateTimeWithTzFormatter:()=>a});var r=i(27841),s=i(43389),n=i(15055);const o={dateFormat:"MMM dd",timeFormat:"%h:%m"};class a{constructor(e={}){this._dateFormatter=null,this._timeFormatter=null,this._options=Object.assign({},o,e),""!==this._options.dateFormat&&(this._dateFormatter=new s.DateFormatter(this._options.dateFormat)),this._options.timeFormat.length>0&&(this._timeFormatter=new n.TimeFormatter(this._options.timeFormat)),this._timezone=this._options.timezone}format(e){void 0===this._tzOffset&&void 0!==this._timezone&&(this._tzOffset=(0,r.parseTzOffset)(this._timezone,1e3*e));const t=this._tzOffset?this._tzOffset:{offset:0,string:"UTC"},i=1e3*e+t.offset,s=new Date(i),n=[];if(null!==this._dateFormatter&&n.push(this._dateFormatter.format(s)),null!==this._timeFormatter){const e=this._timeFormatter.format(s);n.push(e)}return n.push(t.string),n.join(" ")}setTimezone(e){this._timezone=e,this._tzOffset=void 0}}},55055:(e,t,i)=>{"use strict";i.d(t,{FormattersSerializer:()=>c});var r=i(11228),s=i(81293),n=i(14704),o=i(53371),a=i(16282);const l={price:r.PriceFormatter,volume:s.VolumeFormatter,percentage:n.PercentageFormatter,quoteSessionPrice:o.QuoteSessionPriceFormatter};var c;!function(e){e.serialize=function(e){const t=(0,a.ensureDefined)(l[e.type]);return{type:e.type,state:t.serialize(e)}},e.deserialize=function(e){return(0,a.ensureDefined)(l[e.type]).deserialize(e.state)}}(c||(c={}))},95872:(e,t,i)=>{"use strict";i.d(t,{LimitedPrecisionNumericFormatter:()=>s});var r=i(31565);class s{constructor(e=1){this._precision=e}format(e){(0,r.isNumber)(e)||(e=parseFloat(e));const t=e.toFixed(this._precision),i=Math.pow(10,-this._precision);return Math.max(parseFloat(t),i)+""}parse(e){const t=parseFloat(e);return isNaN(t)?{res:!1}:{res:!0,value:t,suggest:this.format(t)}}}},80790:(e,t,i)=>{"use strict";i.d(t,{NumericFormatter:()=>n});var r=i(11228),s=i(93302);class n{constructor(e){this._precision=e}format(e){return(void 0!==this._precision?e.toFixed(this._precision):n.formatNoE(e)).replace(".",r.formatterOptions.decimalSign)}parse(e){const t=e.replace(r.formatterOptions.decimalSign,".");let i=parseFloat(t);return this._precision&&(i=+i.toFixed(this._precision)),i}static formatNoE(e){if(!Number.isFinite(e))return String(e);const t=new s.Big(e);return t.lt(1)?t.toFixed():t.toString()}}},14704:(e,t,i)=>{"use strict";i.d(t,{PercentageFormatter:()=>n});var r=i(11228),s=i(82755);class n extends r.PriceFormatter{constructor(e){super(e),this.type="percentage"}state(){const e=r.PriceFormatter.prototype.state.call(this);return e.percent=!0,e}parse(e){return e=e.replace("%",""),super.parse(e)}format(e,t,i,r,n=!0){const o=super.format(e,t,i,r,!1)+"%";return n?(0,s.forceLTRStr)(o):o}static serialize(e){return e.state()}static deserialize(e){return new n(e.priceScale)}}},11386:(e,t,i)=>{"use strict"
;i.d(t,{PipFormatter:()=>s});var r=i(11228);class s extends r.PriceFormatter{constructor(e,t,i,r){t||(t=1),"forex"!==i&&"cfd"!==i||!r?(super(1),this._isForex=!1):(super(r),this._isForex=!0),this._pipPriceScale=e,this._pipMinMove=t,this._pipMinMove2=r}format(e,t,i){let r=this._isForex?this._pipMinMove2:this._pipMinMove;return void 0===r&&(r=NaN),super.format(e*this._pipPriceScale/r,t,i)}}},30879:(e,t,i)=>{"use strict";i.d(t,{PriceColorer:()=>r});var r,s=i(71928),n=i(93669);!function(e){function t(e,t){return 0===e?t&&void 0!==t.neutral?t.neutral:s.color.black70:e>0?t&&void 0!==t.up?t.up:n.colorsPalette["color-success"]:t&&void 0!==t.down?t.down:n.colorsPalette["color-danger"]}e.formatSign=t,e.formatDiff=function(e,i){return t(i-e)},e.domDifference=function(e,t,i=0,r="",s=""){function n(e){const t=document.createElement("span");return t.innerHTML=e,t}const o=document.createElement("div");if(!i)return o.appendChild(n(e)),o;const a=e+"",l=t+"";let c=null;if(a.length===l.length){for(let e=0;e<a.length;e++)if(a.charAt(e)!==l.charAt(e)){c=e;break}}else c=Number("0");if(null===c)return o.appendChild(n(a)),o;const u=n(a.substr(0,c)),d=document.createElement("span");return d.className=i<0?r:s,d.appendChild(n(a.substr(c))),o.appendChild(u),o.appendChild(d),o}}(r||(r={}))},11228:(e,t,i)=>{"use strict";i.d(t,{customFormatters:()=>l,formatterOptions:()=>c,numberToStringWithLeadingZero:()=>u,PriceFormatter:()=>d});var r=i(20220),s=i(31565),n=i(82755);const o=(0,i(87380).getLogger)("Chart.PriceFormatter"),a=new RegExp(/^(-?)[0-9]+$/),l={dateFormatter:null,timeFormatter:null},c={decimalSign:".",decimalSignFractional:"'"};function u(e,t){if(!(0,s.isNumber)(e))return"n/a";if(!(0,s.isInteger)(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");if(0===t)return e.toString();return("0000000000000000"+e.toString()).slice(-t)}class d{constructor(e,t,i,n){if(this.type="price",this._formatterErrors={custom:(0,r.t)("Price format is invalid."),fraction:(0,r.t)("Fraction part is invalid."),secondFraction:(0,r.t)("Second fraction part is invalid.")},t||(t=1),(0,s.isNumber)(e)&&(0,s.isInteger)(e)||(e=100),e<0)throw new TypeError("invalid base");this._priceScale=e,this._minMove=t,this._minMove2=n,i&&void 0!==n&&n>0&&2!==n&&4!==n&&8!==n?o.logDebug("invalid minmove2"):(this._fractional=i,this.calculateDecimal())}isFractional(){return!!this._fractional}state(){return{fractional:this._fractional,fractionalLength:this._fractionalLength,minMove:this._minMove,minMove2:this._minMove2,priceScale:this._priceScale}}calculateDecimal(){if(this._fractionalLength=0,this._priceScale>0&&this._minMove>0){let e=this._priceScale;for(this._fractional&&this._minMove2&&(e/=this._minMove2);e>1;)e/=10,this._fractionalLength++}}format(e,t,i,r=!0,s=!0){let o,a="";return e<0?(a=!1===r?"":"−",e=-e):e&&!0===t&&(a="+"),o=this._fractional?a+this._formatAsFractional(e,i):a+this._formatAsDecimal(e,i),s?(0,n.forceLTRStr)(o):o}parse(e){return e=(e=(0,n.stripLTRMarks)(e)).replace("−","-"),
this._fractional?this._minMove2?this._parseAsDoubleFractional(e):this._parseAsSingleFractional(e):this._parseAsDecimal(e)}hasForexAdditionalPrecision(){return!this._fractional&&10===this._minMove2}static serialize(e){return e.state()}static deserialize(e){return new d(e.priceScale,e.minMove,e.fractional,e.minMove2)}_formatAsDecimal(e,t){let i;t=t||0,i=this._fractional?Math.pow(10,this._fractionalLength||0):Math.pow(10,t)*this._priceScale/this._minMove;const r=1/i;let s;if(i>1)s=Math.floor(e);else{const t=Math.floor(Math.round(e/r)*r);s=0===Math.round((e-t)/r)?t:t+r}let n="";if(i>1){let r=parseFloat((Math.round(e*i)-s*i).toFixed(this._fractionalLength));r>=i&&(r-=i,s+=1);const o=void 0!==this._fractionalLength?this._fractionalLength:NaN;n=c.decimalSign+u(parseFloat(r.toFixed(this._fractionalLength))*this._minMove,o+t),n=this._removeEndingZeros(n,t)}return s.toString()+n}_getFractPart(e,t){const i=[0,5],r=[0,2,5,7];return 2===t?void 0===i[e]?-1:i[e]:4===t?void 0===r[e]?-1:r[e]:e}_formatAsFractional(e,t){const i=this._priceScale/this._minMove;let r=Math.floor(e),s=t?Math.floor(e*i)-r*i:Math.round(e*i)-r*i;s===i&&(s=0,r+=1);let n="";if(t){let o=(e-r-s/i)*i;o=Math.round(o*Math.pow(10,t)),n=u(o,t),n=this._removeEndingZeros(n,t)}if(!this._fractionalLength)throw new Error("_fractionalLength is not calculated");let o="";if(this._minMove2){const e=s%this._minMove2;s=(s-e)/this._minMove2;const t=u(s,this._fractionalLength),i=this._getFractPart(e,this._minMove2);o=t+c.decimalSignFractional+i}else s=this._getFractPart(s,this._priceScale),o=u(s*this._minMove,this._fractionalLength);return r.toString()+c.decimalSignFractional+o+n}_removeEndingZeros(e,t){for(let i=0;i<t&&"0"===e[e.length-1];i++)e=e.substr(0,e.length-1);return e}_parseAsDecimal(e){let t=a.exec(e);if(t){const t=parseFloat(e);return{value:t,res:!0,suggest:this.format(t)}}if(t=new RegExp("^(-?)[0-9]+\\"+c.decimalSign+"[0-9]*$").exec(e),t){const t=parseFloat(e.replace(c.decimalSign,"."));return{value:t,res:!0,suggest:this.format(t)}}return{error:this._formatterErrors.custom,res:!1}}_patchFractPart(e,t){const i={0:0,5:1},r={0:0,2:1,5:2,7:3};return 2===t?void 0===i[e]?-1:i[e]:4===t?void 0===r[e]?-1:r[e]:e}_parseAsSingleFractional(e){let t=a.exec(e);if(t){const t=parseFloat(e);return{value:t,res:!0,suggest:this.format(t)}}if(t=new RegExp("^(-?)([0-9]+)\\"+c.decimalSignFractional+"([0-9]+)$").exec(e),t){const e=!!t[1],i=parseInt(t[2]),r=this._priceScale,s=this._patchFractPart(parseInt(t[3]),r);if(s>=r||s<0)return{error:this._formatterErrors.fraction,res:!1};let n=i+s/r;return e&&(n=-n),{value:n,res:!0,suggest:this.format(n)}}return{error:this._formatterErrors.custom,res:!1}}_parseAsDoubleFractional(e){let t=a.exec(e);if(t){const t=parseFloat(e);return{value:t,res:!0,suggest:this.format(t)}}if(t=new RegExp("^(-?)([0-9]+)\\"+c.decimalSignFractional+"([0-9]+)\\"+c.decimalSignFractional+"([0-9]+)$").exec(e),t){
const e=!!t[1],i=parseInt(t[2]),r=void 0!==this._minMove2?this._minMove2:NaN,s=this._priceScale/r,n=this._minMove2,o=this._patchFractPart(parseInt(t[3]),s),a=this._patchFractPart(parseInt(t[4]),n);if(o>=s||o<0)return{error:this._formatterErrors.fraction,res:!1};if(void 0!==n&&a>=n||a<0)return{error:this._formatterErrors.secondFraction,res:!1};let l=void 0!==n?i+o/s+a/(s*n):NaN;return e&&(l=-l),{value:l,res:!0,suggest:this.format(l)}}return{error:this._formatterErrors.custom,res:!1}}}},53371:(e,t,i)=>{"use strict";i.d(t,{QuoteSessionPriceFormatter:()=>s});var r=i(11228);class s{constructor(e){this.type="quoteSessionPrice",this.reset(e)}state(){return this._priceFormatter.state()}reset(e){this._priceFormatter=e||new r.PriceFormatter(100,1,!1)}update(e,t){const i=null!=t.pricescale||null!=t.minmov||null!=t.fractional||null!=t.minmove2,s=null!=e.pricescale&&null!=e.minmov&&null!=e.fractional&&null!=e.minmove2;i&&s&&(this._priceFormatter=new r.PriceFormatter(e.pricescale,e.minmov,e.fractional||!1,e.minmove2))}format(e,t,i){return this._priceFormatter.format(e,t,i)}hasForexAdditionalPrecision(){return this._priceFormatter.hasForexAdditionalPrecision()}static serialize(e){return e.state()}static deserialize(e){const t=new r.PriceFormatter(e.priceScale,e.minMove,e.fractional,e.minMove2);return new s(t)}}},79187:(e,t,i)=>{"use strict";function r(e){let t="";e<0&&(t="−",e=-e);const i=e.toString(),r=i.split(".")[1];let s=2;if(r){const e=r.match(/^([0]+)/);e&&(s=e[1].length+1)}return t+parseFloat(i).toFixed(s)}i.d(t,{roundToFirstValuable:()=>r})},15055:(e,t,i)=>{"use strict";i.d(t,{TimeFormatter:()=>s});var r=i(11228);class s{constructor(e){this._formatStr=e||"%h:%m:%s"}format(e){return r.customFormatters.timeFormatter?r.customFormatters.timeFormatter.format(e):this._formatStr.replace("%h",(0,r.numberToStringWithLeadingZero)(e.getUTCHours(),2)).replace("%m",(0,r.numberToStringWithLeadingZero)(e.getUTCMinutes(),2)).replace("%s",(0,r.numberToStringWithLeadingZero)(e.getUTCSeconds(),2))}formatLocal(e){return r.customFormatters.timeFormatter?r.customFormatters.timeFormatter.formatLocal?r.customFormatters.timeFormatter.formatLocal(e):r.customFormatters.timeFormatter.format(e):this._formatStr.replace("%h",(0,r.numberToStringWithLeadingZero)(e.getHours(),2)).replace("%m",(0,r.numberToStringWithLeadingZero)(e.getMinutes(),2)).replace("%s",(0,r.numberToStringWithLeadingZero)(e.getSeconds(),2))}}},76712:(e,t,i)=>{"use strict";i.d(t,{TimeSpanFormatter:()=>r});i(20220);class r{format(e){const t=e<0;e=Math.abs(e);const i=Math.floor(e/86400);e-=86400*i;const r=Math.floor(e/3600);e-=3600*r;const s=Math.floor(e/60);e-=60*s;let n="";return i&&(n+=i+window.t("d",{context:"dates"})+" "),r&&(n+=r+window.t("h",{context:"dates"})+" "),s&&(n+=s+window.t("m",{context:"dates"})+" "),e&&(n+=e+window.t("s",{context:"dates"})+" "),t&&(n="-"+n),n.trim()}}},81293:(e,t,i)=>{"use strict";i.d(t,{PLACE_HOLDER:()=>a,VolumeFormatter:()=>l});var r=i(20220),s=i(80790),n=i(31565),o=i(75496);const a="---";class l{constructor(e){this.type="volume",
this._numericFormatter=new s.NumericFormatter,this._fractionalValues=void 0!==e&&e>0,this._precision=e}state(){return{precision:this._precision}}format(e,t){if(!(0,n.isNumber)(e))return a;let i="";return e<0?(i="−",e=-e):e>0&&t&&(i="+"),e>=1e100?(0,r.t)("N/A"):(!this._fractionalValues||e>=995?e=Math.round(e):this._fractionalValues&&(e=+e.toFixed(this._precision)),e<995?i+this._formatNumber(e):e<999995?i+this._formatNumber(e/1e3)+"K":e<999999995?(e=1e3*Math.round(e/1e3),i+this._formatNumber(e/1e6)+"M"):e<999999999995?(e=1e6*Math.round(e/1e6),i+this._formatNumber(e/1e9)+"B"):(e=1e9*Math.round(e/1e9),i+this._formatNumber(e/1e12)+"T"))}parse(e){if("---"===e)return{error:"not a number",res:!1,value:NaN};const t={K:1e3,M:1e6,B:1e9},i=e.slice(-1);if(t.hasOwnProperty(i)){const r=this._numericFormatter.parse(e.slice(0,-1));return(0,n.isNumber)(r)?{res:!0,value:r*t[i]}:{error:"not a number",res:!1,value:NaN}}{const t=this._numericFormatter.parse(e);return(0,n.isNumber)(t)?{res:!0,value:t}:{error:"not a number",res:!1,value:NaN}}}static serialize(e){return e.state()}static deserialize(e){return new l(e.precision)}_formatNumber(e){return this._fractionalValues&&(e=(0,o.fixComputationError)(e)),this._numericFormatter.format(e).replace(/(\.[1-9]*)0+$/,(e,t)=>t)}}},18872:(e,t,i)=>{"use strict";i.d(t,{FutureBarsPaneView:()=>l});var r=i(16282),s=i(29295),n=i(46561);const o={0:{background:"rgba(255, 158, 171, 0.3)",line:"#7E202F"},1:{background:"rgba(244, 255, 158, 0.3)",line:"#EBFF3F"},2:{background:"rgba(195, 255, 160, 0.3)",line:"#308020"}};class a extends s.ScaledPaneRenderer{constructor(){super(...arguments),this._data=null}setData(e){this._data=e}hitTest(){return null}_drawImpl(e,t){if(null===this._data)return;const i=o[this._data.predictionCode];e.fillStyle=i.background,e.fillRect(Math.max(0,this._data.startX),0,t.cssWidth,t.cssHeight),e.strokeStyle=i.line,e.beginPath(),e.lineWidth=1;const r=Math.round(this._data.startX);e.moveTo(r,0),e.lineTo(r,t.cssHeight),e.stroke()}}class l{constructor(e,t,i,r){this._renderer=new a,this._startX=0,this._series=t,this._timeScale=e,this._lastKnownBarIndex=i,this._direction=r}update(){this._startX=this._timeScale.indexToCoordinate(this._lastKnownBarIndex)+.5*this._timeScale.barSpacing()+1}renderer(){const e=(0,n.barFunction)("close"),t=this._series.data().bars(),i=e((0,r.ensureNotNull)(t.valueAt(this._lastKnownBarIndex))),s=e((0,r.ensureNotNull)(t.last()).value);let o=0;s>i?o=1:s<i&&(o=2);let a=1;return 0!==this._direction&&(a=this._direction===o?2:0),this._renderer.setData({startX:this._startX,predictionCode:a}),this._renderer}}},11403:(e,t,i)=>{"use strict";i.d(t,{shouldBeFormattedAsPercent:()=>o,getPriceValueFormatterForSource:()=>a});var r=i(20554),s=i(88987);const n=(0,i(98006).isFeatureEnabled)("percentage_values_for_percentage_scale");function o(e){if(!n)return!1;const t=e.priceScale();return!(null===t||!t.isPercentage())&&(!(0,s.isSymbolSource)(e)||(0,r.isPriceSourceStyle)(e.style()))}function a(e){const t=e.priceScale();if(o(e)&&null!==t)return i=>{var r
;return t.formatPricePercentage(i,null!==(r=e.firstValue())&&void 0!==r?r:100)};const i=e.formatter();return i.format.bind(i)}},89532:(e,t,i)=>{"use strict";var r=i(70391).GridRenderer;function s(){this._id="grid",this.visible=!0,this.horzLinesVisible=!0,this.horzLinesColor="white",this.horzLinesStyle="",this.vertLinesVisible=!0,this.vertLinesColor="white",this.vertLinesStyle=""}function n(e,t){this.source=e,this.pane=t,this._renderer=new r}s.prototype.id=function(){return this._id},s.prototype.paneViews=function(e){return[new n(this,e)]},n.prototype.update=function(){},n.prototype.renderer=function(){var e={};return this.pane.defaultPriceScale().isEmpty()||this.pane.timeScale().isEmpty()?null:(e.horzLinesVisible=!0,e.vertLinesVisible=!0,e.horzLinesColor=this.pane._model.properties().paneProperties.horzGridProperties.color.value(),e.vertLinesColor=this.pane._model.properties().paneProperties.vertGridProperties.color.value(),e.horzLineStyle=this.pane._model.properties().paneProperties.horzGridProperties.style.value(),e.vertLineStyle=this.pane._model.properties().paneProperties.vertGridProperties.style.value(),e.priceMarks=this.pane.defaultPriceScale().marks(),e.timeMarks=this.pane.timeScale().marks(),e.w=this.pane.width(),e.h=this.pane.height(),this._renderer.setData(e),this._renderer)},t.Grid=s},62288:(e,t,i)=>{"use strict";function r(e,t,i){if(e.isTouch){if(void 0!==i)return i(e),!0}else if(void 0!==t)return t(e),!0;return!1}function s(e,t,i,r){return void 0!==t.executeDefaultAction&&(e.isTouch?Boolean(t.executeDefaultAction[r]):Boolean(t.executeDefaultAction[i]))}var n;i.d(t,{tryCallHandler:()=>r,shouldDefaultActionBeExecuted:()=>s,AreaName:()=>n,HitTestResult:()=>o}),function(e){e.Style="Style",e.Text="Text",e.SourceItemMove="SourceItemMove"}(n||(n={}));class o{constructor(e,t,i){this._result=e,this._data=t||null,this._eraseMarker=i}result(){return this._result}data(){return this._data}hasPressedMoveHandler(e){return null!==this._data&&function(e,t,i){if(e.isTouch){if(void 0!==i)return!0}else if(void 0!==t)return!0;return!1}(e,this._data.pressedMouseMoveHandler,this._data.touchMoveHandler)}tryCallMouseDownOrTouchStartHandler(e){return null!==this._data&&r(e,this._data.mouseDownHandler,this._data.touchStartHandler)}tryCallMouseUpOrTouchEndHandler(e){return null!==this._data&&r(e,this._data.mouseUpHandler,this._data.touchEndHandler)}tryCallMouseEnterHandler(e){return null!==this._data&&r(e,this._data.mouseEnterHandler)}tryCallMouseLeaveHandler(e){return null!==this._data&&r(e,this._data.mouseLeaveHandler)}tryCallMouseMoveHandler(e){return null!==this._data&&r(e,this._data.mouseMoveHandler)}tryCallClickOrTapHandler(e){return null!==this._data&&r(e,this._data.clickHandler,this._data.tapHandler)}tryCallDblClickOrDblTapHandler(e){return null!==this._data&&r(e,this._data.doubleClickHandler,this._data.doubleTapHandler)}tryCallContextMenuHandler(e){return null!==this._data&&r(e,this._data.contextMenuHandler,this._data.touchContextMenuHandler)}eraseMarker(){return this._eraseMarker}}o.MOVEPOINT_BACKGROUND=1,o.REGULAR=2,
o.MOVEPOINT=3,o.CHANGEPOINT=4,o.CUSTOM=5},17627:(e,t,i)=>{"use strict";i.d(t,{HorizontalLinePaneView:()=>n});var r=i(11258),s=i(3707);class n{constructor(){this._lineRendererData={y:0,color:"rgba(0, 0, 0, 0)",linewidth:1,linestyle:s.LINESTYLE_SOLID,visible:!1},this._lineRenderer=new r.HorizontalLineRenderer,this._invalidated=!0,this._lineRenderer.setData(this._lineRendererData)}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._lineRenderer}}},94209:(e,t,i)=>{"use strict";var r,s;i.d(t,{PositionPLDisplay:()=>r,TradingSourcesHorizontalAlignment:()=>s,tradingPreferencesDefault:()=>n,CustomSourceLayer:()=>o}),function(e){e[e.Money=0]="Money",e[e.Pips=1]="Pips",e[e.Percentage=2]="Percentage"}(r||(r={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(s||(s={}));const n={showPositions:!1,positionPL:{visibility:!1,display:r.Money},showOrders:!1,showExecutions:!1,showReverse:!1,showTPSL:!1,extendLeft:!1,horizontalAlignment:s.Right,lineWidth:0,lineStyle:0};var o;!function(e){e[e.Background=0]="Background",e[e.Foreground=1]="Foreground",e[e.Topmost=2]="Topmost"}(o||(o={}))},2459:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ResolutionKind:()=>n,SpecialResolutionKind:()=>o,Interval:()=>u,isHour:()=>h});const r=/^(\d*)([TSHDWMR])$/,s=/^(\d+)$/;var n,o;!function(e){e.Ticks="ticks",e.Seconds="seconds",e.Minutes="minutes",e.Days="days",e.Weeks="weeks",e.Months="months",e.Range="range",e.Invalid="invalid"}(n||(n={})),function(e){e.Hours="hours"}(o||(o={}));const a={};a[n.Ticks]=1e3,a[n.Seconds]=1e3,a[n.Minutes]=60*a[n.Seconds],a[n.Days]=1440*a[n.Minutes],a[n.Weeks]=7*a[n.Days];const l={T:n.Ticks,S:n.Seconds,D:n.Days,W:n.Weeks,M:n.Months,R:n.Range},c=new Set([n.Ticks,n.Seconds,n.Minutes]);class u{constructor(e,t){this._kind=n.Invalid,this._multiplier=0,e!==n.Invalid&&t>0&&(this._kind=e,this._multiplier=t)}kind(){return this._kind}multiplier(){return this._multiplier}isValid(){return this.kind()!==n.Invalid&&this.multiplier()>0}isDWM(){return this.isValid()&&!this.isRange()&&!this.isIntraday()&&!this.isTicks()}isIntraday(){const e=c.has(this.kind());return this.isValid()&&e}isSeconds(){return this.kind()===n.Seconds}isMinutes(){return this.kind()===n.Minutes}isMinuteHours(){return this.kind()===n.Minutes&&h(this.multiplier())}isDays(){return this.kind()===n.Days}isWeeks(){return this.kind()===n.Weeks}isMonths(){return this.kind()===n.Months}isRange(){return this.kind()===n.Range}isTicks(){return this.kind()===n.Ticks}isTimeBased(){return!this.isRange()}letter(){return this.isValid()&&this.kind()!==n.Minutes?this.kind()[0].toUpperCase():""}value(){return this.isValid()?this.kind()===n.Minutes?this.multiplier()+"":this.multiplier()+this.letter():""}isEqualTo(e){if(!(e instanceof u))throw new Error("Argument is not an Interval");return!(!this.isValid()||!e.isValid())&&(this.kind()===e.kind()&&this.multiplier()===e.multiplier())}inMilliseconds(e=Date.now()){if(!this.isValid()||this.isRange())return NaN;if(this.isMonths()){const t=new Date(e)
;t.setUTCMonth(t.getUTCMonth()+(this.multiplier()||1));return+t-e}const t=this.multiplier();return a[this.kind()]*t}static isEqual(e,t){return e===t||u.parse(e).isEqualTo(u.parse(t))}static parse(e){e=(e+"").toUpperCase().split(",")[0];let t=r.exec(e);return null!==t?"H"===t[2]?new u(n.Minutes,60*d(t[1])):new u(l[t[2]],d(t[1])):(t=s.exec(e),null!==t?new u(n.Minutes,d(t[1])):new u(n.Invalid,0))}static kind(e){return u.parse(e).kind()}static isValid(e){return u.parse(e).isValid()}static isDWM(e){return u.parse(e).isDWM()}static isIntraday(e){return u.parse(e).isIntraday()}static isSeconds(e){return u.parse(e).isSeconds()}static isMinutes(e){return u.parse(e).isMinutes()}static isMinuteHours(e){return u.parse(e).isMinuteHours()}static isDays(e){return u.parse(e).isDays()}static isWeeks(e){return u.parse(e).isWeeks()}static isMonths(e){return u.parse(e).isMonths()}static isRange(e){return u.parse(e).isRange()}static isTicks(e){return u.parse(e).isTicks()}static isTimeBased(e){return u.parse(e).isTimeBased()}static normalize(e){const t=u.parse(e);return t.isValid()?t.value():null}}function d(e){return 0===e.length?1:parseInt(e,10)}function h(e){return e>=60&&!(e%60)}},45087:(e,t,i)=>{"use strict";i.d(t,{intervalsVisibilitiesDefaults:()=>r});const r={ticks:!0,seconds:!0,secondsFrom:1,secondsTo:59,minutes:!0,minutesFrom:1,minutesTo:59,hours:!0,hoursFrom:1,hoursTo:24,days:!0,daysFrom:1,daysTo:366,weeks:!0,weeksFrom:1,weeksTo:52,months:!0,monthsFrom:1,monthsTo:12,ranges:!0}},57415:(e,t,i)=>{"use strict";i.d(t,{IntervalsVisibilitiesProperty:()=>l});var r=i(27937),s=i.n(r),n=i(98006),o=i(53423);const a=(0,n.isFeatureEnabled)("store_only_non_default_interval_visibilities");class l extends(s()){state(e){var t;return a?null!==(t=(0,o.nonDefaultIntervalsVisibilities)(super.state(e)))&&void 0!==t?t:void 0:super.state(e)}storeStateIfUndefined(){return!1}}},53423:(e,t,i)=>{"use strict";i.d(t,{makeIntervalsVisibilitiesVisibleAtInterval:()=>a,isActualInterval:()=>c,nonDefaultIntervalsVisibilities:()=>u,mergeIntervalVisibilitiesDefaults:()=>d});var r=i(16282),s=i(2459),n=i(45087),o=i(31565);function a(e,t){let i=t.multiplier();if(t.isTicks()&&(e.ticks=!0),t.isSeconds()&&(i<60?(e.seconds=!0,e.secondsFrom=Math.min(e.secondsFrom,i),e.secondsTo=Math.max(e.secondsTo,i)):(i/=60,t=new s.Interval(s.ResolutionKind.Minutes,i))),t.isMinutes())if(i<60)e.minutes=!0,e.minutesFrom=Math.min(e.minutesFrom,i),e.minutesTo=Math.max(e.minutesTo,i);else{const t=Math.floor(i/60);e.hours=!0,e.hoursFrom=Math.min(e.hoursFrom,t),e.hoursTo=Math.max(e.hoursTo,t)}t.isDays()&&(e.days=!0,e.daysFrom=Math.min(e.daysFrom,i),e.daysTo=Math.max(e.daysTo,i)),t.isWeeks()&&(e.weeks=!0,e.weeksFrom=Math.min(e.weeksFrom,i),e.weeksTo=Math.max(e.weeksTo,i)),t.isMonths()&&(e.months=!0,e.monthsFrom=Math.min(e.monthsFrom,i),e.monthsTo=Math.max(e.monthsTo,i)),t.isRange()&&(e.ranges=!0)}function l(e,t,i,r){return e&&r>=t&&r<=i}function c(e,t){const i=t.childs();switch(e.kind()){case s.ResolutionKind.Ticks:return i.ticks.value();case s.ResolutionKind.Seconds:
if(e.multiplier()<60)return l(i.seconds.value(),i.secondsFrom.value(),i.secondsTo.value(),e.multiplier());{const t=Math.floor(e.multiplier()/60);return l(i.minutes.value(),i.minutesFrom.value(),i.minutesTo.value(),t)}case s.ResolutionKind.Minutes:if(e.multiplier()<60)return l(i.minutes.value(),i.minutesFrom.value(),i.minutesTo.value(),e.multiplier());{const t=Math.floor(e.multiplier()/60);return l(i.hours.value(),i.hoursFrom.value(),i.hoursTo.value(),t)}case s.ResolutionKind.Days:return l(i.days.value(),i.daysFrom.value(),i.daysTo.value(),e.multiplier());case s.ResolutionKind.Weeks:return l(i.weeks.value(),i.weeksFrom.value(),i.weeksTo.value(),e.multiplier());case s.ResolutionKind.Months:return l(i.months.value(),i.monthsFrom.value(),i.monthsTo.value(),e.multiplier());case s.ResolutionKind.Range:return i.ranges.value()}return(0,r.assert)(!1,"Unsupported resolution: "+e.value()),!1}function u(e){const t=Object.keys(e).filter(t=>n.intervalsVisibilitiesDefaults[t]!==e[t]);return 0===t.length?null:t.reduce((t,i)=>(t[i]=e[i],t),{})}function d(e){return(0,o.merge)((0,o.clone)(n.intervalsVisibilitiesDefaults),null!=e?e:{})}},68793:(e,t,i)=>{"use strict";function r(e){return Boolean(e.showInObjectTree)}i.d(t,{isDataSource:()=>r})},21218:(e,t,i)=>{"use strict";var r;i.d(t,{SymbolErrorPermissionDeniedReason:()=>r,permissionDenied:()=>s}),function(e){e.Symbol="symbol",e.GroupPermission="group"}(r||(r={}));const s="permission denied"},88987:(e,t,i)=>{"use strict";function r(e){return e.symbolSource&&e.symbolSource()===e}i.d(t,{isSymbolSource:()=>r})},23576:(e,t,i)=>{"use strict";var r,s=i(16282).ensureNotNull,n=i(72927).Point,o=i(26184).SelectionRenderer,a=i(62288).HitTestResult,l=i(26254).PaneRendererRenkoPB,c=i(9962).PaneRendererKagi,u=i(63470).PaneRendererPnF,d=i(30807).PaneRendererBars,h=i(56288).CompositeRenderer,p=i(5722).SelectionIndexes,_=i(87380).getLogger("Chart.JapaneseSeriesPaneView"),m=i(22842);function f(e,t){this.m_series=e,this.m_model=t,this.m_bars=[],this._invalidated=!0,this._isMarkersEnabled=m.enabled("source_selection_markers"),this._selectionIndexer=new p(t.timeScale())}function g(e,t){f.call(this,e,t)}function v(e,t){f.call(this,e,t)}function S(e,t){g.call(this,e,t)}function y(e,t){v.call(this,e,t)}function b(e,t){g.call(this,e,t)}function w(e,t){v.call(this,e,t)}function P(e,t){g.call(this,e,t)}function C(e,t){v.call(this,e,t)}function T(e,t){g.call(this,e,t)}function x(e,t){v.call(this,e,t)}f.prototype.bars=function(){throw new Error("unimplemented")},f.prototype.isProjection=function(){throw new Error("unimplemented")},f.prototype.update=function(){this._invalidated=!0},f.prototype.nearestIndex=function(e,t){if(TradingView.isInteger(e)){var i=this.bars().search(e,t);return null!==i?i.index:void 0}_.logDebug("incorrect logicalPoint")},f.prototype._updateImpl=function(){var e=this;if((this.m_bars.length=0,
this.m_series.properties().style.value()!==TradingView.Series.STYLE_PNF||this.m_series.data().boxSize)&&(!this.m_model.timeScale().isEmpty()&&!this.m_series.priceScale().isEmpty()&&null!==(o=this.m_series.getRealVisibleRange())&&0!==this.bars().size()&&!e.m_series.data().bars().isEmpty())){for(var t=o.firstBar(),i=o.lastBar(),r=this.m_series.data().search(t).value[TradingView.CLOSE_PLOT];t<=i;t++){if(null!==this.bars().valueAt(t))break}if(!(t>i)){var o=this.bars().range(t,i),l=this.m_series.priceScale(),c=this.m_series.barColorer(),u={},d=e.m_series.properties().style.value(),h=d===TradingView.Series.STYLE_KAGI||d===TradingView.Series.STYLE_PNF,p=e.isProjection(),_=s(e.m_series.data().bars().lastIndex());if(o.each((function(t,i){if(void 0!==i[TradingView.OPEN_PLOT]&&void 0!==i[TradingView.HIGH_PLOT]&&void 0!==i[TradingView.LOW_PLOT]&&void 0!==i[TradingView.CLOSE_PLOT]){var r={},s={O:i[TradingView.OPEN_PLOT],H:i[TradingView.HIGH_PLOT],L:i[TradingView.LOW_PLOT],C:i[TradingView.CLOSE_PLOT],Adt:h?i[TradingView.ADT_PLOT]:void 0};r.time=Math.round(t),r.open=s.O,r.high=s.H,r.low=s.L,r.close=s.C,u.value=i;var n=c.barStyle(t,p,u);switch(u.previousValue=i,r.color=n.barColor,r.borderColor=n.barBorderColor,r.isUp=n.isBarUp,r.wickColor=n.barWickColor,d){case TradingView.Series.STYLE_PNF:r.low-=.5*e.m_series.data().boxSize,r.high+=.5*e.m_series.data().boxSize,r.upColor=n.upColor,r.downColor=n.downColor,r.isMergedBar=n.isMergedBar,r.additionalNum=Math.round(1+(i[TradingView.HIGH_PLOT]-i[TradingView.LOW_PLOT])/e.m_series.data().boxSize);break;case TradingView.Series.STYLE_KAGI:if(r.upColor=n.upColor,r.downColor=n.downColor,r.isTwoColorBar=n.isTwoColorBar,!isNumber(s.Adt))break;r.additionalPrice=s.Adt,p&&r.time===_&&(r.combinedWithProjection=!0)}e.m_bars.push(r)}}),this),d===TradingView.Series.STYLE_PNF&&(this.blockSize=(l.priceToCoordinate(0,r)-l.priceToCoordinate(500,r))/500*this.m_series.data().boxSize),l.barPricesToCoordinates(this.m_bars,r),this.m_model.timeScale().barIndexesToCoordinates(this.m_bars),this.m_model.selection().isSelected(this.m_series)){var m=this._selectionIndexer.indexes();this._selectionData={points:[],bgColors:[],visible:!0};var f=this.m_model.paneForSource(this.m_series).height();this._selectionData.hittestResult=a.REGULAR;for(var g=0;g<m.length;g++){var v=m[g],S=this.m_series.bars().valueAt(v);if(null!==S){var y=.5*(S[TradingView.OPEN_PLOT]+S[TradingView.CLOSE_PLOT]),b=this.m_model.timeScale().indexToCoordinate(v),w=this.m_series.priceScale().priceToCoordinate(y,r);this._selectionData.points.push(new n(b,w)),this._selectionData.bgColors.push(this.m_model.backgroundColorAtYPercentFromTop(w/f))}}}else this._selectionIndexer.clear()}}},f.prototype.items=function(){return this.m_bars},inherit(g,f),g.prototype.bars=function(){return this.m_series.bars()},g.prototype.isProjection=function(){return!1},inherit(v,f),v.prototype.bars=function(){return this.m_series.nsBars()},v.prototype.isProjection=function(){return!0},inherit(S,g),S.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),
this._invalidated=!1);var e={};e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing();var t=new h;return t.append(new l(e)),this.m_model.selection().isSelected(this.m_series)&&this._isMarkersEnabled&&t.append(new o(this._selectionData)),t},inherit(y,v),y.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};return e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing(),new l(e)},r=function(e,t){v.call(this,e,t)},inherit(r,v),r.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};return e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing(),e.thinBars=this.m_series.properties().rangeStyle.thinBars.value(),new d(e)},inherit(b,g),b.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};e.bars=this.m_bars,e.barSpacing=.9*this.m_model.timeScale().barSpacing();var t=new h;return t.append(new l(e)),this.m_model.selection().isSelected(this.m_series)&&this._isMarkersEnabled&&t.append(new o(this._selectionData)),t},inherit(w,v),w.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};return e.bars=this.m_bars,e.barSpacing=.9*this.m_model.timeScale().barSpacing(),new l(e)},inherit(P,g),P.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing();var t=new h;return t.append(new c(e)),this.m_model.selection().isSelected(this.m_series)&&this._isMarkersEnabled&&t.append(new o(this._selectionData)),t},inherit(C,v),C.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};return e.bars=this.m_bars,e.upColor=this.upColor,e.downColor=this.downColor,e.barSpacing=this.m_model.timeScale().barSpacing(),new c(e)},inherit(T,g),T.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};e.bars=this.m_bars,e.blockSize=this.blockSize,e.barSpacing=this.m_model.timeScale().barSpacing();var t=new h;return t.append(new u(e)),this.m_model.selection().isSelected(this.m_series)&&this._isMarkersEnabled&&t.append(new o(this._selectionData)),t},inherit(x,v),x.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};return e.bars=this.m_bars,e.blockSize=this.blockSize,e.barSpacing=this.m_model.timeScale().barSpacing(),new u(e)},t.SeriesRenkoPaneView=S,t.SeriesProjectionRenkoPaneView=y,t.SeriesPriceBreakPaneView=b,t.SeriesProjectionPriceBreakPaneView=w,t.SeriesKagiPaneView=P,t.SeriesProjectionKagiPaneView=C,t.SeriesPnFPaneView=T,t.SeriesProjectionPnFPaneView=x,t.SeriesProjectionRangePaneView=r},92372:(e,t,i)=>{"use strict";var r=i(27937),s=i(31565).isSameType,n=i(1771).DefaultProperty;function o(e,t,i,r){this._map=Object.assign({},this._map,r),t&&(t=this.unpackLevels(t)),n.call(this,e,t,i)}inherit(o,n),o.prototype.state=function(e,t){e=e||[];var i=r.prototype.state.call(this,e)
;return t?i:this.packLevels(i)},o.prototype.clone=function(){for(var e=this.state(),t=new o(this._defaultName,e),i=0;i<this._exclusions.length;++i)t.addExclusion(this._exclusions[i]);return t},o.prototype.merge=function(e,t){return r.prototype.merge.call(this,this.unpackLevels(e),t)},o.prototype._map={prefixes:[""],range:[0,0],names:["coeff","color","visible","linestyle","linewidth"],typecheck:{pack:Object,unpack:Array}},o.prototype._packLvlTpl=function(){return[]},o.prototype._unpackLvlTpl=function(){return{}},o.prototype._packLvlFill=function(e,t,i,r){return r.push(i[t]),r},o.prototype._unpackLvlFill=function(e,t,i,r){return r[t]=i[e],r},o.prototype._iterateLevels=function(e,t){for(var i in this._map.prefixes)for(var r=(this._map.prefixes[i]||"")+"level",n=this._map.range[0];n<=this._map.range[1];n++)if(e[r+n]&&s(e[r+n],t.typecheck())){var o=t.tpl();for(var a in this._map.names)o=t.fill(a,this._map.names[a],e[r+n],o);e[r+n]=o}return e},o.prototype.packLevels=function(e){return this._iterateLevels(e,{tpl:this._packLvlTpl,fill:this._packLvlFill,typecheck:this._map.typecheck.pack})},o.prototype.unpackLevels=function(e){return this._iterateLevels(e,{tpl:this._unpackLvlTpl,fill:this._unpackLvlFill,typecheck:this._map.typecheck.unpack})},o.prototype.saveDefaults=function(){TradingView.saveDefaults(this._defaultName,this.state(this._exclusions,!0))},e.exports=o},60621:(e,t,i)=>{"use strict";i.d(t,{LineToolsGroupModel:()=>o});var r=i(96276),s=i.n(r),n=i(89931);class o{constructor(e){this._onChanged=new(s()),this._groups=[],this._groups=e||[],this._groups.forEach(e=>{e.onChanged().subscribe(null,t=>this._onChanged.fire(e.id,t))})}groups(){return this._groups.filter(e=>e.isActualSymbol())}groupsForAllSymbols(){return this._groups}createGroup(e,t,i){t=t||this._generateNextName();const r=new n.LineToolsGroup(e,t,i);this._groups.push(r),r.onChanged().subscribe(null,e=>this._onChanged.fire(r.id,e));const s={visibilityChanged:!1,lockedChanged:!1,titleChanged:!1,isActualIntervalChanged:!1,affectedLineTools:e.map(e=>e.id())};return this._onChanged.fire(r.id,s),r}addGroup(e){this._groups.push(e),e.onChanged().subscribe(null,t=>this._onChanged.fire(e.id,t)),this._onChanged.fire(e.id)}removeGroup(e){const t=this._groups.findIndex(t=>t.id===e.id);this._groups.splice(t,1),this._onChanged.fire(e.id)}groupForId(e){return this._groups.find(t=>t.id===e)||null}groupForLineTool(e){return this._groups.find(t=>t.containsLineTool(e))||null}removeLineTools(e){this._groups.forEach(t=>{const i=e.filter(t.containsLineTool.bind(t));i.length&&t.excludeLineTools(i)});this._groups.filter(e=>0===e.lineTools().length).forEach(e=>this.removeGroup(e))}state(e){return{groups:(e?this._groups.filter(e=>e.isActualSymbol()):this._groups).map(e=>e.state())}}onChanged(){return this._onChanged}fireChangedAll(){this._groups.forEach(e=>{this._onChanged.fire(e.id)})}static fromState(e,t){const i=[];for(const r of t.groups){const t=n.LineToolsGroup.fromState(e,r);null!==t&&i.push(t)}return new o(i)}_generateNextName(){const e=new Set(this.groups().map(e=>e.name()))
;for(let t=1;;t++){const i="Group "+t,r="Group_"+t;if(!e.has(i)&&!e.has(r))return i}}}},89931:(e,t,i)=>{"use strict";i.d(t,{LineToolsGroup:()=>l});var r=i(96276),s=i.n(r),n=i(75443);function o(e){return e.properties().visible.value()}function a(e){return!o(e)}class l{constructor(e,t,i){this._instanceId=(0,n.randomHashN)(6),this._onChanged=new(s()),this._lineToolsSet=new Set,this._lineTools=[...e],this._lineToolsSet=new Set(this._lineTools),this._name=t,this.id=i||(0,n.randomHashN)(6)}instanceId(){return this._instanceId}lineTools(){return this._lineTools}name(){return this._name}setName(e){this._doAndFireOnChange(()=>{this._name=e})}isActualSymbol(){return this._lineTools.length>0&&this._lineTools[0].isActualSymbol()&&this._lineTools[0].isActualCurrency()&&this._lineTools[0].isActualUnit()}symbol(){return this._lineTools[0].symbol()}currencyId(){var e;return null!==(e=this._lineTools[0].properties().childs().currencyId.value())&&void 0!==e?e:null}unitId(){var e;return null!==(e=this._lineTools[0].properties().childs().unitId.value())&&void 0!==e?e:null}containsLineTool(e){return this._lineToolsSet.has(e)}addLineTools(e){this._doAndFireOnChange(t=>{e.forEach(e=>this._lineToolsSet.add(e)),this._lineTools.push(...e),t.push(...e.map(e=>e.id()))})}excludeLineTool(e){this._doAndFireOnChange(t=>{this._lineToolsSet.delete(e);const i=this._lineTools.indexOf(e);this._lineTools.splice(i,1),t.push(e.id())})}excludeLineTools(e){this._doAndFireOnChange(t=>{const i=new Set(e);e.forEach(e=>this._lineToolsSet.delete(e)),this._lineTools=this._lineTools.filter(e=>!i.has(e)),t.push(...e.map(e=>e.id()))})}state(){return{id:this.id,name:this._name,tools:this._lineTools.map(e=>e.id())}}visibility(){const e=this._lineTools.some(o),t=this._lineTools.some(a);return e&&!t?"Visible":t&&!e?"Invisible":"Partial"}locked(){const e=this._lineTools.some(e=>e.properties().frozen.value()),t=this._lineTools.some(e=>!e.properties().frozen.value());return e&&!t?"Locked":t&&!e?"Unlocked":"Partial"}isActualInterval(){const e=this._lineTools.some(e=>e.isActualInterval()),t=this._lineTools.some(e=>!e.isActualInterval());return e&&!t?"IsActualInterval":t&&!e?"IsNotActualInterval":"Partial"}onChanged(){return this._onChanged}static fromState(e,t){const i=[];for(const r of t.tools){const t=e.dataSourceForId(r);null!==t&&i.push(t)}return i.length>0?new l(i,t.name,t.id):null}_doAndFireOnChange(e){const t=[],i=this.visibility(),r=this.locked(),s=this.name(),n=this.isActualInterval();e(t),this._onChanged.fire({affectedLineTools:t,visibilityChanged:i!==this.visibility(),lockedChanged:r!==this.locked(),titleChanged:s!==this.name(),isActualIntervalChanged:n!==this.isActualInterval()})}}},83944:(e,t,i)=>{"use strict";i.d(t,{LineTool5PointsPattern:()=>a});var r=i(16282),s=i(1771),n=i(73371),o=i(22756);class a extends n.LineDataSource{constructor(e,t){super(e,t||a.createProperties()),this._loadPaneViews(e)}pointsCount(){return 5}name(){return"XABCD Pattern"}static createProperties(e){const t=new s.DefaultProperty("linetool5pointspattern",e)
;return a._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,12162)).then(e=>e.PatternWithBackgroundDefinitionViewModel)}_loadPaneViews(e){Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,51963)).then(t=>{this._setPaneViews([new t.Pattern5pointsPaneView(this,e)])})}static _configureProperties(e){n.LineDataSource._configureProperties(e),e.addChild("linesColors",new o.LineToolColorsProperty([(0,r.ensureDefined)(e.child("color"))])),e.addChild("textsColors",new o.LineToolColorsProperty([(0,r.ensureDefined)(e.child("textcolor"))]))}}},82394:(e,t,i)=>{"use strict";i.d(t,{LineToolABCD:()=>a});var r=i(16282),s=i(1771),n=i(73371),o=i(22756);class a extends n.LineDataSource{constructor(e,t){const r=t||a.createProperties();super(e,r),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,35475)).then(t=>{this._setPaneViews([new t.ABCDPaneView(this,e)])})}pointsCount(){return 4}name(){return"ABCD Pattern"}static createProperties(e){const t=new s.DefaultProperty("linetoolabcd",e);return a._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,32172)).then(e=>e.PatternWithoutBackgroundDefinitionsViewModel)}static _configureProperties(e){n.LineDataSource._configureProperties(e),e.addChild("linesColors",new o.LineToolColorsProperty([(0,r.ensureDefined)(e.child("color"))])),e.addChild("textsColors",new o.LineToolColorsProperty([(0,r.ensureDefined)(e.child("textcolor"))]))}}},77453:(e,t,i)=>{"use strict";var r=i(72927).Point,s=i(89684).distanceToLine,n=i(51102),o=n.rotationMatrix,a=n.scalingMatrix,l=n.translationMatrix,c=n.transformPoint,u=i(73371).LineDataSource,d=i(1771).DefaultProperty,h=i(22756).LineToolColorsProperty;class p extends u{constructor(e,t){super(e,t||p.createProperties()),this.version=p.version,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,43860,19)).then(({ArcPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}startChanging(e,t){if(super.startChanging(e,t),0===e||1===e){var i=this.pointToScreenPoint(this._points[0])[0],n=this.pointToScreenPoint(this._points[1])[0],o=this.pointToScreenPoint(this._points[2])[0];this._dist=s(i,n,o).distance;var a=n.subtract(i),l=new r(-a.y,a.x),c=i.add(n).scaled(.5);o.subtract(c).dotProduct(l)<0&&(this._dist=-this._dist)}}pointsCount(){return 3}name(){return"Arc"}hasEditableCoordinates(){return!1}setPoint(e,t){var i=Object.assign({},t),n=this.pointToScreenPoint(this._points[0])[0],u=this.pointToScreenPoint(this._points[1])[0],d=this.pointToScreenPoint(this._points[2])[0];switch(e){case 0:n=this.pointToScreenPoint(i)[0];var h=u.subtract(n),p=n.add(u).scaled(.5);m=(m=new r(-h.y,h.x)).normalized(),d=p.add(m.scaled(this._dist)),d=this.screenPointToPoint(d),this._points[0]=i,this._points[2]=d;break;case 1:var _=s(n,u,d).distance;h=(u=this.pointToScreenPoint(i)[0]).subtract(n),p=n.add(u).scaled(.5)
;m=(m=new r(-h.y,h.x)).normalized(),d=p.add(m.scaled(this._dist)),d=this.screenPointToPoint(d),this._points[1]=i,this._points[2]=d;break;case 2:i=this.pointToScreenPoint(i)[0];var m;_=s(n,u,i).distance,h=u.subtract(n),p=n.add(u).scaled(.5);m=(m=new r(-h.y,h.x)).normalized(),d=p.add(m.scaled(_));var f=p.add(m.scaled(-_)),g=h.length(),v=h.x/g,S=h.y/g,y=Math.acos(v);S<0&&(y=-y);var b=l(-p.x,-p.y);i=c(b,i);var w=c(b,d);b=o(-y),i=c(b,i),w=c(b,w),b=a(1,g/(2*_)),i=c(b,i),w=c(b,w);var P=i.y*w.y>=0?new r(d.x,d.y):new r(f.x,f.y);P=this.screenPointToPoint(P),this._points[2]=P}this.normalizePoints()}migrateVersion(e,t,i){if(1===e&&2===this._points.length){var r=(2*this._points[0].price+3*this._points[1].price)/5;this._points.append({price:r,index:this._points[1].index})}if(1===e&&2===this._timePoint.length){var s={price:r=(2*this._timePoint[0].price+3*this._timePoint[1].price)/5,offset:this._timePoint[1].offset,time_t:this._timePoint[1].time_t};this._timePoint.append(s)}}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,96088))).GeneralFiguresDefinitionsViewModel}static createProperties(e){var t=new d("linetoolarc",e);return p._configureProperties(t),t}static _configureProperties(e){u._configureProperties(e),e.addChild("linesColors",new h([e.color]))}}p.version=2,t.LineToolArc=p},3914:(e,t,i)=>{"use strict";i.d(t,{LineToolArrowMark:()=>l,LineToolArrowMarkLeft:()=>c,LineToolArrowMarkUp:()=>u,LineToolArrowMarkRight:()=>d,LineToolArrowMarkDown:()=>h});var r=i(1771),s=i(73371),n=i(27937),o=i.n(n),a=i(22756);class l extends s.LineDataSource{constructor(e,t,r){const s=t||l.createProperties(null,r);super(e,s),this._textPaneView=null,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,21143)).then(({ArrowMarkPaneView:t})=>{const i=[new t(this,e)];this._setPaneViews(i)})}paneViews(e){const t=super.paneViews();return null!==t&&this._textPaneView&&t.push(this._textPaneView),t}pointsCount(){return 1}template(){const e=super.template();return e.text=this.properties().childs().text.value(),e}static createProperties(e,t){const i=new r.DefaultProperty(t,e);return l._configureProperties(i),i}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,17983)).then(e=>e.ArrowMarkDefinitionsViewModel)}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text)}static _configureProperties(e){s.LineDataSource._configureProperties(e),e.addChild("linesColors",new a.LineToolColorsProperty([e.childs().arrowColor])),e.addChild("textsColors",new a.LineToolColorsProperty([e.childs().color])),e.hasChild("text")||e.addChild("text",new(o())("")),e.addExclusion("text")}}l.version=2;class c extends l{constructor(e,t){super(e,t,"linetoolarrowmarkleft")}direction(){return"left"}name(){return"Arrow Mark Left"}textAlignParams(){return{horzAlign:"left",vertAlign:"middle",offsetX:22,offsetY:3}}static createProperties(e){
return l.createProperties(e,"linetoolarrowmarkleft")}}class u extends l{constructor(e,t){super(e,t,"linetoolarrowmarkup")}direction(){return"up"}name(){return"Arrow Mark Up"}textAlignParams(){return{horzAlign:"center",vertAlign:"top",offsetX:0,offsetY:20}}static createProperties(e){return l.createProperties(e,"linetoolarrowmarkup")}}class d extends l{constructor(e,t){super(e,t,"linetoolarrowmarkright")}direction(){return"right"}name(){return"Arrow Mark Right"}textAlignParams(){return{horzAlign:"right",vertAlign:"middle",offsetX:22,offsetY:3,forceTextAlign:!0}}static createProperties(e){return l.createProperties(e,"linetoolarrowmarkright")}}class h extends l{constructor(e,t){super(e,t,"linetoolarrowmarkdown")}direction(){return"down"}name(){return"Arrow Mark Down"}textAlignParams(){return{horzAlign:"center",vertAlign:"bottom",offsetX:0,offsetY:20}}static createProperties(e){return l.createProperties(e,"linetoolarrowmarkdown")}}},83076:(e,t,i)=>{"use strict";i.d(t,{LineToolArrowMarker:()=>a});var r=i(73371),s=i(1771),n=i(27937),o=i.n(n);class a extends r.LineDataSource{constructor(e,t){super(e,t||a.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,3994)).then(({ArrowMarkerPaneView:e})=>{this._setPaneViews([new e(this,this.model())])})}pointsCount(){return 2}name(){return"Trend Line"}static createProperties(e){const t=new s.DefaultProperty("linetoolarrowmarker",e);return a._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,58192)).then(e=>e.ArrowMarkerDefinitionsViewModel)}static _configureProperties(e){r.LineDataSource._configureProperties(e),e.hasChild("text")||e.addChild("text",new(o())("")),e.addExclusion("text")}}},8556:(e,t,i)=>{"use strict";var r=i(35200).LineToolTrendLine,s=i(1771).DefaultProperty;class n extends r{constructor(e,t){super(e,t||n.createProperties())}name(){return"Arrow"}static createProperties(e){var t=new s("linetoolarrow",e);return n._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e)}}t.LineToolArrow=n},86738:(e,t,i)=>{"use strict";i.d(t,{LineToolBalloon:()=>u});var r=i(20220),s=i(1771),n=i(73371),o=i(27937),a=i.n(o),l=i(22756);const c=(0,r.t)("Comment");class u extends n.LineDataSource{constructor(e,t){const r=t||u.createProperties();super(e,r),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,34923)).then(t=>{this._setPaneViews([new t.BalloonPaneView(this,e)])})}pointsCount(){return 1}name(){return"Balloon"}template(){const e=super.template();return e.text=this.properties().childs().text.value(),e}static createProperties(e){const t=new s.DefaultProperty("linetoolballoon",e);return u._configureProperties(t),t}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text)}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,83729)).then(e=>e.BalloonDefinitionsViewModel)}
static _configureProperties(e){n.LineDataSource._configureProperties(e),e.hasChild("text")||e.addChild("text",new(a())(c)),e.addExclusion("text"),e.addChild("linesColors",new l.LineToolColorsProperty([e.childs().borderColor])),e.addChild("textsColors",new l.LineToolColorsProperty([e.childs().color]))}}},45963:(e,t,i)=>{"use strict";i.d(t,{BarMarksTooltip:()=>o});var r=i(16282);function s(e,t,i){return new Promise(r=>{i&&e.classList.remove(i),e.classList.add(t);const s=i=>{i.target===e&&i.animationName===t&&(e.removeEventListener(i.type,s),r(i))};e.addEventListener("animationend",s,!1),e.addEventListener("webkitAnimationEnd",s,!1),e.addEventListener("MSAnimationEnd",s,!1)})}function n(e){return s(e,"tv-transition--fade-in","tv-transition--fade-out")}class o{constructor(){this._source=null,this._tooltipHovered=!1,this._layout=null,this._container=null,this._context=null,this._plateArrowSize=14,this._handleTouchMouseLeave=e=>{(0,r.ensureNotNull)(this._layout).contains(e.target)||this._clearHovered()},this._setHovered=()=>{this._tooltipHovered=!0,document.addEventListener("touchstart",this._handleTouchMouseLeave),n((0,r.ensureNotNull)(this._layout))},this._clearHovered=()=>{var e;this._tooltipHovered=!1,document.removeEventListener("touchstart",this._handleTouchMouseLeave),null===(e=this._source)||void 0===e||e.onNeedRepaint.fire()}}showPlate(e,t){if(this._currentId!==e.id||!this._layout||null===this._layout.parentNode){this._currentId=e.id,this._createLayout();const i=(0,r.ensureNotNull)(this._layout);this._getContainer(t).appendChild(i),i.addEventListener("mouseenter",this._setHovered),i.addEventListener("mouseleave",this._clearHovered)}const i=(0,r.ensureNotNull)(this._layout);let s=Math.round(e.barWidth/2);s>15&&(s=15),s<10&&(s=10),this._updatePlate(e);const n=t.canvas.getBoundingClientRect(),o=e.x-i.offsetWidth<this._plateArrowSize;let a=n.width-e.x+Math.round(e.barWidth/2+s);o&&(a-=i.offsetWidth+2*this._plateArrowSize);const l=n.height,c=Math.min(Math.max(e.y,20),l-i.offsetHeight-10)+"px";i.classList.toggle("right",o),i.style.display="block",i.style.top=c,i.style.right=a+"px",i.style.fontSize=s+"px"}hide(e){const t=(0,r.ensureNotNull)(this._layout);var i;this._tooltipHovered?n(t):(i=t,s(i,"tv-transition--fade-out","tv-transition--fade-in")).then(()=>{t.remove(),e()})}setSource(e){this._source=e}removeLayout(){var e;this._tooltipHovered||null===(e=this._layout)||void 0===e||e.remove()}toggleLayout(e){(0,r.ensureNotNull)(this._layout).style.visibility=e?"visible":"hidden"}_getContainer(e){return this._container&&this._context===e||(this._context=e,this._container=e.canvas.parentElement),(0,r.ensureNotNull)(this._container)}}},96238:(e,t,i)=>{"use strict";i.d(t,{BarsMarksContainer:()=>T});var r=i(16282),s=i(87380),n=i(42098),o=i.n(n),a=i(22842),l=i(73371),c=i(96276),u=i.n(c),d=i(2459),h=i(31565),p=i(20554);class _{constructor(e,t){this.source=e,this._rendererFactory=t}update(){}renderer(e,t){return this._rendererFactory(this.source)}}var m=i(29295),f=i(39304),g=i(72927),v=i(62288),S=i(71044);const y={green:{
border:"#78C143",background:"#8DDD54"},red:{border:"#CC4545",background:"#ED5A5A"},neutral:{border:"#EAC300",background:"#FFD400"},yellow:{border:"#EAC300",background:"#FFD400"},blue:{border:"#047ACE",background:"#0496FF"}};class b extends m.ScaledPaneRenderer{constructor(e,t){super(),this._highlightByAuthor=!1,this._barWidth=e.barWidth,this._plates=e.plates,this._tooltip=e.tooltip,this._model=t}hitTest(e){for(let t=this._plates.length-1;t>=0;--t){const i=this._hitTestDot(this._plates[t],e);if(i)return i}return null}_drawImpl(e){var t,i;e.save();for(let e=0;e<this._plates.length;e++)if(this._plates[e].highlightByAuthor){this._highlightByAuthor=!0;break}this._plates.forEach(this._drawItem.bind(this,e));const r=this._plates.map(e=>this._plateTransform(e));null===(t=this._tooltip)||void 0===t||t.draw(r,e),null===(i=this._tooltip)||void 0===i||i.endDraw(),e.restore()}_drawItem(e,t){e.save(),this._highlightByAuthor&&!t.highlightByAuthor&&(e.globalAlpha=.4);const i=this._dotTransform(t);i.mine?this._drawTriangle(e,i):this._drawDot(e,i),e.restore()}_commonTransform(e){const t=Math.max(1.4*e.minSize,this._barWidth+4),i={up:-1,down:1}[e.direction]*(e.yInverted?-1:1)*(t*(e.order+.6)+.25*t),r=e.y+i,s=(0,h.clone)(e.overridedTheme||y[e.theme]);return s.dotBorderWidth=e.hovered||e.highlightByAuthor?4:2,{id:e.id,theme:s,themeName:e.theme,x:Math.round(e.x+1),y:Math.round(r),yInverted:e.yInverted,pinned:Boolean(e.pinned),hovered:Boolean(e.hovered)}}_dotTransform(e){const t=Math.max(e.minSize/2,.4*this._barWidth),i={...this._commonTransform(e),radius:t,label:e.label,labelFontColor:e.labelFontColor,labelFontSize:Math.ceil(Math.max(10,Math.min(t,20)))};return this._model.updateDotData(e,i)}_plateTransform(e){const t=this._commonTransform(e);return this._model.updatePlateData(e,t)}_drawTriangle(e,t){e.strokeStyle=t.theme.border,e.fillStyle=t.theme.background,e.lineWidth=t.theme.dotBorderWidth||2;const i=t,r=t.radius,s=Math.cos(Math.PI/6)*r,n=Math.sin(Math.PI/6)*r;e.translate(i.x,i.y);"up"===t.direction!==t.yInverted&&e.rotate(Math.PI),t.public||(e.lineWidth/=2),e.beginPath(),e.moveTo(0,-r),e.lineTo(s,n),e.lineTo(-s,n),e.lineTo(0,-r),e.closePath(),e.stroke(),t.public&&e.fill()}_drawDot(e,t){e.strokeStyle=t.theme.border,e.fillStyle=t.theme.background,e.lineWidth=t.theme.dotBorderWidth||2,e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI,!0),e.closePath(),e.stroke(),e.fill(),t.label&&t.radius>=7&&(e.textAlign="center",e.textBaseline="middle",e.font="bold "+t.labelFontSize+"px "+f.CHART_FONT_FAMILY,e.fillStyle=t.labelFontColor,e.fillText(t.label,t.x,t.y))}_hitTestDot(e,t){const i=this._dotTransform(e),r=new g.Point(i.x,i.y);return(0,S.pointInCircle)(t,r,Math.max(i.radius,8))?new v.HitTestResult(v.HitTestResult.REGULAR,{activeItem:e}):null}}var w=i(1771);const P=(0,s.getLogger)("Chart.BarsMarksContainer"),C=Math.round(new Date(2037,0,1).getTime()/1e3);class T extends l.LineDataSource{constructor(e,t){const i=e.onWidget();let s;if(s=i?!e.hideIdeas():!!a.enabled("bars_marks")&&o().getBool("BarsMarksContainer.visibile",!1),t)t.merge({visible:s,
frozen:!1});else{t=new w.DefaultProperty("barmarks",{visible:s,frozen:!1})}t.childs().visible.listeners().subscribe(null,t=>{i||e.isSnapshot()||!a.enabled("bars_marks")||o().setValue("BarsMarksContainer.visibile",!!t.value()),this._tooltip&&this._tooltip.removeAll()}),l.LineDataSource._configureProperties(t),super(e,t),this.onNeedRepaint=new(u()),this._requests=[],this._marks={},this._loadedRange=null,this._getDataTimeout=null,this._collectedRange=null,this._lastRange=null,this._model.mainSeries().onSymbolIntervalChanged().subscribe(this,this.clearMarks),this._model.mainSeries().dataEvents().symbolResolved().subscribe(this,this.clearMarks),this._model.mainSeries().dataEvents().completed().subscribe(this,()=>{var e,t;const i=this._model.mainSeries().data();if(0===i.size())return;const s=(0,r.ensureNotNull)(i.first()).index,n=(0,r.ensureNotNull)(i.last()).index,o=this.timeScale();this.getData({start:null!==(e=o.indexToTimePoint(s))&&void 0!==e?e:1/0,end:null!==(t=o.indexToTimePoint(n))&&void 0!==t?t:-1/0})}),this._initialize(),this._pinnedTooltips={},this._tooltip=this._createTooltipRenderer()}marks(){return this._marks}updateDotData(e,t){return t}isAvailableInFloatingWidget(){return!1}pinTooltip(e,t){this._pinnedTooltips[e]=t}timeScale(){return this._model.timeScale()}getIntervalInTicks(){const e=this._model.mainSeries().properties().childs().interval.value(),t=d.Interval.parse(e);if(!t.isValid())throw new TypeError("Unexpected interval");return t.isRange()?60:t.inMilliseconds()/1e3}getVisibleTickMarksRange(){var e,t;if(this.timeScale().isEmpty())return{start:0,end:0};const i=(0,r.ensureNotNull)(this.timeScale().visibleBarsStrictRange()),s=(0,r.ensureNotNull)(this.timeScale().points().firstIndex()),n=(0,r.ensureNotNull)(this.timeScale().points().lastIndex());if(!(i.lastBar()>s&&i.firstBar()<n))return{start:0,end:0};let o;o=i.lastBar()<n?this.timeScale().indexToTimePoint(i.lastBar()):C;const a={start:this.timeScale().indexToTimePoint(Math.max(i.firstBar(),s)),end:o};return{start:null!==(e=a.start)&&void 0!==e?e:1/0,end:null!==(t=a.end)&&void 0!==t?t:-1/0}}getVisibleRangePlates(){const e=[],t=this.getVisibleTickMarksRange(),i=this.getIntervalInTicks();return Object.keys(this._marks).forEach(r=>{var s,n;const o=this._marks[r],a=o.tickmark;a>=(null!==(s=t.start)&&void 0!==s?s:1/0)&&a<=(null!==(n=t.end)&&void 0!==n?n:-1/0)+i&&e.push(o)}),e}getPublishedPlates(){const e={};return window.is_authenticated?(this.getVisibleRangePlates().forEach(t=>{t.is_public&&(this._pinnedTooltips[t.id]||t.user__id===window.user.id)&&(e[t.id]=t)}),e):e}filterDisplayedPlates(e){const t=e.reduce((e,t)=>{const i=this._getIndex(t.tickmark);return null!==i&&(e[i]=e[i]||[],e[i].push(t)),e},{});return Object.keys(t).reduce((e,i)=>{let r=t[i];return r=r.sort((e,t)=>t.views_count-e.views_count),r=r.slice(0,10),e.concat(r)},[])}getViewData(){return{barWidth:this.barWidth(),plates:this.getPlatesViewData(),tooltip:this._tooltip}}barWidth(){return this.timeScale().barSpacing()}getPlatesViewData(){var e,t,i;const s=this._model.mainSeries()
;if(s.data().isEmpty())return[];const n=(0,p.isPriceSourceStyle)(s.style())?s.barFunction():null,o=this.filterDisplayedPlates(this.getVisibleRangePlates()),a={},l=null!==(e=this._model.lastHittestData())&&void 0!==e?e:this._model.lastSelectedHittestData(),c=[];for(const e of o){const i=(0,r.ensureNotNull)(this._getIndex(e.tickmark)),s=this._getBar(i);if(null===s)continue;const o=this._layout(e.direction),u=this._theme(e.direction);let d=null;null!==l&&this._model.hoveredSource()===this&&(d=null!==(t=l.activeItem)&&void 0!==t?t:null);const p=null!==d&&d.id===e.id,_=this.timeScale().indexToCoordinate(i),m=this._offset(o,s,n),f=(0,r.ensureNotNull)(this.priceScale()).isInverted();let g=0;i in a||(a[i]={up:0,down:0}),g=a[i][o]++,c.push((0,h.merge)({id:e.id,x:_,y:m,yInverted:f,order:g,direction:o,theme:u,hovered:p,pinned:!0===this._pinnedTooltips[e.id],user__id:e.user__id,label:e.label,labelFontColor:e.labelFontColor||"#444",minSize:e.minSize||5},this._plateViewData(e)))}const u=c.filter(e=>!0===e.hovered);for(let e=0;e<o.length;e++)o[e].user__id===(null===(i=u[0])||void 0===i?void 0:i.user__id)&&(o[e].highlightByAuthor=!0);return c.sort((e,t)=>e.hovered&&!t.hovered?1:0),c}paneViews(){return this._properties.childs().visible.value()?[new _(this,e=>new b(e.getViewData(),this))]:[]}dataWindowView(){return null}priceAxisViews(){return null}statusView(){return null}updateAllViews(){}pointsCount(){return 0}roundRange(e){return{start:Math.round(e.start),end:Math.round(e.end)}}refreshData(){null!==this._lastRange&&this.getData(this._lastRange)}getData(e){(0,h.isNumber)(e.start)&&(0,h.isNumber)(e.end)?(this._lastRange=e,e.end=C,this._pushGetDataStack(Object.assign({},e))):P.logError("Wrong range")}clearMarks(){this._abortAllRequests(),this._marks={},this._loadedRange=null}isUserDeletable(){return!1}_plateViewData(e){return{}}_layout(e){switch(e){default:case 0:return"up";case 1:return"down";case 2:return"up";case 3:case 4:case 5:case 6:return"up"}}_theme(e){switch(e){default:case 0:return"neutral";case 1:return"green";case 2:return"red";case 3:return"yellow";case 4:return"blue";case 5:return"green";case 6:return"red"}}_offset(e,t,i){let s;switch(e){default:case"up":s=null===i?t[2]:i(t);break;case"down":s=null===i?t[3]:i(t)}return(0,r.ensureNotNull)(this.priceScale()).priceToCoordinate(s,(0,r.ensureNotNull)((0,r.ensureNotNull)(this.ownerSource()).firstValue()))}_getIndex(e){return this.timeScale().timePointToIndex(e)}_getBar(e){return this._model.mainSeries().data().valueAt(e)}_rangeDifference(e){return e=Object.assign({start:1/0,end:-1/0},e),this._loadedRange&&(e.start<this._loadedRange.start?e.end=this._loadedRange.start:e.end>this._loadedRange.end&&(e.start=this._loadedRange.end)),e}_rangeUnion(e,t){return e=Object.assign({start:1/0,end:-1/0},e),t&&(e.start=Math.min(t.start,e.start),e.end=Math.max(t.end,e.end)),e}_pushGetDataStack(e){(0,h.isNumber)(e.start)&&(0,h.isNumber)(e.end)?(this._getDataTimeout&&clearTimeout(this._getDataTimeout),this._collectedRange=this._rangeUnion(e,this._collectedRange),
this._getDataTimeout=setTimeout(()=>{this._getData(this._collectedRange),this._getDataTimeout=this._collectedRange=null},300)):P.logError("Wrong tickmark range")}_abortAllRequests(){this._requests.forEach(e=>{e.cancel()}),this._requests=[],this._getDataTimeout&&clearTimeout(this._getDataTimeout),this._getDataTimeout=this._collectedRange=null}}},78776:(e,t,i)=>{"use strict";i.d(t,{TooltipRenderer:()=>s});var r=i(16282);class s{constructor(e,t){this._tooltips={},this._hoveredId=null,this._tooltipFactory=e,this.source=t}showPlate(e,t){const i=this._findOrCreateTooltip(e);null!==i&&(i.drawPlate(e,t),i.plateData=e)}draw(e,t){this._hoveredId=null;for(const t of e)t.hovered&&(this._hoveredId=t.id);for(const i of e)this.showPlate(i,t)}endDraw(){var e,t;for(const i in this._tooltips)if(this._tooltips.hasOwnProperty(i)){const s=(0,r.ensureDefined)(this._tooltips[i]);s.toggleVisibility(),this._hoveredId&&(null===(e=s.plateData)||void 0===e?void 0:e.id)!==this._hoveredId&&!(null===(t=s.plateData)||void 0===t?void 0:t.pinned)&&(s.remove(),delete this._tooltips[i])}}removeAll(){for(const e in this._tooltips)if(this._tooltips.hasOwnProperty(e)){(0,r.ensureDefined)(this._tooltips[e]).remove()}this._tooltips={}}removeTooltip(e){delete this._tooltips[e]}_createTooltip(){return new n(this,this._tooltipFactory())}_findOrCreateTooltip(e){let t=this._tooltips[e.id];return void 0===t&&(e.hovered||e.pinned)&&(t=this._createTooltip(),this._tooltips[e.id]=t),t||null}}class n{constructor(e,t){this._visible=!1,this._renderer=e,this._tooltip=t}drawPlate(e,t){this._visible=!0,this._tooltip.setSource(this._renderer.source),this._tooltip.showPlate(e,t),e.hovered||e.pinned||this._tooltip.hide(()=>this._renderer.removeTooltip(e.id))}remove(){this._tooltip.removeLayout()}toggleVisibility(){this._tooltip.toggleLayout(this._visible),this._visible=!1}}},91491:(e,t,i)=>{"use strict";var r;i.d(t,{LineToolBarsPatternMode:()=>r}),function(e){e[e.Bars=0]="Bars",e[e.Line=1]="Line",e[e.OpenClose=2]="OpenClose",e[e.LineOpen=3]="LineOpen",e[e.LineHigh=4]="LineHigh",e[e.LineLow=5]="LineLow",e[e.LineHL2=6]="LineHL2"}(r||(r={}))},98754:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(54281).Action,n=i(1771).DefaultProperty,o=i(40989).PlotRowSearchMode,a=i(91491).LineToolBarsPatternMode;class l extends r{constructor(e,t){var r=t||l.createProperties();super(e,r),r.mirrored.listeners().subscribe(this,l.prototype.mirror),r.flipped.listeners().subscribe(this,l.prototype.flip),this._scaleCoeff=1,this.version=l.version,this._pattern=[],this._properties.mode.listeners().subscribe(this,l.prototype.onModeChanged),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,59715,19)).then(({BarsPatternPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}isSynchronizable(){return!1}onModeChanged(){var e=this.patternPriceDiff();e*=this._pressCoeff,this._points[1].price=this._timePoint[1].price=this._points[0].price+e}additionalActions(e){var t=this;return[new s({checked:this.properties().mirrored.value(),checkable:!0,label:window.t("Mirrored"),
payload:{target:this},onExecute:function(t){var i=t.getPayload().target;e.setProperty(i.properties().mirrored,!i.properties().mirrored.value(),"Bats Pattern Mirroring"),i.updateAllViews(),i._model.updateSource(i)}}),new s({checked:this.properties().flipped.value(),checkable:!0,label:window.t("Flipped"),payload:{target:this},onExecute:function(t){var i=t.getPayload().target;e.setProperty(i.properties().flipped,!i.properties().flipped.value(),"Bats Pattern Flipping"),i.updateAllViews(),i._model.updateSource(i)}}),new s({checkable:!0,label:window.t("Restore Size"),onExecute:function(i){var r=t.points()[0],s=t.patternPriceDiff(),n=r.price+s,o=r.index+t._pattern.length-1;e.startChangingLinetool(t,{price:n,index:o},1,{}),e.changeLinePoint({price:n,index:o},{}),e.endChangingLinetool()}})]}pointsCount(){return 2}_preparePoint(e,t){e=this._alignPointToRangeOfActualData(e);var i=this._model.mainSeries();this.properties().mode.value()===a.Bars?e.price=i.bars().valueAt(e.index)[TradingView.HIGH_PLOT]:e.price=i.bars().valueAt(e.index)[TradingView.CLOSE_PLOT];var s=this.priceScale(),n=this.ownerSource().firstValue(),o=.05*s.height(),l=s.priceToCoordinate(e.price,n)-o;return e.price=s.coordinateToPrice(l,n),r.prototype._preparePoint.call(this,e,t)}state(e){var t=r.prototype.state.call(this,e);return t.pattern=this._pattern,t}restoreData(e){e.pattern&&(this._pattern=e.pattern)}name(){return"Bars Pattern"}hasEditableCoordinates(){return!1}cloneData(e){this._pattern=TradingView.clone(e._pattern)}mirror(){for(var e=this._pattern,t=e[0][TradingView.HIGH_PLOT],i=Math.min(e[0][TradingView.LOW_PLOT],e[0][TradingView.HIGH_PLOT]),r=Math.max(e[0][TradingView.LOW_PLOT],e[0][TradingView.HIGH_PLOT]),s=1;s<e.length;s++)i=Math.min(i,e[s][TradingView.LOW_PLOT]),r=Math.max(r,e[s][TradingView.HIGH_PLOT]);if(i<r){var n=(i+r)/2,o=function(e){return n-(e-n)};for(s=0;s<e.length;s++)e[s][TradingView.HIGH_PLOT]=o(e[s][TradingView.HIGH_PLOT]),e[s][TradingView.LOW_PLOT]=o(e[s][TradingView.LOW_PLOT]),e[s][TradingView.OPEN_PLOT]=o(e[s][TradingView.OPEN_PLOT]),e[s][TradingView.CLOSE_PLOT]=o(e[s][TradingView.CLOSE_PLOT])}var a=e[0][TradingView.HIGH_PLOT]-t,l=e[e.length-1][TradingView.LOW_PLOT]-e[0][TradingView.HIGH_PLOT];this._points[0].price+=a,this._points[1].price=this._points[0].price+l,this.updateAllViews()}flip(){this._points[0].price=this._points[1].price;for(var e=0;e<this._pattern.length/2;e++){var t=this._pattern[e];this._pattern[e]=this._pattern[this._pattern.length-e-1],this._pattern[this._pattern.length-e-1]=t}var i=this._pattern[this._pattern.length-1][TradingView.LOW_PLOT]-this._pattern[0][TradingView.HIGH_PLOT];this._points[1].price=this._points[0].price+i,this.updateAllViews()}firstPatternPrice(){var e=parseInt(this.properties().mode.value(),10);if(e===a.LineHL2)return(this._pattern[0][TradingView.HIGH_PLOT]+this._pattern[0][TradingView.LOW_PLOT])/2;var t={0:TradingView.HIGH_PLOT,1:TradingView.CLOSE_PLOT,2:TradingView.OPEN_PLOT,3:TradingView.OPEN_PLOT,4:TradingView.HIGH_PLOT,5:TradingView.LOW_PLOT}[e];return this._pattern[0][t]}
lastPatternPrice(){var e=parseInt(this.properties().mode.value(),10);if(e===a.LineHL2)return(this._pattern[this._pattern.length-1][TradingView.HIGH_PLOT]+this._pattern[this._pattern.length-1][TradingView.LOW_PLOT])/2;var t={0:TradingView.LOW_PLOT,1:TradingView.CLOSE_PLOT,2:TradingView.CLOSE_PLOT,3:TradingView.OPEN_PLOT,4:TradingView.HIGH_PLOT,5:TradingView.LOW_PLOT}[e];return this._pattern[this._pattern.length-1][t]}patternPriceDiff(){return this.lastPatternPrice()-this.firstPatternPrice()}pressCoeff(){var e=this.patternPriceDiff(),t=this.points()[0].price,i=(this.points()[1].price-t)/e;return this._pressCoeff=i,i}addPoint(e,t){var i=r.prototype.addPoint.call(this,e,t,!0);if(i){var s=Math.min(this.points()[0].index,this.points()[1].index),n=Math.max(this.points()[0].index,this.points()[1].index),a=this._model.mainSeries().nearestIndex(s,o.NearestRight),l=this._model.mainSeries().nearestIndex(n,o.NearestLeft);this.points()[0].index>this.points()[1].index&&(this._points[0].price=this._points[1].price),this._pattern=[];for(var c=a;c<=l;c++){var u=this._model.mainSeries().data().valueAt(c);this._pattern.push(TradingView.clone(u))}if(this._pattern.length>0){var d=this.patternPriceDiff();this._points[1].price=this._points[0].price+d,this._points[1].index=this._points[0].index+(l-a),this.normalizePoints(),this.createServerPoints()}}return i}setPoint(e,t,i){1===e&&t.index<=this._points[0].index&&(t.index=this._points[0].index+1),0===e&&t.index>=this._points[1].index&&(t.index=this._points[1].index-1),super.setPoint(e,t,i)}migrateVersion(e,t,i){if(1===e&&this._pattern.length>0){var r=this.patternPriceDiff();2===this._timePoint.length&&(this._timePoint[1].price=this._timePoint[0].price+r),2===this._points.length&&(this._points[1].price=this._points[0].price+r)}}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,70111))).BarsPatternDefinitionsViewModel}static createProperties(e){var t=new n("linetoolbarspattern",e);return l._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e),e.addExclusion("mirrored"),e.addExclusion("flipped")}}l.version=2,t.LineToolBarsPattern=l},84669:(e,t,i)=>{"use strict";i.d(t,{LineToolBezierCubic:()=>n});var r=i(1771),s=i(73371);class n extends s.LineDataSource{constructor(e,t){const r=t||n.createProperties();super(e,r),this._controlPoints=null,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,82805)).then(t=>{this._setPaneViews([new t.BezierCubicPaneView(this,e)])})}pointsCount(){return 2}name(){return"Double Curve"}setLastPoint(e,t){super.setLastPoint(e,t),this._controlPoints=this._calculateControlPoints()}addPoint(e,t,i){const r=super.addPoint(e,t,i);if(r){const e=this._calculateControlPoints();this._controlPoints=null,this._points.push(e[0]),this._points.push(e[1]),i||(this.normalizePoints(),this.createServerPoints()),this._createPointProperty(2),this._createPointProperty(3)}return r}restorePoints(e,t,i){super.restorePoints(e,t,i),this._createPointProperty(2),
this._createPointProperty(3)}controlPoints(){return this._controlPoints}static createProperties(e){const t=new r.DefaultProperty("linetoolbeziercubic",e);return n._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,52293)).then(e=>e.GeneralBezierDefinitionsViewModel)}static _configureProperties(e){s.LineDataSource._configureProperties(e)}_calculateControlPoints(){const e=this.pointToScreenPoint(this.points()[0])[0],t=this.pointToScreenPoint(this.points()[1])[0],i=t.subtract(e).scaled(.5).transposed().scaled(.3),r=e.add(t).scaled(.33),s=e.add(t).scaled(.67),n=r.add(i),o=s.subtract(i);return[this.screenPointToPoint(n),this.screenPointToPoint(o)]}}},29801:(e,t,i)=>{"use strict";i.d(t,{LineToolBezierQuadro:()=>n});var r=i(1771),s=i(73371);class n extends s.LineDataSource{constructor(e,t){const r=t||n.createProperties();super(e,r),this._controlPoint=null,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,90509)).then(t=>{this._setPaneViews([new t.BezierQuadroPaneView(this,e)])})}pointsCount(){return 2}name(){return"Curve"}setLastPoint(e,t){super.setLastPoint(e,t),this._controlPoint=this._calculateControlPoint()}addPoint(e,t,i){const r=super.addPoint(e,t,i);if(r){const e=this._calculateControlPoint();this._points.push(e),this._controlPoint=null,i||(this.normalizePoints(),this.createServerPoints()),this._createPointProperty(2)}return r}restorePoints(e,t,i){super.restorePoints(e,t,i),this._createPointProperty(2)}controlPoint(){return this._controlPoint}static createProperties(e){const t=new r.DefaultProperty("linetoolbezierquadro",e);return n._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,52293)).then(e=>e.GeneralBezierDefinitionsViewModel)}static _configureProperties(e){s.LineDataSource._configureProperties(e)}_calculateControlPoint(){const e=this.pointToScreenPoint(this.points()[0])[0],t=this.pointToScreenPoint(this.points()[1])[0],i=t.subtract(e).scaled(.5).transposed().scaled(.3),r=e.add(t).scaled(.5).add(i);return this.screenPointToPoint(r)}}},94864:(e,t,i)=>{"use strict";i.d(t,{LineToolBrushBase:()=>s});var r=i(73371);class s extends r.LineDataSource{constructor(){super(...arguments),this._finished=!1}pointsCount(){return-1}finished(){return this._finished}finish(){this._finished=!0,this._lastPoint=null,this.normalizePoints(),this.createServerPoints()}hasEditableCoordinates(){return!1}addPoint(e,t,i){if(this._finished)return!0;if(this._lastPoint=null,this._points.length>0){const t=this._points[this._points.length-1],i=this.pointToScreenPoint(t)[1];if(this.pointToScreenPoint(e)[1].subtract(i).length()<2)return this._finished}return super.addPoint(e),this._finished}restorePoints(e,t,i){super.restorePoints(e,t,i),this._finished=!0}}},87820:(e,t,i)=>{"use strict";i.d(t,{LineToolBrush:()=>o});var r=i(1771),s=i(94864),n=i(22756);class o extends s.LineToolBrushBase{constructor(e,t){
super(e,t||o.createProperties()),this._loadPaneViews(e)}smooth(){return this.properties().childs().smooth.value()}name(){return"Brush"}hasEditableCoordinates(){return!1}static createProperties(e){const t=new r.DefaultProperty("linetoolbrush",e);return o._configureProperties(t),t}_loadPaneViews(e){Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,71680)).then(t=>{this._setPaneViews([new t.BrushPaneView(this,e)])})}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,9290)).then(e=>e.BrushDefinitionsViewModel)}static _configureProperties(e){s.LineToolBrushBase._configureProperties(e),e.addChild("backgroundsColors",new n.LineToolColorsProperty([e.childs().backgroundColor],e.childs().fillBackground))}}},83841:(e,t,i)=>{"use strict";var r;i.d(t,{CalloutConsts:()=>r}),function(e){e[e.RoundRadius=8]="RoundRadius",e[e.TextMargins=2]="TextMargins",e[e.MinWidth=100]="MinWidth"}(r||(r={}))},21786:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(96861).DataSource,n=i(27937),o=i(1771).DefaultProperty,a=i(83841).CalloutConsts,l=i(22756).LineToolColorsProperty;class c extends r{constructor(e,t){super(e,t||c.createProperties()),this._barOffset=0,this._timeScale=e.timeScale(),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,13232,19)).then(({CalloutPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}pointsCount(){return 2}name(){return"Callout"}_correctPoints(e){var t=this._currentMovingPoint.logical.index-this._startMovingPoint.logical.index,i=this._currentMovingPoint.logical.price-this._startMovingPoint.logical.price,r=e[1];r.index+=t,r.price+=i,e[1]=r}addPoint(e){var t=r.prototype.addPoint.call(this,e);return t&&this._calculateBarOffset(),t}_calculateBarOffset(){this.points().length>1&&(this._barOffset=this.points()[1].index-this.points()[0].index)}setLastPoint(e){super.setLastPoint(e),2===this.points().length&&this._calculateBarOffset()}setPoint(e,t){switch(e){case 0:super.setPoint(e,t),this._calculateBarOffset();break;case 1:var i=this.properties();if(!i.wordWrapWidth)return;var r=this._points,s=this._dragStartLeftEdgeIndex,n=Math.round((t.index-s)/2);if(isFinite(s)&&isFinite(n)){r[1]={index:s+n,price:r[1].price},this._calculateBarOffset(),this.normalizePoints();var o=this._timeScale.indexToCoordinate(s+2*n)-this._timeScale.indexToCoordinate(s)-a.RoundRadius-a.TextMargins;if(!isFinite(o))return;i.wordWrapWidth.setValue(Math.max(a.MinWidth,o));break}r[1]=t,this._calculateBarOffset(),this.normalizePoints()}}setPoints(e){super.setPoints(e);var t=this.properties();if(t.wordWrapWidth){var i=this._dragStartLeftEdgeIndex,r=Math.round((e[1].index-i)/2);if(this._calculateBarOffset(),this.normalizePoints(),isFinite(i)&&isFinite(r)){var s=this._timeScale.indexToCoordinate(i+2*r)-this._timeScale.indexToCoordinate(i)-a.RoundRadius-a.TextMargins;if(!isFinite(s))return;t.wordWrapWidth.setValue(Math.max(a.MinWidth,s))}}}_onPointsetUpdated(e){super._onPointsetUpdated(e),
0!==e.length&&(this._dragStartLeftEdgeIndex=this.points()[1].index)}move(e,t,i){super.move(e,t,i),this._calculateBarOffset()}state(e){var t=r.prototype.state.call(this,e);return t.barOffset=this._barOffset,t}restoreData(e){e.barOffset?this._barOffset=e.barOffset:this._calculateBarOffset(),this._calculatePoint2()}setPriceScale(e){s.prototype.setPriceScale.call(this,e),e&&e.priceRange()&&this._calculatePoint2()}template(){var e=r.prototype.template.call(this);return e.text=this.properties().childs().text.value(),e}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text)}_calculatePoint2(){if(!(this._model.lineBeingEdited()===this||this._model.sourcesBeingMoved().includes(this)||this._points.length<2)){var e=this.points()[0],t=this.points()[1];this._points[1]={price:t.price,index:e.index+this._barOffset}}}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,67570))).CalloutDefinitionsViewModel}static createProperties(e){var t=new o("linetoolcallout",e);return c._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e),e.hasChild("text")||e.addChild("text",new n(window.t("Text"))),e.addExclusion("text"),e.addChild("textsColors",new l([e.childs().color]))}}t.LineToolCallout=c},28061:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(1771).DefaultProperty;class n extends r{constructor(e,t){super(e,t||n.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,53893,19)).then(({LineToolCircleLinesPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}pointsCount(){return 2}name(){return"Cyclic Lines"}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,79560))).CyclicAndSineLinesPatternDefinitionsViewModel}static createProperties(e){var t=new s("linetoolcirclelines",e);return n._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e)}}t.LineToolCircleLines=n},21414:(e,t,i)=>{"use strict";i.d(t,{LineToolCrossLine:()=>a});var r=i(1771),s=i(27586),n=i(48697),o=i(73371);class a extends o.LineDataSource{constructor(e,t){super(e,t||a.createProperties()),this._priceAxisView=new s.LineToolHorzLinePriceAxisView(this),this._timeAxisView=new n.LineToolVertLineTimeAxisView(this),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,3350)).then(({CrossLinePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}pointsCount(){return 1}name(){return"Cross Line"}priceAxisViews(e,t){return this.isSourceHidden()?null:t===this.priceScale()&&this.properties().childs().showPrice.value()&&this._model.paneForSource(this)===e?[this._priceAxisView]:null}timeAxisViews(){return this.isSourceHidden()?null:this.properties().childs().showTime.value()?[this._timeAxisView]:null}updateAllViews(){super.updateAllViews(),this._priceAxisView.update(),this._timeAxisView.update()}canHasAlert(){return!1}lineColor(){
return this.properties().childs().linecolor.value()}lineWidth(){return this.properties().childs().linewidth.value()}lineStyle(){return this.properties().childs().linestyle.value()}static createProperties(e){const t=new r.DefaultProperty("linetoolcrossline",e);return a._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,13892)).then(e=>e.CrossLineDefinitionsViewModel)}static _configureProperties(e){o.LineDataSource._configureProperties(e)}}},66116:(e,t,i)=>{"use strict";i.d(t,{CustomEventItem:()=>n,LineToolCustomUrlEvent:()=>o});var r=i(16282),s=i(34842);class n{constructor(e){this._source=e}position(){return this._props().childs().position.value()}_props(){return this._source.properties()}}class o extends s.LineToolWithRelativePriceCoordinate{constructor(){super(...arguments),this._item=null,this._eventTimePointIndex=null}pointsCount(){return 1}cloneable(){return!1}eventTimePointIndex(){return this._eventTimePointIndex}customEvent(){return this._item}restorePoints(e,t,i){i&&t.length>0&&(this._eventTimePointIndex=t[0].index),super.restorePoints(e,t,i)}priceAxisPoints(){return[]}_baseSeriesIndexForPoint(e){var t;return null!==(t=this._eventTimePointIndex)&&void 0!==t?t:e.index}_alignPointHorizontallyOrVertically(e){var t,i;if(null===this._eventTimePointIndex)return e;const s=this._points[0].index-this._eventTimePointIndex,n=(0,r.ensure)(null===(i=null===(t=this._startMovingPoint)||void 0===t?void 0:t.logical)||void 0===i?void 0:i.index)-s;return{price:e.price,index:n}}_snapPoint45Degree(e,t,i){this._eventTimePointIndex&&(e.index=this._eventTimePointIndex)}_snapTo45DegreesAvailable(){return!0}_allowChangeAnchorHorizontally(){return!0}_pointsForPointset(){return[[(0,r.ensureNotNull)(this._item).time(),0],...super._pointsForPointset()]}_onPointsetUpdated(e){if(0===e.length)return;const t=e.findIndex(e=>0===e.index);-1!==t&&(this._eventTimePointIndex=e[t].value[0]);const i=e.slice(1).map(e=>({value:e.value,index:e.index-1}));super._onPointsetUpdated(i)}_readyToCreatePointset(){return super._readyToCreatePointset()&&null!==this._item}}},49362:(e,t,i)=>{"use strict";i.d(t,{LineToolCypherPattern:()=>n});var r=i(83944),s=i(1771);class n extends r.LineTool5PointsPattern{constructor(e,t){super(e,t||n.createProperties())}name(){return"Cypher Pattern"}static createProperties(e){const t=new s.DefaultProperty("linetoolcypherpattern",e);return n._configureProperties(t),t}_loadPaneViews(e){Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,2284)).then(t=>{this._setPaneViews([new t.CypherPaneView(this,e)])})}static _configureProperties(e){r.LineTool5PointsPattern._configureProperties(e)}}},46903:(e,t,i)=>{"use strict";i.d(t,{LineToolDateAndPriceRange:()=>a});var r=i(16282),s=i(1771),n=i(73371),o=i(62921);class a extends n.LineDataSource{constructor(e,t){super(e,t||a.createProperties()),this._volumeCalculator=null,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,28636)).then(e=>{
this._setPaneViews([new e.DateAndPriceRangePaneView(this,this._model)])})}destroy(){super.destroy(),null!==this._volumeCalculator&&this._volumeCalculator.destroy()}pointsCount(){return 2}name(){return"Date and Price Range"}volume(){if(null===this._volumeCalculator)return NaN;const e=this.points();return this._volumeCalculator.volume(e[0].index,e[1].index)}setOwnerSource(e){e===this._model.mainSeries()&&((0,r.assert)(null===this._volumeCalculator),this._volumeCalculator=new o.SeriesTimeRangeVolumeCalculator(this._model.mainSeries())),super.setOwnerSource(e)}static createProperties(e){const t=new s.DefaultProperty("linetooldateandpricerange",e);return a._configureProperties(t),t}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,34404))).GeneralDatePriceRangeDefinitionsViewModel}static _configureProperties(e){n.LineDataSource._configureProperties(e)}}},59919:(e,t,i)=>{"use strict";i.d(t,{LineToolDateRange:()=>a});var r=i(16282),s=i(1771),n=i(73371),o=i(62921);class a extends n.LineDataSource{constructor(e,t){super(e,t||a.createProperties()),this._volumeCalculator=null,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,42673)).then(e=>{this._setPaneViews([new e.DateRangePaneView(this,this._model)])})}destroy(){super.destroy(),null!==this._volumeCalculator&&this._volumeCalculator.destroy()}pointsCount(){return 2}name(){return"Date Range"}volume(){if(null===this._volumeCalculator)return NaN;const e=this.points();return this._volumeCalculator.volume(e[0].index,e[1].index)}setOwnerSource(e){e===this._model.mainSeries()&&((0,r.assert)(null===this._volumeCalculator),this._volumeCalculator=new o.SeriesTimeRangeVolumeCalculator(this._model.mainSeries())),super.setOwnerSource(e)}static createProperties(e){const t=new s.DefaultProperty("linetooldaterange",e);return a._configureProperties(t),t}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,34404))).GeneralDatePriceRangeDefinitionsViewModel}static _configureProperties(e){n.LineDataSource._configureProperties(e)}}},84145:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(1771).DefaultProperty;class n extends r{constructor(e,t){super(e,t||n.createProperties()),this.version=n.version,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,21566,19)).then(({DisjointChannelPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}pointsCount(){return 3}name(){return"Disjoint Channel"}hasEditableCoordinates(){return!1}addPoint(e,t){return t&&t.shift()&&2===this.points().length&&this._snapPoint45Degree(e,this.points()[this.points().length-2]),r.prototype.addPoint.call(this,e)}setLastPoint(e,t){return t&&t.shift()&&2===this.points().length&&this._snapPoint45Degree(e,this.points()[this.points().length-2]),r.prototype.setLastPoint.call(this,e)}setPoint(e,t,i){var r=.5*(this._points[1].price+this._points[2].price);if(i&&i.shift()&&1===e){
this._snapPoint45Degree(t,this.points()[0])}if(e<3&&super.setPoint(e,t),0!==e&&2!==e){if(1===e){var s=this._points[1].price-r;this._points[2].price=this._points[1].price-2*s}else if(3===e){s=t.price-this._points[2].price;this._points[0].price=this._points[1].price-s,this._points[0].index=t.index}this.normalizePoints()}}getPoint(e){if(e<3)return r.prototype.getPoint.call(this,e);var t=this._points[0].price-this._points[2].price;return{index:this._points[0].index,price:this._points[1].price-t}}canHasAlert(){return!0}_getAlertPlots(){var e=this._points[0],t=this._points[1],i=[];e.index<=t.index?(i.push(e),i.push(t)):(i.push(t),i.push(e));var r=this._points[2];r.time=t.time,r.index=t.index;var s,n,o,a,l={price:r.price+(t.price-e.price),time:e.time,index:e.index},c=[];r.index<=l.index?(c.push(r),c.push(l)):(c.push(l),c.push(r)),i[0].price>c[0].price?(s=i,n=c):c[0].price>i[0].price||c[1].price>i[1].price?(s=c,n=i):(s=i,n=c);var u=this.properties().extendLeft.value(),d=this.properties().extendRight.value();return e.index<=t.index?(o=u,a=d):(o=d,a=u),[this._linePointsToAlertPlot(s,"Upper",o,a),this._linePointsToAlertPlot(n,"Lower",o,a)]}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,64408))).GeneralTrendFiguresDefinitionsViewModel}static createProperties(e){var t=new s("linetooldisjointangle",e);return n._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e)}}n.version=1,t.LineToolDisjointChannel=n},69352:(e,t,i)=>{"use strict";i.d(t,{LineToolElliott:()=>u,LineToolElliottImpulse:()=>p,LineToolElliottTriangle:()=>m,LineToolElliottTripleCombo:()=>g,LineToolElliottCorrection:()=>y,LineToolElliottDoubleCombo:()=>w});var r=i(20220),s=i(73371),n=i(54281),o=i(1771),a=i(22756);const l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],c=[{value:0,title:(0,r.t)("Supermillennium")},{value:1,title:(0,r.t)("Millennium")},{value:2,title:(0,r.t)("Submillennium")},{value:3,title:(0,r.t)("Grand Supercycle")},{value:4,title:(0,r.t)("Supercycle")},{value:5,title:(0,r.t)("Cycle")},{value:6,title:(0,r.t)("Primary")},{value:7,title:(0,r.t)("Intermediate")},{value:8,title:(0,r.t)("Minor",{context:"wave"})},{value:9,title:(0,r.t)("Minute",{context:"wave"})},{value:10,title:(0,r.t)("Minuette")},{value:11,title:(0,r.t)("Subminuette")},{value:12,title:(0,r.t)("Micro")},{value:13,title:(0,r.t)("Submicro")},{value:14,title:(0,r.t)("Minuscule")}];class u extends s.LineDataSource{constructor(e,t){super(e,null!=t?t:u.createProperties()),this.version=4,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,7772)).then(e=>{this._setPaneViews([new e.ElliottLabelsPaneView(this,this._model)])})}migrateVersion(e,t,i){if(i.properties.hasChild("background")&&i.properties.removeProperty("background"),i.properties.hasChild("backgroundColor")&&i.properties.removeProperty("backgroundColor"),i.properties.hasChild("showBackground")&&i.properties.removeProperty("showBackground"),1===e){const e=Object.assign({},this._timePoint[0])
;if(this._timePoint.unshift(e),this._points.length>0){const e=Object.assign({},this._points[0]);this._points.unshift(e)}}}applyTemplate(e){const t=e;delete t.background,delete t.backgroundColor,delete t.showBackground,super.applyTemplate(e)}name(){return"Elliott Labels"}additionalActions(e){return[new n.Action({label:(0,r.t)("Degree"),subItems:l.map(t=>{const i=c.filter(e=>e.value===t)[0];return new n.Action({label:i.title,checkable:!0,checked:this.properties().childs().degree.value()===t,onExecute:()=>{e.setProperty(this.properties().childs().degree,t,"Change Elliott Degree")}})})})]}label(e){const t=l.length-this.properties().childs().degree.value()-1,i=Math.floor(t/3);return{group:i,bold:!!(i%2),decoration:["","brackets","circle"][t%3],label:this.labelsGroup()[i][e]}}availableDegreesValues(){return c}static createProperties(e){const t=new o.DefaultProperty("linetoolelliott",e);return u._configureProperties(t),t}static migrateState(e){const t={0:11,1:10,2:9,3:8,4:7,5:6,6:5,7:4,8:3},i={0:11,1:8};"LineToolElliottSubminuette"===e.type&&(e.type="LineToolElliottImpulse",e.state.degree=t[e.state.wavesize]),"LineToolElliottMinor"===e.type&&(e.type="LineToolElliottImpulse",e.state.degree=t[e.state.wavesize]),"LineToolElliottCircle"===e.type&&(e.type="LineToolElliottImpulse",e.state.degree=t[e.state.wavesize]),"LineToolElliottMinorRetr"===e.type&&(e.type="LineToolElliottCorrection",e.state.degree=i[e.state.wavesize]),"LineToolElliottMajorRetr"===e.type&&(e.type="LineToolElliottCorrection",e.state.degree=i[e.state.wavesize])}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,45783))).ElliottPatternDefinitionsViewModel}static _configureProperties(e){s.LineDataSource._configureProperties(e),e.addChild("linesColors",new a.LineToolColorsProperty([e.childs().color])),e.addExclusion("linesColors")}}class d extends u{pointsCount(){return 6}static _configureProperties(e){u._configureProperties(e)}}const h=[["0","1","2","3","4","5"],["0","i","ii","iii","iv","v"],["0","1","2","3","4","5"],["0","I","II","III","IV","V"],["0","1","2","3","4","5"]];class p extends d{constructor(e,t){super(e,t||p.createProperties())}name(){return"Elliott Impulse Wave (12345)"}labelsGroup(){return h}static createProperties(e){const t=new o.DefaultProperty("linetoolelliottimpulse",e);return p._configureProperties(t),t}static _configureProperties(e){d._configureProperties(e)}}const _=[["0","A","B","C","D","E"],["0","a","b","c","d","e"],["0","A","B","C","D","E"],["0","a","b","c","d","e"],["0","A","B","C","D","E"]];class m extends d{constructor(e,t){super(e,t||m.createProperties())}name(){return"Elliott Triangle Wave (ABCDE)"}labelsGroup(){return _}static createProperties(e){const t=new o.DefaultProperty("linetoolelliotttriangle",e);return m._configureProperties(t),t}static _configureProperties(e){d._configureProperties(e)}}const f=[["0","W","X","Y","X","Z"],["0","w","x","y","x","z"],["0","W","X","Y","X","Z"],["0","w","x","y","x","z"],["0","W","X","Y","X","Z"]]
;class g extends d{constructor(e,t){super(e,null!=t?t:g.createProperties())}name(){return"Elliott Triple Combo Wave (WXYXZ)"}labelsGroup(){return f}static createProperties(e){const t=new o.DefaultProperty("linetoolelliotttriplecombo",e);return g._configureProperties(t),t}static _configureProperties(e){d._configureProperties(e)}}class v extends u{pointsCount(){return 4}static _configureProperties(e){u._configureProperties(e)}}const S=[["0","A","B","C"],["0","a","b","c"],["0","A","B","C"],["0","a","b","c"],["0","A","B","C"]];class y extends v{constructor(e,t){super(e,null!=t?t:y.createProperties())}name(){return"Elliott Correction Wave (ABC)"}labelsGroup(){return S}static createProperties(e){const t=new o.DefaultProperty("linetoolelliottcorrection",e);return y._configureProperties(t),t}static _configureProperties(e){v._configureProperties(e)}}const b=[["0","W","X","Y"],["0","w","x","y"],["0","W","X","Y"],["0","w","x","y"],["0","W","X","Y"]];class w extends v{constructor(e,t){super(e,null!=t?t:w.createProperties())}name(){return"Elliott Double Combo Wave (WXY)"}labelsGroup(){return b}static createProperties(e){const t=new o.DefaultProperty("linetoolelliottdoublecombo",e);return w._configureProperties(t),t}static _configureProperties(e){v._configureProperties(e)}}},37168:(e,t,i)=>{"use strict";var r=i(72927).Point,s=i(89684).distanceToLine,n=i(73371).LineDataSource,o=i(1771).DefaultProperty,a=i(22756).LineToolColorsProperty;class l extends n{constructor(e,t){super(e,t||l.createProperties()),this.version=l.version,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,89096,19)).then(({EllipsePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}startChanging(e,t){if(super.startChanging(e,t),0===e||1===e){var i=this.pointToScreenPoint(this._points[0])[0],r=this.pointToScreenPoint(this._points[1])[0],n=this.pointToScreenPoint(this._points[2])[0];this._dist=s(i,r,n).distance||0}}_preparePoint(e,t){var i=this._preparePointInternal(e,t,!1);return t&&t.shift()&&this._points[0].index===this._points[1].index&&this._fixVerticalDiameterPoints(this._points[1],this._points[0],i),i}_preparePointInternal(e,t,i){var s=Object.assign({},e);if(t&&t.shift()){var n=this.points().length;if(!this._fakePointAdded&&3===n&&!i)return s;if(this._fakePointAdded||2===n||i){this._snapPoint45Degree(e,this._points[0]),this._fakePointAdded?this._points[1]=e:i||(this._fakePointAdded=!0,super._addPointIntenal(e));var o=this.pointToScreenPoint(this._points[0])[0],a=this.pointToScreenPoint(this._points[1])[0],l=a.x-o.x,c=a.y-o.y,u=Math.sqrt(l*l+c*c)/2,d=a.subtract(o),h=o.add(a).scaled(.5),p=new r(-d.y,d.x);p=p.normalized();var _=h.add(p.scaled(u));s=this.screenPointToPoint(_),(TradingView.isNaN(s.price)||TradingView.isNaN(s.index))&&(s=this.screenPointToPoint(h))}}else this._fakePointAdded&&(this._points.splice(1,1),this._fakePointAdded=!1);return s}_fixVerticalDiameterPoints(e,t,i){
var r=this.pointToScreenPoint(e)[0],s=this.pointToScreenPoint(t)[0],n=this._model.timeScale(),o=n.indexToCoordinate(e.index),a=n.indexToCoordinate(i.index),l=2*Math.abs(o-a);l*=t.price>e.price?1:-1,e.price=this.screenPointToPoint({x:r.x,y:s.y+l}).price}addPoint(e,t,i){var r=n.prototype.addPoint.call(this,e,t,i);return r&&(this._fakePointAdded=!1),r}setPoint(e,t,i){var n=Object.assign({},t),o=this.pointToScreenPoint(this._points[0])[0],a=this.pointToScreenPoint(this._points[1])[0],l=this.pointToScreenPoint(this._points[2])[0];switch(e){case 0:if(i&&i.shift()){this._snapPoint45Degree(n,this._points[1]),this._points[0]=n,this._points[2]=this._preparePointInternal(this._points[2],i,!0),this._points[0].index===this._points[1].index&&this._fixVerticalDiameterPoints(this._points[0],this._points[1],this._points[2]);break}o=this.pointToScreenPoint(n)[0];var c=a.subtract(o),u=o.add(a).scaled(.5);h=(h=new r(-c.y,c.x)).normalized(),l=u.add(h.scaled(this._dist)),l=this.screenPointToPoint(l),this._points[0]=n,this._points[2]=l;break;case 1:if(i&&i.shift()){this._snapPoint45Degree(n,this._points[0]),this._points[1]=n,this._points[2]=this._preparePointInternal(this._points[2],i,!0),this._points[0].index===this._points[1].index&&this._fixVerticalDiameterPoints(this._points[1],this._points[0],this._points[2]);break}c=(a=this.pointToScreenPoint(n)[0]).subtract(o),u=o.add(a).scaled(.5);h=(h=new r(-c.y,c.x)).normalized(),l=u.add(h.scaled(this._dist)),l=this.screenPointToPoint(l),this._points[1]=n,this._points[2]=l;break;case 2:n=this.pointToScreenPoint(n)[0];var d=s(o,a,n).distance;c=a.subtract(o),u=o.add(a).scaled(.5);h=(h=new r(-c.y,c.x)).normalized(),l=u.add(h.scaled(d)),l=this.screenPointToPoint(l),this._points[2]=l;break;case 3:n=this.pointToScreenPoint(n)[0];var h;d=s(o,a,n).distance,c=a.subtract(o),u=o.add(a).scaled(.5);h=(h=new r(-c.y,c.x)).normalized(),l=u.add(h.scaled(d)),l=this.screenPointToPoint(l),this._points[2]=l}this.normalizePoints()}pointsCount(){return 3}name(){return"Ellipse"}hasEditableCoordinates(){return!1}migrateVersion(e,t,i){if(1===e&&2===this._points.length){var r=this._points[0].price,s=.5*(this._points[0].price+this._points[1].price);this._points[0]={price:s,index:this._points[0].index},this._points[1]={price:s,index:this._points[1].index},this._points.push({price:r,index:this._points[0].index})}if(1===e&&2===this._timePoint.length){r=this._timePoint[0].price,s=.5*(this._timePoint[0].price+this._timePoint[1].price);this._timePoint[0].price=s,this._timePoint[1].price=s;var n={price:r,offset:this._timePoint[0].offset,time_t:this._timePoint[0].time_t};this._timePoint.push(n)}}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,96088))).GeneralFiguresDefinitionsViewModel}static createProperties(e){var t=new o("linetoolellipse",e);return l._configureProperties(t),t}static _configureProperties(e){n._configureProperties(e),e.addChild("linesColors",new a([e.childs().color]))}}l.version=2,t.LineToolEllipse=l},3080:(e,t,i)=>{
"use strict";var r=i(35200).LineToolTrendLine,s=i(1771).DefaultProperty;class n extends r{constructor(e,t){super(e,t||n.createProperties())}name(){return"Extended Line"}static createProperties(e){var t=new s("linetoolextended",e);return n._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e)}}t.LineToolExtended=n},29994:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(92372),n=i(22756).LineToolColorsProperty;class o extends r{constructor(e,t){super(e,t||o.createProperties()),this.version=o.version,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,47644,19)).then(({FibChannelPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}levelsCount(){return o.LevelsCount}migrateVersion(e,t,i){i.properties.removeProperty("reverse")}pointsCount(){return 3}name(){return"Fib Channel"}processErase(e,t){var i="level"+t,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,27564))).FibDrawingsWith24LevelsDefinitionsViewModel}static createProperties(e){var t=new s("linetoolfibchannel",e,!1,{range:[1,24],names:["coeff","color","visible"]});return o._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e);var t=[];for(let i=1;i<=o.LevelsCount;i++)t.push(e.child("level"+i).child("color"));e.addChild("linesColors",new n(t)),e.addExclusion("linesColors")}}o.LevelsCount=24,o.version=2,t.LineToolFibChannel=o},89706:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(92372),n=i(22756),o=n.LineToolWidthsProperty,a=n.LineToolColorsProperty;class l extends r{constructor(e,t){super(e,t||l.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,82197,19)).then(({FibCirclesPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}levelsCount(){return l.LevelsCount}pointsCount(){return 2}name(){return"Fib Circles"}processErase(e,t){var i="level"+t,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}static createProperties(e){var t=new s("linetoolfibcircles",e,!1,{range:[1,11]});return l._configureProperties(t),t}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,42842))).FibCirclesDefinitionsViewModel}_snapTo45DegreesAvailable(){return!0}static _configureProperties(e){r._configureProperties(e);for(var t=[e.child("trendline").child("linewidth")],i=[e.child("trendline").child("color")],s=1;s<=l.LevelsCount;s++)t.push(e.child("level"+s).child("linewidth")),i.push(e.child("level"+s).child("color"));e.addChild("linesColors",new a(i)),e.addChild("linesWidths",new o(t))}}l.LevelsCount=11,t.LineToolFibCircles=l},49941:(e,t,i)=>{"use strict";var r=i(92372),s=i(73371).LineDataSource,n=i(22756),o=n.LineToolWidthsProperty,a=n.LineToolColorsProperty;class l extends s{constructor(e,t){super(e,t||l.createProperties()),this.version=l.version,
this._properties._stateVersion=1,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,51315,19)).then(({FibRetracementPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}levelsCount(){return l.LevelsCount}pointsCount(){return 2}name(){return"Fib Retracement"}migrateVersion(e,t,i){1===e&&this.properties().extendLines.setValue(!0)}processErase(e,t){var i="level"+t,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,27564))).FibDrawingsWith24LevelsDefinitionsViewModel}static createProperties(e){var t=new r("linetoolfibretracement",e,!1,{range:[1,24],names:["coeff","color","visible"]});return l._configureProperties(t),t}static _configureProperties(e){s._configureProperties(e);for(var t=[e.child("trendline").child("linewidth"),e.child("levelsStyle").child("linewidth")],i=[e.child("trendline").child("color")],r=1;r<=l.LevelsCount;r++)i.push(e.child("level"+r).child("color"));e.addChild("linesColors",new a(i)),e.addChild("linesWidths",new o(t))}fibLevelsBasedOnLogScale(){return this.properties().fibLevelsBasedOnLogScale.value()&&this.priceScale().isLog()}}l.version=2,l.LevelsCount=24,t.LineToolFibRetracement=l},83750:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(92372),n=i(22756),o=n.LineToolWidthsProperty,a=n.LineToolColorsProperty;class l extends r{constructor(e,t){super(e,t||l.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,85572,19)).then(({FibSpeedResistanceArcsPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}levelsCount(){return l.LevelsCount}pointsCount(){return 2}name(){return"Fib Speed Resistance Arcs"}processErase(e,t){var i="level"+t,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}static createProperties(e){var t=new s("linetoolfibspeedresistancearcs",e,!1,{range:[1,11]});return l._configureProperties(t),t}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,87134))).FibSpeedResistanceArcsDefinitionsViewModel}static _configureProperties(e){r._configureProperties(e);for(var t=[e.child("trendline").child("linewidth")],i=[e.child("trendline").child("color")],s=1;s<=l.LevelsCount;s++)t.push(e.child("level"+s).child("linewidth")),i.push(e.child("level"+s).child("color"));e.addChild("linesColors",new a(i)),e.addChild("linesWidths",new o(t))}}l.LevelsCount=11,t.LineToolFibSpeedResistanceArcs=l},62872:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(92372),n=i(22756).LineToolColorsProperty;class o extends r{constructor(e,t){super(e,t||o.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,53591,19)).then(({FibSpeedResistanceFanPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}hLevelsCount(){return o.HLevelsCount}vLevelsCount(){return o.VLevelsCount}pointsCount(){return 2}name(){
return"Fib Speed Resistance Fan"}processErase(e,t){var i="h"===t.type?"hlevel"+t.index:"vlevel"+t.index,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,96024))).FibSpeedResistanceFanDefinitionsViewModel}_snapTo45DegreesAvailable(){return!0}static createProperties(e){void 0!==e&&void 0===e.reverse&&(e.reverse=!0);var t=new s("linetoolfibspeedresistancefan",e,!1,{range:[1,7],prefixes:["h","v"],names:["coeff","color","visible"]});return o._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e);var t=[e.child("grid").child("color")];for(let i=1;i<=o.HLevelsCount;i++)t.push(e.child("hlevel"+i).child("color"));for(let i=1;i<=o.VLevelsCount;i++)t.push(e.child("vlevel"+i).child("color"));e.addChild("linesColors",new n(t)),e.addExclusion("linesColors")}}o.HLevelsCount=7,o.VLevelsCount=7,t.LineToolFibSpeedResistanceFan=o},98260:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(1771).DefaultProperty;class n extends r{constructor(e,t){super(e,t||n.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,44159,19)).then(({FibSpiralPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}pointsCount(){return 2}name(){return"Fib Spiral"}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,85068))).FibSpiralDefinitionsViewModel}static createProperties(e){var t=new s("linetoolfibspiral",e);return n._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e)}}t.LineToolFibSpiral=n},84159:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(92372),n=i(22756),o=n.LineToolWidthsProperty,a=n.LineToolColorsProperty;class l extends r{constructor(e,t){super(e,t||l.createProperties()),this.version=l.version,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,34783,19)).then(({FibTimeZonePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}levelsCount(){return l.LevelsCount}migrateVersion(e,t,i){if(1===e){i.properties.level1.color.setValue(i.properties.baselinecolor.value());for(var r=2;r<=11;r++)i.properties["level"+r].color.setValue(i.properties.linecolor.value());for(r=1;r<=11;r++)i.properties["level"+r].linewidth.setValue(i.properties.linewidth.value()),i.properties["level"+r].linestyle.setValue(i.properties.linestyle.value())}}pointsCount(){return 2}name(){return"Fib Time Zone"}processErase(e,t){var i="level"+t,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,76400))).FibTimezoneDefinitionsViewModel}static createProperties(e){var t=new s("linetoolfibtimezone",e,!1,{range:[1,11]});return l._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e)
;for(var t=[],i=[],s=1;s<=l.LevelsCount;s++)t.push(e.child("level"+s).child("linewidth")),i.push(e.child("level"+s).child("color"));for(t=[],i=[],s=1;s<=l.LevelsCount;s++)t.push(e.child("level"+s).child("linewidth")),i.push(e.child("level"+s).child("color"));e.addChild("linesColors",new a(i)),e.addChild("linesWidths",new o(t))}}l.version=2,l.LevelsCount=11,t.LineToolFibTimeZone=l},80484:(e,t,i)=>{"use strict";i.d(t,{LineToolFibWedgeBase:()=>o});var r=i(16282),s=i(72927),n=i(73371);class o extends n.LineDataSource{pointsCount(){return 3}hasEditableCoordinates(){return!1}setPoint(e,t){if(super.setPoint(e,t),!this._recursiveGuard)try{if(this._recursiveGuard=!0,2===e){const e=this.pointToScreenPoint(this._points[0])[0];let t=this.pointToScreenPoint(this._points[1])[0];const i=this.pointToScreenPoint(this._points[2])[0].subtract(e).length();let r=t.subtract(e);r.length()<=0&&(r=new s.Point(1,0)),t=e.add(r.normalized().scaled(i));const n=this.screenPointToPoint(t),o=this._pointsProperty.childs().points[1];o.childs().price.setValue(n.price),o.childs().bar.setValue(n.index)}else{const e=this.pointToScreenPoint(this._points[0])[0],t=this.pointToScreenPoint(this._points[1])[0];let i=this.pointToScreenPoint(this._points[2])[0];const r=t.subtract(e).length();let n=i.subtract(e);n.length()<=0&&(n=new s.Point(1,0)),i=e.add(n.normalized().scaled(r));const o=this.screenPointToPoint(i),a=this._pointsProperty.childs().points[2];a.childs().price.setValue(o.price),a.childs().bar.setValue(o.index)}}finally{this._recursiveGuard=!1}}addPoint(e){if(2===this._points.length){const t=this.pointToScreenPoint(this._points[0])[0],i=this.pointToScreenPoint(this._points[1])[0];let s=this.pointToScreenPoint(e)[0];const n=i.subtract(t).length(),o=s.subtract(t).normalized();s=t.add(o.scaled(n));const a=(0,r.ensureNotNull)(this.ownerSource()),l=(0,r.ensureNotNull)(a.firstValue()),c=(0,r.ensureNotNull)(this.priceScale()).coordinateToPrice(s.y,l);e={index:Math.round(this._model.timeScale().coordinateToIndex(s.x)),price:c}}return n.LineDataSource.prototype.addPoint.call(this,e)}}},66165:(e,t,i)=>{"use strict";var r=i(80484).LineToolFibWedgeBase,s=i(92372),n=i(22756),o=n.LineToolWidthsProperty,a=n.LineToolColorsProperty;class l extends r{constructor(e,t){super(e,t||l.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,70674,19)).then(({FibWedgePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}isSynchronizable(){return!1}levelsCount(){return l.LevelsCount}name(){return"Fib Wedge"}processErase(e,t){var i="level"+t,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}static createProperties(e){var t=new s("linetoolfibwedge",e,!1,{range:[1,11]});return l._configureProperties(t),t}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,30483))).FibWedgeDefinitionsViewModel}static _configureProperties(e){r._configureProperties(e)
;for(var t=[e.child("trendline").child("linewidth")],i=[e.child("trendline").child("color")],s=1;s<=l.LevelsCount;s++)t.push(e.child("level"+s).child("linewidth")),i.push(e.child("level"+s).child("color"));e.addChild("linesColors",new a(i)),e.addChild("linesWidths",new o(t))}}l.LevelsCount=11,t.LineToolFibWedge=l},35929:(e,t,i)=>{"use strict";i.d(t,{LineToolFlagMark:()=>a});var r=i(72927),s=i(73371),n=i(1771),o=i(22756);class a extends s.LineDataSource{constructor(e,t){super(e,t||a.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,63613)).then(({FlagMarkPaneView:e})=>{const t=new e(this,this.model());t.setAnchors(new r.Point(0,0)),this._setPaneViews([t])})}pointsCount(){return 1}name(){return"Flag Mark"}static createProperties(e){e&&void 0===e.flagColor&&(e.flagColor="#318757");const t=new n.DefaultProperty("linetoolflagmark",e);return a._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,54175)).then(e=>e.FlagMarkDefinitionsViewModel)}static _configureProperties(e){s.LineDataSource._configureProperties(e),e.addChild("backgroundsColors",new o.LineToolColorsProperty([e.childs().flagColor])),e.addExclusion("backgroundsColors")}}a.version=2},9779:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(1771).DefaultProperty;class n extends r{constructor(e,t){super(e,t||n.createProperties()),this.version=n.version,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,90454,19)).then(({FlatBottomPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}pointsCount(){return 3}name(){return"Flat Bottom"}hasEditableCoordinates(){return!1}addPoint(e,t){return t&&t.shift()&&2===this.points().length&&this._snapPoint45Degree(e,this.points()[this.points().length-2]),r.prototype.addPoint.call(this,e)}setLastPoint(e,t){return t&&t.shift()&&2===this.points().length&&this._snapPoint45Degree(e,this.points()[this.points().length-2]),r.prototype.setLastPoint.call(this,e)}setPoint(e,t,i){if(i&&i.shift()&&1===e){this._snapPoint45Degree(t,this.points()[0])}if(2===e)this._points[1].index=t.index;else if(3===e)return this._points[0].index=t.index,this._points[2].price=t.price,void this.normalizePoints();super.setPoint(e,t)}getPoint(e){return e<3?r.prototype.getPoint.call(this,e):3===e?{index:this._points[0].index,price:this._points[2].price}:void 0}canHasAlert(){return!0}_getAlertPlots(){var e=this._points[0],t=this._points[1],i=[];e.index<=t.index?(i.push(e),i.push(t)):(i.push(t),i.push(e));var r=this._points[2];r.time=t.time,r.index=t.index;var s,n,o,a,l={price:r.price,time:e.time,index:e.index},c=[];r.index<=l.index?(c.push(r),c.push(l)):(c.push(l),c.push(r)),i[0].price>c[0].price?(s=i,n=c):c[0].price>i[0].price||c[1].price>i[1].price?(s=c,n=i):(s=i,n=c);var u=this.properties().extendLeft.value(),d=this.properties().extendRight.value();return e.index<=t.index?(o=u,a=d):(o=d,a=u),[this._linePointsToAlertPlot(s,"Upper",o,a),this._linePointsToAlertPlot(n,"Lower",u,a)]}
async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,64408))).GeneralTrendFiguresDefinitionsViewModel}static createProperties(e){var t=new s("linetoolflatbottom",e);return n._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e)}}n.version=1,t.LineToolFlatBottom=n},59213:(e,t,i)=>{"use strict";i.d(t,{createPropertiesObject:()=>a});var r=i(31565),s=i(92372),n=i.n(s);class o extends(n()){constructor(e,t){super(e,t,!1,{names:["width","color","visible"]})}_iterateLevels(e,t){for(const i in e.levels)if(e.levels[i]&&(0,r.isSameType)(e.levels[i],t.typecheck())){let r=t.tpl();for(const s in this._map.names)this._map.names.hasOwnProperty(s)&&(r=t.fill(s,this._map.names[s],e.levels[i],r));e.levels[i]=r}return e}}function a(e,t){return new o(e,t)}},12489:(e,t,i)=>{"use strict";function r(e){"LineToolGannComplex"!==e.type||void 0!==e.version&&1!==e.version||(e.type="LineToolGannFixed")}i.r(t),i.d(t,{migrateState:()=>r})},26914:(e,t,i)=>{"use strict";i.d(t,{LineToolGannComplex:()=>u});var r=i(72927),s=i(16282),n=i(95872),o=i(73371),a=i(940),l=i(59213),c=i(22756);class u extends o.LineDataSource{constructor(e,t){super(e,t||u.createProperties()),this.version=2,this._scaleRatioFormatter=new n.LimitedPrecisionNumericFormatter(7),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,41306)).then(({GannComplexPaneView:e})=>{this._setPaneViews([new e(this,this.model())])});const r=this.properties();this._adjustScaleRatio(r),r.subscribe(this,this._adjustScaleRatio),r.childs().scaleRatio.subscribe(this,this._correctFirstPoint),this._syncStateExclusions=["scaleRatio"],r.addExclusion("scaleRatio"),r.onRestoreFactoryDefaults().subscribe(this,this._handleRestoringFactoryDefaults),this._onTemplateApplying.subscribe(this,this._handleTemplateApplying),this._onTemplateApplied.subscribe(this,this._correctFirstPoint)}migrateVersion(e,t,i){1===e&&(this._points.length>=this.pointsCount()?setTimeout(()=>this._migratePoint()):this._timePoint.length>=this.pointsCount()&&this._pointAdded.subscribe(this,this._migratePoint))}destroy(){const e=this.properties();e.unsubscribe(this,this._adjustScaleRatio),e.childs().scaleRatio.unsubscribe(this,this._correctFirstPoint),e.onRestoreFactoryDefaults().unsubscribe(this,this._handleRestoringFactoryDefaults),this._onTemplateApplying.unsubscribe(this,this._handleTemplateApplying),this._onTemplateApplied.unsubscribe(this,this._correctFirstPoint),super.destroy()}pointsCount(){return 2}name(){return"Gann Square"}addPoint(e,t,i){this._points.length>1&&this._points.pop();const r=super.addPoint(e,t,i),n=this.priceScale();return!(0,s.ensureNotNull)(n).isLog()&&r&&this._correctFirstPoint(),r}setPoint(e,t,i){super.setPoint(e,t,i),void 0!==i&&i.shift()?this._correctPoint(e):this._correctScaleRatio()}setLastPoint(e,t){const i=this.priceScale();(0,s.ensureNotNull)(i).isLog()||(this._points[1]=e,this._correctPoint(1)),super.setLastPoint(e,t)}isReversed(){
return this.properties().childs().reverse.value()}levelsCount(){return this.properties().childs().levels.childCount()}levels(){const e=[],t=this.properties().childs(),i=t.levels.childCount();for(let r=0;r<i;r++){const i=t.levels.childs()[r].childs();e.push({index:r,visible:i.visible.value(),color:i.color.value(),width:i.width.value()})}return e}fanLinesCount(){return this.properties().childs().fanlines.childCount()}fanLines(){const e=[],t=this.properties().childs(),i=t.fanlines.childCount();for(let r=0;r<i;r++){const i=t.fanlines.childs()[r].childs();e.push({index:r,visible:i.visible.value(),x:i.x.value(),y:i.y.value(),color:i.color.value(),width:i.width.value()})}return e}arcsCount(){return this.properties().childs().arcs.childCount()}arcs(){const e=[],t=this.properties().childs(),i=t.arcs.childCount();for(let r=0;r<i;r++){const i=t.arcs.childs()[r].childs();e.push({index:r,visible:i.visible.value(),x:i.x.value(),y:i.y.value(),color:i.color.value(),width:i.width.value()})}return e}arcsBackgroundTransparency(){return this.properties().childs().arcsBackground.childs().transparency.value()}isArcsBackgroundFilled(){return this.properties().childs().arcsBackground.childs().fillBackground.value()}isLabelsVisible(){return this.properties().childs().showLabels.value()}getLabelsStyle(){const e=this.properties().childs(),{font:t,fontSize:i,bold:r,italic:s}=e.labelsStyle.childs(),n=e.levels.childCount();return{textColor:e.levels.childs()[n-1].childs().color.value(),font:t.value(),fontSize:i.value(),bold:r.value(),italic:s.value()}}getScaleRatioStep(){return 1e-7}getScaleRatioFormatter(){return this._scaleRatioFormatter}getPriceDiff(){const e=this.points();if(e.length<2)return null;const[t,i]=e;return i.price-t.price}getIndexDiff(){const e=this.points();if(e.length<2)return null;const[t,i]=e;return i.index-t.index}getScaleRatio(){const e=this.getPriceDiff(),t=this.getIndexDiff();return null!==e&&null!==t&&0!==t?Math.abs(e/t):null}static createProperties(e){const t=(0,l.createPropertiesObject)("linetoolganncomplex",e);return u._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,98283)).then(e=>e.GannComplexAndFixedDefinitionsViewModel)}static _configureProperties(e){o.LineDataSource._configureProperties(e);const t=[],i=[],r=e.childs();{const e=r.levels.childCount();for(let s=0;s<e;s++){const e=r.levels.childs()[s].childs();t.push(e.width),i.push(e.color)}}{const e=r.fanlines.childCount();for(let s=0;s<e;s++){const e=r.fanlines.childs()[s].childs();t.push(e.width),i.push(e.color)}}{const e=r.arcs.childCount();for(let s=0;s<e;s++){const e=r.arcs.childs()[s].childs();t.push(e.width),i.push(e.color)}}e.addChild("linesColors",new c.LineToolColorsProperty(i)),e.addChild("linesWidths",new c.LineToolWidthsProperty(t))}_correctScaleRatio(){const e=this.properties().childs(),t=this.getScaleRatio();e.scaleRatio.setValue(t)}_getAdjustedScaleRatio(){const e=this.model().mainSeries().priceScale(),t=this.model().timeScale();return(0,
a.scaleRatio)(t,e)}_adjustScaleRatio(e){const t=e.scaleRatio.value();""!==t&&null!==t||e.scaleRatio.setValue(this._getAdjustedScaleRatio())}_correctPoint(e){if(this._points.length<2)return;const t=this.getIndexDiff();if(null===t)return;const i=this.properties().childs().scaleRatio.value();if(null!==i){const r=this._points[e],s=0===e?this._points[1]:this._points[0],n=r.price-s.price>0,o=r.index-s.index>0;let a=n&&!o||!n&&o?-1:1;0===e&&(a=-a),r.price=s.price+a*t*i,this._pointChanged.fire(e)}this.normalizePoints()}_correctFirstPoint(){this._correctPoint(this.isReversed()?0:1)}_handleRestoringFactoryDefaults(){this.properties().childs().scaleRatio.setValue(this._getAdjustedScaleRatio())}_handleTemplateApplying(e){""===e.scaleRatio&&(e.scaleRatio=this._getAdjustedScaleRatio())}_migratePoint(){if(this.points().length<this.pointsCount())return;const e=this._getScreenPoints();if(null===e)return;const t=this.screenPointToPoint(e[1]);this.setPoint(1,t),this._pointAdded.unsubscribe(this,this._migratePoint)}_getScreenPoints(){const e=this._calcAngle();if(null===e)return null;let[t,i]=this.points();this.isReversed()&&([t,i]=[i,t]);const s=this.pointToScreenPoint(t)[0],n=this.pointToScreenPoint(i)[0],o=Math.sqrt(Math.pow(s.x-n.x,2)+Math.pow(s.y-n.y,2)),a=new r.Point(Math.cos(e),-Math.sin(e)),l=a.normalized(),c=l.x<0?-1:1,u=l.y<0?-1:1;return[s.addScaled(a,o),s.add(new r.Point(5*o*c,5*o*u))]}_calcAngle(){const[e,t]=this.points(),i=this.pointToScreenPoint(e)[0];let r=this.pointToScreenPoint(t)[0].subtract(i);if(r.length()>0){r=r.normalized();let e=Math.acos(r.x);return r.y>0&&(e=-e),e}return null}}},66706:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(92372),n=i(22756),o=n.LineToolWidthsProperty,a=n.LineToolColorsProperty;class l extends r{constructor(e,t){super(e,t||l.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,48468,19)).then(({GannFanPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}levelsCount(){return l.LevelsCount}pointsCount(){return 2}name(){return"Gann Fan"}processErase(e,t){var i="level"+t,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,25573))).GannFanDefinitionsViewModel}static createProperties(e){var t=new s("linetoolgannfan",e,!1,{range:[1,9]});return l._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e);for(var t=[],i=[],s=1;s<=l.LevelsCount;s++)t.push(e.child("level"+s).child("linewidth")),i.push(e.child("level"+s).child("color"));e.addChild("linesColors",new a(i)),e.addChild("linesWidths",new o(t))}}l.LevelsCount=9,t.LineToolGannFan=l},26752:(e,t,i)=>{"use strict";i.d(t,{LineToolGannFixed:()=>a});var r=i(72927),s=i(73371),n=i(22756),o=i(59213);class a extends s.LineDataSource{constructor(e,t){super(e,t||a.createProperties()),this._constructor="LineToolGannFixed",
Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,52012)).then(({GannFixedPaneView:e})=>{this._setPaneViews([new e(this,this.model())])}),this.properties().childs().reverse.subscribe(this,this._reversePoints)}pointsCount(){return 2}name(){return"Gann Square Fixed"}axisPoints(){const e=this.points(),t=this.getScreenPoints();return e.length<2||t.length<2?[]:[e[0],this.screenPointToPoint(t[1])]}getScreenPoints(){const e=this.points();if(e.length<2)return[];const t=this._calcAngle();if(null===t)return[];const[i,s]=e,n=this.pointToScreenPoint(i)[0],o=this.pointToScreenPoint(s)[0],a=Math.sqrt(Math.pow(n.x-o.x,2)+Math.pow(n.y-o.y,2)),l=new r.Point(Math.cos(t),-Math.sin(t)),c=l.normalized(),u=c.x<0?-1:1,d=c.y<0?-1:1;return[n.addScaled(l,a),n.add(new r.Point(5*a*u,5*a*d))]}levelsCount(){return this.properties().childs().levels.childCount()}levels(){const e=[],t=this.properties().childs(),i=t.levels.childCount();for(let r=0;r<i;r++){const i=t.levels.childs()[r].childs();e.push({index:r,visible:i.visible.value(),color:i.color.value(),width:i.width.value()})}return e}fanLinesCount(){return this.properties().childs().fanlines.childCount()}fanLines(){const e=[],t=this.properties().childs(),i=t.fanlines.childCount();for(let r=0;r<i;r++){const i=t.fanlines.childs()[r].childs();e.push({index:r,visible:i.visible.value(),x:i.x.value(),y:i.y.value(),color:i.color.value(),width:i.width.value()})}return e}arcsCount(){return this.properties().childs().arcs.childCount()}arcs(){const e=[],t=this.properties().childs(),i=t.arcs.childCount();for(let r=0;r<i;r++){const i=t.arcs.childs()[r].childs();e.push({index:r,visible:i.visible.value(),x:i.x.value(),y:i.y.value(),color:i.color.value(),width:i.width.value()})}return e}arcsBackgroundTransparency(){return this.properties().childs().arcsBackground.childs().transparency.value()}isArcsBackgroundFilled(){return this.properties().childs().arcsBackground.childs().fillBackground.value()}static createProperties(e){const t=(0,o.createPropertiesObject)("linetoolgannfixed",e);return a._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,98283)).then(e=>e.GannComplexAndFixedDefinitionsViewModel)}static _configureProperties(e){s.LineDataSource._configureProperties(e);const t=[],i=[],r=e.childs();{const e=r.levels.childCount();for(let s=0;s<e;s++){const e=r.levels.childs()[s].childs();t.push(e.width),i.push(e.color)}}{const e=r.fanlines.childCount();for(let s=0;s<e;s++){const e=r.fanlines.childs()[s].childs();t.push(e.width),i.push(e.color)}}{const e=r.arcs.childCount();for(let s=0;s<e;s++){const e=r.arcs.childs()[s].childs();t.push(e.width),i.push(e.color)}}e.addChild("linesColors",new n.LineToolColorsProperty(i)),e.addChild("linesWidths",new n.LineToolWidthsProperty(t))}_calcAngle(){const e=this.points();if(e.length<2)return null;const[t,i]=e,r=this.pointToScreenPoint(t)[0];let s=this.pointToScreenPoint(i)[0].subtract(r);if(s.length()<=0)return null;s=s.normalized()
;let n=Math.acos(s.x);return s.y>0&&(n=-n),n}_reversePoints(){const[e,t]=this._points;this._points[0]=t,this._points[1]=e,this.normalizePoints(),this.restart()}}},46055:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(92372),n=i(22756).LineToolColorsProperty,o=[4.5,9,11.25,18,22.5,36,45],a=function(){for(var e=[],t=o.length-1,i=1,r=0,s=0;s<1e10;)s=o[r]*i,e.push(Math.round(s)),e.push(Math.ceil(-s)),r===t-1&&(i*=10),r=(r+1)%t;return e.sort((function(e,t){return e<t?-1:e>t?1:0})),e}();class l extends r{constructor(e,t){super(e,t||l.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,15165,19)).then(({GannSquarePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}hLevelsCount(){return l.HLevelsCount}vLevelsCount(){return l.VLevelsCount}pointsCount(){return 2}name(){return"Gann Box"}_alignPriceOnPattern(e,t){var i=Math.round(1e6*(e.price-t.price))/1e6;if(0===i)return t.price;for(var r=o[0],s=o[o.length-1],n=1,a=Math.abs(i);a<r*n||s*n<a;)a<r*n?n*=.1:s*n<a&&(n*=10);for(var l=s*n,c=o.length-2;c>=0&&!(o[c]*n<a);--c)l=o[c]*n;return e.price=t.price+(i>=0?l:-l),e}_alignTimeOnPattern(e,t){var i=e.index-t.index;if(0===i)return 0;for(var r=a.length-2;r>=0&&!(a[r]<i);--r);return r+=i>0?1:0,e.index=t.index+a[r],e}_alignPointsFixedIncrement(e,t){return this._alignTimeOnPattern(e,t),this._alignPriceOnPattern(e,t),e}_preparePoint(e,t){return t&&t.shift()&&0!==this._points.length&&this._alignPointsFixedIncrement(e,this._points[0]),super._preparePoint(e,t)}getPoint(e){if(e<2)return super.getPoint(e);var t=null;switch(e){case 2:case 3:var i=this.points();if(i.length===this.pointsCount()){var r=i[0].index,s=i[1].price;3===e&&(r=i[1].index,s=i[0].price),t={index:r,price:s}}}return t}setPoint(e,t,i){if(i&&i.shift()){var r=e%2==0?this._points[1]:this._points[0];this._alignPointsFixedIncrement(t,r)}switch(e){case 2:this._points[0].index=t.index,this._points[1].price=t.price;break;case 3:this._points[1].index=t.index,this._points[0].price=t.price;break;default:super.setPoint(e,t,i)}}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,44012))).GannSquareDefinitionsViewModel}static createProperties(e){var t=new s("linetoolgannsquare",e,!1,{range:[1,7],prefixes:["h","v"],names:["coeff","color","visible"]});return l._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e);for(var t=[e.child("color"),e.child("fans").child("color")],i=1;i<=l.HLevelsCount;i++)t.push(e.child("hlevel"+i).child("color"));for(i=1;i<=l.VLevelsCount;i++)t.push(e.child("vlevel"+i).child("color"));e.addChild("linesColors",new n(t)),e.addExclusion("linesColors")}}l.HLevelsCount=7,l.VLevelsCount=7,t.LineToolGannSquare=l},90767:(e,t,i)=>{"use strict";var r=i(84162).sign,s=i(73371).LineDataSource,n=i(1771).DefaultProperty;class o{constructor(e,t,i){this._source=e,this._index=t,this._bars=i||[]}setBars(e){this._bars=e||[]}clone(e){return new o(e,this._index,TradingView.clone(this._bars))}createBar(){
var e=this._source.properties().averageHL.value(),t=this._source.properties().variance.value()/100,i=this._source._model.mainSeries().base(),r=Math.random(),s=e*(1-2*r)*t,n=e*(1+(.5-(r=Math.random()))*t),o=s-n/2,a=o+n;return{o:(o+Math.random()*n)/i,h:a/i,l:o/i,c:(o+Math.random()*n)/i}}generate(){this._bars=[];var e=this._source.points(),t=e[this._index],i=e[this._index+1];if(t&&i&&t.index!==i.index){this._avgHL=this._source.properties().averageHL.value(),this._variance=this._source.properties().variance.value()/100;for(var s=this._index?t.index+1:t.index,n=r(i.index-t.index),o=s;o!==i.index;o+=n)this._bars.push(this.createBar())}}bars(){return this._bars}setSize(e){if(e<this._bars.length)this._bars.splice(e,this._bars.length-e);else for(;this._bars.length<e;)this._bars.push(this.createBar())}}class a extends s{constructor(e,t,r){var s=t||a.createProperties();if(super(e,s),this._segments=[],!r){var n=Math.round(this.calculateATR(e));s.averageHL.setValue(n)}s.averageHL.listeners().subscribe(this,a.prototype.regenerate),s.variance.listeners().subscribe(this,a.prototype.regenerate),s.points||s.addProperty("points"),this._currentAverageHL=this._properties.averageHL.value(),this._currentVariance=this._properties.variance.value(),this._currentInterval=e.mainSeries().interval(),this.properties().onRestoreFactoryDefaults().subscribe(this,this._handleRestoringFactoryDefaults),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,63319,19)).then(({GhostFeedPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}isSynchronizable(){return!1}_handleRestoringFactoryDefaults(){var e=Math.round(this.calculateATR());this.properties().averageHL.setValue(e)}destroy(){this.properties().onRestoreFactoryDefaults().unsubscribe(this,this._handleRestoringFactoryDefaults),super.destroy()}regenerate(){this._currentAverageHL=this._properties.averageHL.value(),this._currentVariance=this._properties.variance.value(),this._segments.forEach((function(e){e.generate()})),this.updateAllViews(),this._model.updateSource(this)}propertiesChanged(){super.propertiesChanged(),this._currentAverageHL===this._properties.averageHL.value()&&this._currentVariance===this._properties.variance.value()||this.regenerate()}pointsCount(){return-1}name(){return"Ghost Feed"}segmentBars(e){return this._segments[e].bars()}segments(){return this._segments}generateBars(e){this._segments.length<=e&&this._segments.push(new o(this,e)),this._segments[e].generate()}addPoint(e){if(this._points.length>0&&this._points[this._points.length-1].index===e.index){this._lastPoint=null,this.normalizePoints(),this.createServerPoints();for(var t=0;t<this._points.length;t++)this._createPointProperty(t);return!0}var i=s.prototype.addPoint.call(this,e);return this._finished&&(this._lastPoint=null),this._points.length>1&&this.generateBars(this._points.length-2),i||this._finished}finish(){this._finished=!0,this._lastPoint=null,this.normalizePoints(),this.createServerPoints()}setPoint(e,t,i){if(super.setPoint(e,t,i),e>0){var r=this.points()[e-1],s=t.index-r.index
;this._segments[e-1].setSize(Math.abs(s))}if(e<this.points().length-1){s=this.points()[e+1].index-t.index;this._segments[e].setSize(Math.abs(s))}}state(e){var t=s.prototype.state.call(this,e);return t.segments=this._segments.map((function(e){return{bars:e.bars()}})),t}restoreData(e){var t=this;e.segments&&(this._segments=e.segments.map((function(e,i){return new o(t,i,[].concat(e.bars))}))),this._currentAverageHL=this._properties.averageHL.value(),this._currentVariance=this._properties.variance.value()}onData(e){if(super.onData(e),0===this.pointsProperty().childs().points._childs.length)for(var t=0;t<this._points.length;t++)this._createPointProperty(t);this._currentInterval!==this._model.mainSeries().interval()&&(this.regenerate(),this._currentInterval=this._model.mainSeries().interval())}cloneData(e){var t=this;this._segments=e._segments.map((function(e){return e.clone(t)}))}calculateATR(e){var t=(void 0!==e?e:this._model).mainSeries(),i=[];t.bars().each((function(e,t){i.push(t[TradingView.HIGH_PLOT]-t[TradingView.LOW_PLOT])}));var r=0===i.length?0:i.reduce((function(e,t){return e+t}),0)/i.length;return r*=t.base()}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,94387))).GhostFeedDefinitionsViewModel}static createProperties(e){var t=new n("linetoolghostfeed",e);return a._configureProperties(t),t}static _configureProperties(e){s._configureProperties(e)}}t.LineToolGhostFeed=a},43515:(e,t,i)=>{"use strict";i.d(t,{LineToolHeadAndShoulders:()=>o});var r=i(1771),s=i(73371),n=i(22756);class o extends s.LineDataSource{constructor(e,t){const r=t||o.createProperties();super(e,r),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,71307)).then(t=>{this._setPaneViews([new t.LineToolHeadAndShouldersPaneView(this,e)])})}pointsCount(){return 7}name(){return"Head and Shoulders"}static createProperties(e){const t=new r.DefaultProperty("linetoolheadandshoulders",e);return o._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,12162)).then(e=>e.PatternWithBackgroundDefinitionViewModel)}static _configureProperties(e){s.LineDataSource._configureProperties(e),e.addChild("linesColors",new n.LineToolColorsProperty([e.childs().color])),e.addChild("textsColors",new n.LineToolColorsProperty([e.childs().textcolor]))}}},52189:(e,t,i)=>{"use strict";i.d(t,{LineToolHighlighter:()=>n});var r=i(1771),s=i(94864);class n extends s.LineToolBrushBase{constructor(e,t){super(e,t||n.createProperties()),this._loadPaneViews(e)}smooth(){return this.properties().childs().smooth.value()}name(){return"Highlighter"}static createProperties(e){const t=new r.DefaultProperty("linetoolhighlighter",e);return n._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,39578)).then(e=>e.HighlighterDefinitionsViewModel)}_loadPaneViews(e){
Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,9823)).then(t=>{this._setPaneViews([new t.HighlighterPaneView(this,e)])})}static _configureProperties(e){s.LineToolBrushBase._configureProperties(e)}}},27586:(e,t,i)=>{"use strict";i.d(t,{LineToolHorzLinePriceAxisView:()=>s});var r=i(32552);class s extends r.PriceAxisView{constructor(e){super(),this._source=e}_updateRendererData(e,t,i){e.visible=!1;const r=this._source.points(),s=this._source.priceScale();if(0===r.length||null===s||s.isEmpty())return;const n=r[0];if(!isFinite(n.price))return;const o=this._source.ownerSource(),a=null!==o?o.firstValue():null;if(null===a)return;const l=this._source.properties().linecolor.value();i.background=l,i.textColor=this.generateTextColor(l),i.coordinate=s.priceToCoordinate(n.price,a),e.text=s.formatPrice(n.price,a),e.visible=!0}}},34566:(e,t,i)=>{"use strict";i.d(t,{LineToolHorzLine:()=>l});var r=i(27937),s=i.n(r),n=i(1771),o=i(73371),a=i(27586);class l extends o.LineDataSource{constructor(e,t){super(e,t||l.createProperties()),this._priceAxisView=new a.LineToolHorzLinePriceAxisView(this),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,55653)).then(({HorzLinePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}state(e){const t=super.state(e);return t.points&&0!==t.points.length&&(t.points[0].offset=0),t}pointsCount(){return 1}name(){return"Horizontal Line"}priceAxisViews(e,t){return this.isSourceHidden()||t!==this.priceScale()||!this._model.selection().isSelected(this)&&!this.properties().childs().showPrice.value()||e!==this._model.paneForSource(this)?null:[this._priceAxisView]}timeAxisViews(){return null}timeAxisPoints(){return[]}updateAllViews(){super.updateAllViews(),this._priceAxisView.update()}canHasAlert(){return!0}template(){const e=super.template();return e.text=this.properties().childs().text.value(),e}denormalizeTimePoints(){this._points=[],this._timePoint.length>0&&this._points.push({price:this._timePoint[0].price,index:0})}clearData(){const e=this._points;super.clearData(),this._points=e}static createProperties(e){const t=new n.DefaultProperty("linetoolhorzline",e);return l._configureProperties(t),t}_getAlertPlots(){return[this.points()[0].price]}_pointsForPointset(){return[]}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,23985)).then(e=>e.HorizontalLineDefinitionsViewModel)}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text||"")}static _configureProperties(e){o.LineDataSource._configureProperties(e),e.hasChild("text")||e.addChild("text",new(s())("")),e.addExclusion("text")}}},99331:(e,t,i)=>{"use strict";i.d(t,{LineToolHorzRay:()=>l});var r=i(1771),s=i(27937),n=i.n(s),o=i(27586),a=i(73371);class l extends a.LineDataSource{constructor(e,t){super(e,null!=t?t:l.createProperties()),this._priceAxisView=new o.LineToolHorzLinePriceAxisView(this),
Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,12242)).then(({HorzRayPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}pointsCount(){return 1}name(){return"Horizontal Ray"}priceAxisViews(e,t){return this.isSourceHidden()||t!==this.priceScale()||!this._model.selection().isSelected(this)&&!this.properties().childs().showPrice.value()||e!==this._model.paneForSource(this)?null:[this._priceAxisView]}updateAllViews(){super.updateAllViews(),this._priceAxisView.update()}template(){const e=super.template();return e.text=this.properties().childs().text.value(),e}canHasAlert(){return!0}static createProperties(e){const t=new r.DefaultProperty("linetoolhorzray",e);return l._configureProperties(t),t}_getAlertPlots(){const e=this._points[0],t={index:e.index+1,price:e.price};return[this._linePointsToAlertPlot([e,t],null,!1,!0)]}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,83097))).HorizontalRayDefinitionsViewModel}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text||"")}static _configureProperties(e){a.LineDataSource._configureProperties(e),e.hasChild("text")||e.addChild("text",new(n())("")),e.addExclusion("text")}}},94994:(e,t,i)=>{"use strict";i.d(t,{LineToolIcon:()=>o});var r=i(1771),s=i(73371),n=i(22756);class o extends s.LineDataSource{constructor(e,t){super(e,t||o.createProperties()),this._sizeScale=NaN,this.version=1,document.fonts&&document.fonts.check&&document.fonts.load&&!document.fonts.check("12px FontAwesome")&&document.fonts.load("12px FontAwesome","☺").then(()=>{this._isDestroyed||e.updateSource(this)}),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,94891)).then(t=>{this._setPaneViews([new t.IconPaneView(this,e)])})}pointsCount(){return 1}name(){return"Icon"}hasEditableCoordinates(){return!1}getAnchorLimit(){return 80}applyTemplate(e){delete e.icon,super.applyTemplate(e)}startChanging(e,t){super.startChanging(e,t);const i=this.properties().childs();i.size.value()<80?this._sizeScale=i.size.value()/80:this._sizeScale=1}getChangePointForSync(e){return null}setPoint(e,t,i){const r=Object.assign({},t),s=this.pointToScreenPoint(this.points()[0])[1],n=this.pointToScreenPoint(r)[1],o=this.properties().childs();if(0===e||1===e){const t=n.subtract(s).normalized(),i=-t.x;let r=Math.acos(i);Math.asin(t.y)>0&&(r=2*Math.PI-r),0===e&&(r+=Math.PI),o.angle.setValue(r)}else{let e=2*n.subtract(s).length();e*=this._sizeScale,o.size.setValue(e),o.scale.setValue(1)}}endChanging(e,t){const i=super.endChanging(e,t);return this._sizeScale=NaN,i}getSourceIcon(){return{type:"text",text:String.fromCharCode(this.properties().childs().icon.value())}}static createProperties(e){const t=new r.DefaultProperty("linetoolicon",e);return o._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,7894)).then(e=>e.IconsDefinitionsViewModel)}
static _configureProperties(e){s.LineDataSource._configureProperties(e),e.addChild("backgroundsColors",new n.LineToolColorsProperty([e.childs().color])),e.addExclusion("angle"),e.addExclusion("scale")}}},17117:(e,t,i)=>{"use strict";i.d(t,{isIdeaUrl:()=>l,isIdeaAuthorProfileImageUrl:()=>c,createIdeaLineToolByUrl:()=>d});var r=i(16282),s=i(75443),n=i(44197),o=i(86023);const a=/^\/chart\/.+?\/([0-9a-zA-Z]{8})(-[-\w]+)?\/?$/;function l(e){try{const t=new URL(e);return"https:"===t.protocol&&t.hostname.endsWith(".tradingview.com")&&a.test(t.pathname)}catch(e){return!1}}function c(e){if(e.startsWith("data:image/svg+xml,"))return!0;try{const t=new URL(e),i=new URL(window.AWS_S3_CDN);return t.protocol===i.protocol&&t.hostname===i.hostname&&t.pathname.includes("/userpics/")}catch(e){return!1}}async function u(e){const t=new URL(`/api/v1/ideas/${i=e,(0,r.ensureNotNull)(a.exec(new URL(i).pathname))[1]}/`,location.href);var i;return fetch(t.toString()).then(e=>{if(!e.ok)throw new Error("Error processing idea: "+e.statusText);return e.json()})}function d(e,t){return u(e).then(e=>{const i=function(e,t){var i;const s=(0,r.ensureDefined)(e.user);let o;s.avatars&&c(s.avatars.small)&&(o=s.avatars.small.startsWith("data:image/svg+xml,")?s.avatars.small:s.avatars.small.replace(window.AWS_S3_CDN,"")+"?resetCache=true");const a={avatarUrl:o,badges:null===(i=s.badges)||void 0===i?void 0:i.map(e=>e.name),username:s.username};return{createdAt:e.created_timestamp,direction:e.direction,name:(0,n.clean)(e.name,!0),author:a,uuid:e.uuid}}(e),a={price:0,time_t:i.createdAt,offset:0},l=t.mainSeries(),u=(0,r.ensureNotNull)(t.model().paneForSource(l)),d=u.newLineToolZOrder(!0),h={type:"drawing",source:{id:(0,s.randomHashN)(6),zorder:d,type:"LineToolIdea",position:50,state:{interval:"1",...o.LineToolIdea.createProperties().state()},ideaData:i,symbol:l.symbol(),ownerSource:l.id(),points:[a]},geometry:[],modelId:t.model().id()};return t.pasteLineTool(u,h,!0,!0)})}},86023:(e,t,i)=>{"use strict";i.d(t,{LineToolIdea:()=>w});var r=i(1771),s=i(73371),n=i(20220),o=i(29098),a=i(87380),l=i(35252),c=i(14397),u=i(57807),d=i(17117);const h=(0,a.getLogger)("Chart.IdeaDialog"),p=(0,n.t)("Idea"),_=(0,n.t)("Insert a link to the idea");let m=null;function f(e){"LineToolIdea"===e?(window.is_authenticated||(0,c.resetToCursor)(!0),window.runOrSignIn(()=>{c.tool.setValue("LineToolIdea"),m=(0,u.showCustomUrlEventDialog)({onConfirm:g,onClose:()=>{m=null,"LineToolIdea"===c.tool.value()&&(0,c.resetToCursor)(!0)},title:p,placeholderText:_}),(0,o.trackEvent)("Idea","Open idea dialog")},{source:"Change drawing tool state"})):null!==m&&m.then(e=>e())}function g(e){const t=(0,l.chartWidgetCollectionService)();if(null===t)return;if(!(0,d.isIdeaUrl)(e))return void h.logWarn("Invalid idea url: "+e);const i=t.activeChartWidget.value();(0,d.createIdeaLineToolByUrl)(e,i.model())}var v=i(27937),S=i.n(v),y=i(66116);class b extends y.CustomEventItem{constructor(e,t){super(t),this._data=e}ideaData(){return this._data}index(){return this._source.eventTimePointIndex()}time(){
return this._data.createdAt}avatar(){var e;return null===(e=this._data.author)||void 0===e?void 0:e.avatarUrl}}class w extends y.LineToolCustomUrlEvent{constructor(e,t){super(e,t||w.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,5514)).then(t=>{this._setPaneViews([new t.IdeaPaneView(this,e)])})}name(){return"Idea"}state(e){const t=super.state(e);return this._item&&(t.ideaData=this._item.ideaData()),e&&(t.eventTimePointIndex=this._eventTimePointIndex),t}restoreData(e){e.ideaData&&(this._item=new b(e.ideaData,this)),void 0!==e.eventTimePointIndex&&(this._eventTimePointIndex=e.eventTimePointIndex)}static createProperties(e){const t=new r.DefaultProperty("linetoolIdea",e);return w._configureProperties(t),t.hasChild("position")||t.addChild("position",new(S())(50)),t.addExclusion("position"),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,52386)).then(e=>e.IdeaDefinitionsViewModel)}static _configureProperties(e){s.LineDataSource._configureProperties(e)}}(0,c.runOnDrawingStateReady)(()=>{c.tool.subscribe(f)})},56810:(e,t,i)=>{"use strict";i.d(t,{buildAbsoluteUserImageUrl:()=>p,LineToolImage:()=>_});var r=i(16282),s=i(72927),n=i(87380),o=i(1771),a=i(27937),l=i.n(a),c=i(73371);const u=(0,n.getLogger)("Chart.LineToolImage");function d(e){return e.toLowerCase().startsWith("blob:")}const h=window.AWS_BBS3_DOMAIN;function p(e){if(d(e))return e;const t=new URL(e,h),i=new URL(t.pathname,h);if("/"===i.pathname)return null;const r=i.toString();return t.toString()!==r?null:r}class _ extends c.LineDataSource{constructor(e,t){var r;super(e,t||_.createProperties()),this._image=null,this._originPoint=4;const s=this.properties().childs().url;this._absoluteUserImageUrl=new(l())(null!==(r=p(this.properties().childs().url.value()))&&void 0!==r?r:""),this._absoluteUserImageUrl.subscribe(this,e=>{const t=e.value();if(d(t))return;const i=p(t);null!==i&&s.setValue(new URL(i).pathname)}),s.subscribe(this,()=>{const e=p(s.value());null!==e&&this._absoluteUserImageUrl.setValue(e)}),this._loadImage(),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,44890)).then(({ImagePaneView:t})=>{this._setPaneViews([new t(this,e)])}),this.properties().childs().url.subscribe(this,()=>{this._loadImage()})}absoluteUserImageUrl(){return this._absoluteUserImageUrl}cssWidth(){return this.properties().childs().cssWidth.value()}cssHeight(){return this.properties().childs().cssHeight.value()}angle(){return this.properties().childs().angle.value()}originPoint(){return this._originPoint}dOffsetX(){return this._dOffsetX||0}pointsCount(){return 1}name(){return"Image"}image(){return this._image}setBlobImageUrl(e){this._image||(this._createImage(e),this._blobUrl=e)}getChangePointForSync(e){return null}hasEditableCoordinates(){return!1}pointToScreenPoint({index:e,price:t},i=0){const n=this._model.timeScale(),o=(0,r.ensureNotNull)(this.priceScale()),a=(0,r.ensureNotNull)((0,
r.ensureNotNull)(this.ownerSource()).firstValue()),l=n.indexToCoordinate(e)+i,c=o.priceToCoordinate(t,a);return[new s.Point(l,c),new s.Point(l,c)]}setPoint(e,t,i){if(null===this._image)return;const{width:r,height:s}=this._image,[n]=this.pointToScreenPoint(t),[o]=this.pointToScreenPoint(this._points[0],this.dOffsetX()),a=Math.max(Math.abs(o.x-n.x)/r,Math.abs(o.y-n.y)/s),l=Math.round(r*a),c=Math.round(s*a),u=this.properties().childs();u.cssWidth.setValue(l),u.cssHeight.setValue(c),this.propertiesChanged()}startChanging(e,t){super.startChanging(e,t),this._changeOriginPoint(_._oppositePoints[e])}endChanging(e,t){return this._changeOriginPoint(4),super.endChanging(e,t)}getPoint(){return null}syncLineStyleState(){const e=super.syncLineStyleState();return!e.url&&this._blobUrl&&(e.blobUrl=this._blobUrl),e}restoreExternalState(e){const{blobUrl:t,...i}=e;t&&this.setBlobImageUrl(t),super.restoreExternalState(i)}isSavedInChart(){return super.isSavedInChart()&&""!==this.absoluteUserImageUrl().value()}static createProperties(e){const t=new o.DefaultProperty("linetoolimage",e);return _._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,77647)).then(e=>e.ImageDefinitionsViewModel)}static _configureProperties(e){c.LineDataSource._configureProperties(e),e.hasChild("url")||e.addChild("url",new(l())("")),e.addExclusion("url"),e.addExclusion("cssWidth"),e.addExclusion("cssHeight"),e.addExclusion("angle")}_loadImage(){const e=this.properties(),t=(0,r.ensureDefined)(e.child("url")).value();t&&this._createImage(t)}_changeOriginPoint(e){const t=this.originPoint(),i=4===t?_._correctOriginDirections[e]:_._correctOriginDirections[_._oppositePoints[t]],r=this.properties().childs().cssWidth.value()/2,n=this.properties().childs().cssHeight.value()/2,[o]=this._points,[a]=this.pointToScreenPoint(o),l=new s.Point(a.x+r*i[0],a.y+n*i[1]),c=this.screenPointToPoint(l);this._dOffsetX=4===t?l.x-this.pointToScreenPoint(c)[0].x:void 0,o.index=c.index,o.price=c.price,this._originPoint=e}_createImage(e){var t;const i=d(e),s=p(e);if(null===s)return void u.logWarn("Invalid image URL: "+e);if(s===(null===(t=this._image)||void 0===t?void 0:t.src))return;const n=document.createElement("img");n.crossOrigin="anonymous",n.src=s,n.addEventListener("load",()=>{this._image=n;const e=this._model,t=this.properties().childs();if(!i){const e=new URL(s).pathname;t.url.setValue(e),this._blobUrl=void 0}if(t.cssWidth.value()&&t.cssHeight.value())return void this._model.updateSource(this);const o=e.timeScale().width()/4,a=(0,r.ensureNotNull)(this.priceScale()).height()/4,l=n.naturalWidth,c=n.naturalHeight,u=Math.min(1,o/l),d=Math.min(1,a/c),h=Math.min(u,d),p=Math.round(h*l),_=Math.round(h*c);t.cssWidth.setValue(p),t.cssHeight.setValue(_),this.updateAllViews(),this._model.updateSource(this)}),n.addEventListener("error",()=>{this.model().removeSource(this)})}}_._correctOriginDirections=[[-1,-1],[1,-1],[-1,1],[1,1],[0,0]],_._oppositePoints=[3,2,1,0,4]},78815:(e,t,i)=>{
"use strict";i.d(t,{blobImageFilter:()=>o,imageIsOversized:()=>l,generateLink:()=>c,uploadImage:()=>u});var r=i(85864),s=i(14900),n=i(20220);function o(e){return"image/png"===e.type||"image/jpeg"===e.type}const a=new s.Size(2e3,2e3);function l(e){return e.width>=a.w||e.height>=a.h}async function c(e){const t=new FormData,i="name"in e?e.name:"image.png";t.append("content_type",e.type),t.append("filename",i),t.append("size",""+e.size);const s=await(0,r.fetch)("/charts/uploads/generate-link/",{method:"POST",body:t});if(!s.ok)throw new Error("Error generating upload link: "+s.status);return s.json()}async function u(e){if(!await async function(e){return new Promise((t,i)=>{const r=new FileReader;r.onload=e=>{var r;const s=new Image;s.src=null===(r=e.target)||void 0===r?void 0:r.result,s.onload=()=>{t(!l(s))},s.onerror=i},r.onerror=i,r.readAsDataURL(e)})}(e))throw new Error((0,n.t)("The image being pasted is way too large"));try{const t=await c(e),i=t.data.fields,s=new FormData;for(const e of Object.keys(i))s.append(e,i[e]);s.append("file",e);const n=await(0,r.fetch)(t.data.url,{method:"POST",body:s});if(n.ok)return t.data.url+t.filepath;throw new Error("Upload response is not ok: "+n.status)}catch(e){throw new Error("Error uploading image: "+e.message)}}},42249:(e,t,i)=>{"use strict";i.d(t,{LineToolInfoLine:()=>n});var r=i(1771),s=i(35200);class n extends s.LineToolTrendLine{constructor(e,t){super(e,t||n.createProperties())}pointsCount(){return 2}name(){return"Info Line"}static createProperties(e){const t=new r.DefaultProperty("linetoolinfoline",e);return n._configureProperties(t),t}static _configureProperties(e){s.LineToolTrendLine._configureProperties(e)}}},74544:(e,t,i)=>{"use strict";var r=i(92372),s=i(45155).LineToolPitchfork;class n extends s{constructor(e,t){super(e,t||n.createProperties())}name(){return"Inside Pitchfork"}static createProperties(e){var t=new r("linetoolinsidepitchfork",e,!1,{range:[0,8]});return n._configureProperties(t),t}static _configureProperties(e){s._configureProperties(e)}}t.LineToolInsidePitchfork=n},32719:(e,t,i)=>{"use strict";var r;i.d(t,{isStudyLineToolName:()=>o,isLineToolName:()=>a,isLineDrawnWithPressedButton:()=>l,isLineToolDrawWithoutPoints:()=>c,isImageToolName:()=>u,isTextToolName:()=>d});var s=i(22275);const n=new Set(["LineStudyMtpAnalysis","LineStudyMtpDecisionPoint","LineStudyMtpRiskReward","LineStudyMtpElliotWaveMain","LineStudyMtpElliotWaveMajor","LineStudyMtpElliotWaveMinor","LineStudyMtpDownWave1OrA","LineStudyMtpDownWave2OrB","LineStudyMtpDownWave3","LineStudyMtpDownWave4","LineStudyMtpDownWave5","LineStudyMtpDownWaveC","LineStudyMtpUpWave1OrA","LineStudyMtpUpWave2OrB","LineStudyMtpUpWave3","LineStudyMtpUpWave4","LineStudyMtpUpWave5","LineStudyMtpUpWaveC"]);function o(e){let t=!1;return t="LineToolVbPFixed"===e||"LineToolRegressionTrend"===e||"LineToolAnchoredVWAP"===e||"LineToolFixedRangeVolumeProfile"===e||function(e){return n.has(e)}(e),t}function a(e){return e in(r||(r=i.t(s,2)))||o(e)}function l(e){return"LineToolBrush"===e||"LineToolHighlighter"===e}function c(e){
return"LineToolTweet"===e||"LineToolIdea"===e}function u(e){return"LineToolImage"===e}function d(e){switch(e){case"LineToolBalloon":case"LineToolText":case"LineToolTextAbsolute":case"LineToolCallout":case"LineToolNote":case"LineToolNoteAbsolute":case"LineToolSignpost":return!0}return!1}},20990:(e,t,i)=>{"use strict";i.d(t,{LineDataSourceBase:()=>k});var r=i(72927),s=i(16282),n=i(88001),o=i(87380),a=i(96861),l=i(14397),c=i(96276),u=i.n(c),d=i(27937),h=i.n(d),p=i(22756);class _ extends(h()){constructor(e,t){super(),this._lineSource=e,this._pointIndex=t,e.pointAdded().subscribe(this,e=>{this._pointIndex===e&&this._listeners.fire(this)}),e.pointChanged().subscribe(this,e=>{this._pointIndex===e&&this._listeners.fire(this)})}value(){const e=this._lineSource.points()[this._pointIndex].price,t=(0,s.ensureNotNull)(this._lineSource.ownerSource()).formatter();if(t.parse){const i=t.format(e),r=t.parse(i);return r.res?r.value:e}return e}setValue(e){const t=this._lineSource.points()[this._pointIndex];t.price=parseFloat(""+e),this._lineSource.startChanging(this._pointIndex,t),this._lineSource.setPoint(this._pointIndex,t),this._lineSource.model().updateSource(this._lineSource),this._listeners.fire(this);const i=this._lineSource.endChanging(!0,!1);this._lineSource.syncMultichartState(i)}}var m=i(48467),f=i(2459),g=i(1694),v=i(5489),S=i(20554),y=i(82324),b=i(65066),w=i.n(b),P=i(94420),C=i(19453),T=i(53423),x=i(45087),I=i(57415),L=i(31565);const M=(0,o.getLogger)("Chart.LineDataSource");class E{constructor(){this._states=[]}start(e){this._states.push(e)}finish(e){const t=(0,s.ensureDefined)(this._states.pop());return r=t,(i=e).length!==r.length?{indexesChanged:!0,pricesChanged:!0}:i.reduce((e,t,i)=>{const s=r[i];return e.indexesChanged=e.indexesChanged||t.index!==s.index,e.pricesChanged=e.pricesChanged||t.price!==s.price,e},{indexesChanged:!1,pricesChanged:!1});var i,r}isEmpty(){return 0===this._states.length}}let A=0;class k extends a.DataSource{constructor(e,t){super(),this.version=1,this.customization={forcePriceAxisLabel:!1,disableErasing:!1,disableSave:!1,showInObjectsTree:!0},this._currentPointsetId=null,this._pointChanged=new(u()),this._pointAdded=new(u()),this._alertUndoMode=!1,this._priceAxisViews=[],this._timeAxisViews=[],this._timePoint=[],this._points=[],this._lastPoint=null,this._paneViews=new Map,this._normalizedPointsChanged=new(u()),this._fixedPointsChanged=new(u()),this._changeStatesStack=new E,this._startMovingPoint=null,this._currentMovingPoint=null,this._fixedPoints=[],this._isActualSymbol=!1,this._isActualInterval=!1,this._isActualCurrency=!1,this._isActualUnit=!1,this._onTemplateApplying=new(u()),this._onTemplateApplied=new(u()),this._syncStateExclusions=[],this._syncLineStyleMuted=!1,this._onIsActualIntervalChange=new(u()),this._linkKey=new(w())(null),this._model=e,this._properties=t,this._localAndServerAlertsMismatch=!1,e.mainSeries().symbolResolved().subscribe(this,this._onMainSeriesSymbolResolved)}destroy(){this._paneViews.forEach((e,t)=>this._destroyPanePaneViews(t)),
this._model.mainSeries().symbolResolved().unsubscribeAll(this)}linkKey(){return this._linkKey}boundToSymbol(){return!0}points(){const e=[];for(let t=0;t<this._points.length;t++){const i=this._points[t];e.push({index:i.index,price:i.price,time:i.time})}return this._lastPoint&&e.push({index:this._lastPoint.index,price:this._lastPoint.price}),!this.isFixed()&&this._currentMovingPoint&&this._startMovingPoint&&this._correctPoints(e),e}timeAxisPoints(){return this.points()}priceAxisPoints(){return this.points()}normalizedPoints(){return this._timePoint}normalizedPointsChanged(){return this._normalizedPointsChanged}fixedPointsChanged(){return this._fixedPointsChanged}widthsProperty(){var e;return null!==(e=this._properties.childs().linesWidths)&&void 0!==e?e:null}lineColorsProperty(){var e;return null!==(e=this._properties.childs().linesColors)&&void 0!==e?e:null}backgroundColorsProperty(){var e;return null!==(e=this._properties.childs().backgroundsColors)&&void 0!==e?e:null}textColorsProperty(){var e;return null!==(e=this._properties.childs().textsColors)&&void 0!==e?e:null}pointsProperty(){return this._pointsProperty}startMoving(e,t,i,r){this.isFixed()&&this.restoreFixedPoints(),this._startMovingPoint=e}move(e,t,i,r){if(i&&(i.shiftOnly()||i.controlShift()))if(this.isFixed()){const t=this._alignScreenPointHorizontallyOrVertically((0,s.ensureDefined)(e.screen));this._currentMovingPoint={screen:t}}else{const t=this._alignPointHorizontallyOrVertically((0,s.ensureDefined)(e.logical));this._currentMovingPoint={logical:t}}else this._currentMovingPoint=e;this.updateAllViews()}endMoving(e,t){let i=!1,r=!1;if(this._currentMovingPoint&&this._startMovingPoint){if(this.isFixed())this._correctFixedPoints(this._fixedPoints)&&this._fixedPointsChanged.fire();else{const e=(0,s.ensureDefined)(this._currentMovingPoint.logical),t=(0,s.ensureDefined)(this._startMovingPoint.logical);i=e.index!==t.index,r=e.price!==t.price;if(this._correctPoints(this._points)){n.emit("drawing_event",this._id,"move");for(let e=0;e<this._points.length;e++)this._pointChanged.fire(e)}}this._startMovingPoint=null,this._currentMovingPoint=null}const o={indexesChanged:i,pricesChanged:r};return this.isFixed()?(this.calcPositionPercents(),this.updateAllViews(),o):(this.updateAllViews(),i&&!e?(this._properties.childs().interval.setValue(this._model.mainSeries().interval()),this.normalizePoints(),this.createServerPoints()):(this._copyPricesWithoutNormalization(),this._normalizedPointsChanged.fire()),(r||i)&&this.synchronizeAlert(!this._alertUndoMode),o)}startMovingPoint(){return this._startMovingPoint?{...this._startMovingPoint}:null}currentMovingPoint(){return this._currentMovingPoint?{...this._currentMovingPoint}:null}startChanging(e,t){void 0!==e&&void 0!==t&&(e<this._priceAxisViews.length&&this._priceAxisViews[e].setActive(!0),e<this._timeAxisViews.length&&this._timeAxisViews[e].setActive(!0)),this._changeStatesStack.start(this.points())}endChanging(e,t){const i=this._changeStatesStack.finish(this.points())
;i.indexesChanged&&this._changeStatesStack.isEmpty()?(this._properties.childs().interval.setValue(this._model.mainSeries().interval()),this.normalizePoints(),t||this.createServerPoints()):(this._copyPricesWithoutNormalization(),this._normalizedPointsChanged.fire());for(let e=0;e<this._priceAxisViews.length;e++)this._priceAxisViews[e].setActive(!1);for(let e=0;e<this._timeAxisViews.length;e++)this._timeAxisViews[e].setActive(!1);return this.synchronizeAlert(!e),i}setPoint(e,t,i,r){if(i&&i.shift()&&this._snapTo45DegreesAvailable()){const i=0===e?1:e-1;this._snapPoint45Degree(t,this.points()[i])}this._points[e].index===t.index?(this._points[e].price=t.price,this._pointChanged.fire(e)):(this._points[e]=t,this._pointChanged.fire(e))}getPoint(e){return this.points()[e]||null}setLastPoint(e,t){this._lastPoint=this._preparePoint(e,t),this.updateAllViews()}lastPoint(){return this._lastPoint}getChangePointForSync(e){return this.getPoint(e)}setPoints(e){this._points=e}isForcedDrawPriceAxisLabel(){return this.customization.forcePriceAxisLabel}clearData(){this._points=[]}denormalizeTimePoints(){let e=[];for(let t=0;t<this._timePoint.length;t++){const i=this._model.timeScale().denormalizeTimePoint(this._timePoint[t]);if(void 0===i){e=[];break}e.push({index:i,price:this._timePoint[t].price})}e.length>0&&(this._points=e)}restorePoints(e,t,i){this._timePoint=(0,g.deepCopy)(e),this._points=t,i||this.denormalizeTimePoints()}restorePositionPercents(e){this._positionPercents=e}calcIsActualSymbol(){if(this._model.mainSeries().hasDelayedSymbolIntervalChange())return;const e=this.ownerSource();if(null===e)this._isActualSymbol=!1;else{const t=(0,s.ensureNotNull)(e.symbolSource());this._migrateSymbolProperty();const i=this._properties.childs().symbol,r=i.value();if(this._isActualSymbol=t.symbolSameAsCurrent(r),this._isActualSymbol){const e=t.symbol();(0,v.areEqualSymbols)(r,e)||(M.logWarn('Possible drawing "migrating" detected from "'+r+'" to "'+e+'"'),M.logWarn("Series symbolInfo: "+JSON.stringify(t.symbolInfo())),M.logWarn(""+(new Error).stack)),i.setValue(e)}}this.calcIsActualInterval(),this.calcIsActualCurrency(),this.calcIsActualUnit(),this._onSourceHiddenMayChange()}calcIsActualCurrency(){const e=this.ownerSource();if(null===e)return void(this._isActualCurrency=!1);const t=this._properties.childs().currencyId.value();if(null!==t){const i=e.symbolSource();if(null===i)return;this._isActualCurrency=t===(0,S.symbolCurrency)(i.symbolInfo(),void 0,!0)}else{const t=(0,s.ensureNotNull)(e.symbolSource()).symbolInfo();this._isActualCurrency=null!==t&&(0,S.symbolCurrency)(t)===(0,S.symbolOriginalCurrency)(t)}this._onSourceHiddenMayChange()}calcIsActualUnit(){const e=this.ownerSource();if(null===e)return void(this._isActualUnit=!1);const t=this._properties.childs().unitId.value();if(null!==t)this._isActualUnit=t===(0,s.ensureNotNull)(e.symbolSource()).unit();else{const t=(0,s.ensureNotNull)(e.symbolSource()).symbolInfo();this._isActualUnit=null!==t&&(0,S.symbolUnit)(t)===(0,S.symbolOriginalUnit)(t)}this._onSourceHiddenMayChange()}
calcIsActualInterval(){const e=this._isActualInterval,t=this._properties,i=this._model.mainSeries();this._isActualInterval=(0,T.isActualInterval)(f.Interval.parse(i.interval()),t.childs().intervalsVisibilities),!this._isActualInterval&&this._model.selection().isSelected(this)&&this._model.selectionMacro(e=>e.removeSourceFromSelection(this)),this._isActualInterval!==e&&this._onIsActualIntervalChange.fire(),this._onSourceHiddenMayChange()}paneViews(e){if(this.isSourceHidden())return null;const t=this._getPaneViews(this.isMultiPaneAvailable()?e:void 0);if(null===t)return null;if(1===t.length)return[t[0]];const i=[];for(let e=t.length-1;e>=0;--e)i.push(t[e]);return i}isSavedInChart(){return!this.customization.disableSave}setSavingInChartEnabled(e){this.customization.disableSave=!e}detachAlert(){const e=this.getAlertSync();if(e&&this._alertCallbacks){const t=this._alertCallbacks;e.off("destroy",t.remove),e.off("change:hovered",t.hovered),e.off("change:selected",t.selected)}this.hasAlert.setValue(!1),this._alertId=void 0}removeAlert(){this._alertId=void 0,this.hasAlert.setValue(!1)}deleteAlert(){{if(!this.hasAlert.value()||void 0===this._alertId)return;const e=(0,y.getPriceAlertsDispatcherIfExists)();e&&e.deleteAlert(this._alertId),this.removeAlert()}}areLocalAndServerAlertsMismatch(){return this._localAndServerAlertsMismatch}showInObjectTree(){return this.customization.showInObjectsTree}setShowInObjectsTreeEnabled(e){this.customization.showInObjectsTree=e}start(){this.createServerPoints()}onData(e){"pointset_error"!==e.method?e.params.customId===this._currentPointsetIdWithPrefix()&&this._onPointsetUpdated(e.params.plots):M.logError(`Error getting pointset: ${e.params[0]} ${e.params[1]}`)}isActualSymbol(){return this._isActualSymbol}isActualCurrency(){return this._isActualCurrency}isActualInterval(){return this._isActualInterval}isActualUnit(){return this._isActualUnit}onIsActualIntervalChange(){return this._onIsActualIntervalChange}setOwnerSource(e){null!==this._ownerSource&&(this._ownerSource.currencyChanged().unsubscribeAll(this),this._ownerSource.unitChanged().unsubscribeAll(this)),super.setOwnerSource(e),e&&(this.setPriceScale(e.priceScale()),e.currencyChanged().subscribe(this,this.calcIsActualCurrency),e.unitChanged().subscribe(this,this.calcIsActualUnit),this.calcIsActualSymbol(),this._migrateZOrder())}dataAndViewsReady(){return this._paneViews.size>0}pointAdded(){return this._pointAdded}pointChanged(){return this._pointChanged}addPoint(e,t,i){const r=this._preparePoint(e,t);return this._addPointIntenal(r,t,i)}propertiesChanged(e){this.calcIsActualInterval(),this.updateAllViewsAndRedraw(),e||this._syncLineStyleIfNeeded()}state(e){var t,i;const r={type:this.toolname,id:this.id(),state:this.properties().state(null!==(t=this._propertiesStateExclusions())&&void 0!==t?t:void 0),points:(0,g.deepCopy)(this._timePoint),zorder:this.zorder(),ownerSource:null===(i=this.ownerSource())||void 0===i?void 0:i.id()};return this.linkKey().value()&&(r.linkKey=this.linkKey().value()),delete r.state.points,e&&(r.indexes=this._points),
this.isFixed()&&(r.positionPercents=this._positionPercents||this.calcPositionPercents()),"version"in this&&1!==this.version&&(r.version=this.version),this._saveAlertIdInState()&&this.hasAlert.value()&&void 0!==this._alertId&&(r.alertId=this._alertId.toString()),r}updateAllViewsAndRedraw(){this.updateAllViews(),this._model.updateSource(this)}properties(){return this._properties}restoreExternalPoints(e,t){if(this._timePoint=(0,g.deepCopy)(e.points),t.indexesChanged){if(this.properties().childs().interval.setValue(e.interval),!this.isActualSymbol())return this._clearServerPoints(),void this._normalizedPointsChanged.fire();this.createServerPoints()}else{const t=Math.min(this._points.length,e.points.length);for(let i=0;i<t;i++)this._points[i].price=e.points[i].price}this._normalizedPointsChanged.fire()}restoreExternalState(e){this.properties().mergeAndFire(e)}applyTemplate(e){this._onTemplateApplying.fire(e),this._applyTemplateImpl(e),this.calcIsActualSymbol(),this.updateAllViews(),this.model().lightUpdate(),this._onTemplateApplied.fire()}template(){return this.properties().preferences()}isSourceHidden(){return!this._properties.childs().visible.value()||(0,l.hideAllDrawings)().value()&&this.canBeHidden()||!this._isActualInterval||!this._isActualSymbol||!this._isActualCurrency||!this._isActualUnit}createServerPoints(){if(!this._isActualSymbol)return;if(!this._model.chartApi().isConnected().value())return;if(this._clearServerPoints(),this._model.timeScale().isEmpty())return;if(0===this._timePoint.length&&this._points.length>0&&this.normalizePoints(),!this._readyToCreatePointset())return;const e=this._pointsForPointset();if(0===e.length)return;this._currentPointsetId=++A;const t=(0,s.ensureNotNull)(this._model.mainSeries().seriesSource().symbolInstanceId()),i=(0,C.getServerInterval)(this.properties().childs().interval.value());this._model.chartApi().createPointset(this._currentPointsetIdWithPrefix(),"turnaround",t,i,e,this.onData.bind(this))}finish(){}tryCreateServerPoints(){this.isFixed()||this.isSourceHidden()||null===this._currentPointsetId&&this.createServerPoints()}stop(){this._clearServerPoints()}restart(){this.isFixed()||(this._currentPointsetId=null,this.createServerPoints())}isStarted(){return null!==this._currentPointsetId}convertYCoordinateToPriceForMoving(e,t){var i;const r=(0,s.ensureNotNull)(this.priceScale());if(r.isEmpty())return null;const n=this.ownerSource(),o=(0,s.ensure)(null===(i=n||t)||void 0===i?void 0:i.firstValue());return r.coordinateToPrice(e,o)}syncMultichartState(e){const t={points:this._timePoint,interval:this._model.mainSeries().interval()},i=this.linkKey().value();if(null!==i&&this.isSynchronizable()){const r={model:this._model,linkKey:i,symbol:this._model.mainSeries().symbol(),finalState:t,changes:e};(0,l.finishChangingLineTool)(r)}}enableCurrentIntervalVisibility(){const e=this.properties().childs().intervalsVisibilities.state();void 0!==e&&((0,T.makeIntervalsVisibilitiesVisibleAtInterval)(e,f.Interval.parse(this._model.mainSeries().interval())),
this.properties().childs().intervalsVisibilities.mergeAndFire(e))}clonePositionOffset(){return this.isFixed()?{barOffset:0,xCoordOffset:20,yCoordOffset:20}:{barOffset:0,xCoordOffset:0,yCoordOffset:-40}}syncLineStyleState(){const e=this.properties().state(this._syncStateExclusions);return delete e.interval,e.intervalsVisibilities=(0,T.mergeIntervalVisibilitiesDefaults)(e.intervalsVisibilities),e}_pointsForPointset(){return this._timePoint.map(e=>[e.time_t,e.offset])}_snapPoint45Degree(e,t,i){const r=this._model.timeScale(),n=r.indexToCoordinate(t.index),o=r.indexToCoordinate(e.index)-n,a=(0,s.ensureNotNull)(this.priceScale()),l=t.price,c=e.price,u=(0,s.ensureNotNull)((0,s.ensureNotNull)(this.ownerSource()).firstValue()),d=a.priceToCoordinate(l,u),h=a.priceToCoordinate(c,u)-d,p=Math.round(Math.atan2(o,h)/Math.PI*4);if(2===Math.abs(p))i||(e.price=l);else if(0===Math.abs(p)||4===Math.abs(p))i||(e.index=t.index);else{const t=Math.sqrt(o*o+h*h),i=o<0?-1:1,s=h<0?-1:1;let l=Math.max(Math.abs(h),Math.abs(o));l/=l*Math.sqrt(2)/t;const c=Math.round(r.coordinateToIndex(n+l*i)),p=Math.abs(r.indexToCoordinate(c)-n),_=a.coordinateToPrice(d+p*s,u);e.index=c,e.price=_}}normalizePoint(e){return{...this._model.timeScale().normalizeBarIndex(e.index),price:e.price}}normalizePoints(){this._timePoint=[];for(let e=0;e<this._points.length;e++)if(void 0!==this._points[e].index){const t=this.normalizePoint(this._points[e]);if(!t.time_t){this._timePoint=[];break}this._timePoint.push(t)}this._normalizedPointsChanged.fire()}_setPaneViews(e,t,i){this._paneViews.set(t,e),void 0!==t&&i&&t.onDestroyed().subscribe(this,()=>this._destroyPanePaneViews(t)),this._model.lightUpdate()}_getPaneViews(e){return this._paneViews.get(e)||null}_updateAllPaneViews(){this._paneViews.forEach(e=>{for(const t of e)t.update()})}_alignPointHorizontallyOrVertically(e){const t=this.pointToScreenPoint(e)[1],i=(0,s.ensureDefined)((0,s.ensureNotNull)(this._startMovingPoint).logical),r=this.pointToScreenPoint(i)[1],n=Math.abs(r.x-t.x),o=Math.abs(r.y-t.y);if(n<10&&o<10)return e;return{index:n<o?i.index:e.index,price:n<o?e.price:i.price}}_alignScreenPointHorizontallyOrVertically(e){const t=(0,s.ensureDefined)((0,s.ensureNotNull)(this._startMovingPoint).screen),i=Math.abs(t.x-e.x),n=Math.abs(t.y-e.y);return i<10&&n<10?e:i<n?new r.Point(t.x,e.y):new r.Point(e.x,t.y)}_correctPoints(e){const t=(0,s.ensureDefined)((0,s.ensureNotNull)(this._currentMovingPoint).logical),i=(0,s.ensureDefined)((0,s.ensureNotNull)(this._startMovingPoint).logical),r=t.index-i.index,n=t.price-i.price;if(0===r&&0===n)return!1;for(let t=0;t<e.length;t++){const i=e[t];i.index=i.index+r,i.price+=n,e[t]=i}return!0}_correctFixedPoints(e){const t=(0,s.ensureDefined)((0,s.ensureNotNull)(this._currentMovingPoint).screen),i=(0,s.ensureDefined)((0,s.ensureNotNull)(this._startMovingPoint).screen),r=t.subtract(i);if(r.length()>=1){for(let t=0;t<e.length;t++)e[t]=e[t].add(r);return!0}return!1}_currentPointsetIdWithPrefix(){return"pointset_"+this._currentPointsetId}_clearServerPoints(){
null!==this._currentPointsetId&&this._model.chartApi().isConnected().value()&&this._model.chartApi().removePointset(this._currentPointsetIdWithPrefix()),this._currentPointsetId=null}_createPointProperty(e){const t=this._pointsProperty.childs().points;t.addProperty(""+e,{});const i=t[e];i.addChild("price",new _(this,e)),i.addChild("bar",new m.LineDataSourcePointIndexProperty(this,e))}_createPointsProperties(){this._pointsProperty=new(h()),this._pointsProperty.addChild("points",new(h()));for(let e=0;e<this.pointsCount();e++)this._createPointProperty(e)}_alignPointToRangeOfActualData(e){const t=(0,s.ensureNotNull)(this._model.mainSeries().bars().firstIndex()),i=(0,s.ensureNotNull)(this._model.mainSeries().bars().lastIndex());let r=Math.max(e.index,t);return r=Math.min(r,i),{...e,index:r}}_migrateSymbolProperty(){const e=this._properties.childs();if(e.symbolStateVersion.value()<2){const t=(0,s.ensureNotNull)(this.ownerSource()),i=(0,s.ensureNotNull)(t.symbolSource());if(i===this._model.mainSeries())return void e.symbolStateVersion.setValueSilently(2);if(null===i.symbolInfo())return;this._model.mainSeries().symbolSameAsCurrent(e.symbol.value())&&e.symbol.setValueSilently(i.symbol()),e.symbolStateVersion.setValueSilently(2)}}_migrateZOrder(){const e=this._properties.childs();e.zOrderVersion.value()<2&&(this.ownerSource()===this.model().mainSeries()&&this.setZorder(this.zorder()-this.model().mainSeries().obsoleteZOrder()),e.zOrderVersion.setValueSilently(2))}_preparePoint(e,t){const i=e;return t&&t.shift()&&this.points().length>=2&&this._snapTo45DegreesAvailable()&&this._snapPoint45Degree(i,this.points()[this.points().length-2]),i}_addPointIntenal(e,t,i){this._points.push(e);const r=this._points.length===this.pointsCount();return r?(this._lastPoint=null,i||(this.normalizePoints(),this.createServerPoints())):this._lastPoint=e,this._pointAdded.fire(this._points.length-1),r}_onSourceHiddenMayChange(){this._model.invalidate(P.InvalidationMask.validateAction(()=>{this._isDestroyed||this._processHibernate()}))}_processHibernate(){this.isSourceHidden()?this.isStarted()&&this.stop():this.isStarted()||this.start()}_saveAlertIdInState(){return!0}_onPointsetUpdated(e){if(0===e.length)return;for(let t=0;t<e.length;t++){const i=e[t],r=this._timePoint[i.index],s={index:i.value[0],time:new Date(1e3*i.value[1]),price:r.price};this._points.length<=i.index?(this._points.push(s),this._pointAdded.fire(this._points.length-1)):(this._points[i.index]=s,this._pointChanged.fire(i.index))}const t=this;t.checkAlert&&t.checkAlert(),this.updateAllViewsAndRedraw()}_snapTo45DegreesAvailable(){return!1}_onMainSeriesSymbolResolved(){const e=this.ownerSource();null===e||this._model.mainSeries()===e.symbolSource()||this.isSourceHidden()||this.createServerPoints()}_readyToCreatePointset(){return this._timePoint.length>0}_onAlertData(e){}_propertiesStateExclusions(){return null}_syncLineStyleIfNeeded(){const e=this.linkKey().value();!this._syncLineStyleMuted&&e&&(0,l.changeLineStyle)({linkKey:e,state:this.syncLineStyleState(),model:this._model})}
_muteSyncLineStyle(){this._syncLineStyleMuted=!0}_unmuteSyncLineStyleWithoutApplyingChanges(){this.propertiesChanged(),this._syncLineStyleMuted=!1}_applyTemplateImpl(e){e.intervalsVisibilities=(0,T.mergeIntervalVisibilitiesDefaults)(e.intervalsVisibilities);const t=this.properties();t.mergePreferences(e),t.saveDefaults(),this.propertiesChanged()}static _configureProperties(e){if(k._addCollectedProperties(e),e.hasChild("symbolStateVersion")||e.addChild("symbolStateVersion",new(h())(k._initialSymbolStateVersion())),e.hasChild("zOrderVersion")||e.addChild("zOrderVersion",new(h())(k._initialZOrderVersion())),e.hasChild("visible")||e.addChild("visible",new(h())(!0)),e.hasChild("frozen")||e.addChild("frozen",new(h())(!1)),e.hasChild("symbol")||e.addChild("symbol",new(h())("")),e.hasChild("currencyId")||e.addChild("currencyId",new(h())(null)),e.hasChild("unitId")||e.addChild("unitId",new(h())(null)),e.addExclusion("symbolStateVersion"),e.addExclusion("zOrderVersion"),e.addExclusion("visible"),e.addExclusion("frozen"),e.addExclusion("symbol"),e.addExclusion("currencyId"),e.addExclusion("unitId"),e.hasChild("intervalsVisibilities")){const t=(0,L.merge)((0,L.clone)(x.intervalsVisibilitiesDefaults),e.childs().intervalsVisibilities.state());e.removeProperty("intervalsVisibilities"),e.addChild("intervalsVisibilities",new I.IntervalsVisibilitiesProperty(t))}else e.addChild("intervalsVisibilities",new I.IntervalsVisibilitiesProperty(x.intervalsVisibilitiesDefaults));e.hasChild("title")||e.addChild("title",new(h())("")),e.addExclusion("symbolInfo"),e.addExclusion("points"),e.addExclusion("interval"),e.addExclusion("title"),e.hasChild("singleChartOnly")&&e.removeProperty("singleChartOnly")}static _addCollectedProperties(e){e.hasChild("linewidth")&&e.addChild("linesWidths",new p.LineToolWidthsProperty([(0,s.ensureDefined)(e.child("linewidth"))])),e.hasChild("linecolor")&&e.addChild("linesColors",new p.LineToolColorsProperty([(0,s.ensureDefined)(e.child("linecolor"))])),e.hasChild("backgroundColor")&&e.addChild("backgroundsColors",new p.LineToolColorsProperty([(0,s.ensureDefined)(e.child("backgroundColor"))])),e.hasChild("textColor")&&e.addChild("textsColors",new p.LineToolColorsProperty([(0,s.ensureDefined)(e.child("textColor"))])),e.addExclusion("linesWidths"),e.addExclusion("linesColors"),e.addExclusion("backgroundsColors"),e.addExclusion("textsColors")}static _initialSymbolStateVersion(){return 1}static _initialZOrderVersion(){return 1}_destroyPanePaneViews(e){const t=this._paneViews.get(e);if(void 0!==t)for(const e of t)e.destroy&&e.destroy();void 0!==e&&e.onDestroyed().unsubscribeAll(this),this._paneViews.delete(e)}_copyPricesWithoutNormalization(){const e=Math.min(this._points.length,this._timePoint.length);for(let t=0;t<e;t++)this._timePoint[t].price=this._points[t].price}}},76625:(e,t,i)=>{"use strict";i.d(t,{thirdPointCursorType:()=>h,LineSourcePaneView:()=>p});var r=i(72927),s=i(93669),n=i(748),o=i(62288),a=i(26184),l=i(19680),c=i(88558),u=i(16282);const d=s.colorsPalette["color-tv-blue-600"];function h(e,t){
const i=t.x-e.x,r=t.y-e.y,s=Math.abs(Math.atan2(i,r));return s>Math.PI/4&&s<3*Math.PI/4?c.PaneCursorType.VerticalResize:c.PaneCursorType.HorizontalResize}class p{constructor(e,t){this._invalidated=!0,this._points=[],this._floatPoints=[],this._middlePoint=null,this._selectionRenderers=[],this._lineAnchorRenderers=[],this._source=e,this._model=t}priceToCoordinate(e){const t=this._source.priceScale();if(null===t)return null;const i=this._source.ownerSource(),r=null!==i?i.firstValue():null;return null===r?null:t.priceToCoordinate(e,r)}currentPoint(){const e=this._model.crossHairSource();return new r.Point(e.originX(),e.originY())}anchorColor(){return d}isHoveredSource(){return this._source===this._model.hoveredSource()}isSelectedSource(){return this._model.selection().isSelected(this._source)}isBeingEdited(){return this._model.lineBeingEdited()===this._source}isEditMode(){return!this._model.isSnapshot()}areAnchorsVisible(){return(this.isHoveredSource()&&!this.isLocked()||this.isSelectedSource())&&this.isEditMode()}update(){this._invalidated=!0}isLocked(){return Boolean(this._source.isLocked&&this._source.isLocked())}addAnchors(e){let t=this._points;this._model.lineBeingCreated()===this._source&&(t=t.slice(0,-1));const i=t.map((e,t)=>{const i=this._source.points()[t],r=e;return r.snappingPrice=null==i?void 0:i.price,r.snappingIndex=null==i?void 0:i.index,r});e.append(this.createLineAnchor({points:i},0))}createLineAnchor(e,t){if(this.isLocked()){const i=this._getSelectionRenderer(t);return i.setData({bgColors:this._lineAnchorColors(e.points),points:e.points,visible:this.areAnchorsVisible(),hittestResult:o.HitTestResult.REGULAR,barSpacing:this._model.timeScale().barSpacing()}),i}const i=(0,n.lastEventIsTouch)(),r=this._getLineAnchorRenderer(t);return r.setData({...e,color:this.anchorColor(),backgroundColors:this._lineAnchorColors(e.points),currentPoint:this.currentPoint(),linePointBeingEdited:this.isBeingEdited()?this._model.linePointBeingEdited():null,hittestResult:o.HitTestResult.CHANGEPOINT,radius:i?13:6,strokeWidth:i?2:1,selected:this.isSelectedSource(),selectedStrokeWidth:i?0:3,visible:this.areAnchorsVisible()}),r}_lineAnchorColors(e){const t=(0,u.ensureNotNull)(this._model.paneForSource(this._source)).height();return e.map(e=>this._model.backgroundColorAtYPercentFromTop(e.y/t))}_updateImpl(e,t){this._points=[],this._floatPoints=[];if(this._model.timeScale().isEmpty())return;if(!this._validatePriceScale())return;const i=this._source.points();for(let e=0;e<i.length;e++){const t=i[e],r=this._source.pointToScreenPoint(t);if(!r)return;const s=r[0];s.data=e;const n=r[1];n.data=e,this._floatPoints.push(s),this._points.push(n)}2===this._points.length&&(this._middlePoint=this._source.calcMiddlePoint(this._points[0],this._points[1])),this._invalidated=!1}_validatePriceScale(){const e=this._source.priceScale();return null!==e&&!e.isEmpty()}_getSource(){return this._source}_getPoints(){return this._points}_getModel(){return this._model}_height(){const e=this._source.priceScale();return null!==e?e.height():0}_width(){
return this._model.timeScale().width()}_getSelectionRenderer(e){for(;this._selectionRenderers.length<=e;)this._selectionRenderers.push(new a.SelectionRenderer);return this._selectionRenderers[e]}_getLineAnchorRenderer(e){for(;this._lineAnchorRenderers.length<=e;)this._lineAnchorRenderers.push(new l.LineAnchorRenderer);return this._lineAnchorRenderers[e]}}},48467:(e,t,i)=>{"use strict";i.d(t,{LineDataSourcePointIndexProperty:()=>n});var r=i(27937),s=i.n(r);class n extends(s()){constructor(e,t){super(),this._lineSource=e,this._pointIndex=t}value(){return this._lineSource.points()[this._pointIndex].index}setValue(e){const t=this._lineSource.points()[this._pointIndex];t.index=e,this._lineSource.startChanging(this._pointIndex,t),this._setPointImpl(t),this._lineSource.model().updateSource(this._lineSource),this._listeners.fire(this);const i=this._lineSource.endChanging(!0,!1);this._lineSource.syncMultichartState(i)}_setPointImpl(e){this._lineSource.setPoint(this._pointIndex,e)}}},69722:(e,t,i)=>{"use strict";i.d(t,{LineToolPriceAxisView:()=>o});var r=i(16282),s=i(32552),n=i(53021);class o extends s.PriceAxisView{constructor(e,t){super(),this._active=!1,this._source=e,this._data=t}setActive(e){this._active=e}_updateRendererData(e,t,i){e.visible=!1;const r=this._source.model();if(!r.timeScale()||r.timeScale().isEmpty())return;const s=this._source.priceScale();if(null===s||s.isEmpty())return;if(!r.selection().isSelected(this._source)&&!this._source.isForcedDrawPriceAxisLabel())return;if(null===r.timeScale().visibleBarsStrictRange())return;const n=this._source.priceAxisPoints(),o=this._data.pointIndex;if(n.length<=o)return;const a=n[o];if(!isFinite(a.price))return;const l=this._source.ownerSource(),c=null!==l?l.firstValue():null;if(null===c)return;let u=this._data.backgroundPropertyGetter?this._data.backgroundPropertyGetter():null;null===u&&(u=this._getBgColor()),i.background=u,i.borderColor="#2E84A6",i.textColor=this.generateTextColor(u),i.coordinate=s.priceToCoordinate(a.price,c),e.text=this._formatPrice(a.price,c),e.visible=!0}_getBgColor(){return this._active?n.axisLabelBackgroundColor.active:n.axisLabelBackgroundColor.common}_formatPrice(e,t){return(0,r.ensureNotNull)(this._source.priceScale()).formatPrice(e,t)}}},45801:(e,t,i)=>{"use strict";i.d(t,{LineDataSourceTimeAxisView:()=>n});var r=i(81265),s=i(53021);class n extends r.TimeAxisView{constructor(e,t){super(e.model()),this._active=!1,this._source=e,this._pointIndex=t}setActive(e){this._active=e}_getBgColor(){return this._active?s.axisLabelBackgroundColor.active:s.axisLabelBackgroundColor.common}_getIndex(){if(!this._model.selection().isSelected(this._source))return null;const e=this._source.timeAxisPoints();return e.length<=this._pointIndex?null:e[this._pointIndex].index}}},73371:(e,t,i)=>{"use strict"
;var r=i(72927).Point,s=i(69722).LineToolPriceAxisView,n=i(45801).LineDataSourceTimeAxisView,o=i(14397),a=i(2459).Interval,l=i(87380).getLogger("Chart.LineDataSource"),c=i(88001),u=i(27937),d=i(22842),h=i(79200).reloginOrGoPro,p=i(36989).canPlaceAlertOnResolution,_=i(28709).showGoProAlertsOnSecondsDialog,m=i(82324).getPriceAlertsDispatcher,f=i(82324).getPriceAlertsDispatcherIfExists,g=i(40089).lineToolsLocalizedNames,v=d.enabled("datasource_copypaste"),S=i(20990).LineDataSourceBase;class y extends S{constructor(e,t){super(e,t),this._properties.hasChild("interval")||this._properties.addChild("interval",new u(e.mainSeries().interval())),this.calcIsActualSymbol(),this._properties.intervalsVisibilities.listeners().subscribe(this,y.prototype.calcIsActualSymbol);var i=this;if(this._properties.listeners().subscribe(this,(function(e){i.propertiesChanged()})),this._createPointsProperties(),this.pointsCount()>0)for(var r=0;r<this.pointsCount();r++)this._priceAxisViews.push(this.createPriceAxisView(r)),this._timeAxisViews.push(new n(this,r));this._properties.visible.listeners().subscribe(this,(function(e){var t=!1===o.hideAllDrawings().value();e.value()?e.value()&&t&&c.emit("drawing_event",this._id,"show"):(i._model.selection().isSelected(this)&&i._model.selectionMacro((function(e){e.removeSourceFromSelection(i)})),t&&c.emit("drawing_event",this._id,"hide")),i._onSourceHiddenMayChange()})),o.hideAllDrawings().subscribe(this,this._onSourceHiddenMayChange),this._definitionsViewModel=null,this._isDestroyed=!1}isAvailableInFloatingWidget(){return!0}visibilityKeyByInterval(e){var t,i=a.parse(e);return y.IntervalsVisibilities.forEach((function(e){e.kind===i.kind()&&e.from<=i.multiplier()&&e.to>=i.multiplier()&&(t=e.key)})),t}priceScale(){return this._ownerSource?this._ownerSource.m_priceScale:null}symbol(){return this._properties.symbol.value()}isSavedInStudyTemplates(){return!1}fixedPoints(){var e=[];if(this._positionPercents&&!this.priceScale().isEmpty())for(var t=0;t<this._positionPercents.length;t++){var i=this._positionPercents[t],s=this._model.timeScale().width()*i.x,n=this.priceScale().height()*i.y;e.push(new r(s,n))}else for(t=0;t<this._fixedPoints.length;t++)e.push(this._fixedPoints[t].clone());return this._lastPoint&&e.push(this._lastPoint.clone()),this._currentMovingPoint&&this._startMovingPoint&&this._correctFixedPoints(e),e}addFixedPoint(e){this._fixedPoints.push(e);var t=this._fixedPoints.length===this.pointsCount();return t&&this.calcPositionPercents(),t}calcPositionPercents(){if(!this.priceScale()||this.priceScale().isEmpty())return[];this._positionPercents=[];for(var e=0;e<this._fixedPoints.length;e++){var t=this._fixedPoints[e],i=t.x/this._model.timeScale().width(),r=t.y/this.priceScale().height();this._positionPercents.push({x:i,y:r})}return this._positionPercents}calcMiddlePoint(e,t){return new r((e.x+t.x)/2,(e.y+t.y)/2)}getPointByPosition(e,t,i,r){return[t,i,r][e]}restoreFixedPoints(){this._fixedPoints=this.fixedPoints()}dataWindowView(){return null}statusView(){return null}isSynchronizable(){
return this.priceScale()===this._model.mainSeries().priceScale()}priceAxisViews(e,t){if(t!==this.priceScale()||this.isSourceHidden())return null;if(this._model.lineBeingEdited()===this){var i=this._model.linePointBeingEdited();if(null!==i&&i<this._priceAxisViews.length){var r=this._priceAxisViews.slice(),s=r[i];return r.splice(i,1),r.push(s),r}return this._priceAxisViews}return this._priceAxisViews}timeAxisViews(){if(this.isSourceHidden())return null;if(this._model.lineBeingEdited()===this){var e=this._model.linePointBeingEdited();if(null!==e&&e<this._timeAxisViews.length){var t=this._timeAxisViews.slice(),i=t[e];return t.splice(e,1),t.push(i),t}return this._timeAxisViews}return this._timeAxisViews}updateAllViews(){if(!this._isActualSymbol||!this._isActualCurrency||!this._isActualUnit)return null;if(!this._properties.visible.value())return null;this._updateAllPaneViews();for(var e=this._priceAxisViews,t=0;t<e.length;t++)e[t].update();for(e=this._timeAxisViews,t=0;t<e.length;t++)e[t].update()}setLastFixedPoint(e){this._lastFixedPoint=e,this.updateAllViews()}title(){return this.translatedType()}translatedType(){return void 0!==g[this.toolname]?g[this.toolname]:"Line Tool"}name(){return"Line Tool"}isBeingEdited(){return this===this._model.lineBeingEdited()||this===this._model.sourceBeingMoved}isFixed(){return!1}isLocked(){return this.properties().frozen&&this.properties().frozen.value()}pointToScreenPoint(e){var t=this._model.timeScale(),i=this.priceScale(),s=this.ownerSource().firstValue();if(!i||i.isEmpty()||t.isEmpty()||null==s)return[new r(0,0),new r(0,0)];var n=t.indexToCoordinate(e.index,!0),o=e.price,a=i.priceToCoordinate(o,s),l=new r(n,a);n=t.indexToCoordinate(e.index,!1),a=i.priceToCoordinate(o,s);return[l,new r(n,a)]}screenPointToPoint(e){var t=this._model.timeScale(),i=this.priceScale(),r=t.coordinateToIndex(e.x),s=this.ownerSource().firstValue();if(null!==s&&isFinite(s))return{price:i.coordinateToPrice(e.y,s),index:r}}tags(){return[this.toolname]}createPriceAxisView(e){return new s(this,{pointIndex:e})}alertId(){return this._alertId}setAlert(e,t){var i=this;t=t||{};if(!this.canHasAlert())return Promise.reject("Line data source can not has alert");function r(){!t.noChartSave&&window.saver&&window.saver.saveChartSilently(null,(function(e){e&&413===e.status||h({feature:"savedChartsForAlertLimit"})}),{noDefaultOnFail:!0})}return i._alertId=parseInt(e),i.hasAlert.setValue(!0),i.getAlert().then((function(e){var t=i._model.hoveredSource()===i,s=i._model.selection().isSelected(i);return e?(i._processAlertHandlers("unsubscribe"),i._processAlertHandlers("subscribe"),e.set("hovered",t),e.set("selected",s),setTimeout(r,0),i._onAlertData(e),e):(l.logError("Failed to get alert, alert will not be saved with drawing in chart"),Promise.reject("got_no_alert"))})).catch((function(t){i._processAlertHandlers("unsubscribe"),"not_exists"===t?m().then((function(t){t.removeAlertFromAllChartsSilently(i.id(),e)})):l.logError("Getting alert or Saving chart failed: "+t)}))}_processAlertHandlers(e){var t,i,r=this
;if("unsubscribe"!==(e="subscribe"===e?"subscribe":"unsubscribe")||r._alertCallbacks){i="subscribe"===e?"on":"off",t=r.properties();var s=r._alertCallbacks||{remove:r.removeAlert.bind(r),hovered:function(e,t){var i=r._model.hoveredSource()===r;t&&!i?r._model.setHoveredSource(r,null):!t&&i&&r._model.setHoveredSource(null,null)},selected:function(e,t){t&&r._model.selectionMacro((function(e){e.addSourceToSelection(r)}))},synchronizeSilently:function(e){r.synchronizeAlert(!1)}};r._alertCallbacks||(r._alertCallbacks=s),r.getAlert().then((function(n){n&&(n[i]("destroy",s.remove),n[i]("change:hovered",s.hovered),n[i]("change:selected",s.selected),t.extendLeft&&t.extendLeft[e](r,s.synchronizeSilently),t.extendRight&&t.extendRight[e](r,s.synchronizeSilently))}))}}editAlert(e){var t=this;t.hasAlert.value()&&m().then((function(i){i.openEditDialog(t._alertId,{actionSource:e,error:function(e){"not_exists"===e&&t.removeAlert()}})}))}getAlert(){var e=this;return new Promise((function(t,i){m().then((function(r){r.requestAlert(e._alertId,{success:t,error:i})}))}))}getAlertSync(){if(!this._alertId)return null;var e=f();return e&&e.getAlertSync(this._alertId)||null}synchronizeAlert(e){this.hasAlert.value()&&setTimeout(()=>{this._isDestroyed||this._synchronizeAlert(e)},0)}_synchronizeAlert(e){var t=this,i=t._getUndoHistory();if(!t._undoCheckpointAlert&&!t._alertUndoMode){var r=i.undoStack().pop();t._undoCheckpointAlert=i.createUndoCheckpoint(),r&&i.undoStack().push(r)}function s(){t._alertUndoMode=!0,i.undoToCheckpoint(t._undoCheckpointAlert),setTimeout((function(){t._alertUndoMode=!1,t._localAndServerAlertsMismatch=!1}),0)}function n(e){"not_exists"!==e&&(l.logError("Getting alert failed: "+e),s())}p(t.stateForAlert().interval)?t.getAlert().then((function(i){i?(!function(e){var i=e.get("description")!==e.defaultDescription(),r=e.get("extra"),s=r.alertSeries(),n=t._model.mainSeries().stateForAlert();"MainSeries"===s.type&&n.actualSymbol===s.actualSymbol&&(r.mainSeries(n),r.alertSeries(n));e.set("resolution",t.stateForAlert().interval),r.drawing(t),i||e.setDefaultDescription();t._localAndServerAlertsMismatch=!0}(i),e&&(!function(e){m().then((function(i){i.restartAlert(e,{success:function(){t._localAndServerAlertsMismatch=!1},error:n,complete:function(){delete t._undoCheckpointAlert},actionSource:"drawing_sync"})}))}(i),t._onAlertData(i))):l.logError("Failed to get alert, drawing and alert are not synchronized")})).catch(n):t._alertUndoMode||(_(),s(),delete t._undoCheckpointAlert)}_getUndoHistory(){return this._model._undoModel.undoHistory()}stateForAlert(){if(!this.canHasAlert())return null;var e=this.state();e.id=this.idForAlert(),e.uniqueId=this.idForAlert(),e.title=this.title(),e.interval=this._model.mainSeries().interval();var t=this._getAlertPlots();return t&&(e.plots=t),e}_getAlertPlots(){return null}_linePointsToAlertPlot(e,t,i,r){if(2!==e.length)return l.logError("[Drawing Alert] Wrong points"),null;var s=this._model.timeScale();return!s||s.isEmpty()?null:{type:"LinePlot",title:t||this.title(),timestamp:s.indexToTimePoint(0),
offset1:e[0].index,offset2:e[1].index,price1:e[0].price,price2:e[1].price,extendBackward:i||!1,extendForward:r||!1}}getAlertIsActive(){if(!this._alertId)return!1;var e=this.getAlertSync(this._alertId);return Boolean(e&&e.get("active"))}geometry(){var e=this;return this.points().map((function(t){return function(t){var i=t.x/e._model.timeScale().width(),s=t.y/e.priceScale().height();return new r(i,s)}(e.pointToScreenPoint(t)[0])}))}model(){return this._model}_getPropertyDefinitionsViewModelClass(){return Promise.resolve(null)}getPropertyDefinitionsViewModel(){if(null===this._definitionsViewModel){var e=this;return e._getPropertyDefinitionsViewModelClass().then((function(t){return null===t||e._isDestroyed?null:(null===e._definitionsViewModel&&(e._definitionsViewModel=new t(e._model.undoModel(),e)),e._definitionsViewModel)}))}return Promise.resolve(this._definitionsViewModel)}hasEditableCoordinates(){return!0}getSourceIcon(){return{type:"loadSvg",svgId:"linetool."+this.toolname}}destroy(){super.destroy(),this.stop(),null!==this._definitionsViewModel&&(this._definitionsViewModel.destroy(),this._definitionsViewModel=null),null!==this._ownerSource&&(this._ownerSource.currencyChanged().unsubscribeAll(this),this._ownerSource.unitChanged().unsubscribeAll(this)),o.hideAllDrawings().unsubscribeAll(this),this.deleteAlert(),this._isDestroyed=!0}getOrderTemplate(){return null}copiable(){return v}cloneable(){return null!==this._ownerSource&&null!==this._ownerSource.firstValue()}movable(){return!0}}y.prototype.version=1,t.LineDataSource=y},22756:(e,t,i)=>{"use strict";i.r(t),i.d(t,{LineToolMultiplePropertyBaseImpl:()=>l,LineToolCollectedProperty:()=>c,LineToolWidthsProperty:()=>u,LineToolColorsProperty:()=>d,MultipleLineWidthsProperty:()=>p,MultipleLineColorsProperty:()=>_});var r=i(87380),s=i(96276),n=i.n(s);const o=(0,r.getLogger)("Chart.LineToolCollectedProperty");class a{applyValue(e,t){e.setValue(t)}}class l{constructor(e,t){this._onChange=new(n()),this._properties=e,e.forEach(e=>e.subscribe(this,()=>{this._onChange.fire(this)})),this._showIfProperty=t}visible(){var e;return!this._showIfProperty||(null===(e=this._showIfProperty)||void 0===e?void 0:e.value())}value(){if(0===this._properties.length)return o.logError("Incorrect call, should not request value of 0 properties"),"mixed";const e=this._properties[0].value();return 1===this._properties.length||this._properties.every(t=>t.value()===e)?e:"mixed"}state(){}merge(){}destroy(){this._properties.forEach(e=>e.unsubscribeAll(this))}subscribe(e,t){this._onChange.subscribe(e,t)}unsubscribe(e,t){this._onChange.unsubscribe(e,t)}unsubscribeAll(e){this._onChange.unsubscribeAll(e)}storeStateIfUndefined(){return!0}}class c extends l{setValue(e,t,i){if("mixed"===e)return;const r=null!=i?i:new a;this._properties.forEach(t=>r.applyValue(t,e))}}class u extends c{}class d extends c{firstColor(){return this._properties[0].value()}}class h extends l{setValue(e,t,i){if("mixed"===e)return;const r=null!=i?i:new a;this._properties.forEach(t=>t.setValue(e,void 0,r))}}class p extends h{}
class _ extends h{}},22275:(e,t,i)=>{"use strict";t.LineToolFibRetracement=i(49941).LineToolFibRetracement,t.LineToolFibChannel=i(29994).LineToolFibChannel,t.LineToolFibSpeedResistanceArcs=i(83750).LineToolFibSpeedResistanceArcs,t.LineToolProjection=i(99153).LineToolProjection,t.LineToolTrendBasedFibExtension=i(42161).LineToolTrendBasedFibExtension,t.LineToolElliott=i(69352).LineToolElliott,t.LineToolFibCircles=i(89706).LineToolFibCircles,t.LineToolVertLine=i(68265).LineToolVertLine,t.LineToolCrossLine=i(21414).LineToolCrossLine,t.LineToolBarsPattern=i(98754).LineToolBarsPattern,t.LineToolTrendBasedFibTime=i(6068).LineToolTrendBasedFibTime,t.LineToolFibTimeZone=i(84159).LineToolFibTimeZone,t.LineToolCircleLines=i(28061).LineToolCircleLines,t.LineToolDateRange=i(59919).LineToolDateRange,t.LineToolPriceRange=i(46835).LineToolPriceRange,t.LineToolDateAndPriceRange=i(46903).LineToolDateAndPriceRange,t.LineToolParallelChannel=i(85378).LineToolParallelChannel,t.LineToolTrendAngle=i(21540).LineToolTrendAngle,t.LineToolTrendLine=i(35200).LineToolTrendLine,t.LineToolInfoLine=i(42249).LineToolInfoLine,t.LineToolArrowMark=i(3914).LineToolArrowMark,t.LineToolImage=i(56810).LineToolImage,t.LineToolPitchfan=i(17146).LineToolPitchfan,t.LineToolGannSquare=i(46055).LineToolGannSquare,t.LineToolFibSpeedResistanceFan=i(62872).LineToolFibSpeedResistanceFan,t.LineToolGannComplex=i(26914).LineToolGannComplex,t.LineToolGannFixed=i(26752).LineToolGannFixed,t.LineToolGannFan=i(66706).LineToolGannFan,t.LineToolFibWedge=i(66165).LineToolFibWedge,t.LineToolPitchfork=i(45155).LineToolPitchfork,t.LineToolDisjointAngle=i(84145).LineToolDisjointChannel,t.LineToolFlatBottom=i(9779).LineToolFlatBottom,t.LineToolIcon=i(94994).LineToolIcon,t.LineToolRotatedRectangle=i(95197).LineToolRotatedRectangle,t.LineToolFibSpiral=i(98260).LineToolFibSpiral,t.LineToolHeadAndShoulders=i(43515).LineToolHeadAndShoulders,t.LineToolTriangle=i(99812).LineToolTriangle,t.LineToolTrianglePattern=i(44208).LineToolTrianglePattern,t.LineTool5PointsPattern=i(83944).LineTool5PointsPattern,t.LineToolThreeDrivers=i(64978).LineToolThreeDrivers,t.LineToolABCD=i(82394).LineToolABCD,t.LineToolPolyline=i(16977).LineToolPolyline,t.LineToolPath=i(67701).LineToolPath,t.LineToolPrediction=i(70092).LineToolPrediction,t.LineToolPriceLabel=i(19275).LineToolPriceLabel,t.LineToolArrowMarker=i(83076).LineToolArrowMarker,t.LineToolNote=i(46851).LineToolNote,t.LineToolNoteAbsolute=i(46851).LineToolNoteAbsolute,t.LineToolSignpost=i(70642).LineToolSignpost,t.LineToolBrush=i(87820).LineToolBrush,t.LineToolArc=i(77453).LineToolArc,t.LineToolCallout=i(21786).LineToolCallout,t.LineToolBalloon=i(86738).LineToolBalloon,t.LineToolText=i(1479).LineToolText,t.LineToolHorzLine=i(34566).LineToolHorzLine,t.LineToolHorzRay=i(99331).LineToolHorzRay,t.LineToolRectangle=i(14694).LineToolRectangle,t.LineToolEllipse=i(37168).LineToolEllipse,t.LineToolTimeCycles=i(68911).LineToolTimeCycles,t.LineToolSineLine=i(52050).LineToolSineLine,t.LineToolGhostFeed=i(90767).LineToolGhostFeed,
t.LineToolBezierQuadro=i(29801).LineToolBezierQuadro,t.LineToolBezierCubic=i(84669).LineToolBezierCubic,t.LineToolArrow=i(8556).LineToolArrow,t.LineToolRay=i(30133).LineToolRay,t.LineToolExtended=i(3080).LineToolExtended,t.LineToolSchiffPitchfork=i(8404).LineToolSchiffPitchfork,t.LineToolSchiffPitchfork2=i(33356).LineToolSchiffPitchfork2,t.LineToolInsidePitchfork=i(74544).LineToolInsidePitchfork,t.LineToolTextAbsolute=i(1479).LineToolTextAbsolute,t.LineToolArrowMarkLeft=i(3914).LineToolArrowMarkLeft,t.LineToolArrowMarkRight=i(3914).LineToolArrowMarkRight,t.LineToolArrowMarkUp=i(3914).LineToolArrowMarkUp,t.LineToolArrowMarkDown=i(3914).LineToolArrowMarkDown,t.LineToolFlagMark=i(35929).LineToolFlagMark,t.LineToolCypherPattern=i(49362).LineToolCypherPattern,t.LineToolElliottImpulse=i(69352).LineToolElliottImpulse,t.LineToolElliottTriangle=i(69352).LineToolElliottTriangle,t.LineToolElliottTripleCombo=i(69352).LineToolElliottTripleCombo,t.LineToolElliottCorrection=i(69352).LineToolElliottCorrection,t.LineToolElliottDoubleCombo=i(69352).LineToolElliottDoubleCombo,t.LineToolRiskRewardLong=i(46049).LineToolRiskRewardLong,t.LineToolRiskRewardShort=i(46049).LineToolRiskRewardShort,t.LineToolPosition=i(55833).LineToolPosition,t.LineToolOrder=i(66962).LineToolOrder,t.LineToolHighlighter=i(52189).LineToolHighlighter,t.LineToolPriceNote=i(82998).LineToolPriceNote,t.LineToolTweet=i(44848).LineToolTweet,t.LineToolIdea=i(86023).LineToolIdea},34842:(e,t,i)=>{"use strict";i.d(t,{LineToolWithRelativePriceCoordinate:()=>a});var r=i(16282),s=i(73371),n=i(16584),o=i(14397);class a extends s.LineDataSource{constructor(){super(...arguments),this._startMovingAnchorY=NaN}priceSource(){return this.ownerSource()}addPoint(e,t,i){return super.addPoint(this._updatePositionAndCorrectPoint(e),t,i)}setPoint(e,t,i){super.setPoint(e,this._updatePositionAndCorrectPoint(t,!this.isPhantom()&&!this._allowChangeAnchorHorizontally()),i),this._syncPosition()}setPointAndChangeIndex(e,t,i){super.setPoint(e,this._updatePositionAndCorrectPoint(t,!1),i),this._syncPosition()}startMoving(e,t,i,s){s||(this._startMovingAnchorY=(0,r.ensureNotNull)(this._anchorYCoordinate())),super.startMoving(e,t,i)}move(e,t,i,s){var n;const o=(0,r.ensureDefined)((0,r.ensureNotNull)(this.startMovingPoint()).logical),a=(0,r.ensureDefined)(e.logical);if(!s&&0===t){const e=this._points[0],t=a.index-o.index,i=(0,r.ensureNotNull)(this.priceScale()),s=(0,r.ensure)(null===(n=this.ownerSource())||void 0===n?void 0:n.firstValue()),l=i.priceToCoordinate(a.price,s)-i.priceToCoordinate(o.price,s),c=this._startMovingAnchorY+l,u=i.coordinateToPrice(c,s);this._updatePositionAndCorrectPoint({index:e.index+t,price:u})}super.move(e,t,i),s||this._syncPosition()}_allowChangeAnchorHorizontally(){return!1}_updatePositionAndCorrectPoint(e,t){t&&(e.index=this._points[0].index);const i=this.priceSource();if(null===i)return e;const r=i.priceScale(),s=i.firstValue();if(null===r||r.isEmpty()||null===s)return e;const o=r.height();let a=o/2,l=e.price>=r.coordinateToPrice(a,s)?1:-1;const c=this._model.mainSeries()
;if(i===c){const t=c.data().search(this._baseSeriesIndexForPoint(e));if(null!==t){const i=(0,n.seriesPrice)(c,t,-1),o=(0,n.seriesPrice)(c,t,1);l=e.price>=i?1:-1,a=r.priceToCoordinate(1===l?o:i,s),e.price=1===l?Math.max(o,e.price):e.price}}const u=1===(-1===l!==r.isInverted()?-1:1)?a:o-a,d=r.priceToCoordinate(e.price,s),h=Math.min(o,Math.abs(d-a)),p=Math.max(0,Math.min(100,100*h/u))*l;return this.properties().childs().position.setValue(p),e}_baseSeriesIndexForPoint(e){return e.index}_syncPosition(){const e=this.linkKey().value();if(null!==e){const t={position:this.properties().childs().position.value()};(0,o.changeLineStyle)({linkKey:e,state:t,model:this._model})}}_anchorYCoordinate(){const e=this.priceSource();if(null===e)return null;const t=e.priceScale(),i=e.firstValue();if(null===t||t.isEmpty()||null===i)return null;const r=this._model.mainSeries(),s=this.customEvent();if(null===s)return null;let o=null;if(e===r&&(o=(0,n.seriesBasePosition)(r,s)),null===o&&(o=(0,n.noDataBasePosition)(s,t,i)),null===o)return null;const a=s.position(),l=t.priceToCoordinate(o.price,i);return(0,n.positionToCoordinate)(a,t.height(),l,(0,n.positionVisualDirection)(a,t.isInverted()))}}},40089:(e,t,i)=>{"use strict";i.d(t,{lineToolsLocalizedNames:()=>s});i(20220);var r=i(98006);const s={LineTool5PointsPattern:window.t("XABCD Pattern"),LineToolABCD:window.t("ABCD Pattern"),LineToolArc:window.t("Arc"),LineToolArrow:window.t("Arrow"),LineToolArrowMarkDown:window.t("Arrow Mark Down"),LineToolArrowMarkLeft:window.t("Arrow Mark Left"),LineToolArrowMarkRight:window.t("Arrow Mark Right"),LineToolArrowMarkUp:window.t("Arrow Mark Up"),LineToolBalloon:window.t("Balloon"),LineToolBarsPattern:window.t("Bars Pattern"),LineToolBezierCubic:window.t("Double Curve"),LineToolBezierQuadro:window.t("Curve"),LineToolBrush:window.t("Brush"),LineToolCallout:window.t("Callout"),LineToolCircleLines:window.t("Cyclic Lines"),LineToolCypherPattern:window.t("Cypher Pattern"),LineToolDateAndPriceRange:window.t("Date and Price Range"),LineToolDateRange:window.t("Date Range"),LineToolDisjointAngle:window.t("Disjoint Channel"),LineToolElliottCorrection:window.t("Elliott Correction Wave (ABC)"),LineToolElliottDoubleCombo:window.t("Elliott Double Combo Wave (WXY)"),LineToolElliottImpulse:window.t("Elliott Impulse Wave (12345)"),LineToolElliottTriangle:window.t("Elliott Triangle Wave (ABCDE)"),LineToolElliottTripleCombo:window.t("Elliott Triple Combo Wave (WXYXZ)"),LineToolEllipse:window.t("Ellipse"),LineToolExtended:window.t("Extended Line"),LineToolFibChannel:window.t("Fib Channel"),LineToolFibCircles:window.t("Fib Circles"),LineToolFibRetracement:window.t("Fib Retracement"),LineToolFibSpeedResistanceArcs:window.t("Fib Speed Resistance Arcs"),LineToolFibSpeedResistanceFan:window.t("Fib Speed Resistance Fan"),LineToolFibSpiral:window.t("Fib Spiral"),LineToolFibTimeZone:window.t("Fib Time Zone"),LineToolFibWedge:window.t("Fib Wedge"),LineToolFlagMark:window.t("Flag Mark"),LineToolImage:window.t("Image"),LineToolFlatBottom:window.t("Flat Top/Bottom"),
LineToolAnchoredVWAP:window.t("Anchored VWAP"),LineToolGannComplex:window.t("Gann Square"),LineToolGannFixed:window.t("Gann Square Fixed"),LineToolGannFan:window.t("Gann Fan"),LineToolGannSquare:window.t("Gann Box"),LineToolHeadAndShoulders:window.t("Head and Shoulders"),LineToolHorzLine:window.t("Horizontal Line"),LineToolHorzRay:window.t("Horizontal Ray"),LineToolIcon:window.t("Icon"),LineToolInsidePitchfork:window.t("Inside Pitchfork"),LineToolNote:window.t("Note"),LineToolNoteAbsolute:window.t("Anchored Note"),LineToolSignpost:window.t("Signpost"),LineToolParallelChannel:window.t("Parallel Channel"),LineToolPitchfan:window.t("Pitchfan"),LineToolPitchfork:window.t("Pitchfork"),LineToolPolyline:window.t("Polyline"),LineToolPath:window.t("Path"),LineToolPrediction:window.t("Forecast"),LineToolPriceLabel:window.t("Price Label"),LineToolArrowMarker:window.t("Arrow Marker"),LineToolPriceRange:window.t("Price Range"),LineToolProjection:window.t("Projection"),LineToolRay:window.t("Ray"),LineToolRectangle:window.t("Rectangle"),LineToolRegressionTrend:window.t("Regression Trend"),LineToolRiskRewardLong:window.t("Long Position"),LineToolRiskRewardShort:window.t("Short Position"),LineToolFixedRangeVolumeProfile:window.t("Fixed Range Volume Profile"),LineToolRotatedRectangle:window.t("Rotated Rectangle"),LineToolSchiffPitchfork:window.t("Modified Schiff Pitchfork"),LineToolSchiffPitchfork2:window.t("Schiff Pitchfork"),LineToolSineLine:window.t("Sine Line"),LineToolText:window.t("Text",{context:"tool"}),LineToolTextAbsolute:window.t("Anchored Text"),LineToolThreeDrivers:window.t("Three Drives Pattern"),LineToolTimeCycles:window.t("Time Cycles"),LineToolTrendAngle:window.t("Trend Angle"),LineToolTrendBasedFibExtension:window.t("Trend-Based Fib Extension"),LineToolTrendBasedFibTime:window.t("Trend-Based Fib Time"),LineToolTrendLine:window.t("Trend Line"),LineToolInfoLine:window.t("Info Line"),LineToolTriangle:window.t("Triangle"),LineToolTrianglePattern:window.t("Triangle Pattern"),LineToolVertLine:window.t("Vertical Line"),LineToolCrossLine:window.t("Cross Line"),LineToolHighlighter:window.t("Highlighter"),LineToolPriceNote:window.t("Price Note"),LineToolVbPFixed:window.t("Volume Profile Fixed Range")};(0,r.isFeatureEnabled)("remove-line-tool-ghost-feed")||(s.LineToolGhostFeed=window.t("Ghost Feed")),s.LineToolTweet=window.t("Tweet"),s.LineToolIdea=window.t("Idea")},87048:(e,t,i)=>{"use strict";i.r(t),i.d(t,{cloneLineTool:()=>ke,createLineTool:()=>Pe,createLineToolProperties:()=>Te,createStudyLineToolProperties:()=>xe,getNewToolProperties:()=>we,isLineDrawnWithPressedButton:()=>me.isLineDrawnWithPressedButton,isLineTool:()=>Le,isLineToolName:()=>me.isLineToolName,isStudyLineTool:()=>Me,isStudyLineToolName:()=>me.isStudyLineToolName,isTrading:()=>Ee,lineToolByLinkKey:()=>De,prepareLineToolPropertiesByOwnerSource:()=>Ce,setNewToolProperties:()=>ye,supportsPhantomMode:()=>Ie,tryFindStudyLineToolNameByStudyId:()=>Ae,unsetNewToolProperties:()=>be});var r={};i.r(r),i.d(r,{LineStudyMtpAnalysis:()=>$,LineStudyMtpDecisionPoint:()=>K,
LineStudyMtpDownWave1OrA:()=>re,LineStudyMtpDownWave2OrB:()=>se,LineStudyMtpDownWave3:()=>ne,LineStudyMtpDownWave4:()=>oe,LineStudyMtpDownWave5:()=>ae,LineStudyMtpDownWaveC:()=>le,LineStudyMtpElliotWaveMain:()=>Q,LineStudyMtpElliotWaveMajor:()=>ee,LineStudyMtpElliotWaveMinor:()=>te,LineStudyMtpRiskReward:()=>J,LineStudyMtpUpWave1OrA:()=>ce,LineStudyMtpUpWave2OrB:()=>ue,LineStudyMtpUpWave3:()=>de,LineStudyMtpUpWave4:()=>he,LineStudyMtpUpWave5:()=>pe,LineStudyMtpUpWaveC:()=>_e});var s=i(16282),n=i(72927),o=i(98006),a=i(31115),l=i(73371),c=i(22275),u=i.t(c,2),d=i(94238),h=i(95047),p=i(84234),_=i.n(p),m=i(31565),f=i(22842),g=i(8155),v=i(55055),S=i(999),y=i(27937),b=i.n(y),w=i(84819),P=i(14127),C=i(59757),T=i(40989),x=i(22756),I=i(32552);class L extends I.PriceAxisView{constructor(e){super(),this._model=e.model(),this._source=e}_updateRendererData(e,t,i){e.visible=!1,t.visible=!1;const r=this._source.model(),s=this._source.priceScale();if(null===s)return;if(!r.isPriceScaleVisible(s))return;const n=this._source.lastValueData("",!1);n.noData||(i.background=n.color,i.textColor=this.generateTextColor(n.color),i.coordinate=n.coordinate,i.floatCoordinate=n.floatCoordinate,this._showAxisLabel()&&(e.text=n.text,e.visible=!0))}_showAxisLabel(){return this._source.properties().childs().axisLabelVisible.value()}}var M=i(21234),E=i(39426),A=i(6144);class k extends E.StudyPlotPaneView{constructor(e,t,i,r){super(e,t,i,r),this._line=e}_updateImpl(){if(super._updateImpl(),!this._line.hasAlert.value())return;const e=this._items;if(!this._renderer.isEmpty()&&e.length>0){const t=e[e.length-1],i=this._model.timeScale().width();if(t.x<0||e[0].x>i)return;const r=Math.min(i-5,t.x);let s=t.y;if(t.x>r){let i=e.length-2;for(;i>=0;){const n=e[i];if(n.x<=r){const e=(r-n.x)/(t.x-n.x);s=n.y+(t.y-n.y)*e;break}i-=1}}const o=new n.Point(r,s);this._renderer.append(new A.PaneRendererClockIcon({point1:o,point2:o,color:this._line.getAlertIsActive()?this._lineColor:M.Constants.DrawingIconColor,horzMargin:-16}))}}}var D=i(87380),R=i(1771),N=i(12012),O=i(90542),V=i(44197);const B=(0,D.getLogger)("Chart.AnchoredVWAP"),F=(0,w.studyIdString)("AnchoredVWAP","tv-basicstudies");function W(e,t,i,r){return"calculate_stDev"in(0,s.ensureDefined)(e.inputs)||void 0===r.inputs.find(e=>"calculate_stDev"===e.id)||((0,s.ensureDefined)(t.inputs).calculate_stDev=!1),t}class U extends a.StudyLineDataSource{constructor(e,t,i){i=i||(0,s.ensureNotNull)(e.studyMetaInfoRepository().findByIdSync({type:"java",studyId:F}));const r=t||U._createPropertiesFromStudyMetaInfo(i,e.studyVersioning());super(e,i,"anchoredvwap",r);const[n,o,a]=this.metaInfo().plots,l=e.mainSeries(),c=[new k(this,l,e,n.id)];o&&a&&(c.push(new E.StudyPlotPaneView(this,l,e,o.id)),c.push(new E.StudyPlotPaneView(this,l,e,a.id))),this._properties.childs().areaBackground&&c.splice(0,0,new O.AreaBackgroundPaneView(this,e)),this._lastValuePriceAxisView=new L(this),this._anchorPriceCalculated=!1,this._onInputsReadyCallbacks=[],this._setPaneViews(c),
e.properties().scalesProperties.showStudyLastValue.subscribe(this,this._onShowStudyLastValueChanged),r.onRestoreFactoryDefaults().subscribe(this,this._onRestoreFactoryDefaults)}destroy(){this.properties().onRestoreFactoryDefaults().unsubscribeAll(this),this.model().properties().scalesProperties.showStudyLastValue.unsubscribeAll(this),this._onInputsReadyCallbacks=[],super.destroy()}canHasAlert(){return!0}pointsCount(){return 1}priceAxisViews(e,t){if(t!==this.priceScale()||this.isSourceHidden())return null;const i=super.priceAxisViews(e,t);return null===i?[this._lastValuePriceAxisView]:[...i,this._lastValuePriceAxisView]}updateAllViews(){super.updateAllViews(),this._lastValuePriceAxisView.update()}offset(e){return 0}firstValue(){return this._model.mainSeries().firstValue()}getMinFirstBarIndexForPlot(){return-1/0}priceRange(e,t){if(!this._isReady()||this.isSourceHidden())return null;const i=this.plots().minMaxOnRangeCached(e,t,[{name:this.metaInfo().plots[0].id,offset:0}]);if(null===i)return null;const r=(0,s.ensureNotNull)(this.priceScale());return r.isLog()?new C.PriceRange(r.priceToLogical(i.min),r.priceToLogical(i.max)):new C.PriceRange(i.min,i.max)}isIncludedInAutoScale(){return!0}lastValueData(e,t,i){const r={noData:!0},n=this.priceScale();if(this._model.timeScale().isEmpty()||null===this.priceScale()||null===n||n.isEmpty()||this.plots().isEmpty())return r;const o=this._model.timeScale().visibleBarsStrictRange();if(null===o)return r;if(!this.properties().childs().visible.value())return r;const a=this.plots().search(o.lastBar(),T.PlotRowSearchMode.NearestLeft,1);if(null===a)return r;const l=o.contains(a.index),c=!t&&l?a:(0,s.ensureNotNull)(this.plots().last());if(!c||!(0,m.isNumber)(c.value[1]))return r;const u=c.value[1],d=this.properties().childs().styles.childs().VWAP,h=(0,s.ensureNotNull)(this.firstValue()),p=n.priceToCoordinate(u,h),_=n.formatPriceAbsolute(u),f=n.formatPricePercentage(u,h);return{noData:!1,price:u,color:d.childs().color.value(),coordinate:p,floatCoordinate:p,index:c.index,text:n.isPercentage()?f:_,formattedPriceAbsolute:_,formattedPricePercentage:f}}restoreData(e){super.restoreData(e),void 0!==e.data&&(this._anchorPriceCalculated=!0)}properties(){return super.properties()}sourceId(){return(0,s.ensureNotNull)(this._studyId())}hasStateForAlert(){return f.enabled("alerts")&&null!==this._inputs}alertCreationAvailable(){return!this.hasAlert.value()&&this.hasStateForAlert()}stateForAlert(){const e=this.metaInfo(),t=(0,S.plotsForAlert)(e,this.offset.bind(this),["VWAP"]),i=(0,S.collectDepsForAlert)([this],this.id()),r=i.idForAlert,s=i.studyDependencies,n=i.inputsForAlert,o=(this.priceScale()||this.model().mainSeries().priceScale()).formatter(),a=o?v.FormattersSerializer.serialize(o):null;return{id:r,uniqueId:r,type:N.StateForAlertType.StudyLineTool,title:(0,V.clean)(this.title(),!0),shortTitle:(0,V.clean)(this.title(),!0),shortDescription:(0,V.clean)(e.shortDescription||"Study",!0),interval:this._model.mainSeries().interval(),fullId:e.fullId,isTVScript:Boolean(e.isTVScript),
isTVScriptStrategy:Boolean(e.isTVScriptStrategy),hasAlertFunction:Boolean(e.hasAlertFunction),plots:t,inputs:n,alerts:e.alerts,scriptIdPart:e.scriptIdPart,scriptVersion:e.pine?e.pine.version:"-1",callStudyDependencies:(0,g.formatCallstudyArg)((0,S.dependenciesForAlerts)([],this._model.studyMetaInfoRepository())),studyDependencies:s,formatter:a}}inputsForAlertState(){null===this._inputs&&B.logError("Could not get inputsForAlertState if VWAP has no inputs");const{start_time:e,source:t}=this.inputs();return{start_time:e,source:t}}inputs(){return(0,s.ensureNotNull)(this._inputs)}idForAlert(){return(0,S.collectDepsForAlert)([this],this.id()).idForAlert}defaultPlotIdForAlert(){return this.metaInfo().plots[0].id}static createProperties(e,t){const i=_().getStudyPropertyRootNameById(F),r=(0,s.ensureNotNull)(e.studyMetaInfoRepository().findByIdSync({type:"java",studyId:F})),n=(0,R.createDefaultsState)(!0,i,[],e.studyVersioning());return xe("LineToolAnchoredVWAP",r,r,(0,m.merge)((0,m.clone)(n),null!=t?t:{}),e.studyVersioning())}static studyId(){return F}static createPropertiesFromStudyMetaInfoAndState(e,t,i,r){const s=(0,P.prepareStudyPropertiesForLoadChart)(e,t,i,null,r,W);return U._configureProperties(s),s}_onPointsetUpdated(e){super._onPointsetUpdated(e),this._onStudyInputsMayChange()}_studyInputs(e){(0,s.assert)(1===e.length,"all the line tool points should be defined");const t=e[0],i=this._getPointTime(t,!1);if(null===i)return this._subscribeApplyInputsOnSeriesCompleted(),null;const r=1e3*i,n={...this.properties().childs().inputs.state(["start_time"]),start_time:r},o=this.metaInfo().inputs.map(e=>e.id),a=Object.keys(n);for(const e of a)o.includes(e)||delete n[e];return n}_isReady(){return super._isReady()&&(null!==this._inputs||this._anchorPriceCalculated)&&this.model().lineBeingEdited()!==this}_onDataCleared(){super._onDataCleared(),this._anchorPriceCalculated=!1}_onInputsChanged(){if(super._onInputsChanged(),null!==this._inputs){for(const e of this._onInputsReadyCallbacks)try{e(this._inputs)}catch(e){B.logError(e.stack||e.message)}this._onInputsReadyCallbacks=[]}}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,19918))).AnchoredVWAPDefinitionsViewModel}_updateAnchorsPrice(){if(this._anchorPriceCalculated||!this.isActualSymbol())return;const e=this.firstValue(),t=this.points();if(null===e||0===t.length)return;const i=t[0].index,r=this.plots().valueAt(i);if(null===r)return;const s=r[1];null!=s&&(this._points[0].price=s,this._anchorPriceCalculated=!0)}_synchronizeAlert(e){this._onInputsReady(()=>super._synchronizeAlert(e))}static _createPropertiesFromStudyMetaInfo(e,t){const i=(0,P.prepareStudyProperties)(e,null,null,t);return U._configureProperties(i),i}static _configureProperties(e){a.StudyLineDataSource._configureProperties(e),e.hasChild("axisLabelVisible")||e.addChild("axisLabelVisible",new(b())(!0));const t=e.childs().styles.childs().VWAP.childs().linewidth,i=e.childs().styles.childs().VWAP.childs().color
;e.addChild("linesWidths",new x.LineToolWidthsProperty([t])),e.addChild("linesColors",new x.LineToolColorsProperty([i]))}_onInputsReady(e){null!==this._inputs?e(this._inputs):this._onInputsReadyCallbacks.push(e)}_onShowStudyLastValueChanged(){this._lastValuePriceAxisView.update(),this.model().updateSource(this)}_onRestoreFactoryDefaults(){this.properties().childs().axisLabelVisible.setValue(!0)}}const H=(0,w.studyIdString)("VbPFixed","tv-basicstudies");class z extends h.LineToolVbPFixed{constructor(e,t,i,r){const s=i||e.studyMetaInfoRepository().findByIdSync({type:"java",studyId:H});super(e,t,s,r)}calcIsActualSymbol(){a.StudyLineDataSource.prototype.calcIsActualSymbol.apply(this)}boundToSymbol(){return!0}isSynchronizable(){return this.priceScale()===this._model.mainSeries().priceScale()}static studyId(){return H}static createProperties(e){const t=super._createPropertiesFromStudyIdAndState(H,e);return h.LineToolVbPFixed._configureProperties(t),t}}var j=i(47658),Y=i(67642),G=i(81293);function q(e){return(0,w.studyIdString)(e,"mtp-mtpredictor")}class X extends a.StudyLineDataSource{constructor(e,t,i,r){const s=q(r),n=i||e.studyMetaInfoRepository().findByIdSync({type:"java",studyId:s}),o=t||X._createPropertiesFromStudyMetaInfo(n,e.studyVersioning());super(e,n,r,o),this._formatter=new G.VolumeFormatter,(0,Y.createGraphicsPaneViews)(this,e).then(this._setPaneViews.bind(this))}formatter(){return this._formatter}series(){return this._ownerSource instanceof j.Series?this._ownerSource:this._model.mainSeries()}static _createPropertiesFromMtpStudyShortIdAndState(e,t){return super._createPropertiesFromStudyIdAndState(q(e),t)}}class $ extends X{constructor(e,t,i){super(e,t,i,"mtp_tsanalysis")}pointsCount(){return 1}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_tsanalysis",e)}static studyId(){return q("mtp_tsanalysis")}_studyInputs(e){(0,s.assert)(1===e.length,"all the line tool points should be defined");const t=this._getPointTime(e[0],!0);if(null===t)return this._subscribeApplyInputsOnSeriesCompleted(),null;const i=this.properties().childs().inputs.childs();return{displayZoneLabels:i.displayZoneLabels.value(),bar:1e3*t,account_size:i.account_size.value(),percent_risk:i.percent_risk.value(),tickEntryOffset:i.tickEntryOffset.value(),tickStopOffset:i.tickStopOffset.value(),minRRRatio:i.minRRRatio.value(),shouldFilterWPTZones:i.shouldFilterWPTZones.value(),shouldFilterSTFTrends:i.shouldFilterSTFTrends.value()}}}class K extends X{constructor(e,t,i){super(e,t,i,"mtp_decisionpoint"),this._symbolIntervalChanged=!1,this._model.mainSeries().onSymbolIntervalChanged().subscribe(this,this._onSymbolIntervalChanged)}destroy(){this._model.mainSeries().onSymbolIntervalChanged().unsubscribeAll(this),super.destroy()}pointsCount(){return 1}onData(e){super.onData(e),this._symbolIntervalChanged=!1}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_decisionpoint",e)}static studyId(){return q("mtp_decisionpoint")}_studyInputs(e){(0,
s.assert)(1===e.length,"all the line tool points should be defined");const t=this._getPointTime(e[0],!0);return null===t?(this._subscribeApplyInputsOnSeriesCompleted(),null):{displayZoneLabels:this.properties().childs().inputs.childs().displayZoneLabels.value(),symbolIntervalChanged:this._symbolIntervalChanged,bar:1e3*t}}_onSymbolIntervalChanged(){this._symbolIntervalChanged=!0}}class J extends X{constructor(e,t,i){super(e,t,i,"mtp_riskreward")}pointsCount(){return 3}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_riskreward",e)}static getTooltipText(e){return e&&0!==e._points.length?1===e._points.length?"Select Stop Bar":2===e._points.length?"Select Target Point":null:"Select Entry Setup Bar"}static studyId(){return q("mtp_riskreward")}_studyInputs(e){(0,s.assert)(3===e.length,"all the line tool points should be defined");const t=this._getPointTime(e[0],!0),i=this._getPointTime(e[1],!0),r=this._getPointTime(e[2],!0);if(null===t||null===i||null===r)return this._subscribeApplyInputsOnSeriesCompleted(),null;const n=this.properties().childs().inputs.childs();return{entry_bar:1e3*t,stop_bar:1e3*i,target_bar:1e3*r,target_price:e[2].price,account_size:n.account_size.value(),percent_risk:n.percent_risk.value(),tickEntryOffset:n.tickEntryOffset.value(),tickStopOffset:n.tickStopOffset.value()}}}class Z extends X{pointsCount(){return 1}_studyInputs(e){(0,s.assert)(1===e.length,"all the line tool points should be defined");const t=this._getPointTime(e[0],!0);return null===t?(this._subscribeApplyInputsOnSeriesCompleted(),null):{displayZoneLabels:this.properties().childs().inputs.childs().displayZoneLabels.value(),bar:1e3*t}}}class Q extends Z{constructor(e,t,i){super(e,t,i,"mtp_ew_main")}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_ew_main",e)}static studyId(){return q("mtp_ew_main")}}class ee extends Z{constructor(e,t,i){super(e,t,i,"mtp_ew_major")}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_ew_major",e)}static studyId(){return q("mtp_ew_major")}}class te extends Z{constructor(e,t,i){super(e,t,i,"mtp_ew_minor")}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_ew_minor",e)}static studyId(){return q("mtp_ew_minor")}}class ie extends X{_studyInputs(e){(0,s.assert)(e.length===this.pointsCount(),"all the line tool points should be defined");const t={displayZoneLabels:this.properties().childs().inputs.childs().displayZoneLabels.value()};for(let i=0;i<this.pointsCount();++i){const r=this._getPointTime(e[i],!0);if(null===r)return this._subscribeApplyInputsOnSeriesCompleted(),null;t["bar"+i]=1e3*r}return t}}class re extends ie{constructor(e,t,i){super(e,t,i,"mtp_wpt_down1ora")}pointsCount(){return 2}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_down1ora",e)}static getTooltipText(e){return"Down Wave 1 or A: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_down1ora")}}class se extends ie{
constructor(e,t,i){super(e,t,i,"mtp_wpt_down2orb")}pointsCount(){return 2}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_down2orb",e)}static getTooltipText(e){return"Down Wave 2 or B: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_down2orb")}}class ne extends ie{constructor(e,t,i){super(e,t,i,"mtp_wpt_down3")}pointsCount(){return 3}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_down3",e)}static getTooltipText(e){return"Down Wave 3: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_down3")}}class oe extends ie{constructor(e,t,i){super(e,t,i,"mtp_wpt_down4")}pointsCount(){return 2}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_down4",e)}static getTooltipText(e){return"Down Wave 4: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_down4")}}class ae extends ie{constructor(e,t,i){super(e,t,i,"mtp_wpt_down5")}pointsCount(){return 5}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_down5",e)}static getTooltipText(e){return"Down Wave 5: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_down5")}}class le extends ie{constructor(e,t,i){super(e,t,i,"mtp_wpt_downc")}pointsCount(){return 3}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_downc",e)}static getTooltipText(e){return"Down Wave C: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_downc")}}class ce extends ie{constructor(e,t,i){super(e,t,i,"mtp_wpt_up1ora")}pointsCount(){return 2}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_up1ora",e)}static getTooltipText(e){return"Up Wave 1 or A: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_up1ora")}}class ue extends ie{constructor(e,t,i){super(e,t,i,"mtp_wpt_up2orb")}pointsCount(){return 2}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_up2orb",e)}static getTooltipText(e){return"Up Wave 2 or B: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_up2orb")}}class de extends ie{constructor(e,t,i){super(e,t,i,"mtp_wpt_up3")}pointsCount(){return 3}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_up3",e)}static getTooltipText(e){return"Up Wave 3: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_up3")}}class he extends ie{constructor(e,t,i){super(e,t,i,"mtp_wpt_up4")}pointsCount(){return 2}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_up4",e)}static getTooltipText(e){return"Up Wave 4: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_up4")}}class pe extends ie{constructor(e,t,i){super(e,t,i,"mtp_wpt_up5")}pointsCount(){return 5}static createProperties(e){
return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_up5",e)}static getTooltipText(e){return"Up Wave 5: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_up5")}}class _e extends ie{constructor(e,t,i){super(e,t,i,"mtp_wpt_upc")}pointsCount(){return 3}static createProperties(e){return super._createPropertiesFromMtpStudyShortIdAndState("mtp_wpt_upc",e)}static getTooltipText(e){return"Up Wave C: Select Point "+((e?e._points.length:0)+1)}static studyId(){return q("mtp_wpt_upc")}}var me=i(32719),fe=i(75363);const ge=(0,o.isFeatureEnabled)("unit_conversion");function ve(e){for(const t of Object.keys(e))TradingView[t]=e[t]}ve(u),ve({LineToolRegressionTrend:d.LineToolRegressionTrend,LineToolVbPFixed:h.LineToolVbPFixed,LineToolAnchoredVWAP:U,LineToolFixedRangeVolumeProfile:z}),ve(r);let Se=null;function ye(e,t,i){return null!==Se&&Se.tool===e&&Se.toolData===t||(Se={properties:Te(e,void 0,i),tool:e,toolData:t}),Se.properties}function be(){Se=null}function we(e){return null!==Se&&Se.tool===e?Se.properties:null}function Pe(e,t,i,n,o){let a;if((0,s.assert)((0,me.isLineToolName)(e),"Unknown line tool: "+e),o||i||(i=we(e)||void 0),"LineToolVbPFixed"===e)a=new h.LineToolVbPFixed(t,i,(0,s.ensureDefined)(n),t.mainSeries());else if("LineToolFixedRangeVolumeProfile"===e)a=new z(t,i,(0,s.ensureDefined)(n),t.mainSeries());else if("LineToolRegressionTrend"===e)a=new d.LineToolRegressionTrend(t,i,(0,s.ensureDefined)(n));else if("LineToolAnchoredVWAP"===e)a=new U(t,i,(0,s.ensureDefined)(n));else if(e in r){a=new((0,s.ensureDefined)(r[e]))(t,i,(0,s.ensureDefined)(n))}else{a=new((0,s.ensureDefined)(u[e]))(t,i,o)}return a.toolname=e,be(),a}function Ce(e,t){const i=(0,s.ensureNotNull)(t.symbolSource());e.childs().symbol.setValue(i.symbol()),e.childs().currencyId.setValue(i.currency()),ge&&e.childs().unitId.setValue(i.unit()),e.childs().symbolStateVersion.setValue(2),e.childs().zOrderVersion.setValue(2)}function Te(e,t,i){if((0,s.assert)((0,me.isLineToolName)(e),e+" should be name of the line tool"),"LineToolVbPFixed"===e)return h.LineToolVbPFixed.createProperties(t);if("LineToolFixedRangeVolumeProfile"===e)return z.createProperties(t);if("LineToolRegressionTrend"===e)return d.LineToolRegressionTrend.createProperties(t);if("LineToolAnchoredVWAP"===e)return U.createProperties(i,t);if(e in r){return(0,s.ensureDefined)(r[e]).createProperties(t)}return(0,s.ensureDefined)(u[e]).createProperties(t)}function xe(e,t,i,n,o){if((0,s.assert)((0,me.isStudyLineToolName)(e),e+" should be name of the study line tool"),"LineToolVbPFixed"===e)return h.LineToolVbPFixed.createPropertiesFromStudyMetaInfoAndState(t,i,n,o);if("LineToolFixedRangeVolumeProfile"===e)return z.createPropertiesFromStudyMetaInfoAndState(t,i,n,o);if("LineToolRegressionTrend"===e)return d.LineToolRegressionTrend.createPropertiesFromStudyMetaInfoAndState(t,i,n,o);if("LineToolAnchoredVWAP"===e)return U.createPropertiesFromStudyMetaInfoAndState(t,i,n,o);if(e in r){return(0,s.ensureDefined)(r[e]).createPropertiesFromStudyMetaInfoAndState(t,i,n,o)}
throw new Error("Property creation is not implemented for study line tool "+e)}function Ie(e){(0,s.assert)((0,me.isLineToolName)(e),e+" should be name of the line tool");const t=u[e];return void 0!==t&&Boolean(t.supportPhantomMode)}function Le(e){return e instanceof l.LineDataSource}function Me(e){let t=!1;return t=e instanceof a.StudyLineDataSource,t}function Ee(e){return e instanceof fe.LineToolTrading}function Ae(e){let t=null;if(e===h.LineToolVbPFixed.studyId())t="LineToolVbPFixed";else if(e===z.studyId())t="LineToolFixedRangeVolumeProfile";else if(e===d.LineToolRegressionTrend.studyId())t="LineToolRegressionTrend";else for(const t in r)if(r[t].studyId()===e)return t;return t}function ke(e,t,i,r){const o=t.toolname,a=Te(t.toolname,t.properties().state(),e);a.childs().visible.setValue(!0);const l=(0,s.ensureNotNull)(t.ownerSource()),c=Pe(o,e,a);void 0!==r&&c.setId(r),c.setOwnerSource(l),c.toolname=o;const u=c.clonePositionOffset(),d=t.fixedPoints();(i?d.map(e=>e.add(new n.Point(u.xCoordOffset,u.yCoordOffset))):d).forEach(e=>c.addFixedPoint(e));const h=t.normalizedPoints(),p=i?function(e,t,i){const r=(0,s.ensureNotNull)(t.priceScale()),n=(0,s.ensureNotNull)(t.firstValue());return e.map(e=>{const t=e.price,s=r.priceToCoordinate(t,n)+i.yCoordOffset,o=r.coordinateToPrice(s,n);return{time_t:e.time_t,price:o,offset:e.offset+i.barOffset}})}(h,l,u):h,_=t.points();return c.restorePoints(p,_),c.cloneData&&c.cloneData(t),c.checkAlert&&c.checkAlert(),c}function De(e,t){return e.dataSources().find(e=>Le(e)&&e.linkKey().value()===t)||null}},46851:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(27937),n=i(1771).DefaultProperty;class o extends r{constructor(e,t){super(e,t||o.createProperties()),this.version=o.version,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,27922)).then(({NotePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}pointsCount(){return 1}name(){return"Note"}getTooltipWidth(){return o.TOOLTIP_WIDTH}getTooltipPadding(){return o.TOOLTIP_PADDING}getTooltipLineSpacing(){return o.TOOLTIP_LINESPACING}template(){var e=r.prototype.template.call(this);return e.text=this.properties().childs().text.value(),e}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text)}static createProperties(e){void 0!==e&&void 0!==e.markerColor&&void 0===e.borderColor&&(e.borderColor=e.markerColor);var t=new n("linetoolnote",e);return o._configureProperties(t),t}state(e){var t=r.prototype.state.call(this,e);return e&&(t.state.fixedSize=!1),t}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,23542))).NoteDefinitionsViewModel}static _configureProperties(e){r._configureProperties(e),e.hasChild("text")||e.addChild("text",new s(window.t("Text"))),e.addExclusion("text")}}o.TOOLTIP_WIDTH=300,o.TOOLTIP_PADDING=10,o.TOOLTIP_LINESPACING=5,o.version=1;class a extends o{constructor(e,t){super(e,t||a.createProperties())}title(){return window.t("Anchored Note")}name(){
return"Anchored Note"}isFixed(){return!0}hasEditableCoordinates(){return!1}static createProperties(e){var t=new n("linetoolnoteabsolute",e);return a._configureProperties(t),t}static _configureProperties(e){o._configureProperties(e)}}t.LineToolNote=o,t.LineToolNoteAbsolute=a},66962:(e,t,i)=>{"use strict";var r=i(22842),s=i(75363).LineToolTrading,n=i(69722).LineToolPriceAxisView,o=i(47859),a=i(73371).LineDataSource,l=i(1771).DefaultProperty,c=i(70734).sortSourcesPreOrdered.LineToolOrder;function u(e){return null==e?e="":e+="",e}class d{constructor(e){this._line=e,this._data={bodyText:"order",quantityText:"0"},this._editable=!0,this._cancellable=!0,this._mode="",this._direction="buy",this._active=!0}setMode(e){return this._mode=e,this._line.updateAllViewsAndRedraw(),this}setDirection(e){return this._direction=e,this._line.updateAllViewsAndRedraw(),this}setActive(e){return this._active=e,this._line.updateAllViewsAndRedraw(),this}setEditable(e){return this._editable=e,this._line.updateAllViewsAndRedraw(),this}getEditable(){return this._editable}setCancellable(e){return this._cancellable=e,this._line.updateAllViewsAndRedraw(),this}getCancellable(){return this._cancellable}hasMoveCallback(){return this.isFunction(this._onMoveCallback)}hasModifyCallback(){return this.isFunction(this._onModifyCallback)}getPrice(){return this._line.points().length>0?this._line.points()[0].price:this._line._timePoint.length>0?this._line._timePoint[0].price:void 0}setPrice(e){if(this._line.points().length>0){var t=this._line.points()[0];t.price=e,this._line._points[0]=t,this._line.normalizePoints(),this._line.updateAllViewsAndRedraw()}return this._line._timePoint.length>0&&(this._line._timePoint[0].price=e),this}getText(){return this._data.bodyText}setText(e){return this._data.bodyText=e||"",this._line.updateAllViewsAndRedraw(),this}setTooltip(e){return this._line.properties().tooltip.setValue(u(e)),this}getTooltip(){return this._line.properties().tooltip.value()}setModifyTooltip(e){return this._line.properties().modifyTooltip.setValue(u(e)),this}getModifyTooltip(){return this._line.properties().modifyTooltip.value()}setCancelTooltip(e){return this._line.properties().cancelTooltip.setValue(u(e)),this}getCancelTooltip(){return this._line.properties().cancelTooltip.value()}getQuantity(){return this._data.quantityText}setQuantity(e){return this._data.quantityText=e||"",this._line.updateAllViewsAndRedraw(),this}getExtendLeft(){var e=this._line.properties().extendLeft.value();return"inherit"===e?this._line._model.properties().tradingProperties.extendLeft.value():e}setExtendLeft(e){return this._line.properties().extendLeft.setValue(e),this}getLineLength(){var e=this._line.properties().lineLength.value();return"inherit"===e?this._line._model.properties().tradingProperties.lineLength.value():e}setLineLength(e){return this._line.properties().lineLength.setValue(Math.max(0,Math.min(e,100))),this}getLineColor(){var e=this._line.properties()
;return"buy"===this._direction?this._active?e.lineActiveBuyColor.value():e.lineInactiveBuyColor.value():this._active?e.lineActiveSellColor.value():e.lineInactiveSellColor.value()}setLineColor(e){return"buy"===this._direction?this._active?this.setLineActiveBuyColor(e):this.setLineInactiveBuyColor(e):this._active?this.setLineActiveSellColor(e):this.setLineInactiveSellColor(e),this}setLineActiveBuyColor(e){return this._line.properties().lineActiveBuyColor.setValue(e),this}setLineInactiveBuyColor(e){return this._line.properties().lineInactiveBuyColor.setValue(e),this}setLineActiveSellColor(e){return this._line.properties().lineActiveSellColor.setValue(e),this}setLineInactiveSellColor(e){return this._line.properties().lineInactiveSellColor.setValue(e),this}getLineStyle(){var e=this._line.properties().lineStyle.value();return"inherit"===e?this._line._model.properties().tradingProperties.lineStyle.value():e}setLineStyle(e){return this._line.properties().lineStyle.setValue(e),this}getLineWidth(){var e=this._line.properties().lineWidth.value();return"inherit"===e?this._line._model.properties().tradingProperties.lineWidth.value():e}setLineWidth(e){return this._line.properties().lineWidth.setValue(e),this}getBodyBorderColor(){var e=this._line.properties();return"buy"===this._direction?this._active?e.bodyBorderActiveBuyColor.value():e.bodyBorderInactiveBuyColor.value():this._active?e.bodyBorderActiveSellColor.value():e.bodyBorderInactiveSellColor.value()}setBodyBorderColor(e){return"buy"===this._direction?this._active?this.setBodyBorderActiveBuyColor(e):this.setBodyBorderInactiveBuyColor(e):this._active?this.setBodyBorderActiveSellColor(e):this.setBodyBorderInactiveSellColor(e),this}setBodyBorderActiveBuyColor(e){return this._line.properties().bodyBorderActiveBuyColor.setValue(e),this}setBodyBorderInactiveBuyColor(e){return this._line.properties().bodyBorderInactiveBuyColor.setValue(e),this}setBodyBorderActiveSellColor(e){return this._line.properties().bodyBorderActiveSellColor.setValue(e),this}setBodyBorderInactiveSellColor(e){return this._line.properties().bodyBorderInactiveSellColor.setValue(e),this}getBodyBackgroundColor(){return o.getColorFromProperties(this._line.properties().bodyBackgroundColor,this._line.properties().bodyBackgroundTransparency)}setBodyBackgroundColor(e){return o.setColorToProperties(e,this._line.properties().bodyBackgroundColor,this._line.properties().bodyBackgroundTransparency),this}getBodyTextColor(){var e=this._line.properties();return"limit"===this._mode?this._active?e.bodyTextActiveLimitColor.value():e.bodyTextInactiveLimitColor.value():"stop"===this._mode?this._active?e.bodyTextActiveStopColor.value():e.bodyTextInactiveStopColor.value():"buy"===this._direction?this._active?e.bodyTextActiveBuyColor.value():e.bodyTextInactiveBuyColor.value():this._active?e.bodyTextActiveSellColor.value():e.bodyTextInactiveSellColor.value()}setBodyTextColor(e){
return"limit"===this._mode?this._active?this.setBodyTextActiveLimitColor(e):this.setBodyTextInactiveLimitColor(e):"stop"===this._mode?this._active?this.setBodyTextActiveStopColor(e):this.setBodyTextInactiveStopColor(e):"buy"===this._direction?this._active?this.setBodyTextActiveBuyColor(e):this.setBodyTextInactiveBuyColor(e):this._active?this.setBodyTextActiveSellColor(e):this.setBodyTextInactiveSellColor(e),this}setBodyTextInactiveLimitColor(e){return this._line.properties().bodyTextInactiveLimitColor.setValue(e),this}setBodyTextActiveLimitColor(e){return this._line.properties().bodyTextActiveLimitColor.setValue(e),this}setBodyTextInactiveStopColor(e){return this._line.properties().bodyTextInactiveStopColor.setValue(e),this}setBodyTextActiveStopColor(e){return this._line.properties().bodyTextActiveStopColor.setValue(e),this}setBodyTextInactiveBuyColor(e){return this._line.properties().bodyTextInactiveBuyColor.setValue(e),this}setBodyTextActiveBuyColor(e){return this._line.properties().bodyTextActiveBuyColor.setValue(e),this}setBodyTextInactiveSellColor(e){return this._line.properties().bodyTextInactiveSellColor.setValue(e),this}setBodyTextActiveSellColor(e){return this._line.properties().bodyTextActiveSellColor.setValue(e),this}getBodyFont(){return o.getFontFromProperties(this._line.properties().bodyFontFamily,this._line.properties().bodyFontSize,this._line.properties().bodyFontBold,this._line.properties().bodyFontItalic)}setBodyFont(e){return o.setFontToProperties(e,this._line.properties().bodyFontFamily,this._line.properties().bodyFontSize,this._line.properties().bodyFontBold,this._line.properties().bodyFontItalic),this}getQuantityBorderColor(){var e=this._line.properties();return"buy"===this._direction?this._active?e.quantityBorderActiveBuyColor.value():e.quantityBorderInactiveBuyColor.value():this._active?e.quantityBorderActiveSellColor.value():e.quantityBorderInactiveSellColor.value()}setQuantityBorderColor(e){return"buy"===this._direction?this._active?this.setQuantityBorderActiveBuyColor(e):this.setQuantityBorderInactiveBuyColor(e):this._active?this.setQuantityBorderActiveSellColor(e):this.setQuantityBorderInactiveSellColor(e),this}setQuantityBorderActiveBuyColor(e){return this._line.properties().quantityBorderActiveBuyColor.setValue(e),this}setQuantityBorderInactiveBuyColor(e){return this._line.properties().quantityBorderInactiveBuyColor.setValue(e),this}setQuantityBorderActiveSellColor(e){return this._line.properties().quantityBorderActiveSellColor.setValue(e),this}setQuantityBorderInactiveSellColor(e){return this._line.properties().quantityBorderInactiveSellColor.setValue(e),this}getQuantityBackgroundColor(){var e=this._line.properties();return"buy"===this._direction?this._active?e.quantityBackgroundActiveBuyColor.value():e.quantityBackgroundInactiveBuyColor.value():this._active?e.quantityBackgroundActiveSellColor.value():e.quantityBackgroundInactiveSellColor.value()}setQuantityBackgroundColor(e){
return"buy"===this._direction?this._active?this.setQuantityBackgroundActiveBuyColor(e):this.setQuantityBackgroundInactiveBuyColor(e):this._active?this.setQuantityBackgroundActiveSellColor(e):this.setQuantityBackgroundInactiveSellColor(e),this}setQuantityBackgroundActiveBuyColor(e){return this._line.properties().quantityBackgroundActiveBuyColor.setValue(e),this}setQuantityBackgroundInactiveBuyColor(e){return this._line.properties().quantityBackgroundInactiveBuyColor.setValue(e),this}setQuantityBackgroundActiveSellColor(e){return this._line.properties().quantityBackgroundActiveSellColor.setValue(e),this}setQuantityBackgroundInactiveSellColor(e){return this._line.properties().quantityBackgroundInactiveSellColor.setValue(e),this}getQuantityTextColor(){return o.getColorFromProperties(this._line.properties().quantityTextColor,this._line.properties().quantityTextTransparency)}setQuantityTextColor(e){return o.setColorToProperties(e,this._line.properties().quantityTextColor,this._line.properties().quantityTextTransparency),this}getQuantityFont(){return o.getFontFromProperties(this._line.properties().quantityFontFamily,this._line.properties().quantityFontSize,this._line.properties().quantityFontBold,this._line.properties().quantityFontItalic)}setQuantityFont(e){return o.setFontToProperties(e,this._line.properties().quantityFontFamily,this._line.properties().quantityFontSize,this._line.properties().quantityFontBold,this._line.properties().quantityFontItalic),this}getCancelButtonBorderColor(){var e=this._line.properties();return"buy"===this._direction?this._active?e.cancelButtonBorderActiveBuyColor.value():e.cancelButtonBorderInactiveBuyColor.value():this._active?e.cancelButtonBorderActiveSellColor.value():e.cancelButtonBorderInactiveSellColor.value()}setCancelButtonBorderColor(e){return"buy"===this._direction?this._active?this.setCancelButtonBorderActiveBuyColor(e):this.setCancelButtonBorderInactiveBuyColor(e):this._active?this.setCancelButtonBorderActiveSellColor(e):this.setCancelButtonBorderInactiveSellColor(e),this}setCancelButtonBorderActiveBuyColor(e){return this._line.properties().cancelButtonBorderActiveBuyColor.setValue(e),this}setCancelButtonBorderInactiveBuyColor(e){return this._line.properties().cancelButtonBorderInactiveBuyColor.setValue(e),this}setCancelButtonBorderActiveSellColor(e){return this._line.properties().cancelButtonBorderActiveSellColor.setValue(e),this}setCancelButtonBorderInactiveSellColor(e){return this._line.properties().cancelButtonBorderInactiveSellColor.setValue(e),this}getCancelButtonBackgroundColor(){return o.getColorFromProperties(this._line.properties().cancelButtonBackgroundColor,this._line.properties().cancelButtonBackgroundTransparency)}setCancelButtonBackgroundColor(e){return o.setColorToProperties(e,this._line.properties().cancelButtonBackgroundColor,this._line.properties().cancelButtonBackgroundTransparency),this}getCancelButtonIconColor(){var e=this._line.properties()
;return"buy"===this._direction?this._active?e.cancelButtonIconActiveBuyColor.value():e.cancelButtonIconInactiveBuyColor.value():this._active?e.cancelButtonIconActiveSellColor.value():e.cancelButtonIconInactiveSellColor.value()}setCancelButtonIconColor(e){return"buy"===this._direction?this._active?this.setCancelButtonIconActiveBuyColor(e):this.setCancelButtonIconInactiveBuyColor(e):this._active?this.setCancelButtonIconActiveSellColor(e):this.setCancelButtonIconInactiveSellColor(e),this}setCancelButtonIconActiveBuyColor(e){return this._line.properties().cancelButtonIconActiveBuyColor.setValue(e),this}setCancelButtonIconInactiveBuyColor(e){return this._line.properties().cancelButtonIconInactiveBuyColor.setValue(e),this}setCancelButtonIconActiveSellColor(e){return this._line.properties().cancelButtonIconActiveSellColor.setValue(e),this}setCancelButtonIconInactiveSellColor(e){return this._line.properties().cancelButtonIconInactiveSellColor.setValue(e),this}block(){this._blocked=!0,this._line.updateAllViewsAndRedraw()}unblock(){this._blocked=!1,this._line.updateAllViewsAndRedraw()}getBlocked(){return this._blocked}isFunction(e){return"function"==typeof e}onCancel(e,t){return t?this.isFunction(t)&&(this._onCancelData=e,this._onCancelCallback=t):this.isFunction(e)&&(this._onCancelCallback=e),this}callOnCancel(){this.isFunction(this._onCancelCallback)&&this._onCancelCallback.call(this,this._onCancelData)}isOnCancelCallbackPresent(){return this.isFunction(this._onCancelCallback)}onModify(e,t){return t?this.isFunction(t)&&(this._onModifyData=e,this._onModifyCallback=t):this.isFunction(e)&&(this._onModifyCallback=e),this}callOnModify(){this.isFunction(this._onModifyCallback)&&this._onModifyCallback.call(this,this._onModifyData)}onMove(e,t){return t?this.isFunction(t)&&(this._onMoveData=e,this._onMoveCallback=t):this.isFunction(e)&&(this._onMoveCallback=e),this}callOnMove(){this.isFunction(this._onMoveCallback)&&this._onMoveCallback.call(this,this._onMoveData)}onContextMenu(e,t){return t?this.isFunction(t)&&(this._onContextMenuData=e,this._onContextMenuCallback=t):this.isFunction(e)&&(this._onContextMenuCallback=e),this}shouldShowContextMenu(){return this.isFunction(this._onContextMenuCallback)}callOnContextMenu(){if(this.isFunction(this._onContextMenuCallback))return this._onContextMenuCallback.call(this,this._onContextMenuData)}remove(){this._line._model.removeSource(this._line),delete this._line}}class h extends s{constructor(e,t){super(e,t||h.createProperties()),this._adapter=new d(this),this.setSelectionEnabled(!0),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,7416)).then(({OrderPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}zorder(){return c}isSpeciallyZOrderedSource(){return!0}setPoint(e,t,i){this._points[e]=t,this.normalizePoints()}addPoint(e,t){return this._points.push(e),this._lastPoint=null,this.normalizePoints(),this.createServerPoints(),!0}name(){return"Order"}endMoving(e){
var t=this._startMovingPoint&&this._currentMovingPoint&&this._startMovingPoint.logical.price!==this._currentMovingPoint.logical.price;super.endMoving(),!e&&t&&this._adapter.callOnMove()}createPriceAxisView(e){var t={pointIndex:e,backgroundPropertyGetter:()=>this._adapter.getLineColor()};return this._priceAxisView=new n(this,t),this._priceAxisView}paneViews(){return TradingView.printing&&!r.enabled("snapshot_trading_drawings")?null:this._model.properties().tradingProperties.showOrders.value()?a.prototype.paneViews.call(this):null}priceAxisViews(e,t){return TradingView.printing&&!r.enabled("snapshot_trading_drawings")?null:this._model.properties().tradingProperties.showOrders.value()?a.prototype.priceAxisViews.call(this,e,t):null}adapter(){return this._adapter}hasContextMenu(){return this._adapter.shouldShowContextMenu()}contextMenuItems(){return this._adapter.callOnContextMenu()}movable(){return Boolean(this._adapter._onMoveCallback)}static createProperties(e){var t=new l("linetoolorder",e,!1,!1);return h._configureProperties(t),t}static _configureProperties(e){s._configureProperties(e)}}t.LineToolOrder=h},85378:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(1771).DefaultProperty,n=i(14397);class o extends r{constructor(e,t){super(e,t||o.createProperties()),this._priceAxisViews.push(this.createPriceAxisView(3)),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,50015,19)).then(({ParallelChannelPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}calculatePriceDiff(){var e=this.points();if(3===e.length){var t=e[0],i=e[1],r=e[2],s=this._findPriceOffset(t,i,r);null!==s&&isFinite(s)&&(this._priceOffset=s)}}_findPriceOffset(e,t,i){var r=this.priceScale();if(null===r||e.index===t.index)return null;if(r.isLog()){var s=this._model.timeScale();if(s.isEmpty())return null;var n=this.ownerSource().firstValue(),o=s.indexToCoordinate(e.index),a=s.indexToCoordinate(t.index),l=r.priceToCoordinate(e.price,n),c=r.priceToCoordinate(t.price,n),u=l+(m=(c-l)/(a-o))*(s.indexToCoordinate(i.index)-o),d=r.priceToCoordinate(i.price,n)-u,h=(n=this.ownerSource().firstValue(),.5*(l+c)),p=r.coordinateToPrice(h,n),_=h+d;return r.coordinateToPrice(_,n)-p}var m=(t.price-e.price)/(t.index-e.index),f=e.price+m*(i.index-e.index);return i.price-f}setLastPoint(e,t){t&&t.shift()&&2===this.points().length&&this._snapPoint45Degree(e,this.points()[0]),super.setLastPoint(e),this.calculatePriceDiff()}restorePoints(e,t,i){super.restorePoints(e,t,i),e&&e.length>=3&&(this._priceOffset=e[2].price-e[0].price)}setPoint(e,t,i){if(i&&i.shift())switch(e){case 0:case 1:this._snapPoint45Degree(t,this._points[1-e]);break;case 2:case 3:this._snapPoint45Degree(t,{index:this._points[3-e].index,price:this._points[3-e].price+this._priceOffset})}var r=!1;switch(e){case 0:case 1:super.setPoint(e,t,i);break;case 2:case 3:this._points[e-2].index=t.index,this._points[e-2].price=t.price-this._priceOffset;break;case 4:this._points[2]=t,this.calculatePriceDiff(),r=!0;break;case 5:var s=this._findPriceOffset(this._points[0],this._points[1],t)
;null!==s&&isFinite(s)&&(this._points[0].price+=s,this._points[1].price+=s,this._priceOffset-=s,r=!0)}if(e%2==0&&this._correctThirdPoint(),r&&this.linkKey().value()){for(var o=[],a=0;a<this._points.length;a++)o.push(this._points[a].price);n.changeLineStyle({model:this._model,linkKey:this.linkKey().value(),state:{prices:o}})}}restoreExternalState(e){if((e=Object.assign({},e)).prices)if(this.isActualSymbol()){for(var t=0;t<e.prices.length;t++)this._points[t].price=e.prices[t];this._priceOffset=this._points[2].price-this._points[0].price}else this._priceOffset=void 0;delete e.prices,super.restoreExternalState(e)}onData(e){super.onData(e),this._updateThirdPointAndPriceOffset()}setPoints(e){super.setPoints(e),this.calculatePriceDiff()}getPoint(e){if(e<2)return r.prototype.getPoint.call(this,e);var t=null;switch(e){case 2:case 3:var i=this.points();i.length===this.pointsCount()&&(t={index:i[e-2].index,price:i[e-2].price+this._priceOffset})}return t}pointsCount(){return 3}name(){return"Parallel Channel"}hasEditableCoordinates(){return!1}addPoint(e,t){var i=this.points().length;t&&t.shift()&&2===i&&this._snapPoint45Degree(e,this.points()[0]);var s=r.prototype.addPoint.call(this,e,t);return this._updateThirdPointAndPriceOffset(),s}cloneData(e){this._priceOffset=e._priceOffset}restoreData(e){e.priceOffset&&(this._priceOffset=e.priceOffset)}state(e){var t=r.prototype.state.call(this,e);return t.priceOffset=this._priceOffset,t}canHasAlert(){return!0}axisPoints(){var e=this.points();return e.length<2?[]:(e[2]={index:e[0].index,price:e[0].price+this._priceOffset},e.push({index:e[1].index,price:e[1].price+this._priceOffset}),e)}_getAlertPlots(){var e=[].concat(this._points).splice(0,2);function t(e,t){return e.index<=t.index?[e,t]:[t,e]}var i,r,s,n,o=t((e=e.concat([{price:e[0].price+this._priceOffset,time:e[0].time,index:e[0].index},{price:e[1].price+this._priceOffset,time:e[1].time,index:e[1].index}]))[0],e[1]),a=t(e[2],e[3]);this._priceOffset<0?(r=a,i=o):(r=o,i=a);var l=this.properties().extendLeft.value(),c=this.properties().extendRight.value();return e[0].index<=e[1].index?(s=l,n=c):(s=c,n=l),[this._linePointsToAlertPlot(i,"Upper",s,n),this._linePointsToAlertPlot(r,"Lower",s,n)]}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,98294))).ParallelChannelDefinitionsViewModel}_updateThirdPointAndPriceOffset(){this._points.length===this.pointsCount()&&(void 0===this._priceOffset&&this.calculatePriceDiff(),this._correctThirdPoint())}_correctThirdPoint(){var e=this._points[0];this._points[2].index=e.index,this._points[2].price=e.price+this._priceOffset}static createProperties(e){var t=new s("linetoolparallelchannel",e);return o._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e)}}t.LineToolParallelChannel=o},67701:(e,t,i)=>{"use strict";i.d(t,{LineToolPath:()=>c});var r=i(16282),s=i(72927),n=i(1771),o=i(34250),a=i(73371),l=i(22756);class c extends a.LineDataSource{constructor(e,t){const r=t||c.createProperties()
;super(e,r),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,2728)).then(t=>{this._setPaneViews([new t.PathPaneView(this,e)])})}pointsCount(){return-1}name(){return"Path"}hasEditableCoordinates(){return!1}addPoint(e,t,i){var n;const a=(0,r.ensureNotNull)(this.priceScale()),l=this._model.timeScale().indexToCoordinate(e.index),c=e.price,u=(0,r.ensure)(null===(n=this.ownerSource())||void 0===n?void 0:n.firstValue()),d=a.priceToCoordinate(c,u);if(this._points.length>0){const e=this._points[this._points.length-1],t=this._model.timeScale().indexToCoordinate(e.index),i=e.price,r=a.priceToCoordinate(i,u);if(new s.Point(l,d).subtract(new s.Point(t,r)).length()<(0,o.interactionTolerance)().minDistanceBetweenPoints)return this._lastPoint=null,this.normalizePoints(),this.createServerPoints(),!0}return super.addPoint(e,t,i)}static createProperties(e){const t=new n.DefaultProperty("linetoolpath",e);return c._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,90882)).then(e=>e.PathDefinitionsViewModel)}static _configureProperties(e){a.LineDataSource._configureProperties(e),e.addChild("linesColors",new l.LineToolColorsProperty([e.childs().lineColor]))}}},17146:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(92372),n=i(22756),o=n.LineToolWidthsProperty,a=n.LineToolColorsProperty;class l extends r{constructor(e,t){super(e,t||l.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,20894,19)).then(({PitchfanLinePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}levelsCount(){return l.LevelsCount}pointsCount(){return 3}name(){return"Pitchfan"}processErase(e,t){var i="level"+t,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,86013))).PitchBaseDefinitionsViewModel}static createProperties(e){var t=new s("linetoolpitchfan",e,!1,{range:[0,8]});return l._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e);for(var t=[e.child("median").child("linewidth")],i=[e.child("median").child("color")],s=0;s<=l.LevelsCount;s++)t.push(e.child("level"+s).child("linewidth")),i.push(e.child("level"+s).child("color"));e.addChild("linesColors",new a(i)),e.addChild("linesWidths",new o(t))}}l.LevelsCount=8,t.LineToolPitchfan=l},53995:(e,t,i)=>{"use strict";var r;i.d(t,{LineToolPitchforkStyle:()=>r}),function(e){e[e.Original=0]="Original",e[e.Schiff=1]="Schiff",e[e.Inside=2]="Inside",e[e.Schiff2=3]="Schiff2"}(r||(r={}))},45155:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(92372),n=i(54281).Action,o=i(53995).LineToolPitchforkStyle,a=null,l=i(22756),c=l.LineToolWidthsProperty,u=l.LineToolColorsProperty;class d extends r{constructor(e,t){super(e,t||d.createProperties()),this._properties.style.listeners().subscribe(this,d.prototype._recreatePaneView),this._recreatePaneView()}
levelsCount(){return d.LevelsCount}additionalActions(e){for(var t=[],i=["Original","Modified Schiff","Inside","Schiff"],r=0;r<4;r++){var s=new n({checked:this.properties().style.value()===r,checkable:!0,label:window.t(i[r]),payload:{target:this,value:r},onExecute:function(t){var i=t.getPayload(),r=i.target;e.setProperty(r.properties().style,i.value,`Change ${r.name()} Style`),r.updateAllViews(),r._model.updateSource(r)}});t.push(s)}return[t[0],t[3],t[1],t[2]]}_recreatePaneView(){if(null!==a){var e=[];this._properties.style.value()===o.Original?e=[new a.PitchforkLinePaneView(this,this._model)]:this._properties.style.value()===o.Schiff?e=[new a.SchiffPitchforkLinePaneView(this,this._model)]:this._properties.style.value()===o.Schiff2?e=[new a.SchiffPitchfork2LinePaneView(this,this._model)]:this._properties.style.value()===o.Inside&&(e=[new a.InsidePitchforkLinePaneView(this,this._model)]),this._setPaneViews(e)}else Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,23477,19)).then(e=>{null===a&&(a=e),this._recreatePaneView()})}pointsCount(){return 3}name(){return"Pitchfork"}processErase(e,t){var i="level"+t,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}static createProperties(e){var t=new s("linetoolpitchfork",e,!1,{range:[0,8]});return d._configureProperties(t),t}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,60339))).PitchForkDefinitionsViewModel}static _configureProperties(e){r._configureProperties(e);for(var t=[e.child("median").child("linewidth")],i=[e.child("median").child("color")],s=0;s<=d.LevelsCount;s++)t.push(e.child("level"+s).child("linewidth")),i.push(e.child("level"+s).child("color"));e.addChild("linesColors",new u(i)),e.addChild("linesWidths",new c(t))}}d.LevelsCount=8,t.LineToolPitchfork=d},16977:(e,t,i)=>{"use strict";i.d(t,{LineToolPolyline:()=>l});var r=i(16282),s=i(72927),n=i(1771),o=i(34250),a=i(73371);class l extends a.LineDataSource{constructor(e,t){const r=t||l.createProperties();super(e,r),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,18291)).then(t=>{this._setPaneViews([new t.PolylinePaneView(this,e)])})}pointsCount(){return-1}name(){return"Polyline"}hasEditableCoordinates(){return!1}addPoint(e,t,i){var n;const a=(0,r.ensureNotNull)(this.priceScale()),l=this._model.timeScale().indexToCoordinate(e.index),c=e.price,u=(0,r.ensure)(null===(n=this.ownerSource())||void 0===n?void 0:n.firstValue()),d=a.priceToCoordinate(c,u),h=(0,o.interactionTolerance)().minDistanceBetweenPoints;if(this._points.length>0){const e=this._points[this._points.length-1],t=this._model.timeScale().indexToCoordinate(e.index),i=e.price,r=a.priceToCoordinate(i,u);if(new s.Point(l,d).subtract(new s.Point(t,r)).length()<h)return this._lastPoint=null,this.normalizePoints(),this.createServerPoints(),!0;const n=this._points[0],o=this._model.timeScale().indexToCoordinate(n.index),c=n.price,p=a.priceToCoordinate(c,u)
;if(new s.Point(l,d).subtract(new s.Point(o,p)).length()<h)return this.properties().childs().filled.setValue(!0),this._lastPoint=null,this.normalizePoints(),this.createServerPoints(),!0}return super.addPoint(e,t,i)}setPoint(e,t,i){var n;super.setPoint(e,t,i);const a=this.priceScale();if(!(this._model.timeScale().isEmpty()||null===a||a.isEmpty()||e!==this._points.length-1&&0!==e)){const i=(0,r.ensure)(null===(n=this.ownerSource())||void 0===n?void 0:n.firstValue()),l=this._model.timeScale().indexToCoordinate(t.index),c=a.priceToCoordinate(t.price,i),u=e===this._points.length-1?this._points[0]:this._points[this._points.length-1],d=this._model.timeScale().indexToCoordinate(u.index),h=a.priceToCoordinate(u.price,i);new s.Point(l,c).subtract(new s.Point(d,h)).length()<(0,o.interactionTolerance)().minDistanceBetweenPoints&&this.properties().childs().filled.setValue(!0)}}static createProperties(e){const t=new n.DefaultProperty("linetoolpolyline",e);return l._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,46587)).then(e=>e.PolylinesDefinitionsViewModel)}static _configureProperties(e){a.LineDataSource._configureProperties(e),e.addExclusion("filled")}}},74803:(e,t,i)=>{"use strict";i.d(t,{PositionAveragePriceAxisView:()=>s});var r=i(69722);class s extends r.LineToolPriceAxisView{_formatPrice(e,t){return this._source.formatter().format(e)}}},55833:(e,t,i)=>{"use strict";var r=i(22842),s=i(75363).LineToolTrading,n=i(73371).LineDataSource,o=i(74803).PositionAveragePriceAxisView,a=i(47859),l=i(1771).DefaultProperty,c=i(11228).PriceFormatter,u=i(70734).sortSourcesPreOrdered.LineToolPosition;function d(e){return null==e?e="":e+="",e}class h{constructor(e){this._line=e,this._data={bodyText:"position",quantityText:"0"},this._closeEnabled=!0,this._direction="buy",this._profitState="neutral"}setDirection(e){return this._direction=e,this._line.updateAllViewsAndRedraw(),this}setProfitState(e){return this._profitState=e,this._line.updateAllViewsAndRedraw(),this}getPrice(){return this._line.points().length>0?this._line.points()[0].price:this._line._timePoint.length>0?this._line._timePoint[0].price:void 0}setPrice(e){if(this._line.points().length>0){var t=this._line.points()[0];t.price=e,this._line._points[0]=t,this._line.normalizePoints(),this._line.updateAllViewsAndRedraw()}return this._line._timePoint.length>0&&(this._line._timePoint[0].price=e),this}getText(){return this._data.bodyText}setText(e){return this._data.bodyText=e||"",this._line.updateAllViewsAndRedraw(),this}setTooltip(e){return this._line.properties().tooltip.setValue(d(e)),this}getTooltip(){return this._line.properties().tooltip.value()}setProtectTooltip(e){return this._line.properties().protectTooltip.setValue(d(e)),this}getProtectTooltip(){return this._line.properties().protectTooltip.value()}setCloseTooltip(e){return this._line.properties().closeTooltip.setValue(d(e)),this}getCloseTooltip(){return this._line.properties().closeTooltip.value()}setReverseTooltip(e){
return this._line.properties().reverseTooltip.setValue(d(e)),this}getReverseTooltip(){return this._line.properties().reverseTooltip.value()}getQuantity(){return this._data.quantityText}setQuantity(e){return this._data.quantityText=e||"",this._line.updateAllViewsAndRedraw(),this}getExtendLeft(){var e=this._line.properties().extendLeft.value();return"inherit"===e?this._line._model.properties().tradingProperties.extendLeft.value():e}setExtendLeft(e){return this._line.properties().extendLeft.setValue(e),this}getLineLength(){var e=this._line.properties().lineLength.value();return"inherit"===e?this._line._model.properties().tradingProperties.lineLength.value():e}setLineLength(e){return this._line.properties().lineLength.setValue(Math.max(0,Math.min(e,100))),this}getLineColor(){var e=this._line.properties();return("buy"===this._direction?e.lineBuyColor:e.lineSellColor).value()}setLineColor(e){return"buy"===this._direction?this.setLineBuyColor(e):this.setLineSellColor(e),this}setLineBuyColor(e){return this._line.properties().lineBuyColor.setValue(e),this}setLineSellColor(e){return this._line.properties().lineSellColor.setValue(e),this}getLineStyle(){var e=this._line.properties().lineStyle.value();return"inherit"===e?this._line._model.properties().tradingProperties.lineStyle.value():e}setLineStyle(e){return this._line.properties().lineStyle.setValue(e),this}getLineWidth(){var e=this._line.properties().lineWidth.value();return"inherit"===e?this._line._model.properties().tradingProperties.lineWidth.value():e}setLineWidth(e){return this._line.properties().lineWidth.setValue(e),this}getBodyBorderColor(){var e=this._line.properties();return("buy"===this._direction?e.bodyBorderBuyColor:e.bodyBorderSellColor).value()}setBodyBorderColor(e){return"buy"===this._direction?this.setBodyBorderBuyColor(e):this.setBodyBorderSellColor(e),this}setBodyBorderBuyColor(e){return this._line.properties().bodyBorderBuyColor.setValue(e),this}setBodyBorderSellColor(e){return this._line.properties().bodyBorderSellColor.setValue(e),this}getBodyBackgroundColor(){return a.getColorFromProperties(this._line.properties().bodyBackgroundColor,this._line.properties().bodyBackgroundTransparency)}setBodyBackgroundColor(e){return a.setColorToProperties(e,this._line.properties().bodyBackgroundColor,this._line.properties().bodyBackgroundTransparency),this}getBodyTextColor(){var e=this._line.properties();return("positive"===this._profitState?e.bodyTextPositiveColor:"negative"===this._profitState?e.bodyTextNegativeColor:e.bodyTextNeutralColor).value()}setBodyTextColor(e){return"positive"===this._profitState?this.setBodyTextPositiveColor(e):"negative"===this._profitState?this.setBodyTextNegativeColor(e):this.setBodyTextNeutralColor(e),this}setBodyTextPositiveColor(e){return this._line.properties().bodyTextPositiveColor.setValue(e),this}setBodyTextNegativeColor(e){return this._line.properties().bodyTextNegativeColor.setValue(e),this}setBodyTextNeutralColor(e){return this._line.properties().bodyTextNeutralColor.setValue(e),this}getBodyFont(){
return a.getFontFromProperties(this._line.properties().bodyFontFamily,this._line.properties().bodyFontSize,this._line.properties().bodyFontBold,this._line.properties().bodyFontItalic)}setBodyFont(e){return a.setFontToProperties(e,this._line.properties().bodyFontFamily,this._line.properties().bodyFontSize,this._line.properties().bodyFontBold,this._line.properties().bodyFontItalic),this}getQuantityBorderColor(){var e=this._line.properties();return("buy"===this._direction?e.quantityBorderBuyColor:e.quantityBorderSellColor).value()}setQuantityBorderColor(e){return"buy"===this._direction?this.setQuantityBorderBuyColor(e):this.setQuantityBorderSellColor(e),this}setQuantityBorderBuyColor(e){return this._line.properties().quantityBorderBuyColor.setValue(e),this}setQuantityBorderSellColor(e){return this._line.properties().quantityBorderSellColor.setValue(e),this}getQuantityBackgroundColor(){var e=this._line.properties();return("buy"===this._direction?e.quantityBackgroundBuyColor:e.quantityBackgroundSellColor).value()}setQuantityBackgroundColor(e){return"buy"===this._direction?this.setQuantityBackgroundBuyColor(e):this.setQuantityBackgroundSellColor(e),this}setQuantityBackgroundBuyColor(e){return this._line.properties().quantityBackgroundBuyColor.setValue(e),this}setQuantityBackgroundSellColor(e){return this._line.properties().quantityBackgroundSellColor.setValue(e),this}getQuantityTextColor(){return a.getColorFromProperties(this._line.properties().quantityTextColor,this._line.properties().quantityTextTransparency)}setQuantityTextColor(e){return a.setColorToProperties(e,this._line.properties().quantityTextColor,this._line.properties().quantityTextTransparency),this}getQuantityFont(){return a.getFontFromProperties(this._line.properties().quantityFontFamily,this._line.properties().quantityFontSize,this._line.properties().quantityFontBold,this._line.properties().quantityFontItalic)}setQuantityFont(e){return a.setFontToProperties(e,this._line.properties().quantityFontFamily,this._line.properties().quantityFontSize,this._line.properties().quantityFontBold,this._line.properties().quantityFontItalic),this}getReverseButtonBorderColor(){var e=this._line.properties();return("buy"===this._direction?e.reverseButtonBorderBuyColor:e.reverseButtonBorderSellColor).value()}setReverseButtonBorderColor(e){return"buy"===this._direction?this.setReverseButtonBorderBuyColor(e):this.setReverseButtonBorderSellColor(e),this}setReverseButtonBorderBuyColor(e){return this._line.properties().reverseButtonBorderBuyColor.setValue(e),this}setReverseButtonBorderSellColor(e){return this._line.properties().reverseButtonBorderSellColor.setValue(e),this}getReverseButtonBackgroundColor(){return a.getColorFromProperties(this._line.properties().reverseButtonBackgroundColor,this._line.properties().reverseButtonBackgroundTransparency)}setReverseButtonBackgroundColor(e){return a.setColorToProperties(e,this._line.properties().reverseButtonBackgroundColor,this._line.properties().reverseButtonBackgroundTransparency),this}getReverseButtonIconColor(){
var e=this._line.properties();return("buy"===this._direction?e.reverseButtonIconBuyColor:e.reverseButtonIconSellColor).value()}setReverseButtonIconColor(e){return"buy"===this._direction?this.setReverseButtonIconBuyColor(e):this.setReverseButtonIconSellColor(e),this}setReverseButtonIconBuyColor(e){return this._line.properties().reverseButtonIconBuyColor.setValue(e),this}setReverseButtonIconSellColor(e){return this._line.properties().reverseButtonIconSellColor.setValue(e),this}getCloseButtonBorderColor(){var e=this._line.properties();return("buy"===this._direction?e.closeButtonBorderBuyColor:e.closeButtonBorderSellColor).value()}setCloseButtonBorderColor(e){return"buy"===this._direction?this.setCloseButtonBorderBuyColor(e):this.setCloseButtonBorderSellColor(e),this}setCloseButtonBorderBuyColor(e){return this._line.properties().closeButtonBorderBuyColor.setValue(e),this}setCloseButtonBorderSellColor(e){return this._line.properties().closeButtonBorderSellColor.setValue(e),this}getCloseButtonBackgroundColor(){return a.getColorFromProperties(this._line.properties().closeButtonBackgroundColor,this._line.properties().closeButtonBackgroundTransparency)}setCloseButtonBackgroundColor(e){return a.setColorToProperties(e,this._line.properties().closeButtonBackgroundColor,this._line.properties().closeButtonBackgroundTransparency),this}getCloseButtonIconColor(){var e=this._line.properties();return("buy"===this._direction?e.closeButtonIconBuyColor:e.closeButtonIconSellColor).value()}setCloseButtonIconColor(e){return"buy"===this._direction?this.setCloseButtonIconBuyColor(e):this.setCloseButtonIconSellColor(e),this}setCloseButtonIconBuyColor(e){return this._line.properties().closeButtonIconBuyColor.setValue(e),this}setCloseButtonIconSellColor(e){return this._line.properties().closeButtonIconSellColor.setValue(e),this}block(){this._blocked=!0,this._line.updateAllViewsAndRedraw()}unblock(){this._blocked=!1,this._line.updateAllViewsAndRedraw()}isFunction(e){return"function"==typeof e}onReverse(e,t){return t?this.isFunction(t)&&(this._onReverseData=e,this._onReverseCallback=t):this.isFunction(e)&&(this._onReverseCallback=e),this}callOnReverse(){this.isFunction(this._onReverseCallback)&&this._onReverseCallback.call(this,this._onReverseData)}isOnReverseCallbackPresent(){return this.isFunction(this._onReverseCallback)}onClose(e,t){return t?this.isFunction(t)&&(this._onCloseData=e,this._onCloseCallback=t):this.isFunction(e)&&(this._onCloseCallback=e),this}setCloseEnabled(e){return this._closeEnabled===e||(this._closeEnabled=e,this._onCloseCallback&&this._line.updateAllViewsAndRedraw()),this}isCloseEnabled(){return this._closeEnabled}callOnClose(){this.isFunction(this._onCloseCallback)&&this._closeEnabled&&this._onCloseCallback.call(this,this._onCloseData)}isOnCloseCallbackPresent(){return this._closeEnabled&&this.isFunction(this._onCloseCallback)}onModify(e,t){return t?this.isFunction(t)&&(this._onModifyData=e,this._onModifyCallback=t):this.isFunction(e)&&(this._onModifyCallback=e),this}callOnModify(){
this.isFunction(this._onModifyCallback)&&this._onModifyCallback.call(this,this._onModifyData)}onContextMenu(e,t){return t?this.isFunction(t)&&(this._onContextMenuData=e,this._onContextMenuCallback=t):this.isFunction(e)&&(this._onContextMenuCallback=e),this}shouldShowContextMenu(){return this.isFunction(this._onContextMenuCallback)}callOnContextMenu(){if(this.isFunction(this._onContextMenuCallback))return this._onContextMenuCallback.call(this,this._onContextMenuData)}remove(){this._line._model.removeSource(this._line),delete this._line}}class p extends s{constructor(e,t){super(e,t||p.createProperties()),this._adapter=new h(this),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,76656,19)).then(({PositionPaneView:e})=>{this._setPaneViews([new e(this,this._model)])});var r=e.mainSeries().symbolInfo(),s=null!==r?r.pricescale:100,n=null!==r&&r.fractional?r.minmov:1,o=null!==r&&r.fractional,a=null!==r?r.minmove2:void 0;this._formatter=new c(s,n,o,a)}zorder(){return u}isSpeciallyZOrderedSource(){return!0}setPoint(e,t,i){this._points[e]=t,this.normalizePoints()}addPoint(e,t){return this._points.push(e),this._lastPoint=null,this.normalizePoints(),this.createServerPoints(),!0}name(){return"Position"}createPriceAxisView(e){return this._priceAxisView=new o(this,{pointIndex:e,backgroundPropertyGetter:()=>this._adapter.getLineColor()}),this._priceAxisView}paneViews(){return TradingView.printing&&!r.enabled("snapshot_trading_drawings")?null:this._model.properties().tradingProperties.showPositions.value()?n.prototype.paneViews.call(this):null}priceAxisViews(e,t){return TradingView.printing&&!r.enabled("snapshot_trading_drawings")?null:this._model.properties().tradingProperties.showPositions.value()?n.prototype.priceAxisViews.call(this,e,t):null}hasContextMenu(){return this._adapter.shouldShowContextMenu()}contextMenuItems(){return this._adapter.callOnContextMenu()}formatter(){return this._formatter}static createProperties(e){var t=new l("linetoolposition",e,!1,!1);return p._configureProperties(t),t}static _configureProperties(e){s._configureProperties(e)}}t.LineToolPosition=p},90251:(e,t,i)=>{"use strict";var r,s;i.r(t),i.d(t,{AlertStatus:()=>r,Direction:()=>s}),function(e){e[e.Waiting=0]="Waiting",e[e.Success=1]="Success",e[e.Failure=2]="Failure"}(r||(r={})),function(e){e[e.Up=1]="Up",e[e.Down=2]="Down"}(s||(s={}))},70092:(e,t,i)=>{"use strict";var r=i(16282).ensureNotNull,s=i(73371).LineDataSource,n=i(1771).DefaultProperty,o=i(90251);class a extends s{constructor(e,t){super(e,t||a.createProperties()),this._predictionPaneView=null,this._model.mainSeries().properties().interval.subscribe(this,()=>{this.setStatus(o.AlertStatus.Waiting)}),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,69706,19)).then(({PredictionPaneView:e})=>{this._predictionPaneView=new e(this,this._model),this._setPaneViews([this._predictionPaneView])})}destroy(){super.destroy(),this._model.mainSeries().properties().interval.unsubscribeAll(this)}dataAndViewsReady(){
return s.prototype.dataAndViewsReady.call(this)&&this._predictionPaneView&&this._predictionPaneView.iconsReady()}isSynchronizable(){return!1}status(){return this._properties.status.value()}setStatus(e){return this._properties.status.setValue(e)}pointsCount(){return 2}name(){return"Forecast"}restorePoints(e,t,i){super.restorePoints(e,t,i),this.checkAlert()}checkAlert(){if(!(this._points.length<2||this._model.mainSeries().bars().isEmpty())){var e=this._points[1];if(this.status())e.index>this._model.timeScale().baseIndex()&&this.setStatus(o.AlertStatus.Waiting);else{var t=this._model.mainSeries().bars().valueAt(e.index);if(null!==t){var i=this.direction();if(i===o.Direction.Up&&t[TradingView.HIGH_PLOT]>=e.price)this.setStatus(o.AlertStatus.Success);else if(i===o.Direction.Down&&t[TradingView.LOW_PLOT]<=e.price)this.setStatus(o.AlertStatus.Success);else{var s=r(this._model.mainSeries().bars().lastIndex());e.index!==s&&this.setStatus(o.AlertStatus.Failure)}}}}}addPoint(e){var t=s.prototype.addPoint.call(this,e);return t&&this.checkAlert(),t}endChanging(){super.endChanging(),this.setStatus(o.AlertStatus.Waiting),this.checkAlert()}onData(e){super.onData(e),this.checkAlert()}endMoving(){super.endMoving(),this.setStatus(o.AlertStatus.Waiting),this.checkAlert()}direction(){if(this.points().length<2)return o.Direction.Up;var e=this.points()[0];return this.points()[1].price>e.price?o.Direction.Up:o.Direction.Down}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,62262))).PredictionDefinitionsViewModel}cloneable(){return!1}static createProperties(e){var t=new n("linetoolprediction",e);return a._configureProperties(t),t}static _configureProperties(e){s._configureProperties(e),e.merge({status:o.AlertStatus.Waiting})}}t.LineToolPrediction=a},19275:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(1771).DefaultProperty,n=i(22756).LineToolColorsProperty;class o extends r{constructor(e,t){super(e,t||o.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,80186,19)).then(({PriceLabelPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}pointsCount(){return 1}name(){return"Price Label"}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,50481))).PriceLabelDefinitionsViewModel}static createProperties(e){var t=new s("linetoolpricelabel",e);return o._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e),e.addChild("linesColors",new n([e.childs().borderColor])),e.addChild("textsColors",new n([e.childs().color]))}}t.LineToolPriceLabel=o},82998:(e,t,i)=>{"use strict";i.d(t,{LineToolPriceNote:()=>l});var r=i(16282),s=i(1771),n=i(27937),o=i.n(n),a=i(73371);class l extends a.LineDataSource{constructor(e,t){super(e,t||l.createProperties()),this._labelMovingDelta=null,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,40770)).then(t=>{
this._setPaneViews([new t.PriceNotePaneView(this,e)])})}pointsCount(){return 2}name(){return"Price Note"}template(){const e=super.template();return e.text=this.properties().childs().text.value(),e}startMoving(e,t,i){if(1===t){if(this.isSourceHidden())return;const i=(0,r.ensureDefined)(e.logical),s=this.points()[1];this._labelMovingDelta={index:s.index-i.index,price:s.price-i.price},this.startChanging(t,i)}else this._labelMovingDelta=null,super.startMoving(e,t,i)}move(e,t,i){if(null!==this._labelMovingDelta){const t=(0,r.ensureDefined)(e.logical),s={index:t.index+this._labelMovingDelta.index,price:t.price+this._labelMovingDelta.price};this.setPoint(1,s,i),this.updateAllViews()}else super.move(e,t,i)}endMoving(e,t){return null!==this._labelMovingDelta?(this._labelMovingDelta=null,this.endChanging(!1,e)):super.endMoving(e)}static createProperties(e){const t=new s.DefaultProperty("linetoolpricenote",e);return l._configureProperties(t),t}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text)}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,43140)).then(e=>e.PriceNoteDefinitionsViewModel)}_snapTo45DegreesAvailable(){return!0}static _configureProperties(e){a.LineDataSource._configureProperties(e),e.hasChild("text")||e.addChild("text",new(o())("")),e.addExclusion("text"),e.hasChild("backgroundsColors")&&e.removeProperty("backgroundsColors"),e.hasChild("textsColors")&&e.removeProperty("textsColors")}}},46835:(e,t,i)=>{"use strict";i.d(t,{LineToolPriceRange:()=>n});var r=i(1771),s=i(73371);class n extends s.LineDataSource{constructor(e,t){super(e,t||n.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,94722)).then(e=>{this._setPaneViews([new e.PriceRangePaneView(this,this._model)])})}pointsCount(){return 2}name(){return"Price Range"}static createProperties(e){const t=new r.DefaultProperty("linetoolpricerange",e);return n._configureProperties(t),t}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,34404))).GeneralDatePriceRangeDefinitionsViewModel}static _configureProperties(e){s.LineDataSource._configureProperties(e)}}},99153:(e,t,i)=>{"use strict";var r=i(92372),s=i(80484).LineToolFibWedgeBase,n=i(22756).LineToolColorsProperty;class o extends s{constructor(e,t){super(e,t||o.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,62644,19)).then(({ProjectionLinePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}levelsCount(){return 1}name(){return"Projection"}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,6673))).ProjectionDefinitionsViewModel}static createProperties(e){var t=new r("linetoolprojection",e,!1,{range:[1,1]});return o._configureProperties(t),t}static _configureProperties(e){s._configureProperties(e),
e.addChild("linesColors",new n([e.trendline.color]))}}t.LineToolProjection=o},30133:(e,t,i)=>{"use strict";var r=i(35200).LineToolTrendLine,s=i(1771).DefaultProperty;class n extends r{constructor(e,t){super(e,t||n.createProperties())}name(){return"Ray"}static createProperties(e){var t=new s("linetoolray",e);return n._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e)}}t.LineToolRay=n},14694:(e,t,i)=>{"use strict";i.d(t,{LineToolRectangle:()=>c});var r=i(72927),s=i(1771),n=i(27937),o=i.n(n),a=i(73371),l=i(22756);class c extends a.LineDataSource{constructor(e,t){const r=t||c.createProperties();super(e,r),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,94179)).then(({RectanglePaneView:t})=>{const i=[new t(this,e)];this._setPaneViews(i)})}pointsCount(){return 2}textColorsProperty(){return this.properties().childs().showLabel.value()?super.textColorsProperty():null}name(){return"Rectangle"}setPoint(e,t,i){if(e<2&&super.setPoint(e,t,i),i&&i.shift()){const i=this._getAnchorPointForIndex(e);if(e>=4)return this._correctMiddlePoints(e,t,i),void this.normalizePoints();this._snapPoint45Degree(t,i)}switch(e){case 2:this._points[1].price=t.price,this._points[0].index=t.index;break;case 3:this._points[0].price=t.price,this._points[1].index=t.index;break;case 4:this._points[0].index=t.index;break;case 5:this._points[1].index=t.index;break;case 6:this._points[0].price=t.price;break;case 7:this._points[1].price=t.price}this.normalizePoints()}getPoint(e){return e<2?super.getPoint(e):this._getAnchorPointForIndex(e)}template(){const e=super.template();return e.text=this.properties().childs().text.value(),e}static createProperties(e){const t=new s.DefaultProperty("linetoolrectangle",e);return c._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,55017)).then(e=>e.RectangleDefinitionsViewModel)}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text)}_snapPoint45Degree(e,t,i){const r=this.m_priceScale,s=this.ownerSource();if(null===r||null===s)return;const n=s.firstValue();if(null===n)return;const o=this._model.timeScale(),a=this.pointToScreenPoint(e)[0],l=this.pointToScreenPoint(t)[0],c=a.x-l.x,u=a.y-l.y,d=c<0?-1:1,h=u<0?-1:1,p=Math.max(Math.abs(c),Math.abs(u)),_=Math.round(o.coordinateToIndex(l.x+p*d)),m=Math.abs(o.indexToCoordinate(_)-l.x),f=r.coordinateToPrice(l.y+m*h,n);e.index=_,e.price=f}_correctMiddlePoints(e,t,i){e<6?this._correctRightLeftMiddlePoint(e,t,i):this._correctTopBottomMiddlePoint(e,t,i)}_correctRightLeftMiddlePoint(e,t,i){const s=this.pointToScreenPoint(t)[0],n=this.pointToScreenPoint(i)[0],o=this.pointToScreenPoint(this._points[0])[0],a=this.pointToScreenPoint(this._points[1])[0];let l=s.x-n.x;if(0===l)return;const c=o.x<a.x?1:-1,u=o.y<a.y?1:-1;switch(l*=c,e){case 4:{const e=a.y-u*l/2,t=this.screenPointToPoint(new r.Point(a.x,e));this._points[1].price=t.price;const i=this.screenPointToPoint(new r.Point(o.x+c*l,o.y+u*l/2))
;this._points[0].price=i.price,this._points[0].index=i.index;break}case 5:{const e=o.y-u*l/2,t=this.screenPointToPoint(new r.Point(o.x,e));this._points[0].price=t.price;const i=this.screenPointToPoint(new r.Point(a.x+c*l,a.y+u*l/2));this._points[1].price=i.price,this._points[1].index=i.index;break}}}_correctTopBottomMiddlePoint(e,t,i){const s=this.m_priceScale,n=this.ownerSource();if(null===s||null===n)return;const o=this._model.timeScale(),a=n.firstValue();if(null===a)return;const l=this.pointToScreenPoint(t)[0],c=this.pointToScreenPoint(i)[0],u=this.pointToScreenPoint(this._points[0])[0],d=this.pointToScreenPoint(this._points[1])[0],h=l.y-c.y,p=h<0?-1:1,_=u.x<d.x?1:-1,m=u.y<d.y?1:-1;switch(e){case 6:{const e=Math.floor(d.x-_*h/2),t=this.screenPointToPoint(new r.Point(e,d.y)),i=Math.abs(this._points[1].index-t.index),n=_*m*p*Math.ceil(i/2);if(0===n)return;this._points[1].index=this._points[1].index-n;const l=p*Math.abs(o.indexToCoordinate(this._points[1].index)-d.x);this._points[0].price=s.coordinateToPrice(u.y+l,a),this._points[0].index=this._points[0].index+n;break}case 7:{const e=Math.floor(u.x-_*h/2),t=this.screenPointToPoint(new r.Point(e,u.y)),i=Math.abs(this._points[0].index-t.index),n=_*m*p*Math.ceil(i/2);if(0===n)return;this._points[0].index=this._points[0].index-n;const l=p*Math.abs(o.indexToCoordinate(this._points[0].index)-u.x);this._points[1].price=s.coordinateToPrice(d.y+l,a),this._points[1].index=this._points[1].index+n;break}}}_snapTo45DegreesAvailable(){return!0}static _configureProperties(e){a.LineDataSource._configureProperties(e),e.hasChild("text")||e.addChild("text",new(o())("")),e.addChild("linesColors",new l.LineToolColorsProperty([e.childs().color])),e.addChild("textsColors",new l.LineToolColorsProperty([e.childs().textColor],e.childs().showLabel)),e.addExclusion("text"),e.addExclusion("linesColors"),e.addExclusion("textsColors")}_getAnchorPointForIndex(e){const t=this.points(),i=t[0],r=t[1];let s=0,n=0;switch(e){case 0:s=i.price,n=i.index;break;case 1:s=r.price,n=r.index;break;case 2:s=r.price,n=i.index;break;case 3:s=i.price,n=r.index;break;case 4:s=(r.price+i.price)/2,n=i.index;break;case 5:s=(r.price+i.price)/2,n=r.index;break;case 6:s=i.price,n=(r.index+i.index)/2;break;case 7:s=r.price,n=(r.index+i.index)/2}return{index:n,price:s}}}},90211:(e,t,i)=>{"use strict";i.d(t,{patchSourceState:()=>r});i(20220);function r(e){const t={palettes:{},inputs:[{defval:2,id:"upper diviation",max:500,min:-500,name:window.t("Upper Deviation"),type:"integer"},{defval:-2,id:"lower diviation",max:500,min:-500,name:window.t("Lower Deviation"),type:"integer"},{defval:!0,id:"use upper diviation",name:window.t("Use Upper Deviation"),type:"bool"},{defval:!0,id:"use lower diviation",name:window.t("Use Lower Deviation"),type:"bool"},{defval:0,id:"first bar time",max:253370764800,min:0,name:window.t("First bar time"),type:"time"},{defval:0,id:"last bar time",max:253370764800,min:0,name:window.t("Last bar time"),type:"time"},{defval:"close",id:"source",name:window.t("Source"),
options:["open","high","low","close","hl2","hlc3","ohlc4"],type:"text"}],plots:[],graphics:{},defaults:{inputs:{"first bar time":0,"last bar time":0,"lower diviation":-2,source:"close","upper diviation":2,"use lower diviation":!0,"use upper diviation":!0}},_metainfoVersion:6,description:"Regression Trend",id:"RegressionTrend@tv-basicstudies",is_price_study:!0,shortDescription:"Reg Trend",shortId:"RegressionTrend",version:"2",fullId:"RegressionTrend@tv-basicstudies-2",name:"RegressionTrend@tv-basicstudies"};return e.metaInfo||(e.metaInfo=t),e}},94238:(e,t,i)=>{"use strict";var r=i(16282).assert,s=i(31115).StudyLineDataSource,n=i(41657).INVALID_TIME_POINT_INDEX,o="RegressionTrend@tv-basicstudies";function a(e){return void 0!==e.startPrice&&void 0!==e.endPrice}class l extends s{constructor(e,t,r){r=r||e.studyMetaInfoRepository().findByIdSync({type:"java",studyId:o});var n=t||s._createPropertiesFromStudyMetaInfo(r,e.studyVersioning());super(e,r,"linreg_",n),this._trendData=null,Promise.all([i.e(13935),i.e(20507)]).then(i.t.bind(i,52535,19)).then(({RegressionTrendPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}formatter(){r(!1,"This method should never be called")}pointsCount(){return 2}clearData(){this._trendData=null,super.clearData()}state(e){var t=s.prototype.state.call(this,e);return e?Object.assign({},t,{nonseriesdata:this._trendData}):t}restoreData(e){super.restoreData(e),this._trendData=e.nonseriesdata?e.nonseriesdata:null}startIndex(){if(null===this._trendData||null===this._indexes)return null;var e=this._indexes[this._trendData.startIndex];return e!==n?e:null}endIndex(){if(null===this._trendData||null===this._indexes)return null;var e=this._indexes[this._trendData.endIndex];return e!==n?e:null}baseLine(){return null===this._trendData?null:this._trendData.baseLine}downLine(){return null===this._trendData?null:this._trendData.downLine}upLine(){return null===this._trendData?null:this._trendData.upLine}pearsons(){return null===this._trendData?null:this._trendData.pearsons}recalcStudyIfNeeded(){this._onStudyInputsMayChange()}_studyInputs(e){r(2===e.length,"all the line tool points should be defined");var t=e[0],i=e[1];if(t.index===i.index)return null;const s=this._getPointTime(t.index<=i.index?t:i,!0),n=this._getPointTime(i.index>=t.index?i:t,!0);if(null===s||null===n)return this._subscribeApplyInputsOnSeriesCompleted(),null;var o=1e3*s,a=1e3*n;return{"upper diviation":this.properties().inputs["upper diviation"].value(),"lower diviation":this.properties().inputs["lower diviation"].value(),"use upper diviation":this.properties().inputs["use upper diviation"].value(),"use lower diviation":this.properties().inputs["use lower diviation"].value(),"first bar time":o,"last bar time":a,source:this.properties().inputs.source.value()}}_onDataUpdated(e,t,i){null!==t&&(t.indexes_replace||(this._trendData=t.data),this._indexes=i,super._onDataUpdated(e,t,i))}_updateAnchorsPrice(){
!this._trendData||TradingView.isNaN(this._trendData.baseLine.startPrice)||TradingView.isNaN(this._trendData.baseLine.endPrice)||(this._points[0].price=this._trendData.baseLine.startPrice,this._points[1].price=this._trendData.baseLine.endPrice)}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(60607)]).then(i.bind(i,80386))).RegressionTrendDefinitionsViewModel}_isReady(){return this._trendData&&void 0!==this._trendData.startIndex&&void 0!==this._trendData.endIndex&&a(this._trendData.upLine)&&a(this._trendData.baseLine)&&a(this._trendData.downLine)}static createProperties(e){return s._createPropertiesFromStudyIdAndState(o,e)}static createPropertiesFromStudyMetaInfoAndState(e,t,i,r){return s.createPropertiesFromStudyMetaInfoAndState(e,t,i,r)}static studyId(){return o}cloneable(){return!1}}l.prototype.version=2,t.LineToolRegressionTrend=l},89987:(e,t,i)=>{"use strict";var r;i.d(t,{RiskDisplayMode:()=>r}),function(e){e.Percentage="percents",e.Money="money"}(r||(r={}))},50291:(e,t,i)=>{"use strict";var r;i.d(t,{RiskRewardPointIndex:()=>r}),function(e){e[e.Entry=0]="Entry",e[e.Close=1]="Close",e[e.ActualEntry=2]="ActualEntry",e[e.ActualClose=3]="ActualClose"}(r||(r={}))},11952:(e,t,i)=>{"use strict";i.d(t,{LineToolRiskRewardPriceAxisView:()=>s});var r=i(32552);class s extends r.PriceAxisView{constructor(e,t){super(),this._source=e,this._data=t}_updateRendererData(e,t,i){if(e.visible=!1,!this._showAxisLabel())return;const r=this._source.priceScale();if(0===this._source.points().length||null===r||r.isEmpty())return;const s=this._source.ownerSource(),n=null!==s?s.firstValue():null;if(null===n)return;const o=this._data.priceProperty.value(),a=this._data.colorProperty.value();i.background=a,i.textColor=this.generateTextColor(a),i.coordinate=r.priceToCoordinate(o,n),e.text=r.formatPrice(o,n),e.visible=!0}_showAxisLabel(){return this._source.properties().childs().showPriceLabels.value()}}},30924:(e,t,i)=>{"use strict";i.r(t),i.d(t,{RiskRewordEntryPriceProperty:()=>a,RiskRewordStopPriceProperty:()=>l,RiskRewardTargetPriceProperty:()=>c});var r=i(16282),s=i(27937),n=i.n(s);class o extends(n()){constructor(e,t){super(),this._lineSource=e,this._pointIndex=t}value(){const e=this._lineSource.points()[this._pointIndex].price;return this._formatAndParsePrice(e)}state(){return this.value()}merge(e,t){return this.setValue(e),t?[]:null}_formatAndParsePrice(e){const t=(0,r.ensureNotNull)(this._lineSource.ownerSource()).formatter();if(t.parse){const i=t.format(e),r=t.parse(i);return r.res?r.value:e}return e}}class a extends o{constructor(e){super(e,0)}setValue(e){const t=this._lineSource.points()[this._pointIndex];this._lineSource.startChanging(this._pointIndex,t),t.price=parseFloat(""+e),this._lineSource.setPoint(this._pointIndex,t),this._lineSource.recalculate(),this._lineSource.model().updateSource(this._lineSource),this._listeners.fire(this),this._lineSource.endChanging(!1,!1),this._lineSource.syncPriceLevels()}}class l extends o{constructor(e){super(e,1)}value(){
const e=this._lineSource.stopPrice();return this._formatAndParsePrice(e)}setValue(e){const t=Math.round(Math.abs(e-this._lineSource.entryPrice())*this._lineSource.model().mainSeries().base());this._lineSource.properties().childs().stopLevel.setValue(t),this._lineSource.syncPriceLevels()}}class c extends o{constructor(e){super(e,2)}value(){const e=this._lineSource.profitPrice();return this._formatAndParsePrice(e)}setValue(e){const t=Math.round(Math.abs(e-this._lineSource.entryPrice())*this._lineSource.model().mainSeries().base());this._lineSource.properties().childs().profitLevel.setValue(t),this._lineSource.syncPriceLevels()}}},46049:(e,t,i)=>{"use strict";var r=i(59757).PriceRange,s=i(16282).ensureNotNull,n=i(73371).LineDataSource,o=i(11952).LineToolRiskRewardPriceAxisView,a=i(14397),l=i(1771).DefaultProperty,c=i(80790).NumericFormatter,u=i(50291).RiskRewardPointIndex,d=i(30924),h=d.RiskRewordEntryPriceProperty,p=d.RiskRewordStopPriceProperty,_=d.RiskRewardTargetPriceProperty,m=i(89987).RiskDisplayMode,f=i(31565).isNumber,g=i(40989).PlotRowSearchMode,v=i(11377),S=v.SIDE,y=v.ORDERTYPE;class b extends n{constructor(e,t){var s=t;if(super(e,s),!t.stopLevel&&!t.profitLevel){var n=e.timeScale().visibleBarsStrictRange(),a=n.firstBar(),l=n.lastBar(),d=e.mainSeries().priceRange(a,l),f=e.mainSeries().priceScale();if(f.isLog()){var g=f.logicalToPrice(d.minValue()),v=f.logicalToPrice(d.maxValue());d=new r(g,v)}if(d&&!d.isEmpty()){var S=Math.round(.2*d.length()*e.mainSeries().base());s.merge({stopLevel:S,profitLevel:S})}}var y=this;s.stopLevel.listeners().subscribe(this,this.recalculate),s.stopLevel.listeners().subscribe(null,(function(){y.properties().stopPrice._listeners.fire(y.properties().stopPrice)})),s.profitLevel.listeners().subscribe(this,this.recalculate),s.profitLevel.listeners().subscribe(null,(function(){y.properties().targetPrice._listeners.fire(y.properties().targetPrice)})),s.addChild("entryPrice",new h(this)),s.addChild("stopPrice",new p(this)),s.addChild("targetPrice",new _(this)),s.addProperty("riskSize",0),s.addProperty("qty",0),s.addProperty("amountTarget",s.accountSize.value()),s.addProperty("amountStop",s.accountSize.value()),this._riskInPercentsFormatter=new c(2),this._riskInMoneyFormatter=new c,s.risk.subscribe(this,this._recalculateRiskSize),s.accountSize.subscribe(this,this._recalculateRiskSize),s.riskDisplayMode.subscribe(this,this._recalculateRisk),s.riskDisplayMode.subscribe(this,this._recalculateRiskSize),s.entryPrice.subscribe(this,this._recalculateRiskSize),s.stopPrice.subscribe(this,this._recalculateRiskSize),s.profitLevel.subscribe(this,this._recalculateRiskSize),s.profitLevel.subscribe(this,this.syncPriceLevels.bind(this)),s.stopLevel.subscribe(this,this._recalculateRiskSize),s.stopLevel.subscribe(this,this.syncPriceLevels.bind(this)),s.qty.subscribe(this,this._recalculateRiskSize),this.pointAdded().subscribe(this,e=>{switch(e){case u.Entry:case u.Close:this._recalculateRiskSize(),this._recalculateQty()}}),this.pointChanged().subscribe(this,e=>{switch(e){case u.Entry:case u.Close:
this._recalculateRiskSize(),this._recalculateQty()}}),s.riskDisplayMode.value()===m.Percentage&&s.risk.value()>100&&s.riskDisplayMode.setValueSilently(m.Money),this._syncStateExclusions=["points","entryPrice","stopPrice","targetPrice","stopLevel","profitLevel","riskSize","qty","amountTarget","amountStop"],this.version=b.version,this._entryPriceAxisView=new o(this,{colorProperty:s.linecolor,priceProperty:s.entryPrice}),this._stopPriceAxisView=new o(this,{colorProperty:s.stopBackground,priceProperty:s.stopPrice}),this._profitPriceAxisView=new o(this,{colorProperty:s.profitBackground,priceProperty:s.targetPrice}),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,72173,19)).then(({RiskRewardPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}riskFormatter(e){return e===m.Percentage?this._riskInPercentsFormatter:this._riskInMoneyFormatter}getRiskStep(e){return e===m.Percentage?.01:1}_roundValue(e){return parseFloat(e.toFixed(2))}hasEditableCoordinates(){return!1}_recalculateRisk(){var e=this.properties(),t=e.riskDisplayMode.value(),i=e.riskSize.value(),r=e.accountSize.value(),s=e.risk.value();s=t===m.Percentage?this._roundValue(i/r*100):this._roundValue(r/100*s),this._riskInChange=!0,e.risk.setValue(this.riskFormatter(t).format(s)),this._riskInChange=!1}_recalculateRiskSize(){if(!this._riskInChange){var e=this.properties(),t=e.risk.value(),i=e.riskDisplayMode.value(),r=e.accountSize.value();i===m.Percentage?e.riskSize.setValue(t/100*r):t>r?(e.risk.setValue(r),e.riskSize.setValue(r)):e.riskSize.setValue(t)}}lastBarData(){var e=this._model.mainSeries().bars().firstIndex(),t=this._model.mainSeries().bars().lastIndex();if(null===e||null===t||isNaN(e)||isNaN(t))return null;var i=this.points();if(4===i.length){var r=i[u.ActualClose];return r.index<e?null:{closePrice:r.price,index:Math.min(t,r.index)}}var s=i[u.Close];if(s.index<e)return null;var n=Math.min(t,s.index),o=this._model.mainSeries().bars().search(n,g.NearestLeft);return null===o?null:{closePrice:o.value[TradingView.CLOSE_PLOT],index:o.index}}migrateVersion(e,t,i){if(1===e&&this._points.length>=1){var r=[];if(r.push(this._points[0]),n={price:(n=this._points[0]).price,index:this._getClosePointIndex(n.index)},r.push(n),this._points[1]&&r.push(this._points[1]),this._points[2]&&r.push(this._points[2]),this._points=r,this._timePoint.length>=1){var s=[],n=this._timePoint[0];s.push(n);var o={price:n.price,time_t:n.time_t,offset:this._getClosePointIndex(n.offset)};s.push(o),this._timePoint[1]&&r.push(this._points[1]),this._timePoint[2]&&r.push(this._points[2]),this._timePoint=s}}}checkAlert(){this.recalculate()}priceAxisViews(e,t){return this.isSourceHidden()||t!==this.priceScale()||this._model.paneForSource(this)!==e?null:[this._entryPriceAxisView,this._stopPriceAxisView,this._profitPriceAxisView]}updateAllViews(){this.isActualSymbol()&&this._properties.visible.value()&&(a.hideAllDrawings().value()&&this.userEditEnabled()||(super.updateAllViews(),this._entryPriceAxisView.update(),this._stopPriceAxisView.update(),
this._profitPriceAxisView.update()))}restoreExternalState(e){if(f(e.entryPrice)){if(e=Object.assign({},e),!this.isActualSymbol())this._timePoint[0].price=e.entryPrice,delete e.entryPrice;this.properties().merge(e)}else super.restoreExternalState(e)}_changeEntryPoint(e){var t=this.properties().stopPrice.value(),i=this.properties().targetPrice.value(),r=1/this._model.mainSeries().base(),s=Math.min(t,i)+r,n=Math.max(t,i)-r;e.price=Math.max(s,Math.min(n,this._roundPrice(e.price))),super.setPoint(0,e),this.properties().stopPrice.setValue(t),this.properties().targetPrice.setValue(i)}setPoint(e,t,i){if(this.isActualSymbol()){switch(this._muteSyncLineStyle(),e){case 0:this._changeEntryPoint(t);break;case 2:this.properties().stopPrice.setValue(this.preparseStopPrice(t.price));break;case 3:this.properties().targetPrice.setValue(this.preparseProfitPrice(t.price));break;case 1:t.price=this._roundPrice(t.price),super.setPoint(1,t),this.recalculate()}this._unmuteSyncLineStyleWithoutApplyingChanges(),this.syncPriceLevels()}}getPoint(e){switch(e){case 0:return this._points[0];case 1:return{index:this._points[1].index,price:this._points[0].price};case 2:return{index:this._points[0].index,price:this.stopPrice()};case 3:return{index:this._points[0].index,price:this.profitPrice()}}return null}setPoints(e){this._muteSyncLineStyle(),super.setPoints(e),this.recalculate(),this._unmuteSyncLineStyleWithoutApplyingChanges(),this.syncPriceLevels()}syncPriceLevels(){if(this.linkKey().value()){var e=this.properties(),t={entryPrice:e.entryPrice.value(),stopLevel:e.stopLevel.value(),profitLevel:e.profitLevel.value()};a.changeLineStyle({linkKey:this.linkKey().value(),state:t,model:this._model})}}pointsCount(){return 1}name(){return"Risk/Reward"}addPoint(e){e.price=this._roundPrice(e.price),super.addPoint(e,null,!0);var t={price:e.price,index:this._getClosePointIndex(e.index)};super._addPointIntenal(t,null,!0);var i=this.calculateActualEntry(e,t);i&&(super._addPointIntenal(i,null,!0),(t=this.findClosePoint(i,t))&&super._addPointIntenal(t,null,!0));return this._lastPoint=null,this.normalizePoints(),this.createServerPoints(),!0}setOwnerSource(e){super.setOwnerSource(e),this._model.mainSeries().symbolInfo()&&(this._recalculateAmount(),this._recalculateRiskSize(),this._recalculateQty())}_roundPrice(e){var t=this._model.mainSeries().base();return Math.round(e*t)/t}recalculate(){if(0!==this.points().length){var e=this.properties().targetPrice.value(),t=this.properties().stopPrice.value(),i=[this._points[0],this._points[1]],r=this.calculateActualEntry(this.points()[0],this.points()[1]);if(r){i.push(r);var s=this.findClosePoint(r,this.points()[1]);s&&i.push(s)}this._points=i,e!==this.properties().targetPrice.value()&&this.properties().targetPrice._listeners.fire(this.properties().targetPrice),t!==this.properties().stopPrice.value()&&this.properties().stopPrice._listeners.fire(this.properties().stopPrice)}}start(){super.start(),this.recalculate()}startMoving(e,t,i){e.logical.price=this._roundPrice(e.logical.price),super.startMoving(e,t,i)}move(e,t,i){
e.logical.price=this._roundPrice(e.logical.price),super.move(e,t,i),this.recalculate(),this._entryPriceAxisView.update()}_correctPoints(e){return!!this.isActualSymbol()&&n.prototype._correctPoints.call(this,[e[0],e[1]])}entryPrice(){return this.points()[0].price}findClosePoint(e,t){for(var i=this._model.mainSeries().bars(),r=s(i.firstIndex()),n=Math.max(e.index,r),o=s(i.lastIndex()),a=Math.min(o,t.index),l=n;l<=a;l++){var c=i.valueAt(l);if(null!==c){var u=this.checkStopPrice(c);if(null!=u)return{index:l,price:u}}}return null}calculateActualEntry(e,t){var i=this._model.mainSeries().bars();if(i.isEmpty())return null;for(var r=s(i.firstIndex()),n=Math.max(e.index,r),o=e.price,a=s(i.lastIndex()),l=Math.min(a,t.index),c=n;c<=l;c++){var u=i.valueAt(c);if(null!==u&&u[TradingView.HIGH_PLOT]>=o&&u[TradingView.LOW_PLOT]<=o)return{index:c,price:o}}return null}axisPoints(){if(!this._points[u.ActualEntry])return[];var e=this._points[u.ActualEntry],t=null;if(4===this._points.length)t=this._points[u.ActualClose];else{var i=this.lastBarData();if(!i)return[];t={index:i.index,price:i.closePrice}}return[e,t]}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,80040))).RiskRewardDefinitionsViewModel}template(){var e=this.properties(),t=n.prototype.template.call(this);return t.stopLevel=e.stopLevel.value(),t.profitLevel=e.profitLevel.value(),t}_applyTemplateImpl(e){delete e.targetPrice,delete e.stopPrice,delete e.entryPrice,super._applyTemplateImpl(e);var t=this.properties();void 0!==e.stopLevel&&t.stopLevel.setValue(e.stopLevel),void 0!==e.profitLevel&&t.profitLevel.setValue(e.profitLevel)}getOrderTemplate(){var e=this.properties();return{qty:e.qty.value()/e.lotSize.value(),limitPrice:e.entryPrice.value(),stopLoss:e.stopPrice.value(),takeProfit:e.targetPrice.value(),side:this._orderSide(),type:y.LIMIT,seenPrice:null}}_propertiesStateExclusions(){return["entryPrice","stopPrice","targetPrice"]}static _configureProperties(e){n._configureProperties(e),e.addExclusion("stopLevel"),e.addExclusion("profitLevel"),e.addExclusion("stopPrice"),e.addExclusion("targetPrice"),e.addExclusion("entryPrice")}_getClosePointIndex(e){var t=this._model.timeScale(),i=Math.round(t.width()/t.barSpacing());return e+Math.max(3,Math.round(.15*i))}}b.version=2;class w extends b{constructor(e,t){super(e,t||w.createProperties());var i=this.properties();i.entryPrice.subscribe(this,this._recalculateQty),i.stopPrice.subscribe(this,this._recalculateQty),i.riskSize.subscribe(this,this._recalculateQty),i.entryPrice.subscribe(this,this._recalculateAmount),i.profitLevel.subscribe(this,this._recalculateAmount),i.stopLevel.subscribe(this,this._recalculateAmount),i.accountSize.subscribe(this,this._recalculateAmount),i.riskSize.subscribe(this,this._recalculateAmount),i.qty.subscribe(this,this._recalculateAmount)}_recalculateQty(){if(0!==this.points().length){
var e=this.properties(),t=e.entryPrice.value(),i=e.stopPrice.value(),r=e.riskSize.value(),s=this._model.mainSeries().pointValue(),n=r/(Math.abs(i-t)*s);e.qty.setValue(n)}}_recalculateAmount(){if(0!==this.points().length){var e=this.properties(),t=e.accountSize.value(),i=e.entryPrice.value(),r=e.qty.value(),s=e.stopPrice.value(),n=e.targetPrice.value(),o=this._model.mainSeries().pointValue(),a=this._roundValue(t+(i-n)*r*o),l=this._roundValue(t-(s-i)*r*o);e.amountTarget.setValue(a),e.amountStop.setValue(l)}}name(){return"Risk/Reward short"}stopPrice(){return this.entryPrice()+this.properties().stopLevel.value()/this._model.mainSeries().base()}profitPrice(){return this.entryPrice()-this.properties().profitLevel.value()/this._model.mainSeries().base()}calculatePL(e){return this.entryPrice()-e}preparseStopPrice(e){e=this._roundPrice(e);var t=this.entryPrice()+1/this._model.mainSeries().base();return Math.max(e,t)}preparseProfitPrice(e){e=this._roundPrice(e);var t=this.entryPrice()-1/this._model.mainSeries().base();return Math.min(e,t)}checkStopPrice(e){var t=this.stopPrice(),i=this.profitPrice();return e[TradingView.HIGH_PLOT]>=t?this.stopPrice():e[TradingView.LOW_PLOT]<=i?this.profitPrice():null}_orderSide(){return S.SELL}static createProperties(e){var t=new l("linetoolriskrewardshort",e);return w._configureProperties(t),t}static _configureProperties(e){b._configureProperties(e)}}class P extends b{constructor(e,t){super(e,t||P.createProperties());var i=this.properties();i.entryPrice.subscribe(this,this._recalculateQty),i.stopPrice.subscribe(this,this._recalculateQty),i.riskSize.subscribe(this,this._recalculateQty),i.entryPrice.subscribe(this,this._recalculateAmount),i.profitLevel.subscribe(this,this._recalculateAmount),i.stopLevel.subscribe(this,this._recalculateAmount),i.accountSize.subscribe(this,this._recalculateAmount),i.riskSize.subscribe(this,this._recalculateAmount),i.qty.subscribe(this,this._recalculateAmount)}_recalculateQty(){if(0!==this.points().length){var e=this.properties(),t=e.entryPrice.value(),i=e.stopPrice.value(),r=e.riskSize.value(),s=this._model.mainSeries().pointValue(),n=r/(Math.abs(t-i)*s);e.qty.setValue(n)}}_recalculateAmount(){if(0!==this.points().length){var e=this.properties(),t=e.accountSize.value(),i=e.entryPrice.value(),r=e.qty.value(),s=e.stopPrice.value(),n=e.targetPrice.value(),o=this._model.mainSeries().pointValue(),a=this._roundValue(t+(n-i)*r*o),l=this._roundValue(t-(i-s)*r*o);e.amountTarget.setValue(a),e.amountStop.setValue(l)}}stopPrice(){return this.entryPrice()-this.properties().stopLevel.value()/this._model.mainSeries().base()}profitPrice(){return this.entryPrice()+this.properties().profitLevel.value()/this._model.mainSeries().base()}calculatePL(e){return e-this.entryPrice()}preparseStopPrice(e){e=this._roundPrice(e);var t=this.entryPrice()-1/this._model.mainSeries().base();return Math.min(e,t)}preparseProfitPrice(e){e=this._roundPrice(e);var t=this.entryPrice()+1/this._model.mainSeries().base();return Math.max(e,t)}checkStopPrice(e){var t=this.stopPrice(),i=this.profitPrice()
;return e[TradingView.LOW_PLOT]<=t?this.stopPrice():e[TradingView.HIGH_PLOT]>=i?this.profitPrice():null}name(){return"Risk/Reward long"}_orderSide(){return S.BUY}static createProperties(e){var t=new l("linetoolriskrewardlong",e);return P._configureProperties(t),t}static _configureProperties(e){b._configureProperties(e)}}t.LineToolRiskRewardLong=P,t.LineToolRiskRewardShort=w},95197:(e,t,i)=>{"use strict";var r=i(72927).Point,s=i(89684).distanceToLine,n=i(73371).LineDataSource,o=i(1771).DefaultProperty,a=i(22756).LineToolColorsProperty;class l extends n{constructor(e,t){super(e,t||l.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,77301,19)).then(({RotatedRectanglePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}startChanging(e,t){if(super.startChanging(e,t),0===e||1===e){var i=this._getPaneViews()[0],r=i._points[0],n=i._points[1],o=i._points[2];this._distance=s(r,n,o).distance}}setPoint(e,t,i){if(super.setPoint(e,t,i),0===e||1===e){var s=this._getPaneViews()[0];s.update();var n=s._points[0],o=s._points[1].subtract(n),a=new r(o.y,-o.x).normalized().scaled(this._distance),l=n.add(a),c=this.screenPointToPoint(l);this._points[2]=c}}endChanging(e,t){delete this._distance,super.endChanging(e,t)}pointsCount(){return 3}name(){return"Rotated Rectangle"}hasEditableCoordinates(){return!1}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,96088))).GeneralFiguresDefinitionsViewModel}_snapTo45DegreesAvailable(){return!0}static createProperties(e){var t=new o("linetoolrotatedrectangle",e);return l._configureProperties(t),t}static _configureProperties(e){n._configureProperties(e),e.addChild("linesColors",new a([e.color]))}}t.LineToolRotatedRectangle=l},8404:(e,t,i)=>{"use strict";var r=i(92372),s=i(45155).LineToolPitchfork;class n extends s{constructor(e,t){super(e,t||n.createProperties())}name(){return"Modified Schiff Pitchfork"}static createProperties(e){var t=new r("linetoolschiffpitchfork",e,!1,{range:[0,8]});return n._configureProperties(t),t}static _configureProperties(e){s._configureProperties(e)}}t.LineToolSchiffPitchfork=n},33356:(e,t,i)=>{"use strict";var r=i(92372),s=i(45155).LineToolPitchfork;class n extends s{constructor(e,t){super(e,t||n.createProperties())}name(){return"Schiff Pitchfork"}static createProperties(e){var t=new r("linetoolschiffpitchfork2",e,!1,{range:[0,8]});return n._configureProperties(t),t}static _configureProperties(e){s._configureProperties(e)}}t.LineToolSchiffPitchfork2=n},70642:(e,t,i)=>{"use strict";i.d(t,{LineToolSignpost:()=>f});var r=i(1771),s=i(73371),n=i(27937),o=i.n(n),a=i(551),l=i(96276),c=i.n(l);class u{constructor(e){this._image=null,this._currentImageURL=null,this._imageReady=!1,this._ready=new(c()),this._source=e,this.updateImage()}updateImage(){const e=this.imageURL();this._currentImageURL!==e&&(this._currentImageURL=e,this._image=null,this._imageReady=!1,null!==this._currentImageURL&&(this._image=new Image,this._image.onload=()=>{
this._imageReady=!0,this._ready.fire()},this._image.crossOrigin="anonymous",this._image.src=this._currentImageURL))}itemIndex(){return 1}labelIndex(){return 0}image(){return this._imageReady&&this.showPlate()?this._image:null}showPlate(){return this._props().childs().showImage.value()}backgroundPlateColor(e){return this._props().childs().plateColor.value()}ready(){return this._ready}type(){return this._props().childs().itemType.value()}category(){return 1}index(){const e=this._source.points();return 0===e.length?null:e[0].index}imageURL(){const e=this._props().childs().emoji.value();return(0,a.getTwemojiUrl)(e,"png")||null}sourceImage(){return null}additionalImageURL(){return null}additionalImageSource(){return null}name(){return""}headline(){return this._props().childs().text.value()}text(){return""}fullTextAst(){return null}position(){return this._props().childs().position.value()}fontSize(){return this._props().childs().fontSize.value()}fontBold(){return this._props().childs().bold.value()}fontItalic(){return this._props().childs().italic.value()}sourceLabel(){return null}_props(){return this._source.properties()}}class d extends(o()){constructor(e){super(),this._source=e,e.pointAdded().subscribe(this,()=>this.listeners().fire(this)),e.pointChanged().subscribe(this,()=>this.listeners().fire(this))}value(){const e=this._source.properties().childs().position.value();return parseFloat(e.toFixed(2))}setValue(e){this._source.properties().childs().position.setValue(e),this._source.model().updateSource(this._source),this.listeners().fire(this),this._source.syncMultichartState({pricesChanged:!1,indexesChanged:!1})}}var h=i(48467);class p extends h.LineDataSourcePointIndexProperty{constructor(e,t){super(e,t),this._source=e}_setPointImpl(e){this._source.setPointAndChangeIndex(this._pointIndex,e)}}var _=i(22756),m=i(34842);class f extends m.LineToolWithRelativePriceCoordinate{constructor(e,t){const r=t||f.createProperties();super(e,r),this._item=new u(this),this.properties().childs().emoji.subscribe(this,()=>this._item.updateImage()),this._item.ready().subscribe(this,()=>this._model.updateSource(this)),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,43352)).then(t=>{this._setPaneViews([new t.SignpostPaneView(this,e)])})}isItemHovered(e){return!1}isItemSelected(e){return!1}isHidden(e){return!1}items(){return[this.customEvent()]}priceSource(){return this.ownerSource()}pointsCount(){return 1}name(){return"Signpost"}customEvent(){return this._item}showInObjectTree(){return!this.isPhantom()&&super.showInObjectTree()}isPhantom(){return this._model.isPhantomLine(this)}clonePositionOffset(){return{barOffset:1,xCoordOffset:0,yCoordOffset:0}}template(){const e=super.template(),t=this.properties().childs();return e.text=t.text.value(),e.position=t.position.value(),e}static createProperties(e){const t=new r.DefaultProperty("linetoolsignpost",e);return f._configureProperties(t),t.hasChild("text")||t.addChild("text",new(o())(window.t("Text"))),t.hasChild("position")||t.addChild("position",new(o())(50)),
t.addExclusion("text"),t.addExclusion("position"),t.addChild("backgroundsColors",new _.LineToolColorsProperty([t.childs().plateColor])),t}_createPointProperty(e){super._createPointProperty(e);const t=this._pointsProperty.childs().points[e];t.removeProperty("price"),t.removeProperty("bar"),t.addChild("price",new d(this)),t.addChild("bar",new p(this,0))}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text),this.properties().childs().position.setValue(e.position)}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,2482)).then(e=>e.SignpostDefinitionsViewModel)}static _configureProperties(e){s.LineDataSource._configureProperties(e)}}f.supportPhantomMode=!0},52050:(e,t,i)=>{"use strict";i.d(t,{LineToolSineLine:()=>n});var r=i(1771),s=i(73371);class n extends s.LineDataSource{constructor(e,t){super(e,t||n.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,19115)).then(e=>{this._setPaneViews([new e.SineLinePaneView(this,this._model)])})}pointsCount(){return 2}name(){return"Sine Line"}static createProperties(e){const t=new r.DefaultProperty("linetoolsineline",e);return n._configureProperties(t),t}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,79560))).CyclicAndSineLinesPatternDefinitionsViewModel}static _configureProperties(e){s.LineDataSource._configureProperties(e)}}},31115:(e,t,i)=>{"use strict";i.d(t,{StudyLineDataSource:()=>x});var r=i(16282),s=i(31565),n=i(40989),o=i(73371),a=i(1771),l=i(84234),c=i.n(l),u=i(67642),d=i(76625),h=i(93669),p=i(3707),_=i(98815),m=i(56288),f=i(72543),g=i(32579);const v=h.colorsPalette["color-cold-gray-500"];class S extends d.LineSourcePaneView{constructor(){super(...arguments),this._lineRenderer1=new f.VerticalLineRenderer,this._lineRenderer2=new f.VerticalLineRenderer,this._medianRenderer=new g.TrendLineRenderer,this._renderer=null}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer}_updateImpl(){super._updateImpl(),this._renderer=null;const e=this._getPoints();if(e.length<1)return;this._renderer=new m.CompositeRenderer;const[t,i]=e;this._lineRenderer1.setData({x:t.x,color:v,linewidth:1,linestyle:p.LINESTYLE_SOLID}),this._renderer.append(this._lineRenderer1),e.length>1&&(this._lineRenderer2.setData({x:i.x,color:v,linewidth:1,linestyle:p.LINESTYLE_SOLID}),this._medianRenderer.setData({points:[t,i],color:v,linewidth:1,linestyle:p.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:_.LineEnd.Normal,rightend:_.LineEnd.Normal}),this._renderer.append(this._lineRenderer2),this._renderer.append(this._medianRenderer))}}var y=i(58241),b=i(31570),w=i(45433),P=i(14127),C=i(4033),T=i(81994);class x extends o.LineDataSource{constructor(e,t,i,r){super(e,r),this._indexes=null,this._inputs=null,this._pointsetPoints=null,this._loadedPlots=null,this._loadedGraphics=null,this._definitionsViewModel=null,
this._alignerCache=null,this._beingCreatedPaneView=new S(this,e),this._anchorsPaneView=new I(this,this.model()),this._metaInfo=t,this._dataSource=new b.StudyDataSource(e.chartApi(),e.mainSeries().seriesSource(),i,t),this._dataSource.dataCleared().subscribe(this,this._onDataCleared),this._dataSource.dataUpdated().subscribe(this,this._onDataUpdated)}destroy(){this._dataSource.dataUpdated().unsubscribe(this,this._onDataUpdated),this._dataSource.dataCleared().unsubscribe(this,this._onDataCleared),this._dataSource.destroy(),null!==this._definitionsViewModel&&(this._definitionsViewModel.destroy(),this._definitionsViewModel=null),this._unsubscribeApplyInputsOnSeriesCompleted(),this._isDestroyed=!0,super.destroy()}stop(){super.stop(),this._isDestroyed||(this._dataSource.stop(),this.clearData())}start(){super.start(),this._isDestroyed||null===this._inputs||this._dataSource.start()}metaInfo(){return this._metaInfo}graphicsInfo(){return this._metaInfo.graphics}series(){return this._model.mainSeries()}translatedType(){return this._metaInfo.description}name(){return this._metaInfo.description}studyId(){return this._metaInfo.id}setPoint(e,t,i){super.setPoint(e,this._preparePoint(t,i))}move(e){}clearData(){this._clearAllDataExceptPointsetPoints(),this._pointsetPoints=null,this.updateAllViews()}data(){return this.plots()}plots(){return this._loadedPlots||this._dataSource.plots()}graphics(){return this._loadedGraphics||this._dataSource.graphics()}firstValue(){return this._model.mainSeries().firstValue()}state(e){const t=super.state(e);let i;this.metaInfo()instanceof c()?i=this.metaInfo().state():(i=(0,s.clone)(this.metaInfo()),i.id=c().parseIdString(i.id+(i.version?"-"+i.version:"")).fullId);const r={...t,metaInfo:i};return e&&(r.data=this.plots().state(),r.nonseriesindexes=this._indexes,r.graphics=(0,u.saveStudyGraphics)(this.graphics())),r}restoreData(e){void 0!==e.data&&(this._loadedPlots=new n.PlotList((0,w.studyPlotFunctionMap)(this._metaInfo),w.studyEmptyPlotValuePredicate),this._loadedPlots.restoreState(e.data)),this._indexes=e.nonseriesindexes?e.nonseriesindexes:null,this._loadedGraphics=e.graphics?(0,u.loadStudyGraphics)(e.graphics):null}getPropertyDefinitionsViewModel(){return null===this._definitionsViewModel?this._getPropertyDefinitionsViewModelClass().then(e=>null===e||this._isDestroyed?null:(null===this._definitionsViewModel&&(this._definitionsViewModel=new e(this._model.undoModel(),this)),this._definitionsViewModel)):Promise.resolve(this._definitionsViewModel)}paneViews(e){let t=[];if(this.isSourceHidden())return t;if(this._isReady()&&this._changeStatesStack.isEmpty()){const i=super.paneViews(e);null!==i&&(t=t.concat(i))}else t.push(this._beingCreatedPaneView);return t.push(this._anchorsPaneView),t}propertiesChanged(e){super.propertiesChanged(e),this._onStudyInputsMayChange()}dataAndViewsReady(){return super.dataAndViewsReady()&&this._isReady()}endChanging(e,t){const i=super.endChanging(e,t);return i.indexesChanged?this.clearData():this._updateAnchorsPrice(),i}moveData(e){this._dataSource.moveData(e)}
static createPropertiesFromStudyMetaInfoAndState(e,t,i,r){const s=(0,P.prepareStudyPropertiesForLoadChart)(e,t,i,null,r);return x._configureProperties(s),s}_studyId(){return this._dataSource.studyId()}_isReady(){return!0}_updateAllPaneViews(){super._updateAllPaneViews(),this._beingCreatedPaneView.update(),this._anchorsPaneView.update()}_getPointTime(e,t){const i=e.index,r=this._model.timeScale().indexToTimePoint(i);if(null!==r)return r;if(t||void 0===e.time)return null;const s=this._model.mainSeries().symbolInfo();if(null===s)return null;let n=this._model.properties().timezone.value();"exchange"===n&&(n=s.timezone);const o=(0,C.cal_to_utc)((0,C.get_timezone)(n),e.time);return this._getStartBarAligner()(o)/1e3}_updateAnchorsPrice(){}_onPointsetUpdated(e){super._onPointsetUpdated(e),this._pointsetPoints=this._points.map(e=>({price:e.price,index:e.index,time:e.time})),this._onStudyInputsMayChange()}_onDataCleared(){this.updateAllViews(),this._model.updateSource(this)}_onDataUpdated(e,t,i){this._updateAnchorsPrice(),this.updateAllViews(),this._model.updateSource(this)}_onStudyInputsMayChange(){let e=null;null!==this._pointsetPoints&&this._pointsetPoints.length===this.pointsCount()&&(e=this._studyInputs(this._pointsetPoints),null===e&&(this._clearAllDataExceptPointsetPoints(),this.updateAllViews())),this._areInputsEqual(this._inputs,e)||this._applyStudyInputs(e)}_onMainSeriesSymbolResolved(){super._onMainSeriesSymbolResolved(),this._alignerCache=null}_preparePoint(e,t){return super._preparePoint(this._alignPointToRangeOfActualData(e),t)}_getPropertyDefinitionsViewModelClass(){return Promise.resolve(null)}_subscribeApplyInputsOnSeriesCompleted(){this._unsubscribeApplyInputsOnSeriesCompleted(),this._model.mainSeries().dataEvents().completed().subscribe(this,()=>this._onStudyInputsMayChange(),!0)}_unsubscribeApplyInputsOnSeriesCompleted(){this._model.mainSeries().dataEvents().completed().unsubscribeAll(this)}_onInputsChanged(){this.hasAlert.value()&&(this._localAndServerAlertsMismatch=!0)}static _createPropertiesFromStudyIdAndState(e,t){const i=c().getStudyPropertyRootNameById(e),r=new a.DefaultProperty(i,t);return x._configureProperties(r),r}static _createPropertiesFromStudyMetaInfo(e,t){const i=(0,P.prepareStudyProperties)(e,null,null,t);return x._configureProperties(i),i}static _configureProperties(e){o.LineDataSource._configureProperties(e)}_areInputsEqual(e,t){return null===t?null===e:null!==e&&(0,y.areStudyInputsEqual)(this._metaInfo.inputs,e,t)}_applyStudyInputs(e){const t=this._inputs;this._inputs=e,null!==e&&(this._unsubscribeApplyInputsOnSeriesCompleted(),this._dataSource.setInputs(e),null===t&&this.isStarted()&&!this._dataSource.isStarted()&&this._dataSource.start()),this._onInputsChanged()}_clearAllDataExceptPointsetPoints(){this._inputs=null,this._dataSource.clearData(),this._loadedPlots=null,this._indexes=null,this._loadedGraphics=null}_getStartBarAligner(){const e=this._model.mainSeries().interval()
;return null!==this._alignerCache&&this._alignerCache.resolution===this._model.mainSeries().interval()||(this._alignerCache={resolution:e,aligner:(0,T.createTimeToBarTimeAligner)(e,(0,r.ensureNotNull)(this._model.mainSeries().symbolInfo()))}),this._alignerCache.aligner}}class I extends d.LineSourcePaneView{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e=new m.CompositeRenderer;return e.append(this.createLineAnchor({points:this._getPoints()},0)),e}}},1479:(e,t,i)=>{"use strict";i.d(t,{LineToolText:()=>u,LineToolTextAbsolute:()=>d});var r=i(16282),s=i(72927),n=i(73371),o=i(27937),a=i.n(o),l=i(1771),c=i(22756);class u extends n.LineDataSource{constructor(e,t){const r=t||u.createProperties();super(e,r),this._barSpacing=e.timeScale().barSpacing(),this._recalculatePointsOnCenter=!1,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,22904)).then(({TextPaneView:t})=>{const i=this._recalculatePointsOnCenter?(e,t)=>{this._recalculatePointsOnCenter&&this._recalculateCenterPosition(e,t)}:void 0;this._setPaneViews([new t(this,e,void 0,void 0,void 0,void 0,void 0,i)])})}centerPosition(){this._recalculatePointsOnCenter=!0}setPoint(e,t,i){const r=this.properties().childs();let s;if(1===e&&r.wordWrapWidth.value()){const e=this.model().timeScale();s=this.isFixed()?this.fixedPoints()[0].x:e.indexToCoordinate(this.points()[0].index);const i=e.indexToCoordinate(t.index)-s-~~(r.fontsize.value()/6);if(!isFinite(i))return;r.wordWrapWidth.setValue(Math.max(100,i))}}pointsCount(){return 1}name(){return"Text"}setPriceScale(e){super.setPriceScale(e),e&&e.priceRange()&&(this._priceDencity=e.height()/(0,r.ensureNotNull)(e.priceRange()).length(),this._isPriceDencityLog=e.isLog())}restoreSize(){const e=(0,r.ensureNotNull)(this.priceScale());this._barSpacing=this.model().timeScale().barSpacing(),this._priceDencity=e.height()/(0,r.ensureNotNull)(e.priceRange()).length(),this.redraw()}redraw(){this.updateAllViews(),this._model.updateSource(this)}template(){const e=super.template();return e.text=this.properties().childs().text.value(),e}state(e){const t=super.state(e);return e&&(t.state.fixedSize=!1),t}barSpacing(){return this._barSpacing}priceDencity(){return this._priceDencity}isPriceDencityLog(){return this._isPriceDencityLog}hasEditableCoordinates(){return!1}static createProperties(e){const t=new l.DefaultProperty("linetooltext",e);return u._configureProperties(t),t}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text)}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,55510)).then(e=>e.TextDefinitionsViewModel)}static _configureProperties(e){n.LineDataSource._configureProperties(e),e.hasChild("text")||e.addChild("text",new(a())(window.t("Text"))),e.addChild("linesColors",new c.LineToolColorsProperty([e.childs().borderColor])),e.addChild("textsColors",new c.LineToolColorsProperty([e.childs().color])),e.addExclusion("text"),e.addExclusion("linesColors"),
e.addExclusion("textsColors")}_recalculateCenterPosition(e,t){const i=(this.isFixed()?this.fixedPoints():this.pointToScreenPoint(this._points[0]))[0],r=new s.Point(i.x-e/2,i.y-t/2),n=this.screenPointToPoint(r);this.setPoints([n]),this.normalizePoints(),this.createServerPoints(),this.redraw()}}class d extends u{constructor(e,t){super(e,t||d.createProperties())}name(){return"Anchored Text"}hasEditableCoordinates(){return!1}isFixed(){return!0}static createProperties(e){const t=new l.DefaultProperty("linetooltextabsolute",e);return d._configureProperties(t),t}static _configureProperties(e){u._configureProperties(e)}}},64978:(e,t,i)=>{"use strict";i.d(t,{LineToolThreeDrivers:()=>o});var r=i(1771),s=i(73371),n=i(22756);class o extends s.LineDataSource{constructor(e,t){const r=t||o.createProperties();super(e,r),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,14793)).then(t=>{this._setPaneViews([new t.LineToolThreeDrivesPaneView(this,e)])})}pointsCount(){return 7}name(){return"Three Drives Pattern"}static createProperties(e){const t=new r.DefaultProperty("linetoolthreedrivers",e);return o._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,32172)).then(e=>e.PatternWithoutBackgroundDefinitionsViewModel)}static _configureProperties(e){s.LineDataSource._configureProperties(e),e.addChild("linesColors",new n.LineToolColorsProperty([e.childs().color])),e.addChild("textsColors",new n.LineToolColorsProperty([e.childs().textcolor])),e.addChild("linesWidths",new n.LineToolWidthsProperty([e.childs().linewidth])),e.hasChild("backgroundsColors")&&e.removeProperty("backgroundsColors")}}},68911:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(1771).DefaultProperty;class n extends r{constructor(e,t){super(e,t||n.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,90278,19)).then(({TimeCyclesPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}pointsCount(){return 2}name(){return"Time Cycles"}setPoint(e,t,i){var r=Object.assign({},t),s=this._points[0],n=this._points[1];s.price=r.price,n.price=r.price,this._points[e]=r,this.normalizePoints()}addPoint(e,t,i){var s=r.prototype.addPoint.call(this,e,t,!0);if(s){var n=this._points[0];this._points[1].price=n.price,i||(this.normalizePoints(),this.createServerPoints())}return s}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,13042))).TimeCyclesPatternDefinitionsViewModel}static createProperties(e){var t=new s("linetooltimecycles",e);return n._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e)}}t.LineToolTimeCycles=n},75363:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(75496).fixComputationError;class n extends r{constructor(e,t){super(e,t),this.customization.forcePriceAxisLabel=!0,this.customization.disableErasing=!0,this.customization.showInObjectsTree=!1,
this.setSelectionEnabled(!1)}isSynchronizable(){return!1}pointsCount(){return n.POINTS_COUNT}hasContextMenu(){return!1}state(){return null}startMoving(){r.prototype.startMoving.apply(this,arguments),this._cursorMoved=!1}endMoving(){r.prototype.endMoving.apply(this,arguments),this._cursorMoved=!1}_correctPoints(e){this._currentMovingPoint&&this._startMovingPoint?this._currentMovingPoint.logical.price-this._startMovingPoint.logical.price&&(this._cursorMoved=!0):this._cursorMoved=!1;for(var t=1/this.priceScale().mainSource().base(),i=0;i<e.length;i++){var r=e[i];this._cursorMoved&&(r.price=this._currentMovingPoint.logical.price),r.price=s(t*Math.round(r.price/t)),e[i]=r}}userEditEnabled(){return!0}movable(){return!1}canBeHidden(){return!1}isUserDeletable(){return!1}showInObjectTree(){return!1}doesMovingAffectsUndo(){return!1}isAvailableInFloatingWidget(){return!1}timeAxisViews(){return null}cloneable(){return!1}copiable(){return!1}static _configureProperties(e){r._configureProperties(e)}}n.POINTS_COUNT=1,e.exports.LineToolTrading=n},21540:(e,t,i)=>{"use strict";var r=i(27937),s=i(72927).Point,n=i(73371).LineDataSource,o=i(1771).DefaultProperty;class a extends r{constructor(e){super(),this._lineSource=e}value(){var e=180*this._lineSource._angle/Math.PI;return Math.round(e)}setValue(e){var t=e*Math.PI/180;this._lineSource._angle=t;var i=this._lineSource.pointToScreenPoint(this._lineSource.points()[0])[0],r=Math.cos(this._lineSource._angle),n=-Math.sin(this._lineSource._angle),o=new s(r,n),a=i.addScaled(o,this._lineSource._distance),l=this._lineSource.screenPointToPoint(a);this._lineSource._points[1]=l,this._lineSource._model.updateSource(this._lineSource),this._lineSource.updateAllViews(),this._lineSource._model.updateSource(this._lineSource)}}class l extends n{constructor(e,t){super(e,t||l.createProperties()),this._properties.addChild("angle",new a(this)),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,59766,19)).then(({TrendAnglePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}isSynchronizable(){return!1}pointsCount(){return 2}name(){return"Trend Angle"}_calculateAngle(){var e=this.pointToScreenPoint(this.points()[0])[0],t=this.pointToScreenPoint(this.points()[1])[0],i=t.subtract(e);i.length()>0?(i=i.normalized(),this._angle=Math.acos(i.x),i.y>0&&(this._angle=-this._angle),this._distance=t.subtract(e).length()):delete this._angle,this.properties().hasOwnProperty("angle")&&this.properties().angle.listeners().fire(this.properties().angle)}addPoint(e,t){var i=n.prototype.addPoint.call(this,e,t);return i&&this._calculateAngle(),i}setLastPoint(e,t){super.setLastPoint(e,t),this.points().length>1&&this._calculateAngle()}axisPoints(){if(this.points().length<2)return[];var e=[this.points()[0]],t=this.pointToScreenPoint(this.points()[0])[1],i=Math.cos(this._angle)*this._distance,r=-Math.sin(this._angle)*this._distance,n=t.add(new s(i,r)),o=this.screenPointToPoint(n);return e.push(o),e}setPoint(e,t,i){super.setPoint(e,t,i),this.points().length>1&&1===e&&this._calculateAngle()}restoreData(e){
this._angle=e.angle,this._distance=e.distance}state(e){var t=n.prototype.state.call(this,e);return t.angle=this._angle,t.distance=this._distance,t}cloneData(e){this._angle=e._angle,this._distance=e._distance}canHasAlert(){return!0}_getAlertPlots(){return[this._linePointsToAlertPlot(this._points,null,this.properties().extendLeft.value(),this.properties().extendRight.value())]}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,30153))).TrendAngleDefinitionsViewModel}_snapTo45DegreesAvailable(){return!0}static createProperties(e){var t=new o("linetooltrendangle",e);return l._configureProperties(t),t}static _configureProperties(e){n._configureProperties(e)}}t.LineToolTrendAngle=l},42161:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(92372),n=i(22756),o=n.LineToolWidthsProperty,a=n.LineToolColorsProperty;class l extends r{constructor(e,t){super(e,t||l.createProperties()),this.version=l.version,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,72943,19)).then(({TrendBasedFibExtensionPaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}levelsCount(){return l.LevelsCount}pointsCount(){return 3}name(){return"Trend-Based Fib Extension"}migrateVersion(e,t,i){1===e&&this.properties().extendLines.setValue(!0)}processErase(e,t){var i="level"+t,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}static createProperties(e){var t=new s("linetooltrendbasedfibextension",e,!1,{range:[0,8]});return l._configureProperties(t),t}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,27564))).FibDrawingsWith24LevelsDefinitionsViewModel}static _configureProperties(e){r._configureProperties(e);for(var t=[e.child("trendline").child("linewidth"),e.child("levelsStyle").child("linewidth")],i=[e.child("trendline").child("color")],s=1;s<=l.LevelsCount;s++)i.push(e.child("level"+s).child("color"));e.addChild("linesColors",new a(i)),e.addChild("linesWidths",new o(t))}fibLevelsBasedOnLogScale(){return this.properties().fibLevelsBasedOnLogScale.value()&&this.priceScale().isLog()}}l.version=2,l.LevelsCount=24,t.LineToolTrendBasedFibExtension=l},6068:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(92372),n=i(22756),o=n.LineToolWidthsProperty,a=n.LineToolColorsProperty;class l extends r{constructor(e,t){super(e,t||l.createProperties()),this.version=l.version,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,46038,19)).then(({TrendBasedFibTimePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}levelsCount(){return l.LevelsCount}pointsCount(){return 3}name(){return"Trend-Based Fib Time"}migrateVersion(e,t,i){}processErase(e,t){var i="level"+t,r=this.properties()[i].visible;e.setProperty(r,!1,"Erase level line")}async _getPropertyDefinitionsViewModelClass(){
return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,51210))).TrendBasedFibTimeDefinitionsViewModel}static createProperties(e){var t=new s("linetooltrendbasedfibtime",e,!1,{range:[1,11]});return l._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e);for(var t=[e.child("trendline").child("linewidth")],i=[e.child("trendline").child("color")],s=1;s<=l.LevelsCount;s++)t.push(e.child("level"+s).child("linewidth")),i.push(e.child("level"+s).child("color"));e.addChild("linesColors",new a(i)),e.addChild("linesWidths",new o(t))}}l.LevelsCount=11,l.version=1,t.LineToolTrendBasedFibTime=l},35200:(e,t,i)=>{"use strict";var r=i(27937),s=i(73371).LineDataSource,n=i(69722).LineToolPriceAxisView,o=i(1771).DefaultProperty;class a extends s{constructor(e,t){super(e,t||a.createProperties()),this._trendLinePaneView=null,Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,9357,19)).then(({TrendLinePaneView:e})=>{this._trendLinePaneView=new e(this,this._model),this._setPaneViews([this._trendLinePaneView])})}dataAndViewsReady(){return s.prototype.dataAndViewsReady.call(this)&&this._trendLinePaneView&&this._trendLinePaneView.iconsReady()}stop(){super.stop()}pointsCount(){return 2}name(){return"Trend Line"}canHasAlert(){return!0}showPriceLabels(){return this._properties.childs().showPriceLabels.value()}createPriceAxisView(e){return new n(this,{pointIndex:e,backgroundPropertyGetter:()=>this.showPriceLabels()?this._properties.linecolor.value():null})}isForcedDrawPriceAxisLabel(){return this.showPriceLabels()}_getAlertPlots(){return[this._linePointsToAlertPlot(this._points,null,this.properties().extendLeft.value(),this.properties().extendRight.value())]}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,54571))).TrendLineDefinitionsViewModel}template(){var e=s.prototype.template.call(this);return e.text=this.properties().childs().text.value(),e}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text||"")}_snapTo45DegreesAvailable(){return!0}static createProperties(e){var t=new o("linetooltrendline",e);return a._configureProperties(t),t}static _configureProperties(e){s._configureProperties(e),e.hasChild("text")||e.addChild("text",new r("")),e.addExclusion("text")}}t.LineToolTrendLine=a},44208:(e,t,i)=>{"use strict";i.d(t,{LineToolTrianglePattern:()=>o});var r=i(1771),s=i(73371),n=i(22756);class o extends s.LineDataSource{constructor(e,t){const r=t||o.createProperties();super(e,r),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,12803)).then(t=>{this._setPaneViews([new t.LineToolTrianglePatternPaneView(this,e)])})}pointsCount(){return 4}name(){return"Triangle Pattern"}static createProperties(e){const t=new r.DefaultProperty("linetooltrianglepattern",e);return o._configureProperties(t),t}_getPropertyDefinitionsViewModelClass(){
return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,12162)).then(e=>e.PatternWithBackgroundDefinitionViewModel)}static _configureProperties(e){s.LineDataSource._configureProperties(e),e.addChild("linesColors",new n.LineToolColorsProperty([e.childs().color])),e.addChild("textsColors",new n.LineToolColorsProperty([e.childs().textcolor])),e.addChild("backgroundsColors",new n.LineToolColorsProperty([e.childs().backgroundColor]))}}},99812:(e,t,i)=>{"use strict";var r=i(73371).LineDataSource,s=i(1771).DefaultProperty,n=i(22756).LineToolColorsProperty;class o extends r{constructor(e,t){super(e,t||o.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.t.bind(i,59591,19)).then(({TrianglePaneView:e})=>{this._setPaneViews([new e(this,this._model)])})}pointsCount(){return 3}name(){return"Triangle"}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,96088))).GeneralFiguresDefinitionsViewModel}static createProperties(e){var t=new s("linetooltriangle",e);return o._configureProperties(t),t}static _configureProperties(e){r._configureProperties(e),e.addChild("linesColors",new n([e.childs().color]))}}t.LineToolTriangle=o},51397:(e,t,i)=>{"use strict";i.d(t,{isTwitterUrl:()=>a,isTwitterProfileImageUrl:()=>l,createTweetLineToolByUrl:()=>c});var r=i(16282),s=i(75443),n=i(44197),o=i(44848);function a(e){try{const t=new URL(e);return("twitter.com"===t.hostname||t.hostname.endsWith(".twitter.com"))&&"https:"===t.protocol}catch(e){return!1}}function l(e){try{const t=new URL(e);return"pbs.twimg.com"===t.hostname&&"https:"===t.protocol&&t.pathname.startsWith("/profile_images/")}catch(e){return!1}}function c(e,t){return async function(e){const t=new URL("/api/v1/get-tweet-data/",location.href);return t.searchParams.append("tweet_url",e),fetch(t.toString()).then(e=>{if(!e.ok)throw new Error("Error processing tweet: "+e.statusText);return e.json()})}(e).then(i=>{const a=function(e,t){var i;return{id:e.id,createdAt:e.created_at,text:(0,n.clean)(e.text,!0),username:"@"+e.username,user:e.user,profileImageUrl:e.profile_image_url,hashtags:e.hashtags.join(" "),tweetUrl:null!==(i=e.tweet_url)&&void 0!==i?i:t}}(i,e),l={price:0,time_t:a.createdAt,offset:0},c=t.mainSeries(),u=(0,r.ensureNotNull)(t.model().paneForSource(c)),d=u.newLineToolZOrder(!0),h={type:"drawing",source:{id:(0,s.randomHashN)(6),zorder:d,type:"LineToolTweet",position:50,state:{interval:"1",...o.LineToolTweet.createProperties().state()},tweetData:a,symbol:c.symbol(),ownerSource:c.id(),points:[l]},geometry:[],modelId:t.model().id()};return t.pasteLineTool(u,h,!0,!0)})}},44848:(e,t,i)=>{"use strict";i.d(t,{LineToolTweet:()=>b});var r=i(1771),s=i(20220),n=i(29098),o=i(87380),a=i(35252),l=i(14397),c=i(57807),u=i(51397);const d=(0,o.getLogger)("Chart.TweetDialog"),h=(0,s.t)("Tweet"),p=(0,s.t)("Insert a link to the tweet");let _=null;function m(e){"LineToolTweet"===e?(window.is_authenticated||(0,l.resetToCursor)(!0),
window.runOrSignIn(()=>{l.tool.setValue("LineToolTweet"),_=(0,c.showCustomUrlEventDialog)({onConfirm:f,onClose:()=>{_=null,"LineToolTweet"===l.tool.value()&&(0,l.resetToCursor)(!0)},title:h,placeholderText:p}),(0,n.trackEvent)("Tweet","Open tweet dialog")},{source:"Change drawing tool state"})):null!==_&&_.then(e=>e())}function f(e){const t=(0,a.chartWidgetCollectionService)();if(null===t)return;if(!(0,u.isTwitterUrl)(e))return void d.logWarn("Invalid tweet url: "+e);const i=t.activeChartWidget.value();(0,u.createTweetLineToolByUrl)(e,i.model())}var g=i(27937),v=i.n(g),S=i(66116);class y extends S.CustomEventItem{constructor(e,t){super(t),this._data=e}tweetData(){return this._data}index(){return this._source.eventTimePointIndex()}time(){return this._data.createdAt}avatar(){return this._data.profileImageUrl}}class b extends S.LineToolCustomUrlEvent{constructor(e,t){super(e,t||b.createProperties()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,70312)).then(t=>{this._setPaneViews([new t.TweetPaneView(this,e)])})}name(){return"Tweet"}state(e){const t=super.state(e);return this._item&&(t.tweetData=this._item.tweetData()),e&&(t.eventTimePointIndex=this._eventTimePointIndex),t}restoreData(e){if(e.tweetData){if(!(0,u.isTwitterUrl)(e.tweetData.tweetUrl))throw new Error("Invalid url for tweet line tool: "+e.tweetData.tweetUrl);this._item=new y(e.tweetData,this)}void 0!==e.eventTimePointIndex&&(this._eventTimePointIndex=e.eventTimePointIndex)}static createProperties(e){const t=new r.DefaultProperty("linetoolTweet",e);return b._configureProperties(t),t.hasChild("position")||t.addChild("position",new(v())(50)),t.addExclusion("position"),t}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,38335)).then(e=>e.TweetDefinitionsViewModel)}}(0,l.runOnDrawingStateReady)(()=>{l.tool.subscribe(m)})},48697:(e,t,i)=>{"use strict";i.d(t,{LineToolVertLineTimeAxisView:()=>s});var r=i(45801);class s extends r.LineDataSourceTimeAxisView{constructor(e){super(e,0)}_getBgColor(){return this._source.properties().linecolor.value()}_getAlwaysInViewPort(){return!1}_getIndex(){const e=this._source.points();return 0===e.length?null:e[0].index}}},68265:(e,t,i)=>{"use strict";i.d(t,{LineToolVertLine:()=>u});var r=i(16282),s=i(72927),n=i(1771),o=i(27937),a=i.n(o),l=i(73371),c=i(48697);class u extends l.LineDataSource{constructor(e,t){const r=t||u.createProperties();super(e,r),this._timeAxisView=new c.LineToolVertLineTimeAxisView(this),this._paneViewFactory=null,this.properties().childs().extendLine.subscribe(this,()=>e.lightUpdate()),Promise.all([i.e(4033),i.e(18319),i.e(13935),i.e(51583)]).then(i.bind(i,98561)).then(t=>{this._paneViewFactory=i=>new t.VertLinePaneView(this,e,i),this._model.lightUpdate()})}destroy(){this.properties().childs().extendLine.unsubscribeAll(this),super.destroy()}pointsCount(){return 1}name(){return"Vertical Line"}timeAxisViews(){
return this.isSourceHidden()?null:this.properties().childs().showTime.value()?[this._timeAxisView]:null}updateAllViews(){super.updateAllViews(),this._timeAxisView.update()}canHasAlert(){return!0}template(){const e=super.template();return e.text=this.properties().childs().text.value(),e}isMultiPaneAvailable(){return!0}isMultiPaneEnabled(){return this.properties().childs().extendLine.value()}paneViews(e){return e=(0,r.ensureDefined)(e),this.isMultiPaneEnabled()||this._model.paneForSource(this)===e?(null===this._getPaneViews(e)&&null!==this._paneViewFactory&&this._setPaneViews([this._paneViewFactory(e)],e,!0),super.paneViews(e)):null}priceAxisViews(){return null}priceAxisPoints(){return[]}pointToScreenPoint(e){const t=this._model.timeScale();if(t.isEmpty())return[new s.Point(0,0),new s.Point(0,0)];const i=t.indexToCoordinate(e.index),r=new s.Point(i,0);return[r,r]}convertYCoordinateToPriceForMoving(e){return 0}static createProperties(e){null!=e&&(void 0===e.textOrientation&&(e.textOrientation="horizontal"),void 0===e.extendLine&&(e.extendLine=!1));const t=new n.DefaultProperty("linetoolvertline",e);return u._configureProperties(t),t}_getAlertPlots(){const e=this._points[0],t={index:e.index,price:e.price+1};return[this._linePointsToAlertPlot([e,t],null,!0,!0)]}_getPropertyDefinitionsViewModelClass(){return Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(18537)]).then(i.bind(i,14848)).then(e=>e.VerticalLineDefinitionsViewModel)}_applyTemplateImpl(e){super._applyTemplateImpl(e),this.properties().childs().text.setValue(e.text||"")}static _configureProperties(e){l.LineDataSource._configureProperties(e),e.hasChild("text")||e.addChild("text",new(a())("")),e.addExclusion("text")}}},95047:(e,t,i)=>{"use strict";i.d(t,{LineToolVbPFixed:()=>d});var r=i(45018),s=i(16282),n=i(84819),o=i(31115),a=i(67642),l=i(39426),c=i(31565);const u=(0,n.studyIdString)("VbPFixed","tv-volumebyprice");class d extends o.StudyLineDataSource{constructor(e,t,i,r){const s=i||e.studyMetaInfoRepository().findByIdSync({type:"java",studyId:u}),n=t||d._createPropertiesFromStudyMetaInfo(s,e.studyVersioning());super(e,s,"vbpfixed_",n),(0,a.createGraphicsPaneViews)(this,e).then(t=>{if(r=e.mainSeries(),s.plots.length>0){const i=new l.StudyPlotPaneView(this,r,e,s.plots[0].id);t.push(i)}if(s.plots.length>1){const i=new l.StudyPlotPaneView(this,r,e,s.plots[1].id);t.push(i)}if(s.plots.length>2){const i=new l.StudyPlotPaneView(this,r,e,s.plots[2].id);t.push(i)}this._setPaneViews(t)}),this.clearData()}pointsCount(){return 2}boundToSymbol(){return!1}offset(e){return 0}getMinFirstBarIndexForPlot(){return-1/0}calcIsActualSymbol(){this._isActualSymbol=!0,this._isActualCurrency=!0,this._isActualUnit=!0,this.calcIsActualInterval()}cloneable(){return!1}isSynchronizable(){return!1}static createProperties(e){const t=super._createPropertiesFromStudyIdAndState(u,e);return d._configureProperties(t),t}static studyId(){return u}_studyInputs(e){(0,s.assert)(2===e.length,"all the line tool points should be defined")
;const[t,i]=e,r=Math.max(t.index,i.index),n=this._model.mainSeries().bars().lastIndex(),o=this._getPointTime(t.index<=i.index?t:i,!0),a=this._getPointTime(i.index>=t.index?i:t,!0);if(null===o||null===a)return this._subscribeApplyInputsOnSeriesCompleted(),null;const l=this.properties().childs();return{rowsLayout:l.inputs.childs().rowsLayout.value(),rows:l.inputs.childs().rows.value(),volume:l.inputs.childs().volume.value(),vaVolume:l.inputs.childs().vaVolume.value(),first_bar_time:1e3*o,last_bar_time:1e3*a,subscribeRealtime:n===r}}_isReady(){return!(0,a.isStudyGraphicsEmpty)(this.graphics())}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(60607)]).then(i.bind(i,75291))).StudyLineDataSourceDefinitionsViewModel}_onDataUpdated(){this._updateAnchors(),this.updateAllViews(),this._model.updateSource(this)}_updateAnchors(){const e=this._calculateAnchors();if(!e)return;const[{index:t,price:i},{index:r,price:s}]=e;if(this._timePoint.length&&(this._timePoint[0].price=i,this._timePoint[1].price=s),this._points.length){const e=this.model().timeScale(),n=e.indexToTimePoint(t),o=e.indexToTimePoint(t);this._points[0]={index:t,price:i,time:(0,c.isNumber)(n)?new Date(1e3*n):void 0},this._points[1]={index:r,price:s,time:(0,c.isNumber)(o)?new Date(1e3*o):void 0}}}_calculateAnchors(){let e=null,t=null,i=null,s=null;if(this.graphics().hhists().forEach(r=>{r.forEach(r=>{const{priceLow:n,priceHigh:o,firstBarTime:a,lastBarTime:l}=r;(!e||n<e)&&(e=n),(!t||o>t)&&(t=o),(!i||a<i)&&(i=a),(!s||l>s)&&(s=l)})}),!((0,r.default)(e)||(0,r.default)(t)||(0,r.default)(s)||(0,r.default)(i)))return[{price:t,index:i},{price:e,index:s}]}_updateAnchorsPrice(){const e=this._calculateAnchors();if(!e)return;const[{price:t},{price:i}]=e;this._timePoint.length&&(this._timePoint[0].price=t,this._timePoint[1].price=i),this._points.length&&(this._points[0].price=t,this._points[1].price=i)}}},51136:(e,t,i)=>{"use strict";i.d(t,{LogicalRange:()=>s});var r=i(16282);class s{constructor(e,t){(0,r.assert)(e<=t,"The left value should be greater than or equal to the right value"),this._left=e,this._right=t}left(){return this._left}right(){return this._right}length(){return this._right-this._left+1}contains(e){return this._left<=e&&e<=this._right}equals(e){return this._left===e.left()&&this._right===e.right()}static compare(e,t){return null===e||null===t?e===t:e.equals(t)}}},84667:(e,t,i)=>{"use strict";i.d(t,{LollipopPaneView:()=>h});var r=i(16282),s=i(72927),n=i(31565),o=i(56288),a=i(54567),l=i(14900),c=i(72543),u=i(4456),d=i(62288);class h{constructor(e,t,i){this._invalidated=!1,this._renderer=new o.CompositeRenderer,this._textWidthCache=new a.TextWidthCache,this._stylesCache=null,this._lollipops={},this._lollipopsCounter=0,this._lastClickedId=null,this.onPaneBgChange=()=>{this._recreateStyles(this._model)},this._lastClickedId=null,this._model=e,this._source=t,this._hitTestHandler=i,this._recreateStyles(e),e.backgroundColor().subscribe(this.onPaneBgChange),
e.mainSeries().onSymbolIntervalChanged().subscribe(this,this._onSymbolOrIntervalChanged)}destroy(){this._model.backgroundColor().unsubscribe(this.onPaneBgChange),this._model.mainSeries().onSymbolIntervalChanged().unsubscribeAll(this)}onClickOutside(e){var t;if(null===this._lastClickedId||!e)return void this.clearLastClicked();let i=null;if(function(e){return void 0!==e.touches}(e)){if(1!==e.touches.length)return;{const t=(0,r.ensureNotNull)(e.target).getBoundingClientRect(),n=e.touches[0];i=new s.Point(n.clientX-t.left,n.clientY-t.top)}}else i=new s.Point(e.offsetX,e.offsetY);const n=this._renderer.hitTest(i,{physicalHeight:0,physicalWidth:0,pixelRatio:1,cssHeight:0,cssWidth:0});null!==n&&(null===(t=n.data())||void 0===t?void 0:t.activeItem)===(0,r.ensureDefined)(this._lollipops[this._lastClickedId]).itemIndex||this.clearLastClicked()}clearLastClicked(){const e=null!==this._lastClickedId&&this._lollipops[this._lastClickedId]||null;null!==e&&(e.active=!1),this._lastClickedId=null}getLastClickedLollipopId(){return this._lastClickedId}update(){this._invalidated=!0}afterUpdate(e,t,i,r){}showBarLine(){return!0}getStyle(e){const t=e.active?"active":e.hovered?"hovered":"default";let i=t;if(e.stack&&(i+="_stack:"+e.stack),"active"===i)return this.activeStyle;if("hovered"===i)return this.hoveredStyle;if("default"===i)return this.defaultStyle;if(this._stylesCache||(this._stylesCache={}),!this._stylesCache[i]){const r=(0,n.clone)("active"===t?this.activeStyle:"hovered"===t?this.hoveredStyle:this.defaultStyle);e.stack&&(r.lollipop.incHeight=25*e.stack),this._stylesCache[i]=r}return this._stylesCache[i]}hasTooltip(e){return!0}_getY(){let e=0;const t=this._model.panes();for(let i=t.length;i--;){const r=t[i];r.containsMainSeries()&&(e+=r.height())}return e}_createRenderers(e,t){this._renderer.clear();const i=new l.Size(e,t);for(const e in this._lollipops)if(this._lollipops.hasOwnProperty(e)){const t=(0,r.ensureDefined)(this._lollipops[e]);if(t.visible){const e=this.getStyle(t),r={id:t.id,centerPoint:new s.Point(t.basePoint.x,t.basePoint.y-e.lollipop.bottom-e.lollipop.height/2-(e.lollipop.incHeight||0)),style:e},n={activeItem:t.itemIndex,clickHandler:this._lollipopMouseClickHandler.bind(this,r,i),tapHandler:this._lollipopMouseClickHandler.bind(this,r,i)};if(this._renderer.append(this._createRendererForLollipop(r,n)),(t.hovered||t.active)&&this.hasTooltip(t)&&t.barY&&this.showBarLine()){const i={color:e.barLine.strokeStyle,linestyle:e.barLine.lineStyle,linewidth:e.barLine.lineWidth,x:t.basePoint.x,top:0,bottom:t.basePoint.y-e.lollipop.bottom-e.lollipop.height},r=new c.VerticalLineRenderer;r.setData(i),this._renderer.insert(r,0)}}}}_recreateStyles(e){this._stylesCache=null}_createRendererForLollipop(e,t){return new u.LollipopRenderer(e,new d.HitTestResult(d.HitTestResult.CUSTOM,t),this._textWidthCache)}_lollipopMouseClickHandler(e,t,i){i.preventDefault();const n=e.id;if(this._lastClickedId=this._lastClickedId===n?null:n,null===this._lastClickedId)return;const o={target:i.target,targetSize:t,
point:new s.Point(e.centerPoint.x,e.centerPoint.y-e.style.lollipop.height/2-8),marginTop:15};this._hitTestHandler(o,()=>{const e=(0,r.ensureDefined)(this._lollipops[n]),t=this.createTooltipContent(e);return t?[t]:null})}_onSymbolOrIntervalChanged(){this._lollipops={},this._lollipopsCounter=0,this._renderer.clear(),this.clearLastClicked()}}},95215:(e,t,i)=>{"use strict";var r;i.d(t,{MagnetMode:()=>r}),function(e){e[e.WeakMagnet=0]="WeakMagnet",e[e.StrongMagnet=1]="StrongMagnet"}(r||(r={}))},8273:(e,t,i)=>{"use strict";i.d(t,{magnetEnabled:()=>m,magnetMode:()=>f,setIsMagnetEnabled:()=>g,setMagnetMode:()=>v});var r=i(1771),s=i(65066),n=i.n(s),o=i(95215),a=i(14397),l=i(87048),c=i(54255);const u=new(n())(!1),d=new(n())(o.MagnetMode.WeakMagnet),h=(0,c.modifierPressed)(),p=(0,c.shiftPressed)();function _(){const e=h.value();if(p.value()&&(a.isToolEditingNow.value()||a.isToolCreatingNow.value()))return void u.setValue(!1);const t=a.tool.value(),i=a.isStudyEditingNow.value()||a.isPointSelectedNow.value(),r=e&&((0,l.isLineToolName)(t)||a.isToolEditingNow.value()||(0,a.toolIsMeasure)(t)||i),s=(0,a.properties)().childs().magnet.value();d.setValue(!s&&r?o.MagnetMode.StrongMagnet:(0,a.properties)().childs().magnetMode.value()),u.setValue(r?!s:s)}function m(){return u}function f(){return d}function g(e){(0,r.saveDefaultProperties)(!0),(0,a.properties)().childs().magnet.setValue(e),(0,r.saveDefaultProperties)(!1)}function v(e){(0,r.saveDefaultProperties)(!0),(0,a.properties)().childs().magnetMode.setValue(e),(0,a.properties)().childs().magnet.setValue(!0),(0,r.saveDefaultProperties)(!1)}(0,a.runOnDrawingStateReady)(()=>{(0,a.properties)().childs().magnet.subscribe(null,_),(0,a.properties)().childs().magnetMode.subscribe(null,_),h.subscribe(_),p.subscribe(_),a.tool.subscribe(_),a.isToolEditingNow.subscribe(_),_()})},54876:(e,t,i)=>{"use strict";i.d(t,{MainSeriesScaleRatioProperty:()=>n});var r=i(96276),s=i.n(r);class n{constructor(e){this._changed=new(s()),this._model=e}getStepChangeValue(){return.1}getMinValue(){return 1e-7}getMaxValue(){return 99999999}value(){return this._model.mainSeriesScaleRatio()}setValue(e,t){(e!==this.value()||t)&&(this._model.setMainSeriesScaleRatio(e),this._onChanged())}state(){return null}clone(){return new n(this._model)}listeners(){return this._changed}subscribe(e,t){this._changed.subscribe(e,t)}unsubscribe(e,t){this._changed.unsubscribe(e,t)}unsubscribeAll(e){this._changed.unsubscribeAll(e)}storeStateIfUndefined(){return!0}_onChanged(){this._changed.fire(this)}}},84101:(e,t,i)=>{"use strict";i.d(t,{ensureTimePointIndexIndex:()=>n,unpackNonSeriesData:()=>o});var r=i(73211),s=i(85192);function n(e){if(e<0)throw new Error("TimePointIndexIndex should be non-negative integer");return e}async function o(e){if(""===e)return null;const t=JSON.parse(e);if(!(0,r.isObject)(t)||"function"==typeof t)throw new Error("Non-object content in the non-series envelope");if((0,r.hasProperty)(t,"indexes_replace"))return{indexes_replace:!0};const n={indexes_replace:!1};if((0,
r.hasProperty)(t,"offsets")&&(n.offsets=t.offsets),(0,r.hasProperty)(t,"isUpdate")){if("boolean"!=typeof t.isUpdate)throw new Error('Invalid type of "isUpdate" field');n.isUpdate=t.isUpdate}if((0,r.hasProperty)(t,"data")&&(n.data=t.data),(0,r.hasProperty)(t,"graphicsCmds")&&(n.graphicsCmds=(0,s.validateGraphicsCommands)(t.graphicsCmds)),(0,r.hasProperty)(t,"dataCompressed")||(0,r.hasProperty)(t,"graphicsCmdsCompressed")){const{default:e}=await i.e(81578).then(i.t.bind(i,66085,23));if((0,r.hasProperty)(t,"dataCompressed")){const i=await(new e).loadAsync(t.dataCompressed,{base64:!0});n.data=JSON.parse(await i.file("").async("text"))}if((0,r.hasProperty)(t,"graphicsCmdsCompressed")){const i=await(new e).loadAsync(t.graphicsCmdsCompressed,{base64:!0});n.graphicsCmds=(0,s.validateGraphicsCommands)(JSON.parse(await i.file("").async("text")))}return n}return n}},12372:(e,t,i)=>{"use strict";i.d(t,{OverlayPriceAxisView:()=>l});var r=i(22842),s=i(32552),n=i(20554),o=i(57086);const a=r.enabled("force_exchange_as_title");class l extends s.PriceAxisView{constructor(e){super(),this._source=e}_updateRendererData(e,t,i){e.visible=!1,t.visible=!1;const r=this._source.lastValueData("close",!1);if(r.noData)return;const s=this._source.model(),n=this._source.priceScale();if(null===n)return;if(!s.isPriceScaleVisible(n))return;i.background=r.color,i.textColor=this.generateTextColor(r.color),i.coordinate=r.coordinate,i.floatCoordinate=r.floatCoordinate;const a=this._source.model().properties().scalesProperties,l=n.isPercentage();a.showSeriesLastValue.value()&&(e.text=l?r.formattedPricePercentage:r.formattedPriceAbsolute,a.seriesLastValueMode.value()!==o.PriceAxisLastValueMode.LastPriceAndPercentageValue?e.secondLine="":e.secondLine=l?r.formattedPriceAbsolute:r.formattedPricePercentage,e.visible=!0),t.text="",a.showSymbolLabels.value()&&(t.text=this._paneText(),t.visible=t.text.length>0)}_paneText(){let e="";const t=this._source.symbolInfo();return a?e=(0,n.displayedSymbolExchange)(t):this._source.model().properties().scalesProperties.showSymbolLabels.value()&&(e=(0,n.displayedSymbolName)(t)),e}}},99942:(e,t,i)=>{"use strict";i.d(t,{PaneBase:()=>M});var r=i(72927),s=i(16282),n=i(87380),o=i(96276),a=i.n(o),l=i(75443),c=i(68793),u=i(8412),d=i(43854),h=i(36436),p=i(87048),_=i(70734);const m=new Map([["trading",e=>(0,p.isTrading)(e)],["drawing",e=>(0,p.isLineTool)(e)&&!(0,p.isTrading)(e)&&!e.isPhantom()],["drawingsForAllSymbols",e=>(0,p.isLineTool)(e)&&!(0,p.isTrading)(e)&&!e.isPhantom()],["phantom",e=>(0,p.isLineTool)(e)&&e.isPhantom()],["restRowSources",e=>!(0,p.isLineTool)(e)&&!(0,p.isTrading)(e)],["leftPriceScale",(e,t)=>"left"===g(e,t)],["rightPriceScale",(e,t)=>"right"===g(e,t)],["overlayPriceScale",(e,t)=>"overlay"===g(e,t)]]),f=new Map([["trading","visibleSorted"],["drawing","visibleSorted"],["drawingsForAllSymbols","allSorted"],["phantom","visibleSorted"],["restRowSources","visibleSorted"],["leftPriceScale","visibleSorted"],["rightPriceScale","visibleSorted"],["overlayPriceScale","visibleSorted"]]);function g(e,t){
const i=e.priceScale();return null===i?"overlay":t.priceScalePosition(i)}class v{constructor(e){this._groupedSources=new Map,this._sources=null,this._pane=e}clear(){this._groupedSources.clear(),this._sources=null}destroy(){this.clear()}all(){return this._groupedSources.has("visibleSorted")||this._sortSources(),(0,s.ensureDefined)(this._groupedSources.get("visibleSorted"))}allIncludingHidden(){return this._groupedSources.has("allSorted")||this._sortSources(),(0,s.ensureDefined)(this._groupedSources.get("allSorted"))}allExceptSpecialSources(){if(!this._groupedSources.has("exceptSpecial")){const e=this.allIncludingHidden().filter(e=>!e.isSpeciallyZOrderedSource());this._groupedSources.set("exceptSpecial",e)}return(0,s.ensureDefined)(this._groupedSources.get("exceptSpecial"))}tradingSources(){return this._getSourcesByGroupType("trading")}lineSources(){return this._getSourcesByGroupType("drawing")}lineSourcesForAllSymbols(){return this._getSourcesByGroupType("drawingsForAllSymbols")}phantomSources(){return this._getSourcesByGroupType("phantom")}allExceptLineAndTradingSources(){return this._getSourcesByGroupType("restRowSources")}hitTestSources(){if(!this._groupedSources.has("hitTest")){const e=this.allExceptLineAndTradingSources().concat(this.lineSources());this._groupedSources.set("hitTest",e)}return(0,s.ensureDefined)(this._groupedSources.get("hitTest"))}generalSources(){if(!this._groupedSources.has("general")){const e=this.allExceptLineAndTradingSources().concat(this.lineSources());this._groupedSources.set("general",(0,_.sortSources)(e))}return(0,s.ensureDefined)(this._groupedSources.get("general"))}leftPriceScalesSources(){return this._getSourcesByGroupType("leftPriceScale")}rightPriceScalesSources(){return this._getSourcesByGroupType("rightPriceScale")}overlayPriceScaleSources(){return this._getSourcesByGroupType("overlayPriceScale")}_getSourcesByGroupType(e){const t=(0,s.ensureDefined)(f.get(e));return this._groupedSources.has(t)?this._groupedSources.has(e)||this._groupSources(e):(this._sortSources(),this._groupSources(e)),(0,s.ensureDefined)(this._groupedSources.get(e))}_sortSources(){null===this._sources&&(this._sources=this._pane.dataSources());const e=(0,_.sortSources)(this._sources),t=e.filter(e=>!(0,p.isLineTool)(e)||e.isActualSymbol()&&e.isActualCurrency()&&e.isActualUnit());this._groupedSources.set("allSorted",e),this._groupedSources.set("visibleSorted",t)}_groupSources(e){const t=(0,s.ensureDefined)(f.get(e)),i=m.get(e);if(void 0!==i){const r=(0,s.ensureDefined)(this._groupedSources.get(t)).filter(e=>i(e,this._pane));this._groupedSources.set(e,r)}}}var S=i(53353),y=i(940),b=i(59757),w=i(55304),P=i(88987),C=i(93006),T=i(65066),x=i.n(T);const I=(0,n.getLogger)("Chart.Pane");function L(e,t,i){e.setMargins({top:t,bottom:i})}class M{constructor(e,t,i,r){this.m_dataSources=[],this._sourceWatchedValuesSubscriptions=new Map,this.m_mainDataSource=null,this._cachedOrderedSources=new v(this),this._sourcesById=new Map,this._sourcePropertiesChanged=new(a()),this._sourcesZOrderChanged=new(a()),this._tagsChanged=new(a()),
this._stretchFactor=1e3,this._isInInsertManyDataSourcesState=!1,this._lastLineDataSourceZOrder=null,this._rightPriceScales=[],this._leftPriceScales=[],this._lockedPriceScale=null,this._currentPriceScaleRatio=null,this._onPriceScalesChanged=new(a()),this._isRecalculatingScales=!1,this._priceDataSources=[],this._symbolSources=[],this._symbolSourceResolved=new(a()),this._symbolSourceResolvingActive=new(x())(!1),this._bulkActions={activeCounter:0},this._reorderZOrderOnAddingSourceToCollectionAllowed=!0,this._height=0,this._width=0,this._dataSourcesCollectionChanged=new(a()),this._symbolSourceCollectionChanged=new(a()),this._recalcSymbolSourceResolvingActive=()=>{for(const e of this._symbolSources)if(e.symbolResolvingActive().value())return void this._symbolSourceResolvingActive.setValue(!0);this._symbolSourceResolvingActive.setValue(!1)},this._onSymbolSourceCollectionChanged=()=>{0===this._bulkActions.activeCounter?this._symbolSourceCollectionChanged.fire():this._bulkActions.symbolSourceCollectionChanged=!0},this._priceScaleSelectionStrategy=(0,h.createPriceScaleSelectionStrategy)(i.properties().priceScaleSelectionStrategyName.value()),this._id=null!=r?r:(0,l.randomHashN)(6)}id(){return this._id}bulkActionMacro(e){const t=this._bulkActions;t.activeCounter+=1,e(),t.activeCounter-=1,0===t.activeCounter&&(this._dataSourcesCollectionChanged.fire(),t.symbolSourceCollectionChanged&&this._symbolSourceCollectionChanged.fire(),t.symbolSourceCollectionChanged=!1)}sourcesByGroup(){return this._cachedOrderedSources}dataSourceForId(e){return this._sourcesById.get(e)||null}changeSourceId(e,t){(0,s.assert)(this.hasDataSource(e)),this._sourcesById.delete(e.id()),e.setId(t),this._sourcesById.set(t,e)}movePriceScale(e,t,i){const r=this.priceScalePosition(e);if(r!==t)this.removePriceScale(e),this._placePriceScale(e,t,i),e.invalidateMargins(),this._invalidateSourcesCache();else if(void 0!==i&&"overlay"!==r){const t="left"===r?this._leftPriceScales:this._rightPriceScales,s=t.indexOf(e);t.splice(s,1),t.splice(i,0,e)}}isEmpty(){return null===this.m_mainDataSource}recalculatePriceScale(e){if(!e)return;const t=e.sourcesForAutoscale();if((e.isAutoScale()||e.priceRangeShouldBeRecalculatedOnce())&&t&&t.length>0&&!this.timeScale().isEmpty()){const t=this.timeScale().visibleBarsStrictRange();e.recalculatePriceRange(t)}e.updateAllViews()}onSourceTagsChanged(){this._tagsChanged.fire()}insertDataSource(e,t,i){e.setZorder(i),t||(t=this.findSuitableScale(e)),this._addSourceToCollections(e);let r=!1;e===this.model().mainSeries()?(this.m_mainDataSource=e,r=!0):null!==this.m_mainDataSource||e instanceof u.AlertLabel||(this.m_mainDataSource=e,r=!0),t.addDataSource(e,this._isInInsertManyDataSourcesState),e.setPriceScale(t),t.invalidateMargins(),e.onTagsChanged&&e.onTagsChanged().subscribe(this,this.onSourceTagsChanged),r&&this._processMainSourceChange(),this._tagsChanged.fire(),e instanceof d.PriceDataSource&&this.recalculatePriceScale(t),this._invalidateSourcesCache(),this._isInInsertManyDataSourcesState||(0,
s.ensureNotNull)(this.model().alertsWatcher()).syncSourceAlertLabels(e)}addDataSource(e,t,i){let r=e.zorder();i||((0,p.isLineTool)(e)&&!e.isSpeciallyZOrderedSource()?(r=null!==this._lastLineDataSourceZOrder?this._lastLineDataSourceZOrder+1:this.newLineToolZOrder(),this._isInInsertManyDataSourcesState&&(this._lastLineDataSourceZOrder=r)):(0,w.isStudy)(e)&&!e.isSpeciallyZOrderedSource()&&(r=this.newStudyZOrder())),this.insertDataSource(e,t,r)}removeDataSource(e,t,i){const r=this.m_dataSources.indexOf(e);if(-1===r)return void I.logDebug("removeDataSource: invalid data source");(0,s.ensureNotNull)(this.model().alertsWatcher()).detachSourceAlertLabels(e),this._removeSourceFromCollections(r,!!i),e!==this.m_mainDataSource||t||(this.m_mainDataSource=null);const n=e.priceScale();this.removeSourceFromPriceScale(e),e.onTagsChanged&&e.onTagsChanged().unsubscribe(this,this.onSourceTagsChanged),e instanceof d.PriceDataSource&&!t&&this._processMainSourceChange(),this._tagsChanged.fire(),n&&e instanceof d.PriceDataSource&&this.recalculatePriceScale(n),this._invalidateSourcesCache()}hasDataSource(e){return this._sourcesById.has(e.id())}dataSources(){return this.m_dataSources}priceDataSources(){return this._priceDataSources}symbolSources(){return this._symbolSources}replaceSource(e,t,i){const r=this.m_mainDataSource===e,s=e.zorder();this.insertDataSource(t,i,s),this.removeDataSource(e,r),this._sourcesById.set(t.id(),t),r&&(this.m_mainDataSource=t,this._processMainSourceChange())}isOverlay(e){const t=e.priceScale();return null===t||"overlay"===this.priceScalePosition(t)}updateAllViews(){for(const e of this.m_dataSources)e.updateAllViews();for(const e of this.model().customSources())e.updateViewsForPane(this)}priceScalePosition(e){return this._leftPriceScales.includes(e)?"left":this._rightPriceScales.includes(e)?"right":"overlay"}createPriceScaleAtPosition(e,t){const i=this.properties().childs().axisProperties.state();i.autoScale=!0;const r=new S.PriceScale(this.model().properties().scalesProperties,i);return r.setHeight(this.height()),L(r,this._defaultTopMargin(),this._defaultBottomMargin()),this._placePriceScale(r,e,t),r}removePriceScale(e){e.modeChanged().unsubscribeAll(this),e.priceRangeChanged().unsubscribeAll(this),e.internalHeightChanged().unsubscribeAll(this),e===this._lockedPriceScale&&(this._lockedPriceScale=null,this._currentPriceScaleRatio=null);const t=this._leftPriceScales.indexOf(e);-1!==t&&(this._leftPriceScales[t].invalidateMargins(),this._leftPriceScales.splice(t,1));const i=this._rightPriceScales.indexOf(e);if(-1!==i&&(this._rightPriceScales[i].invalidateMargins(),this._rightPriceScales.splice(i,1)),null===e.mainSource()){const t=e.dataSources().length;0!==t&&I.logError("Invalid priceScale state: empty mainSource but non-empty data sources="+t)}this._onPriceScalesChanged.fire()}move(e,t,i){const r=e.priceScale();this.removeSourceFromPriceScale(e),t.addDataSource(e),e.setPriceScale(t),t.invalidateMargins(),this._processMainSourceChange(),this._invalidateSourcesCache(),
e.isIncludedInAutoScale()&&(null!==r&&this.recalculatePriceScale(r),this.recalculatePriceScale(t)),this._onPriceScalesChanged.fire()}setZOrders(e){e.forEach((e,t)=>{t.setZorder(e)}),this._invalidateSourcesCache(),0===this._bulkActions.activeCounter&&this._dataSourcesCollectionChanged.fire(),this.model().lightUpdate()}isMainPane(){const e=this.model().mainSeries();for(const t of this.m_dataSources)if(t===e)return!0;return!1}isLast(){const e=this.model().panes();return e[e.length-1]===this}newStudyZOrder(){return(0,C.newStudyZOrder)(this._priceDataSources)}newLineToolZOrder(e){return(0,C.newLineToolZOrder)(this.m_dataSources,e)}containsMainSeries(){return this._sourcesById.has(this.model().mainSeries().id())}applyPriceScaleRatio(e,t){var i;null!==this._lockedPriceScale&&this._lockedPriceScale!==e||this._currentPriceScaleRatio===t||!this.isMainPane()||null===this._lockedPriceScale&&e!==(null===(i=this.mainDataSource())||void 0===i?void 0:i.priceScale())||(this._setNewPriceRangeByScaleRatio(e,t,this._mainSourceVisiblePriceRange(e),!0,!0),null!==this._lockedPriceScale?this._tryToApplyNewPriceScaleRatio():e.isLog()||this.model().mainSeriesScaleRatioPropertyOnChanged())}sendToBack(e){const t=this.sourcesByGroup().allExceptSpecialSources();this._batchReorder(e,t[0],C.moveBeforeSource)}bringToFront(e){const t=this.sourcesByGroup().allExceptSpecialSources();this._batchReorder(e,t[t.length-1],C.moveAfterSource)}sendBackward(e){const t=this.sourcesByGroup().allIncludingHidden(),i=t.indexOf(e[0]);if(0===i)this.bringToFront(e);else{const r=t[i-1];this.insertBefore(e,r)}}bringForward(e){const t=this.sourcesByGroup().allExceptSpecialSources(),i=t.indexOf(e[e.length-1]);if(i===t.length-1)this.sendToBack(e);else{const r=t[i+1];this.insertAfter(e,r)}}insertAfter(e,t){this._batchReorder(e,t,C.moveAfterSource)}insertBefore(e,t){this._batchReorder(e,t,C.moveBeforeSource)}priceScaleSelectionStrategy(){return this._priceScaleSelectionStrategy}findTargetPriceAxisViews(e,t,i,r){if((0,c.isDataSource)(e)&&this.model().paneForSource(e)!==this)return[];const s=e.priceScale();if(t===s)return i;if(null===s)return[];if("overlay"===this.priceScalePosition(s))return t===this.defaultPriceScale()?i:[];const n=this.priceScalePosition(t);if(n!==this.priceScalePosition(s))return[];const o="left"===n?this.leftPriceScales():this.rightPriceScales();return o.indexOf(t)<o.indexOf(s)?r:[]}onPriceScalesChanged(){return this._onPriceScalesChanged}setPaneSize(e){let t;switch(e){case"large":t=1;break;case"medium":t=.6;break;case"small":t=.3;break;case"tiny":t=.15;break;default:throw new Error("Unknown size enum value: "+e)}this._stretchFactor=1e3*t}stretchFactor(){return this._stretchFactor}setStretchFactor(e){this._stretchFactor=e}customSources(e){return this.model().customSources(e)}width(){return this._width}height(){return this._height}setHeight(e){this._height=e,this._leftPriceScales.forEach(t=>t.setHeight(e)),this._rightPriceScales.forEach(t=>t.setHeight(e));for(let t=0;t<this.m_dataSources.length;t++){const i=this.m_dataSources[t]
;this.isOverlay(i)&&i.priceScale()&&(0,s.ensureNotNull)(i.priceScale()).setHeight(e)}this.updateAllViews()}setWidth(e){this._width=e,this.updateAllViews()}onTagsChanged(){return this._tagsChanged}dataSourcesCollectionChanged(){return this._dataSourcesCollectionChanged}symbolSourceCollectionChanged(){return this._symbolSourceCollectionChanged}symbolSourceResolved(){return this._symbolSourceResolved}symbolSourceResolvingActive(){return this._symbolSourceResolvingActive}sourcePropertiesChanged(){return this._sourcePropertiesChanged}sourceZOrderChanged(){return this._sourcesZOrderChanged}lineToolsForArea(e){const t=this.height(),i=this.width(),r=this.logicalRectToPixels(e);return[...this.m_dataSources,...this.model().multiPaneSources(this)].filter(p.isLineTool).filter(e=>(e.paneViews(this)||[]).some(e=>{const s=e.renderer(t,i);return s&&s.doesIntersectWithBox&&s.doesIntersectWithBox(r)}))}logicalRectToPixels(e){const t=this.defaultPriceScale(),i=this.timeScale(),n=(0,s.ensureNotNull)((0,s.ensureNotNull)(t.mainSource()).firstValue()),o=t.priceToCoordinate(e.p1.price,n),a=i.indexToCoordinate(e.p1.index),l=t.priceToCoordinate(e.p2.price,n),c=i.indexToCoordinate(e.p2.index),u=new r.Point(Math.min(a,c),Math.min(o,l)),d=new r.Point(Math.max(a,c),Math.max(o,l));return(0,r.box)(u,d)}clipboardLineToolOwnerSource(e){const t=this.dataSourceForId(e);if(null!==t){const e=t.ownerSource();if(null!==e&&null!==e.firstValue())return e}const i=this.mainDataSource();if(null!==i&&null!==i.firstValue())return i;for(const e of this.dataSources())if(e instanceof d.PriceDataSource&&null!==e.firstValue())return e;return null}realignLineTools(){let e=!1;for(const t of this.m_dataSources)(0,p.isLineTool)(t)&&(t.calcIsActualSymbol(),t.updateAllViews(),e=!0);return this._invalidateSourcesCache(),e}startScalePrice(e,t){e.startScale(t)}scalePriceTo(e,t){e.scaleTo(t),this.updateAllViews()}endScalePrice(e){e.endScale()}resetPriceScale(e){const t=this.timeScale().visibleBarsStrictRange();e.isLockScale()||e.setMode({autoScale:!0}),e.recalculatePriceRange(t),this.updateAllViews()}restorePriceScaleState(e,t){e.restoreState(t),this.updateAllViews()}beginInsertManyLineDataSources(){this._isInInsertManyDataSourcesState=!0,this._lastLineDataSourceZOrder=null}endInsertManyLineDataSources(){this._isInInsertManyDataSourcesState=!1,this._lastLineDataSourceZOrder=null;{const e=(0,s.ensureNotNull)(this.model().alertsWatcher());for(const t of this.m_dataSources)e.syncSourceAlertLabels(t)}}removeSourceFromPriceScale(e){const t=e.priceScale();if(null!==t){const i=t.dataSources();i.indexOf(e)>=0&&t.removeDataSource(e),0===i.length&&this.removePriceScale(t)}}_addSourceToCollections(e,t){this.m_dataSources.push(e),this._sourcesById.set(e.id(),e),this._invalidateSourcesCache(),t||0!==this._bulkActions.activeCounter||this._dataSourcesCollectionChanged.fire();const i=()=>{this._sourcePropertiesChanged.fire(e)};e.properties().subscribe(this,i),e.zOrderChanged().subscribe(this,t=>this._sourcesZOrderChanged.fire(e,t)),(0,
p.isLineTool)(e)&&(e.normalizedPointsChanged().subscribe(this,i),e.fixedPointsChanged().subscribe(this,i),e.hasAlert.subscribe(i),e.linkKey().subscribe(i),this._sourceWatchedValuesSubscriptions.set(e.id(),i));const r=(0,P.isSymbolSource)(e)?e:null;e instanceof d.PriceDataSource&&(e.currencyChanged().subscribe(this,()=>this._invalidateSourcesCache()),e.unitChanged().subscribe(this,()=>this._invalidateSourcesCache()),this._priceDataSources.push(e),null!==r&&(this._symbolSources.push(r),r.symbolResolved().subscribe(this,()=>this._symbolSourceResolved.fire(e)),r.symbolResolvingActive().subscribe(this._recalcSymbolSourceResolvingActive),r.symbolHibernated().subscribe(this._onSymbolSourceCollectionChanged),this._recalcSymbolSourceResolvingActive(),this._onSymbolSourceCollectionChanged())),e.isMultiPaneAvailable()&&this.model().addMultiPaneSource(e),!e.isSpeciallyZOrderedSource()&&this._reorderZOrderOnAddingSourceToCollectionAllowed&&((0,p.isLineTool)(e)&&(0,C.isReorderRequired)(null,e.zorder())||(0,w.isStudy)(e)&&(0,C.isReorderRequired)(e.zorder(),null))&&(this._reorderZOrderOnAddingSourceToCollectionAllowed=(0,C.reorderDataSourcesZOrder)(this.m_dataSources))}_removeSourceFromCollections(e,t){const i=this.m_dataSources[e];i.properties().unsubscribeAll(this),i.zOrderChanged().unsubscribeAll(this),this.m_dataSources.splice(e,1),this._sourcesById.delete(i.id());const r=i.id();if((0,p.isLineTool)(i)&&(i.normalizedPointsChanged().unsubscribeAll(this),i.fixedPointsChanged().unsubscribeAll(this),this._sourceWatchedValuesSubscriptions.has(r))){const e=this._sourceWatchedValuesSubscriptions.get(r);i.hasAlert.unsubscribe(e),i.linkKey().unsubscribe(e)}this._invalidateSourcesCache();const n=(0,P.isSymbolSource)(i)?i:null;if(i instanceof d.PriceDataSource){i.currencyChanged().unsubscribeAll(this),i.unitChanged().unsubscribeAll(this);const e=this._priceDataSources.indexOf(i);if((0,s.assert)(-1!==e),this._priceDataSources.splice(e,1),null!==n){const e=this._symbolSources.indexOf(n);(0,s.assert)(-1!==e,"Source is not found"),this._symbolSources.splice(e,1),n.symbolResolved().unsubscribeAll(this),n.symbolResolvingActive().unsubscribe(this._recalcSymbolSourceResolvingActive),n.symbolHibernated().unsubscribe(this._onSymbolSourceCollectionChanged),this._recalcSymbolSourceResolvingActive(),this._onSymbolSourceCollectionChanged()}}t||0!==this._bulkActions.activeCounter||this._dataSourcesCollectionChanged.fire(),i.isMultiPaneAvailable()&&this.model().removeMultiPaneSource(i),this._reorderZOrderOnAddingSourceToCollectionAllowed=!0}_recalculatePriceScaleByScaleRatio(e){this.isMainPane()&&e===this._lockedPriceScale&&(null!==this._currentPriceScaleRatio?this._applyOldScaleRatioToPriceScale():this._tryToApplyNewPriceScaleRatio())}_defaultBottomMargin(){return.01*this.properties().childs().bottomMargin.value()}_defaultTopMargin(){return.01*this.properties().childs().topMargin.value()}_updateMargins(){const e=this._defaultTopMargin(),t=this._defaultBottomMargin();for(const i of this._leftPriceScales)L(i,e,t)
;for(const i of this._rightPriceScales)L(i,e,t);for(const i of this.m_dataSources)if(this.isOverlay(i)){const r=i.priceScale();null!==r&&(L(r,e,t),this.recalculatePriceScale(r))}for(const e of this._leftPriceScales)this.recalculatePriceScale(e);for(const e of this._rightPriceScales)this.recalculatePriceScale(e);this.updateAllViews()}_batchReorder(e,t,i){i(this.sourcesByGroup().allExceptSpecialSources(),e,t),this._invalidateSourcesCache(),this._dataSourcesCollectionChanged.fire(),this.model().fullUpdate()}_placePriceScale(e,t,i){if("overlay"===t)return void e.invalidateMargins();const r="left"===t?this._leftPriceScales:this._rightPriceScales,n=void 0===i?r.length:i;r.splice(n,0,e),e.modeChanged().subscribe(this,this._onPriceScaleModeChanged.bind(this,e)),e.internalHeightChanged().subscribe(this,this._recalculatePriceScaleByScaleRatio.bind(this,e)),e.priceRangeChanged().subscribe(this,this._recalculateTimeScaleByScaleRatio.bind(this,e)),e.priceRangeChanged().subscribe(this,this._onPriceScaleSetMinMaxPriceRange.bind(this,e)),e.isLockScale()&&((0,s.assert)(null===this._lockedPriceScale),this._lockedPriceScale=e,this._currentPriceScaleRatio=null),e.invalidateMargins(),this._onPriceScalesChanged.fire()}_onPriceScaleModeChanged(e,t,i){if(i.lockScale&&(this._lockedPriceScale!==e&&null!==this._lockedPriceScale&&this._lockedPriceScale.setMode({lockScale:!1}),this._lockedPriceScale=e,this._currentPriceScaleRatio=(0,y.scaleRatio)(this.timeScale(),e)),t.lockScale&&!i.lockScale&&(this._lockedPriceScale=null,this._currentPriceScaleRatio=null),t.percentage===i.percentage&&t.indexedTo100===i.indexedTo100)return;const r=this.timeScale().visibleBarsStrictRange();null!==r&&(e.recalculatePriceRange(r),e.updateAllViews())}_applyOldScaleRatioToPriceScale(){this._isRecalculatingScales||null===this._currentPriceScaleRatio||null===this._lockedPriceScale||(this._isRecalculatingScales=!0,this._setNewPriceRangeByScaleRatio(this._lockedPriceScale,this._currentPriceScaleRatio,this._mainSourceVisiblePriceRange(this._lockedPriceScale)),this._isRecalculatingScales=!1)}_setNewPriceRangeByScaleRatio(e,t,i,r,s){const n=(0,y.priceRangeByScaleRatio)(e,this.timeScale().barSpacing(),t);e.setPriceRange(null!==n?n:i,r,s)}_applyOldScaleRatioToTimeScale(){this._isRecalculatingScales||null===this._currentPriceScaleRatio||(this._isRecalculatingScales=!0,this._setNewBarSpacingByScaleRatio(),this._isRecalculatingScales=!1)}_tryToApplyNewPriceScaleRatio(){const e=(0,s.ensureNotNull)(this._lockedPriceScale),t=(0,y.scaleRatio)(this.timeScale(),e);this._currentPriceScaleRatio===t||e.isLog()||(this._currentPriceScaleRatio=t,this.model().mainSeriesScaleRatioPropertyOnChanged())}_recalculateTimeScaleByScaleRatio(e){e===this._lockedPriceScale&&(null!==this._currentPriceScaleRatio?this._applyOldScaleRatioToTimeScale():this._tryToApplyNewPriceScaleRatio())}_setNewBarSpacingByScaleRatio(){const e=this.timeScale().getValidBarSpacing((0,y.barSpacingByScaleRatio)((0,s.ensureNotNull)(this._lockedPriceScale),this._currentPriceScaleRatio))
;this.timeScale().isValidBarSpacing(e)&&this.timeScale().setBarSpacing(e)}_mainSourceVisiblePriceRange(e){const t=this.timeScale().visibleBarsStrictRange();return null!==t?(0,s.ensureNotNull)((0,s.ensureNotNull)(e.mainSource()).priceRange(t.firstBar(),t.lastBar())):new b.PriceRange(-.5,.5)}_setMinMaxPriceRange(){const e=(0,s.ensureNotNull)(this._lockedPriceScale),t=(0,y.priceRangeByScaleRatio)(e,this.timeScale().maxBarSpacing(),this._currentPriceScaleRatio),i=(0,y.priceRangeByScaleRatio)(e,this.timeScale().minBarSpacing(),this._currentPriceScaleRatio);null!==t&&e.setMaxPriceRange(t),null!==i&&e.setMinPriceRange(i)}_onPriceScaleSetMinMaxPriceRange(e){e===this._lockedPriceScale&&this._setMinMaxPriceRange()}}},88558:(e,t,i)=>{"use strict";var r;i.d(t,{PaneCursorType:()=>r}),function(e){e[e.Default=0]="Default",e[e.Pointer=1]="Pointer",e[e.Eraser=2]="Eraser",e[e.Dot=3]="Dot",e[e.Grabbing=4]="Grabbing",e[e.ZoomIn=5]="ZoomIn",e[e.VerticalResize=6]="VerticalResize",e[e.HorizontalResize=7]="HorizontalResize",e[e.DiagonalNeSwResize=8]="DiagonalNeSwResize",e[e.DiagonalNwSeResize=9]="DiagonalNwSeResize"}(r||(r={}))},63956:(e,t,i)=>{"use strict";i.d(t,{PanePriceAxisView:()=>n});var r=i(54567);class s{constructor(e){this._priceAxisViewRenderer=null,this._rendererOptions=null,this._align="right",this._width=0,this._height=0,this._textWidthCache=e}setParams(e,t,i,r,s){this._priceAxisViewRenderer=e,this._rendererOptions=t,this._width=i,this._height=r,this._align=s}draw(e,t){null!==this._rendererOptions&&null!==this._priceAxisViewRenderer&&this._priceAxisViewRenderer.draw(e,this._rendererOptions,this._textWidthCache,this._width,this._height,this._align,t.pixelRatio)}hitTest(e){var t,i;return void 0===(null===(t=this._priceAxisViewRenderer)||void 0===t?void 0:t.hitTest)?null:null===(i=this._priceAxisViewRenderer)||void 0===i?void 0:i.hitTest(e,this._width,this._align)}}class n{constructor(e,t,i){this._renderer=null,this._invalidated=!0,this._priceAxisView=e,this._textWidthCache=new r.TextWidthCache(100),this._dataSource=t,this._chartModel=i,this._fontSize=-1,this._panePriceAxisViewRenderer=new s(this._textWidthCache)}update(){this._invalidated=!0}renderer(e,t){return this._invalidated&&this._updateImpl(e,t),this._renderer}_updateImpl(e,t){this._renderer=null;const i=this._chartModel.crossHairSource(),r=this._dataSource===i?i.pane:this._chartModel.paneForSource(this._dataSource);if(null===r)return;const s=this._priceScale();if(null===s)return;let n=r.priceScalePosition(s);if("overlay"===n&&(n=r.priceScalePosition(r.defaultPriceScale())),"overlay"===n)return;const o=this._chartModel.priceAxisRendererOptions();o.fontSize!==this._fontSize&&(this._fontSize=o.fontSize,this._textWidthCache.reset()),this._panePriceAxisViewRenderer.setParams(this._priceAxisView.paneRenderer(),o,t,e,n),this._renderer=this._panePriceAxisViewRenderer,this._invalidated=!1}_priceScale(){return this._dataSource.priceScale()}}},93321:(e,t,i)=>{"use strict";i.d(t,{PaneRendererArea:()=>a});var r=i(16282),s=i(24090),n=i(99438),o=i(34250)
;class a extends s.PaneRendererLine{constructor(e){e.forceLineColor=!1,super(e)}draw(e,t){var i;e.save(),e.scale(t.pixelRatio,t.pixelRatio);const s=this._data;if(0===s.items.length)return;e.lineCap="butt",e.strokeStyle=s.lineColor,e.lineWidth=s.lineWidth,(0,n.setLineStyle)(e,s.lineStyle),e.lineWidth=1;let a=0;for(;a<s.items.length&&!(0,o.coordinateIsValid)(s.items[a].y);)a++;let l=s.items.length-1;for(;l>=0&&!(0,o.coordinateIsValid)(s.items[l].y);)l--;if(a>l)return;const c={},u=s.items;for(let e=a;e<=l;e++){const t=u[e];let i;if(i=t.style?t.style.color:s.lineColor,e<l&&u[e+1].style){const s=(0,r.ensureDefined)(u[e+1].style).color;if(i!==s){const e=c[s]||[];e.push(t),c[s]=e}}const n=c[i]||[];n.push(t),c[i]=n}for(const t of Object.keys(c)){const r=c[t];e.beginPath();let n=0;for(let o=0;o<r.length;o++)r[o].style&&(null===(i=r[o].style)||void 0===i?void 0:i.color)!==t&&(e.moveTo(Math.round(r[n].x),s.bottom),this._walkLine(e,r.slice(n,o),!0,s.bottom),n=o);if(e.moveTo(Math.round(r[n].x),s.bottom),this._walkLine(e,r.slice(n,r.length),!0,s.bottom),e.closePath(),s.isSeries){const t=e.createLinearGradient(0,0,0,s.bottom);t.addColorStop(0,s.color1),t.addColorStop(1,s.color2),e.fillStyle=t,s.simpleMode=!0}else e.fillStyle=t;e.fill()}e.lineWidth=s.lineWidth,e.restore(),super.draw(e,t)}}},6144:(e,t,i)=>{"use strict";i.d(t,{PaneRendererClockIcon:()=>o});var r=i(62288),s=i(29295);const n=Math.sqrt(3);class o extends s.ScaledPaneRenderer{constructor(e){super(),this.update(e)}update(e){var t;const i=e.point1,r=null!==(t=e.point2)&&void 0!==t?t:e.point1,s=i.x-r.x,o=i.y-r.y;let a=e.horzMargin;void 0===a&&(a=s>0?10:-25),this._x=i.x+a,this._y=i.y+(0!==o&&Math.abs(s)*n<=Math.abs(o)?-7:o>0?-25:11),this._color=e.color}hitTest(e){return e.x<this._x||e.x>this._x+16||e.y<this._y||e.y>this._y+16?null:new r.HitTestResult(r.HitTestResult.REGULAR)}_drawImpl(e){e.save(),e.translate(this._x-.5,this._y-.5),e.beginPath(),e.arc(8,9,6,0,2*Math.PI,!0),e.closePath(),e.moveTo(8,9),e.arc(8.5,5.5,.5,Math.PI,0),e.lineTo(9,10),e.arc(5.5,9.5,.5,.5*Math.PI,1.5*Math.PI),e.closePath(),e.moveTo(1.71,5.93),e.bezierCurveTo(-.61,2.83,3.86,-.76,6.39,2.18),e.bezierCurveTo(4.35,2.67,2.63,4.04,1.71,5.93),e.closePath(),e.moveTo(14.29,5.93),e.bezierCurveTo(16.61,2.83,12.14,-.76,9.61,2.18),e.bezierCurveTo(11.65,2.67,13.37,4.04,14.29,5.93),e.fillStyle=this._color,e.fill(),e.restore()}}},56288:(e,t,i)=>{"use strict";i.d(t,{CompositeRenderer:()=>r});class r{constructor(){this._renderers=[],this._globalAlpha=1}setGlobalAlpha(e){this._globalAlpha=e}append(e){this._renderers.push(e)}insert(e,t){this._renderers.splice(t,0,e)}clear(){this._renderers.length=0}isEmpty(){return 0===this._renderers.length}draw(e,t){for(let i=0;i<this._renderers.length;i++)e.save(),e.globalAlpha=this._globalAlpha,this._renderers[i].draw(e,t),e.restore()}drawBackground(e,t){e.save(),e.globalAlpha=this._globalAlpha;for(let i=0;i<this._renderers.length;i++){const r=this._renderers[i];r.drawBackground&&r.drawBackground(e,t)}e.restore()}hitTest(e,t){let i=null;for(let r=this._renderers.length-1;r>=0;r--){
const s=this._renderers[r].hitTest(e,t);null!==s&&(null===i||s.result()>i.result())&&(i=s)}return i}doesIntersectWithBox(e){return this._renderers.some(t=>!!t.doesIntersectWithBox&&t.doesIntersectWithBox(e))}}},64348:(e,t,i)=>{"use strict";i.d(t,{clearRectWithGradient:()=>o,fillRectInnerBorder:()=>a,drawHorizontalLine:()=>l,drawVerticalLine:()=>c,drawRoundRect:()=>d,drawRoundRectWithInnerBorder:()=>h,fillRectWithBorder:()=>p,createCircle:()=>_});var r=i(72927),s=i(99438),n=i(69647);function o(e,t,i,r,s,n,o){e.save(),e.globalCompositeOperation="copy";const a=e.createLinearGradient(0,0,0,s);a.addColorStop(0,n),a.addColorStop(1,o),e.fillStyle=a,e.fillRect(t,i,r,s),e.restore()}function a(e,t,i,r,s,n){e.fillRect(t+n,i,r-2*n,n),e.fillRect(t+n,i+s-n,r-2*n,n),e.fillRect(t,i,n,s),e.fillRect(t+r-n,i,n,s)}function l(e,t,i,r){e.beginPath();const s=e.lineWidth%2?.5:0;e.moveTo(i,t+s),e.lineTo(r,t+s),e.stroke()}function c(e,t,i,r){e.beginPath();const s=e.lineWidth%2?.5:0;e.moveTo(t+s,i),e.lineTo(t+s,r),e.stroke()}function u(e,t){return Array.isArray(e)?e.map(e=>0===e?e:e+t):e+t}function d(e,t,i,r,s,n,o){let a,l,c,u;if(Array.isArray(n))if(2===n.length){const e=Math.max(0,n[0]),t=Math.max(0,n[1]);a=e,l=e,c=t,u=t}else{if(4!==n.length)throw new Error("Wrong border radius - it should be like css border radius");a=Math.max(0,n[0]),l=Math.max(0,n[1]),c=Math.max(0,n[2]),u=Math.max(0,n[3])}else{const e=Math.max(0,n);a=e,l=e,c=e,u=e}o||e.beginPath(),e.moveTo(t+a,i),e.lineTo(t+r-l,i),0!==l&&e.arcTo(t+r,i,t+r,i+l,l),e.lineTo(t+r,i+s-c),0!==c&&e.arcTo(t+r,i+s,t+r-c,i+s,c),e.lineTo(t+u,i+s),0!==u&&e.arcTo(t,i+s,t,i+s-u,u),e.lineTo(t,i+a),0!==a&&e.arcTo(t,i,t+a,i,a)}function h(e,t,i,r,o,a,l=0,c=0,h="",p=n.LineStyle.Solid){if(e.save(),!c||!h||h===a)return d(e,t,i,r,o,l),e.fillStyle=a,e.fill(),void e.restore();const _=c/2;if("transparent"!==a){const s="transparent"!==h&&p!==n.LineStyle.Solid;d(e,s?t:t+c,s?i:i+c,s?r:r-2*c,s?o:o-2*c,s?l:u(l,-c)),e.fillStyle=a,e.fill()}if("transparent"!==h){d(e,t+_,i+_,r-c,o-c,u(l,-_)),e.lineWidth=c,e.strokeStyle=h,(0,s.setLineStyle)(e,p),e.closePath(),e.stroke()}e.restore()}function p(e,t,i,n,o,a,l,c,u,d,h,p,_,m,f){const g=d?0:t,v=h?_:n;if(void 0!==a&&(e.fillStyle=a,e.fillRect(g,i,v-g+m,o-i)),void 0!==l&&c>0){if(e.beginPath(),(0,s.setLineStyle)(e,u),void 0!==f){const t=f.map(e=>e*c);(0,s.setLineDash)(e,t)}let a=(0,r.point)(0,0),d=(0,r.point)(0,0),h=(0,r.point)(0,0),_=(0,r.point)(0,0);switch(p){case"outer":{const e=.5*c;h=(0,r.point)(0,e),_=(0,r.point)(0,e),a=(0,r.point)(e,-c),d=(0,r.point)(e,-c);break}case"center":{const e=c%2?.5:0,t=c%2?.5:m;h=(0,r.point)(.5*c-e,-e),_=(0,r.point)(t+.5*c,-e),a=(0,r.point)(-e,e+.5*c),d=(0,r.point)(t,e+.5*c);break}case"inner":{const e=.5*c;h=(0,r.point)(0,-e),_=(0,r.point)(1,-e),a=(0,r.point)(-e,c),d=(0,r.point)(1-e,c);break}}e.lineWidth=c,e.strokeStyle=l,e.moveTo(g-h.x,i-h.y),e.lineTo(v+_.x,i-_.y),e.moveTo(n+d.x,i+d.y),e.lineTo(n+d.x,o-d.y),e.moveTo(g-h.x,o+h.y),e.lineTo(v+_.x,o+_.y),e.moveTo(t-a.x,i+a.y),e.lineTo(t-a.x,o-a.y),e.stroke()}}function _(e,t,i,r){e.beginPath(),
e.arc(t,i,r,0,2*Math.PI,!1),e.closePath()}},70391:(e,t,i)=>{"use strict";i.d(t,{GridRenderer:()=>n});var r=i(99438),s=i(64348);class n{constructor(){this._data=null}setData(e){this._data=e}draw(e,t){if(null===this._data)return;const i=t.pixelRatio,n=Math.max(1,Math.floor(i));e.lineWidth=n;const o=Math.ceil(this._data.h*i),a=Math.ceil(this._data.w*i);if(e.save(),e.lineCap="butt",this._data.vertLinesVisible){e.strokeStyle=this._data.vertLinesColor,(0,r.setLineStyle)(e,this._data.vertLineStyle);for(const t of this._data.timeMarks){const r=Math.round(t.coord*i);(0,s.drawVerticalLine)(e,r,0,o)}}if(this._data.horzLinesVisible){e.strokeStyle=this._data.horzLinesColor,(0,r.setLineStyle)(e,this._data.horzLineStyle);for(const t of this._data.priceMarks){const r=Math.round(t.coord*i);(0,s.drawHorizontalLine)(e,r,0,a)}}e.restore()}hitTest(e){return null}}},34250:(e,t,i)=>{"use strict";i.r(t),i.d(t,{extendAndClipLineSegment:()=>u,getArrowPoints:()=>d,optimalBarWidth:()=>h,optimalCandlestickWidth:()=>p,optimalHiLoWidth:()=>_,interactionTolerance:()=>m,coordinateIsValid:()=>f,setValidLineStyle:()=>g,fillScaledRadius:()=>v,strokeScaledRadius:()=>S});var r=i(72927),s=i(95196),n=i(748),o=i(31565),a=i(99438);const l={line:13,minDistanceBetweenPoints:10,series:14,curve:10,anchor:13,esd:4},c={line:3,minDistanceBetweenPoints:5,series:2,curve:3,anchor:2,esd:0};function u(e,t,i,n,o,a){if((0,r.equalPoints)(e,t))return null;const l=new r.Point(0,0),c=new r.Point(i,n);if(o){if(a){const i=(0,s.intersectLineAndBox)((0,r.lineThroughPoints)(e,t),(0,r.box)(l,c));return Array.isArray(i)?i:null}{const i=(0,s.intersectRayAndBox)(t,e,(0,r.box)(l,c));return null===i||(0,r.equalPoints)(t,i)?null:(0,r.lineSegment)(t,i)}}if(a){const i=(0,s.intersectRayAndBox)(e,t,(0,r.box)(l,c));return null===i||(0,r.equalPoints)(e,i)?null:(0,r.lineSegment)(e,i)}{const i=(0,s.intersectLineSegmentAndBox)((0,r.lineSegment)(e,t),(0,r.box)(l,c));return Array.isArray(i)?i:null}}function d(e,t,i,r){const s=.5*i,n=Math.sqrt(2),o=t.subtract(e),a=o.normalized();let l=5*i;r&&(l=Math.min(l,.35*o.length()));const c=1*s;if(l*n*.2<=c)return[];const u=a.scaled(l),d=t.subtract(u),h=a.transposed(),p=1*l,_=h.scaled(p),m=d.add(_),f=d.subtract(_),g=m.subtract(t).normalized().scaled(c),v=f.subtract(t).normalized().scaled(c),S=t.add(g),y=t.add(v),b=s*(n-1),w=h.scaled(b),P=Math.min(l-1*s/n,s*n*1),C=a.scaled(P),T=t.subtract(w),x=t.add(w),I=t.subtract(C);return[[m,S],[f,y],[T,I.subtract(w)],[x,I.add(w)]]}function h(e,t){return t=t||1,Math.floor(.3*e*t)}function p(e,t){if(e>=2.5&&e<=4)return Math.floor(3*t);const i=1-.2*Math.atan(Math.max(4,e)-4)/(.5*Math.PI),r=Math.floor(e*i*t),s=Math.floor(e*t),n=Math.min(r,s);return Math.max(Math.floor(t),n)}function _(e){return.4*e}function m(){return(0,n.lastEventIsTouch)()?l:c}function f(e){return null!=e&&!(0,o.isNaN)(e)}function g(e,t){void 0!==t&&(0,a.setLineStyle)(e,t)}function v(e,t){const i=Math.max(1,Math.floor(t))%2?.5:0;return Math.round(e*t)+i}function S(e,t,i){const r=Math.max(1,Math.floor(t))%2?.5:0;return Math.round(e*t)+(r!==i%2?.5:0)}},
11258:(e,t,i)=>{"use strict";i.d(t,{HorizontalLineRenderer:()=>a});var r=i(62288),s=i(99438),n=i(64348),o=i(34250);class a{constructor(){this._data=null,this._hitTest=new r.HitTestResult(r.HitTestResult.REGULAR)}setData(e){this._data=e}setHitTest(e){this._hitTest=e}hitTest(e){if(null===this._data||!1===this._data.visible||null===this._hitTest)return null;const t=(0,o.interactionTolerance)().line,i=Math.abs(e.y-this._data.y)<=t+this._data.linewidth/2,r=void 0===this._data.left||this._data.left-e.x<=t,s=void 0===this._data.right||e.x-this._data.right<=t;return i&&r&&s?this._hitTest:null}draw(e,t){if(null===this._data)return;if(!1===this._data.visible)return;if(this._data.y<-this._data.linewidth/2||this._data.y>t.cssHeight+this._data.linewidth/2)return;const i=t.pixelRatio;e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=Math.max(1,Math.floor(this._data.linewidth*i)),void 0!==this._data.linestyle&&(0,s.setLineStyle)(e,this._data.linestyle);const r=void 0!==this._data.left?Math.max(this._data.left,0):0,o=void 0!==this._data.right?Math.min(this._data.right,t.cssWidth):t.cssWidth,a=Math.round(this._data.y*i),l=Math.floor(r*i),c=Math.ceil(o*i);(0,n.drawHorizontalLine)(e,a,l,c)}}},85789:(e,t,i)=>{"use strict";function r(e,t){return e.pixelRatio===t.pixelRatio}i.d(t,{areEqualPaneRenderParams:()=>r})},19680:(e,t,i)=>{"use strict";i.d(t,{LineAnchorPointImpl:()=>d,LineAnchorRenderer:()=>g});var r=i(72927),s=i(71044),n=i(64348),o=i(31565),a=i(62288),l=i(88558),c=i(34250),u=i(16282);class d extends r.Point{constructor(e,t,i,r){super(e,t),this.data=i,this.square=r}}function h(e,t,i,r){const s=i+r/2;(0,n.drawRoundRect)(e,t.x-s,t.y-s,2*s,2*s,(i+r)/2),e.closePath(),e.lineWidth=r}function p(e,t,i,r){e.globalAlpha=.2,h(e,t,i,r),e.stroke(),e.globalAlpha=1}function _(e,t,i,r){h(e,t,i-r,r),e.fill(),e.stroke()}function m(e,t,i,r){e.globalAlpha=.2,e.beginPath(),e.arc(t.x,t.y,i+r/2,0,2*Math.PI,!0),e.closePath(),e.lineWidth=r,e.stroke(),e.globalAlpha=1}function f(e,t,i,r){e.beginPath(),e.arc(t.x,t.y,i-r/2,0,2*Math.PI,!0),e.closePath(),e.lineWidth=r,e.fill(),e.stroke()}class g{constructor(e){this._data=null!=e?e:null}setData(e){this._data=e}draw(e,t){if(null===this._data||!this._data.visible)return;const i=[],r=[],s=[],n=[];for(let e=0;e<this._data.points.length;++e){const t=this._data.points[e],o=this._data.backgroundColors[e];t.square?(i.push(t),r.push(o)):(s.push(t),n.push(o))}i.length&&(e.strokeStyle=this._data.color,this._drawPoints(e,t.pixelRatio,i,r,_,p)),s.length&&(e.strokeStyle=this._data.color,this._drawPoints(e,t.pixelRatio,s,n,f,m))}hitTest(e){if(null===this._data||this._data.disableInteractions)return null;const t=this._data.radius,i=(0,c.interactionTolerance)().anchor;for(let r=0;r<this._data.points.length;++r){const s=this._data.points[r];if(s.subtract(e).length()<=t+i){const e=void 0!==this._data.pointsCursorType?this._data.pointsCursorType[r]:l.PaneCursorType.Default;return new a.HitTestResult(this._data.hittestResult,{pointIndex:s.data,cursorType:e,activeItem:s.activeItem,snappingPrice:s.snappingPrice,
snappingIndex:s.snappingIndex})}}return null}doesIntersectWithBox(e){return null!==this._data&&this._data.points.some(t=>(0,s.pointInBox)(t,e))}_drawPoints(e,t,i,r,s,n){const a=(0,u.ensureNotNull)(this._data),l=a.currentPoint,h=a.radius;let p=Math.max(1,Math.floor((a.strokeWidth||2)*t));a.selected&&(p+=Math.max(1,Math.floor(t/2)));const _=Math.max(1,Math.floor(t));let m=Math.round(h*t*2);m%2!=_%2&&(m+=1);const f=_%2/2,g=(0,c.interactionTolerance)().anchor;for(let c=0;c<i.length;++c){const u=i[c];e.fillStyle=r[c];if(!((0,o.isInteger)(u.data)&&a.linePointBeingEdited===u.data)){if(s(e,new d(Math.round(u.x*t)+f,Math.round(u.y*t)+f,u.data,u.square),m/2,p),!a.disableInteractions){if(u.subtract(l).length()<=h+g){const i=Math.max(1,Math.floor(a.selectedStrokeWidth*t));let r=Math.round(h*t*2);r%2!=_%2&&(r+=1);n(e,new d(Math.round(u.x*t)+f,Math.round(u.y*t)+f,u.data,u.square),r/2,i)}}}}}}},98815:(e,t,i)=>{"use strict";var r;i.d(t,{LineEnd:()=>r}),function(e){e[e.Normal=0]="Normal",e[e.Arrow=1]="Arrow",e[e.Circle=2]="Circle"}(r||(r={}))},24090:(e,t,i)=>{"use strict";i.d(t,{PaneRendererLine:()=>l});var r=i(72927),s=i(89684),n=i(62288),o=i(99438),a=i(34250);class l{constructor(e){this._data=e}hitTest(e,t){const i=(0,a.interactionTolerance)().series+this._data.lineWidth/2;let o=0,l=this._data.items.length-1;for(;l-o>2;){const t=Math.round((l+o)/2);this._data.items[t].x<=e.x?o=t:l=t}o=Math.max(1,o-1),l=Math.min(this._data.items.length-1,l+1);for(let t=o;t<=l;++t){const o=this._data.items[t-1],a=this._data.items[t],l=o.x,c=a.x;if((0,s.distanceToSegment)(new r.Point(l,o.y),new r.Point(c,a.y),new r.Point(e.x,e.y)).distance<=i)return this._data.hittest?this._data.hittest:new n.HitTestResult(n.HitTestResult.REGULAR)}return null}draw(e,t){e.save(),e.scale(t.pixelRatio,t.pixelRatio),e.lineCap="square",e.lineJoin="round",e.strokeStyle=this._data.lineColor,e.fillStyle=this._data.lineColor,e.lineWidth=this._data.lineWidth,(0,o.setLineStyle)(e,this._data.lineStyle),(0,a.setValidLineStyle)(e,this._data.lineStyle),this._data.simpleMode?this._drawSimpleMode(e,t.pixelRatio):this._drawLines(e),e.restore()}_drawSimpleMode(e,t){if(e.beginPath(),this._walkLine(e,this._data.items,!1,NaN),e.stroke(),this._data.withMarkers){e.save(),e.scale(1/t,1/t);const i=Math.max(1,Math.floor(t))%2/2,r=(this._data.lineWidth+2)*t+i,s=2*Math.PI;e.beginPath();for(let n=this._data.items.length;n--;){const o=this._data.items[n];if(o){const n=Math.round(o.x*t)+i,a=o.y*t;e.moveTo(n,a),e.arc(n,a,r,0,s)}}e.fill(),e.restore()}}_walkLine(e,t,i,r){if(!t)return;const s=.25*this._data.barSpacing;let n,o,l,c,u;const d=a.coordinateIsValid;for(let e=0;e<t.length;e++){const i=t[e];if(d(i.y)){o=i,n=e;break}}if(void 0!==n&&void 0!==o)for(let o=n;o<t.length;o++){c=t[o],u=t[o+1]||{};const a=Math.round(c.x);if(d(c.y))if(l&&d(l.y))e.lineTo(a,c.y),i&&!d(u.y)&&e.lineTo(a,r);else if(u&&d(u.y))i?(o!==n&&e.lineTo(a,r),e.lineTo(a,c.y)):e.moveTo(a,c.y);else if(i){if(0===o)continue;o!==n&&e.lineTo(a-s,r),e.lineTo(a-s,c.y),e.lineTo(a+s,c.y),e.lineTo(a+s,r)}else e.moveTo(a-s,c.y),e.lineTo(a+s,c.y)
;l=c}}_drawLines(e){if(!this._data.items.length)return;let t,i,r;const s=.25*this._data.barSpacing,n=a.coordinateIsValid;e.beginPath();const o=this._data.items[0];o&&e.moveTo(o.x,o.y);let l,c=e.strokeStyle,u=e.lineWidth;for(let o=1;o<this._data.items.length;++o){let _,m,f;t=this._data.items[o-1],i=this._data.items[o],r=this._data.items[o+1],i.style&&!this._data.forceLineColor?(_=i.style.color,m=i.style.width,f=i.style.style):(_=this._data.lineColor,m=this._data.lineWidth,f=this._data.lineStyle),this._data.ignorePaletteLineWidth&&(m=this._data.lineWidth);(_!==c||m!==u||f!==l)&&(c=_,u=m,l=f,e.stroke(),e.beginPath(),e.strokeStyle=_,e.lineWidth=m,(0,a.setValidLineStyle)(e,f),e.moveTo(t.x,t.y)),d=t,p=r,n((h=i).y)&&(n(d.y)?e.lineTo(h.x,h.y):p&&n(p.y)?e.moveTo(h.x,h.y):(e.moveTo(h.x-s,h.y),e.lineTo(h.x+s,h.y)))}var d,h,p;e.stroke()}}},4456:(e,t,i)=>{"use strict";i.d(t,{LollipopRenderer:()=>u});var r=i(71044),s=i(72927),n=i(99438),o=i(3707),a=i(64348),l=i(14900),c=i(34250);class u{constructor(e,t,i){this._data=e,this._hittest=t,this._textWidthCache=i}draw(e,t){const i=t.pixelRatio,r=this._data.centerPoint,n=Math.round(r.x*i),o=Math.round(r.y*i),a=Math.max(1,Math.floor(i))%2/2,l=new s.Point(n+a,o-a);this._drawLollipop(e,l,t),this._drawLabel(e,l,t.pixelRatio)}hitTest(e,t){const i=(0,c.interactionTolerance)().esd,n=this._data.centerPoint.y-this._data.style.lollipop.height/2-i,o=this._data.centerPoint.x-this._data.style.lollipop.width/2-i,a=(0,s.box)(new s.Point(o,n),new s.Point(o+this._data.style.lollipop.width+2*i,n+this._data.style.lollipop.height+2*i));return(0,r.pointInBox)(e,a)?this._hittest:null}_drawLollipop(e,t,i){const r=this._data.style,s=i.pixelRatio,l=Math.max(1,Math.floor(s));let c=Math.round(r.lollipop.width*s);c%2!=l%2&&(c+=1);const u=c/2;r.lollipop.fillCircle&&r.lollipop.backgroundColor&&(e.fillStyle=r.lollipop.backgroundColor,(0,a.createCircle)(e,t.x,t.y,u),e.fill());const d=Math.round(r.lollipop.lineWidth*s);e.strokeStyle=r.lollipop.strokeStyle,e.lineWidth=d,(0,n.setLineStyle)(e,o.LINESTYLE_SOLID);const h=u-Math.round(1*s+d/2);(0,a.createCircle)(e,t.x,t.y,h),r.lollipop.fillCircle&&r.lollipop.fillStyle&&(e.fillStyle=r.lollipop.fillStyle,e.fill()),e.stroke()}_drawLabel(e,t,i){const r=this._data.style.lollipop.text,s=r.label;e.textAlign="center",e.textBaseline="middle",e.fillStyle=r.strokeStyle,e.font=r.font;const n=this._textWidthCache.yMidCorrection(e,s);e.translate(t.x,t.y+((r.deltaY||0)+n)*i),(0,l.drawScaled)(e,i,()=>{e.fillText(s,0,0)})}}},90878:(e,t,i)=>{"use strict";i.d(t,{RectangleRenderer:()=>d});var r=i(16282),s=i(72927),n=i(71044),o=i(89684),a=i(62288),l=i(50946),c=i(3707),u=i(64348);class d{constructor(e,t,i){this._data=null,this._hitTestResult=e||new a.HitTestResult(a.HitTestResult.MOVEPOINT),this._backHitTestResult=t||new a.HitTestResult(a.HitTestResult.MOVEPOINT_BACKGROUND),this._forceOverrideTransparency=Boolean(i)}setData(e){this._data=e}hitTest(e,t){if(null===this._data||this._data.points.length<2||this._data.nohittest)return null
;const[i,r]=this._getPointsInPhysicalSpace(t),n=new s.Point(r.x,i.y),a=new s.Point(i.x,r.y),l=new s.Point(e.x*t.pixelRatio,e.y*t.pixelRatio),c=this._extendAndHitTestLineSegment(l,i,n,t);if(null!==c)return c;const u=this._extendAndHitTestLineSegment(l,a,r,t);if(null!==u)return u;let d=(0,o.distanceToSegment)(n,r,l);return d.distance<=3?this._hitTestResult:(d=(0,o.distanceToSegment)(i,a,l),d.distance<=3?this._hitTestResult:this._data.fillBackground?this._hitTestBackground(l,i,r,t):null)}getColor(){const e=(0,r.ensure)(this._data);return void 0===e.transparency?e.backcolor:(0,l.generateColor)(e.backcolor,e.transparency,this._forceOverrideTransparency)}draw(e,t){if(null===this._data||this._data.points.length<2||this._data.linewidth<=0&&!this._data.fillBackground)return;e.save();const[i,r]=this._getPointsInPhysicalSpace(t),s=this._data.linewidth?Math.max(1,Math.floor(this._data.linewidth*t.pixelRatio)):0,n=this._data.fillBackground?this.getColor():void 0,o=Math.max(1,Math.floor(t.pixelRatio));(0,u.fillRectWithBorder)(e,i.x,i.y,r.x,r.y,n,this._data.color,s,c.LINESTYLE_SOLID,this._data.extendLeft,this._data.extendRight,"center",t.physicalWidth,this._data.includeRightEdge&&1===o?1:0),e.restore()}_getPointsInPhysicalSpace(e,t=0){const i=(0,r.ensureNotNull)(this._data),[n,o]=i.points,a=e.pixelRatio,l=Math.min(n.x,o.x),c=Math.max(n.x,o.x),u=Math.min(n.y,o.y),d=Math.max(n.y,o.y),h=Math.round(l*a)+t,p=Math.round(c*a)+t,_=Math.round(u*a)+t,m=Math.round(d*a)+t;return[new s.Point(h,_),new s.Point(p,m)]}_extendAndHitTestLineSegment(e,t,i,r){const s=this._extendAndClipLineSegment(t,i,r);if(null!==s){if((0,o.distanceToSegment)(s[0],s[1],e).distance<=3)return this._hitTestResult}return null}_extendAndClipLineSegment(e,t,i){const n=(0,r.ensureNotNull)(this._data);if((0,s.equalPoints)(e,t))return null;const o=i.physicalWidth,a=Math.min(e.x,t.x),l=Math.max(e.x,t.x),c=n.extendLeft?0:Math.max(a,0),u=n.extendRight?o:Math.min(l,o);return c>u||u<=0||c>=o?null:[new s.Point(c,e.y),new s.Point(u,t.y)]}_hitTestBackground(e,t,i,r){const o=this._extendAndClipLineSegment(t,i,r);return null!==o&&(0,n.pointInBox)(e,(0,s.box)(o[0],o[1]))?this._backHitTestResult:null}}},29295:(e,t,i)=>{"use strict";i.d(t,{ScaledPaneRenderer:()=>r,ScaledPaneRendererWrapper:()=>s});class r{draw(e,t){e.save(),e.scale(t.pixelRatio,t.pixelRatio),e.translate(.5,.5),this._drawImpl(e,{...t,pixelRatio:1}),e.restore()}drawBackground(e,t){e.save(),e.scale(t.pixelRatio,t.pixelRatio),e.translate(.5,.5),this._drawBackgroundImpl(e,{...t,pixelRatio:1}),e.restore()}_drawBackgroundImpl(e,t){}}class s{constructor(e){this._base=e}hitTest(e,t){return this._base.hitTest(e,t)}draw(e,t){e.save(),e.scale(t.pixelRatio,t.pixelRatio),e.translate(.5,.5),this._base.draw(e,{...t,pixelRatio:1}),e.restore()}drawBackground(e,t){e.save(),e.scale(t.pixelRatio,t.pixelRatio),e.translate(.5,.5),this._base.drawBackground&&this._base.drawBackground(e,{...t,pixelRatio:1}),e.restore()}}},15469:(e,t,i)=>{"use strict";i.d(t,{PaneRendererBaseline:()=>u})
;var r=i(72927),s=i(95196),n=i(89684),o=i(34250),a=i(4543),l=i(29295),c=i(62288);class u extends l.ScaledPaneRenderer{constructor(){super(...arguments),this._data=null}setData(e){this._data=e}hitTest(e){if(null===this._data)return null;const{items:t,topLineWidth:i,bottomLineWidth:s}=this._data,l=(0,o.interactionTolerance)().series+(i+s)/4,u=(0,a.lowerbound)(t,e,(e,t)=>e.x<=t.x),d=Math.max(1,u-1),h=Math.min(t.length-1,u+1);for(let i=d;i<=h;++i){const s=t[i-1],o=t[i],{distance:a}=(0,n.distanceToSegment)(new r.Point(s.x,s.y),new r.Point(o.x,o.y),new r.Point(e.x,e.y));if(a<=l)return new c.HitTestResult(c.HitTestResult.REGULAR)}return null}_drawImpl(e){if(null===this._data)return;const{items:t,baseLevelCoordinate:i,bottom:n,bottomFillColor1:a,bottomFillColor2:l,topFillColor1:c,topFillColor2:u,topLineColor:d,bottomLineColor:h,topLineWidth:p,bottomLineWidth:_}=this._data;if(!function(e){if(0===e.length)return!1;const t=e.findIndex(e=>(0,o.coordinateIsValid)(e.y));if(-1===t)return!1;let i=e.length-1;for(;i>t&&!(0,o.coordinateIsValid)(e[i].y);)i--;return!(t>i)}(t))return;const{topItems:m,bottomItems:f}=function(e,t){const i=[],n=[];let a=null;for(let l=0;l<e.length;l++){let c=e[l];const u=e[l+1]||{};if((0,o.coordinateIsValid)(c.y))c.y<=t&&i.push(c),c.y>=t&&n.push(c),a=c;else{if(null===a)continue;c=a}if((0,o.coordinateIsValid)(u.y)&&(c.y>t&&u.y<t||c.y<t&&u.y>t))if(Math.abs(c.x-u.x)<1){const e=new r.Point(c.x,t);i.push(e),n.push(e)}else{const e=(0,s.intersectLineSegments)(c,u,new r.Point(c.x,t),new r.Point(u.x,t));if(null!==e){const t=c.add(u.subtract(c).scaled(e));i.push(t),n.push(t)}}}return{topItems:i,bottomItems:n}}(t,i);e.lineCap="round",e.lineJoin="round",0!==m.length&&(e.beginPath(),e.moveTo(m[0].x,i),this._makeLine(e,m,!0,0),e.closePath(),e.fillStyle=this._makeLinearGradient(e,c,u,i-n,i),e.fill(),e.beginPath(),this._makeLine(e,m,!1,0),e.lineWidth=p,e.strokeStyle=d,e.stroke()),0!==f.length&&(e.beginPath(),e.moveTo(f[0].x,i),this._makeLine(e,f,!0,1),e.closePath(),e.fillStyle=this._makeLinearGradient(e,a,l,i,i+n),e.fill(),e.beginPath(),this._makeLine(e,f,!1,1),e.lineWidth=_,e.strokeStyle=h,e.stroke())}_makeLine(e,t,i,r){if(null===this._data)return;const s=t.findIndex(e=>(0,o.coordinateIsValid)(e.y));if(-1===s)return;const{barSpacing:n,baseLevelCoordinate:a}=this._data,l=.25*n;let c;const u=t.length;for(let n=s;n<u;n++){const u=t[n],d=t[n+1]||{};if((0,o.coordinateIsValid)(u.y)){if(0===r){if(c&&c.y>=a&&u.y>=a){e.moveTo(u.x,u.y);continue}}else if(c&&c.y<=a&&u.y<=a){e.moveTo(u.x,u.y);continue}if(c&&(0,o.coordinateIsValid)(c.y))e.lineTo(u.x,u.y),i&&!(0,o.coordinateIsValid)(d.y)&&e.lineTo(u.x,a);else if(d&&(0,o.coordinateIsValid)(d.y))i?(n!==s&&e.lineTo(u.x,a),e.lineTo(u.x,u.y)):e.moveTo(u.x,u.y);else if(i){if(0===n)continue;n!==s&&e.lineTo(u.x-l,a),e.lineTo(u.x-l,u.y),e.lineTo(u.x+l,u.y),e.lineTo(u.x+l,a)}else e.moveTo(u.x-l,u.y),e.lineTo(u.x+l,u.y);c=u}}}_makeLinearGradient(e,t,i,r,s){const n=e.createLinearGradient(0,r,0,s);return n.addColorStop(0,t),n.addColorStop(1,i),n}}},93828:(e,t,i)=>{"use strict";var r;i.d(t,{
StatsPosition:()=>r}),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(r||(r={}))},72472:(e,t,i)=>{"use strict";i.d(t,{StepLineDecoration:()=>r,PaneRendererStepLine:()=>f});var r,s=i(89684),n=i(62288),o=i(72927),a=i(99438),l=i(4543),c=i(34250),u=i(64348),d=i(50946);!function(e){e[e.None=0]="None",e[e.Diamonds=1]="Diamonds"}(r||(r={}));class h{initialize(e,t,i,r){var s,n,o,l;const c=e.lineStyle;t.lineCap="butt",t.lineJoin="round";const u=Math.max(Math.floor(null!==(n=null===(s=r.style)||void 0===s?void 0:s.width)&&void 0!==n?n:e.lineWidth*i.pixelRatio));void 0!==c&&(0,a.setLineStyle)(t,c);const d=u%2?.5:0;t.moveTo(Math.round(r.x*i.pixelRatio)+d,Math.round(r.y*i.pixelRatio)+d),t.strokeStyle=null!==(l=null===(o=r.style)||void 0===o?void 0:o.color)&&void 0!==l?l:e.lineColor,t.lineWidth=u}finishFragment(e){e.stroke()}hitTest(e,t,i,r,n){var a,l;const u=Math.round((i.x+r.x)/2),d=new o.Point(u,i.y),h=new o.Point(u,r.y),p=null!==(l=null===(a=i.style)||void 0===a?void 0:a.width)&&void 0!==l?l:e.lineWidth,_=(0,c.interactionTolerance)().series+p/2;return Math.min((0,s.distanceToSegment)(i,d,n).distance,(0,s.distanceToSegment)(d,h,n).distance,(0,s.distanceToSegment)(h,r,n).distance)<=_}applyColor(e,t){e.strokeStyle=t}applyLineWidth(e,t){e.lineWidth=t}drawItem(e,t,i,r){e.lineTo(i.x,i.y),void 0!==r&&(e.lineTo(r.x,i.y),e.lineTo(r.x,r.y))}}class p{constructor(){this._lineWidth=1}initialize(e,t,i,r){var s,n,o,a;this.applyColor(t,null!==(n=null===(s=r.style)||void 0===s?void 0:s.color)&&void 0!==n?n:e.lineColor),this._lineWidth=Math.max(Math.floor(null!==(a=null===(o=r.style)||void 0===o?void 0:o.width)&&void 0!==a?a:e.lineWidth*i.pixelRatio))}finishFragment(e){e.fill()}drawItem(e,t,i,r,s){if(s&&void 0!==r&&!Number.isNaN(r.y)){e.save(),e.translate(r.x,r.y),e.rotate(Math.PI/4);const i=this._scaleByLineWidth(this._lineWidth);e.scale(i,i),this._drawItemRotatedAndTranslated(e,t),e.restore()}}applyLineWidth(e,t){this._lineWidth=t}hitTest(e,t,i,r,s){var n,a;if(!r.valIsNotSameAsPrev)return!1;const l=Math.round((i.x+r.x)/2),c=new o.Point(l,r.y),u=s.subtract(c),d=Math.max(Math.floor(null!==(a=null===(n=i.style)||void 0===n?void 0:n.width)&&void 0!==a?a:e.lineWidth*t.pixelRatio));return this._hitTestTranslated(u,d)}_scaleByLineWidth(e){return Math.sqrt(e)}}class _ extends p{applyColor(e,t){e.fillStyle=t}_hitTestTranslated(e,t){return Math.abs(e.x)+Math.abs(e.y)<8*this._scaleByLineWidth(t)/2}_drawItemRotatedAndTranslated(e,t){(0,u.drawRoundRect)(e,-4,-4,8,8,2,!0)}}class m extends p{applyColor(e,t){e.fillStyle=(0,d.applyTransparency)(t,85)}_hitTestTranslated(e,t){return Math.abs(e.x)+Math.abs(e.y)<21*this._scaleByLineWidth(t)/2}_drawItemRotatedAndTranslated(e,t){(0,u.drawRoundRect)(e,-10.5,-10.5,21,21,5,!0)}}class f{constructor(){this._data=null}setData(e){this._data=e}hitTest(e,t){var i;const s=this._data;if(null===s||0===s.items.length)return null;const o=s.items,a=(0,l.lowerbound)(o,e,(e,t)=>e.x<=t.x),c=Math.max(0,a-1),u=Math.min(o.length-1,a+1),d=function(e){switch(e){case r.Diamonds:return[new h,new m];default:
return[new h]}}(null===(i=this._data)||void 0===i?void 0:i.decoration);for(let i=c;i<u;i++){const r=o[i],a=o[i+1];if(a&&d.some(i=>i.hitTest(s,t,r,a,e)))return new n.HitTestResult(n.HitTestResult.REGULAR)}return null}draw(e,t){if(null===this._data||0===this._data.items.length)return;e.save();(function(e){switch(e){case r.Diamonds:return[new h,new _,new m];default:return[new h]}})(this._data.decoration).forEach(i=>this._drawImpl(e,t,i)),e.restore()}_drawImpl(e,t,i){var r,s,n,a,l,c,u,d,h,p;if(null===this._data||0===this._data.items.length)return;const{lineWidth:_,lineColor:m,items:f}=this._data,g=f.length,v=t.pixelRatio;let S=Math.max(Math.floor(null!==(s=null===(r=f[0].style)||void 0===r?void 0:r.width)&&void 0!==s?s:_*v)),y=S%2?.5:0;i.initialize(this._data,e,t,f[0]),e.beginPath();for(let r=0;r<g;r++){const s=f[r],g=f[r+1],b=Math.round(s.x*v)+y,w=Math.round(s.y*v)+y;if(!g){i.drawItem(e,t,(0,o.point)(b,w));continue}const P=Math.round((s.x+g.x)/2*v)+y,C=Math.round(g.y*v)+y;i.drawItem(e,t,(0,o.point)(b,w),(0,o.point)(P,C),g.valIsNotSameAsPrev);const T=null!==(a=null===(n=s.style)||void 0===n?void 0:n.color)&&void 0!==a?a:m,x=null!==(c=null===(l=s.style)||void 0===l?void 0:l.width)&&void 0!==c?c:_,I=null!==(d=null===(u=g.style)||void 0===u?void 0:u.color)&&void 0!==d?d:m,L=null!==(p=null===(h=g.style)||void 0===h?void 0:h.width)&&void 0!==p?p:_,M=T!==I,E=x!==L;(M||E)&&(i.finishFragment(e),M&&i.applyColor(e,I),E&&(S=Math.max(1,Math.floor(L*v)),y=S%2?.5:0,i.applyLineWidth(e,S)),e.beginPath(),e.moveTo(P,C))}i.finishFragment(e)}}},90789:(e,t,i)=>{"use strict";i.d(t,{calculateLabelPosition:()=>p,wordWrap:()=>f,TextRenderer:()=>L});var r=i(72927),s=i(16282),n=i(71044),o=i(82755),a=i(62288),l=i(64348),c=i(99438),u=i(31565),d=i(14900),h=i(3707);function p(e,t,i,s,n){const o=.5*(t.x+i.x);let a=i.y;return t.y>i.y?(a-=e.height/2+s.y,a=Math.max(e.height/2,a)):(a+=e.height/2+s.y,a=Math.min(n-e.height/2,a)),new r.Point(o,a)}let _;function m(){const e=document.createElement("canvas");e.width=0,e.height=0,_=(0,s.ensureNotNull)(e.getContext("2d"))}function f(e,t,i){_||m(),i=(0,u.isString)(i)?parseInt(i):i,e+="";const r=!(0,u.isNumber)(i)||!isFinite(i)||i<=0?e.split(/\r\n|\r|\n|$/):e.split(/[^\S\r\n]*(?:\r\n|\r|\n|$)/);if(r[r.length-1]||r.pop(),!(0,u.isNumber)(i)||!isFinite(i)||i<=0)return r;_.font=t;const s=[];for(let e=0;e<r.length;e++){const t=r[e],n=_.measureText(t).width;if(n<=i){s.push(t);continue}const o=t.split(/([-)\]},.!?:;])|(\s+)/);let a=0;for(;o.length;){let e=~~(i/n*(o.length+2)/3);if(e<=0||_.measureText(o.slice(0,3*e-1).join("")).width<=i)for(;_.measureText(o.slice(0,3*(e+1)-1).join("")).width<=i;)e++;else for(;e>0&&_.measureText(o.slice(0,3*--e-1).join("")).width>i;);if(e>0)s.push(o.slice(0,3*e-1).join("")),o.splice(0,3*e);else{const e=o[0]+(o[1]||"");if(a=1===a?1:~~(i/_.measureText(e).width*e.length),_.measureText(e.substr(0,a)).width<=i)for(;_.measureText(e.substr(0,a+1)).width<=i;)a++;else for(;a>1&&_.measureText(e.substr(0,--a)).width>i;);a<1&&(a=1),s.push(e.substr(0,a)),o[0]=e.substr(a),o[1]=""}
if(_.measureText(o.join("")).width<=i){s.push(o.join(""));break}}}return s}function g(e,t,i){if(0===i)return e.clone();const s=(e.x-t.x)*Math.cos(i)-(e.y-t.y)*Math.sin(i)+t.x,n=(e.x-t.x)*Math.sin(i)+(e.y-t.y)*Math.cos(i)+t.y;return new r.Point(s,n)}function v(e,t){return t+2*P(e)+2*b(e)}function S(e,t){return T(e)*t+C(e)*(t-1)+2*w(e)+2*y(e)}function y(e){return void 0!==e.boxPaddingVert?e.boxPaddingVert*I(e):void 0!==e.boxPadding?e.boxPadding*I(e):T(e)/3}function b(e){return void 0!==e.boxPaddingHorz?e.boxPaddingHorz*I(e):void 0!==e.boxPadding?e.boxPadding*I(e):T(e)/3}function w(e){return(e.backgroundVertInflate||0)*I(e)}function P(e){return(e.backgroundHorzInflate||0)*I(e)}function C(e){return(e.padding||0)*I(e)}function T(e){return Math.ceil(x(e)*I(e))}function x(e){return e.fontsize||e.fontSize||30}function I(e){const t=Math.min(1,Math.max(.2,Math.min(e.scaleX||1,e.scaleY||1)));if(1===t)return t;const i=x(e);return Math.ceil(t*i)/i}class L{constructor(e,t){this._data=null,this._internalData=null,this._boxSize=null,this._polygonPoints=null,this._linesInfo=null,this._fontInfo=null,this._hittest=t||new a.HitTestResult(a.HitTestResult.MOVEPOINT,{areaName:a.AreaName.Text}),void 0!==e&&this.setData(e)}setData(e){e.horzTextAlign||(e.horzTextAlign=e.horzAlign),function(e,t){if(null===e||null===t)return null===e==(null===t);if(void 0===e.points!=(void 0===t.points))return!1;if(void 0!==e.points&&void 0!==t.points){if(e.points.length!==t.points.length)return!1;for(let s=0;s<e.points.length;++s)if(i=e.points[s],r=t.points[s],i.x!==r.x||i.y!==r.y)return!1}var i,r;return e.text===t.text&&e.vertAlign===t.vertAlign&&e.horzAlign===t.horzAlign&&e.horzTextAlign===t.horzTextAlign&&e.font===t.font&&e.offsetX===t.offsetX&&e.offsetY===t.offsetY&&e.bold===t.bold&&e.italic===t.italic&&e.fontsize===t.fontsize&&e.fontSize===t.fontSize&&e.backgroundRoundRect===t.backgroundRoundRect&&e.forceTextAlign===t.forceTextAlign&&e.wordWrapWidth===t.wordWrapWidth&&e.forceCalculateMaxLineWidth===t.forceCalculateMaxLineWidth&&e.padding===t.padding&&e.scaleY===t.scaleY&&e.scaleX===t.scaleX&&e.highlightBorder===t.highlightBorder&&e.backgroundHorzInflate===t.backgroundHorzInflate&&e.backgroundVertInflate===t.backgroundVertInflate&&e.boxPadding===t.boxPadding&&e.boxPaddingVert===t.boxPaddingVert&&e.boxPaddingHorz===t.boxPaddingHorz&&e.angle===t.angle&&e.maxHeight===t.maxHeight&&(0,u.deepEquals)(e.boxShadow,t.boxShadow)[0]}(this._data,e)?this._data=e:(this._data=e,this._internalData=null,this._boxSize=null,this._polygonPoints=null,this._linesInfo=null,this._fontInfo=null)}hitTest(e){return null===this._data||void 0===this._data.points||0===this._data.points.length?null:(0,n.pointInPolygon)(e,this._getPolygonPoints())?this._hittest:null}doesIntersectWithBox(e){return null!==this._data&&void 0!==this._data.points&&0!==this._data.points.length&&(0,n.pointInBox)(this._data.points[0],e)}measure(){if(null===this._data)return{width:0,height:0};const e=this._getBoxSize();return{width:e.boxWidth,height:e.boxHeight}}rect(){if(null===this._data)return{x:0,y:0,width:0,
height:0};const e=this._getInternalData();return{x:e.boxLeft,y:e.boxTop,width:e.boxWidth,height:e.boxHeight}}isOutOfScreen(e,t){if(null===this._data||void 0===this._data.points||0===this._data.points.length)return!0;const i=this._getInternalData();if(i.boxLeft+i.boxWidth<0||i.boxLeft>e){const i=(0,r.box)(new r.Point(0,0),new r.Point(e,t));return this._getPolygonPoints().every(e=>!(0,n.pointInBox)(e,i))}return!1}setPoints(e,t){(0,s.ensureNotNull)(this._data).points=e,this._hittest=t||new a.HitTestResult(a.HitTestResult.MOVEPOINT)}fontStyle(e){return null===this._data?"":this._getFontInfo().fontStyle}wordWrap(e,t,i){return f(e,i||this.fontStyle(),t)}draw(e,t){if(null===this._data||void 0===this._data.points||0===this._data.points.length)return;if(this.isOutOfScreen(t.cssWidth,t.cssHeight))return;const i=t.pixelRatio,r=this._getInternalData(),s=this._getRotationPoint().scaled(i);e.save(),e.translate(s.x,s.y),e.rotate(this._data.angle||0),e.translate(-s.x,-s.y);const n=this._getFontInfo().fontSize;e.textBaseline=r.textBaseLine,e.textAlign=r.textAlign,e.font=this.fontStyle();const{scaledLeft:o,scaledRight:a,scaledTop:u,scaledBottom:p}=function(e,t){const i=Math.round(e.boxLeft*t),r=Math.round(e.boxTop*t);return{scaledLeft:i,scaledRight:i+Math.round(e.boxWidth*t),scaledTop:r,scaledBottom:r+Math.round(e.boxHeight*t)}}(r,i);if(this._data.backgroundColor||this._data.borderColor||this._data.highlightBorder&&this._data.wordWrapWidth){const t=this._data.borderWidth||Math.max(n/12,1),r=Math.round(t*i),s=r/2;let d=null;if(this._data.boxShadow){e.save();const{shadowColor:t,shadowBlur:i,shadowOffsetX:r=0,shadowOffsetY:s=0}=this._data.boxShadow;e.shadowColor=t,e.shadowBlur=i,e.shadowOffsetX=r,e.shadowOffsetY=s,d=()=>{e.restore(),d=null}}if(this._data.backgroundRoundRect)this._data.backgroundColor&&((0,l.drawRoundRect)(e,o,u,a-o,p-u,this._data.backgroundRoundRect*i),e.fillStyle=this._data.backgroundColor,e.fill(),null==d||d()),this._data.borderColor&&((0,l.drawRoundRect)(e,o-s,u-s,a-o+r,p-u+r,this._data.backgroundRoundRect*i+r),e.strokeStyle=this._data.borderColor,e.lineWidth=r,e.stroke(),null==d||d());else if(this._data.backgroundColor&&(e.fillStyle=this._data.backgroundColor,e.fillRect(o,u,a-o,p-u),null==d||d()),this._data.borderColor||this._data.highlightBorder){let t;this._data.borderColor?(e.strokeStyle=this._data.borderColor,t=r):(e.strokeStyle=this._data.color,(0,c.setLineStyle)(e,h.LINESTYLE_DASHED),t=Math.max(1,Math.floor(i))),e.lineWidth=t,e.beginPath(),e.moveTo(o-t/2,u-t/2),e.lineTo(o-t/2,p+t/2),e.lineTo(a+t/2,p+t/2),e.lineTo(a+t/2,u-t/2),e.lineTo(o-t/2,u-t/2),e.stroke(),null==d||d()}}e.fillStyle=this._data.color;const _=(o+Math.round(r.textStart*i))/i,m=.05*n;let f=(u+Math.round((r.textTop+m)*i))/i;const g=C(this._data),v=this._getLinesInfo();for(const t of v.lines)(0,d.drawScaled)(e,i,()=>e.fillText(t,_,f)),f+=n+g;e.restore()}_getLinesMaxWidth(e){if(_||m(),_.textBaseline="alphabetic",_.font=this.fontStyle(),
null!==this._data&&this._data.wordWrapWidth&&!this._data.forceCalculateMaxLineWidth)return this._data.wordWrapWidth*I(this._data);let t=0;for(const i of e)t=Math.max(t,_.measureText(i).width);return t}_getInternalData(){if(null!==this._internalData)return this._internalData;const e=(0,s.ensureNotNull)(this._data),t=this._getBoxSize(),i=t.boxWidth,r=t.boxHeight,n=(0,s.ensureDefined)(e.points)[0];let a=n.y;switch(e.vertAlign){case"bottom":a-=r+e.offsetY;break;case"middle":a-=r/2;break;case"top":a+=e.offsetY}let l=n.x;const c=b(e),u=y(e),d=P(e)+c;let h;const p=a+(w(e)+u)+T(e)/2;let _;switch(e.horzAlign){case"left":l+=e.offsetX;break;case"center":l-=i/2;break;case"right":l-=i+e.offsetX}switch((0,s.ensureDefined)(e.horzTextAlign)){case"left":_="start",h=l+d,(0,o.isRtl)()&&(e.forceTextAlign?_="left":(h=l+i-d,_="right"));break;case"center":_="center",h=l+i/2;break;case"right":_="end",h=l+i-d,(0,o.isRtl)()&&e.forceTextAlign&&(_="right")}return this._internalData={boxLeft:l,boxTop:a,boxWidth:i,boxHeight:r,textStart:h-l,textTop:p-a,textAlign:_,textBaseLine:"middle"},this._internalData}_getLinesInfo(){if(null===this._linesInfo){const e=(0,s.ensureNotNull)(this._data);let t=this.wordWrap(e.text,e.wordWrapWidth);if(void 0!==e.maxHeight){const i=function(e){const t=(0,s.ensureDefined)(e.maxHeight),i=T(e),r=C(e);return Math.floor((t+r)/(i+r))}(e);t.length>i&&(t=t.slice(0,i))}this._linesInfo={linesMaxWidth:this._getLinesMaxWidth(t),lines:t}}return this._linesInfo}_getFontInfo(){if(null===this._fontInfo){const e=(0,s.ensureNotNull)(this._data),t=T(e),i=(e.bold?"bold ":"")+(e.italic?"italic ":"")+t+"px "+e.font;this._fontInfo={fontStyle:i,fontSize:t}}return this._fontInfo}_getBoxSize(){if(null===this._boxSize){const e=this._getLinesInfo(),t=(0,s.ensureNotNull)(this._data);this._boxSize={boxWidth:v(t,e.linesMaxWidth),boxHeight:S(t,e.lines.length)}}return this._boxSize}_getPolygonPoints(){if(null!==this._polygonPoints)return this._polygonPoints;if(null===this._data)return[];const e=this._data.angle||0,{boxLeft:t,boxTop:i,boxWidth:s,boxHeight:n}=this._getInternalData(),o=this._getRotationPoint();return this._polygonPoints=[g(new r.Point(t,i),o,e),g(new r.Point(t+s,i),o,e),g(new r.Point(t+s,i+n),o,e),g(new r.Point(t,i+n),o,e)],this._polygonPoints}_getRotationPoint(){const{boxLeft:e,boxTop:t,boxWidth:i,boxHeight:n}=this._getInternalData(),{horzAlign:o,vertAlign:a}=(0,s.ensureNotNull)(this._data);let l,c;switch(o){case"center":l=e+i/2;break;case"left":l=e;break;case"right":l=e+i}switch(a){case"middle":c=t+n/2;break;case"top":c=t;break;case"bottom":c=t+n}return new r.Point(l,c)}}},32579:(e,t,i)=>{"use strict";i.d(t,{drawArrow:()=>d,TrendLineRenderer:()=>h});var r=i(16282),s=i(89684),n=i(98815),o=i(62288),a=i(99438),l=i(34250),c=i(64348);function u(e,t,i,r,s){t.save(),t.fillStyle="#000000",t.beginPath(),t.arc(e.x*s,e.y*s,i*s,0,2*Math.PI,!1),t.fill(),r.strokeWidth&&(t.lineWidth=r.strokeWidth,t.stroke()),t.restore()}function d(e,t,i,r,s,n=!1){if(t.subtract(e).length()<1)return;const o=(0,l.getArrowPoints)(e,t,r,n);for(let e=0;e<o.length;++e){
const t=o[e][0],r=o[e][1];(0,a.drawLine)(i,t.x*s,t.y*s,r.x*s,r.y*s)}}class h{constructor(){this._data=null,this._hittest=new o.HitTestResult(o.HitTestResult.MOVEPOINT)}setData(e){this._data=e}setHitTest(e){this._hittest=e}draw(e,t){const i=this._data;if(null===i)return;if("points"in i&&i.points.length<2)return;if("floatPoints"in i&&i.floatPoints.length<2)return;const r=t.pixelRatio;e.lineCap="butt",e.strokeStyle=i.color,e.lineWidth=Math.max(1,Math.floor(i.linewidth*r)),(0,a.setLineStyle)(e,i.linestyle);const s="floatPoints"in i?i.floatPoints:i.points,n=s[0],o=s[1];let l=[];i.overlayLineEndings?l=[n.clone(),o.clone()]:this._drawEnds(e,[n,o],i.linewidth,r);const u=this._extendAndClipLineSegment(n,o,t);null!==u&&i.linewidth>0&&(u[0].x===u[1].x?(0,c.drawVerticalLine)(e,Math.round(u[0].x*r),u[0].y*r,u[1].y*r):u[0].y===u[1].y?(0,c.drawHorizontalLine)(e,Math.round(u[0].y*r),u[0].x*r,u[1].x*r):(0,a.drawLine)(e,u[0].x*r,u[0].y*r,u[1].x*r,u[1].y*r)),i.overlayLineEndings&&this._drawEnds(e,l,i.linewidth,r)}hitTest(e,t){const i=this._data;if(null===i)return null;if("points"in i&&i.points.length<2)return null;if("floatPoints"in i&&i.floatPoints.length<2)return null;const r=(0,l.interactionTolerance)().line,n="floatPoints"in i?i.floatPoints:i.points,o=n[0],a=n[1],c=this._extendAndClipLineSegment(o,a,t);if(null!==c){if((0,s.distanceToSegment)(c[0],c[1],e).distance<=r)return this._hittest}return null}_extendAndClipLineSegment(e,t,i){const s=(0,r.ensureNotNull)(this._data);return(0,l.extendAndClipLineSegment)(e,t,i.cssWidth,i.cssHeight,s.extendleft,s.extendright)}_drawEnds(e,t,i,s){const o=t[0],a=t[1],l=(0,r.ensureNotNull)(this._data);switch(l.leftend){case n.LineEnd.Arrow:d(a,o,e,i,s);break;case n.LineEnd.Circle:u(o,e,i,(0,r.ensureDefined)(l.endstyle),s)}switch(l.rightend){case n.LineEnd.Arrow:d(o,a,e,i,s);break;case n.LineEnd.Circle:u(a,e,i,(0,r.ensureDefined)(l.endstyle),s)}}}},72543:(e,t,i)=>{"use strict";i.d(t,{VerticalLineRenderer:()=>a});var r=i(62288),s=i(99438),n=i(64348),o=i(34250);class a{constructor(){this._data=null,this._hitTest=new r.HitTestResult(r.HitTestResult.MOVEPOINT)}setData(e){this._data=e}setHitTest(e){this._hitTest=e}hitTest(e){if(null===this._data||null===this._hitTest)return null;const t=(0,o.interactionTolerance)().line,i=Math.abs(e.x-this._data.x)<=t+this._data.linewidth/2,r=void 0===this._data.top||this._data.top-e.y<=t,s=void 0===this._data.bottom||e.y-this._data.bottom<=t;return i&&r&&s?this._hitTest:null}draw(e,t){if(null===this._data)return;if(this._data.linewidth<=0)return;if(this._data.x<-this._data.linewidth/2||this._data.x>t.cssWidth+this._data.linewidth/2)return;const i=t.pixelRatio;e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=Math.max(1,Math.floor(this._data.linewidth*i)),void 0!==this._data.linestyle&&(0,s.setLineStyle)(e,this._data.linestyle);const r=void 0!==this._data.top?Math.max(this._data.top,0):0,o=void 0!==this._data.bottom?Math.min(this._data.bottom,t.cssHeight):t.cssHeight,a=Math.round(this._data.x*i),l=Math.floor(r*i),c=Math.ceil(o*i);(0,n.drawVerticalLine)(e,a,l,c)}}
},70734:(e,t,i)=>{"use strict";i.d(t,{specialZOrderBase:()=>r,sortSourcesPreOrdered:()=>s,sortSources:()=>n});const r=1e7,s={ChartEventsSource:r+1,Dividends:r+2,Splits:r+3,Earnings:r+4,LineToolOrder:r+5,LineToolPosition:r+6,LineToolExecution:r+7,AlertLabel:r+8};function n(e){return[...e].sort((e,t)=>e.zorder()-t.zorder())}},86483:(e,t,i)=>{"use strict";var r=i(96276),s=i(4543).moveToHead,n=i(73371).LineDataSource,o=i(43854).PriceDataSource,a=i(87048).isLineTool,l=i(8412).AlertLabel,c=i(53353).PriceScale,u=i(36436).createPriceScaleSelectionStrategy,d=i(99942).PaneBase,h=i(70734).sortSources;class p extends d{constructor(e,t,i,s){super(e,t,i,s),this.m_timeScale=e,this.m_mainDataSource=null,this._properties=t,this._model=i,this._destroyed=new r,i.properties().priceScaleSelectionStrategyName.listeners().subscribe(null,function(e){this._priceScaleSelectionStrategy=u(e.value()),this._priceScaleSelectionStrategy.apply(this)}.bind(this)),this.m_timeScale.barSpacingChanged().subscribe(this,function(){this.m_mainDataSource===this._model.mainSeries()&&this._recalculatePriceScaleByScaleRatio(this.m_mainDataSource.priceScale())}.bind(this)),t.topMargin.listeners().subscribe(this,p.prototype._updateMargins),t.bottomMargin.listeners().subscribe(this,p.prototype._updateMargins),this._updateMargins(),this._maximized=!1}destroy(){this._properties.topMargin.listeners().unsubscribe(this,p.prototype._updateMargins),this._properties.bottomMargin.listeners().unsubscribe(this,p.prototype._updateMargins),this._model.properties().priceScaleSelectionStrategyName.listeners().unsubscribeAll(this),this.m_timeScale.barSpacingChanged().unsubscribeAll(this),this._leftPriceScales.concat(this._rightPriceScales).forEach((function(e){e.modeChanged().unsubscribeAll(this),e.priceRangeChanged().unsubscribeAll(this),e.internalHeightChanged().unsubscribeAll(this)}),this);for(var e=0;e<this.m_dataSources.length;e++){var t=this.m_dataSources[e];this.removeSourceFromPriceScale(t),t.destroy&&t.destroy()}this._destroyed.fire()}model(){return this._model}leftPriceScales(){return this._leftPriceScales}rightPriceScales(){return this._rightPriceScales}visibleLeftPriceScales(){var e=this._model.priceScaleSlotsCount();if(this._leftPriceScales.length>e.left){var t=s(this._leftPriceScales,this.mainDataSource().priceScale());return t.splice(e.left),t}return this._leftPriceScales}visibleRightPriceScales(){var e=this._model.priceScaleSlotsCount();if(this._rightPriceScales.length>e.right){var t=s(this._rightPriceScales,this.mainDataSource().priceScale());return t.splice(e.right),t}return this._rightPriceScales}timeScale(){return this.m_timeScale}_processMainSourceChange(){var e;if(null===this.m_mainDataSource)for(var t=0;t<this.m_dataSources.length;t++){if(!(!((s=this.m_dataSources[t])instanceof o)||this.isOverlay(s)||s.properties().linkedToSeries&&s.properties().linkedToSeries.value()||s instanceof l)){this.m_mainDataSource=s,e=!0;break}}if(this.m_mainDataSource&&e){var i=[];for(t=0;t<this.m_dataSources.length;t++){(s=this.m_dataSources[t])instanceof n&&i.push(s)}i=h(i)
;for(t=0;t<i.length;t++)this.move(i[t],this.m_mainDataSource.priceScale(),!0)}else if(!this.m_mainDataSource||this.isOverlay(this.m_mainDataSource)&&0===this.nonOverlayPricesSourcesCount()){var r=null;if(this.m_dataSources.includes(this._model.mainSeries()))r=this._model.mainSeries();else for(t=0;t<this.m_dataSources.length;t++){var s;if((s=this.m_dataSources[t])instanceof o&&this.isOverlay(s)&&s.showInObjectTree()){r=s;break}}if(null!==r){var a=this.m_mainDataSource===r;this.m_mainDataSource=r;var c=this.createNewPriceScaleIfPossible();if(a&&r===this._model.mainSeries()){var u=r.priceScale();this._model.children(r,!0).forEach(e=>{this.removeSourceFromPriceScale(e),c.addDataSource(e),e.setPriceScale(c)}),this.removePriceScale(u)}this.move(r,c,!0),this.recalculatePriceScale(r.priceScale())}}}startScrollPrice(e,t){e.startScroll(t)}scrollPriceTo(e,t){e.scrollTo(t),this.updateAllViews()}endScrollPrice(e){e.endScroll()}setPriceAutoScale(e,t){e.setMode({autoScale:t}),this.timeScale().isEmpty()||this.recalculatePriceScale(e)}defaultPriceScale(){var e=this.m_mainDataSource?this.m_mainDataSource.priceScale():null;return null===e&&(e=new c(this._model.properties().scalesProperties)),e}_priceScaleIsPrice(e){var t=e.mainSource();return!!t&&(!!TradingView.isInherited(t.constructor,TradingView.Series)||!!TradingView.isInherited(t.constructor,TradingView.Study)&&t.metaInfo().is_price_study)}findSuitableScale(e,t,i){return this._priceScaleSelectionStrategy.findSuitableScale(this,e,t,i)}createNewPriceScaleIfPossible(){return this._priceScaleSelectionStrategy.createNewPriceScaleIfPossible(this)}canCreateNewPriceScale(){return this._priceScaleSelectionStrategy.canCreateNewPriceScale(this)}mainDataSource(){return this.m_mainDataSource}recalculate(){this.recalculatePriceScale(this.m_rightPriceScale),this.recalculatePriceScale(this.m_leftPriceScale);for(var e=0;e<this.m_dataSources.length;e++){var t=this.m_dataSources[e];this.isOverlay(t)&&!a(t)&&this.recalculatePriceScale(t.priceScale())}this.updateAllViews(),this._model.updatePane(this)}createDrawingsCaches(){0}clearDrawingCaches(){0}_invalidateSourcesCache(){this._cachedOrderedSources.clear(),this._leftPriceScales.forEach((function(e){e.invalidateSourcesCache()})),this._rightPriceScales.forEach((function(e){e.invalidateSourcesCache()}))}onDestroyed(){return this._destroyed}clearSeries(e){for(var t=this.m_dataSources.length-1;t>=0;t--)TradingView.isInherited(this.m_dataSources[t].constructor,TradingView.Series)&&this._removeSourceFromCollections(t,e)}nonOverlayPricesSourcesCount(){return this.m_dataSources.filter((function(e){return(!e.properties().linkedToSeries||!e.properties().linkedToSeries.value())&&(TradingView.isInherited(e.constructor,o)&&e.showInObjectTree()&&!this.isOverlay(e))}),this).length}canHaveMoreNoScaleSources(){return this.nonOverlayPricesSourcesCount()>1}actionNoScaleIsEnabled(e){return!(!this.isOverlay(e)&&TradingView.isInherited(e.constructor,o))||this.canHaveMoreNoScaleSources()}executionsPositionController(){return null}setMaximized(e){this._maximized=e}
isMaximized(){return this._maximized}properties(){return this._properties}priceScaleRatio(){return this._currentPriceScaleRatio}getPriceScaleById(e){var t=this.m_dataSources.find((function(t){return null!==t.priceScale()&&t.priceScale().id()===e}));return void 0===t?null:t.priceScale()}setPriceScaleSelectionStrategy(e){this._priceScaleSelectionStrategy=e,e.apply(this)}priceScaleIndex(e,t){switch(t){case"left":return this.leftPriceScales().indexOf(e);case"right":return this.rightPriceScales().indexOf(e)}}}p.DEFAULT_STRETCH_FACTOR=1e3,p.PANE_ANIMATION_DURATION=500,t.Pane=p},95033:(e,t,i)=>{"use strict";i.d(t,{PinePerm:()=>l});i(18184);var r=i(85864),s=i(18184);const n="user__username";function o(e){const t=new FormData;return t.append("pine_id",e.pine_id),t.append("username_recip",e.username_recip),e.expiration&&t.append("expiration",e.expiration),t}class a extends Error{constructor(e,t,i){super(e),this.title=i,this.code=t}}var l;!function(e){let t;!function(e){e.UserDoesNotHavePermission="user_does_not_have_permission",e.UserIsBanned="user_is_banned",e.Exists="exists"}(t=e.StatusCode||(e.StatusCode={})),e.add=function(e){return window.is_authenticated?(0,r.fetch)("/pine_perm/add/",{body:o(e),credentials:"include",method:"POST"}).then(e=>e.json().then(t=>{const i=t.status;if("exists"===i)throw new a(i,i);if(!e.ok)throw new a(t.detail,t.code,t.title)})):Promise.reject()},e.remove=function(e,t){return window.is_authenticated?s.ajax({data:{pine_id:t,username_recip:e},dataType:"json",type:"POST",url:"/pine_perm/remove/"}):s.Deferred().reject()},e.listUsers=function(e){const{pineId:t,next:i,prev:r,username:o,orderBy:a=n,limit:l=10}=e;return!window.is_authenticated||r&&!i?s.Deferred().reject():s.ajax({data:{pine_id:t,username:o},dataType:"json",type:"POST",url:i||r?""+i:`/pine_perm/list_users/?limit=${l}&order_by=${a}`})},e.listScripts=function(){return window.is_authenticated?s.ajax({dataType:"json",type:"POST",url:"/pine_perm/list_scripts/"}):s.Deferred().reject()},e.modifyUserExpiration=function(e){return window.is_authenticated?(0,r.fetch)("/pine_perm/modify_user_expiration/",{body:o(e),credentials:"include",method:"POST"}).then(e=>{if(!e.ok)return e.json().then(e=>{throw Error(e.detail)})}):Promise.reject()},e.numberOfUsersWithAccess=function(e){return window.is_authenticated?(0,r.fetch)("/pine_perm/list_users/?pine_id="+e,{method:"GET"}).then(e=>e.ok?e.json():e.json().then(e=>{throw new a(e.detail)})):Promise.reject()}}(l||(l={}))},40989:(e,t,i)=>{"use strict";i.r(t),i.d(t,{PlotRowSearchMode:()=>a,PlotList:()=>u,mergeMinMax:()=>d,mergePlotRows:()=>h});var r=i(16282),s=i(4543),n=i(41657);const o=(0,i(87380).getLogger)("Chart.PlotList");var a;!function(e){e[e.NearestLeft=-1]="NearestLeft",e[e.Exact=0]="Exact",e[e.NearestRight=1]="NearestRight"}(a||(a={}));function l(e){return e.index}function c(e){return e.value[0]}class u{constructor(e=null,t=null){this._items=[],this._start=0,this._end=0,this._shareRead=!1,this._minMaxCache=new Map,this._rowSearchCacheByIndex=new Map,
this._rowSearchCacheByIndexWithoutEmptyValues=new Map,this._rowSearchCacheByTime=new Map,this._rowSearchCacheByTimeWithoutEmptyValues=new Map,this._plotFunctions=e||new Map,this._emptyValuePredicate=t}clear(){this._items=[],this._start=0,this._end=0,this._shareRead=!1,this._minMaxCache.clear(),this._invalidateSearchCaches()}first(){return this.size()>0?this._items[this._start]:null}last(){return this.size()>0?this._items[this._end-1]:null}firstIndex(){return this.size()>0?this._indexAt(this._start):null}lastIndex(){return this.size()>0?this._indexAt(this._end-1):null}size(){return this._end-this._start}isEmpty(){return 0===this.size()}contains(e){return null!==this.search(e,a.Exact)}valueAt(e){const t=this.search(e);return null!==t?t.value:null}add(e,t){if(this._shareRead)return o.logDebug("add: readonly collection modification attempt"),!1;const i={index:e,value:t},r=this._nonCachedSearch(e,a.Exact,l);return this._invalidateSearchCaches(),null===r?(this._items.splice(this._lowerbound(e,l),0,i),this._start=0,this._end=this._items.length,!0):(this._items[r]=i,!1)}search(e,t=a.Exact,i){return this._searchImpl(e,t,this._rowSearchCacheByIndex,this._rowSearchCacheByIndexWithoutEmptyValues,l,i)}searchByTime(e,t=a.Exact,i){return this._searchImpl(e,t,this._rowSearchCacheByTime,this._rowSearchCacheByTimeWithoutEmptyValues,c,i)}fold(e,t){let i=t;for(let t=this._start;t<this._end;++t){i=e(this._indexAt(t),this._valueAt(t),i)}return i}findFirst(e,t){const i=void 0!==t&&Math.min(this._start+t,this._end)||this._end;for(let t=this._start;t<i;++t){const i=this._indexAt(t),r=this._valueAt(t);if(e(i,r))return{index:i,value:r}}return null}findLast(e,t){const i=void 0!==t&&Math.max(this._end-t,this._start)||this._start;for(let t=this._end-1;t>=i;--t){const i=this._indexAt(t),r=this._valueAt(t);if(e(i,r))return{index:i,value:r}}return null}each(e){for(let t=this._start;t<this._end;++t){if(e(this._indexAt(t),this._valueAt(t)))break}}reduce(e,t){let i=t;for(let t=this._start;t<this._end;++t){i=e(i,this._indexAt(t),this._valueAt(t))}return i}range(e,t){const i=new u(this._plotFunctions,this._emptyValuePredicate);return i._items=this._items,i._start=this._lowerbound(e,l),i._end=this._upperbound(t),i._shareRead=!0,i}rangeIterator(e,t){const i=this._lowerbound(e,l),r=this._upperbound(t);if(i===r)return{hasNext:()=>!1,next:()=>{throw new Error("Invalid operation")}};let s=i-1;return{hasNext:()=>s<r-1,next:()=>(s+=1,this._items[s])}}minMaxOnRangeCached(e,t,i){if(this.isEmpty())return null;let r=null;for(const s of i){r=d(r,this._minMaxOnRangeCachedImpl(e-s.offset,t-s.offset,s.name))}return r}minMaxOnRange(e,t,i){if(this.isEmpty())return null;let r=null;for(const s of i){r=d(r,this._minMaxOnRange(e-s.offset,t-s.offset,s.name))}return r}merge(e){return this._shareRead?(o.logDebug("merge: readonly collection modification attempt"),
null):0===e.length?null:this.isEmpty()||e[e.length-1].index<this._items[0].index?this._prepend(e):e[0].index>this._items[this._items.length-1].index?this._append(e):1===e.length&&e[0].index===this._items[this._items.length-1].index?(this._updateLast(e[0]),e[0]):this._merge(e)}addTail(e,t=!1){let i=0;t&&this._end-this._start>0&&(i=1,this._items[this._end-this._start-1].value=e[0].value);for(let t=i;t<e.length;++t){const i=e[t],r=this.lastIndex();if(null===r){o.logError("Can't add tail to the empty plotlist");break}this.add(r+1,i.value)}this._invalidateSearchCaches()}move(e){if(this._shareRead)return void o.logDebug("move: readonly collection modification attempt");if(0===e.length)return;const t=this._items.slice();for(const i of e){const e=this._bsearch(i.old,l);if(null!==e&&void 0!==t[e])if(i.new===n.INVALID_TIME_POINT_INDEX)t[e]=void 0;else{t[e]={index:i.new,value:t[e].value};const r=this._bsearch(i.new,l);if(null!==r){const e=t[r];void 0!==e&&e.index===i.new&&(t[r]=void 0)}}}this._items=t.filter(e=>void 0!==e).sort((e,t)=>e.index-t.index),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._start=0,this._end=this._items.length}remove(e){if(this._shareRead)return o.logDebug("remove: readonly collection modification attempt"),null;const t=this._nonCachedSearch(e,a.NearestRight,l);if(null===t)return null;const i=this._items.splice(t);return this._end=this._items.length,this._minMaxCache.clear(),this._invalidateSearchCaches(),i.length>0?i[0]:null}state(){return{start:this._start,end:this._end,data:this._items,shareread:this._shareRead}}restoreState(e){e?(this._start=e.start,this._end=e.end,this._shareRead=e.shareread,this._items=e.data,this._minMaxCache.clear(),this._invalidateSearchCaches()):this.clear()}_indexAt(e){return this._items[e].index}_valueAt(e){return this._items[e].value}_length(){return this._items.length}_searchImpl(e,t,i,r,s,n){const o=void 0!==n?i:r,a=void 0!==n?1e4*(t+1)+n:t;let l=o.get(e);if(void 0!==l){const e=l.get(a);if(void 0!==e)return e}const c=this._nonCachedSearch(e,t,s,n);if(null===c)return null;const u={index:this._indexAt(c),value:this._valueAt(c)};return void 0===l&&(l=new Map,o.set(e,l)),l.set(a,u),u}_nonCachedSearch(e,t,i,r){const s=this._lowerbound(e,i),n=s===this._end||e!==i(this._items[s]);if(n&&t!==a.Exact)switch(t){case a.NearestLeft:return this._searchNearestLeft(s,r);case a.NearestRight:return this._searchNearestRight(s,r);default:throw new TypeError("Unknown search mode")}if(void 0===r||n||t===a.Exact)return n?null:s;switch(t){case a.NearestLeft:return this._nonEmptyNearestLeft(s,r);case a.NearestRight:return this._nonEmptyNearestRight(s,r);default:throw new TypeError("Unknown search mode")}}_nonEmptyNearestRight(e,t){const i=(0,r.ensure)(this._emptyValuePredicate),s=(0,r.ensure)(t);for(;e<this._end&&i(this._valueAt(e),s);)e+=1;return e===this._end?null:e}_nonEmptyNearestLeft(e,t){const i=(0,r.ensureNotNull)(this._emptyValuePredicate),s=(0,r.ensure)(t);for(;e>=this._start&&i(this._valueAt(e),s);)e-=1;return e<this._start?null:e}_searchNearestLeft(e,t){
if(e===this._start)return null;const i=e-1,r=i!==this._end?i:null;return void 0!==t&&null!==r?this._nonEmptyNearestLeft(r,t):r}_searchNearestRight(e,t){const i=e,r=i!==this._end?i:null;return void 0!==t&&null!==r?this._nonEmptyNearestRight(r,t):r}_bsearch(e,t){const i=this._lowerbound(e,t);return i!==this._end&&e===t(this._items[i])?i:null}_lowerbound(e,t){return(0,s.lowerbound)(this._items,e,(e,i)=>t(e)<i,this._start,this._end)}_upperbound(e){return(0,s.upperbound)(this._items,e,(e,t)=>t.index>e,this._start,this._end)}_plotMinMax(e,t,i){let r=null;const s=this._plotFunctions.get(i);if(void 0===s)throw new Error(`Plot "${i}" is not registered`);for(let i=e;i<t;i++){const e=s(this._items[i].value);null==e||Number.isNaN(e)||(null===r?r={min:e,max:e}:(e<r.min&&(r.min=e),e>r.max&&(r.max=e)))}return r}_invalidateCacheForRow(e){const t=Math.floor(e.index/30);this._minMaxCache.forEach(e=>e.delete(t))}_prepend(e){return(0,r.assert)(!this._shareRead,"collection should not be readonly"),(0,r.assert)(0!==e.length,"plotRows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=e.concat(this._items),this._start=0,this._end=this._items.length,e[0]}_append(e){return(0,r.assert)(!this._shareRead,"collection should not be readonly"),(0,r.assert)(0!==e.length,"plotRows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=this._items.concat(e),this._start=0,this._end=this._items.length,e[0]}_updateLast(e){(0,r.assert)(!this.isEmpty(),"plot list should not be empty");const t=this._items[this._end-1];(0,r.assert)(t.index===e.index,"last row index should match new row index"),this._invalidateCacheForRow(e),this._invalidateSearchCaches(),this._items[this._end-1]=e}_merge(e){return(0,r.assert)(0!==e.length,"plot rows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=h(this._items,e),this._start=0,this._end=this._items.length,e[0]}_minMaxOnRangeCachedImpl(e,t,i){if(this.isEmpty())return null;let s=null;const n=(0,r.ensureNotNull)(this.firstIndex()),o=(0,r.ensureNotNull)(this.lastIndex()),a=Math.max(e,n),l=Math.min(t,o),c=30*Math.ceil(a/30),u=Math.max(c,30*Math.floor(l/30));s=d(s,this._minMaxOnRange(a,Math.min(c,t,l),i));let h=this._minMaxCache.get(i);void 0===h&&(h=new Map,this._minMaxCache.set(i,h));for(let e=Math.max(c+1,a);e<u;e+=30){const t=Math.floor(e/30);let r=h.get(t);if(void 0===r){const e=30*t,s=30*(t+1)-1;r=this._minMaxOnRange(e,s,i),h.set(t,r)}s=d(s,r)}s=d(s,this._minMaxOnRange(u,l,i));return s}_minMaxOnRange(e,t,i){return this._plotMinMax(this._lowerbound(e,l),this._upperbound(t),i)}_invalidateSearchCaches(){this._rowSearchCacheByIndex.clear(),this._rowSearchCacheByIndexWithoutEmptyValues.clear(),this._rowSearchCacheByTime.clear(),this._rowSearchCacheByTimeWithoutEmptyValues.clear()}}function d(e,t){if(null===e)return t;if(null===t)return e;return{min:Math.min(e.min,t.min),max:Math.max(e.max,t.max)}}function h(e,t){const i=function(e,t){const i=e.length,r=t.length;let s=i+r,n=0,o=0
;for(;n<i&&o<r;)e[n].index<t[o].index?n++:e[n].index>t[o].index?o++:(n++,o++,s--);return s}(e,t),r=new Array(i);let s=0,n=0;const o=e.length,a=t.length;let l=0;for(;s<o&&n<a;)e[s].index<t[n].index?(r[l]=e[s],s++):e[s].index>t[n].index?(r[l]=t[n],n++):(r[l]=t[n],s++,n++),l++;for(;s<o;)r[l]=e[s],s++,l++;for(;n<a;)r[l]=t[n],n++,l++;return r}},83748:(e,t,i)=>{"use strict";i.d(t,{PrePostMarket:()=>f,defaultPrePostMarketPreferences:()=>m});var r=i(93669),s=i(3707),n=i(63956),o=i(91513),a=i(78539);class l extends a.PriceLineAxisView{constructor(e,t){super(),this._model=e,this._source=t}_value(){const e=this._model.mainSeries(),t=e.priceScale(),i=e.firstValue();if(null===i)return{noData:!0};const r=this._source.price(),s=this._source.currentSession();if(null===r||"pre_market"!==s&&"post_market"!==s)return{noData:!0};const n=t.priceToCoordinate(r,i);return{noData:!1,floatCoordinate:n,coordinate:n,color:"",formattedPricePercentage:"",formattedPriceAbsolute:"",text:"",index:0}}_priceLineColor(e){const t=this._source.properties().childs();return"pre_market"===this._source.currentSession()?t.preMarketColor.value():t.postMarketColor.value()}_lineWidth(){return this._source.properties().childs().lineWidth.value()}_lineStyle(){return this._source.properties().childs().lineStyle.value()}_isVisible(){if(!this._source.canBeVisibleOnSymbolAndInterval()||!this._model.properties().scalesProperties.showPrePostMarketPriceLabel.value())return!1;const e=this._source.price(),t=this._source.currentSession();return null!==e&&("pre_market"===t||"post_market"===t)}}var c=i(20220),u=i(32552);class d extends u.PriceAxisView{constructor(e,t){super(),this._model=e,this._source=t}_updateRendererData(e,t,i){if(e.visible=!1,t.visible=!1,!this._model.properties().scalesProperties.showPrePostMarketPriceLabel.value())return;const r=this._model.mainSeries(),s=r.priceScale(),n=r.firstValue();if(null===n)return;if(!this._source.canBeVisibleOnSymbolAndInterval())return;const o=this._source.price(),a=this._source.currentSession();if(null==o||"pre_market"!==a&&"post_market"!==a)return;e.visible=!0,t.visible=!0,e.text=s.formatPriceAbsolute(o),t.text="pre_market"===a?(0,c.t)("Pre"):(0,c.t)("Post"),i.coordinate=s.priceToCoordinate(o,n);const l=this._source.properties().childs();i.background="pre_market"===a?l.preMarketColor.value():l.postMarketColor.value()}}var h=i(17627),p=i(62288);class _ extends h.HorizontalLinePaneView{constructor(e,t,i){super(),this._model=e,this._source=t;const r={doubleClickHandler:i,doubleTapHandler:i};this._lineRenderer.setHitTest(new p.HitTestResult(p.HitTestResult.REGULAR,r))}_updateImpl(){const e=this._lineRendererData;e.visible=!1;const t=this._model.mainSeries(),i=this._source.properties().childs();if(!i.visible.value()||!t.isVisible())return;const r=t.priceScale(),s=t.firstValue();if(null===s)return;if(!this._source.canBeVisibleOnSymbolAndInterval())return;const n=this._source.price(),o=this._source.currentSession();null===n||"pre_market"!==o&&"post_market"!==o||(e.visible=!0,e.y=r.priceToCoordinate(n,s),
e.linestyle=i.lineStyle.value(),e.linewidth=i.lineWidth.value(),e.color="pre_market"===o?i.preMarketColor.value():i.postMarketColor.value())}}const m={visible:!0,lineStyle:s.LINESTYLE_DOTTED,lineWidth:1,preMarketColor:"#fb8c00",postMarketColor:r.colorsPalette["color-tv-blue-500"]};class f extends o.CustomSourceBase{constructor(e,t,i){super(e,t),this._extraHoursPrice=null,this._currentSession="holiday",this._quotesProvider=t.mainSeries().quotesProvider(),this._prePostMarketLinePaneView=new _(t,this,i),this._prePostPriceAxisView=new d(t,this),this._prePostLabelPaneView=new n.PanePriceAxisView(this._prePostPriceAxisView,t.mainSeries(),t),this._prePostPriceLineAxisView=new l(t,this),this._quotesProvider.quotesUpdate().subscribe(this,this._updateQuotes),this._updateQuotes()}destroy(){this._quotesProvider.quotesUpdate().unsubscribeAll(this)}paneViews(e){return this._isMainSourcePane(e)?[this._prePostMarketLinePaneView]:[]}labelPaneViews(e){return this._isMainSourcePane(e)?[this._prePostLabelPaneView]:[]}priceAxisViews(e,t){return this._isMainSourcePane(e)?e.findTargetPriceAxisViews(this,t,[this._prePostPriceAxisView],[this._prePostPriceLineAxisView]):[]}priceScale(){return this._model.mainSeries().priceScale()}updateAllViews(){this._prePostMarketLinePaneView.update(),this._prePostPriceAxisView.update(),this._prePostPriceLineAxisView.update(),this._prePostLabelPaneView.update()}price(){return this._extraHoursPrice}currentSession(){return this._currentSession}canBeVisibleOnSymbolAndInterval(){return!this._model.mainSeries().isPrePostMarketPricesForbiddenProperty().value()}properties(){return this._model.mainSeries().properties().childs().prePostMarket}_updateQuotes(){const e=this._quotesProvider.quotes();null===e?this._extraHoursPrice=null:(this._extraHoursPrice=e.rtc,void 0!==e.current_session&&(this._currentSession=e.current_session));const t=this._model.mainSeries().properties().childs().prePostMarket.childs().visible.value(),i=this._model.properties().scalesProperties.showPrePostMarketPriceLabel.value();this.canBeVisibleOnSymbolAndInterval()&&(t||i)&&(this.updateAllViews(),this._model.updateSource(this))}_isMainSourcePane(e){return this._model.paneForSource(this._model.mainSeries())===e}}},8155:(e,t,i)=>{"use strict";var r=i(57233);function s(e){var t=JSON.stringify(e);return t=t.replace(/'/g,"\\'")}e.exports={formatCallstudyArg:s,prepareCallStudyArgs:function(e,t){var i={};if(t.isTVScript){var n=t.defaults.inputs.text;i.text=r.patchILTemplate(n,t,e)}else for(var o=Object.keys(e),a=o.length-1;a>=0;a--){var l=o[a],c=e[l]?e[l].id:null;c&&e[c]&&(i[c]=e[c])}return s(i)}}},32552:(e,t,i)=>{"use strict";i.d(t,{PriceAxisView:()=>p});var r=i(72927),s=i(71044),n=i(748),o=i(50946),a=i(82755),l=i(14900),c=i(62288),u=i(64348),d=i(88558);class h{constructor(e,t){this.setData(e,t)}setData(e,t){this._data=e,this._commonData=t}draw(e,t,i,r,s,n,c){var d,h,p;const _=this._data;if(!_.visible||this._isOutOfScreen(t,s))return;const m=this._commonData;e.save(),e.font=t.font
;const f=void 0!==_.labelIcon,g=_.ignoreOffset?0:t.offsetSize,v=t.borderSize,S=t.paddingTop+m.additionalPaddingTop,y=t.paddingBottom+m.additionalPaddingBottom,b=t.paddingInner,w=t.paddingOuter,P=t.fontSize;let C=_.text,T=_.textColor||m.textColor,x=_.secondLine||"",I=m.secondLineTextColor||T,L=_.thirdLine||"";const M=m.thirdLineTextColor||T;0===x.length&&(x=L,I=M,L=""),0===C.length&&(C=x,T=I,x=L,I=M,L="");const E=i.yMidCorrection(e,C)*c,A=Math.ceil(i.measureText(e,C)),k=P+S+y,D=Boolean(x),R=Boolean(L),N=D?Math.ceil(i.measureText(e,x)):0,O=R?Math.ceil(i.measureText(e,L)):0,V=v+b+w+A+g,B=N>0?v+b+w+N+g:0,F=O>0?v+b+w+O+g:0,W=Math.max(V,B,F),U=Math.max(1,Math.floor(c));let H=Math.round(k*c);H%2!=U%2&&(H+=1);const z=Math.round((P+t.lineSpacing)*c),j=Math.round(2*(P+t.lineSpacing)*c),Y=Math.max(1,Math.floor(v*c)),G=_.separatorVisible?Y:0,q=_.borderVisible?Y:0,X=f?H:Math.round(W*c),$=Math.round(g*c),K=Math.ceil(r*c),J=Math.ceil(b*c),Z=Math.round((null!==(d=m.fixedCoordinate)&&void 0!==d?d:m.coordinate)*c)-Math.floor(.5*c),Q=Math.floor(Z+U/2-H/2),ee=Q+H,te="right"===n,ie=te?K-G:G,re=K;let se,ne=ie;const oe=(0,o.resetTransparency)(null!==(h=_.backgroung)&&void 0!==h?h:m.background);e.fillStyle=oe;const ae=2*c;if(e.textAlign=te?"right":"left",e.textBaseline="middle",te?(ne=ie-X,se=ie-$-J-1):(ne=ie+X,se=ie+$+J),C||f){const i=R?H+j:D?H+z:H;if(((t,r,s)=>{te?(0,u.drawRoundRectWithInnerBorder)(e,ne,Q,X,i,t,[ae,0,0,ae],q,r,s):(0,u.drawRoundRectWithInnerBorder)(e,ie,Q,X,i,t,[0,ae,ae,0],q,r,s)})(oe,null!==(p=m.borderColor)&&void 0!==p?p:oe,m.borderStyle),_.separatorVisible&&(e.fillStyle=t.paneBackgroundColor,e.fillRect(te?re-G:0,Q,G,ee-Q)),f){switch(_.labelIcon){case 0:this._drawPlusIcon(e,ie,ne,Q,Z,ee,U);break;case 1:this._drawClockIcon(e,ie,ne,Z,U,c)}return}e.save(),e.translate(se,(Q+ee)/2+E),(0,l.drawScaled)(e,c,()=>{e.fillStyle=T,e.fillText(C,0,0)}),e.restore()}D&&(e.fillStyle=I,e.save(),e.translate(se,(Q+ee)/2+E+z),(0,l.drawScaled)(e,c,()=>{e.fillText((0,a.startWithLTR)(x),0,0)}),e.restore()),R&&(e.fillStyle=M,e.save(),e.translate(se,(Q+ee)/2+E+j),(0,l.drawScaled)(e,c,()=>{e.fillText((0,a.startWithLTR)(L),0,0)}),e.restore()),e.restore()}height(e){const t=this._lines();return this._data.visible&&0!==t?t*e.fontSize+(t-1)*e.lineSpacing+e.paddingTop+this._commonData.additionalPaddingTop+e.paddingBottom+this._commonData.additionalPaddingBottom:0}hitTest(e){const t=this._data.hitTestData;if(void 0===t||!this._data.visible)return null;const i=(0,n.lastEventIsTouch)()?10:0,o=(0,r.box)(new r.Point(t.xl-i,t.y-i),new r.Point(t.xl+t.containerWidth+i,t.y+t.containerHeight+i)),a=t.left&&(0,s.pointInBox)(e,o),l=(0,r.box)(new r.Point(t.xr-i,t.y-i),new r.Point(t.xr+t.containerWidth+i,t.y+t.containerHeight+i)),u=t.right&&(0,s.pointInBox)(e,l);if(a||u){const i=a?"left":"right";return new c.HitTestResult(c.HitTestResult.CUSTOM,{cursorType:d.PaneCursorType.Default,clickHandler:void 0===t.clickHandler?void 0:t.clickHandler.bind(this,e,i),tapHandler:void 0===t.clickHandler?void 0:t.clickHandler.bind(this,e,i),tooltip:t.tooltip})}return null}
_drawPlusIcon(e,t,i,r,s,n,o){e.fillStyle=this._commonData.textColor,e.strokeStyle=this._commonData.textColor,e.lineWidth=o;const a=Math.abs(t-i);let l=Math.round(.35*a);l%2!=o%2&&(l+=1);let c=Math.round(.65*a);c%2!=o%2&&(c+=1);const u=Math.floor((a-l)/2),d=Math.min(t,i),h=d+Math.floor(a/2-o/2);e.fillRect(d+u,s,l,o),e.fillRect(h,r+u,o,l),e.beginPath(),e.arc(h+o/2,s+o/2,c/2,0,2*Math.PI,!1),e.stroke()}_drawClockIcon(e,t,i,r,s,n){e.fillStyle=this._commonData.textColor,e.lineWidth=s;const o=Math.abs(t-i);let a=Math.round(.35*o);a%2!=s%2&&(a+=1);let l=Math.round(.65*o);l%2!=s%2&&(l+=1);const c=Math.min(t,i)+Math.floor(o/2-s/2);e.save(),e.translate(c+s/2-l/2,r+s/2-l/2),e.scale(n,n);const u=new Path2D("M7.5 0.8a1 1 0 0 0 0 13.4 1 1 0 0 0 0-13.4zm0 1a1 1 0 0 1 0 11 1 1 0 0 1 0-11zm-.97-.25A3.5 3.5 0 0 0 3.5 0 3.5 3.5 0 0 0 0 3.5a3.5 3.5 0 0 0 1.75 3.03l.5-.86A2.5 2.5 0 0 1 1 3.5 2.5 2.5 0 0 1 3.5 1a2.5 2.5 0 0 1 2.17 1.25zm6.72 4.78A3.5 3.5 0 0 0 15 3.5 3.5 3.5 0 0 0 11.5 0a3.5 3.5 0 0 0-3.03 1.75l.86.5A2.5 2.5 0 0 1 11.5 1 2.5 2.5 0 0 1 14 3.5a2.5 2.5 0 0 1-1.25 2.17zM7 5h1v5H7zm3 2v1H5V7z");e.fill(u),e.restore()}_lines(){const e=this._data;return(e.text?1:0)+(e.secondLine?1:0)+(e.thirdLine?1:0)}_isOutOfScreen(e,t){var i;const r=this._commonData,s=null!==(i=r.fixedCoordinate)&&void 0!==i?i:r.coordinate,n=this.height(e),o=n/this._lines();return s-o/2-3>t||s+(n-o/2)+3<0}}class p{constructor(e){this._commonRendererData={coordinate:0,textColor:"#FFF",background:"#000",additionalPaddingBottom:0,additionalPaddingTop:0},this._axisRendererData={text:"",visible:!1,separatorVisible:!1,borderVisible:!1,ignoreOffset:!1},this._paneRendererData={text:"",visible:!1,separatorVisible:!0,borderVisible:!1,ignoreOffset:!0},this._invalidated=!0,this._axisRenderer=new(e||h)(this._axisRendererData,this._commonRendererData),this._paneRenderer=new(e||h)(this._paneRendererData,this._commonRendererData)}text(){return this._updateRendererDataIfNeeded(),this._axisRendererData.text}secondLineText(){return this._updateRendererDataIfNeeded(),this._axisRendererData.secondLine}thirdLineText(){return this._updateRendererDataIfNeeded(),this._axisRendererData.thirdLine}background(){return this._updateRendererDataIfNeeded(),this._commonRendererData.background}color(){return this._updateRendererDataIfNeeded(),this.generateTextColor(this.background())}generateTextColor(e){return(0,o.colorFromBackground)(e)}coordinate(){return this._updateRendererDataIfNeeded(),this._commonRendererData.coordinate}floatCoordinate(){var e;return this._updateRendererDataIfNeeded(),null!==(e=this._commonRendererData.floatCoordinate)&&void 0!==e?e:this._commonRendererData.coordinate}update(){this._invalidated=!0}height(e){return this._updateRendererDataIfNeeded(),Math.max(this._axisRenderer.height(e),this._paneRenderer.height(e))}getFixedCoordinate(){return this._commonRendererData.fixedCoordinate||0}setFixedCoordinate(e){this._commonRendererData.fixedCoordinate=e}isVisible(){return this._updateRendererDataIfNeeded(),this._axisRendererData.visible||this._paneRendererData.visible}
isAxisLabelVisible(){return this._updateRendererDataIfNeeded(),this._axisRendererData.visible}isPaneLabelVisible(){return this._updateRendererDataIfNeeded(),this._paneRendererData.visible}renderer(){return this._updateRendererDataIfNeeded(),this._axisRenderer}paneRenderer(){return this._updateRendererDataIfNeeded(),this._paneRenderer}setPaneRendererLabelIcon(e){this._paneRendererData.labelIcon=e}setPaneLabelVisible(e){this._paneRendererData.visible=e,this._invalidated=!0}ignoreAlignment(){return!1}_updateRendererDataIfNeeded(){this._invalidated&&(this._commonRendererData.fixedCoordinate=void 0,this._updateRendererData(this._axisRendererData,this._paneRendererData,this._commonRendererData),this._invalidated=!1)}}},43854:(e,t,i)=>{"use strict";i.d(t,{PriceDataSource:()=>a});var r=i(96861),s=i(96276),n=i.n(s),o=i(88987);class a extends r.DataSource{constructor(e){super(),this._formatterChanged=new(n()),this._priceStepChanged=new(n()),this._currencyChanged=new(n()),this._unitChanged=new(n()),this._priceRangeReadyChanged=new(n()),this._metaInfo=null,this._priceStep=null,this._priceRangeReady=!0,this._model=e}barColorer(){return null}base(){return 0}model(){return this._model}currencyChanged(){return this._currencyChanged}isCurrencySource(){return!0}unitChanged(){return this._unitChanged}isUnitSource(){return!0}priceRange(e,t){return null}isDraggable(){return!this._metaInfo||!this._metaInfo.linkedToSeries}priceLineColor(e){return e}formatterChanged(){return this._formatterChanged}priceStep(e){return this._priceStep}priceStepChanged(){return this._priceStepChanged}isIncludedInAutoScale(){return!0}correctScaleMargins(e){return e}priceRangeReady(){return this._priceRangeReady}priceRangeReadyChanged(){return this._priceRangeReadyChanged}disablePriceRangeReady(){const e=this.priceScale();null===e||e.isAutoScale()||e.mainSource()!==this||(this._priceRangeReady=!1,e.recalculatePriceRangeOnce()),this._priceRangeReadyChanged.fire(!1)}_enablePriceRangeReady(){this._priceRangeReady=!0,this._priceRangeReadyChanged.fire(!0)}_onSourceCurrencyChanged(){(0,o.isSymbolSource)(this)||this._currencyChanged.fire()}_onSourceUnitChanged(){(0,o.isSymbolSource)(this)||this._unitChanged.fire()}_onSourcePriceRangeReadyChanged(e){(0,o.isSymbolSource)(this)||e||this.disablePriceRangeReady()}}},26274:(e,t,i)=>{"use strict";i.d(t,{PriceLineAxisRenderer:()=>a});var r=i(16282),s=i(99438),n=i(3707),o=i(64348);class a{constructor(e,t){this.setData(e,t)}setData(e,t){this._data=e,this._commonData=t}draw(e,t,i,a,l,c,u){var d;if(!this._data.visible)return;const h=null!==(d=this._commonData.fixedCoordinate)&&void 0!==d?d:this._commonData.coordinate;e.lineWidth=Math.max(1,Math.floor((0,r.ensureDefined)(this._data.linewidth)*u)),e.lineCap="butt",(0,s.setLineStyle)(e,void 0===this._data.linestyle?n.LINESTYLE_DOTTED:this._data.linestyle),e.strokeStyle=this._commonData.textColor,(0,o.drawHorizontalLine)(e,Math.round(h*u),0,Math.ceil(a*u))}height(e){return 0}}},78539:(e,t,i)=>{"use strict";i.d(t,{PriceLineAxisView:()=>o,SeriesPriceLineAxisView:()=>a,
StudyPriceLineAxisView:()=>l});var r=i(32552),s=i(26274),n=i(3707);class o extends r.PriceAxisView{constructor(e){super(e||s.PriceLineAxisRenderer)}ignoreAlignment(){return!0}_updateRendererData(e,t,i){if(t.visible=!1,e.visible=!1,!this._isVisible())return;const r=this._value();r.noData||(i.background="",i.textColor=this._priceLineColor(r.color),i.coordinate=r.coordinate,i.floatCoordinate=r.floatCoordinate,e.linewidth=this._lineWidth(),e.linestyle=this._lineStyle(),e.backgroundAreaVisible=this._backgroundAreaVisible(),e.backgroundAreaColor=this._backgroundAreaColor(),e.backgroundAreaHeight=this._backgroundAreaHeight(),e.visible=!0)}_lineStyle(){return n.LINESTYLE_DOTTED}_backgroundAreaVisible(){return!1}_backgroundAreaColor(){return""}_backgroundAreaHeight(){return 0}}class a extends o{constructor(e){super(),this._series=e}_value(){return this._series.lastValueData(void 0,!0)}_priceLineColor(e){return this._series.priceLineColor(e)}_lineWidth(){return this._series.properties().childs().priceLineWidth.value()}_isVisible(){const e=this._series.model().properties().scalesProperties.showSeriesLastValue.value();return this._series.properties().childs().showPriceLine.value()&&e}}class l extends o{constructor(e,t){super(),this._study=e,this._plotname=t}_value(){return this._study.lastValueData(this._plotname,!0)}_lineWidth(){return this._study.properties().styles[this._plotname].linewidth.value()}_lineStyle(){return n.LINESTYLE_DOTTED}_priceLineColor(e){return e}_isVisible(){const e=this._study.model().properties().scalesProperties.showStudyLastValue.value();return this._study.properties().styles[this._plotname].trackPrice.value()&&e}}},10769:(e,t,i)=>{"use strict";i.d(t,{PriceScaleBase:()=>D});var r=i(16282),s=i(31565),n=i(96276),o=i.n(n),a=i(4543),l=i(59757),c=i(67350),u=i(47658),d=i(43854),h=i(98006),p=i(32411),_=i(5991),m=i(27937),f=i.n(m),g=i(55304),v=i(88987),S=i(20554),y=i(64547),b=i(70734),w=i(84162);class P{constructor(e,t){if(this._base=e,this._integralDividers=t,(0,w.isBaseDecimal)(this._base))this._fractionalDividers=[2,2.5,2];else{this._fractionalDividers=[];for(let e=this._base;1!==e;){if(e%2==0)this._fractionalDividers.push(2),e/=2;else{if(e%5!=0)throw new Error("unexpected base");this._fractionalDividers.push(2),this._fractionalDividers.push(2.5),e/=5}if(this._fractionalDividers.length>100)throw new Error("something wrong with base")}}}tickSpan(e,t,i){const r=0===this._base?0:1/this._base;let s=Math.pow(10,Math.max(0,Math.ceil((0,w.log10)(e-t)))),n=0,o=this._integralDividers[0];for(;;){const e=(0,w.greaterOrEqual)(s,r,1e-14)&&s>r+1e-14,t=(0,w.greaterOrEqual)(s,i*o,1e-14),a=(0,w.greaterOrEqual)(s,1,1e-14);if(!(e&&t&&a))break;s/=o,o=this._integralDividers[++n%this._integralDividers.length]}if(s<=r+1e-14&&(s=r),s=Math.max(1,s),this._fractionalDividers.length>0&&(0,w.equal)(s,1,1e-14))for(n=0,o=this._fractionalDividers[0];(0,w.greaterOrEqual)(s,i*o,1e-14)&&s>r+1e-14;)s/=o,o=this._fractionalDividers[++n%this._fractionalDividers.length];return s}}class C{constructor(e,t,i,r){this._marks=null,this._priceScale=e,
this._base=t,this._coordinateToLogicalFunc=i,this._logicalToCoordinateFunc=r}base(){return this._base}setBase(e){if(e<0)throw new Error("base < 0");this._base=e}tickSpan(e,t,i=0){if(e<t)throw new Error("high < low");const r=this._priceScale.height(),s=(e-t)*this._tickMarkHeight()/r,n=new P(this._base,[2,2.5,2]),o=new P(this._base,[2,2,2.5]),a=new P(this._base,[2.5,2,2]);let l=0;const c=n.tickSpan(e,t,s);c>i&&(l=c);const u=o.tickSpan(e,t,s);u>i&&(l=Math.min(l,u));const d=a.tickSpan(e,t,s);return d>i&&(l=Math.min(l,d)),l>0?l:e-t}rebuildTickMarks(){this._marks=null}marks(){return null===this._marks&&(this._marks=this._rebuildTickMarksImpl()),this._marks}_fontHeight(){return this._priceScale.fontSize()}_tickMarkHeight(){return Math.ceil(2.5*this._fontHeight())}_rebuildTickMarksImpl(){const e=this._priceScale,t=[],i=e.mainSource();if(e.isEmpty()||null===i)return t;let r=i.firstValue();null===r&&(r=0);const s=e.height(),n=this._coordinateToLogicalFunc(s-1,r),o=this._coordinateToLogicalFunc(0,r),a=Math.max(n,o),l=Math.min(n,o);if(a===l)return t;let c=this.tickSpan(a,l),u=a%c;u+=u<0?c:0;const d=a>=l?1:-1;let h=null;const p=e.formatter();let _=NaN;for(let i=a-u;i>l;i-=c){i===_&&(c=this.tickSpan(a,l,c)),_=i;const s=this._logicalToCoordinateFunc(i,r);null!==h&&Math.abs(s-h)<this._tickMarkHeight()||(t.push({coord:s,label:p.format(i)}),h=s,e.isLog()&&(c=this.tickSpan(i*d,l)))}return t}}var T=i(87048),x=i(14397),I=i(14704),L=i(11228);const M=(0,h.isFeatureEnabled)("unit_conversion"),E=new I.PercentageFormatter,A=new L.PriceFormatter(100,1),k={autoScale:!0,autoScaleDisabled:!1,lockScale:!1,percentage:!1,percentageDisabled:!1,log:!1,logDisabled:!1,alignLabels:!0,isInverted:!1,indexedTo100:!1};class D{constructor(e){this._marksCache=null,this._onMarksChanged=new(o()),this.m_dataSources=[],this._sourcesForAutoscale=null,this._hasSeries=!1,this._studiesCount=0,this._drawingCount=0,this._seriesLikeSources=[],this._seriesLikeSourcesSet=new Set,this._priceDataSources=[],this._mainSource=null,this._lastSourceRemoved=new(o()),this._scaleSeriesOnly=!1,this._invalidatedForRange={isValid:!0,visibleBars:null},this.m_priceRange=null,this._logFormula=(0,c.logFormulaForPriceRange)(null),this.m_height=0,this._margins={top:0,bottom:0},this._correctedMarginsCache=null,this._topPixelMargin=0,this._bottomPixelMargin=0,this._internalHeightCache=null,this._internalHeightChanged=new(o()),this._priceRangeSnapshot=null,this._scrollStartPoint=null,this._currencyCache=null,this._unitCache=null,this._recalculatePriceRangeOnce=!1,this._cachedOrderedSoruces=null,this._scaleStartPoint=null,this._maxPriceRange=null,this._minPriceRange=null,this._priceRangeChanged=new(o()),this._sourcesToUpdateViews=null,this._markBuilder=new C(this,100,this._coordinateToLogical.bind(this),this._logicalToCoordinate.bind(this)),this._formatter=null,this._id="",e=Object.assign({},k,e),this._properties=new(f())(e)}id(){return this._id}setId(e){this._id=e}isLog(){return this._properties.childs().log.value()}isPercentage(){return this._properties.childs().percentage.value()}
isInverted(){return this._properties.childs().isInverted.value()}isIndexedTo100(){return this._properties.childs().indexedTo100.value()}isAutoScale(){return this._properties.childs().autoScale.value()&&!this.isLockScale()}isLockScale(){return this._properties.childs().lockScale.value()}isRegular(){return!this.isPercentage()&&!this.isLog()&&!this.isIndexedTo100()}properties(){return this._properties}height(){return this.m_height}setHeight(e){this.m_height!==e&&(this.m_height=e,this._invalidateInternalHeightCache(),this._marksCache=null)}internalHeight(){if(this._internalHeightCache)return this._internalHeightCache;const e=this.height()-this.topPixelMargin()-this.bottomPixelMargin();return this._internalHeightCache=e,e}priceRange(){return this._makeSureItIsValid(),this.m_priceRange}setPriceRange(e,t,i){if(!(e instanceof l.PriceRange))throw new TypeError("incorrect price range");const r=this.m_priceRange;if(!t&&l.PriceRange.compare(r,e))return;const s=null!==this._maxPriceRange&&this._maxPriceRange.containsStrictly(e),n=null!==this._minPriceRange&&e.containsStrictly(this._minPriceRange);this.isLockScale()&&!t&&(s||n)||(this._marksCache=null,this.m_priceRange=e,i||this._priceRangeChanged.fire(r,e))}setMinPriceRange(e){this._minPriceRange=e}setMaxPriceRange(e){this._maxPriceRange=e}recalculatePriceRangeOnce(){this._recalculatePriceRangeOnce=!0}priceRangeShouldBeRecalculatedOnce(){if(!this._recalculatePriceRangeOnce||this.isLockScale())return!1;const e=this.mainSource();return null!==e&&e.priceRangeReady()}priceRangeChanged(){return this._priceRangeChanged}updateAllViews(){const e=this._getSourcesToUpdateViews();for(const t of e)t.updateAllViews()}logFormula(){return this._logFormula}state(){var e;const t=this._properties.childs();return{id:this._id,m_priceRange:(null===(e=this.priceRange())||void 0===e?void 0:e.serialize())||null,m_isAutoScale:this.isAutoScale(),m_isPercentage:t.percentage.value(),m_isIndexedTo100:t.indexedTo100.value(),m_isLog:t.log.value(),m_isLockScale:this.isLockScale(),m_isInverted:this.isInverted(),m_height:this.m_height,m_topMargin:this._margins.top,m_bottomMargin:this._margins.bottom,alignLabels:t.alignLabels.value(),logFormula:(0,s.clone)(this._logFormula)}}restoreState(e){let t=e.m_priceRange;if(void 0===t)throw new TypeError("invalid state");if(void 0===e.m_isAutoScale)throw new TypeError("invalid state");void 0!==e.id&&(this._id=e.id);const i={autoScale:e.m_isAutoScale};void 0!==e.m_isPercentage&&(i.percentage=e.m_isPercentage),void 0!==e.m_isIndexedTo100&&(i.indexedTo100=e.m_isIndexedTo100),void 0!==e.m_isLog&&(i.log=e.m_isLog),void 0!==e.m_isLockScale&&(i.lockScale=e.m_isLockScale),void 0!==e.m_isInverted&&this._properties.childs().isInverted.setValue(e.m_isInverted),void 0!==e.m_height&&this.setHeight(Math.max(0,e.m_height)),this.setMode(i),t?(t instanceof l.PriceRange||(t=new l.PriceRange(t)),this.setPriceRange(t,!0)):this.m_priceRange=null,e.logFormula&&(this._logFormula=e.logFormula),void 0!==e.m_topMargin&&(this._margins.top=e.m_topMargin),
void 0!==e.m_bottomMargin&&(this._margins.bottom=e.m_bottomMargin),void 0!==e.alignLabels&&this._properties.childs().alignLabels.setValue(e.alignLabels),this._mainSource=null,this._scaleSeriesOnly=!1}priceToLogical(e){return this.isLog()&&e?(0,c.toLog)(e,this._logFormula):e}logicalToPrice(e){return this.isLog()?(0,c.fromLog)(e,this._logFormula):e}priceToCoordinate(e,t){const i=this._priceToPercentOrIndexedTo100IfNeeded(e,t);return this._logicalToCoordinate(i)}coordinateToPrice(e,t){let i=this._coordinateToLogical(e);return this.isPercentage()?i=(0,c.fromPercent)(i,t):this.isIndexedTo100()&&(i=(0,c.fromIndexedTo100)(i,t)),i}mainSource(){if(null!==this._mainSource)return this._mainSource;let e;for(const t of this.m_dataSources){if(t instanceof u.Series){e=t;break}!e&&t instanceof d.PriceDataSource&&(e=t)}return this._mainSource=e||null,this._correctedMarginsCache=null,this._mainSource}pricesArrayToCoordinates(e,t,i){this._makeSureItIsValid();const s=this.bottomPixelMargin(),n=(0,r.ensureNotNull)(this.priceRange()),o=n.minValue(),a=n.maxValue(),l=this.internalHeight()-1,u=this.isInverted(),d=l/(a-o);void 0===i&&(i=e.length);const h=this.isPercentage(),p=this.isIndexedTo100(),_=this.isLog(),m=this.m_height;let f,g;for(let r=0;r<i;r++)f=e[r],Number.isFinite(f)&&(h?f=(0,c.toPercent)(f,t):p?f=(0,c.toIndexedTo100)(f,t):_&&(f=(0,c.toLog)(f,this._logFormula)),g=s+d*(f-o),e[r]=u?g:m-1-g)}pointsArrayToCoordinates(e,t){this._makeSureItIsValid();const i=(0,r.ensureNotNull)(this.priceRange()),s=this.bottomPixelMargin(),n=i.minValue(),o=i.maxValue(),a=this.internalHeight()-1,l=this.isInverted(),u=a/(o-n),d=e;if(this.isPercentage())for(let e=0;e<d.length;e++)d[e].y=(0,c.toPercent)(d[e].y,t);if(this.isIndexedTo100())for(let e=0;e<d.length;e++)d[e].y=(0,c.toIndexedTo100)(d[e].y,t);if(this.isLog())for(let e=0;e<d.length;e++)d[e].y=this.priceToLogical(d[e].y);for(let e=0;e<d.length;e++){const t=d[e].y;if(isNaN(t)||null==t)continue;const i=s+u*(t-n),r=l?i:this.m_height-1-i;d[e].y=r}}barPricesToCoordinates(e,t){this._makeSureItIsValid();const i=(0,r.ensureNotNull)(this.priceRange()),s=e,n=this.bottomPixelMargin(),o=i.minValue(),a=i.maxValue(),l=this.internalHeight()-1;let u=null;if(this.isPercentage()?u=c.toPercent:this.isIndexedTo100()?u=c.toIndexedTo100:this.isLog()&&(u=(e,t)=>e?(0,c.toLog)(e,this._logFormula):e),null!==u)for(let e=0;e<s.length;e++)s[e]&&(s[e].open=u(s[e].open,t),s[e].high=u(s[e].high,t),s[e].low=u(s[e].low,t),s[e].close=u(s[e].close,t),void 0!==s[e].additionalPrice&&(s[e].additionalPrice=u(s[e].additionalPrice,t)));const d=l/(a-o),h=this.isInverted();for(let e=0;e<s.length;e++){const t=s[e];if(!t)continue;const i=n+d*(t.open-o),r=h?i:this.m_height-1-i;t.open=r;const a=n+d*(t.high-o),l=h?a:this.m_height-1-a;t.high=l;const c=n+d*(t.low-o),u=h?c:this.m_height-1-c;t.low=u;const p=n+d*(t.close-o),_=h?p:this.m_height-1-p;if(t.close=_,void 0!==t.additionalPrice){const e=n+d*(t.additionalPrice-o);t.additionalPrice=h?e:this.m_height-1-e}}}formatter(){return null===this._formatter&&this.updateFormatter(),(0,
r.ensureNotNull)(this._formatter)}updateFormatter(){this._marksCache=null;const e=this.mainSource();let t=100;e&&(t=e.base()),this._formatter=null,this.isPercentage()?(this._formatter=E,t=100):this.isIndexedTo100()?(this._formatter=new L.PriceFormatter(100,1),t=100):this._formatter=e?e.formatter():A,this._markBuilder=new C(this,t,this._coordinateToLogical.bind(this),this._logicalToCoordinate.bind(this)),this._markBuilder.rebuildTickMarks()}formatPrice(e,t,i){if(this.isPercentage())return this.formatPricePercentage(e,t,i);const r=this._priceToPercentOrIndexedTo100IfNeeded(e,t);return this.formatter().format(r)}formatPriceAbsolute(e){return this._mainSourceFormatter().format(e)}formatPricePercentage(e,t,i){return e=(0,c.toPercent)(e,t),E.format(e,i)}dataSources(){return this.m_dataSources}seriesLikeSources(){return this._seriesLikeSources}addDataSource(e,t){if(t||-1===this.m_dataSources.indexOf(e)){if(e instanceof d.PriceDataSource&&(this._priceDataSources.push(e),e.currencyChanged().subscribe(this,()=>this._currencyCache=null),e.unitChanged().subscribe(this,()=>this._unitCache=null),(0,v.isSymbolSource)(e)&&(this._seriesLikeSources.push(e),this._seriesLikeSourcesSet.add(e),e.symbolResolved().subscribe(this,()=>{this._currencyCache=null,this._unitCache=null}),e instanceof u.Series))){const t=e.properties();this._hasSeries||(t.childs().lockScale&&(this.setMode({lockScale:t.childs().lockScale.value()}),t.removeProperty("lockScale")),t.childs().pnfStyle.child("lockScale")&&t.childs().pnfStyle.removeProperty("lockScale")),this._hasSeries=!0}e.properties().visible.listeners().subscribe(this,this._dropScaleCache),(0,g.isStudy)(e)&&(e.onIsActualIntervalChange().subscribe(this,this._dropScaleCache),0===this._studiesCount&&(0,x.hideAllIndicators)().subscribe(this,this._dropScaleCache),this._studiesCount++),(0,T.isLineTool)(e)&&(0===this._drawingCount&&(0,x.hideAllDrawings)().subscribe(this,this._dropScaleCache),this._drawingCount++),this.m_dataSources.push(e),this._mainSource=null,this._correctedMarginsCache=null,this._sourcesToUpdateViews=null,this._dropScaleCache(),this.updateFormatter(),this._initScaleProperties(),this.invalidateSourcesCache()}}removeDataSource(e){const t=this.m_dataSources.indexOf(e);if((0,r.assert)(-1!==t,"Source is not attached to scale"),e.properties().visible.listeners().unsubscribe(this,this._dropScaleCache),this.m_dataSources.splice(t,1),e instanceof d.PriceDataSource){const t=this._priceDataSources.indexOf(e);if((0,r.assert)(-1!==t,"Source is not found"),this._priceDataSources.splice(t,1),(0,v.isSymbolSource)(e)){const t=this._seriesLikeSources.indexOf(e);(0,r.assert)(-1!==t,"Source is not found"),this._seriesLikeSources.splice(t,1),this._seriesLikeSourcesSet.delete(e),e.symbolResolved().unsubscribeAll(this),e instanceof u.Series&&(this._hasSeries=!1)}e.currencyChanged().unsubscribeAll(this),e.unitChanged().unsubscribeAll(this)}this.mainSource()||this.setMode({autoScale:!0}),(0,g.isStudy)(e)&&(e.onIsActualIntervalChange().unsubscribe(this,this._dropScaleCache),this._studiesCount--,
0===this._studiesCount&&(0,x.hideAllIndicators)().unsubscribe(this,this._dropScaleCache)),(0,T.isLineTool)(e)&&(this._drawingCount--,0===this._drawingCount&&(0,x.hideAllDrawings)().unsubscribe(this,this._dropScaleCache)),this._mainSource=null,this._correctedMarginsCache=null,this._sourcesForAutoscale=null,this._sourcesToUpdateViews=null,this.updateFormatter(),this.invalidateSourcesCache(),0===this.m_dataSources.length&&this._lastSourceRemoved.fire(),this._currencyCache=null,this._unitCache=null}currency(e){if(null!==this._currencyCache&&e.size()===this._currencyCache.availableCurrenciesCount)return this._currencyCache.value;let t;const i=new Set,s=new Set,n=new Set,o=new Map;let a,l=0===this._seriesLikeSources.length,c=!0,u=0,d=0;for(const d of this._seriesLikeSources){if(!d.isVisible())continue;const h=d.symbolInfo();if(null===h){t=null;break}const p=(0,S.symbolOriginalCurrency)(h);if(null===p){t=null;break}o.set(p,(0,r.ensureNotNull)((0,S.symbolOriginalCurrency)(h,!0)));const _=d.currency();if(null===_){t=null;break}o.set(_,(0,r.ensureNotNull)((0,S.symbolCurrency)(h,!0)));const m=(0,S.symbolBaseCurrency)(h);null!==m&&s.add(m),c=c&&p===_,n.add(_),i.add(p),void 0===a?a=_:null!==a&&a!==_&&(a=null),l||e.convertible(_)&&(0,S.symbolCurrencyConvertible)(h)||(l=!0),u+=1}if(null!==t)for(const i of this._priceDataSources){if(this._seriesLikeSourcesSet.has(i))continue;const s=i;if(!s.isCurrencySource()||!s.isVisible())continue;const c=s.currency();if(null===c){t=null;break}n.add(c),d+=1;const h=(0,r.ensureNotNull)(s.symbolSource()),p=h.symbolInfo();if(null===p){t=null;break}if(l||e.convertible(c)&&(0,S.symbolCurrencyConvertible)(p)||(l=!0),o.set(c,(0,r.ensureNotNull)((0,S.symbolCurrency)(p,!0))),!this._seriesLikeSourcesSet.has(h)||!h.isVisible()){if(u>0)a=null;else if(void 0===a)a=c;else if(null!==a&&a!==c){a=null;break}l=!0;break}}return void 0===t&&(t=0===u&&0===d?null:{readOnly:l,selectedCurrency:a||null,currencies:n,originalCurrencies:i,baseCurrencies:s,symbolSourceCount:u,allCurrenciesAreOriginal:c,displayedValues:o}),this._currencyCache={value:t,availableCurrenciesCount:e.size()},t}unit(e){if(null!==this._unitCache&&e.size()===this._unitCache.availableUnitsCount)return this._unitCache.value;let t;const i=new Set,s=new Set,n=new Map,o=new Map;let l,c=0===this._seriesLikeSources.length?new Set:e.allGroups(),u=!0,d=0,h=0;for(const r of this._seriesLikeSources){if(!r.isVisible())continue;const h=r.symbolInfo();if(null===h){t=null;break}const p=(0,S.symbolOriginalUnit)(h);if(null===p){t=null;break}n.set(p,e.name(p)),o.set(p,e.description(p));const _=r.unit();if(null===_){t=null;break}if(n.set(_,e.name(_)),o.set(_,e.description(_)),u=u&&p===_,s.add(_),i.add(p),void 0===l?l=_:null!==l&&l!==_&&(l=null),c.size>0){const t=(0,y.unitConvertibleGroups)(h,_,e);c=(0,a.intersect)(c,new Set(t))}d+=1}if(null!==t)for(const i of this._priceDataSources){if(this._seriesLikeSourcesSet.has(i))continue;const u=i;if(!u.isUnitSource()||!u.isVisible())continue;const p=u.unit();if(null===p){t=null;break}s.add(p),h+=1;const _=(0,
r.ensureNotNull)(u.symbolSource()),m=_.symbolInfo();if(null===m){t=null;break}if(c.size>0){const t=(0,y.unitConvertibleGroups)(m,p,e);c=(0,a.intersect)(c,new Set(t))}if(n.set(p,e.name(p)),o.set(p,e.description(p)),!this._seriesLikeSourcesSet.has(_)||!_.isVisible()){if(d>0)l=null;else if(void 0===l)l=p;else if(null!==l&&l!==p){l=null;break}c=new Set;break}}if(void 0===t)if(0===d&&0===h)t=null;else{const e=l||null;t=M||null!==e?{availableGroups:c,selectedUnit:e,units:s,originalUnits:i,symbolSourceCount:d,allUnitsAreOriginal:u,names:n,descriptions:o}:null}return this._unitCache={value:t,availableUnitsCount:e.size()},t}setMargins(e){if(!(0,s.isNumber)(e.top)||!(0,s.isNumber)(e.bottom))throw new TypeError("invalid margin");if(e.top<0||e.top>30||e.bottom<0||e.bottom>30)throw new RangeError("invalid margin");this._margins.top===e.top&&this._margins.bottom===e.bottom||(this._margins=e,this._correctedMarginsCache=null,this._invalidateInternalHeightCache(),this._marksCache=null)}topMargin(){return this._correctedMargins().top}bottomMargin(){return this._correctedMargins().bottom}invalidateMargins(){this._correctedMarginsCache=null}topPixelMargin(){return this.isInverted()?this.bottomMargin()*this.height()+this._bottomPixelMargin:this.topMargin()*this.height()+this._topPixelMargin}bottomPixelMargin(){return this.isInverted()?this.topMargin()*this.height()+this._topPixelMargin:this.bottomMargin()*this.height()+this._bottomPixelMargin}marks(){return this._makeSureItIsValid(),null===this._marksCache&&(this._markBuilder.rebuildTickMarks(),this._marksCache=this._markBuilder.marks(),this._onMarksChanged.fire()),this._marksCache}onMarksChanged(){return this._onMarksChanged}priceRangeInPrice(){if(this.isEmpty())return null;const e=this.mainSource();if(null===e)return null;const t=(0,r.ensureNotNull)(e.firstValue()),i=this.height();return{from:this.coordinateToPrice(i-1,t),to:this.coordinateToPrice(0,t)}}setPriceRangeInPrice(e){if(this.isPercentage()||this.isIndexedTo100())return;const t=this.isInverted(),i=t?this.bottomMargin():this.topMargin(),r=t?this.topMargin():this.bottomMargin(),s=this.isLog();let n=s?(0,c.toLog)(e.from,this._logFormula):e.from,o=s?(0,c.toLog)(e.to,this._logFormula):e.to;const a=o-n;n+=r*a,o-=i*a,this.setMode({autoScale:!1}),this.setPriceRange(new l.PriceRange(n,o)),this._marksCache=null,this._onMarksChanged.fire()}hasMainSeries(){return this._hasSeries}getStudies(){return this.dataSources().filter(g.isStudy)}lastSourceRemoved(){return this._lastSourceRemoved}sourcesForAutoscale(){return this._mainSource&&this._scaleSeriesOnly!==this._scalesProperties.childs().scaleSeriesOnly.value()&&(this._sourcesForAutoscale=null),this._sourcesForAutoscale||(this._sourcesForAutoscale=this._recalculateSourcesForAutoscale()),this._sourcesForAutoscale}recalculatePriceRange(e){this._invalidatedForRange={visibleBars:e,isValid:!1}}internalHeightChanged(){return this._internalHeightChanged}orderedSources(){if(this._cachedOrderedSoruces)return this._cachedOrderedSoruces;let e=this.m_dataSources.slice()
;return e=e.filter(e=>!(e instanceof p.study_ESD$TV_DIVIDENDS||e instanceof p.study_ESD$TV_SPLITS||e instanceof p.study_ESD$TV_EARNINGS||e instanceof _.ChartEventsSource)),e=(0,b.sortSources)(e),this._cachedOrderedSoruces=e,this._cachedOrderedSoruces}invalidateSourcesCache(){this._cachedOrderedSoruces=null,this._sourcesToUpdateViews=null}startScale(e){if(this.isPercentage()||this.isIndexedTo100())return;if(null!==this._scaleStartPoint||null!==this._priceRangeSnapshot)return;if(this.isEmpty())return;this._scaleStartPoint=this.m_height-e;const t=this.priceRange();this._priceRangeSnapshot=t&&t.clone()}scaleTo(e){if(this.isPercentage()||this.isIndexedTo100())return;if(null===this._scaleStartPoint)return;this.setMode({autoScale:!1}),(e=this.m_height-e)<0&&(e=0);let t=(this._scaleStartPoint+.2*(this.m_height-1))/(e+.2*(this.m_height-1));const i=(0,r.ensureNotNull)(this._priceRangeSnapshot).clone();t=Math.max(t,.1),i.scaleAroundCenter(t),this.setPriceRange(i)}endScale(){this.isPercentage()||this.isIndexedTo100()||null!==this._scaleStartPoint&&(this._scaleStartPoint=null,this._priceRangeSnapshot=null)}startScroll(e){var t,i;this.isAutoScale()||null===this._scrollStartPoint&&null===this._priceRangeSnapshot&&(this.isEmpty()||(this._scrollStartPoint=e,this._priceRangeSnapshot=null!==(i=null===(t=this.priceRange())||void 0===t?void 0:t.clone())&&void 0!==i?i:null))}scrollTo(e){if(this.isAutoScale())return;if(null===this._scrollStartPoint||null===this._priceRangeSnapshot)return;const t=this.priceRange();if(null===t)return;let i=e-this._scrollStartPoint;this.isInverted()&&(i*=-1);const r=i*(t.length()/(this.internalHeight()-1)),s=this._priceRangeSnapshot.clone();s.shift(r),this.setPriceRange(s,!0),this._marksCache=null}endScroll(){this.isAutoScale()||null!==this._scrollStartPoint&&(this._scrollStartPoint=null,this._priceRangeSnapshot=null)}_recalculateSourcesForAutoscale(){this._mainSource&&(this._scaleSeriesOnly=this._scalesProperties.childs().scaleSeriesOnly.value());const e=this._scaleSeriesOnly&&this._hasSeries;return this.m_dataSources.filter(t=>!!(t.properties().visible.value()||t instanceof u.Series)&&(e?t instanceof u.Series:(0,g.isStudy)(t)?!t.isSourceHidden()&&t.isIncludedInAutoScale():t.isIncludedInAutoScale()))}_updateAutoScaleDisabledProperty(e){const t=this._properties.childs(),i=t.indexedTo100.value()||t.percentage.value()||t.lockScale.value();e?t.autoScaleDisabled.setValueSilently(i):t.autoScaleDisabled.setValue(i)}_setAutoScaleValueWithDependentProperties(e){const t=this._properties.childs();t.autoScale.setValueSilently(e),e&&(t.percentage.setValueSilently(!1),t.indexedTo100.setValueSilently(!1),t.lockScale.setValueSilently(!1),t.logDisabled.setValueSilently(!1)),this._updateAutoScaleDisabledProperty(!0)}_setLockScaleValueWithDependentProperties(e){const t=this._properties.childs();t.lockScale.setValueSilently(e),e&&(t.autoScale.setValueSilently(!1),t.percentage.setValueSilently(!1),t.indexedTo100.setValueSilently(!1),t.log.setValueSilently(!1)),t.percentageDisabled.setValueSilently(e),
t.logDisabled.setValueSilently(e),this._updateAutoScaleDisabledProperty(!0)}_setPercentageValueWithDependentProperties(e){const t=this._properties.childs();t.percentage.setValueSilently(e),e&&(t.autoScale.setValueSilently(!0),t.log.setValueSilently(!1),t.lockScale.setValueSilently(!1),t.indexedTo100.setValueSilently(!1)),this._updateAutoScaleDisabledProperty(!0)}_setIndexedTo100ValueWithDependentProperties(e){const t=this._properties.childs();t.indexedTo100.setValueSilently(e),e&&(t.autoScale.setValueSilently(!0),t.log.setValueSilently(!1),t.lockScale.setValueSilently(!1),t.percentage.setValueSilently(!1)),this._updateAutoScaleDisabledProperty(!0)}_setLogValueWithDependentProperties(e){const t=this._properties.childs();t.log.setValueSilently(e),e&&(t.lockScale.setValueSilently(!1),t.percentage.setValueSilently(!1),t.indexedTo100.setValueSilently(!1)),this._updateAutoScaleDisabledProperty(!0)}_recalculatePriceRangeImpl(){const e=this._invalidatedForRange.visibleBars;if(null===e)return;let t=null;const i=this.sourcesForAutoscale(),r=this.isPercentage(),s=this.isIndexedTo100();let n=0,o=0;for(const a of i){if(!a.properties().visible.value())continue;const i=a.firstValue();if(null===i)continue;const l=e.firstBar(),u=e.lastBar(),d=a.autoScaleInfo(l,u);let h=d.range;h&&(r?h=(0,c.toPercentRange)(h,i):s&&(h=(0,c.toIndexedTo100Range)(h,i)),t=null===t?h:t.merge(h)),void 0!==d.topPixelMargin&&(n=Math.max(n,d.topPixelMargin)),void 0!==d.bottomPixelMargin&&(o=Math.max(o,d.bottomPixelMargin))}if((Math.abs(n-this._topPixelMargin)>0||Math.abs(o-this._bottomPixelMargin)>0)&&(this._bottomPixelMargin=o,this._topPixelMargin=n,this._marksCache=null,this._invalidateInternalHeightCache()),t){if(t.minValue()===t.maxValue()&&(t=new l.PriceRange(t.minValue()-.5,t.maxValue()+.5)),this.isLog()){const e=this._convertPriceRangeFromLog(t),i=(0,c.logFormulaForPriceRange)(e);if(!(0,c.logFormulasAreSame)(i,this._logFormula)){const r=this._priceRangeSnapshot?this._convertPriceRangeFromLog(this._priceRangeSnapshot):null;this._logFormula=i,t=this._convertPriceRangeToLog(e),r&&(this._priceRangeSnapshot=this._convertPriceRangeToLog(r))}}this.setPriceRange(t)}else this.m_priceRange||(this.setPriceRange(new l.PriceRange(-.5,.5)),this._logFormula=(0,c.logFormulaForPriceRange)(null));this._invalidatedForRange.isValid=!0;const a=this.mainSource();null!==a&&this._recalculatePriceRangeOnce&&(this._recalculatePriceRangeOnce=!a.priceRangeReady())}_makeSureItIsValid(){this._invalidatedForRange.isValid||(this._invalidatedForRange.isValid=!0,this._recalculatePriceRangeImpl())}_invalidateInternalHeightCache(){this._internalHeightCache=null,this._internalHeightChanged.fire()}_coordinateToLogical(e){if(this._makeSureItIsValid(),this.isEmpty())return 0;const t=this._invertedCoordinate(e),i=(0,r.ensureNotNull)(this.priceRange()),s=i.minValue()+(i.maxValue()-i.minValue())*((t-this.bottomPixelMargin())/(this.internalHeight()-1));return this.logicalToPrice(s)}_logicalToCoordinate(e){if(this._makeSureItIsValid(),this.isEmpty())return 0;e=this.priceToLogical(e);const t=(0,
r.ensureNotNull)(this.priceRange()),i=this.bottomPixelMargin()+(this.internalHeight()-1)*(e-t.minValue())/(t.maxValue()-t.minValue());return this._invertedCoordinate(i)}_dropScaleCache(){this._sourcesForAutoscale=null,this._currencyCache=null,this._unitCache=null}_invertedCoordinate(e){return this.isInverted()?e:this.height()-1-e}_initScaleProperties(){const e=this.isLockScale(),t=this.properties().childs();e&&(t.percentage.setValue(!1),t.indexedTo100.setValue(!1),t.log.setValue(!1),t.autoScale.setValue(!1)),t.percentageDisabled.setValue(e),t.logDisabled.setValue(e),this._updateAutoScaleDisabledProperty(!1),t.percentage.value()&&(t.log.setValue(!1),t.indexedTo100.setValue(!1)),t.indexedTo100.value()&&(t.log.setValue(!1),t.percentage.setValue(!1))}_correctedMargins(){if(null===this._correctedMarginsCache){const e=this.mainSource();this._correctedMarginsCache=null!==e?e.correctScaleMargins(this._margins):this._margins}return this._correctedMarginsCache}_getSourcesToUpdateViews(){return this._sourcesToUpdateViews||(this._sourcesToUpdateViews=this.m_dataSources.filter(e=>!(0,T.isLineTool)(e)||e.isActualSymbol()&&e.isActualCurrency())),this._sourcesToUpdateViews}_mainSourceFormatter(){const e=this.mainSource();return(null==e?void 0:e.formatter())||A}_priceToPercentOrIndexedTo100IfNeeded(e,t){return this.isPercentage()?(0,c.toPercent)(e,t):this.isIndexedTo100()?(0,c.toIndexedTo100)(e,t):e}}},57086:(e,t,i)=>{"use strict";var r;i.d(t,{PriceAxisLastValueMode:()=>r}),function(e){e[e.LastPriceAndPercentageValue=0]="LastPriceAndPercentageValue",e[e.LastValueAccordingToScale=1]="LastValueAccordingToScale"}(r||(r={}))},67350:(e,t,i)=>{"use strict";i.r(t),i.d(t,{fromPercent:()=>o,toPercent:()=>a,toPercentRange:()=>l,fromIndexedTo100:()=>c,toIndexedTo100:()=>u,toIndexedTo100Range:()=>d,toLog:()=>h,fromLog:()=>p,logFormulaForPriceRange:()=>_,logFormulasAreSame:()=>m});var r=i(59757),s=i(84162);const n={logicalOffset:4,coordOffset:1e-4};function o(e,t){return t<0&&(e=-e),e/100*t+t}function a(e,t){const i=100*(e-t)/t;return t<0?-i:i}function l(e,t){const i=a(e.minValue(),t),s=a(e.maxValue(),t);return new r.PriceRange(i,s)}function c(e,t){return t<0&&(e=-e),(e-=100)/100*t+t}function u(e,t){const i=100*(e-t)/t+100;return t<0?-i:i}function d(e,t){const i=u(e.minValue(),t),s=u(e.maxValue(),t);return new r.PriceRange(i,s)}function h(e,t){const i=Math.abs(e);if(i<1e-15)return 0;const r=(0,s.log10)(i+t.coordOffset)+t.logicalOffset;return e<0?-r:r}function p(e,t){const i=Math.abs(e);if(i<1e-15)return 0;const r=Math.pow(10,i-t.logicalOffset)-t.coordOffset;return e<0?-r:r}function _(e){if(null===e)return n;const t=Math.abs(e.maxValue()-e.minValue());if(t>=1||t<1e-15)return n;const i=Math.ceil(Math.abs(Math.log10(t))),r=n.logicalOffset+i;return{logicalOffset:r,coordOffset:1/Math.pow(10,r)}}function m(e,t){return e.logicalOffset===t.logicalOffset&&e.coordOffset===t.coordOffset}},59757:(e,t,i)=>{"use strict";i.r(t),i.d(t,{PriceRange:()=>n});var r=i(31565);const s=(0,i(87380).getLogger)("Chart.PriceRange");class n{constructor(e,t){
if(null!==e&&"object"==typeof e){const t=e;this._minValue=t.m_minValue,this._maxValue=t.m_maxValue}else{const i=e;this._minValue=i,void 0!==t&&(this._maxValue=t)}}equals(e){return this._minValue===e._minValue&&this._maxValue===e._maxValue}clone(){return new n(this._minValue,this._maxValue)}minValue(){return this._minValue}setMinValue(e){this._minValue=e}maxValue(){return this._maxValue}setMaxValue(e){this._maxValue=e}length(){return this._maxValue-this._minValue}isEmpty(){return this._maxValue===this._minValue||this._maxValue!=this._maxValue||this._minValue!=this._minValue}serialize(){return{m_maxValue:this._maxValue,m_minValue:this._minValue}}state(){return{max:this._maxValue,min:this._minValue}}merge(e){return new n(Math.min(this.minValue(),e.minValue()),Math.max(this.maxValue(),e.maxValue()))}apply(e,t){this._minValue=Math.min(this._minValue,e),this._maxValue=Math.max(this._maxValue,t)}set(e,t){this._minValue=e,this._maxValue=t}scaleAroundCenter(e){if(!(0,r.isNumber)(e))return void s.logDebug("PriceRange.scaleAroundCenter: invalid coeff");if(0===this._maxValue-this._minValue)return;const t=.5*(this._maxValue+this._minValue);let i=this._maxValue-t,n=this._minValue-t;i*=e,n*=e,this._maxValue=t+i,this._minValue=t+n}shift(e){(0,r.isNumber)(e)?(this._maxValue+=e,this._minValue+=e):s.logDebug("PriceRange.shift: invalid coeff")}containsStrictly(e){return e.minValue()>this._minValue&&e.maxValue()<this._maxValue}static compare(e,t){return null===e||null===t?e===t:e.equals(t)}}},53353:(e,t,i)=>{"use strict";var r=i(96276),s=i(32411),n=s.study_ESD$TV_EARNINGS,o=s.study_ESD$TV_SPLITS,a=s.study_ESD$TV_DIVIDENDS,l=i(10769).PriceScaleBase,c=i(43854).PriceDataSource,u=i(59757).PriceRange,d=i(75443).randomHash,h=i(55304).isStudy,p=i(67350),_=p.fromLog,m=p.toLog;class f extends l{constructor(e,t){super(t),this._scalesProperties=e;var i=this;this._modeChanged=new r,this._properties.isInverted.listeners().subscribe(this,f.prototype._onIsInvertedChanged),this._properties.listeners().subscribe(null,(function(){if(i.mainSource()&&i.mainSource().model()){var e=i.mainSource().model().paneForSource(i.mainSource());i.mainSource().model().updatePane(e)}})),this._scalesProperties.listeners().subscribe(this,(function(){this._marksCache=null})),this.setId(d())}_convertPriceRangeFromLog(e){if(null===e)return null;var t=_(e.minValue(),this._logFormula),i=_(e.maxValue(),this._logFormula);return new u(t,i)}_convertPriceRangeToLog(e){if(null===e)return null;var t=m(e.minValue(),this._logFormula),i=m(e.maxValue(),this._logFormula);return new u(t,i)}_canConvertPriceRangeFromLog(e){if(null===e)return!1;var t=_(e.minValue(),this._logFormula),i=_(e.maxValue(),this._logFormula);return isFinite(t)&&isFinite(i)}mode(){return{autoScale:this._properties.autoScale.value(),lockScale:this._properties.lockScale.value(),percentage:this._properties.percentage.value(),indexedTo100:this._properties.indexedTo100.value(),log:this._properties.log.value()}}setMode(e){var t={},i=this.mode(),r=this._properties.state(),s=null
;void 0!==e.autoScale&&e.autoScale!==r.autoScale&&(t.autoScale=e.autoScale,this._setAutoScaleValueWithDependentProperties(e.autoScale)),void 0!==e.lockScale&&e.lockScale!==r.lockScale&&(t.lockScale=e.lockScale,this._setLockScaleValueWithDependentProperties(e.lockScale)),void 0!==e.percentage&&e.percentage!==r.percentage&&(t.percentage=e.percentage,this._setPercentageValueWithDependentProperties(e.percentage),this._invalidatedForRange.isValid=!1),void 0!==e.indexedTo100&&e.indexedTo100!==r.indexedTo100&&(t.indexedTo100=e.indexedTo100,this._setIndexedTo100ValueWithDependentProperties(e.indexedTo100),this._invalidatedForRange.isValid=!1),void 0!==e.log&&e.log!==r.log&&(t.log=e.log,this._setLogValueWithDependentProperties(e.log)),r.log&&!this._properties.log.value()&&(this._canConvertPriceRangeFromLog(this.m_priceRange)?null!==(s=this._convertPriceRangeFromLog(this.m_priceRange))&&this.setPriceRange(s):this.properties().autoScale.setValue(!0)),!r.log&&this._properties.log.value()&&null!==(s=this._convertPriceRangeToLog(this.m_priceRange))&&this.setPriceRange(s),r.autoScale!==this._properties.autoScale.value()&&this._properties.autoScale.listeners().fire(this._properties.autoScale),r.autoScaleDisabled!==this._properties.autoScaleDisabled.value()&&this._properties.autoScaleDisabled.listeners().fire(this._properties.autoScaleDisabled),r.lockScale!==this._properties.lockScale.value()&&this._properties.lockScale.listeners().fire(this._properties.lockScale),r.percentage!==this._properties.percentage.value()&&(this._properties.percentage.listeners().fire(this._properties.percentage),this.updateFormatter()),r.indexedTo100!==this._properties.indexedTo100.value()&&(this._properties.indexedTo100.listeners().fire(this._properties.indexedTo100),this.updateFormatter()),r.percentageDisabled!==this._properties.percentageDisabled.value()&&this._properties.percentageDisabled.listeners().fire(this._properties.percentageDisabled),r.log!==this._properties.log.value()&&this._properties.log.listeners().fire(this._properties.log),r.logDisabled!==this._properties.logDisabled.value()&&this._properties.logDisabled.listeners().fire(this._properties.logDisabled),void 0===t.log&&void 0===t.percentage&&void 0===t.lockScale&&void 0===t.autoScale&&void 0===t.indexedTo100||this._modeChanged.fire(i,this.mode())}modeChanged(){return this._modeChanged}fontSize(){return this._scalesProperties.fontSize.value()}isEmpty(){return this._makeSureItIsValid(),0===this.m_height||!this.m_priceRange||this.m_priceRange.isEmpty()}_onIsInvertedChanged(){this._marksCache=null,this._markBuilder.rebuildTickMarks()}canDetachSource(e){return this.m_dataSources.some((function(t){return t!==e&&!(t instanceof a||t instanceof o||t instanceof n)&&t instanceof c&&!(h(t)&&t.isLinkedToSeries())}))}}t.PriceScale=f},64297:(e,t,i)=>{"use strict";i.d(t,{createPrimitiveProperty:()=>n});var r=i(27937),s=i.n(r);function n(e){return new(s())(e)}},73582:(e,t,i)=>{"use strict";i.d(t,{createWVFromGetterAndSubscription:()=>n});var r=i(65066),s=i.n(r);function n(e,t){const i=new(s())(e()),r={}
;t.subscribe(r,()=>{i.setValue(e())});return i.readonly().spawn(()=>t.unsubscribeAll(r))}},27937:(e,t,i)=>{"use strict";var r=i(96276),s=i(31565).isFunction;function n(e){if(this._listeners=new r,this._childs=[],this._muteChildChanges=!1,void 0!==e)if(this.isPrimitiveType(e))this._value=e;else for(var t in e)this.addProperty(t,e[t])}n.prototype.merge=function(e,t){var i=null;if(t)var r=(i=[]).length;if(void 0===e)return i;if(this.isPrimitiveType(e))return t&&this._value!==e&&i.push(this),this._value=e,i;if(Array.isArray(e))for(var s=0;s<e.length;s++)if(this[s]){var n=this[s].merge(e[s],t);t&&(i=i.concat(n))}else this.addProperty(s,e[s]),t&&i.push(this[s]);else for(var o in e)if(this[o]){n=this[o].merge(e[o],t);t&&void 0!==n&&(i=i.concat(n))}else this.addProperty(o,e[o]),t&&i.push(this[o]);return t&&i.length>r&&i.push(this),i},n.prototype.mergeAndFire=function(e){var t=this.merge(e,!0);this._muteChildChanges=!0,t.forEach((function(e){e._muteChildChanges=!0})),t.forEach((function(e){e._muteChildChanges=!1,e.listeners().fire(e)})),this._muteChildChanges=!1,t.length>0&&this.listeners().fire(this)},n.prototype.state=function(e){var t=s(this.value)?this.value():void 0;void 0===t&&(t={});for(var i=0;i<this._childs.length;i++){var r=this._childs[i];if(e&&-1!==e.indexOf(r))continue;const s=this[r];let l;if(e){for(var n=[],o=0;o<e.length;o++){var a=e[o];a.startsWith(r+".")&&n.push(a.substr(r.length+1))}l=s.state(n)}else l=s.state();(void 0!==l||s.storeStateIfUndefined())&&(t[r]=l)}return t},n.prototype.storeStateIfUndefined=function(){return!0},n.prototype.clone=function(e){return new n(this.state())},n.prototype.isPrimitiveType=function(e){return null===e||(!!isNumber(e)||(!!new TradingView.TypeValidator(String).check(e)||TradingView.isBoolean(e)))},n.prototype.value=function(){return this._value},n.prototype.listeners=function(){return this._listeners},n.prototype.childCount=function(){return this._childs.length},n.prototype.childNames=function(){return this._childs},n.prototype.child=function(e){return this[e]},n.prototype.setValue=function(e,t){(this._value!==e||t)&&(this._value=e,this._listeners.fire(this))},n.prototype.setValueSilently=function(e){this._value=e},n.prototype.addProperty=function(e,t){var i=new n(t);this[e]=i,this._childs.push(e),i.subscribe(this,this.childChanged)},n.prototype.removeProperty=function(e){this[e].unsubscribe(this,this.childChanged),delete this[e],this._childs=this._childs.filter((function(t){return t!==e}))},n.prototype.hasChild=function(e){return this._childs.indexOf(e)>=0},n.prototype.addChild=function(e,t){this[e]&&this[e].unsubscribe(this,this.childChanged),this[e]=t,-1===this._childs.indexOf(e)&&this._childs.push(e),t.subscribe(this,this.childChanged)},n.prototype.childChanged=function(e,t){this._muteChildChanges||this.listeners().fire(this)},n.prototype.subscribe=function(e,t){this.listeners().subscribe(e,t,!1)},n.prototype.unsubscribe=function(e,t){this.listeners().unsubscribe(e,t)},n.prototype.unsubscribeAll=function(e){this.listeners().unsubscribeAll(e)},
n.prototype.childs=function(){return this},e.exports=n},93363:(e,t,i)=>{"use strict";var r;i.d(t,{PublishedChartsFilter:()=>r}),function(e){e.None="all",e.Following="following",e.Private="private"}(r||(r={}))},63145:(e,t,i)=>{"use strict";i.d(t,{PublishedChartsTimeline:()=>b});var r=i(42098),s=i.n(r),n=i(96238),o=i(4516),a=i(93363),l=i(87380),c=i(29098),u=i(68724),d=i(94972),h=i(16282),p=i(45963);const _=["green","red","neutral","yellow","blue"];class m extends p.BarMarksTooltip{constructor(){super(...arguments),this._source=null,this._layoutAvatar=null,this._layoutText=null,this._layoutUsername=null,this._layoutPin=null,this._pictureFetched=!1,this._plateData=null}_createLayout(){const e=document.createElement("div");e.classList.add("published-charts-tooltip"),this._layout=e;const t=document.createElement("div");t.classList.add("avatar"),t.appendChild(document.createElement("img")),e.appendChild(t),this._layoutAvatar=t;const i=document.createElement("div");i.classList.add("text"),e.appendChild(i),this._layoutText=i;const r=document.createElement("div");r.classList.add("username"),r.appendChild(document.createTextNode("by ")),r.appendChild(document.createElement("b")),e.appendChild(r),this._layoutUsername=r;const s=document.createElement("div");s.classList.add("pin"),e.appendChild(s),this._layoutPin=s,this._pictureFetched=!1,s.addEventListener("click",()=>{const e=(0,h.ensureNotNull)(this._plateData);e.pinned=!e.pinned,(0,h.ensureNotNull)(this._source).pinTooltip(e.id,e.pinned),s.classList.toggle("pinned",e.pinned)}),i.addEventListener("click",()=>{const e=(0,h.ensureNotNull)(this._plateData);(0,h.ensureNotNull)(this._source).showIdea(e.id,e.pinned)})}_updatePlate(e){this._plateData=e,(0,h.ensureNotNull)(this._layout).classList.remove(..._),(0,h.ensureNotNull)(this._layout).classList.add(e.themeName),(0,h.ensureNotNull)(this._layoutText).innerText=e.title,(0,h.ensureNotNull)((0,h.ensureNotNull)(this._layoutUsername).querySelector("b")).innerText=e.username,(0,h.ensureNotNull)(this._layoutPin).classList.toggle("pinned",e.pinned),this._pictureFetched||(this._pictureFetched=!0,fetch(`/api/v1/user/profile/${e.username}/?avatars_fallback=true&by=username`).then(e=>e.json()).then(t=>{const i=(0,h.ensureNotNull)(this._layoutAvatar),r=(0,h.ensureNotNull)(i.querySelector("img"));r.alt=e.username,void 0!==t.avatars&&(r.src=t.avatars.mid)}))}}var f=i(85864),g=i(85139),v=i(78776),S=i(1771);const y=(0,l.getLogger)("Chart.PublishedChartsTimeLine");class b extends n.BarsMarksContainer{constructor(e,t){let i=s().getValue("PublishedChartsTimeline.filter",a.PublishedChartsFilter.None);window.is_authenticated||(i=a.PublishedChartsFilter.None);super(e,new S.DefaultProperty("publishedchartstimeline",{filter:i})),this.toolname="PublishedChartsTimeline",this._currentRange=null,this._properties.childs().visible.subscribe(this,()=>{this._getData(this._currentRange)}),this.properties().childs().filter.subscribe(this,e=>{s().setValue("PublishedChartsTimeline.filter",e.value()),this.clearMarks(),this._getData(this._currentRange)}),
this._containsData=e.isSnapshot(),this._containsData&&this._properties.childs().visible.setValue(!0),this.setUserEditEnabled(!1),this._onIdeaClickedHandler=t}paneViews(){return this._model.isInReplay()?[]:super.paneViews()}showIdea(e,t){var i;const r=this._marks[e];if(r){if((0,c.trackEvent)("GUI","View published idea"),t&&(0,c.trackEvent)("GUI","Ideas navigation arrow"),(0,u.onWidget)()||this._containsData){let e=r.published_chart_url||"/v/"+r.image_url+"/";return e=this._getBaseUrl()+e,void window.open(e)}null===(i=this._onIdeaClickedHandler)||void 0===i||i.call(this,{chartId:r.image_url,chartName:r.name,publishedUrl:r.published_chart_url,shortSymbol:r.short_name})}else y.logDebug("PublishedChartsTimeline.showIdea: unexpected published chart id")}onClicked(e){null!==e&&this.showIdea(e.activeItem.id,!1)}state(e){const t={type:"BarsMarksContainer",id:this.id(),zorder:this.zorder(),pinnedTooltips:this._pinnedTooltips};return e&&(t.marks=this.getPublishedPlates()),t}asyncState(){return new Promise((e,t)=>{this._properties.childs().visible.value()?e(this.state(!0)):this._getData(this._currentRange,!0).then(()=>e(this.state(!0))).catch(t)})}restoreData(e,t){null!=e.pinnedTooltips&&(this._pinnedTooltips=e.pinnedTooltips),t&&void 0!==e.marks&&(this._marks=e.marks)}updateDotData(e,t){return{...t,mine:e.mine,public:e.public,direction:e.direction}}updatePlateData(e,t){return{...t,title:e.title,user_id:e.user_id,username:e.username,barWidth:this.barWidth()}}destroy(){this._onIdeaClickedHandler=null,this._boundOnMessage&&(o.off("ideas",this._boundOnMessage),o.off("ideas.post",this._boundOnMessage),this._boundOnMessage=null),super.destroy()}_initialize(){o&&(this._boundOnMessage=this._onMessage.bind(this),o.on("ideas",this._boundOnMessage),o.on("ideas.post",this._boundOnMessage))}_plateViewData(e){return{title:e.title,user_id:e.user__id,username:e.username,suggested:e.is_hot,mine:e.user__id===window.user.id,public:e.is_public}}_getData(e,t){const i=this._model.mainSeries().properties().childs(),r=this._model.mainSeries().symbolInfo();if(this._currentRange=e,!r||!this._properties.childs().visible.value()&&!t)return Promise.resolve([]);let s=r.base_name.length>1?r.base_name:[r.pro_name];const n=this.roundRange(this._rangeDifference(e));s=(0,d.uniq)(s),s=s.sort();const o=new FormData;o.append("interval",i.interval.value()),o.append("legs",JSON.stringify(s)),o.append("startTickmark",n.start.toString()),o.append("endTickmark",n.end.toString()),o.append("filter",this.properties().childs().filter.value());const a=(0,g.makeCancelable)(new Promise((e,t)=>{(0,f.fetch)("/charttimeline/",{method:"POST",body:o,headers:new Headers({acccept:"application/json","X-Requested-With":"XMLHttpRequest"})}).then(i=>{i.ok?i.json().then(e):t()}).catch(t)}));return a.promise.then(t=>{t.forEach(e=>{this._marks[e.id]=e}),this._loadedRange=this._rangeUnion(e,this._loadedRange);const i=this._requests.indexOf(a);~i&&this._requests.splice(i,1),this.onNeedRepaint.fire()}),this._requests.push(a),a.promise}_createTooltipRenderer(){
return new v.TooltipRenderer(()=>new m,this)}_onMessage(e,t,i,r){if(this._containsData)return;const s=this._model.mainSeries(),n=s.symbolInfo(),o=n&&n.base_name;if(!o)return;const a=s.properties().childs();e.interval===a.interval.value()&&~o.indexOf(e.pro_symbol)&&(this._marks[e.id]=e,this.onNeedRepaint.fire())}_getBaseUrl(){if((0,u.onWidget)()&&window.locale_domains){const e=window.locale||"en",t=window.locale_domains[e]?window.locale_domains[e]:window.locale_domains.en;return t?document.location.protocol+"//"+t:""}return""}}},76018:(e,t,i)=>{"use strict";i.d(t,{QuotesProvider:()=>a});var r=i(6798),s=i(96276),n=i.n(s),o=i(75443);class a{constructor(){this._quotes=null,this._quoteSessionSymbol=null,this._quoteSessionClientId="",this._quotesUpdate=new(n()),this._quoteSymbolChanged=new(n())}setQuotesSessionSymbol(e){this._quoteSessionSymbol!==e&&(this._quoteSessionClientId||(this._quoteSessionClientId="series-"+(0,o.guid)()),this._unsubscribeQuoteSession(),e&&this._subscribeQuoteSession(e),this._quoteSymbolChanged.fire())}quotesUpdate(){return this._quotesUpdate}quoteSymbolChanged(){return this._quoteSymbolChanged}quotes(){return this._quotes}destroy(){this._unsubscribeQuoteSession()}_onUpdate(e,t){this._quotes=e&&e.values||null,t&&t.values&&this._quotesUpdate.fire(e,t)}_subscribeQuoteSession(e){this._quoteSessionSymbol=e,(0,r.getQuoteSessionInstance)("full").subscribe(this._quoteSessionClientId,this._quoteSessionSymbol,this._onUpdate.bind(this))}_unsubscribeQuoteSession(){this._quoteSessionSymbol&&((0,r.getQuoteSessionInstance)("full").unsubscribe(this._quoteSessionClientId,this._quoteSessionSymbol),this._quoteSessionSymbol=null,this._quotes=null)}}},71004:(e,t,i)=>{"use strict";i.d(t,{rangesAreEqual:()=>n});var r=i(25143),s=i(2459);function n(e,t){return!!s.Interval.isEqual(e.res,t.res)&&(0,r.areEqualTimeFrames)(e.val,t.val)}},95612:(e,t,i)=>{"use strict";var r,s;i.d(t,{ResponseMethods:()=>r}),function(e){e.error="replay_error",e.point="replay_point",e.ok="replay_ok",e.resolutions="replay_resolutions",e.endOfData="replay_data_end",e.instanceId="replay_instance_id"}(r||(r={})),function(e){e.tooSmallDelay="too_small_delay",e.alreadyInAutoplay="already_in_autoplay",e.nothingToStop="nothing_to_stop",e.pointTooDeep="point_too_deep",e.alreadyInSession="already_in_session",e.thereIsNoSuchSeries="no_series",e.notAllowedInAutoplay="not_allow_in_autoplay",e.invalidResolution="invalid_resolution"}(s||(s={}))},19453:(e,t,i)=>{"use strict";i.r(t),i.d(t,{normalizeIntervalString:()=>h,isAvailable:()=>p,setLastUsedResolution:()=>_,getRangeResolution:()=>m,getTimeBasedResolution:()=>f,getDefaultResolution:()=>g,getResolutionByChartStyle:()=>v,getServerInterval:()=>S,isResolutionMultiplierValid:()=>y,getMaxResolutionValue:()=>w,getResolutionsFromSettings:()=>P,convertResolutionsFromSettings:()=>C,mergeResolutions:()=>T,sortResolutions:()=>x,getCustomResolutions:()=>M,getTranslatedResolution:()=>E,getTranslatedResolutionModel:()=>A,isSecondsEnabled:()=>D,isTicksEnabled:()=>R});i(20220)
;var r=i(2459),s=i(20554),n=i(42098),o=i(52946),a=i(94972),l=i(31565);i(22842);const c={[r.ResolutionKind.Ticks]:1,[r.ResolutionKind.Seconds]:60,[r.ResolutionKind.Minutes]:1440,[r.SpecialResolutionKind.Hours]:24,[r.ResolutionKind.Days]:365,[r.ResolutionKind.Weeks]:52,[r.ResolutionKind.Months]:12,[r.ResolutionKind.Range]:1e6,[r.ResolutionKind.Invalid]:NaN},u={[r.ResolutionKind.Ticks]:0,[r.ResolutionKind.Seconds]:1,[r.ResolutionKind.Minutes]:2,[r.SpecialResolutionKind.Hours]:3,[r.ResolutionKind.Days]:4,[r.ResolutionKind.Weeks]:5,[r.ResolutionKind.Months]:6,[r.ResolutionKind.Range]:7,[r.ResolutionKind.Invalid]:8},d={[r.ResolutionKind.Invalid]:"",[r.ResolutionKind.Ticks]:window.t("T",{context:"interval_short"}),[r.ResolutionKind.Seconds]:window.t("s",{context:"interval_short"}),[r.ResolutionKind.Minutes]:window.t("m",{context:"interval_short"}),[r.SpecialResolutionKind.Hours]:window.t("h",{context:"interval_short"}),[r.ResolutionKind.Days]:window.t("D",{context:"interval_short"}),[r.ResolutionKind.Weeks]:window.t("W",{context:"interval_short"}),[r.ResolutionKind.Months]:window.t("M",{context:"interval_short"}),[r.ResolutionKind.Range]:window.t("R",{context:"interval_short"})};function h(e){return r.Interval.parse(e).value()}function p(e){const t=r.Interval.parse(e);if(t.isRange())return o.linking.range.value();const i=t.value(),s=o.linking.supportedResolutions.value();return void 0!==s?void 0!==s.find(e=>h(e)===i):t.isIntraday()?Boolean(o.linking.intraday.value()):t.isDWM()}function _(e){r.Interval.isValid(e)&&(r.Interval.isRange(e)?n.setValue("chart.lastUsedRangeResolution",e):n.setValue("chart.lastUsedTimeBasedResolution",e))}function m(e){const t=n.getValue("chart.lastUsedRangeResolution");if(void 0!==t&&r.Interval.isRange(t))return t;let i="100R";for(const t of e){const e=r.Interval.parse(t);if(e.isRange()){const t=e.value();if("100R"===t)return t;i=t}}return i}function f(e){const t=n.getValue("chart.lastUsedTimeBasedResolution");if(void 0!==t&&r.Interval.isTimeBased(t))return t;let i="1D";for(const t of e){const e=r.Interval.parse(t);if(e.isTimeBased()){const t=e.value();if("1D"===t)return t;i=t}}return i}function g(e){return e?"100R":"1D"}function v(e,t,i){const n=s.isRangeStyle(e),o=r.Interval.isRange(t);return!n&&o?f(i):n&&!o?m(i):t}function S(e){return r.Interval.isRange(e)?"1":e}function y(e){const t=r.Interval.parse(e),i=b(t.kind()),s=t.multiplier();return t.isValid()&&s<=i}function b(e){const t=c[e];return Number.isNaN(t)?1:t}function w(e){return b(r.Interval.kind(e))}function P(e){const t=C(n.getJSON(e,[]));return(0,a.uniq)(t.filter(y).map(h))}function C(e){return Array.isArray(e)?e:Object.keys(e).map(r.Interval.normalize).filter(l.notNull)}function T(...e){let t=[].concat(...e);return t=(0,a.uniq)(t.filter(y).map(h)),x(t)}function x(e){return e.sort(L)}function I(e){const t=r.Interval.parse(e),i=t.multiplier()||1;return t.isMinuteHours()?[r.SpecialResolutionKind.Hours,i/60]:[t.kind(),i]}function L(e,t){const[i,r]=I(e),[s,n]=I(t);return i!==s?u[i]-u[s]:r-n}function M(){let e=[]
;return window.user.is_pro&&(e=P("IntervalWidget.intervals")),e}function E(e){const{multiplier:t,shortKind:i}=A(e);return`${t}${i}`}function A(e,t){const i=r.Interval.parse(e);let s=i.multiplier(),n=i.kind();if(!i.isValid()){if(t)return null;throw new TypeError("Can't translate invalid interval")}return i.isMinuteHours()&&(s=Math.floor(s/60),n=r.SpecialResolutionKind.Hours),{multiplier:s.toString(),shortKind:k(n),hint:`${s} ${k(n,s)}`,mayOmitMultiplier:i.isDWM()&&1===s,mayOmitShortKind:i.isMinutes()&&!i.isMinuteHours()}}function k(e,t){if(!t)return d[e];switch(e){case r.ResolutionKind.Ticks:return window.t("tick",{plural:"ticks",count:t});case r.ResolutionKind.Days:return window.t("day",{plural:"days",count:t});case r.ResolutionKind.Weeks:return window.t("week",{plural:"weeks",count:t});case r.ResolutionKind.Months:return window.t("month",{plural:"months",count:t});case r.ResolutionKind.Seconds:return window.t("second",{plural:"seconds",count:t});case r.ResolutionKind.Minutes:return window.t("minute",{plural:"minutes",count:t});case r.SpecialResolutionKind.Hours:return window.t("hour",{plural:"hours",count:t});case r.ResolutionKind.Range:return window.t("range",{plural:"ranges",count:t});default:return e}}function D(){return!0}function R(){return!1}},940:(e,t,i)=>{"use strict";i.d(t,{scaleRatio:()=>s,priceRangeByScaleRatio:()=>n,barSpacingByScaleRatio:()=>o});var r=i(59757);function s(e,t){if(t.isLog()||e.isEmpty()||t.isEmpty())return null;const i=function(e){if(e.isEmpty())return null;const t=e.priceRange();if(null===t)return null;const i=t.length();return e.internalHeight()/i}(t);if(null===i)return null;return e.getValidBarSpacing()/Math.max(1e-10,i)}function n(e,t,i){if(e.isLog()||null===i||e.isEmpty())return null;const s=e.priceRange();if(null===s||s.isEmpty())return null;const n=e.internalHeight()/(t/i),o=s.length();if(n===o)return s;const a=(n-o)/2;return new r.PriceRange(s.minValue()-a,s.maxValue()+a)}function o(e,t){if(e.isLog()||null===t||e.isEmpty())return null;const i=e.priceRange();if(null===i)return null;const r=i.length();return e.internalHeight()/r*t}},36436:(e,t,i)=>{"use strict";i.d(t,{createPriceScaleSelectionStrategy:()=>a,allPriceScaleSelectionStrategyInfo:()=>l});var r=i(16282),s=i(55304);class n{constructor(e){this._priceScalesLimit=8,this._metaInfo=e}metaInfo(){return this._metaInfo}findSuitableScale(e,t,i,r){if(void 0!==r)return this._tryToGetDesiredPriceScale(e,t,r,i);if((0,s.isStudy)(t)){const r=t.metaInfo();if("Volume"===r.shortId&&e.containsMainSeries())return e.createPriceScaleAtPosition("overlay");const n=t.desiredPriceScalePosition();if(null!==n)return this._tryToGetDesiredPriceScale(e,t,n,i);if(void 0!==i&&((0,s.isStudy)(i)||e.isMainPane())&&r.is_price_study)return this._getPriceScaleTheSameAsForSource(i,e)}let n=!1;if((0,s.isStudy)(t)){const i=t.metaInfo().groupingKey;if(void 0!==i){const t=e.model().findNonOverlayStudyWithGroupingKey(i,e);if(null!==t)return this._getPriceScaleTheSameAsForSource(t.study,t.pane)}n=Boolean(t.metaInfo().is_price_study)
}else t===e.model().mainSeries()&&(n=!0);if(n){const t=this._findFirstScaleForPriceStudy(e);if(null!==t)return t}return this.createNewPriceScaleIfPossible(e)}canCreateNewPriceScale(e){return e.leftPriceScales().length+e.rightPriceScales().length<this._priceScalesLimit}_getPriceScaleTheSameAsForSource(e,t){return t.isOverlay(e)?t.createPriceScaleAtPosition("overlay"):(0,r.ensureNotNull)(e.priceScale())}_priceScaleIsPrice(e,t){const i=e.mainSource();return!!i&&(i===t.mainSeries()||!!(0,s.isStudy)(i)&&Boolean(i.metaInfo().is_price_study))}_findFirstScaleForPriceStudy(e){const t=e.model();for(let i=0;i<this._priceScalesLimit;i++){if(e.rightPriceScales().length>i&&this._priceScaleIsPrice(e.rightPriceScales()[i],t))return e.rightPriceScales()[i];if(e.leftPriceScales().length>i&&this._priceScaleIsPrice(e.leftPriceScales()[i],t))return e.leftPriceScales()[i]}return null}_targetPriceScaleIndex(e,t){if(e.mainSource()===t.mainSeries())return 0}_tryToGetDesiredPriceScale(e,t,i,s){switch(i){case"left":return this.canCreateNewPriceScale(e)?e.createPriceScaleAtPosition("left"):e.createPriceScaleAtPosition("overlay");case"right":return this.canCreateNewPriceScale(e)?e.createPriceScaleAtPosition("right"):e.createPriceScaleAtPosition("overlay");case"as-series":return void 0!==s?(0,r.ensureNotNull)(s.priceScale()):e.isMainPane()?(0,r.ensureNotNull)((0,r.ensureNotNull)(e.mainDataSource()).priceScale()):this.createNewPriceScaleIfPossible(e);case"overlay":return e.createPriceScaleAtPosition("overlay")}}}const o=[{name:"left",title:window.t("Stack On The Left"),ctor:class extends n{constructor(e){super(e)}apply(e){const t=e.model();e.rightPriceScales().slice(0).forEach(i=>e.movePriceScale(i,"left",this._targetPriceScaleIndex(i,t)))}createNewPriceScaleIfPossible(e){return this.canCreateNewPriceScale(e)?e.createPriceScaleAtPosition("left"):e.createPriceScaleAtPosition("overlay")}}},{name:"right",title:window.t("Stack On The Right"),ctor:class extends n{constructor(e){super(e)}apply(e){const t=e.model();e.leftPriceScales().slice(0).forEach(i=>e.movePriceScale(i,"right",this._targetPriceScaleIndex(i,t)))}createNewPriceScaleIfPossible(e){return this.canCreateNewPriceScale(e)?e.createPriceScaleAtPosition("right"):e.createPriceScaleAtPosition("overlay")}}},{name:"auto",title:window.t("Auto"),ctor:class extends n{constructor(e){super(e)}apply(e){if(e.containsMainSeries()){const t=(0,r.ensureNotNull)((0,r.ensureNotNull)(e.mainDataSource()).priceScale());e.movePriceScale(t,"right",0)}const t=e.model();for(;e.leftPriceScales().length>e.rightPriceScales().length;){const i=e.leftPriceScales()[e.leftPriceScales().length-1];e.movePriceScale(i,"right",this._targetPriceScaleIndex(i,t))}for(;e.rightPriceScales().length-e.leftPriceScales().length>1;){const i=e.rightPriceScales()[e.rightPriceScales().length-1];e.movePriceScale(i,"left",this._targetPriceScaleIndex(i,t))}}createNewPriceScaleIfPossible(e){if(!this.canCreateNewPriceScale(e))return e.createPriceScaleAtPosition("overlay");const t=e.leftPriceScales().length<e.rightPriceScales().length?"left":"right"
;return e.createPriceScaleAtPosition(t)}}}];function a(e){const t=(0,r.ensureDefined)(o.find(t=>t.name===e));return new t.ctor(t)}function l(){return o}},57746:(e,t,i)=>{"use strict";var r=i(96276),s=i(18184),n=i(16282).assert,o=i(29098).trackEvent,a=i(41962).TVXWindowEvents,l=i(87380).getLogger("Pine.ScriptLib"),c=i(10164).telemetry,u=i(88001),d={fast:["delete","get","is_auth_to_get","is_auth_to_write","parse_title","rename","lib_list"],medium:["list","eval_pine_ex","translate_light"],slow:["process_legacy","publish","save","translate","translate_source","gen_alert"]};var h={};function p(){h._cache={}}h._isAuthCache=new p,h._pineDeleted=new r,a.on("TVScriptModified",(function(e){h.clearSavedScriptsCache(),h.scriptUpdater()&&h.scriptUpdater().onTVScriptModified(JSON.parse(e))})),a.on("TVScriptDeleted",(function(e){h.clearAllCaches(),h.scriptUpdater()&&h.scriptUpdater().onTVScriptDeleted(JSON.parse(e))})),a.on("TVScriptRenamed",(function(e){h.clearSavedScriptsCache(),h.scriptUpdater()&&h.scriptUpdater().onTVScriptRenamed(JSON.parse(e))})),a.on("TVScriptLegacyPineProcessed",(function(e){h.clearSavedScriptsCache(),h.scriptUpdater()&&h.scriptUpdater().onTVScriptLegacyPineProcessed(JSON.parse(e))})),h.PINE_FACADE_URL=function(){return window.PINE_URL},h.onPineDeleted=function(){return h._pineDeleted},h._pineFacadeAjax=function(e,t,i,r){l.logNormal("Requesting pine facade scripts, url: "+t);var n=function(e,t){for(var i=Object.keys(d),r=0;r<i.length;r++){var s=d[i[r]].filter((function(t){return-1!==e.indexOf(t)}));if(Boolean(s.length))return i[r]}return!1}(t),o=Date.now(),a=r?void 0:{withCredentials:!0};return s.ajax({url:h.PINE_FACADE_URL()+t,type:e,data:i||{},dataType:"json",xhrFields:a}).done((function(){var e=Date.now()-o;c.sendReport("pine",n+"_group_time_frame",{value:e}),c.sendReport("pine",n+"_group_ok"),l.logNormal("Requesting pine facade scripts finished, url: "+t)})).fail((function(){var e=Date.now()-o;c.sendReport("pine",n+"_group_time_frame",{value:e}),c.sendReport("pine",n+"_group_error"),l.logError("Requesting pine facade scripts failed, url: "+t)}))},h.convertScript=function(e,t){var i=s.Deferred(),r={source:e,version_to:t};return h._pineFacadeAjax("POST","/convert/",r).done((function(e,t,r){e.error?i.reject(h._readableError(e.error)):i.resolve(e)})).fail((function(e,t,r){h._anyRequestAsyncFail(i,e)})),i.promise()},h.translateScriptAsync=function(e,t,i,r){o("Pine","ScriptLib.translateScript"),r=!!r;var n=s.Deferred(),a="/translate_source/"+encodeURIComponent(t)+"/?is_pine_ex="+r,l={user_name:window.user&&window.user.username,source:e,inputs:JSON.stringify(i||{})};return h._pineFacadeAjax("POST",a,l).done((function(e,t,i){h._translateScriptAsyncDone(n,e)})).fail((function(e,t,i){h._anyRequestAsyncFail(n,e)})),n.promise()},h.translateScriptAsync2=function(e,t){l.logNormal("translateScriptAsync2, pineId="+e+" pineVersion="+t),o("Pine","ScriptLib.translateScript")
;var i=s.Deferred(),r=0!==e.indexOf("USER"),n=window.user&&window.user.username,c="?user_name="+encodeURIComponent(n),d="/translate/"+encodeURIComponent(e)+"/"+t+"/";return r||null==n||(d+=c),h._pineFacadeAjax("GET",d,void 0,r).done((function(e,r,s){if(h._translateScriptAsyncDone(i,e),t<0){h.clearSavedScriptsCache();var n={scriptMetaInfo:e.result.metaInfo};a.emit("TVScriptLegacyPineProcessed",JSON.stringify(n)),u.emit("TVScriptLegacyPineProcessed",n),setTimeout((function(){n.isSelfCall=!0,null!=h.scriptUpdater()&&h.scriptUpdater().onTVScriptLegacyPineProcessed(n)}),0)}})).fail((function(e,t,r){h._anyRequestAsyncFail(i,e)})),i.promise()},h._translateScriptAsyncDone=function(e,t){if(t.error)e.reject(h._readableError(t.error));else if(t.success)e.resolve(t.result.metaInfo,t.result.IL);else{var i=t.result?t.result.metaInfo:null;e.reject(t.reason,i)}},h._saveScriptAsyncDone=function(e,t){if(t.error)e.reject(h._readableError(t.error));else if(t.success)e.resolve(t.result.metaInfo);else{var i=t.result?t.result.metaInfo:null;e.resolve(i,t.reason)}},h._generateAlertAsyncDone=function(e,t){if(t.error)e.reject(h._readableError(t.error));else if(t.success)e.resolve(t.result.metaInfo,t.result.IL,t.result.inputs||null,t.result.gen_alert_data||null);else{var i=t.result?t.result.metaInfo:null;e.reject(t.reason,i)}},h._readableError=function(e,t){return t},h._anyRequestAsyncFail=function(e,t){0===h.PINE_FACADE_URL().indexOf("http")&&l.logError(t.responseText),e.reject(h._readableError(t.status,t.statusText))},h.isAuthToWritePineScript=function(e){var t="write_"+e,i=h._isAuthCache.getPromise(t);if(null!==i)return i;o("Pine","ScriptLib.isAuthToWritePineScript");var r=s.Deferred(),n="/is_auth_to_write/"+encodeURIComponent(e);return h._pineFacadeAjax("GET",n).done((function(e,t,i){r.resolve(e)})).fail((function(e,t,i){h._anyRequestAsyncFail(r,e)})),h._isAuthCache.setPromise(t,r.promise())},h.isAuthToGetPineSourceCode=function(e,t){var i="get_"+e+"_"+t,r=h._isAuthCache.getPromise(i);if(null!==r)return r;o("Pine","ScriptLib.isAuthToGetPineSourceCode");var n=s.Deferred(),a="/is_auth_to_get/"+encodeURIComponent(e)+"/"+t;return h._pineFacadeAjax("GET",a).done((function(e,t,i){n.resolve(e)})).fail((function(e,t,i){h._anyRequestAsyncFail(n,e)})),h._isAuthCache.setPromise(i,n.promise())},p.prototype.getPromise=function(e){var t=h._cache[e];return void 0===t?null:void 0!==t.value?s.Deferred().resolve(t.value):void 0!==t.promise?t.promise:null},p.prototype.setPromise=function(e,t){return h._cache[e]={promise:t},t.done((function(t){h._cache[e]={value:t}})).fail((function(t){delete h._cache[e]})),t},h.getPineSourceCode=function(e,t,i){o("Pine","ScriptLib.getPineSourceCode");var r=s.Deferred(),n="?no_4xx="+!!i,a="/get/"+encodeURIComponent(e)+"/"+t+n;return h._pineFacadeAjax("GET",a).done((function(e,t,i){!1===e.success?r.reject(e.reason):r.resolve(e)})).fail((function(e,t,i){h._anyRequestAsyncFail(r,e)})),r.promise()},h.saveNewDraft=function(e){o("Pine","ScriptLib.saveNewDraft");var t=s.Deferred()
;if(null==e||""===e)return t.reject(s.t("Cannot save empty source code"));var i=window.user&&window.user.username,r="/save/new_draft/?user_name="+encodeURIComponent(i)+"&allow_use_existing_draft=true",n={source:e};return h._pineFacadeAjax("POST",r,n).done((function(e,i,r){h._translateScriptAsyncDone(t,e)})).fail((function(e,i,r){h._anyRequestAsyncFail(t,e)})),t.promise()},h.saveNextDraft=function(e,t,i){o("Pine","ScriptLib.saveNextDraft");var r=s.Deferred();if(null==t||""===t)return r.reject(s.t("Cannot save empty source code"));var n=window.user&&window.user.username,a=(i=!!i,"/save/next_draft/"+encodeURIComponent(e)+"/?user_name="+encodeURIComponent(n)+"&allow_create_new="+i),l={source:t};return h._pineFacadeAjax("POST",a,l).done((function(e,t,i){h._translateScriptAsyncDone(r,e)})).fail((function(e,t,i){h._anyRequestAsyncFail(r,e)})),r.promise()},h.processLegacy=function(e,t){o("Pine","ScriptLib.processLegacy");var i=s.Deferred(),r=window.user&&window.user.username,n="/process_legacy/"+encodeURIComponent(e)+"/?user_name="+encodeURIComponent(r),a={};return null!=t&&""!==t&&(a.source=t),h._pineFacadeAjax("POST",n,a).done((function(e,t,r){h._translateScriptAsyncDone(i,e)})).fail((function(e,t,r){h._anyRequestAsyncFail(i,e)})),i.promise()},h.generateAlert=function(e){o("Pine","ScriptLib.generateAlert");var t=s.Deferred(),i=window.user&&window.user.username,r="/gen_alert/?user_name="+encodeURIComponent(i),n={alert_info:e},a=Date.now();return h._pineFacadeAjax("POST",r,n).done((function(e,i,r){c.sendReport("alerts","compilation_ok"),h._generateAlertAsyncDone(t,e)})).fail((function(e,i,r){c.sendReport("alerts","compilation_error"),h._anyRequestAsyncFail(t,e)})).always((function(){var e=Date.now()-a;c.sendReport("alerts","compilation_time_frame",{value:e})})),t.promise()},h.parseScriptTitleAsync=function(e){o("Pine","ScriptLib.parseScriptTitle");var t=s.Deferred();if(null==e||""===e)return t.reject(s.t("Cannot save empty source code"));var i={user_name:window.user&&window.user.username,source:e};return h._pineFacadeAjax("POST","/parse_title/",i).done((function(e,i,r){e.error?t.reject(h._readableError(e.error)):e.success?t.resolve(e.result):t.reject(e.reason)})).fail((function(e){h._anyRequestAsyncFail(t,e)})),t.promise()},h.evalMetaInfoExprsAsync=function(e,t){o("Pine","ScriptLib.evalMetaInfoExprs");var i=s.Deferred(),r={username:window.user&&window.user.username,source:e,inputs:JSON.stringify(t||{})};return h._pineFacadeAjax("POST","/eval_pine_ex/",r).done((function(e,t,r){e.error?i.reject(h._readableError(e.error)):e.success?i.resolve(e.result):i.reject(e.reason)})).fail((function(e){h._anyRequestAsyncFail(i,e)})),i.promise()},h.patchPropertiesAsync=function(e,t,i){return l.logNormal("patchPropertiesAsync"),new Promise((function(r,s){if(t.TVScriptMetaInfoExprs){var o=t.TVScriptMetaInfoExprs.tree,a=t.TVScriptMetaInfoExprs.patchMap;h.evalMetaInfoExprsAsync(o,i).done((function(t){for(var i=t.rootValues,s=Object.keys(a),o=0;o<s.length;o++){var l=s[o],c=i[a[l]],u=l.split(".");"defaults"===u[0]&&u.splice(0,1),
n(u.length>1,"Unexpectedly short json path");for(var d=e,h=0;h<u.length-1;++h)d=d[u[h]];d[u[u.length-1]].setValue(c)}r(e)})).fail((function(e){s(e)}))}else r(e)}))},h.scriptUpdater=function(){return window.scriptUpdater},h.clearAllCaches=function(){h.clearIsAuthToCaches(),h.clearSavedScriptsCache()},h.clearIsAuthToCaches=function(e){e?Object.keys(h._cache).filter((function(t){return t.indexOf(e)>=0})).forEach((function(e){delete h._cache[e]})):h._isAuthCache=new p},h.clearSavedScriptsCache=function(e){delete h._userScriptsDfd},h.requestUserScripts=function(e){if(o("Pine","ScriptLib.requestUserScripts"),window.is_authenticated){if(!h._userScriptsDfd){h._userScriptsDfd=s.Deferred();var t=h._userScriptsDfd;h._pineFacadeAjax("GET","/list?filter=saved").done((function(e,i,r){t.resolve(e)})).fail((function(e){h._anyRequestAsyncFail(t,e)}))}t=h._userScriptsDfd}else t=s.Deferred().resolve([]);return"function"==typeof e&&t.done(e),t.promise()},h.setUserScripts=function(e){h._userScriptsDfd||(h._userScriptsDfd=s.Deferred().resolve(e))},h.requestUserPublishedScripts=function(e,t){if(o("Pine","ScriptLib.requestUserPublishedScripts"),window.is_authenticated){if(t||!h._userPublishedScriptsDfd){h._userPublishedScriptsDfd=s.Deferred();var i=h._userPublishedScriptsDfd;h._pineFacadeAjax("GET","/list?filter=published").done((function(e,t,r){i.resolve(e)})).fail((function(e){h._anyRequestAsyncFail(i,e)}))}i=h._userPublishedScriptsDfd}else i=s.Deferred().resolve([]);return"function"==typeof e&&i.done(e),i.promise()},h.requestPineEditorNewTemplateScripts=function(e){o("Pine","ScriptLib.requestPineEditorNewTemplateScripts");var t=s.Deferred();return h._pineFacadeAjax("GET","/list/?filter=template",void 0,!0).done((function(e,i,r){t.resolve(e)})).fail((function(e){h._anyRequestAsyncFail(t,e)})),"function"==typeof e&&t.done(e),t.promise()},h.requestInfoForScripts=function(e){return Promise.all([h._pineFacadeAjax("GET","/list?filter=saved"),h._pineFacadeAjax("GET","/list?filter=addon",void 0,!0)]).then((function(t){var i=t[0],r=t[1];return i.concat(r).filter((function(t){return e.includes(t.scriptIdPart)}))}))},h.requestBuiltinScripts=function(){o("Pine","ScriptLib.requestBuiltinScripts"),l.logNormal("Request built-in scripts");var e=s.Deferred();return h._pineFacadeAjax("GET","/list/?filter=standard",void 0,!0).done((function(t,i,r){l.logNormal("Request built-in scripts finished"),e.resolve(t)})).fail((function(t){l.logWarn("Request built-in scripts finished with fail"),h._anyRequestAsyncFail(e,t)})),e.promise()},h.requestBuiltinAndUserScripts=function(){o("Pine","ScriptLib.requestBuiltinAndUserScripts"),l.logNormal("Request built-in and user scripts");var e,t=window.user&&window.user.username,i={},r=new Promise((function(t,r){e=t,i.reject=r}));return Promise.all([h._pineFacadeAjax("GET","/list?filter=saved&user_name="+encodeURIComponent(t),void 0,!1),h._pineFacadeAjax("GET","/list?filter=standard",void 0,!0)]).then((function(t){l.logNormal("Request built-in and user scripts finished");var i=t[0],r=t[1];e(i.concat(r))})).catch((function(e){
l.logWarn("Request built-in and user scripts finished with fail"),h._anyRequestAsyncFail(i,e)})),r},h.requestCandlestickScripts=function(){var e;o("Pine","ScriptLib.requestCandlestickScripts"),l.logNormal("Request candlestick scripts");var t={},i=new Promise((function(i,r){e=i,t.reject=r}));return h._pineFacadeAjax("GET","/list?filter=candlestick",void 0,!0).done((function(t){l.logNormal("Request candlestick scripts finished"),e(t)})).fail((function(e){l.logWarn("Request candlestick scripts finished with fail"),h._anyRequestAsyncFail(t,e)})),i};var _={time:-1/0,request:null};h.requestFundamentalScripts=function(){if(_.time+6e5>Date.now()&&null!==_.request)return l.logNormal("Return fundamentals from cache"),_.request;l.logNormal("Request fundamental scripts");var e=h._pineFacadeAjax("GET","/list?filter=fundamental",void 0,!1);return e.then((function(e){l.logNormal("Request fundamental scripts finished")})),e.fail((function(e){l.logWarn("Request fundamental scripts finished with fail, resetting cache"),_.request=null})),_.time=Date.now(),_.request=Promise.resolve(e.promise()),_.request},h.requestPineAddons=function(e){o("Pine","ScriptLib.requestPineAddons");var t=s.Deferred();return h._pineFacadeAjax("GET","/list?filter=addon&pine_id_prefix="+e).done((function(e){t.resolve(e)})).fail((function(e){h._anyRequestAsyncFail(t,e)})),t},h._updateAliveScriptInstances=function(e,t){var i={};i.scriptMetaInfo=e.result.metaInfo,i.scriptVersionToUpdate=t,a.emit("TVScriptModified",JSON.stringify(i)),u.emit("TVScriptModified",i),setTimeout((function(){i.isSelfCall=!0,null!=h.scriptUpdater()&&h.scriptUpdater().onTVScriptModified(i)}),0)},h.saveNew=function(e,t,i,r){o("Pine","ScriptLib.saveNew");var n=s.Deferred();if(null==e||""===e)return n.reject(s.t("Cannot save empty source code"));var a=window.user&&window.user.username,l=i?"&allow_overwrite=true":"",c="/save/new/?name="+encodeURIComponent(t)+"&user_name="+encodeURIComponent(a)+l,u={source:e};return h._pineFacadeAjax("POST",c,u).done((function(e,t,i){h.clearSavedScriptsCache(),h._updateAliveScriptInstances(e,r),h._saveScriptAsyncDone(n,e)})).fail((function(e,t,i){h._anyRequestAsyncFail(n,e)})),n.promise()},h.saveNext=function(e,t,i,r,n){o("Pine","ScriptLib.saveNext");var a=null!=i?"&name="+encodeURIComponent(i):"",l=s.Deferred();if(null==t||""===t)return l.reject(s.t("Cannot save empty source code"));var c=window.user&&window.user.username,u="/save/next/"+encodeURIComponent(e)+"/?user_name="+encodeURIComponent(c)+"&allow_create_new="+!!n+a,d={source:t};return h._pineFacadeAjax("POST",u,d).done((function(e,t,i){h.clearSavedScriptsCache(),h._updateAliveScriptInstances(e,r),h._saveScriptAsyncDone(l,e)})).fail((function(e,t,i){h._anyRequestAsyncFail(l,e)})),l.promise()},h.deletePine=function(e){o("Pine","ScriptLib.deletePine");var t=s.Deferred(),i=window.user&&window.user.username,r="/delete/"+encodeURIComponent(e)+"/?user_name="+encodeURIComponent(i);return h._pineFacadeAjax("POST",r).done((function(i,r,s){h.clearIsAuthToCaches(e),h.clearSavedScriptsCache(),t.resolve(i);var n={
scriptIdPart:e};a.emit("TVScriptDeleted",JSON.stringify(n)),u.emit("TVScriptDeleted",n),setTimeout((function(){n.isSelfCall=!0,null!=h.scriptUpdater()&&h.scriptUpdater().onTVScriptDeleted(n),h._pineDeleted.fire(e)}),0)})).fail((function(e,i,r){h._anyRequestAsyncFail(t,e)})),t.promise()},h.renamePine=function(e,t,i){o("Pine","ScriptLib.renamePine");var r=s.Deferred(),n=window.user&&window.user.username,l="/rename/"+encodeURIComponent(e)+"/?name="+encodeURIComponent(t)+"&user_name="+encodeURIComponent(n)+"&force="+encodeURIComponent(!!i);return h._pineFacadeAjax("POST",l).done((function(i,s,n){h.clearSavedScriptsCache();var o={scriptIdPart:e,scriptName:t};a.emit("TVScriptRenamed",JSON.stringify(o)),u.emit("TVScriptRenamed",o),setTimeout((function(){o.isSelfCall=!0,null!=h.scriptUpdater()&&h.scriptUpdater().onTVScriptRenamed(o)}),0),r.resolve(i)})).fail((function(e,t,i){h._anyRequestAsyncFail(r,e)})),r.promise()},h.publishNew=function(e,t){o("Pine","ScriptLib.publishNew");var i=s.Deferred(),r=window.user&&window.user.username,n="/publish/new/?access="+encodeURIComponent(t)+"&user_name="+encodeURIComponent(r),a={source:e};return h._pineFacadeAjax("POST",n,a).done((function(e,t,r){e.success?(h.clearSavedScriptsCache(),i.resolve(e)):i.reject(e.reason)})).fail((function(e,t,r){h._anyRequestAsyncFail(i,e)})),i.promise()},h.publishNext=function(e,t){l.logNormal("ScriptLib.publishNext","pine"),o("Pine","ScriptLib.publishNext");var i=s.Deferred(),r=window.user&&window.user.username,n="/publish/next/"+encodeURIComponent(t)+"?user_name="+encodeURIComponent(r),a={source:e};return h._pineFacadeAjax("POST",n,a).done((function(e,t,r){h.clearSavedScriptsCache(),e.success||i.reject(e.reason),i.resolve(e)})).fail((function(e,t,r){h._anyRequestAsyncFail(i,e)})),i.promise()},h.lightTranslate=function(e,t){return l.logNormal("ScriptLib.lightTranslate","pine"),o("Pine","ScriptLib.lightTranslate"),new Promise((function(i,r){var s=window.user&&window.user.username,n="/translate_light/?user_name="+encodeURIComponent(s);t&&(n+="&pine_id="+encodeURIComponent(t));var o={source:e};h._pineFacadeAjax("POST",n,o).done((function(e,t,s){if(e.success)i(e.result);else{var n=e.result&&e.result.reason||e.reason;r(n)}})).fail((function(e,t,i){h._anyRequestAsyncFail({reject:r},e)}))}))},h.getLibList=function(e,t,i){return l.logNormal("ScriptLib.getLibList","pine"),o("Pine","ScriptLib.getLibList"),new Promise((function(r,s){var n="/lib_list?lib_id_prefix="+encodeURIComponent(e);t&&(n+="&ignore_cache=true"),i&&(n+="&ignore_case=true"),h._pineFacadeAjax("GET",n).done((function(e,t,i){r(e)})).fail((function(e,t,i){h._anyRequestAsyncFail({reject:s},e)}))}))},h.getExistingLibraryInfo=async function(e){try{const t=await h.getLibList(e+"/last",!0,!0);if(!t.length)return null;const i=t[0];return{scriptIdPart:i.scriptIdPart,chartId:i.chartId,version:i.version}}catch(e){return null}},loginStateChange.subscribe(h,h.clearAllCaches),e.exports=h},5722:(e,t,i)=>{"use strict";i.d(t,{SelectionIndexes:()=>s});var r=i(16282);class s{constructor(e){this._baseIndex=null,
this._offsetInBar=null,this._offsetInTime=null,this._barsBetweenPoints=null,this._timescale=e}indexes(){const e=this._timescale.visibleBarsStrictRange();if(null===e)return[];const t=e.firstBar(),i=e.lastBar();if(null===this._offsetInTime||null===this._barsBetweenPoints){const e=this._timescale.barSpacing();this._barsBetweenPoints=Math.floor(120/e),this._offsetInBar=i%this._barsBetweenPoints,this._offsetInTime=this._timescale.indexToTimePoint(this._offsetInBar),this._baseIndex=this._timescale.baseIndex()}const s=this._timescale.baseIndex();this._baseIndex!==s&&(this._baseIndex=s,this._offsetInBar=(0,r.ensureNotNull)(this._timescale.timePointToIndex(this._offsetInTime)));const n=(0,r.ensureNotNull)(this._offsetInBar),o=[];let a=Math.floor((t-n)/this._barsBetweenPoints);const l=Math.floor((i-n)/this._barsBetweenPoints);for(;a<=l;a++)o.push(n+a*this._barsBetweenPoints);return o}clear(){this._offsetInBar=null,this._offsetInTime=null,this._baseIndex=null,this._barsBetweenPoints=null}}},26184:(e,t,i)=>{"use strict";i.d(t,{SelectionRenderer:()=>l});var r=i(71044),s=i(93669),n=i(62288),o=i(88558);const a=s.colorsPalette["color-tv-blue-600"];class l{constructor(e){this._data=e||null}setData(e){this._data=e}draw(e,t){if(null===this._data||!this._data.visible)return;const i=t.pixelRatio;e.strokeStyle=void 0!==this._data.color?this._data.color:a,e.lineCap="butt";const r=Math.max(1,Math.floor(i));e.lineWidth=r;const s=this._data.vertOffset||0;for(let t=0;t<this._data.points.length;++t){const o=this._data.points[t];(n=o,Number.isFinite(n.x)&&Number.isFinite(n.y))&&(e.fillStyle=this._data.bgColors[t],this._drawMarker(e,o,s,r,i))}var n}hitTest(e){if(!this._data||!this._data.visible)return null;for(let t=0;t<this._data.points.length;t++){const i=this._data.points[t];if(i.subtract(e).length()<=5.5){const e=void 0!==this._data.pointsCursorType?this._data.pointsCursorType[t]:o.PaneCursorType.Default;return new n.HitTestResult(this._data.hittestResult,{pointIndex:i.data,cursorType:e})}}return null}doesIntersectWithBox(e){return!!this._data&&this._data.points.some(t=>(0,r.pointInBox)(t,e))}_drawMarker(e,t,i,r,s){let n=Math.round(3.5*s*2);n%2!=r%2&&(n+=1);let o=Math.round(n+2*(.5*r+.75*s));o%2!=r%2&&(o+=1);const a=Math.round(t.x*s),l=Math.round((t.y+i)*s),c=r%2/2;e.beginPath(),e.arc(a+c,l+c,o/2,0,2*Math.PI,!0),e.closePath(),e.fill(),e.beginPath(),e.arc(a+c,l+c,n/2,0,2*Math.PI,!0),e.closePath(),e.stroke()}}},44583:(e,t,i)=>{"use strict"
;var r=i(16282).assert,s=i(14563),n=s.rgba,o=s.rgbaToString,a=s.parseRgb,l=i(94209).TradingSourcesHorizontalAlignment,c=i(16569),u=i(53353).PriceScale,d=i(97133).StudyStub,h=i(87048),p=h.createLineTool,_=h.createLineToolProperties,m=h.createStudyLineToolProperties,f=h.isLineToolName,g=h.isStudyLineToolName,v=i(73371).LineDataSource,S=i(22275).LineToolBarsPattern,y=i(22275).LineToolCallout,b=i(87048).isLineTool,w=i(12489),P=i(14127),C=P.Study,T=P.prepareStudyPropertiesForLoadChart,x=i(55304).createStudy,I=i(47658).Series,L=i(97786),M=i(20554),E=i(84234),A=i(22842),k=i(87380).getLogger("Chart.Serialization"),D=i(8412).AlertLabel,R=i(3851).getConfig,N=i(5803).ProductFeatures,O=i(23946).createGoProDialog,V=i(44848).LineToolTweet,B=i(86023).LineToolIdea,F=i(98006).isFeatureEnabled,W=i(22275).LineToolParallelChannel,U=i(22275).LineToolTrendAngle,H=i(22275).LineToolGhostFeed,z=i(22275).LineToolElliott,j=i(43854).PriceDataSource,Y=i(86483).Pane,G=i(50946),q=i(57137).createDeferredPromise,X=i(53423).mergeIntervalVisibilitiesDefaults,$=i(44079).preferencesByWhiteList,K=(k=i(87380).getLogger("Chart.Serialization"),i(60621).LineToolsGroupModel),J=i(72305).StudyStatusType;const{isLineToolState:Z,isMainSeriesState:Q,isStudyState:ee}=i(5877),{reorderDataSourcesStateZOrder:te}=i(93006);c.prototype.state=function(e,t,i,r){for(var s={panes:[]},n=0;n<this.panes().length;n++)s.panes.push(this.panes()[n].state(!0,e,!1,t,i,r));s.timeScale=this._timeScale.state(e);var o=this.publishedChartsTimelineSource(),a=this.properties(),l=a.tradingProperties.state();return s.chartProperties={paneProperties:a.paneProperties.state(),scalesProperties:a.scalesProperties.state(),publishedChartsTimelineProperties:o?o.state(e):void 0,chartEventsSourceProperties:a.chartEventsSourceProperties.state(),tradingProperties:l,priceScaleSelectionStrategyName:a.priceScaleSelectionStrategyName.value()},a.chartEventsSourceProperties&&(s.chartProperties.chartEventsSourceProperties=a.chartEventsSourceProperties.state()),r||(s.lineToolsGroups=this.lineToolsGroupModel().state(t)),s.version=this.version(),s.timezone=this.timezone(),s.sessions=this.sessions().state(e),s.shouldBeSavedEvenIfHidden=this._shouldBeSavedEvenIfHidden,s},c.prototype.asyncState=function(){var e=this.publishedChartsTimelineSource();return e?e.asyncState().then((function(e){var t={};return t.chartProperties={publishedChartsTimelineProperties:e},t})):Promise.resolve({})},c.prototype.chartPropertiesTransparencyMigrate=function(e){var t,i,r;e.chartProperties.paneProperties.crossHairProperties&&(r=e.chartProperties.paneProperties.crossHairProperties,G.isHexColor(r.color)&&(i=r.transparency/100,t=a(r.color),r.color=o(n(t,i)))),e.chartProperties.paneProperties.dataWindowProperties&&(r=e.chartProperties.paneProperties.dataWindowProperties,G.isHexColor(r.color)&&(i=r.transparency/100,t=a(r.color),r.color=o(n(t,i))))},c.prototype.resetDeferredStudies=function(){new ie(this).reset()},c.prototype._getExceedingChildStudies=function(e){for(var t=[],i=0;i<e.length;++i)t=t.concat(e[i].sources||[]);var r=0,s=1
;s=R(N.STUDY_ON_STUDY).child_limit;for(var n=[],o={},a=0,l=1e6;t.length&&--l;){var c=t[a];(c.ownerSource&&o[c.ownerSource]||!c.ownerSource)&&(o[c.id]=c,t.splice(t.indexOf(c),1),c.ownerSource&&"Study"===c.type&&c.state&&c.state.isChildStudy&&++r>s&&n.push(c)),a=(a+1)%t.length}return n},c.prototype.restoreState=function(e,t,i){new ie(this).reset();var r,s={};if(!e.panes)return void k.logDebug("ChartModel.restoreState: invalid state");if(!Array.isArray(e.panes))return void k.logDebug("ChartModel.restoreState: invalid state");if(e.panes.length<1)return void k.logDebug("ChartModel.restoreState: invalid state");if(this._shouldBeSavedEvenIfHidden=void 0===e.shouldBeSavedEvenIfHidden||e.shouldBeSavedEvenIfHidden,e.chartProperties&&!e.chartProperties.timezone&&(e.chartProperties.timezone=e.timezone),e.chartProperties){var n=TradingView.factoryDefaults("chartproperties").scalesProperties;TradingView.merge(n,e.chartProperties.scalesProperties),!("showLastValue"in n)||"showSeriesLastValue"in n||"showStudyLastValue"in n||(n.showSeriesLastValueProperty=n.showLastValue,n.showStudyLastValueProperty=n.showLastValue),"showSeriesLastValue"in n&&(s.showSeriesLastValueProperty=!0),"showStudyLastValue"in n&&(s.showStudyLastValueProperty=!0),e.chartProperties.paneProperties.vertGridProperties=e.chartProperties.paneProperties.vertGridProperties||TradingView.clone(e.chartProperties.paneProperties.gridProperties),e.chartProperties.paneProperties.horzGridProperties=e.chartProperties.paneProperties.horzGridProperties||TradingView.clone(e.chartProperties.paneProperties.gridProperties),"backgroundType"in e.chartProperties.paneProperties||(e.chartProperties.paneProperties.backgroundType="solid"),this._properties.paneProperties.mergeAndFire(e.chartProperties.paneProperties),this._properties.scalesProperties.mergeAndFire(n),e.chartProperties.timezone&&this._properties.timezone.setValue(e.chartProperties.timezone),e.chartProperties.chartEventsSourceProperties&&this._properties.chartEventsSourceProperties&&this._properties.chartEventsSourceProperties.mergeAndFire(e.chartProperties.chartEventsSourceProperties),e.chartProperties.tradingProperties&&this._properties.tradingProperties&&(void 0===e.chartProperties.tradingProperties.horizontalAlignment&&(e.chartProperties.tradingProperties.horizontalAlignment=(r=e.chartProperties.tradingProperties.lineLength)<=40?l.Right:r>=60?l.Left:l.Center),this._properties.tradingProperties.mergeAndFire(e.chartProperties.tradingProperties)),this._timeScale.restoreState(e.timeScale,t),this._updateDateTimeFormatter()}if(e.timeScale&&this._timeScale.restoreState(e.timeScale,t),!this.readOnly()){var o=this._getExceedingChildStudies(e.panes);if(o.length){for(var a=e.panes.length-1;a>=0;--a){for(var c=(_=e.panes[a]).sources.length-1;c>=0;--c){var u=_.sources[c];~o.indexOf(u)&&_.sources.splice(c,1)}_.sources.length||e.panes.splice(a,1)}setTimeout((function(){O({feature:"studyOnStudy"})}),500)}}const d=e.version||0;var h=e.panes;this.panes()[0].restoreState(h[0],t,d,s,i,!0);var p=1;for(a=1;a<e.panes.length;a++){
var _,m=e.panes[a];if(0!==m.sources.length)(_=this.panes()[p]||this.createPane()).restoreState(m,t,d,s,i,!0),_.mainDataSource()?p+=1:this.removePane(_);else k.logWarn("Empty pane detected - restoring is skipped. idx="+a+", state="+JSON.stringify(m))}e.chartProperties&&e.chartProperties.publishedChartsTimelineProperties&&((u=this.publishedChartsTimelineSource())&&u.restoreData(e.chartProperties.publishedChartsTimelineProperties,t));this._invalidateBarColorerCaches();var f=this.dataSources(),g=0;for(a=0;a<f.length;a++){var S=f[a];TradingView.isInherited(S.constructor,v)&&(g++,S.calcIsActualSymbol())}this.updateTimeScaleBaseIndex(),this.recalculateAllPanes(),this.fullUpdate(),this.syncESD();var y=TVLocalStorage.getItem("linetools_limit")||1e3;return window.is_authenticated&&window.user&&window.user.settings&&(y=window.user.settings.linetools_limit||y),e.sessions&&this.sessions().restoreState(e.sessions,t),e.lineToolsGroups&&(this._lineToolsGroupModel=K.fromState(this,e.lineToolsGroups)),g>y&&g%100==0?{lines_limit_exceeded:!0,line_tools_count:g}:(this.panes().forEach(function(e){this._dataSourceCollectionChanged.fire(e)}.bind(this)),this._lineToolsGroupModel.fireChangedAll(),{})},Y.prototype.state=function(e,t,i,r,s,n){var o={},a=new Map;function l(e){if(a.has(e))return a.get(e);var o=null,l=i&&!e.isSavedInStudyTemplates()||e instanceof D||!e.state||b(e)&&n||!(o=e.state(t,s))||!e.isSavedInChart(t)||r&&e.isActualSymbol&&!e.isActualSymbol()||e.isPhantom()?null:o;return a.set(e,l),l}if(e){o.sources=[];for(var c=0;c<this.m_dataSources.length;c++){var u=l(this.m_dataSources[c]);null!==u&&o.sources.push(u)}}function d(e){return null!==a.get(e)}function h(e){return!n||!b(e)}o.leftAxisesState=this._leftPriceScales.map((function(e){var t={};return t.state=e.state(),t.sources=e.dataSources().filter(d).filter(h).map((function(e){return e.id()})),t})),o.rightAxisesState=this._rightPriceScales.map((function(e){var t={};return t.state=e.state(),t.sources=e.dataSources().filter(d).filter(h).map((function(e){return e.id()})),t})),o.overlayPriceScales={};for(c=0;c<this.m_dataSources.length;c++){var p=this.m_dataSources[c];if(this.isOverlay(p)&&p.isSavedInChart(t)){var _=p.priceScale();o.overlayPriceScales[p.id()]=_?_.state():null}}return o.stretchFactor=this._stretchFactor,this.m_mainDataSource&&(o.mainSourceId=this.m_mainDataSource.id()),o.priceScaleRatio=this._currentPriceScaleRatio,o},Y.prototype.sourceById=function(e){for(var t=0;t<this.m_dataSources.length;t++)if(this.m_dataSources[t].id()===e)return this.m_dataSources[t];return null},Y.prototype.isESDStudy=function(e){return"Script$TV_EARNINGS@tv-scripting"===e.id||"Script$TV_DIVIDENDS@tv-scripting"===e.id||"Script$TV_SPLITS@tv-scripting"===e.id||"ESD$TV_EARNINGS@tv-scripting"===e.id||"ESD$TV_DIVIDENDS@tv-scripting"===e.id||"ESD$TV_SPLITS@tv-scripting"===e.id||"Earnings@tv-basicstudies"===e.id||"Dividends@tv-basicstudies"===e.id||"Splits@tv-basicstudies"===e.id},Y.prototype.isStudyToSkip=function(e){return!!this.isESDStudy(e)},Y.prototype.restoreState=function(e,t,i,r,s,n){r=r||{},
e.stretchFactor&&(this._stretchFactor=e.stretchFactor);var o={};if(e.sources){var a=e.sources.filter((function(e){return!!e&&("MainSeries"===e.type||(!e.points||!e.points.some((function(e){return null===e.time_t||!isFinite(e.time_t)}))||(k.logNormal("Dropped invalid "+e.type+". Reason: non-numeric point time"),!1)))}),this);const u=a.findIndex(Q);-1!==u&&this.model().mainSeries().setObsoleteZOrder(a[u].zorder),i<3&&te(a);var l=-1!==this.m_dataSources.indexOf(this._model.mainSeries());this.clearSeries(n),this.m_mainDataSource=null,l&&this._addSourceToCollections(this._model.mainSeries(),n),function(){var t=a.find((function(t){return t.id===e.mainSourceId}));if(void 0!==t)if(TradingView[t.type]&&f(t.type)){for(var i=null,r=0;r<a.length;r++){var s=a[r];if(!TradingView[t.type]||!f(s.type)){if(null!==i)return void k.logWarn("Pane contains more than 1 possibly main sources - auto fix cannot be applied");i=s}}if(null!==i){var n=e.mainSourceId,o=0;e.mainSourceId=i.id,a.forEach((function(e){e.ownerSource===n&&(e.ownerSource=i.id,o+=1)})),k.logNormal("Auto fix broken pane is applied, changed line tools="+o+", changed from="+n+" to="+i.id)}else k.logWarn("Pane contains only line tools - possible we need to remove this pane?")}else k.logNormal("The type of main source is not line tool - fix is unnecessary");else k.logWarn("There is no main source with id "+e.mainSourceId+", total sources="+a.length)}();for(var c=0;c<a.length;c++){if("study_Sessions"===(d=a[c]).type){this.model().sessions().restoreOldState(d,t);break}}for(c=0;c<a.length;c++){var d;if("study_Sessions"!==(d=a[c]).type){var h=d.id;null===this._model.dataSourceForId(d.id)||"MainSeries"===d.type?(o[h]=d.ownerSource,Q(d)?this._restoreMainSeries(d,t,l,r,s,n):ee(d)?this.restoreStudy(d,t,r,n):Z(d)?(d.state&&(d.state.zOrderVersion=2),this.restoreLineTool(d,t,void 0,n)):TradingView[d.type]&&TradingView[d.type].createFromState&&this._restoreSpecialSource(d,t,n)):k.logError("Duplicate id while restoring pane: "+d.type+","+d.id)}}}var p,_,m=new Set,g=this;function S(e){var t=defaults("chartproperties").paneProperties.axisProperties,i=new u(g.model().properties().scalesProperties,t);return i.restoreState(e.state),e.sources.forEach((function(e){var r=g.dataSourceForId(e);r&&function e(t,i,r){m.has(t)||(m.add(t),void 0!==r.m_showSymbolLabels&&t instanceof I&&g.model().properties().scalesProperties.showSymbolLabels.setValue(r.m_showSymbolLabels),E(t,i),g._model.children(t,!0).forEach((function(t){e(t,i,r)})))}(r,i,t)})),0===i.dataSources().length?null:i}if(e.leftAxisesState)p=e.leftAxisesState.map(S).filter((function(e){return null!==e}));else{var y=S({state:e.leftAxisState,sources:e.leftAxisSources});p=null!==y?[y]:[]}if(this._leftPriceScales.slice().forEach(function(e){this.removePriceScale(e)}.bind(this)),this._leftPriceScales=[],p.forEach((function(e){g._placePriceScale(e,"left")})),e.rightAxisesState)_=e.rightAxisesState.map(S).filter((function(e){return null!==e}));else{var b=S({state:e.rightAxisState,sources:e.rightAxisSources});_=null!==b?[b]:[]}
this._rightPriceScales.forEach(function(e){this.removePriceScale(e)}.bind(this)),this._rightPriceScales=[],_.forEach((function(e){g._placePriceScale(e,"right")})),this._currentPriceScaleRatio=e.priceScaleRatio||e.leftPriceScaleRatio||e.rightPriceScaleRatio||null;var w=new Map;for(c=0;c<this.m_dataSources.length;c++){var P=this.m_dataSources[c];if(!m.has(P)){var T;if(e.overlayPriceScales&&e.overlayPriceScales[P.id()]){var x=e.overlayPriceScales[P.id()];w.has(x.id)?T=w.get(x.id):((T=new u(this._model.properties().scalesProperties)).setHeight(this.m_height),x.m_isAutoScale=!0,x.m_isLog=!1,x.m_isPercentage=!1,x.m_isLockScale=!1,T.restoreState(x),w.set(x.id,T))}else(T=new u(this._model.properties().scalesProperties)).setHeight(this.m_height);E(P,T)}}for(var h in o){var L=o[h];if(L)(P=this.dataSourceForId(h))&&this.dataSourceForId(h).setOwnerSource(this.dataSourceForId(L))}if(e.mainSourceId&&!this.containsMainSeries()&&(this.m_mainDataSource=this.dataSourceForId(e.mainSourceId)),!this.m_mainDataSource)for(c=0;c<this.m_dataSources.length;c++){P=this.m_dataSources[c];if(TradingView.isInherited(P.constructor,j)){this.m_mainDataSource=P;break}}for(c=0;c<this.m_dataSources.length;c++){P=this.m_dataSources[c];if(TradingView.isInherited(P.constructor,v))P.ownerSource()||P.setOwnerSource(this.mainDataSource()),P.isFixed()&&P.restoreFixedPoints();else if(TradingView.isInherited(P.constructor,C)){var M=P.properties();M.linkedToSeries&&M.linkedToSeries.value()&&(P.ownerSource()||P.setOwnerSource(this.model().mainSeries()))}}function E(e,t){g.removeSourceFromPriceScale(e),e.setPriceScale(t),t.addDataSource(e)}this._updateMargins(),this._cachedOrderedSources.clear()},Y.prototype._restoreMainSeries=function(e,t,i,r,s,n){var o=e.id,a=e.state;if(a&&s&&(a.style=s.style||a.style,a.interval=s.interval||a.interval,a.symbol=s.symbol||a.symbol,s.symbol&&delete a.currencyId),a&&a.style===L.STYLE_HILO&&!F("chart_style_hilo")&&(a.style=L.STYLE_CANDLES),a&&["candleStyle","hollowCandleStyle","haStyle"].forEach((function(e){a[e]&&(a[e].wickUpColor=a[e].wickUpColor||a[e].wickColor,a[e].wickDownColor=a[e].wickDownColor||a[e].wickColor)})),a&&(a.statusViewStyle=a.statusViewStyle||{},!a.statusViewStyle.symbolTextSource)){var l=!!a.statusViewStyle.showSymbolAsDescription;a.statusViewStyle.symbolTextSource=l?"ticker":"description"}if(a&&(a.extendedHours?a.sessionId="extended":a.sessionId||(a.sessionId="regular"),delete a.extendedHours),!i){var c=this._model.mainSeries();this._model.paneForSource(c).removeDataSource(c,!1,n),this._addSourceToCollections(c,n)}const u=this.model().mainSeries(),d=u.properties();if(this.m_mainDataSource=u,(g=a&&a.style?a.style:void 0)===I.STYLE_PNF&&"ATR"===d.pnfStyle.inputs.style.value()?d.pnfStyle.inputs.style._value="Traditional":g===I.STYLE_RENKO&&"ATR"===d.renkoStyle.inputs.style.value()&&(d.renkoStyle.inputs.style._value="Traditional"),a&&!a.hasOwnProperty("showSessions")&&(a.showSessions=!1),a&&void 0===!a.settlementAsClose&&(a.settlementAsClose=!1),a&&t&&(a.showCountdown=!1),
a&&(t&&!("showSeriesLastValueProperty"in r)&&"showLastValue"in a&&this._model.properties().scalesProperties.showSeriesLastValue.setValue(a.showLastValue),delete a.showLastValue),a)for(var h={haStyle:M.chartStyleStudyId(I.STYLE_HEIKEN_ASHI,!0),renkoStyle:M.chartStyleStudyId(I.STYLE_RENKO,!0),pbStyle:M.chartStyleStudyId(I.STYLE_PB,!0),kagiStyle:M.chartStyleStudyId(I.STYLE_KAGI,!0),pnfStyle:M.chartStyleStudyId(I.STYLE_PNF,!0),rangeStyle:M.chartStyleStudyId(I.STYLE_RANGE,!0)},p=this._model.studyVersioning(),_=u.styleStudyInfos(),m=Object.keys(L.SYMBOL_STRING_DATA),f=0;f<m.length;f++){var g=m[f],v=L.STYLE_SHORT_NAMES[g]+"Style",S=v in e?e[v].studyId:h[v];if(null!=(g=a[v])){var y=g.inputs,b=E.parseIdString(S),w=_[v].studyId,P=E.parseIdString(w),C=p.updateStudyInputs(b.id,b.version,P.version,y,null);g.inputs=C}}const T=u.sessionId();u.restoreState(e,t),this.changeSourceId(u,o),u.sessionId()!==T&&d.sessionId.listeners().fire(d.sessionId)},Y.prototype.restoreStudy=function(e,t,i,r){if(t&&void 0===e.data&&void 0===e.nonSeriesData&&void 0===e.indexes)k.logError("Cannot restore (skipping) study without data "+e.id+", "+e.metaInfo.id);else{var s=e.id,n=e.state,o=e.zorder,a=e.ownerSource,l=TradingView.clone(e.metaInfo);if(Object.assign(l,E.parseIdString(l.id)),!this.isStudyToSkip(l)||t){var c=n,u=this._model.studyVersioning(),h=u.patchPropsStateAndMetaInfo(c,l,{oldShowStudyLastValueProperty:t&&!i.showStudyLastValueProperty});c=h.propsState,l=h.metaInfo;var p=new d(this._model,e,l.shortDescription);p.setId(s),p.setZorder(o);var _=this;if(t)f(null);else{var m=u.updateMetaInfoAsync(l);m.sync?f(m.result):m.result.then((function(e){f(e)})).catch((function(e){p.setFailed("error: "+e)}))}return p&&(p.setZorder(o),this._addSourceToCollections(p,r),this._processMainSourceChange()),this._cachedOrderedSources.clear(),p}k.logNormal("Skipping study "+l.id)}function f(i){p.setStatus({type:J.Undefined});var r=i||new E(l),n=new ie(_._model);function o(o){var a=T(l,i,c,null,u),d=x(_._model,a,o||_._model.mainSeries(),r);if(d.setId(s),d.setOwnFirstValue(void 0===e.ownFirstValue?null:e.ownFirstValue),t){var h=u.patchStudyData(l,e.data,e.nonSeriesData,e.indexes);d.restoreData(h.data,h.nsData,h.indexes)}_._model.replaceStudyStub(p,d)||(p=d),n.add(s,d)}a&&e.state.isChildStudy?n.get(a).then(o):o()}},Y.prototype.restoreLineTool=function(e,t,i,s){delete e.state.lastUpdateTime,e.state.intervalsVisibilities=X(e.state.intervalsVisibilities),i=void 0===i||i,z.migrateState(e),w.migrateState(e);var n=e.type,o=e.id,a=e.state,l=i?e.zorder:this.newLineToolZOrder();r(f(n),"invalid data source type:"+n+" (expected to be a Line Tool)");var c,u,h=null;if(g(n)){var v=(e=(h=this._model.studyVersioning()).patchPointsBasedStudyState(e)).metaInfo;if(Object.assign(v,E.parseIdString(v.fullId)),!t){var b=v.productId;if(!pro.hasPackage(b)){var P=new d(this._model,e,v.shortDescription);return P.setId(o),this._addSourceToCollections(P,s),void 0!==l&&P.setZorder(l),void P.setFailed(window.t("not authorized"))}}var C=h.updateMetaInfo(v)||v;u=m(n,v,C,a,h),t?u.merge({fixedSize:!1
}):u.merge({fixedSize:!0}),c=p(n,this._model,u,C,!0)}else u=_(n,a,this._model),t?u.merge({fixedSize:!1}):u.merge({fixedSize:!0}),c=p(n,this._model,u,null,!0);c.setId(o),c.linkKey().setValue(e.linkKey||null);var T=e.alertId;T&&c.canHasAlert()&&"function"==typeof c.setAlert&&A.enabled("alerts")&&!this._model.readOnly()&&!this._model.isJustClonedChart()&&c.setAlert(T,{noChartSave:!0});var x=e.indexes?e.indexes:[];if(x=x.slice(0,e.points.length),c.isFixed()?c.restorePositionPercents(e.positionPercents):c.restorePoints(e.points,x,t),c instanceof S||c instanceof y||c instanceof U||c instanceof H||c instanceof W||c instanceof V||c instanceof B)c.restoreData(e);else if(t&&c.restoreData){var I=e;h&&(I.graphics=h.patchPointsBasedStudyData(I.metaInfo,I.graphics)),c.restoreData(I)}var L=null==e.version?1:e.version,M=null==c.version?1:c.version;return L!==M&&"function"==typeof c.migrateVersion&&c.migrateVersion(L,M,{pane:this,model:this._model,properties:u}),void 0!==l&&c.setZorder(l),this._addSourceToCollections(c,s),this._cachedOrderedSources.clear(),c},Y.prototype._restoreSpecialSource=function(e,t,i){var r=TradingView[e.type];if(r&&r.createFromState){var s=r.createFromState(e,t,this._model);s&&(s.setId(e.id),this._addSourceToCollections(s,i),s.zorder&&s.setZorder(s.zorder))}},c.prototype.restoreTheme=function(e,t,i){var r={hollowCandle:{related:"candle"}};for(var s in r)if(!e.mainSourceProperties[s+"Style"]){var n=e.mainSourceProperties[r[s].related+"Style"];e.mainSourceProperties[s+"Style"]=TradingView.clone(n)}this._undoModel.chartLoadTheme(this,e,t,i)},c.prototype.preferences=function(){return $(this,this.mainSeries())};var ie=function(){var e=[],t=[];function i(r){var s=e.indexOf(r);return~s?t[s]:this instanceof i?(this._source=r,this._studies={},this._deferreds={},e.push(r),void t.push(this)):new i(r)}return i.prototype.add=function(e,t){this._deferreds[e]&&(this._deferreds[e].resolve(t),delete this._deferreds[e]),this._studies[e]=t},i.prototype.get=function(e){return this._studies[e]?Promise.resolve(this._studies[e]):(this._deferreds[e]||(this._deferreds[e]=q()),this._deferreds[e].promise)},i.prototype.reset=function(){var i=e.indexOf(this._source);~i&&(e.splice(i,1),t.splice(i,1))},i}();e.exports=c},11126:(e,t,i)=>{"use strict";i.d(t,{SeriesBase:()=>Qe});var r=i(16282),s=i(68724),n=i(29098),o=i(88001),a=i(87380),l=i(43854),c=i(40989),u=i(46561),d=i(27937),h=i.n(d),p=i(20554),_=i(11228),m=i(97786),f=i(14854),g=i(20220),v=i(22842),S=i.n(v),y=i(5956),b=i(87576),w=i(86837);const P=(0,g.t)("Symbol Error"),C=(0,s.onWidget)(),T=v.enabled("hide_unresolved_symbols_in_legend");class x extends b.StatusProviderBase{constructor(e,t,i,r){super(t),this._series=e,this._statusViewProperties=i,this._options=r||{}}text(){return(0,w.generateTitleForGui)(this._getTitleGenerationOptions())}getSplitTitle(){return(0,w.generateSplitTitleForGui)(this._getTitleGenerationOptions())}bold(){return!1}size(){return this._statusViewProperties.childs().fontSize.value()+"px"}errorStatus(){const e=this._series.seriesErrorMessage();return null!==e?{
error:e,title:P}:null}_getTitleGenerationOptions(){const e=this._series.symbolInfo(),t=this._statusViewProperties.childs(),i=this._series.symbolTextSourceProxyProperty().value();return{description:"ticker"===i?e&&e.name||void 0:(0,y.getTranslatedSymbolDescription)({pro_name:e&&e.pro_name||void 0,short_name:e&&e.name||void 0,description:e&&e.description||void 0,short_description:e&&e.short_description||void 0,local_description:e&&e.local_description||void 0,language:e&&e.language||void 0}),exchange:t.showExchange.value()?C||"forex"===(null==e?void 0:e.type)?null==e?void 0:e.exchange:null==e?void 0:e.listed_exchange:void 0,symbol:T&&null===e?"":this._series.symbol(),interval:t.showInterval.value()&&!this._options.hideResolution?this._series.interval():void 0,style:this._series.properties().childs().style.value(),inputs:this._series.getInputsProperties().state(),boxSize:this._series.data().boxSize,reversalAmount:this._series.data().reversalAmount,ticker:"ticker-and-description"===i?e&&e.name||void 0:"",branding:this._options.branding}}}class I extends f.StatusView{constructor(e,t,i,r){super(new x(e,t,i,r)),this._invalidated=!0,this._series=e,this._series.onRestarted().subscribe(this,this.update),this._series.dataEvents().symbolResolved().subscribe(this,this.update),this._series.dataEvents().completed().subscribe(this,this.update),this._series.boxSizeValue().subscribe(this.update.bind(this)),i.childs().symbolTextSource.listeners().subscribe(this,this.update)}getSeriesPrecision(){let e=4;const t=this._series.symbolInfo();return t&&t.pricescale&&(e=Math.round(Math.log(t.pricescale)/Math.log(10))),e}round(e){const t=this.getSeriesPrecision(),i=Math.round(e*Math.pow(10,t))/Math.pow(10,t);return i?i.toString():""}update(){this._invalidated=!0}text(){return this._updateImpl(),super.text()}color(){return this._updateImpl(),super.color()}bold(){return this._updateImpl(),super.bold()}size(){return this._updateImpl(),super.size()}getSplitTitle(){return this._updateImpl(),this._statusProvider.getSplitTitle()}_updateImpl(){this._invalidated&&(this._bold=this._statusProvider.bold(),this._size=this._statusProvider.size(),this._text=this._statusProvider.text(),this._invalidated=!1)}}var L=i(51424),M=i(57976),E=i(14397),A=i(31741),k=i(87048);const D=s.CheckMobile.any(),R=S().enabled("hide_resolution_in_legend");class N extends L.DataWindowView{constructor(e,t){super(),this._invalidated=!0,this._series=e,this._model=t,this._valuesProvider=this._createValuesProvider(e,t),this._items=this._valuesProvider.getItems().map(e=>new L.DataWindowItem(e.title,"")),this.update()}update(){this._invalidated=!0}items(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._items}series(){return this._series}_updateImpl(){const e=this._series.symbolInfo();if(e){const t=[e.name];R||t.push((0,M.translatedIntervalString)(this._series.interval())),t.push((0,s.onWidget)()||"forex"===e.type?e.exchange:e.listed_exchange),this._header=t.join(", "),this._title=e.description}else this._header=this._series.symbol()
;const t=this._model.crossHairSource().appliedIndex(),i=this._valuesProvider.getValues(t);for(let e=0;e<i.length;++e){const t=i[e],r=this._items[e];r.setValue(t.value),r.setVisible(t.visible),r.setColor(t.color)}}_createValuesProvider(e,t){return new A.SeriesValuesProvider(e,t)}_showLastPriceAndChangeOnly(){return D&&(null===this._model.crossHairSource().pane||(0,k.isLineToolName)(E.tool.value())||null!==this._model.lineBeingEdited())}}const O={open:(0,g.t)("O",{context:"in_legend"}),high:(0,g.t)("H",{context:"in_legend"}),low:(0,g.t)("L",{context:"in_legend"}),close:(0,g.t)("C",{context:"in_legend"}),hl2:(0,g.t)("HL2",{context:"in_legend"}),hlc3:(0,g.t)("HLC3",{context:"in_legend"}),ohlc4:(0,g.t)("OHLC4",{context:"in_legend"})};class V extends A.SeriesValuesProvider{constructor(e,t){super(e,t),this._showBarChange=t.properties().paneProperties.legendProperties.showBarChange,this._showSeriesOHLC=t.properties().paneProperties.legendProperties.showSeriesOHLC,this._seriesStyle=e.properties().childs().style,this._emptyValues[0].title=O.open,this._emptyValues[1].title=O.high,this._emptyValues[2].title=O.low,this._emptyValues[3].title=O.close,this._emptyValues[6].title="",this._emptyValues[4].title=""}getValues(e){const t=super.getValues(e),i=this._showSeriesOHLC.value(),r=this._showBarChange.value(),s=12===this._series.style(),n=t[6];if(n.visible=n.visible&&r&&!s,this._showLastPriceAndChangeOnly()){const e=t[5];return e.visible=e.visible&&i,t}const o=(0,p.isPriceSourceStyle)(this._seriesStyle.value()),a=i&&!o,l=i&&o;return t[0].visible=a&&!s,t[1].visible=a,t[2].visible=a,t[3].visible=a&&!s,t[4].visible=l,t}}const B=window.t("At close");class F extends N{constructor(e,t){super(e,t),this._showBarChange=t.properties().paneProperties.legendProperties.showBarChange,this._showSeriesOHLC=t.properties().paneProperties.legendProperties.showSeriesOHLC,this._showBarChange.subscribe(this,this.update),this._showSeriesOHLC.subscribe(this,this.update)}isValuesVisible(){return this._showSeriesOHLC.value()||this._showBarChange.value()}additional(){const e=this._series.dataPoweredBy();return null!==e&&e.length>0?window.t("Data Provided by")+" "+e:null}marketTitle(){const e=this._series.marketStatusModel().status().value();return this._showLastPriceAndChangeOnly()&&("pre_market"===e||"post_market"===e)?B+":":""}destroy(){this._showBarChange.unsubscribeAll(this),this._showSeriesOHLC.unsubscribeAll(this)}_createValuesProvider(e,t){return new V(e,t)}}var W=i(65066),U=i.n(W),H=i(60744),z=i(37796),j=i(4033);function Y(){const e=window.ChartApiInstance.serverTimeOffset();return Date.now()/1e3+e}function G(e,t,i){return e<=i?t<=i?1/0:t/1e3:Math.min(e,t)/1e3}class q{constructor(e,t){this._marketStatus=new(U())(null),this._lastMarketStatus=null,this._sessionsSpec=null,this._nextSessionEdgeInternal=null,this._nextSessionEdge=new(U())(null),this._recalcNextSessionEdgeTimerId=null,H.showMarketOpenStatusProperty.subscribe(this,()=>this._update()),this._quotesProvider=e,e.quotesUpdate().subscribe(this,this._update.bind(this)),
e.quoteSymbolChanged().subscribe(this,()=>{this._nextSessionEdgeInternal=null,this._recalculateNextSessionEdge()}),this._resetSubscription=t,this._resetSubscription.subscribe(this,this._resetStatus)}destroy(){H.showMarketOpenStatusProperty.unsubscribeAll(this),this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._quotesProvider.quoteSymbolChanged().unsubscribeAll(this),this._resetSubscription.unsubscribeAll(this),null!==this._recalcNextSessionEdgeTimerId&&clearTimeout(this._recalcNextSessionEdgeTimerId)}setSymbolInfo(e){var t,i,r,s,n;if(this._nextSessionEdgeInternal=null,null===e)return void(this._sessionsSpec=null);const o=new z.SessionSpec(e.timezone,null!==(t=e.session_display)&&void 0!==t?t:e.session,e.session_holidays,e.corrections);let a,l;const c=null===(i=e.subsessions)||void 0===i?void 0:i.find(e=>"premarket"===e.id),u=null===(r=e.subsessions)||void 0===r?void 0:r.find(e=>"postmarket"===e.id);void 0!==c&&(a=new z.SessionSpec(e.timezone,null!==(s=c["session-display"])&&void 0!==s?s:c.session,e.session_holidays,c["session-correction"])),void 0!==u&&(l=new z.SessionSpec(e.timezone,null!==(n=u["session-display"])&&void 0!==n?n:u.session,e.session_holidays,u["session-correction"])),this._sessionsSpec={general:o,preMarket:a,postMarket:l},this._recalculateNextSessionEdge()}status(){return this._marketStatus}nextSessionEdge(){return this._nextSessionEdge}_resetStatus(){this._marketStatus.setValue(null)}_update(e){void 0!==e&&void 0!==e.values.current_session&&(this._lastMarketStatus=e.values.current_session),null===this._lastMarketStatus||"market"===this._lastMarketStatus&&!H.showMarketOpenStatusProperty.value()?this._resetStatus():this._marketStatus.setValue(this._lastMarketStatus)}_getNextSessionEdgeInternal(){var e;if(null===this._sessionsSpec||"24x7"===this._sessionsSpec.general.spec())return null;const t=1e3*Y();if(null===this._nextSessionEdgeInternal||(null!==(e=this._nextSessionEdgeInternal.timestamp)&&void 0!==e?e:1/0)<=t/1e3){const{general:e,preMarket:i,postMarket:r}=this._sessionsSpec,s=(0,j.get_timezone)(e.timezone()),n=(0,j.utc_to_cal)(s,t),o=G((0,j.cal_to_utc)(s,e.alignToNearestSessionStart(n,1)),(0,j.cal_to_utc)(s,e.alignToNearestSessionEnd(n,1)),t),a=G(void 0!==i?(0,j.cal_to_utc)(s,i.alignToNearestSessionStart(n,1)):1/0,void 0!==i?(0,j.cal_to_utc)(s,i.alignToNearestSessionEnd(n,1)):1/0,t),l=G(void 0!==r?(0,j.cal_to_utc)(s,r.alignToNearestSessionStart(n,1)):1/0,void 0!==r?(0,j.cal_to_utc)(s,r.alignToNearestSessionEnd(n,1)):1/0,t),c=Math.min(o,a,l);c===1/0&&(this._nextSessionEdgeInternal={timestamp:null}),this._nextSessionEdgeInternal=c===l?{timestamp:c,status:"post_market"}:c===a?{timestamp:c,status:"pre_market"}:{timestamp:c}}return this._nextSessionEdgeInternal}_recalculateNextSessionEdge(){const e=this._getNextSessionEdgeInternal();if(null===e||null===e.timestamp)return void this._nextSessionEdge.setValue(null);const t={status:e.status,remainingSeconds:Math.max(0,e.timestamp-Y())};if(null===this._recalcNextSessionEdgeTimerId){let e=Math.ceil(t.remainingSeconds%60);0===e&&(e+=60),
this._recalcNextSessionEdgeTimerId=setTimeout(()=>this._recalculateNextSessionEdgeByTimer(),1e3*e)}this._nextSessionEdge.setValue(t)}_recalculateNextSessionEdgeByTimer(){this._recalcNextSessionEdgeTimerId=null,this._recalculateNextSessionEdge()}}var X=i(2459),$=i(73582),K=i(55471),J=i(36757);const Z=(0,a.getLogger)("Chart.Definitions.Series");function Q(e,t){const i=[];return(0,K.isDelay)(e.delay)?function(e){const t=[];return(0,K.witoutRealtime)(e)?t.push("DelayNoRealtime"):(0,K.isDelayForGuest)("MOEX",e)?t.push("MOEXDelayForGuest"):(0,K.isDelayForGuest)("TFEX",e)?t.push("TFEXDelayForGuest"):(0,K.isDelayForGuest)("CHIXAU",e)?t.push("CHIXAuDelayForGuest"):(0,K.isDelayForGuest)("NGM",e)?t.push("NGMDelayForGuest"):(0,K.isDelayForGuest)("ICESG",e)?t.push("ICESGDelayForGuest"):["BER","DUS","HAM","HAN","MUN"].some(t=>(0,K.isDelayForGuest)(t,e))?t.push("DEForGuest"):["LSE","LSIN","MIL"].some(t=>(0,K.isDelayForGuest)(t,e))?t.push("LSEDelayForGuest"):(0,K.isDelayWithoutMarketAgreement)(e)?t.push("DelayWithoutMarketAgreement"):t.push("DelayToRealtime"),t}(e):(0,K.isEod)(e,t)?(i.push("EOD"),i):((0,K.isTickByTick)(e,t)&&i.push("TickByTick"),(0,K.isBats)(e)&&i.push("BATSToRealtime"),i)}class ee{constructor(e,t,i){this._dataUpdatedModeStatus=new(U())(null),this._symbolInfo=(0,$.createWVFromGetterAndSubscription)(e.getter,e.onChange),this._status=(0,$.createWVFromGetterAndSubscription)(t.getter,t.onChange),this._symbolInfo.subscribe(this._update.bind(this)),this._status.subscribe(this._update.bind(this)),this._resetSubscription=i,this._resetSubscription.subscribe(this,this._resetStatus)}destroy(){this._symbolInfo.destroy(),this._status.destroy(),this._resetSubscription.unsubscribeAll(this)}status(){return this._dataUpdatedModeStatus.readonly()}symbolName(){const e=this._symbolInfo.value();return null!==e?e.name:""}time(){const e=this._symbolInfo.value(),t=null!==e&&e.delay&&e.delay>0?e.delay:900;return Math.round(t/60)}listedExchange(){const e=this._symbolInfo.value();return null!==e?e.listed_exchange:""}async description(){const e=this._symbolInfo.value();if(null===e)return"";let t={};try{t=(0,r.ensureNotNull)(await(0,K.getExchange)(e))}catch(e){Z.logWarn("Cannot get exchange "+(0,J.errorToString)(e))}return t.description||e.listed_exchange}exchange(){const e=this._symbolInfo.value();return null!==e?e.exchange:""}firstReplacedByBatsExchange(){const e=this._symbolInfo.value();return e&&(0,K.firstReplacedByBatsExchange)(e)}_resetStatus(){this._dataUpdatedModeStatus.setValue(null)}_update(){const e=this._symbolInfo.value();if(null===e)return void this._dataUpdatedModeStatus.setValue(null);const t=this._status.value();if("string"==typeof t)return void this._dataUpdatedModeStatus.setValue(null);if(t===m.STATUS_LOADING||t===m.STATUS_RESOLVING)return;const i=Q(e,t);0!==i.length?this._dataUpdatedModeStatus.setValue(i):this._dataUpdatedModeStatus.setValue(null)}}var te=i(96131),ie=i(31565);class re{constructor(e,t){this._dataProblem=new te.WatchedObject(null),this._quotesProvider=e,
this._quotesProvider.quotesUpdate().subscribe(this,this._update.bind(this)),this._resetSubscription=t,this._resetSubscription.subscribe(this,this._resetStatus)}destroy(){this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._resetSubscription.unsubscribeAll(this)}status(){return this._dataProblem}_resetStatus(){this._dataProblem.setValue(null)}_update(e){void 0===e.values||void 0===e.values.data_problem?this._resetStatus():this._dataProblem.setValue((0,ie.clone)(e.values.data_problem))}}var se=i(76018),ne=i(50946),oe=i(32552),ae=i(57086);function le(e){return e<10?"0"+e:e.toString()}function ce(e,t=Date.now()/1e3){let i=Math.ceil(e-t);if(i<=0)return"";if(i<3600){const e=Math.floor(i/60),t=Math.ceil(i%60);return`${le(e)}:${le(t)}`}if(i<86400){const e=Math.floor(i/3600);i%=3600;const t=Math.floor(i/60);i%=60;const r=Math.ceil(i);return`${le(e)}:${le(t)}:${le(r)}`}{const r=new Date(1e3*e),s=new Date(1e3*t),n=j.get_year(r),o=j.get_year(s),a=j.get_month(r),l=j.get_month(s),c=j.get_day_of_month(s),u=ue(r)-ue(s)>=0?0:-1;let d=12*(n-o)+(a-l)+u;if(d>0){const t=j.get_days_in_month(l,o);!function(e,t){const i=j.get_day_of_month(e);e.setUTCMonth(j.get_month(e)+t),j.get_day_of_month(e)!==i&&e.setUTCDate(0)}(s,d);const i=j.get_days_in_month(j.get_month(s),j.get_year(s)),r=c!==t&&i===j.get_day_of_month(s)?t-c:0;let n=Math.ceil((e-s.getTime()/1e3)/86400)+r;return n>=i&&(d++,n=0),`${d}M ${n}d`}if(-1===u){if(j.get_days_in_month(l,o)-i/86400<1/24)return"1M 0d"}let h=Math.floor(i/86400);i%=86400;let p=Math.ceil(i/3600);return 24===p&&(p=0,h+=1),h===j.get_days_in_month(a,n)?"1M 0d":`${h}d ${p}h`}}function ue(e){return 86400*e.getUTCDate()+3600*e.getUTCHours()+60*e.getUTCMinutes()+e.getUTCSeconds()}const de=[0,1,2,3,9,8,10],he=v.enabled("force_exchange_as_title"),pe={alwaysShowGlobalLast:!1,visibleOnHistoryOnly:!1,showCountdown:!0,showSymbolLabel:!0};class _e extends oe.PriceAxisView{constructor(e,t,i){super(),this._previousCountdown="",this._source=e,this._model=t,this._options={...pe,...i}}updateCountdown(){this._countdownText()!==this._previousCountdown&&(this.update(),this._model.updateSourcePriceScale(this._source))}_getSource(){return this._source}_getModel(){return this._model}_isCountdownEnabled(){return this._options.showCountdown}_countdownText(){{const e=this._source.barCloseTime();return null===e?"":ce(e,this._currentTime()/1e3)}}_updateRendererData(e,t,i){e.visible=!1,t.visible=!1;const r=this._source.properties().childs();if(12===r.style.value())return;if(this._options.visibleOnHistoryOnly){const e=this._model.timeScale().visibleBarsStrictRange(),t=this._source.data().last();if(null===e||null===t||e.contains(t.index))return}const s=this._model.properties().scalesProperties;let n=s.showSeriesLastValue.value(),o=this._isCountdownEnabled()&&-1!==de.indexOf(r.style.value())&&r.showCountdown.value(),a=this._options.showSymbolLabel&&s.showSymbolLabels.value();const l=s.seriesLastValueMode.value()===ae.PriceAxisLastValueMode.LastPriceAndPercentageValue,c=this._source.lastValueData(void 0,this._options.alwaysShowGlobalLast)
;if(c.noData)return;const u=8===r.style.value();if((n||o||a)&&u&&r.haStyle.childs().showRealLastPrice.value()){const e=this._source.lastValueData(void 0,!1),t=this._source.lastValueData(void 0,!0);e.noData||t.noData||e.index!==t.index||(n=!1,o=!1,a=!1)}if(n||o){const t=this._axisFirstLineText(c,n);e.text=t,i.textColor=this.generateTextColor(i.background),e.textColor=i.textColor;const r=this._source.priceScale().isPercentage(),s=n&&l?r?c.formattedPriceAbsolute:c.formattedPricePercentage:"";e.secondLine=s,i.secondLineTextColor=i.textColor;const a=o?this._countdownText():"";this._previousCountdown=a,e.thirdLine=a,i.thirdLineTextColor=(0,ne.generateColor)(i.textColor,25),0===t.length&&0===s.length&&0===a.length||(e.visible=!0)}a&&(t.text=this._paneText(a),t.visible=t.text.length>0),i.background=this._source.priceLineColor(c.color),i.coordinate=c.coordinate,i.floatCoordinate=c.floatCoordinate}_paneText(e){let t="";const i=this._source.symbolInfo();return he?t=(0,p.displayedSymbolExchange)(i):e&&(t=(0,p.displayedSymbolName)(i)),t}_axisFirstLineText(e,t){return t?this._source.priceScale().isPercentage()?e.formattedPricePercentage:e.formattedPriceAbsolute:""}_currentTime(){return Date.now()+1e3*this._source.serverTimeOffset()}}var me=i(98006);class fe extends oe.PriceAxisView{constructor(e,t){super(),this._source=e,this._model=t}_updateRendererData(e,t,i){e.visible=!1;const r=this._source;if(!this._model.properties().scalesProperties.showSeriesPrevCloseValue.value())return;if(r.isDWM())return;const s=r.prevClose();if(null===s)return;const n=this._source.properties().childs().prevClosePriceLineColor.value();i.background=n,i.textColor=this.generateTextColor(n),i.coordinate=s.coordinate,e.text=r.priceScale().isPercentage()?s.formattedPricePercentage:s.formattedPriceAbsolute,e.visible=!0}}var ge=i(41261),ve=i(3707);class Se extends ge.SeriesHorizontalLinePaneView{constructor(e){super(e),this._lineRendererData.linestyle=ve.LINESTYLE_DOTTED}_updateImpl(){this._lineRendererData.visible=!1;const e=this._series.properties().childs();if(!e.showPrevClosePriceLine.value())return;if(this._series.isDWM())return;const t=this._series.prevClose();null!==t&&(this._lineRendererData.visible=!0,this._lineRendererData.y=t.coordinate,this._lineRendererData.color=e.prevClosePriceLineColor.value(),this._lineRendererData.linewidth=e.prevClosePriceLineWidth.value())}}var ye=i(78539);class be extends _e{lastPrice(){return this._getSource().data().lastProjectionPrice}_updateRendererData(e,t,i){e.visible=!1,t.visible=!1;const s=this._getModel(),n=this._getSource(),o=n.priceScale(),a=s.timeScale(),l=this.lastPrice();if(a.isEmpty()||o.isEmpty()||void 0===l)return;const u=a.visibleBarsStrictRange();if(null===u)return;const d=u.firstBar(),h=u.lastBar(),p=n.data(),_=p.search(h,c.PlotRowSearchMode.NearestLeft);if(null===_)return;const m=n.nearestIndex(d,c.PlotRowSearchMode.NearestRight);if(void 0===m)return;const f=n.model().properties().scalesProperties,g=(0,r.ensureNotNull)(p.valueAt(m))[4];let v=i.background,S=f.showSeriesLastValue.value(),y=!1,b=!1,w=!1
;const P=n.lastValueData(4,!1),C=n.properties().childs();if(8===C.style.value()&&C.haStyle.childs().showRealLastPrice.value()){const e=n.lastValueData(4,!0);if(e.noData||e.color===i.background||(v=e.color),!e.noData&&!P.noData){const t=e.index===P.index;y=t&&f.showSymbolLabels.value(),b=f.seriesLastValueMode.value()===ae.PriceAxisLastValueMode.LastPriceAndPercentageValue,S=S&&t,w=t&&this._isCountdownEnabled()&&C.showCountdown.value()}}else{v=n.barColorer().barStyle(_.index,!0).barColor}if(i.background=v,i.textColor=this.generateTextColor(v),i.secondLineTextColor=i.textColor,i.thirdLineTextColor=(0,ne.generateColor)(i.textColor,25),i.coordinate=o.priceToCoordinate(l,g),e.visible=S||w,!P.noData){const i=n.priceScale().isPercentage();P.formattedPriceAbsolute=o.formatPriceAbsolute(l),P.formattedPricePercentage=o.formatPricePercentage(l,g,!0),P.text=i?P.formattedPricePercentage:P.formattedPriceAbsolute,e.text=this._axisFirstLineText(P,S),e.secondLine=S&&b?i?P.formattedPriceAbsolute:P.formattedPricePercentage:"",e.thirdLine=w?this._countdownText():"",t.text=this._paneText(y)}t.visible=y}}var we=i(63956),Pe=i(17627),Ce=i(93669);const Te={light:{lineStyle:ve.LINESTYLE_DOTTED,lineWidth:1,textColor:Ce.colorsPalette["color-cold-gray-900"],backgroundColor:Ce.colorsPalette["color-tv-blue-50"],lineColor:Ce.colorsPalette["color-cold-gray-500"]},dark:{lineStyle:ve.LINESTYLE_DOTTED,lineWidth:1,textColor:Ce.colorsPalette["color-white"],backgroundColor:Ce.colorsPalette["color-tv-blue-a800"],lineColor:Ce.colorsPalette["color-cold-gray-500"]}};function xe(e){return e?Te.dark:Te.light}class Ie extends Pe.HorizontalLinePaneView{constructor(e,t,i){super(),this._model=e,this._isVisible=t,this._getValue=i}_updateImpl(){const e=this._lineRendererData;if(e.visible=!1,!this._isVisible.value())return;const t=this._model.mainSeries(),i=t.priceScale(),r=t.firstValue(),s=this._getValue();if(null===r||null===s)return;const n=xe(this._model.isDark());e.visible=!0,e.y=i.priceToCoordinate(s,r),e.linestyle=n.lineStyle,e.linewidth=n.lineWidth,e.color=n.lineColor}}class Le extends oe.PriceAxisView{constructor(e,t,i,r){super(),this._model=e,this._label=t,this._isVisible=i,this._getValue=r}_updateRendererData(e,t,i){if(e.visible=!1,t.visible=!1,!this._isVisible.value())return;const r=this._model.mainSeries(),s=r.priceScale(),n=r.firstValue(),o=this._getValue();if(null===n||null===o)return;const a=xe(this._model.isDark());e.visible=!0,t.visible=!0,e.text=s.formatPriceAbsolute(o),t.text=this._label,i.coordinate=s.priceToCoordinate(o,n),i.background=a.backgroundColor,i.textColor=a.textColor}}class Me extends ye.PriceLineAxisView{constructor(e,t,i){super(),this._model=e,this._isLineVisible=t,this._getValue=i}_isVisible(){return this._isLineVisible.value()}_lineWidth(){return xe(this._model.isDark()).lineWidth}_lineStyle(){return xe(this._model.isDark()).lineStyle}_priceLineColor(e){return xe(this._model.isDark()).lineColor}_value(){const e=this._model.mainSeries(),t=e.priceScale(),i=e.firstValue(),r=this._getValue();if(null===i||null===r)return{noData:!0}
;const s=t.priceToCoordinate(r,i);return{noData:!1,floatCoordinate:s,coordinate:s,color:"",formattedPricePercentage:"",formattedPriceAbsolute:"",text:"",index:0}}}const Ee=(0,g.t)("High"),Ae=(0,g.t)("Low"),ke=(0,g.t)("Avg");function De(e,t,i,r,s,n){const o=new Ie(e,s,n),a=new Le(e,i,r,n);return{paneView:o,panePriceAxisView:new we.PanePriceAxisView(a,t,e),priceAxisView:a,priceLineAxisView:new Me(e,s,n)}}var Re=i(96276),Ne=i.n(Re),Oe=i(5489),Ve=i(72927);class Be{constructor(){this._data=null}setData(e){this._data=e}data(){return this._data}draw(e,t){const i=this._data;if(null===i)return;const r=t.pixelRatio;e.save();const s=Math.max(1,Math.floor(r)),n=s%2/2,o=Math.round(i.center.x*r)+n,a=i.center.y*r;e.fillStyle=i.seriesLineColor,e.beginPath();const l=Math.max(2,1.5*i.seriesLineWidth)*r;e.arc(o,a,l,0,2*Math.PI,!1),e.fill(),e.fillStyle=i.fillColor,e.beginPath(),e.arc(o,a,i.radius*r,0,2*Math.PI,!1),e.fill(),e.lineWidth=s,e.strokeStyle=i.strokeColor,e.beginPath(),e.arc(o,a,i.radius*r+s/2,0,2*Math.PI,!1),e.stroke(),e.restore()}hitTest(e,t){return null}}function Fe(e){return e}const We=[{start:0,end:.25,startRadius:4,endRadius:10,startFillAlpha:.25,endFillAlpha:0,startStrokeAlpha:.4,endStrokeAlpha:.8,easing:Fe},{start:.25,end:.525,startRadius:10,endRadius:14,startFillAlpha:0,endFillAlpha:0,startStrokeAlpha:.8,endStrokeAlpha:0,easing:Fe},{start:.525,end:1,startRadius:14,endRadius:14,startFillAlpha:0,endFillAlpha:0,startStrokeAlpha:0,endStrokeAlpha:0,easing:Fe}];function Ue(e,t,i,r){const s=i+(r-i)*t;return(0,ne.applyTransparency)(e,(0,ne.alphaToTransparency)(s))}function He(e,t){const i=e%2600/2600;let r;for(const e of We)if(i>=e.start&&i<=e.end){r=e;break}if(void 0===r)throw new Error("Last price animation internal logic error");const s=r.easing((i-r.start)/(r.end-r.start));return{fillColor:Ue(t,s,r.startFillAlpha,r.endFillAlpha),strokeColor:Ue(t,s,r.startStrokeAlpha,r.endStrokeAlpha),radius:(n=s,o=r.startRadius,a=r.endRadius,o+(a-o)*n)};var n,o,a}class ze{constructor(e){this._renderer=new Be,this._invalidated=!0,this._stageInvalidated=!0,this._startTime=performance.now(),this._endTime=this._startTime-1,this._series=e}update(e){if(this._invalidated=!0,e){const e=performance.now(),t=this._endTime-e;if(t>0)return void(t<650&&(this._endTime+=2600));this._startTime=e,this._endTime=e+2600}}invalidateStage(){this._stageInvalidated=!0}animationActive(){return performance.now()<=this._endTime}stopAnimation(){this._endTime=this._startTime-1}renderer(e,t){return this._invalidated?(this._updateImpl(e,t),this._invalidated=!1,this._stageInvalidated=!1):this._stageInvalidated&&(this._updateRendererDataStage(),this._stageInvalidated=!1),this._renderer}_updateImpl(e,t){this._renderer.setData(null);const i=this._series.model().timeScale(),r=i.visibleBarsStrictRange(),s=this._series.firstValue(),n=this._series.lastValueData(void 0,!0,!0);if(null===r||null===s||void 0===n.index||void 0===n.price||!r.contains(n.index))return
;const o=new Ve.Point(i.indexToCoordinate(n.index),this._series.priceScale().priceToCoordinate(n.price,s)),a=n.color,l=this._series.properties().childs();let c;switch(this._series.style()){case 3:c=l.areaStyle.childs().linewidth.value();break;case 10:const t=l.baselineStyle,i=Math.round(e*(Math.abs(100-t.childs().baseLevelPercentage.value())/100));c=o.y<=i?t.childs().topLineWidth.value():t.childs().bottomLineWidth.value();break;default:c=l.lineStyle.childs().linewidth.value()}const u=He(this._duration(),a);this._renderer.setData({seriesLineColor:a,seriesLineWidth:c,fillColor:u.fillColor,strokeColor:u.strokeColor,radius:u.radius,center:o})}_updateRendererDataStage(){const e=this._renderer.data();if(null!==e){const t=He(this._duration(),e.seriesLineColor);e.fillColor=t.fillColor,e.strokeColor=t.strokeColor,e.radius=t.radius}}_duration(){return this.animationActive()?performance.now()-this._startTime:2599}}var je=i(94420),Ye=i(92462);const Ge=v.enabled("price_scale_always_last_bar_value"),qe=(0,me.isFeatureEnabled)("unit_conversion"),Xe=v.enabled("display_data_mode"),$e=s.CheckMobile.any(),Ke=!(0,s.onWidget)()&&(0,me.isFeatureEnabled)("legend_branding"),Je=(0,a.getLogger)("Chart.Series"),Ze={countdownEnabled:!0,lastPriceAnimationEnabled:!0};class Qe extends l.PriceDataSource{constructor(e,t,i,s){super(e),this.chartWidgetInitialized=new(Ne()),this.requestingIntradayWhenNotSupported=new(Ne()),this.requestingResolutionWhenNotSupported=new(Ne()),this.requestingStyleIsNotSupported=new(Ne()),this.requestingStyleSupportRecovered=new(Ne()),this._paneView=null,this._priceStep=null,this._symbolInfo=null,this._prevSymbolInfo=null,this._isPrePostMarketPricesForbiddenProperty=new(h())(!0),this._isBackAdjustmentForbiddenProperty=new(h())(!0),this._isSettlementAsCloseForbiddenProperty=new(h())(!0),this._highLowAvgPriceCache=new Map,this._prevClosePriceAxisView=null,this._priceScaleChanged=new(Ne()),this._priceScaleAboutToBeChanged=new(Ne()),this._onRestarted=new(Ne()),this._onStatusChanged=new(Ne()),this._extendedHoursChanged=new(Ne()),this._tagsChanged=new(Ne()),this._sessionIdChanged=new(Ne()),this._currency=null,this._unit=null,this._endOfData=!1,this._lineStyleLastPriceCirclePaneView=new ze(this),this._prevClosePriceLineView=null,this._dataPoweredBy=null,this._loading=!0,this._seriesLoaded=!1,this._status=0,this._symbolResolvingActive=new(U())(!1),this._predictBars=0,this._boxSizeValue=new(U()),this._base=100,this._pointValue=1,this._formatter=new _.PriceFormatter(this._base),this._ignoreMinMoveFormatter=new _.PriceFormatter(this._base),this._ignoreMinMovePriceStep=null,this._lastBarCloseTime=null,this._onSessionIdPropertyChangedBound=this._onSessionIdPropertyChanged.bind(this),this._ignoreSessionIdProxyPropertyChanges=!1,this._textSourceIsAlwaysTickerRestrictionEnabled=!1,this._lastPriceAnimationActive=!1,this._currentSession="out_of_session",this._onStyleChanged=new(Ne()),this._preventRestartOnChartStyleChange=!1,this._intervalObj=null,this._obsoleteZOrder=0,this._seriesErrorMessage=null,
this._seriesAlwaysFalseHibernatedVW=new(U())(!1),this._styleToRecover=null,this._seriesSource=new Ye.SeriesDataSource(e.chartApi(),"s",s);const n=this._seriesSource.dataEvents();n.symbolResolved().subscribe(this,this._onSymbolResolved),n.symbolError().subscribe(this,this._onSymbolError),n.seriesTimeFrame().subscribe(this,this._onSeriesTimeFrame),n.seriesError().subscribe(this,this._onSeriesError),n.loading().subscribe(this,this._onSeriesLoading),n.completed().subscribe(this,this._onSeriesCompleted),n.dataUpdated().subscribe(this,this._onDataUpdated),n.barReceived().subscribe(this,this._onBarReceived),this._quotesProvider=new se.QuotesProvider,this._quotesProvider.quotesUpdate().subscribe(this,this._onQuotesUpdate);const o=t.childs();if(t.hasChild("extendedHours")){(0,r.ensureDefined)(o.extendedHours).value()&&!t.hasChild("sessionId")&&t.addChild("sessionId",new(h())("extended")),t.removeProperty("extendedHours")}t.hasChild("sessionId")||t.addChild("sessionId",new(h())("regular")),this._setProperties(t),this._sessionIdProxyProperty=new(h())(o.sessionId.value()),o.sessionId.subscribe(this,()=>this._updateSessionIdProxyProperty()),this._sessionIdProxyProperty.subscribe(this,this._onSessionIdProxyPropertyChanged),this._symbolTextSourceProxyProperty=new(h()),this._recalcSymbolTextSourceProxyProperty(),o.statusViewStyle.childs().symbolTextSource.subscribe(this,this._recalcSymbolTextSourceProxyProperty),this._symbolTextSourceProxyProperty.subscribe(this,()=>e.lightUpdate()),this._options=(0,ie.merge)((0,ie.clone)(Ze),i),this._prevChartStyle=o.style.value();const a=new _e(this,e,{alwaysShowGlobalLast:!0,showCountdown:i.countdownEnabled});this._priceAxisView=a;let l=null;Ge||(l=new _e(this,e,{visibleOnHistoryOnly:!0,showSymbolLabel:!1,showCountdown:!1,alwaysShowGlobalLast:!1})),this._priceLinePriceAxisView=new ye.SeriesPriceLineAxisView(this),this._priceLineAxisViews=[this._priceLinePriceAxisView];const c=new be(this,e,{showCountdown:i.countdownEnabled});this._priceAxisViews=[a,c],null!==l&&this._priceAxisViews.push(l),this._prevClosePriceAxisView=new fe(this,e),this._priceAxisViews.unshift(this._prevClosePriceAxisView),this._prevClosePriceLineView=new Se(this),this._panePriceAxisView=new we.PanePriceAxisView(a,this,e),this._historyPricePanePriceAxisView=null!==l?new we.PanePriceAxisView(l,this,e):null,this._projectionPriceAxisView=new we.PanePriceAxisView(c,this,e),this._labelPaneViews=[this._panePriceAxisView,this._projectionPriceAxisView],null!==this._historyPricePanePriceAxisView&&this._labelPaneViews.push(this._historyPricePanePriceAxisView),this._highLowAvgPaneViews=[],this._createHighLowAvgViews(),this._subscribeRestartToSessionIdChange(),o.visible.subscribe(this,this._updateLastPriceAnimationActive),this._updateLastPriceAnimationActive(),this._dataWindowView=new N(this,e),this._legendView=new F(this,e);const u={branding:Ke};this._statusView=new I(this,this._model.properties().scalesProperties.textColor,o.statusViewStyle,u),this._marketStatusModel=new q(this._quotesProvider,o.symbol.listeners()),
this._dataUpdatedModeModel=Xe?new ee({getter:this.symbolInfo.bind(this),onChange:n.symbolResolved()},{getter:this.status.bind(this),onChange:this._onStatusChanged},o.symbol.listeners()):null,this._dataProblemModel=new re(this._quotesProvider,o.symbol.listeners()),o.backAdjustment.subscribe(this,()=>{this.isStarted()&&this.restart()}),o.settlementAsClose.subscribe(this,()=>{this.isDWM()&&this.isStarted()&&this.restart()})}seriesErrorMessage(){return this._seriesErrorMessage}destroy(){this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._model.timeScale().visibleBarsStrictRangeChanged().unsubscribeAll(this),this._unsubscribeRestartToSessionIdChange()}properties(){return this._properties}zorder(){return 0}quotesProvider(){return this._quotesProvider}currentSession(){return this._currentSession}labelPaneViews(){return this._labelPaneViews}topPaneViews(){if(this._lastPriceAnimationActive){const e=this._lineStyleLastPriceCirclePaneView;return e.animationActive()&&setTimeout(()=>this._model.invalidate(je.InvalidationMask.cursor()),0),e.invalidateStage(),[e]}return null}priceAxisViews(e,t){return e.findTargetPriceAxisViews(this,t,this._priceAxisViews,this._priceLineAxisViews)}clearHighLowAvgPriceCache(){this._highLowAvgPriceCache.clear()}priceScaleChanged(){return this._priceScaleChanged}priceScaleAboutToBeChanged(){return this._priceScaleAboutToBeChanged}disconnect(){this._seriesSource.stop(),this.m_symbol=void 0,this._predictBars=0,this._status=0,this._model.isSnapshot()||(this._prevSymbolInfo=null,this._symbolInfo=null)}isStatusBad(){return 12===this.status()||4===this.status()||10===this.status()}isStatusError(){return 12===this.status()}actualSymbol(){return(0,p.actualSymbol)(this.symbolInfo(),this.symbol())}proSymbol(){return(0,p.proSymbol)(this.symbolInfo(),this.symbol())}onStyleChanged(){return this._onStyleChanged}style(){return this.properties().childs().style.value()}setStyle(e){this.properties().childs().style.setValue(e)}symbolSameAsCurrent(e){return(0,Oe.symbolSameAsCurrent)(e,this.m_symbol,this.symbolInfo())}symbolInfo(){return this._symbolInfo}symbolResolved(){return this.dataEvents().symbolResolved()}symbolResolvingActive(){return this._symbolResolvingActive}symbolHibernated(){return this._seriesAlwaysFalseHibernatedVW}formatter(e=!0){return e?this._formatter:this._ignoreMinMoveFormatter}priceStep(e=!0){return e?this._priceStep:this._ignoreMinMovePriceStep}interval(){return this.properties().childs().interval.value()}setInterval(e){this.properties().childs().interval.setValue(e)}intervalObj(){const e=this.interval();if(null!==this._intervalObj&&this._intervalObj.resolutionString===e)return this._intervalObj.interval;const t=X.Interval.parse(e);return this._intervalObj={resolutionString:e,interval:t},t}prevClose(){const e=this.priceScale();if(e.isEmpty()||this.data().isEmpty())return null;const t=this.quotes(),i=this.firstValue();if(null===t||null===i)return null;const r=t.prev_close_price;return void 0===r?null:{coordinate:e.priceToCoordinate(r,i),floatCoordinate:e.priceToCoordinate(r,i),
formattedPricePercentage:e.formatPricePercentage(r,i,!0),formattedPriceAbsolute:e.formatPriceAbsolute(r)}}hasClosePrice(){return 12!==this.properties().childs().style.value()}lastValueData(e,t,i){const r={noData:!0},s=this.priceScale();if(this.model().timeScale().isEmpty()||s.isEmpty()||this.data().isEmpty())return r;const n=this.model().timeScale().visibleBarsStrictRange(),o=this.firstValue();if(null===n||null===o)return r;let a,l;if(t){const e=this.data().bars().last();if(null===e)return r;a=e.value,l=e.index}else{const e=this.data().bars().search(n.lastBar(),c.PlotRowSearchMode.NearestLeft);if(null===e)return r;a=e.value,l=e.index}const u=void 0!==e?a[e]:this._barFunction(a),d=this.barColorer().barStyle(l,!1),h=s.priceToCoordinate(u,o),p=s.formatPriceAbsolute(u),_=s.formatPricePercentage(u,o,!0),m={noData:!1,text:s.isPercentage()?_:p,formattedPriceAbsolute:p,formattedPricePercentage:_,color:d.barColor,floatCoordinate:h,coordinate:h,index:l};return i&&(m.price=u),m}isDWM(){return this.intervalObj().isDWM()}nearestValue(e,t,i){const r=this.nearestData(e,i);return r?r.value[t]:void 0}onStatusChanged(){return this._onStatusChanged}onRestarted(){return this._onRestarted}onExtendedHoursChanged(){return this._extendedHoursChanged}sessionId(){return this.properties().childs().sessionId.value()}sessionIdChanged(){return this._sessionIdChanged}autoScaleInfo(e,t){const i=this.priceRange(e,t);if(null===this._paneView)return{range:i};const r=this._paneView;return{range:i,topPixelMargin:r.topPixelMargin?r.topPixelMargin():void 0,bottomPixelMargin:r.bottomPixelMargin?r.bottomPixelMargin():void 0}}onChartStyleChanged(){var e;this._updateBarFunction(),!this._preventRestartOnChartStyleChange&&this.isNeedRestart()&&(this.data().clear(),this.model().timeScale().scrollToRealtime(!1),this.isInReplay()&&!this.isStyleSupportedForReplay(this.style())&&this._removeReplaySubscriber(),this.restart());const t=this.properties();this._prevChartStyle=t.childs().style.value(),this._onStyleChanged.fire(t.childs().style.value()),this.invalidateBarStylesCache(),this._updateLastPriceAnimationActive(),(null===(e=this._styleToRecover)||void 0===e?void 0:e.originalStyle)!==this.style()&&(this._styleToRecover=null)}sessionIdProxyProperty(){return this._sessionIdProxyProperty}symbolTextSourceProxyProperty(){return this._symbolTextSourceProxyProperty}setTextSourceIsAlwaysTickerRestrictionEnabled(e){this._textSourceIsAlwaysTickerRestrictionEnabled=e,this._recalcSymbolTextSourceProxyProperty()}isPrePostMarketPricesForbiddenProperty(){return this._isPrePostMarketPricesForbiddenProperty}isSettlementAsCloseForbiddenProperty(){return this._isSettlementAsCloseForbiddenProperty}isBackAdjustmentForbiddenProperty(){return this._isBackAdjustmentForbiddenProperty}quotes(){return this.data().isEmpty()?null:this._quotesProvider.quotes()}base(){return this._base}pointValue(){return this._pointValue}barCloseTime(){return this._lastBarCloseTime}barFunction(){return this._barFunction}setSymbolParams(e){
const{symbol:t,interval:i,currency:r,unit:s,style:n}=e,o=this.properties().childs(),a=void 0!==t&&t!==o.symbol.value(),l=void 0!==r&&r!==o.currencyId.value(),c=void 0!==s&&s!==o.unitId.value(),u=void 0!==i&&i!==o.interval.value(),d=void 0!==n&&n!==o.style.value();a&&o.symbol.setValueSilently(t),l&&o.currencyId.setValueSilently(r),c&&o.unitId.setValueSilently(s),u&&o.interval.setValueSilently(i),d&&o.style.setValueSilently(n),a&&o.symbol.listeners().fire(o.symbol),l&&o.currencyId.listeners().fire(o.currencyId),c&&o.unitId.listeners().fire(o.unitId),u&&o.interval.listeners().fire(o.interval),d&&(a||l||c?(this._preventRestartOnChartStyleChange=!0,o.style.listeners().fire(o.style),this._preventRestartOnChartStyleChange=!1):o.style.listeners().fire(o.style))}setSymbol(e){this.setSymbolParams({symbol:e})}currency(){return this.properties().childs().currencyId.value()||null}setCurrency(e){this.setSymbolParams({currency:e})}isConvertedToOtherCurrency(){return(0,p.isConvertedToOtherCurrency)(this.symbolInfo())}unit(){return this.properties().childs().unitId.value()||null}setUnit(e){this.properties().childs().unitId.setValue(e)}isConvertedToOtherUnit(){return(0,p.isConvertedToOtherUnit)(this.symbolInfo())}symbolSource(){return this}title(){return this.symbolTitle()}symbolTitle(e,t,i="exchange"){let r=this.properties().childs().symbol.value();const s=this.symbolInfo();if(null!==s){const{type:t}=s;r=(0,p.symbolTitle)(s,e,"forex"===t?"exchange":i)}return t?r:`${r}, ${(0,M.translatedIntervalString)(this.properties().childs().interval.value())}`}setObsoleteZOrder(e){this._obsoleteZOrder=e}obsoleteZOrder(){return this._obsoleteZOrder}valuesProvider(){return new V(this,this.model())}statusProvider(e){return new x(this,this._model.properties().scalesProperties.textColor,this.properties().childs().statusViewStyle,e)}open(e){const t=this.data().valueAt(e);return t&&t[1]}high(e){const t=this.data().valueAt(e);return t&&t[2]}low(e){const t=this.data().valueAt(e);return t&&t[3]}close(e){const t=this.data().valueAt(e);return t&&t[4]}moveItem(e,t,i){if(10===this.style()&&0===t){const t=this.priceScale(),i=this.properties().childs().baselineStyle,r=t.height(),s=100-e.y/r*100,n=s<0?0:Math.round(10*s)/10;i.childs().baseLevelPercentage.setValue(Math.max(Math.min(n,100),0))}}endOfData(){return this._endOfData}dataPoweredBy(){return this._dataPoweredBy}boxSizeValue(){return this._boxSizeValue}isUserDeletable(){return!1}changeSymbol(){this.setSymbolIntervalCurrencyDelayed(),this.model().checkLineToolSelection()}changeInterval(){this.setSymbolIntervalCurrencyDelayed()}changeTimeFrame(){(0,n.trackEvent)("GUI","Change timeframe")}onTagsChanged(){return this._tagsChanged}_updateBarFunction(){if(12===this.properties().childs().style.value())this._barFunction=(0,u.barFunction)("low");else{const e=this.priceSource()||"close";this._barFunction=(0,u.barFunction)(e)}}_setProperties(e){e.hasChild("timeframe")||e.merge({timeframe:""}),e.hasChild("shortName")||e.merge({shortName:""}),e.hasChild("currencyId")||e.addChild("currencyId",new(h())(null)),
e.hasChild("unitId")||e.addChild("unitId",new(h())(null)),this._properties=e;const t=e.childs();t.symbol.listeners().subscribe(this,this.changeSymbol),t.interval.listeners().subscribe(this,this.changeInterval),t.currencyId.listeners().subscribe(this,this._changeCurrency),t.unitId.listeners().subscribe(this,this._changeUnit),t.timeframe.listeners().subscribe(this,this.changeTimeFrame),e.subscribe(this,this._onPropertiesChanged)}_updateSessionIdProxyProperty(e){const t=this._properties.childs().sessionId.value();let i=t;if(e){const e=this.symbolInfo();null!==e&&(i=e.subsession_id||t)}this._ignoreSessionIdProxyPropertyChanges=!0,this._sessionIdProxyProperty.setValue(i),this._ignoreSessionIdProxyPropertyChanges=!1}_onSessionIdProxyPropertyChanged(){this._ignoreSessionIdProxyPropertyChanges||this._properties.childs().sessionId.setValue(this._sessionIdProxyProperty.value()),this._updateLastPriceAnimationActive()}_onSeriesLoading(e){this._loading=!0,this._setStatus(2)}_onDataUpdated(e,t){if(this.hasDelayedSymbolIntervalChange()){if(this._willSymbolIntervalCurrencyChanged())return void Je.logNormal("command comes during symbol/interval changing");Je.logNormal("data_update comes when symbol interval delay present but symbol/interval should not be changed")}t?this._endOfData=!1:this._lastPriceAnimationActive&&this._seriesLoaded&&this._lineStyleLastPriceCirclePaneView.update(!0),this._lastBarCloseTime=e&&e.closeTime||null,this._boxSizeValue.setValue(this.data().boxSize),this._statusView.update(),this.clearHighLowAvgPriceCache();const i=this.model(),s=(0,r.ensureNotNull)(i.paneForSource(this));i.recalculatePane(s),i.updateSource(this),i.updateLineTools()}_setStatus(e){this._status=e,this._statusView.update(),this.model().updateSource(this),this._onStatusChanged.fire()}_willSymbolIntervalCurrencyChanged(){const e=this.properties().childs(),t=this._checkIntervalWillChanged(e.interval.value()),i=this._checkSymbolWillChanged(e.symbol.value()),r=this._checkCurrencyWillChanged(e.currencyId.value()),s=this._checkUnitWillChanged(e.unitId.value());return i||t||r||s}_checkSymbolWillChanged(e){return!this.symbolSameAsCurrent(e)}_checkIntervalWillChanged(e){return!X.Interval.isEqual(this.m_interval,e)}_recreateFormatter(){this._formatter=(0,p.createSeriesFormatter)(this.symbolInfo(),this.properties().childs().minTick.value()),this._ignoreMinMoveFormatter=(0,p.createSeriesFormatter)(this.symbolInfo(),this.properties().childs().minTick.value(),!0),this.priceScale()&&this.priceScale().updateFormatter(),this._formatterChanged.fire()}_recreatePriceStep(){const{minMove:e,priceScale:t}=(0,p.getSeriesPriceFormattingState)(this.symbolInfo()),i=e/t;this._ignoreMinMovePriceStep=1/t,this._priceStep!==i&&(this._priceStep=i,this._priceStepChanged.fire())}_recreatePriceFormattingDependencies(){this._recreateFormatter(),this._recreatePriceStep()}_onQuotesUpdate(e,t){if($e){const e=void 0!==t.values.change||void 0!==t.values.change_percent;e&&this._legendView.update();const i=void 0!==t.values.prev_close_price;i&&((0,
r.ensureNotNull)(this._prevClosePriceLineView).update(),(0,r.ensureNotNull)(this._prevClosePriceAxisView).update()),(e||i)&&this.model().updateSource(this)}void 0!==e.values.current_session&&e.values.current_session!==this._currentSession&&(this._currentSession=e.values.current_session,this._updateLastPriceAnimationActive())}_updateIsPrePostMarketPricesForbiddenProperty(){const e=!this.isDWM()&&!(0,p.isRegularSessionId)(this.sessionIdProxyProperty().value());this._isPrePostMarketPricesForbiddenProperty.setValue(e)}_updateSettlementAsCloseForbiddenProperty(){var e;const t=this.isDWM()&&Boolean(null===(e=this._symbolInfo)||void 0===e?void 0:e.has_settlement);this._isSettlementAsCloseForbiddenProperty.setValue(!t)}_updateBackAdjustmentForbiddenProperty(){var e;const t=Boolean(null===(e=this._symbolInfo)||void 0===e?void 0:e.has_backadjustment);this._isBackAdjustmentForbiddenProperty.setValue(!t)}_getSymbolForApi(){return(0,p.symbolForApi)(this.symbolInfo()||this._prevSymbolInfo,this.symbol())}_getSymbolObject(){const e=this._getExtendedSymbolObject();if(m.SYMBOL_STRING_DATA.hasOwnProperty(this.properties().childs().style.value())){return{symbol:e,type:this.styleStudyInfo(this.getStyleShortName()+"Style").studyId+"!",inputs:this.getInputsProperties().state()}}return e}_getExtendedSymbolObject(){const e={symbol:this._getSymbolForApi()};null!==this.currency()&&(e["currency-id"]=this.currency());const t=this.unit();qe&&null!==t&&(e["unit-id"]=t);{const t=this.properties().childs();e.adjustment=t.dividendsAdjustment.value()?"dividends":"splits",this.isDWM()||(e.session=t.sessionId.value()),t.backAdjustment.value()&&(e.backadjustment="default"),t.settlementAsClose.value()||(e["settlement-as-close"]=!1)}return e}_changeCurrency(){this.setSymbolIntervalCurrencyDelayed(),this.model().checkLineToolSelection(),this._currencyChanged.fire()}_changeUnit(){qe&&(this.setSymbolIntervalCurrencyDelayed(),this.model().checkLineToolSelection()),this._unitChanged.fire()}_checkCurrencyWillChanged(e){return this._currency!==e}_checkUnitWillChanged(e){return!!qe&&this._unit!==e}_checkInterval(){if(this._symbolInfo&&(X.Interval.isIntraday(this.interval())&&!this._symbolInfo.has_intraday&&this.requestingIntradayWhenNotSupported.fire(),this._symbolInfo.hasOwnProperty("supported_resolutions"))){const e=X.Interval.normalize(this._properties.childs().interval.value());null!==e&&-1===this._symbolInfo.supported_resolutions.indexOf(e)&&this.requestingResolutionWhenNotSupported.fire(this._symbolInfo.supported_resolutions[0])}}_checkChartStyle(){const e=this.style();(0,p.isCloseBasedSymbol)(this.symbolInfo())?(0,p.isSingleValueBasedStyle)(e)||(this.requestingStyleIsNotSupported.fire(),this._styleToRecover={correctedStyle:this.style(),originalStyle:e}):null!==this._styleToRecover&&(this.requestingStyleSupportRecovered.fire(this._styleToRecover.originalStyle),this._styleToRecover=null)}_createHighLowAvgViews(){const e=this.properties().childs().highLowAvgPrice,t=this._getHighLowAvgPrice.bind(this),i=function(e,t,i,r){
const s=i.childs(),n=De(e,t,Ee,s.highLowPriceLabelsVisible,s.highLowPriceLinesVisible,()=>r(0)),o=De(e,t,Ae,s.highLowPriceLabelsVisible,s.highLowPriceLinesVisible,()=>r(1)),a=De(e,t,ke,s.averageClosePriceLabelVisible,s.averageClosePriceLineVisible,()=>r(2));return{paneViews:[n.paneView,o.paneView,a.paneView],panePriceAxisViews:[n.panePriceAxisView,o.panePriceAxisView,a.panePriceAxisView],priceAxisViews:[n.priceAxisView,o.priceAxisView,a.priceAxisView],priceLineAxisViews:[n.priceLineAxisView,o.priceLineAxisView,a.priceLineAxisView]}}(this._model,this,e,t);this._highLowAvgPaneViews.push(...i.paneViews),this._labelPaneViews.push(...i.panePriceAxisViews),this._priceAxisViews.push(...i.priceAxisViews),this._priceLineAxisViews.push(...i.priceLineAxisViews)}_getHighLowAvgPrice(e){if(!this._highLowAvgPriceCache.has(e)){const t=this._model.timeScale().visibleBarsStrictRange();if(null===t)return null;const i=this._model.mainSeries().bars(),r=t.firstBar(),s=t.lastBar();if(2===e){const e=function(e,t,i){const r=(0,u.barFunction)("close");let s=0,n=0;for(let o=t;o<=i;o++){const t=e.valueAt(o);null!==t&&(s+=r(t),n++)}return n?s/n:null}(i,r,s);if(null===e)return null;this._highLowAvgPriceCache.set(2,e)}else{const e=function(e,t,i){return e.minMaxOnRangeCached(t,i,[{name:"low",offset:0},{name:"high",offset:0}])}(i,r,s);if(null===e)return null;this._highLowAvgPriceCache.set(1,e.min),this._highLowAvgPriceCache.set(0,e.max)}}return this._highLowAvgPriceCache.get(e)}_onSessionIdPropertyChanged(){this._sessionIdChanged.fire(),this.isDWM()||(this.restart(),this._updateLastPriceAnimationActive())}_subscribeRestartToSessionIdChange(){this.properties().childs().sessionId.subscribe(this,this._onSessionIdPropertyChangedBound)}_unsubscribeRestartToSessionIdChange(){this.properties().childs().sessionId.unsubscribe(this,this._onSessionIdPropertyChangedBound)}_updateLastPriceAnimationActive(){if(!this._options.lastPriceAnimationEnabled)return;const e=this._lastPriceAnimationActive,t=this.properties().childs(),i=t.style.value();if(this._model.isSnapshot()||!t.visible.value()||3!==i&&10!==i&&2!==i)this._lastPriceAnimationActive=!1;else{const e=this.currentSession(),t=!(0,p.isRegularSessionId)(this.sessionIdProxyProperty().value())&&!this.isDWM();this._lastPriceAnimationActive="market"===e||t&&("pre_market"===e||"post_market"===e)}this._lastPriceAnimationActive&&e!==this._lastPriceAnimationActive&&this.model().invalidate(je.InvalidationMask.cursor())}_onPropertiesChanged(e){const t=this._properties.childs();e!==t.symbol&&e!==t.interval&&e!==t.timeframe&&(this._tagsChanged.fire(),this.createPaneView(),this.updateAllViews(),this.model().updateSource(this),(0,o.emit)("series_properties_changed",this._id))}_recalcSymbolTextSourceProxyProperty(){this._textSourceIsAlwaysTickerRestrictionEnabled?this._symbolTextSourceProxyProperty.setValue("ticker"):this._symbolTextSourceProxyProperty.setValue(this._properties.childs().statusViewStyle.childs().symbolTextSource.value())}}},97786:(e,t,i)=>{"use strict";i.r(t),i.d(t,{STATUS_OFFLINE:()=>r,
STATUS_RESOLVING:()=>s,STATUS_LOADING:()=>n,STATUS_READY:()=>o,STATUS_INVALID_SYMBOL:()=>a,STATUS_SNAPSHOT:()=>l,STATUS_EOD:()=>c,STATUS_PULSE:()=>u,STATUS_DELAYED:()=>d,STATUS_DELAYED_STREAMING:()=>h,STATUS_NO_BARS:()=>p,STATUS_REPLAY:()=>_,STATUS_ERROR:()=>m,SERIES_STATUS_TEXT:()=>f,STYLE_LINE_TYPE_MARKERS:()=>g,STYLE_LINE_TYPE_STEP:()=>v,STYLE_LINE_TYPE_SIMPLE:()=>S,STYLE_BARS:()=>y,STYLE_CANDLES:()=>b,STYLE_LINE:()=>w,STYLE_AREA:()=>P,STYLE_RENKO:()=>C,STYLE_KAGI:()=>T,STYLE_PNF:()=>x,STYLE_PB:()=>I,STYLE_HEIKEN_ASHI:()=>L,STYLE_HOLLOW_CANDLES:()=>M,STYLE_BASELINE:()=>E,STYLE_RANGE:()=>A,STYLE_HILO:()=>k,STYLE_SHORT_NAMES:()=>D,SYMBOL_STRING_DATA:()=>R});const r=0,s=1,n=2,o=3,a=4,l=5,c=6,u=7,d=8,h=9,p=10,_=11,m=12,f={[r]:"connecting",[s]:"loading",[n]:"loading",[o]:"realtime",[a]:"invalid",[l]:"snapshot",[c]:"endofday",[u]:"endofday",[d]:"delayed",[h]:"delayed_streaming",[p]:"forbidden",[_]:"replay",[m]:"error"},g=0,v=1,S=2,y=0,b=1,w=2,P=3,C=4,T=5,x=6,I=7,L=8,M=9,E=10,A=11,k=12,D={0:"bar",1:"candle",9:"hollowCandle",2:"line",3:"area",4:"renko",7:"pb",5:"kagi",6:"pnf",8:"ha",10:"baseline",11:"range",12:"hilo"},R={4:{type:"BarSetRenko@tv-prostudies",basicStudyVersion:40},7:{type:"BarSetPriceBreak@tv-prostudies",basicStudyVersion:34},5:{type:"BarSetKagi@tv-prostudies",basicStudyVersion:34},6:{type:"BarSetPnF@tv-prostudies",basicStudyVersion:34},8:{type:"BarSetHeikenAshi@tv-basicstudies",basicStudyVersion:60},11:{type:"BarSetRange@tv-basicstudies",basicStudyVersion:72}}},46561:(e,t,i)=>{"use strict";i.d(t,{seriesPlotFunctionMap:()=>l,barFunction:()=>c,SeriesData:()=>d});var r,s=i(16282),n=i(40989);!function(e){e[e.FromLeft=-1]="FromLeft",e[e.FromRight=1]="FromRight"}(r||(r={}));const o={open:e=>e[1],high:e=>e[2],low:e=>e[3],close:e=>e[4],hl2:e=>(e[2]+e[3])/2,hlc3:e=>(e[2]+e[3]+e[4])/3,ohlc4:e=>(e[1]+e[2]+e[3]+e[4])/4},a=["open","high","low","close","hl2","hlc3","ohlc4"];function l(){const e=new Map;return a.forEach((t,i)=>{e.set(t,c(t))}),e}function c(e){return o[e]}function u(e,t){return null==e[t]}class d{constructor(){this.m_bars=new n.PlotList(l(),u),this.m_nsBars=new n.PlotList(l(),u)}bars(){return this.m_bars}nsBars(){return this.m_nsBars}size(){return this.m_bars.size()+this.m_nsBars.size()}each(e){this.m_bars.each(e),this.m_nsBars.each(e)}clear(){this.m_bars.clear(),this.m_nsBars.clear(),this.lastProjectionPrice=void 0}isEmpty(){return this.m_bars.isEmpty()&&this.m_nsBars.isEmpty()}first(){return this.m_bars.isEmpty()?this.m_nsBars.first():this.m_bars.first()}last(){return this.m_nsBars.isEmpty()?this.m_bars.last():this.m_nsBars.last()}search(e,t){return this.nsBars().isEmpty()?this.bars().search(e,t):this.bars().isEmpty()||(0,s.ensureNotNull)(this.nsBars().firstIndex())<=e?this.nsBars().search(e,t):this.bars().search(e,t)}valueAt(e){const t=this.search(e);return null!==t?t.value:null}plotValueToTimePointIndex(e,t,i){if(i===r.FromRight){const i=(i,r)=>{const s=r[t];return null!=s&&e>=s},r=this.m_bars.findLast(i);if(null!==r)return r.index;const s=this.m_nsBars.findLast(i)
;return null!==s?s.index:this.m_bars.firstIndex()}if(i===r.FromLeft){const i=(i,r)=>{const s=r[t];return null!=s&&e<=s},r=this.m_bars.findFirst(i);if(null!==r)return r.index;const s=this.m_nsBars.findFirst(i);return null!==s?s.index:this.m_bars.lastIndex()}throw new Error("plotValueToTimePointIndex: unsupported search mode")}moveData(e){this.m_bars.move(e),this.m_nsBars.move(e)}}},62921:(e,t,i)=>{"use strict";i.d(t,{SeriesTimeRangeVolumeCalculator:()=>r});class r{constructor(e){this._value=null,this._series=e,this._series.dataEvents().dataUpdated().subscribe(this,this._onSeriesUpdated)}destroy(){this._series.dataEvents().dataUpdated().unsubscribeAll(this)}volume(e,t){if(null!==this._value&&this._value.from===e&&this._value.to===t)return this._value.value;let i=0;const r=this._series.data().bars(),s=r.firstIndex(),n=r.lastIndex();if(null!==s&&e<s&&t<s||null!==n&&e>n&&t>n)i=NaN;else{const r=this._series.data().bars().rangeIterator(Math.min(e,t),Math.max(e,t));for(;r.hasNext();){const e=r.next().value[5];if(void 0===e){i=NaN;break}i+=e}}return this._value={from:e,to:t,value:i},i}_onSeriesUpdated(e,t){if(null===this._value)return;if(t)return void(this._value=null);const i=this._series.data().bars().lastIndex();(null===i||i<=this._value.to)&&(this._value=null)}}},20554:(e,t,i)=>{"use strict";i.r(t),i.d(t,{isRequiringRestartSeriesStyles:()=>b,isRangeBasedStyle:()=>w,isRangeStyle:()=>P,isTimeBasedStyle:()=>C,isValidStyle:()=>T,isSingleValueBasedStyle:()=>x,setLastUsedStyle:()=>I,getLastUsedStyle:()=>L,getLastUsedSingleValueBasedStyle:()=>M,getDefaultStyle:()=>E,getChartStyleByResolution:()=>A,chartStyleStudyId:()=>k,preparePriceAxisProperties:()=>D,hasProjection:()=>N,isPriceSourceStyle:()=>O,getSeriesPriceFormattingState:()=>V,createSeriesFormatter:()=>B,symbolCurrencyConvertible:()=>F,symbolCurrency:()=>W,symbolOriginalCurrency:()=>U,symbolBaseCurrency:()=>H,isConvertedToOtherCurrency:()=>z,symbolUnitConvertible:()=>j,symbolUnit:()=>Y,symbolOriginalUnit:()=>G,isConvertedToOtherUnit:()=>q,symbolUnitConvertibleGroupsIfExist:()=>X,symbolCurrentContract:()=>$,extractSymbolNameFromSymbolInfo:()=>K,symbolTitle:()=>J,displayedSymbolName:()=>Z,displayedSymbolExchange:()=>Q,actualSymbol:()=>ee,proSymbol:()=>te,symbolForApi:()=>ie,isRegularSessionId:()=>re,isCloseBasedSymbol:()=>se,hasVolume:()=>ne});var r=i(42098),s=i(97786),n=i(2459),o=i(11228),a=i(22842),l=i(98006),c=i(16282),u=i(81293),d=i(14704);const h=(0,l.isFeatureEnabled)("unit_conversion"),p=a.enabled("pay_attention_to_ticker_not_symbol"),_=a.enabled("uppercase_instrument_names"),m=a.enabled("charting_library_single_symbol_request"),f=a.enabled("use_ticker_on_symbol_info_update"),g=[4,5,6,7,8],v=[4,5,6,7,8,11],S=[0,1,9,2,3,10],y=[2,10,3];function b(e){return-1!==g.indexOf(e)}function w(e){return-1!==v.indexOf(e)}function P(e){return 11===e}function C(e){return-1!==S.indexOf(e)}function T(e){return w(e)||C(e)}function x(e){switch(e){case 3:case 10:case 2:return!0;default:return!1}}function I(e,t){T(e)&&(11!==e&&r.setValue("chart.lastUsedStyle",e),
se(t)&&x(e)&&r.setValue("chart.lastUsedSingleValueBasedStyle",e))}function L(){const e=r.getInt("chart.lastUsedStyle");return void 0===e?1:e}function M(){const e=r.getInt("chart.lastUsedSingleValueBasedStyle");return void 0===e?2:e}function E(e){return e?11:1}function A(e,t){const i=P(t),r=n.Interval.isRange(e);return!i&&r?E(!0):i&&!r?E(!1):t}function k(e,t){const i=s.SYMBOL_STRING_DATA[e];return void 0===i?null:t?`${i.type}-${i.basicStudyVersion}`:i.type}function D(e){const t=e.priceAxisProperties,i=t.lockScale.value(),r=6===e.style.value();(r||i)&&(t.log.setValue(!1),t.percentage.setValue(!1)),t.logDisabled.setValue(!(!r&&!i)),t.percentageDisabled.setValue(!(!r&&!i))}const R=[4,7,5,6];function N(e){return-1!==R.indexOf(e)}function O(e){return y.includes(e)}function V(e,t="default",i=!1){let r,s,n=100,o=1;if("default"===t)null!=e&&(n=e.pricescale,o=e.minmov,r=e.fractional,s=e.minmove2);else{let e=t.split(",");3!==e.length&&(e=["100","1","false"]),n=parseInt(e[0]),o=parseInt(e[1]),r="true"===e[2]}return i&&(o=1),{priceScale:n,minMove:o,fractional:r,minMove2:s}}function B(e,t,i=!1){if("default"===t&&null!=e){if("volume"===e.formatter||"volume"===e.format)return new u.VolumeFormatter(2);if("percent"===e.formatter||"percent"===e.format)return new d.PercentageFormatter(e.pricescale)}const{priceScale:r,minMove:s,fractional:n,minMove2:a}=V(e,t,i);return new o.PriceFormatter(r,s,n,a)}function F(e){return null!==e&&"spread"!==e.type}function W(e,t,i){if(null===e)return null;const r=!t||i?e.currency_id:e.currency_code;return void 0===r||""===r?null:r}function U(e,t){return(t?e.original_currency_code:e.original_currency_id)||W(e,t)}function H(e){return e.base_currency_id||null}function z(e){return!(null===e||!F(e))&&(void 0!==e.original_currency_id&&e.original_currency_id!==e.currency_id)}function j(e){return h&&null!==e&&"spread"!==e.type}function Y(e){if(null===e||!h)return null;const t=e.unit_id;return void 0===t||""===t?null:t}function G(e){return h?e.original_unit_id||Y(e):null}function q(e){return!(null===e||!j(e))&&(void 0!==e.original_unit_id&&e.original_unit_id!==e.unit_id)}function X(e){return null!==e&&j(e)?e.unit_conversion_types||null:[]}function $(e){return"futures"===e.type&&e.front_contract||null}function K(e,t){let i=e&&(e.pro_name||e.full_name||e.name);return m&&t?i=t:f&&e&&e.ticker&&(i=e.ticker),_&&i&&(i=i.toUpperCase()),i}function J(e,t,i="exchange"){return t?e.name:`${e.name}, ${e[i]}`}function Z(e){let t=e&&($(e)||e.name)||"";return t.length>40&&(t=t.substr(0,37)+"..."),t.trim()}function Q(e){const t=e?e.exchange:"";return _?t.toUpperCase():t}function ee(e,t){return null!==e?e.full_name:t}function te(e,t){return null!==e?e.pro_name:t}function ie(e,t){return p&&e?(0,c.ensureDefined)(e.ticker):ee(e,t)}function re(e){return"regular"===e||"us_regular"===e}function se(e){return"c"===(null==e?void 0:e.visible_plots_set)}function ne(e){return void 0!==e.visible_plots_set?"ohlcv"===e.visible_plots_set:!e.has_no_volume}},47658:(e,t,i)=>{"use strict";var r=i(96276),s=i(27937),n=i(59757).PriceRange
;TradingView.DEFAULT_BAR_COUNT=300,TradingView.TIME_PLOT=0,TradingView.OPEN_PLOT=1,TradingView.HIGH_PLOT=2,TradingView.LOW_PLOT=3,TradingView.CLOSE_PLOT=4,TradingView.ADT_PLOT=6,TradingView.STYLE_PLOT=7;var o=i(16282).assert,a=i(16282).ensureNotNull,l=i(11126).SeriesBase,c=i(87782),u=c.SeriesAreaPaneView,d=c.SeriesLinePaneView,h=c.SeriesHollowCandlesPaneView,p=c.SeriesCandlesPaneView,_=c.SeriesBarsPaneView,m=c.SeriesHeikenAshiPaneView,f=c.SeriesBaselinePaneView,g=i(32845).SeriesHiLoPaneView,v=i(82862).SeriesWaterlinePaneView,S=i(22842),y=i(23576),b=y.SeriesRenkoPaneView,w=y.SeriesProjectionRenkoPaneView,P=y.SeriesPriceBreakPaneView,C=y.SeriesProjectionPriceBreakPaneView,T=y.SeriesKagiPaneView,x=y.SeriesProjectionKagiPaneView,I=y.SeriesPnFPaneView,L=y.SeriesProjectionPnFPaneView,M=y.SeriesProjectionRangePaneView,E=i(10164).telemetry,A=!1,{hash:k}=i(24985),D=i(81704).getDataVendorString,R=i(55055).FormattersSerializer,N=i(18872).FutureBarsPaneView,O=i(95658).getSeriesDangerReason,V=i(98006).isFeatureEnabled,B=i(88444).translateSessionExtendedDescription,F=i(87504).BarsRange,W=i(66786).SeriesBarColorer,U=i(46561).SeriesData,H=i(40989),z=H.PlotRowSearchMode,j=H.mergeMinMax,Y=i(2779).SyncModel,G=i(29098).trackEvent,q=i(87380).getLogger("Chart.Series"),X=i(97786),$=i(20554),K=i(19453),J=K.getServerInterval,Z=K.getResolutionByChartStyle,Q=i(2459).Interval,ee=i(78066).SeriesHorizontalBaseLinePaneView,te=i(55818).SeriesPriceLinePaneView,ie=i(21318).deepExtend,re=i(43607).encodeExtendedSymbolOrGetSimpleSymbolString,se=i(88001),ne=i(21218).permissionDenied,oe=!S.enabled("hide_series_legend_item"),ae=i(25143).TIMEFRAMETYPE,le=i(94420).InvalidationMask,ce=V("unit_conversion");class ue extends l{constructor(e,t,s,n){var o=i(44583);t.removeProperty("currencyId"),super(e,t,s,n),this._symbolIntervalChanged=new r,this._intervalChanged=new r,this.requestingIntradayWhenNotSupported=new r,this.requestingResolutionWhenNotSupported=new r,this._onInReplayStateChanged=new r,this._replayExitedDueUnsupportedInterval=new r,this._replayExitedDueUnavailableForUserInterval=new r,this._onTimeFrameApplied=new r,this.m_model=e,this._chartApi=e._chartApi,this.m_data=null,this.createPaneView(),this._syncModel=null,this._replaySubscriber=null,this._isReplayResolutionAvailableForUser=null,this._haStyle={studyId:$.chartStyleStudyId(ue.STYLE_HEIKEN_ASHI,!0)},this._renkoStyle={studyId:$.chartStyleStudyId(ue.STYLE_RENKO,!0)},this._pbStyle={studyId:$.chartStyleStudyId(ue.STYLE_PB,!0)},this._kagiStyle={studyId:$.chartStyleStudyId(ue.STYLE_KAGI,!0)},this._pnfStyle={studyId:$.chartStyleStudyId(ue.STYLE_PNF,!0)},this._rangeStyle={studyId:$.chartStyleStudyId(ue.STYLE_RANGE,!0)},this._properties.addExclusion&&(this._properties.addExclusion("visible"),this._properties.addExclusion("currencyId")),this._futureBarsPaneView=null,this._properties.showInDataWindow.listeners().subscribe(e,o.prototype.fullUpdate),this.properties().minTick.listeners().subscribe(this,ue.prototype._recreateFormatter);var a=this;this.properties().minTick.listeners().subscribe(null,(function(){
a.m_model.fullUpdate()})),this._priceLineView=null,this._baseHorizontalLineView=new ee(this),this._gotoDateResultCleared=!1,this._gotoDateView=null,this.bindStyleChange(),this.bindJapChartsInputs(),this._createIsDWMProperty(),this.createDividendsAdjustmentProperty(),this.dividendsAdjustment.listeners().subscribe(this,(function(){this.restart()})),this._dataPoweredBy=null,this._symbolIntervalChanged.subscribe(this,this._checkInterval),this.properties().showCountdown.listeners().subscribe(this,ue.prototype._onChangeShowCountdown),this._onChangeShowCountdown(this.properties().showCountdown),this._recreatePriceFormattingDependencies(),this.properties().lineStyle.priceSource.listeners().subscribe(this,this._updateBarFunction),this.properties().areaStyle.priceSource.listeners().subscribe(this,this._updateBarFunction),this.properties().baselineStyle.priceSource.listeners().subscribe(this,this._updateBarFunction),this._updateBarFunction()}isLoading(){return this._loading}isSymbolInvalid(){return this._status===ue.STATUS_INVALID_SYMBOL}styleStudyInfos(){return{haStyle:this._haStyle,renkoStyle:this._renkoStyle,pbStyle:this._pbStyle,kagiStyle:this._kagiStyle,pnfStyle:this._pnfStyle,rangeStyle:this._rangeStyle}}styleStudyInfo(e){return this.styleStudyInfos()[e]}priceLineColor(e){return this.properties().priceLineColor.value()||e}serverTimeOffset(){return this._chartApi.serverTimeOffset()}_onChangeShowCountdown(e){var t=this;e.value()?this._countdownUpdateTimer=this.m_model.setInterval((function(){t._priceAxisView.updateCountdown()}),500):(this.m_model.clearInterval(this._countdownUpdateTimer),delete this._countdownUpdateTimer)}_createIsDWMProperty(){this._isDWMProperty=new s(this.isDWM()),this._onRestarted.subscribe(this,(function(){this._isDWMProperty.setValue(this.isDWM())}))}isDWMProperty(){return this._isDWMProperty}model(){return this.m_model}fixLastBar(e){this._futureBarsPaneView||(this._futureBarsPaneView=new N(this.model().timeScale(),this,this.bars().lastIndex(),e))}clearData(){o(null===this.m_data,"Cannot clear loaded data"),this._seriesSource.clearData()}data(){return this.m_data||this._seriesSource.data()}isPulse(){return this._symbolInfo&&this._symbolInfo.resolutions.length>0}onSymbolIntervalChanged(){return this._symbolIntervalChanged}onIntervalChanged(){return this._intervalChanged}status(){return this._status}createPaneView(){this._paneView=null,this._projectionBarsPaneView=null,this._waterlineView=null,this._priceLineView=this.hasClosePrice()?new te(this):null;var e=this._properties.style.value();switch(e){case ue.STYLE_BARS:this._paneView=new _(this,this.m_model);break;case ue.STYLE_CANDLES:this._paneView=new p(this,this.m_model);break;case ue.STYLE_LINE:this._paneView=new d(this,this.m_model);break;case ue.STYLE_AREA:this._paneView=new u(this,this.m_model);break;case ue.STYLE_HEIKEN_ASHI:this._paneView=new m(this,this.m_model);break;case ue.STYLE_HOLLOW_CANDLES:this._paneView=new h(this,this.m_model);break;case ue.STYLE_BASELINE:this._paneView=new f(this,this.m_model),this._waterlineView=new v(this);break
;case ue.STYLE_HILO:this._paneView=new g(this,this.m_model)}switch(e){case ue.STYLE_RENKO:this._paneView=new b(this,this.m_model),this._projectionBarsPaneView=new w(this,this.m_model);break;case ue.STYLE_PB:this._paneView=new P(this,this.m_model),this._projectionBarsPaneView=new C(this,this.m_model);break;case ue.STYLE_KAGI:this._paneView=new T(this,this.m_model),this._projectionBarsPaneView=new x(this,this.m_model);break;case ue.STYLE_PNF:this._paneView=new I(this,this.m_model),this._projectionBarsPaneView=new L(this,this.m_model)}if(e===ue.STYLE_RANGE&&(this._paneView=new _(this,this.m_model),this._projectionBarsPaneView=new M(this,this.m_model)),null===this._paneView)throw Error("Unknown chart style assigned: "+e)}_clearStylePlot(e,t){if(0!==e.size()){var i=t||a(e.firstIndex()),r=a(e.lastIndex())+1;e.range(i,r).each((function(e,t){t[TradingView.STYLE_PLOT]=null}))}}invalidateBarStylesCache(e){q.logDebug("Invalidate style cache starting from "+e),this._clearStylePlot(this.bars(),e),this._clearStylePlot(this.nsBars())}invalidateBarColorerCache(){delete this._barColorerCache,this.invalidateBarStylesCache()}barColorer(){if(this._barColorerCache)return this._barColorerCache;for(var e=null,t=this.m_model.dataSources(),i=t.length-1;i>=0;i--){var r=t[i];if(r.metaInfo&&TradingView.isInherited(r.constructor,TradingView.Study)&&r.hasBarColorer()&&!r.isSourceHidden()){var s=r.barColorer();null===e?e=s:e.pushBackBarColorer(s)}}return null===e?e=new W(this):e.pushBackBarColorer(new W(this)),this._barColorerCache=e,this._barColorerCache}_barsState(e){var t=e.state();return t.data.forEach((function(e){e.value.splice(7,1)})),t}state(e){var t=this===this.m_model.mainSeries()?"MainSeries":TradingView.className(this.constructor);const i=this.obsoleteZOrder();var r={type:t,id:this.id(),state:this.properties().state(),zorder:i,haStyle:this._haStyle,renkoStyle:this._renkoStyle,pbStyle:this._pbStyle,kagiStyle:this._kagiStyle,pnfStyle:this._pnfStyle,rangeStyle:this._rangeStyle};return this._symbolInfo&&this._symbolInfo.ticker&&(r.state.symbol=this._symbolInfo.ticker),e&&(r.bars=this._barsState(this.bars()),r.nsBars=this._barsState(this.nsBars()),r.symbolInfo=this._symbolInfo,r.rtPrice=this.data().lastProjectionPrice),r.boxSize=this.data().boxSize,r.reversalAmount=this.data().reversalAmount,ce||delete r.state.unitId,r}restoreState(e,t){t&&this._setStatus(ue.STATUS_SNAPSHOT),!ce&&e.state&&delete e.state.unitId,this._properties.mergeAndFire(e.state),this._properties.hasChild("esdBreaksStyle")&&this._properties.removeProperty("esdBreaksStyle"),this._prevChartStyle=this.properties().style.value(),this.createPaneView(),t&&this.restoreData(e.bars,e.nsBars,e.symbolInfo,e.rtPrice,e.boxSize,e.reversalAmount)}hasStateForAlert(){return S.enabled("alerts")}stateForAlert(){var e,t=this===this.m_model.mainSeries()?"MainSeries":TradingView.className(this.constructor),i=this.idForAlert(),r=this.formatter();r=r?R.serialize(r):null;var s=this.sessionIdProxyProperty().value()
;if(this._symbolInfo&&this._symbolInfo.subsessions&&this._symbolInfo.subsessions.length>1){var n=this._symbolInfo.subsessions.find((function(e){return e.id===s}));n&&(e=B(n.description,this._symbolInfo.type))}var o={id:i,uniqueId:i,type:t,proSymbol:this.proSymbol(),actualSymbol:this.actualSymbol(),symbolString:this.getSymbolString(),interval:this.interval(),style:this.properties().style.value(),styleInputs:this.getInputsProperties().state(),sessionId:s,sessionDescription:e,dividendsAdjustment:this.properties().dividendsAdjustment.value(),backAdjustment:this.properties().backAdjustment.value()&&!this.isBackAdjustmentForbiddenProperty().value(),settlementAsClose:this.properties().settlementAsClose.value()&&!this.isSettlementAsCloseForbiddenProperty().value(),boxSize:this.data().boxSize,reversalAmount:this.data().reversalAmount,isSpread:this.isSpread(),formatter:r},a=O(this);return a&&(o.dangerReason=a),o}idForAlert(){return k(this.getSymbolString()+Q.normalize(this.interval())).toString()}restoreData(e,t,i,r,s,n){this._status=ue.STATUS_SNAPSHOT,this.m_data=new U,this.m_data.m_bars.restoreState(e),this.m_data.m_nsBars.restoreState(t),this.updateSymbolInfo(i,!1),this.m_data.lastProjectionPrice=r,this.m_data.boxSize=s,s||(this.properties().style.value()===ue.STYLE_PNF?this.m_data.boxSize=this.properties().pnfStyle.inputs.boxSize.value():this.properties().style.value()===ue.STYLE_RENKO&&(this.m_data.boxSize=this.properties().renkoStyle.inputs.boxSize.value())),this.m_data.reversalAmount=n,n||this.properties().style.value()===ue.STYLE_KAGI&&(this.m_data.reversalAmount=this.properties().kagiStyle.inputs.reversalAmount.value()),this._loading=!1}seriesSource(){return this._seriesSource}_onSymbolResolved(e){this._seriesErrorMessage=null,this.updateSymbolInfo(e,!1),this.m_model.updateSource(this),this.m_model.realignLineTools(),TradingView.onWidget()||(G("Symbol",e.listed_exchange,e.name),G("Symbol Type",e.type,e.listed_exchange));var t=this.symbolInfo().minmov/this.symbolInfo().pricescale,i=this.properties();i.style.value()===ue.STYLE_RENKO&&i.renkoStyle.inputs.boxSize.value()<t?i.renkoStyle.inputs.merge({boxSize:t}):i.style.value()===ue.STYLE_PNF&&i.pnfStyle.inputs.boxSize.value()<t?i.pnfStyle.inputs.merge({boxSize:t}):i.style.value()===ue.STYLE_KAGI&&i.kagiStyle.inputs.reversalAmount.value()<t&&i.kagiStyle.inputs.merge({reversalAmount:t}),this._checkInterval(),this._checkChartStyle()}_onSymbolError(e){this._setStatus(ue.STATUS_INVALID_SYMBOL),this._loading=!1,this._properties.shortName.setValue(this._properties.symbol.value()),this.m_model.clearAllStudies(),this.updateAllViews(),this.m_model.updateSource(this),e!==ne&&this.m_model.resetTimeScale(),this.m_model.realignLineTools(),this._sendTelemetryCounter("symbol_error",this._getTelemetryAdditionalData(e,!1)),this._symbolResolvingActive.setValue(!1)}_onSeriesTimeFrame(e,t,i,r,s){var n=this.m_model.timeScale(),o=t
;if(void 0===s)null!==i&&i.type!==ae.PeriodBack||(o+=n.defaultRightOffsetProperty().value());else if(s.applyDefaultRightMargin)o+=n.defaultRightOffsetProperty().value();else if(s.percentRightMargin){var a=t-e+1,l=Math.max(0,Math.min(.99,s.percentRightMargin/100));o+=l*a/(1-l)}this.m_model.setTimeViewport(e,o)}_onSeriesError(e){this._loading=!1;var t=e.error;if(e.ctx){var i={};Object.entries(e.ctx).forEach((function(e,t){i[e]=t.toString()})),t=t.format(i)}S.enabled("charting_library_debug_mode")&&q.logNormal("Error reason: "+t),this._seriesErrorMessage=t;const r=S.enabled("no_bars_status")&&this._symbolInfo?ue.STATUS_NO_BARS:ue.STATUS_INVALID_SYMBOL;this._setStatus(r),this._seriesLoaded=!0,this._sendTelemetryCounter("series_error",this._getTelemetryAdditionalData(t)),this._enablePriceRangeReady()}_onSeriesCompleted(e,t){if(this._setSymbolIntervalDelay){if(this._willSymbolIntervalCurrencyChanged())return void q.logNormal("command comes during symbol/interval changing");q.logNormal("series_completed comes when symbol interval delay present but symbol/interval should not be changed")}this._sendTelemetryCounter("series_loaded",this._getTelemetryAdditionalData()),this._loading=!1,this._seriesErrorMessage=null;var r=e;switch("pulsed"===r&&(r="delayed"),r){case"streaming":this._setStatus(ue.STATUS_READY);break;case"endofday":this._setStatus(ue.STATUS_EOD);break;case"delayed":this._setStatus(ue.STATUS_DELAYED);break;case"pulsed":this._setStatus(ue.STATUS_PULSE);break;case"replay":this._setStatus(ue.STATUS_REPLAY)}r.match(/delayed_streaming/)&&this._setStatus(ue.STATUS_DELAYED_STREAMING);var s=this.m_model.paneForSource(this);s.recalculatePriceScale(this.priceScale());var n=le.full();(null!==this.m_model.appliedTimeFrame().value()&&n.lockVisibleTimeRangeOnResize(),this.m_model.invalidate(n),this.model().recalcVisibleRangeStudies(!0),this.model().recalcStudyBasedLineTools(),!this.m_priceScale.isLockScale()||this.model().timeScale().isEmpty()||this._seriesLoaded||(this.model().timeScale()._correctOffset(),this.model().timeScale().correctBarSpacing(),this.model().resetPriceScale(s,this.priceScale())),this._seriesLoaded=!0,A)||(A=!0,(0,i(25443).trackTiming)("Chart","Time to series",window.performance.now()));this.requestMoreData(),this._enablePriceRangeReady()}_onBarReceived(e){this.model().recalcVisibleRangeStudies(!0)}isStarted(){return this._seriesSource.isStarted()}restart(){if(this._status!==ue.STATUS_SNAPSHOT){this._loading=!0,this._onRestarted.fire(),this._setStatus(ue.STATUS_RESOLVING),this.updateSymbolInfo(null,!0);var e=this._properties.interval.value();this._checkIntervalWillChanged(e)&&this._notifyIntervalChanged(e);var t=null;this._pendingTimeRange&&(t=this._pendingTimeRange,delete this._pendingTimeRange),this._removeReplaySubscriber(),this._onBeforeModifySeries(this.getSymbolString(),e),this._onTimeFrameApplied.fire(t),e=J(e),this.m_data=null,this._seriesSource.modifySeries(this._getResolvingSymbolObject(),e,t),this._seriesSource.isStarted()||this._seriesSource.start(),this.m_symbol=this._properties.symbol.value(),
this._currency=this._properties.currencyId.value(),this._unit=this._properties.unitId.value(),this.m_interval=this._properties.interval.value()}}hasDelayedSymbolIntervalChange(){return!!this._setSymbolIntervalDelay}setSymbolIntervalCurrencyDelayed(){this._willSymbolIntervalCurrencyChanged()&&(this._setSymbolIntervalDelay&&(q.logNormal("Clear timeout to change symbol/interval #"+this._setSymbolIntervalDelay),clearTimeout(this._setSymbolIntervalDelay)),this._setSymbolIntervalDelay=setTimeout(function(){const e=this._properties;q.logNormal("Timeout #"+this._setSymbolIntervalDelay+' fired, new symbol will be "'+e.symbol.value()+'"'),delete this._setSymbolIntervalDelay,this._setSymbolInterval(e.symbol.value(),e.interval.value(),e.currencyId.value(),e.unitId.value())}.bind(this),30),q.logNormal("Started timeout #"+this._setSymbolIntervalDelay+' to change symbol/interval from "'+this.m_symbol+'" to "'+this._properties.symbol.value()+'"'))}rerequestData(){this._setSymbolInterval(this.m_symbol,this.m_interval,this._currency,this._unit,!0)}_notifyIntervalChanged(e){var t={timeframe:this._pendingTimeRange};this._intervalChanged.fire(e,t),this._pendingTimeRange=t.timeframe}_setSymbolInterval(e,t,i,r,s){this.clearGotoDateResult();var n=Q.isRange(t);n&&this._properties.rangeStyle.inputs.range.setValue(Q.parse(t).multiplier());var o=this._checkSymbolWillChanged(e),a=this._checkIntervalWillChanged(t),l=a&&Q.parse(this.m_interval).isDWM()!==Q.parse(t).isDWM(),c=this._checkCurrencyWillChanged(i),u=this._checkUnitWillChanged(r);if(!(o||a||c||u||s))return this.m_model.realignLineTools(),void this.m_model.updateLineTools();if((null!==i&&c||null!==r&&u)&&this.isInReplay()){const e=this.symbolInfo();null!==e&&e.original_currency_id===i||this._removeReplaySubscriber()}if(this._syncModel=null,this.m_symbol=e,this.m_interval=t,this._currency=i,this._unit=r,this._status!==ue.STATUS_SNAPSHOT&&(!this._seriesSource.isStarted()||o||c||u||l)&&this.updateSymbolInfo(null,!o&&(c||u)),this.isInReplay()){var d=function(){this._removeReplaySubscriber()}.bind(this);o?d():a&&(n?d():this._isReplayResolutionAvailableForUser(t)?this.isIntervalSupported(t)||(d(),this._replayExitedDueUnsupportedInterval.fire()):(d(),this._replayExitedDueUnavailableForUserInterval.fire()))}if(this.m_model.realignLineTools(),this._status!==ue.STATUS_SNAPSHOT){this._loading=!0,this._setStatus(ue.STATUS_RESOLVING),this._updateIsPrePostMarketPricesForbiddenProperty(),this._updateBackAdjustmentForbiddenProperty(),this._updateSettlementAsCloseForbiddenProperty(),this._symbolIntervalChanged.fire(),a&&this._notifyIntervalChanged(this.m_interval),this._onRestarted.fire(),this._seriesLoaded=!1,this._lineStyleLastPriceCirclePaneView.stopAnimation();var h=null;this._pendingTimeRange&&(h=this._pendingTimeRange,delete this._pendingTimeRange),this._onTimeFrameApplied.fire(h),this._onBeforeModifySeries(this.getSymbolString(),t),this.m_data=null,this._seriesSource.modifySeries(this._getResolvingSymbolObject(),J(t),h,s),this._seriesSource.isStarted()||(this._predictBars=0,
this._seriesSource.start()),(o||c||u)&&this.disablePriceRangeReady()}}setDefaultTimeframe(e){this._pendingTimeRange=e}symbol(){return this.properties().symbol.value()}bars(){return this.data().m_bars}nsBars(){return this.data().m_nsBars}hl2(e){return(this.high(e)+this.low(e))/2}hlc3(e){return(this.high(e)+this.low(e)+this.close(e))/3}ohlc4(e){return(this.open(e)+this.high(e)+this.low(e)+this.close(e))/4}priceRange(e,t){if(!TradingView.isInteger(e))return q.logDebug("Series.priceRange: incorrect startBar"),null;if(!TradingView.isInteger(t))return q.logDebug("Series.priceRange: incorrect endBar"),null;if(this.data().isEmpty())return null;if(this.m_priceScale.isLockScale()){var i=this._model.mainSeriesScaleRatio();if(null!==i){var r=this.priceScale().internalHeight()/(this.model().timeScale().barSpacing()/i),s=this.data().search(t,z.NearestLeft),o=(s.value[TradingView.HIGH_PLOT]+s.value[TradingView.LOW_PLOT])/2;return new n(o-.5*r,o+.5*r)}}var a=this.priceSource();if(null!==a)var l=this.data().bars().minMaxOnRangeCached(e,t,[{name:a,offset:0}]),c=this.data().nsBars().minMaxOnRangeCached(e,t,[{name:a,offset:0}]);else l=this.data().bars().minMaxOnRangeCached(e,t,[{name:"low",offset:0},{name:"high",offset:0}]),c=this.data().nsBars().minMaxOnRange(e,t,[{name:"low",offset:0},{name:"high",offset:0}]);var u=null!==(l=j(l,c))?l.min===l.max?new n(l.min-.5,l.max+.5):new n(l.min,l.max):new n(-.5,.5);return this.priceScale().isLog()?new n(this.priceScale().priceToLogical(u.minValue()),this.priceScale().priceToLogical(u.maxValue())):u}nearestData(e,t){if(TradingView.isInteger(e)){var i=this.data().search(e,t);return null!==i?i:void 0}q.logDebug("Series.nearestData: incorrect logicalPoint")}nearestIndex(e,t){var i=this.nearestData(e,t);return i?i.index:void 0}paneViews(){if(!this.properties().visible.value())return null;var e=[this._baseHorizontalLineView,this._paneView];return this._futureBarsPaneView&&e.push(this._futureBarsPaneView),this._projectionBarsPaneView&&e.push(this._projectionBarsPaneView),null!==this._waterlineView&&e.push(this._waterlineView),e.push(this._prevClosePriceLineView),null!==this._priceLineView&&e.push(this._priceLineView),null!==this._gotoDateView&&e.push(this._gotoDateView),e.push(...this._highLowAvgPaneViews),e}dataWindowView(){return this._dataWindowView}legendView(){return this._legendView}statusView(){return oe?this._statusView:null}marketStatusModel(){return this._marketStatusModel}dataUpdatedModeModel(){return this._dataUpdatedModeModel}dataProblemModel(){return this._dataProblemModel}purgeSymbolInfo(){this._symbolInfo=null}updateSymbolInfo(e,t){if(this._prevSymbolInfo=t?this._symbolInfo:null,this._symbolInfo=e,e){this._properties.shortName.setValue(e.name);var i=$.extractSymbolNameFromSymbolInfo(e,this.m_symbol);i&&this._properties.symbol.setValue(i),this._currency=$.symbolCurrency(e),this._properties.currencyId.setValue(this._currency),this._unit=$.symbolUnit(e),this._properties.unitId.setValue(this._unit),this._updateSessionIdProxyProperty(!0)}this._base=e?e.pricescale/e.minmov:100,
this._pointValue=e&&e.pointvalue||1;var r=re(this._getExtendedSymbolObject());this._quotesProvider.setQuotesSessionSymbol(r),this._marketStatusModel.setSymbolInfo(e),e&&this._recreatePriceFormattingDependencies(),this._statusView.update(),this.priceScale().updateFormatter(),this._dataPoweredBy=D(e),this._updateIsPrePostMarketPricesForbiddenProperty(),this._updateBackAdjustmentForbiddenProperty(),this._updateSettlementAsCloseForbiddenProperty(),this._symbolResolvingActive.setValue(!e)}updateAllViews(){this._paneView.update(),this._dataWindowView.update(),this._legendView.update(),this._statusView.update(),this._highLowAvgPaneViews.forEach(e=>e.update()),this._labelPaneViews.forEach(e=>e.update()),this._priceAxisViews.forEach(e=>e.update()),this._priceLineAxisViews.forEach(e=>e.update()),this._futureBarsPaneView&&this._futureBarsPaneView.update(),this._projectionBarsPaneView&&this._projectionBarsPaneView.update(),null!==this._waterlineView&&this._waterlineView.update(),this._prevClosePriceLineView.update(),null!==this._priceLineView&&this._priceLineView.update(),null!==this._gotoDateView&&this._gotoDateView.update(),this._baseHorizontalLineView.update();var e=this._model.activeStrategySource().value();null!==e&&e.updateAllViews(),this._lineStyleLastPriceCirclePaneView.update()}requestMoreData(e){if((this._status===ue.STATUS_READY||this._status===ue.STATUS_PULSE||this._status===ue.STATUS_DELAYED||this._status===ue.STATUS_DELAYED_STREAMING||this._status===ue.STATUS_EOD||this._status===ue.STATUS_REPLAY)&&!this.m_model.timeScale().isEmpty()){var t=this.m_model.timeScale().visibleBarsStrictRange();if(null!==t&&0!==this.bars().size()){var i=t.lastBar()-a(this.data().last()).index;if(this._predictBars<i&&(this._predictBars=i,this._seriesSource.requestMoreTickmarks(i)),!this._endOfData){var r=a(this.bars().firstIndex()),s=e||r-t.firstBar();s<=0||(Number.isFinite(s)?(this._endOfData=!0,this._loading=!0,this._seriesSource.requestMoreData(s),this._setStatus(ue.STATUS_LOADING)):q.logWarn("requestMoreData: invalid bar count: "+s+", visible bars: ["+t.firstBar()+", "+t.lastBar()+"], last index: "+a(this.data().last()).index+", predicted bars: "+this._predictBars+", required bars:"+e))}}}}bindStyleChange(){var e=this;Object.keys(ue.STYLE_SHORT_NAMES).map((function(e){return ue.STYLE_SHORT_NAMES[e]+"Style"})).forEach((function(t){e._properties[t].listeners().subscribe(e,ue.prototype.invalidateBarStylesCache)}))}bindJapChartsInputs(){this._properties.style.listeners().subscribe(this,this.onChartStyleChanged),this._properties.renkoStyle.inputs.boxSize.listeners().subscribe(this,this.onInputChanged),this._properties.renkoStyle.inputs.style.listeners().subscribe(this,this.onInputChanged),this._properties.renkoStyle.inputs.atrLength.listeners().subscribe(this,this.onInputChanged),this._properties.renkoStyle.inputs.wicks.listeners().subscribe(this,this.onInputChanged),this._properties.renkoStyle.inputs.sources.listeners().subscribe(this,this.onInputChanged),this._properties.pbStyle.inputs.lb.listeners().subscribe(this,this.onInputChanged),
this._properties.kagiStyle.inputs.reversalAmount.listeners().subscribe(this,this.onInputChanged),this._properties.kagiStyle.inputs.style.listeners().subscribe(this,this.onInputChanged),this._properties.kagiStyle.inputs.atrLength.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.boxSize.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.reversalAmount.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.sources.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.style.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.atrLength.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.oneStepBackBuilding.listeners().subscribe(this,this.onInputChanged),this._properties.rangeStyle.inputs.phantomBars.listeners().subscribe(this,this.onInputChanged)}createDividendsAdjustmentProperty(){var e=this;e.dividendsAdjustment=new s;var t=function(){var t=e._properties.dividendsAdjustment.value();e.dividendsAdjustment.setValue(t),G("Dividends adjust",!0===t?"On":"Off")};e._properties.dividendsAdjustment.listeners().subscribe(null,t),t()}dividendsAdjustmentProperty(){return this._properties.dividendsAdjustment}setChartStyleWithIntervalIfNeeded(e,t){var i=t;void 0===t&&(i=Z(e,this._properties.interval.value(),this._model.defaultResolutions())),Q.isEqual(i,this._properties.interval.value())||this._properties.interval.setValue(i),this._properties.style.setValue(e)}isNeedRestart(e){return this._status!==ue.STATUS_SNAPSHOT&&(void 0===e&&(e=this.properties().style.value()),!$.isRangeStyle(this._prevChartStyle)&&!$.isRangeStyle(e)&&!(this._prevChartStyle===e||!$.isRequiringRestartSeriesStyles(this._prevChartStyle)&&!$.isRequiringRestartSeriesStyles(e)))}applyPreferences(e){var t=ie({},e);this.m_priceScale.setMode({autoScale:t.priceAxisProperties.autoScale,percentage:t.priceAxisProperties.percentage,log:t.priceAxisProperties.log,lockScale:t.priceAxisProperties.lockScale}),this.setChartStyleWithIntervalIfNeeded(t.style),delete t.style,delete t.interval,this._properties.mergePreferences(t),this._properties.saveDefaults(),this.createPaneView(),this.invalidateBarStylesCache()}priceSource(){var e=null;switch(this._properties.style.value()){case ue.STYLE_LINE:e=this._properties.lineStyle.priceSource.value();break;case ue.STYLE_AREA:e=this._properties.areaStyle.priceSource.value();break;case ue.STYLE_BASELINE:e=this._properties.baselineStyle.priceSource.value()}return e}isRangeBasedStyle(){return $.isRangeBasedStyle(this.style())}onInputChanged(){this.restart()}getSymbolString(){return re(this._getSymbolObject())}_getResolvingSymbolObject(){var e=this._getSymbolObject();return this._replaySubscriber&&(e=this._replaySubscriber.generateReplaySymbol(e)),e}getStyleShortName(){var e=this._properties.style.value();if(ue.STYLE_SHORT_NAMES.hasOwnProperty(e))return ue.STYLE_SHORT_NAMES[e];throw new Error("Missed short name for style "+e)}getStyleProperties(){
return this._properties[this.getStyleShortName()+"Style"]}getInputsProperties(){return this.getStyleProperties().inputs||new s}getInputsInfoProperties(){return this.getStyleProperties().inputInfo||new s}getRealVisibleRange(){var e=this.model().timeScale().visibleBarsStrictRange();if(null===e)return null;var t=this.data().search(e.firstBar(),z.NearestRight),i=this.data().search(e.lastBar(),z.NearestLeft);return null===t||null===i?null:new F(t.index,i.index)}firstValue(){var e=this.firstBar();return null===e?null:this._barFunction(e)}firstBar(){var e=this.model().timeScale().visibleBarsStrictRange();if(null===e)return null;var t=e.firstBar(),i=this.data().search(t,z.NearestRight);return null!==i?i.value:null}isSpread(){return null!==this._symbolInfo&&"spread"===this._symbolInfo.type}getSymbolName(){return this._symbolInfo?this._symbolInfo.name:""}loadDataTo(e){var t=this._properties.interval.value();this._onTimeFrameApplied.fire(e),this._seriesSource.modifySeries(this._getResolvingSymbolObject(),J(t),e)}priceScale(){return this.m_priceScale}setPriceScale(e){this.m_priceScale!==e&&(this._priceScaleAboutToBeChanged.fire(),this.m_priceScale=e,this._properties.removeProperty("priceAxisProperties"),this._properties.addChild("priceAxisProperties",e.properties()),this._properties.priceAxisProperties.childChanged(),se.emit("series_event","price_scale_changed"),this._priceScaleChanged.fire(e))}setGotoDateResult(e){this._gotoDateResultCleared=!1,i.e(4079).then(i.t.bind(i,91834,19)).then(({GotoDateView:t})=>{this._gotoDateResultCleared||(this._gotoDateView=new t(this,e),this.m_model.updateSource(this))})}clearGotoDateResult(e){this._gotoDateView=null,this._gotoDateResultCleared=!0}syncModel(){if(!this._syncModel){var e=this.symbolInfo(),t=this.interval();if(!e||!t)return null;this._syncModel=new Y(e,t)}return this._syncModel}getSourceIcon(){return{type:"loadSvg",svgId:"series."+this.properties().style.value()}}isStyleSupported(e){return!this.isInReplay()||this.isStyleSupportedForReplay(e)}isIntervalSupported(e){return!this.isInReplay()||this._replaySubscriber.canChangeResolution(e)}isStyleSupportedForReplay(e){return $.isTimeBasedStyle(e)}isInReplay(){return null!==this._replaySubscriber}onTimeFrameApplied(){return this._onTimeFrameApplied}onInReplayStateChanged(){return this._onInReplayStateChanged}replayExitedDueUnsupportedInterval(){return this._replayExitedDueUnsupportedInterval}replayExitedDueUnavailableForUserInterval(){return this._replayExitedDueUnavailableForUserInterval}switchToReplay(e,t){this._replaySubscriber=e,this._isReplayResolutionAvailableForUser=t,this._onInReplayStateChanged.fire(),this._replaySubscriber.modifySeries(this.getSymbolString(),this._properties.interval.value()),this.rerequestData()}switchToRealtime(){this.isInReplay()&&(this._removeReplaySubscriber(),this.rerequestData())}_removeReplaySubscriber(){if(this.isInReplay()){var e=this._replaySubscriber;this._replaySubscriber=null,this._isReplayResolutionAvailableForUser=null,this._onInReplayStateChanged.fire(),e.destroy()}}_onBeforeModifySeries(e,t){
this._replaySubscriber&&this._replaySubscriber.modifySeries(e,t)}_getTelemetryAdditionalData(e,t){t=void 0===t||t;var i={symbol:this.actualSymbol()};return t&&(i.resolution=this.interval()),void 0!==e&&(i.reason=e),i}_sendTelemetryReport(e,t,i){void 0===i&&(i=this._getTelemetryAdditionalData());var r=Object.assign(t,{additional:i});E.sendChartReport(e,r)}_sendTelemetryCounter(e,t){this._sendTelemetryReport(e,{count:1},t)}destroy(){this._replayExitedDueUnsupportedInterval.destroy(),this._replayExitedDueUnavailableForUserInterval.destroy(),this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._quotesProvider.destroy(),this.clearGotoDateResult(),this._legendView.destroy(),this._marketStatusModel.destroy(),null!==this._dataUpdatedModeModel&&this._dataUpdatedModeModel.destroy(),this._dataProblemModel.destroy(),this._paneView&&this._paneView.destroy&&this._paneView.destroy(),this._onTimeFrameApplied.destroy(),this._seriesSource.destroy(),super.destroy()}dataEvents(){return this._seriesSource.dataEvents()}moveData(e){return this._seriesSource.moveData(e)}}Object.assign(ue,X),TradingView.Series=ue,t.Series=ue,t.isSeries=function(e){return e instanceof ue}},26587:(e,t,i)=>{"use strict";function r(e,t){return 100*(t-e)/Math.abs(e)}i.d(t,{barPercentChange:()=>r})},30807:(e,t,i)=>{"use strict";i.d(t,{PaneRendererBars:()=>n});var r=i(34250),s=i(55213);class n extends s.PaneRendererSeriesBase{constructor(e){super(),this._bars=e.bars,this._barSpacing=e.barSpacing,this._dontDrawOpen=e.dontDrawOpen,this._thinBars=e.thinBars}draw(e,t){e.save();const i=t.pixelRatio;if(this._barWidth=this._calcBarWidth(i),this._barWidth>=2){Math.max(1,Math.floor(i))%2!=this._barWidth%2&&this._barWidth--}this._barLineWidth=this._thinBars?Math.min(this._barWidth,Math.floor(i)):this._barWidth;let r=null;const s=this._barLineWidth<=this._barWidth&&this._barSpacing>=Math.floor(1.5*t.pixelRatio);for(const t of this._bars){r!==t.color&&(e.fillStyle=t.color,r=t.color);const n=Math.floor(.5*this._barLineWidth),o=Math.round(t.time*i),a=o-n,l=this._barLineWidth,c=a+l-1,u=Math.min(t.high,t.low),d=Math.max(t.high,t.low),h=Math.round(u*i)-n,p=Math.round(d*i)+n,_=Math.max(p-h,this._barLineWidth);e.fillRect(a,h,l,_);const m=Math.ceil(1.5*this._barWidth);if(s){const r=o-m,s=o+m,u=Math.min(a-r,s-c);if(!this._dontDrawOpen){let s=Math.max(h,Math.round(t.open*i)-n),o=s+l-1;o>h+_-1&&(o=h+_-1,s=o-l+1),e.fillRect(r,s,u,o-s+1)}let d=Math.max(h,Math.round(t.close*i)-n),p=d+l-1;p>h+_-1&&(p=h+_-1,d=p-l+1),e.fillRect(c+1,d,u,p-d+1)}}e.restore()}_getTolerance(){const e=this._calcBarWidth(1),t=this._thinBars?Math.min(e,1):e;return(0,r.interactionTolerance)().series+t/2}_getBarSpacing(){return this._barSpacing}_calcBarWidth(e){const t=Math.floor(e);return Math.max(t,Math.floor((0,r.optimalBarWidth)(this._barSpacing,e)))}}},82862:(e,t,i)=>{"use strict";i.d(t,{SeriesWaterlinePaneView:()=>a});var r=i(41261),s=i(88558),n=i(62288),o=i(3707);class a extends r.SeriesHorizontalLinePaneView{constructor(e){super(e);const t={cursorType:s.PaneCursorType.VerticalResize,activeItem:0,
areaName:n.AreaName.SourceItemMove};this._lineRenderer.setHitTest(new n.HitTestResult(n.HitTestResult.MOVEPOINT,t)),this._lineRendererData.visible=!0,this._lineRendererData.linestyle=o.LINESTYLE_SPARSE_DOTTED}_updateImpl(){const e=this._series.properties().childs().baselineStyle.childs(),t=Math.abs(100-e.baseLevelPercentage.value());this._lineRendererData.y=Math.round(this._series.priceScale().height()*(t/100)),this._lineRendererData.color=e.baselineColor.value()}}},55213:(e,t,i)=>{"use strict";i.d(t,{PaneRendererSeriesBase:()=>s});var r=i(62288);class s{constructor(){this._bars=[]}hitTest(e){const t=this._bars,i=this._getBarSpacing(),r=i/2;if(0===t.length)return null;const s=this._getTolerance(),n=t[0],o=t[t.length-1];if(e.x<n.time-r-s)return null;if(e.x>o.time+r+s)return null;let a=0,l=t.length-1,c=-1;for(;a<=l;){const i=Math.floor((a+l)/2),u=t[i];let d=r;if(u!==n&&u!==o||(d+=s),Math.abs(u.time-e.x)<=d){c=i;break}e.x-u.time>r?a=i+1:l=i-1}if(-1!==c){const n=Math.ceil(s/i);if(0!==n){const i=Math.max(0,c-n),o=Math.min(t.length-1,c+n);for(let n=i;n<=o;n++)if(Math.abs(e.x-t[n].time)<=r+s&&this._isPointAtBar(t[n],e.y,s))return this._getHitTest()}else if(this._isPointAtBar(t[c],e.y,s))return this._getHitTest()}return null}_getHitTest(){return new r.HitTestResult(r.HitTestResult.REGULAR)}_isPointAtBar(e,t,i){const r=Math.min(e.high,e.low),s=Math.max(e.high,e.low);return r-i<=t&&t<=s+i}}},67003:(e,t,i)=>{"use strict";i.d(t,{PaneRendererCandles:()=>l});var r=i(16282),s=i(62288),n=i(64348),o=i(34250),a=i(55213);class l extends a.PaneRendererSeriesBase{constructor(e){super(),this._barSpacing=1,this._barWidth=1,this._borderVisible=!1,this._barBorderWidth=1,this._wickVisible=!1,this._bodyVisible=!0,this._borderColor=void 0,this._wickColor=void 0,this._hittest=void 0,this._isPriceScaleInverted=!1,e&&this.setData(e)}setData(e){this._bars=e.bars,this._barSpacing=e.barSpacing,this._borderVisible=e.borderVisible,this._bodyVisible=e.bodyVisible,this._wickVisible=e.wickVisible,this._borderColor=e.borderColor,this._wickColor=e.wickColor,this._hittest=e.hittest,this._isPriceScaleInverted=e.isPriceScaleInverted}hitTest(e){return this._wickVisible||this._borderVisible||this._bodyVisible?super.hitTest(e):null}draw(e,t){if(0===this._bars.length)return;const i=t.pixelRatio;if(this._barWidth=(0,o.optimalCandlestickWidth)(this._barSpacing,i),this._barWidth>=2){Math.floor(i)%2!=this._barWidth%2&&this._barWidth--}this._wickVisible&&this._drawWicks(e,i),this._borderVisible&&this._drawBorder(e,i),this._bodyVisible&&this._drawCandles(e,i)}_getTolerance(){return(0,o.interactionTolerance)().series+this._barBorderWidth/2}_getBarSpacing(){return this._barSpacing}_getHitTest(){return this._hittest||new s.HitTestResult(s.HitTestResult.REGULAR)}_isPointAtBar(e,t,i){const r=this._bodyVisible||this._borderVisible,s=this._wickVisible;if(!r&&!s)return!1;if(r){const r=s?Math.min(e.high,e.low):Math.min(e.open,e.close),n=s?Math.max(e.high,e.low):Math.max(e.open,e.close);return r-i<=t&&t<=n+i}{const r=Math.min(e.open,e.close),s=Math.max(e.open,e.close)
;return e.high-i<=t&&t<=r+i||s-i<=t&&t<=e.low+i}}_drawWicks(e,t){const i=this._bars;let s="",n=Math.min(Math.floor(t),Math.floor(this._barSpacing*t));n=Math.max(Math.floor(t),Math.min(n,this._barWidth));const o=Math.floor(.5*n);let a=null;for(const l of i){const i=l.wickColor?l.wickColor:(0,r.ensureDefined)(this._wickColor);i!==s&&(e.fillStyle=i,s=i);let c=Math.round(Math.min(l.open,l.close)*t),u=Math.round(Math.max(l.open,l.close)*t);this._isPriceScaleInverted&&([u,c]=[c,u]);const d=Math.round(l.high*t),h=Math.round(l.low*t);let p=Math.round(t*l.time)-o;const _=p+n-1;null!==a&&(p=Math.max(a+1,p),p=Math.min(p,_));const m=_-p+1;e.fillRect(p,d,m,c-d),e.fillRect(p,u+1,m,h-u-1),a=_}}_calculateBorderWidth(e){let t=Math.floor(1*e);this._barWidth<=2*t&&(t=Math.floor(.5*(this._barWidth-1)));const i=Math.max(Math.floor(e),t);return this._barWidth<=2*i?Math.max(Math.floor(e),Math.floor(1*e)):i}_drawBorder(e,t){let i="";const s=this._calculateBorderWidth(t);let o=null;for(const a of this._bars){if(a.borderColor!==i&&(e.fillStyle=a.borderColor?a.borderColor:(0,r.ensureDefined)(this._borderColor),i=a.borderColor),this._bodyVisible&&a.hollow)continue;let l=Math.round(a.time*t)-Math.floor(.5*this._barWidth);const c=l+this._barWidth-1,u=Math.round(Math.min(a.open,a.close)*t),d=Math.round(Math.max(a.open,a.close)*t);if(null!==o&&(l=Math.max(o+1,l),l=Math.min(l,c)),this._barSpacing*t>2*s)(0,n.fillRectInnerBorder)(e,l,u,c-l+1,d-u+1,s);else{const t=c-l+1;e.fillRect(l,u,t,d-u+1)}o=c}}_drawCandles(e,t){let i="";const r=this._calculateBorderWidth(t);for(const s of this._bars){if(this._borderVisible&&this._barWidth<=2*r&&!s.hollow)continue;let o=Math.round(Math.min(s.open,s.close)*t),a=Math.round(Math.max(s.open,s.close)*t),l=Math.round(s.time*t)-Math.floor(.5*this._barWidth),c=l+this._barWidth-1;if(s.color!==i){const t=s.color;e.fillStyle=t,i=t}if(s.hollow)e.fillStyle=s.color,(0,n.fillRectInnerBorder)(e,l,o,c-l+1,a-o+1,r);else{if(this._borderVisible&&(l+=r,o+=r,c-=r,a-=r),o>a)continue;e.fillRect(l,o,c-l+1,a-o+1)}}}}},86837:(e,t,i)=>{"use strict";i.d(t,{generateSplitTitleForGui:()=>o,generateTitleForGui:()=>a});var r=i(16282),s=i(57976);function n(e,t){return(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toString()||""}function o(e){const t="QUANDL"===(e=e||{}).exchange,i={title:"",description:"",interval:"",exchange:"",provider:"",chartStyle:"",sessionDescription:""};let o="";if(e.description&&t)if(2===e.description.split("/").length)o=e.description.split("/")[1];else{e.description.split("'").filter(e=>e.length).forEach(e=>{let t=[];t=e&&("/"===e[0]||/\d+\/\(?/.test(e))?[e]:e.split("/").filter(e=>e.length),o+=t[2===t.length?1:0]})}else o=e.description?e.description:e.symbol;if(e.ticker?(i.title=e.ticker,i.description=l(o)):i.title=l(o),e.interval&&(i.interval=(0,s.translatedIntervalString)(e.interval)),t&&e.description){const t=/[\w_]+\/[\w_]+/.exec(e.description);t&&t[0]?i.provider=l(t[0].split("/")[0]):i.provider=l(e.description.split("/")[0])}return e.exchange&&(i.exchange=l(e.exchange)),i.chartStyle=l(function(e){const t=e.inputs
;switch(e.style){case 4:const i=t.style+("ATR"===t.style?`(${t.atrLength})`:""),s=(0,r.ensureDefined)(e.boxSize||t.boxSize);return`${window.t("Renko")} [${i}, ${n(s,4)}]`;case 7:return`${window.t("Line Break")} [${t.lb}]`;case 5:const o=t.style+("ATR"===t.style?`(${t.atrLength})`:""),a=e.reversalAmount||t.reversalAmount,l=void 0!==a?", "+n(a,8):"";return`${window.t("Kagi")} [${o}${l}]`;case 6:const c=`${t.style}${"ATR"===t.style?"("+t.atrLength+")":""}`,u=e.boxSize||t.boxSize;return`${window.t("PnF")} [${c}, ${n((0,r.ensureDefined)(u),8)}, ${t.reversalAmount}]`}return 11===e.style?window.t("Range"):8===e.style?window.t("Heikin Ashi"):""}(e)),e.branding&&!o.toUpperCase().includes("TradingView".toUpperCase())&&(i.branding="TradingView"),e.sessionDescription&&(i.sessionDescription=l(e.sessionDescription)),i}function a(e){const t=o(e);return(e.ticker?t.description:t.title)+(t.interval?", "+t.interval:"")+function(e,t=", "){return(e.provider?`${t}${e.provider}`:"")+(e.exchange?`${t}${e.exchange}`:"")+(e.chartStyle?`${t}${e.chartStyle}`:"")+(e.branding?`${t}${e.branding}`:"")+(e.sessionDescription?`${t}${e.sessionDescription}`:"")}(t)}function l(e){return e.replace(/'/g,"")}},32845:(e,t,i)=>{"use strict";i.d(t,{SeriesHiLoPaneView:()=>g});var r=i(16282),s=i(32022),n=i(87782),o=i(4543),a=i(34250),l=i(62288),c=i(29295);class u extends c.ScaledPaneRenderer{constructor(){super(...arguments),this._data=null,this._barWidth=null}setData(e){this._data=e,this._barWidth=Math.max(1,Math.round((0,a.optimalHiLoWidth)(e.barSpacing)))}hitTest(e){if(null===this._data||null===this._barWidth)return null;const t=this._data.bars,i=.5*this._data.barSpacing;if(0===t.length)return null;if(e.x<t[0].time-i)return null;if(e.x>t[t.length-1].time+i)return null;const r=t[(0,o.lowerbound)(t,e.x-i,(e,t)=>e.time<t)];if(e.x<r.time-i||e.x>r.time+i)return null;const s=(0,a.interactionTolerance)().series+this._barWidth/2,n=Math.min(r.high,r.low),c=Math.max(r.high,r.low),u=this._data.fontSize;return n-s-u<=e.y&&e.y<=n+s||c-s<=e.y&&e.y<=c+s+u?new l.HitTestResult(l.HitTestResult.REGULAR):null}_drawImpl(e){if(null===this._data||null===this._barWidth)return;e.save(),e.translate(.5,.5),e.textAlign="center",e.fillStyle=this._data.labelColor,e.font=(0,s.makeFont)(this._data.fontSize,this._data.font);const t=this._data.bars,i=this._data.inverted;for(let r=0;r<t.length;++r){const s=t[r],n=Math.min(s.high,s.low),o=Math.max(s.high,s.low);e.fillText(i?s.lowLabel:s.highLabel,s.time,n-this._data.labelsPadding),e.fillText(i?s.highLabel:s.lowLabel,s.time,o+this._data.labelsPadding+this._data.fontSize)}e.restore()}}var d=i(67003),h=i(56288),p=i(26184),_=i(54567),m=i(39304);function f(e){return null!=e}class g extends n.SeriesBarCandlesPaneView{constructor(e,t){super(e,t),this._widthsCache=new _.TextWidthCache,this._labelsRenderer=new u,this._candlesRenderer=new d.PaneRendererCandles,this._canvas=document.createElement("canvas"),this._context=(0,r.ensureNotNull)(this._canvas.getContext("2d"));const i=e.properties().childs();this._context.font=(0,
s.makeFont)(i.hiloStyle.childs().fontSize.value(),m.CHART_FONT_FAMILY)}renderer(e,t,i){if(this._invalidated){const e=this._series().formatter(),t=this._needLabels();this._updateImpl(this._barUpdater.bind(this,e,t)),this._invalidated=!1}const r=this._series().properties().childs().hiloStyle.childs(),s=this._model().timeScale().barSpacing(),n=this._needLabels()&&this._bars().every(e=>e.highLabelWidth<=s&&e.lowLabelWidth<=s),o={bars:this._bars(),wickVisible:!1,bodyVisible:r.drawBody.value(),barSpacing:s,borderVisible:r.showBorders.value(),barWidth:(0,a.optimalHiLoWidth)(s),font:m.CHART_FONT_FAMILY,fontSize:r.fontSize.value(),labelColor:r.labelColor.value(),inverted:this._series().priceScale().isInverted(),labelsPadding:3},l=new h.CompositeRenderer;return this._candlesRenderer.setData(o),l.append(this._candlesRenderer),n&&(this._labelsRenderer.setData(o),l.append(this._labelsRenderer)),this._model().selection().isSelected(this._series())&&this._isMarkersEnabled&&l.append(new p.SelectionRenderer(this._selectionData)),l}topPixelMargin(){return this._margin()}bottomPixelMargin(){return this._margin()}_margin(){const e=this._series().properties().childs().hiloStyle.childs();return e.showLabels.value()?e.fontSize.value()+6:0}_barUpdater(e,t,i,r){const s=i[2],n=i[3];return!(!f(s)||!f(n))&&(r.high=r.open=s,r.low=r.close=n,t&&(r.highLabel=e.format(s),r.highLabelWidth=this._getLabelWidth(r.highLabel),r.lowLabel=e.format(n),r.lowLabelWidth=this._getLabelWidth(r.lowLabel)),!0)}_needLabels(){const e=this._model().timeScale().barSpacing();return this._series().properties().childs().hiloStyle.childs().showLabels.value()&&e>5}_getLabelWidth(e){return this._widthsCache.measureText(this._context,e)}}},9962:(e,t,i)=>{"use strict";i.d(t,{PaneRendererKagi:()=>n});var r=i(34250),s=i(55213);class n extends s.PaneRendererSeriesBase{constructor(e){super(),this._bars=e.bars,this._barSpacing=e.barSpacing,this._barLineWidth=Math.max(1,(0,r.optimalBarWidth)(e.barSpacing,1))}draw(e,t){let i,r,s;e.save(),e.lineCap="square";const n=Math.floor(t.pixelRatio)%2?1:0;for(const o of this._bars){const a=Math.round(t.pixelRatio*this._barLineWidth*.5),l=Math.round(t.pixelRatio*o.exactTime-a),c=void 0===r||o.isUp?Math.round(t.pixelRatio*o.high-a):r,u=2*a;let d;if(o.isTwoColorBar){const r=Math.round(t.pixelRatio*o.additionalPrice-t.pixelRatio*o.high+a),s=c+r,h=Math.round(t.pixelRatio*o.low-t.pixelRatio*o.additionalPrice+a),p=void 0!==i&&o.isUp?i:s+h;e.fillStyle=o.upColor,e.fillRect(l,c,u+n,r),e.fillStyle=o.downColor,e.fillRect(l,s,u+n,p+a-s+1),d=p}else{const r=Math.round(t.pixelRatio*o.low-t.pixelRatio*o.high+a),s=void 0!==i&&o.isUp?i:c+r;e.fillStyle=o.color,e.fillRect(l,c,u+n,s+a-c+1),d=s}if(!o.combinedWithProjection){o.isTwoColorBar?e.fillStyle=o.isUp?o.downColor:o.upColor:e.fillStyle=o.color;const i=void 0===s?Math.round((o.exactTime-this._barSpacing)*t.pixelRatio+a):s+2*a,l=Math.round(o.exactTime*t.pixelRatio-a)-i+1,c=2*a+n;if(o.isUp)e.fillRect(i,d-a+1-n,l,c);else{const s=void 0===r?Math.round(o.open*t.pixelRatio-a):r;e.fillRect(i,s,l,c)}}s=l,i=d,r=c}
e.restore()}_getTolerance(){return(0,r.interactionTolerance)().series+this._barLineWidth/4}_getBarSpacing(){return this._barLineWidth}}},63470:(e,t,i)=>{"use strict";i.d(t,{PaneRendererPnF:()=>o});var r,s=i(34250),n=i(55213);!function(e){e[e.EllipseWidth=.9]="EllipseWidth",e[e.EllipseRadius=.95]="EllipseRadius",e[e.SimplifiedEllipseWidth=.86]="SimplifiedEllipseWidth"}(r||(r={}));class o extends n.PaneRendererSeriesBase{constructor(e){super(),this._bars=e.bars,this._barSpacing=e.barSpacing,this._barWidth=e.barSpacing}draw(e,t){if(0===this._bars.length)return;e.save();const i=this._bars.reduce((e,t)=>Math.max(e,(t.low-t.high)/t.additionalNum),0);this._barSpacing>1&&i>=1?this._drawFillSigns(e,t):this._drawSimplified(e,t),e.restore()}_drawImpl(e){}_getTolerance(){return(0,s.interactionTolerance)().series+this._barWidth/8}_getBarSpacing(){return this._barSpacing}_drawBarCross(e,t,i,r){!function(e,t,i,r,s){e.moveTo(t,i),e.lineTo(t+r,i+s),e.moveTo(t+r,i),e.lineTo(t,i+s)}(e,t.time-.5*this._barWidth,t.high+r*i,this._barWidth,i)}_drawBarEllipse(e,t,i,s){!function(e,t,i,s,n){e.save(),e.translate(t+s/2,i+n/2),e.scale(s/2,n/2),e.moveTo(1,0),e.arc(0,0,r.EllipseRadius,0,2*Math.PI,!1),e.restore()}(e,t.time-this._barWidth*r.EllipseWidth*.5,t.high+s*i,this._barWidth*r.EllipseWidth,i)}_drawFillSigns(e,t){e.scale(t.pixelRatio,t.pixelRatio),e.lineCap="butt",e.lineWidth=1;for(const t of this._bars){const i=(t.low-t.high)/t.additionalNum;if(t.isMergedBar&&(e.beginPath(),t.isUp?this._drawBarEllipse(e,t,i,t.additionalNum-1):this._drawBarCross(e,t,i,0),e.strokeStyle=t.isUp?t.downColor:t.upColor,e.stroke()),e.beginPath(),t.isUp)for(let r=t.additionalNum-1-(t.isMergedBar?1:0);r>-1;r--)this._drawBarCross(e,t,i,r);else for(let r=t.isMergedBar?1:0;r<t.additionalNum;r++)this._drawBarEllipse(e,t,i,r);e.strokeStyle=t.color,e.stroke()}e.restore()}_drawSimplified(e,t){for(const i of this._bars){const s=i.isUp?1:r.SimplifiedEllipseWidth,n=(i.time-.5*this._barWidth*s)*t.pixelRatio,o=(i.time+.5*this._barWidth*s)*t.pixelRatio,a=Math.max(1,o-n);let l=i.high*t.pixelRatio;const c=i.low*t.pixelRatio,u=i.high*t.pixelRatio;let d=Math.max(1,c-u);if(i.isMergedBar){e.fillStyle=i.isUp?i.downColor:i.upColor;const t=(i.low-i.high)/i.additionalNum,r=Math.max(1,Math.round(t));i.isUp?(e.fillRect(n,l,a,r),l+=r):(e.fillRect(n,l+a-r,a,r),d-=r)}e.fillStyle=i.color,e.fillRect(n,l,a,d)}}}},26254:(e,t,i)=>{"use strict";i.d(t,{PaneRendererRenkoPB:()=>n});var r=i(34250),s=i(55213);class n extends s.PaneRendererSeriesBase{constructor(e){super(),this._bars=e.bars,this._barWidth=e.barSpacing}draw(e,t){e.save();const i=Math.round(t.pixelRatio*this._barWidth/2);let r=null;for(let s=0;s<this._bars.length;++s){const n=this._bars[s],o=Math.round(n.exactTime*t.pixelRatio),a=null===r?Math.round(o-i):r+1,l=(s<this._bars.length-1?Math.round(this._bars[s+1].exactTime*t.pixelRatio):o+2*i)-i-a,c=Math.round(Math.min(n.close,n.open)*t.pixelRatio),u=Math.round(Math.max(n.close,n.open)*t.pixelRatio)-c+1;e.fillStyle=n.borderColor,e.fillRect(a,c,l,u),
e.fillRect(o,Math.round(n.high*t.pixelRatio),1,Math.round((n.low-n.high)*t.pixelRatio)),e.fillStyle=n.color,e.fillRect(a+1,c+1,l-2,u-2),r=a+l-1}e.restore()}_getTolerance(){return(0,r.interactionTolerance)().series+.5}_getBarSpacing(){return this._barWidth}}},92462:(e,t,i)=>{"use strict";i.r(t),i.d(t,{SeriesDataSource:()=>v,initialRequestOptionsToNumBars:()=>g,parseJapaneseProjectionBars:()=>S});var r=i(16282),s=i(31565),n=i(43607),o=i(2459),a=i(46561),l=i(84101),c=i(21218),u=i(96276),d=i.n(u);class h{constructor(){this._loading=new(d()),this._completed=new(d()),this._error=new(d()),this._symbolError=new(d()),this._symbolResolved=new(d()),this._seriesError=new(d()),this._symbolNotPermitted=new(d()),this._symbolGroupNotPermitted=new(d()),this._chartTypeNotPermitted=new(d()),this._intradaySpreadNotPermitted=new(d()),this._intradayExchangeNotPermitted=new(d()),this._customIntervalNotPermitted=new(d()),this._secondsIntervalNotPermitted=new(d()),this._tickMarksRangeChanged=new(d()),this._barReceived=new(d()),this._seriesTimeFrame=new(d()),this._dataUpdated=new(d())}destroy(){this._loading.destroy(),this._completed.destroy(),this._error.destroy(),this._symbolError.destroy(),this._symbolResolved.destroy(),this._seriesError.destroy(),this._symbolNotPermitted.destroy(),this._symbolGroupNotPermitted.destroy(),this._chartTypeNotPermitted.destroy(),this._intradaySpreadNotPermitted.destroy(),this._intradayExchangeNotPermitted.destroy(),this._customIntervalNotPermitted.destroy(),this._secondsIntervalNotPermitted.destroy(),this._tickMarksRangeChanged.destroy(),this._barReceived.destroy(),this._seriesTimeFrame.destroy(),this._dataUpdated.destroy()}loading(){return this._loading}completed(){return this._completed}error(){return this._error}symbolError(){return this._symbolError}symbolResolved(){return this._symbolResolved}seriesError(){return this._seriesError}symbolNotPermitted(){return this._symbolNotPermitted}symbolGroupNotPermitted(){return this._symbolGroupNotPermitted}chartTypeNotPermitted(){return this._chartTypeNotPermitted}intradaySpreadNotPermitted(){return this._intradaySpreadNotPermitted}intradayExchangeNotPermitted(){return this._intradayExchangeNotPermitted}customIntervalNotPermitted(){return this._customIntervalNotPermitted}secondsIntervalNotPermitted(){return this._secondsIntervalNotPermitted}tickMarksRangeChanged(){return this._tickMarksRangeChanged}barReceived(){return this._barReceived}seriesTimeFrame(){return this._seriesTimeFrame}dataUpdated(){return this._dataUpdated}fireCompleted(e,t){this._completed.fire(e,t)}fireLoading(e){this._loading.fire(e)}fireError(){this._error.fire()}fireSymbolError(e){this._symbolError.fire(e),this.fireError()}fireSymbolResolved(e){this._symbolResolved.fire(e)}fireSeriesError(e){this._seriesError.fire(e),this.fireError()}fireSymbolNotPermitted(e){this._symbolNotPermitted.fire(e),this.fireError()}fireSymbolGroupNotPermitted(e){this._symbolGroupNotPermitted.fire(e),this.fireError()}fireChartTypeNotPermitted(e){this._chartTypeNotPermitted.fire(e),this.fireError()}
fireIntradaySpreadNotPermitted(){this._intradaySpreadNotPermitted.fire(),this.fireError()}fireIntradayExchangeNotPermitted(){this._intradayExchangeNotPermitted.fire(),this.fireError()}fireCustomIntervalNotPermitted(){this._customIntervalNotPermitted.fire(),this.fireError()}fireSecondsIntervalNotPermitted(){this._secondsIntervalNotPermitted.fire(),this.fireError()}fireTickMarksRangeChanged(e){this._tickMarksRangeChanged.fire(e)}fireBarReceived(e){this._barReceived.fire(e)}fireSeriesTimeFrame(e,t,i,r,s){this._seriesTimeFrame.fire(e,t,i,r,s)}fireDataUpdated(e,t){this._dataUpdated.fire(e,t)}}const p=(0,i(87380).getLogger)("Chart.SeriesDataSource");var _;!function(e){e[e.Idle=0]="Idle",e[e.AwaitingConnection=1]="AwaitingConnection",e[e.AwaitingFirstDataUpdate=2]="AwaitingFirstDataUpdate",e[e.Active=3]="Active"}(_||(_={}));let m=1;let f=1;function g(e){return e.startDate?e.endDate||e.count?e.endDate?["from_to",e.startDate,e.endDate]:["bar_count",e.startDate,(0,r.ensure)(e.count)]:["from_to",e.startDate]:e.count||300}class v{constructor(e,t,i){this._instanceId=null,this._symbolInstanceId=null,this._symbol=null,this._resolution=null,this._timeFrame=null,this._data=new a.SeriesData,this._dataEvents=new h,this._status=_.Idle,this._turnaroundCounter=1,this._boundOnGatewayIsConnectedChanged=this._onGatewayIsConnectedChanged.bind(this),this._ongoingDataUpdate=Promise.resolve(),this._gateway=e,this._turnaroundPrefix=t,this._createSeriesParams=g(null!=i?i:{count:300}),this._gateway.isConnected().subscribe(this._boundOnGatewayIsConnectedChanged)}destroy(){this.stop(),this._gateway.isConnected().unsubscribe(this._boundOnGatewayIsConnectedChanged)}modifySeries(e,t,i=null,n=!1){n&&(p.logNormal("Due to force flag clearing symbol & resolution to force re-requesting data."),this._symbol=null,this._resolution=null);const a=this._symbol,l=this._resolution;if(this._symbol=e,this._resolution=t,null===this._instanceId)return void(this._timeFrame=i);const c=!(0,s.deepEquals)(a,e)[0],u=null===l||!o.Interval.isEqual(l,t);(c||u||null!==i)&&(this._timeFrame=null,(c||u)&&this._turnaroundCounter++,c&&this._resolveSymbol(),this._gateway.modifySeries(this._instanceId,this.turnaround(),(0,r.ensureNotNull)(this._symbolInstanceId),this._resolution,i,this._onMessage.bind(this)))}requestMoreData(e){null!==this._instanceId&&this._gateway.requestMoreData(this._instanceId,e,this._onMessage.bind(this))}requestMoreTickmarks(e){null!==this._instanceId&&this._gateway.requestMoreTickmarks(this._instanceId,e,this._onMessage.bind(this))}isStarted(){return this._status!==_.Idle}isActive(){return this._status===_.Active}start(){this.isStarted()?p.logNormal("start: data source is already started, nothing to do"):((0,r.assert)(null!==this._symbol,"symbol must be set before start"),(0,r.assert)(null!==this._resolution,"resolution must be set before start"),this._gateway.isConnected().value()?this._createSeries():this._changeStatusTo(_.AwaitingConnection))}stop(){this.isStarted()?(null!==this._instanceId&&(this._gateway.removeSeries(this._instanceId),
this._instanceId=null),this._changeStatusTo(_.Idle)):p.logNormal("stop: data source is already stopped, nothing to do")}instanceId(){return this._instanceId}data(){return this._data}clearData(){this.isStarted()?this._enqueueUpdate(()=>this._clearDataImpl()):this._clearDataImpl()}dataEvents(){return this._dataEvents}turnaround(){return`${this._turnaroundPrefix}${this._turnaroundCounter}`}symbolInstanceId(){return this._symbolInstanceId}moveData(e){this._enqueueUpdate(()=>this._data.moveData(e))}_clearDataImpl(){this._data.clear()}_resolveSymbol(){null!==this._symbol&&(this._symbolInstanceId="sds_sym_"+m++,this._gateway.resolveSymbol(this._symbolInstanceId,(0,n.encodeExtendedSymbolOrGetSimpleSymbolString)(this._symbol),this._onMessage.bind(this)))}_changeStatusTo(e){(0,r.assert)(this._status!==e,"Source and destination status should be distinct"),p.logNormal(`Status changed from ${_[this._status]} to ${_[e]}`),this._status=e}_createSeries(){(0,r.assert)(this._status!==_.Active,'Status should not be "Active" when creating a study'),this._instanceId="sds_"+f++,this._resolveSymbol(),this._gateway.createSeries(this._instanceId,this.turnaround(),(0,r.ensureNotNull)(this._symbolInstanceId),(0,r.ensureNotNull)(this._resolution),this._createSeriesParams,this._timeFrame,this._onMessage.bind(this)),this._timeFrame=null,this._changeStatusTo(_.AwaitingFirstDataUpdate)}_onGatewayIsConnectedChanged(e){e?this._onGatewayConnected():this._onGatewayDisconnected()}_onGatewayConnected(){this._status===_.AwaitingConnection&&this._createSeries()}_onGatewayDisconnected(){this._status!==_.Idle&&this._status!==_.AwaitingConnection&&(this._instanceId=null,this._changeStatusTo(_.AwaitingConnection)),this._turnaroundCounter=1}_onMessage(e){this._enqueueUpdate(()=>this._onMessageImpl(e))}async _onMessageImpl(e){switch(e.method){case"symbol_resolved":{const[t,i]=e.params;if(t!==this._symbolInstanceId){p.logNormal(`Resolve for old symbol, expected: ${this._symbolInstanceId}, actual ${e.params[0]}`);break}this._onSymbolResolved(i);break}case"symbol_error":if(e.params[0]!==this._symbolInstanceId){p.logNormal(`Symbol error for old symbol, expected: ${this._symbolInstanceId}, actual ${e.params[0]}`);break}this._onSymbolError(e);break;case"series_timeframe":{const[t,i,r,s,n,o,a]=e.params;if(!this._checkTurnaround(t,i)){p.logNormal(`Time frame for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${t} (${i})`);break}this._onSeriesTimeFrame(r,s,n,o,a);break}case"series_error":{const[t,i]=e.params;if(!this._checkTurnaround(t,i)){p.logNormal(`Series error for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${t} (${i})`);break}this._onSeriesError(e.params[2]);break}case"series_loading":{const[t,i]=e.params;if(!this._checkTurnaround(t,i))break;this._onSeriesLoading(e.time);break}case"series_completed":{const[t,i,r]=e.params;if(!this._checkTurnaround(t,r)){p.logNormal(`Series completed for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${t} (${r})`);break}
this._onSeriesCompleted(i,e.time);break}case"data_update":if(!this._checkTurnaround(e.params.customId,e.params.turnaround)){p.logNormal(`Data update for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${e.params.customId} (${e.params.turnaround})`);break}await this._onDataUpdate(e.params.plots,e.params.nonseries,e.params.lastBar);break;case"clear_data":if(e.params.turnaround!==this.turnaround()){p.logNormal(`Clear data for old data, expected: ${this.turnaround()}, actual ${e.params.turnaround}`);break}this._clearDataImpl(),this._dataEvents.fireDataUpdated(void 0,!1)}}_onSeriesError(e){let t,i;if("string"==typeof e)i={error:e},t=e;else if(i=e,e.ctx){const i={};Object.entries(e.ctx).forEach(([e,t])=>{i[e]=t.toString()}),t=e.error.format(i)}else t=e.error;if(t.startsWith("study_not_auth:")){const e=t.split(":",2)[1].split("@",2)[0];["BarSetRenko","BarSetPriceBreak","BarSetKagi","BarSetPnF"].includes(e)?this._dataEvents.fireChartTypeNotPermitted(e):"BarSetSpread"===e?this._dataEvents.fireIntradaySpreadNotPermitted():"BarSetRange"===e&&this._dataEvents.fireCustomIntervalNotPermitted()}else"resolution_not_entitled"===t?this._dataEvents.fireIntradayExchangeNotPermitted():"custom_resolution"===t?this._dataEvents.fireCustomIntervalNotPermitted():"seconds_not_entitled"===t&&this._dataEvents.fireSecondsIntervalNotPermitted();this._dataEvents.fireSeriesError(i)}_onSeriesTimeFrame(e,t,i,r,s){this._dataEvents.fireSeriesTimeFrame(e,t,i,null==r||r,s)}_onSymbolError(e){if(e.params[1]===c.permissionDenied)switch(e.params[2]){case c.SymbolErrorPermissionDeniedReason.Symbol:this._dataEvents.fireSymbolNotPermitted(e.params[3]);break;case c.SymbolErrorPermissionDeniedReason.GroupPermission:this._dataEvents.fireSymbolGroupNotPermitted(e.params[3]);break;default:this._dataEvents.fireSymbolNotPermitted(e.params[2])}this._dataEvents.fireSymbolError(e.params[1])}_onSymbolResolved(e){this._dataEvents.fireSymbolResolved(e)}async _onDataUpdate(e,t,i){this._onDataUnpacked(e,i,await S(t))}_enqueueUpdate(e){return this._ongoingDataUpdate=this._ongoingDataUpdate.then(e,e),this._ongoingDataUpdate}_onDataUnpacked(e,t,i){if(this._status===_.Idle)return;this._status===_.AwaitingFirstDataUpdate&&(this._changeStatusTo(_.Active),this._clearDataImpl());const r=this._data.bars().size(),s=this._data.bars().firstIndex(),n=this._data.bars().merge(e);null!==i&&(this._data.nsBars().clear(),this._data.nsBars().merge(i.projectionPlots),this._data.lastProjectionPrice=i.lastPrice,null!==i.boxSize&&(this._data.boxSize=i.boxSize),this._data.reversalAmount=i.reversalAmount);const o=null===s||null!==n&&n.index<s;this._dataEvents.fireDataUpdated(t,o),r!==this._data.bars().size()&&null!==n&&this._dataEvents.fireBarReceived(n)}_onSeriesLoading(e){this._dataEvents.fireLoading(e)}_onSeriesCompleted(e,t){this._dataEvents.fireCompleted(e,t)}_checkTurnaround(e,t){return this._instanceId===e&&(void 0===t||t===this.turnaround())}}async function S(e){if(void 0===e)return{projectionPlots:[],boxSize:null};if(""===e.d||"nochange"===e.indexes)return null
;const t=await(0,l.unpackNonSeriesData)(e.d);if(null===t||t.indexes_replace)return null;const i=e.indexes,{bars:r,price:s,boxSize:n,reversalAmount:o}=t.data;return{lastPrice:s,projectionPlots:(r||[]).map(e=>{let t;return"factor"in e?t=e.factor:"additionalPrice"in e&&(t=e.additionalPrice),{index:i[e.time],value:[0,e.open,e.high,e.low,e.close,e.volume,t]}}),reversalAmount:o,boxSize:n}}},78066:(e,t,i)=>{"use strict";i.d(t,{SeriesHorizontalBaseLinePaneView:()=>s});var r=i(41261);class s extends r.SeriesHorizontalLinePaneView{constructor(e){super(e)}_updateImpl(){this._lineRendererData.visible=!1;const e=this._series.priceScale().mode();if(!e.percentage&&!e.indexedTo100)return;const t=this._series.firstValue();null!==t&&(this._lineRendererData.visible=!0,this._lineRendererData.y=this._series.priceScale().priceToCoordinate(t,t),this._lineRendererData.color=this._series.properties().childs().baseLineColor.value())}}},41261:(e,t,i)=>{"use strict";i.d(t,{SeriesHorizontalLinePaneView:()=>s});var r=i(17627);class s extends r.HorizontalLinePaneView{constructor(e){super(),this._series=e,this._model=e.model()}}},55818:(e,t,i)=>{"use strict";i.d(t,{SeriesPriceLinePaneView:()=>n});var r=i(41261),s=i(3707);class n extends r.SeriesHorizontalLinePaneView{constructor(e){super(e),this._lineRendererData.linestyle=s.LINESTYLE_DOTTED}_updateImpl(){this._lineRendererData.visible=!1;const e=this._series.properties().childs();if(!e.showPriceLine.value())return;if(12===e.style.value())return;const t=this._series.lastValueData(void 0,!0);t.noData||(this._lineRendererData.visible=!0,this._lineRendererData.y=t.coordinate,this._lineRendererData.color=this._series.priceLineColor(t.color),this._lineRendererData.linewidth=e.priceLineWidth.value())}}},31741:(e,t,i)=>{"use strict";i.d(t,{calculateColor:()=>w,paneBackgroundColor:()=>P,SeriesValuesProvider:()=>C});var r=i(16282),s=i(75496),n=i(14563),o=i(20220),a=i(68724),l=i(50946),c=i(82755),u=i(40989),d=i(87048),h=i(14397),p=i(14704),_=i(66786),m=i(26587),f=i(11403);const g=a.CheckMobile.any(),v=g&&!1,S=new p.PercentageFormatter,y=window.t("n/a"),b=`${y} (${y}%)`;function w(e,t){const i=(0,n.parseRgb)(t),r=(0,n.parseRgb)(e);return(0,n.distanceRgb)(i,r)<70?(0,n.rgbToHexString)((0,n.invertRgb)(i)):t}function P(e){if(null===e)return null;const t=e.properties().child("background");return void 0===t?null:t.value()}class C{constructor(e,t){this._series=e,this._model=t,this._emptyValues=[{title:(0,o.t)("Open"),visible:!1,value:"",index:0,id:""},{title:(0,o.t)("High"),visible:!1,value:"",index:1,id:""},{title:(0,o.t)("Low"),visible:!1,value:"",index:2,id:""},{title:(0,o.t)("Close"),visible:!1,value:"",index:3,id:""},{title:"",visible:!1,value:"",index:4,id:""},{title:"",visible:!1,value:"",index:5,id:""},{title:(0,o.t)("Change"),visible:!1,value:"",index:6,id:""}]}getItems(){return this._emptyValues}getValues(e){const t=this._showLastPriceAndChangeOnly(),i=this._emptyValues.map(e=>({...e,visible:!t}));i[0].value=y,i[1].value=y,i[2].value=y,i[3].value=y,i[6].value=b,i[5].visible=!1;const n=i[4];if(n.value=y,
n.visible=!1,this._model.timeScale().isEmpty()||0===this._series.bars().size()||this._series.priceScale().isEmpty())return i;(0,s.isNumber)(e)||(e=(0,r.ensureNotNull)(this._series.data().last()).index);const o=this._series.nearestIndex(e,u.PlotRowSearchMode.NearestLeft);if(void 0===o)return i;const a=this._series.data().valueAt(o),d=P(this._series.model().paneForSource(this._series));if(null===a||null===d)return i;const h=a[1],p=a[2],m=a[3],g=a[4];if(null==h||null==p||null==m||null==g)return i;const{values:C}=this._changesData(g,o,t),T=(0,f.getPriceValueFormatterForSource)(this._series);if((0,f.shouldBeFormattedAsPercent)(this._series))i[6].value="";else if(void 0!==C){const e=this._series.formatter();i[6].value=(0,c.forceLTRStr)(`${e.format(C.change,!0)} (${S.format(C.percentChange,!0)})`)}t?(i[5].value=T(g),i[5].visible=!0,i[6].visible=!0):(i[0].value=T(h),i[1].value=T(p),i[2].value=T(m),i[3].value=T(g),i[4].value=T(this._series.barFunction()(a)));let x=null;if(t&&!v)x=void 0===C||C.change>=0?_.SeriesBarColorer.upColor(this._series.properties()):_.SeriesBarColorer.downColor(this._series.properties());else{const e=this._series.barColorer().barStyle(o,!1);x=w(d,null!=e.barBorderColor?e.barBorderColor:e.barColor)}x=(0,l.resetTransparency)(w(d,x));for(const e of i)e.color=x;return i}_showLastPriceAndChangeOnly(){return g&&(null===this._model.crossHairSource().pane||(0,d.isLineToolName)(h.tool.value())||null!==this._model.lineBeingEdited())}_changesData(e,t,i){if(i&&!v){const e=this._series.quotes();if(null!==e)return{values:{change:e.change,percentChange:e.change_percent}}}else{const i=this._series.data().valueAt(t-1),r=i&&i[4]||null;if(null!==r)return{values:{change:e-r,percentChange:(0,m.barPercentChange)(r,e)}}}return{}}}},87782:(e,t,i)=>{"use strict";var r=i(72927).Point,s=i(26184).SelectionRenderer,n=i(62288).HitTestResult,o=i(30807).PaneRendererBars,a=i(24090).PaneRendererLine,l=i(72472).PaneRendererStepLine,c=i(93321).PaneRendererArea,u=i(67003).PaneRendererCandles,d=i(15469).PaneRendererBaseline,h=i(56288).CompositeRenderer,p=i(50946),_=i(40989).PlotRowSearchMode,m=i(22842),f=i(34250),g=i(5722).SelectionIndexes;function v(e,t){this.m_series=e,this.m_model=t,this.m_bars=[],this._invalidated=!0,this._isMarkersEnabled=m.enabled("source_selection_markers"),this._selectionData=null,this._selectionIndexer=new g(t.timeScale())}function S(e,t){return void 0!==e[TradingView.OPEN_PLOT]&&void 0!==e[TradingView.HIGH_PLOT]&&void 0!==e[TradingView.LOW_PLOT]&&void 0!==e[TradingView.CLOSE_PLOT]&&(t.open=e[TradingView.OPEN_PLOT],t.high=e[TradingView.HIGH_PLOT],t.low=e[TradingView.LOW_PLOT],t.close=e[TradingView.CLOSE_PLOT],!0)}function y(e,t){v.call(this,e,t)}function b(e,t){v.call(this,e,t)}function w(e,t){v.call(this,e,t)}function P(e,t){v.call(this,e,t)}function C(e,t){this.m_series=e,this.m_model=t,this.m_items=[],this._isMarkersEnabled=m.enabled("source_selection_markers"),this._selectionIndexer=new g(t.timeScale())}function T(e,t){C.call(this,e,t),this._invaidated=!0}function x(e,t){C.call(this,e,t),this._invaidated=!0}
function I(e,t){C.call(this,e,t),this._invaidated=!0,this._renderer=new d}v.prototype._series=function(){return this.m_series},v.prototype._model=function(){return this.m_model},v.prototype._bars=function(){return this.m_bars},v.prototype.update=function(){this._invalidated=!0},v.prototype._updateImpl=function(e){var t=this;if((e=e||S,this.m_bars=[],!this.m_model.timeScale().isEmpty()&&!this.m_series.priceScale().isEmpty())&&(null!==(a=this.m_model.timeScale().visibleBarsStrictRange())&&0!==this.m_series.bars().size())){for(var i=this.m_series.nearestIndex(a.firstBar(),_.NearestRight),s=this.m_series.nearestIndex(a.lastBar(),_.NearestLeft);i<=s;i++){if(null!==this.m_series.bars().valueAt(i))break}if(!(i>s)){var o,a=this.m_series.bars().range(i,s),l=this.m_series.priceScale(),c=this.m_series.barColorer(),u={};if(a.each((function(i,r){var s,n={};(n.time=Math.round(i),e(r,n))&&(u.value=r,s=r[TradingView.STYLE_PLOT]?r[TradingView.STYLE_PLOT]:c.barStyle(i,!1,u),r[TradingView.STYLE_PLOT]=s,u.previousValue=r,n.color=s.barColor,n.borderColor=s.barBorderColor,n.wickColor=s.barWickColor,n.hollow=s.isBarHollow,t.m_bars.push(n))}),this),0!==this.m_bars.length&&(o=this.m_series.firstValue(),l.barPricesToCoordinates(this.m_bars,o)),this.m_model.timeScale().barIndexesToCoordinates(this.m_bars),this.m_model.selection().isSelected(this.m_series)){var d=this._selectionIndexer.indexes();this._selectionData={points:[],bgColors:[],visible:!0};var h=this.m_model.paneForSource(this.m_series).height();this._selectionData.hittestResult=n.REGULAR;for(var p=0;p<d.length;p++){var m=d[p],f=this.m_series.bars().valueAt(m);if(null!==f){var g=.5*(f[TradingView.OPEN_PLOT]+f[TradingView.CLOSE_PLOT]),v=this.m_model.timeScale().indexToCoordinate(m),y=this.m_series.priceScale().priceToCoordinate(g,o);this._selectionData.points.push(new r(v,y)),this._selectionData.bgColors.push(this.m_model.backgroundColorAtYPercentFromTop(y/h))}}}else this._selectionIndexer.clear()}}},v.prototype.items=function(){return this.m_bars},inherit(y,v),y.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing();var t=this.m_series.properties();e.dontDrawOpen=t.barStyle.dontDrawOpen.value(),e.thinBars=t.style.value()===TradingView.Series.STYLE_RANGE?t.rangeStyle.thinBars.value():t.barStyle.thinBars.value();var i=new h;return i.append(new o(e)),this.m_model.selection().isSelected(this.m_series)&&this._isMarkersEnabled&&i.append(new s(this._selectionData)),i},inherit(b,v),b.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing(),e.wickVisible=this.m_series.properties().candleStyle.drawWick.value(),e.bodyVisible=this.m_series.properties().candleStyle.drawBody.value(),e.borderVisible=this.m_series.properties().candleStyle.drawBorder.value(),e.borderColor=this.m_series.properties().candleStyle.borderColor.value(),
e.wickColor=this.m_series.properties().candleStyle.wickColor.value(),e.barWidth=f.optimalBarWidth(e.barSpacing),e.isPriceScaleInverted=this.m_series.priceScale().isInverted();var t=new h;return t.append(new u(e)),this.m_model.selection().isSelected(this.m_series)&&this._isMarkersEnabled&&t.append(new s(this._selectionData)),t},inherit(w,v),w.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing(),e.wickVisible=this.m_series.properties().haStyle.drawWick.value(),e.bodyVisible=this.m_series.properties().haStyle.drawBody.value(),e.borderVisible=this.m_series.properties().haStyle.drawBorder.value(),e.borderColor=this.m_series.properties().haStyle.borderColor.value(),e.wickColor=this.m_series.properties().haStyle.wickColor.value(),e.barWidth=f.optimalBarWidth(e.barSpacing),e.isPriceScaleInverted=this.m_series.priceScale().isInverted();var t=new h;return t.append(new u(e)),this.m_model.selection().isSelected(this.m_series)&&this._isMarkersEnabled&&t.append(new s(this._selectionData)),t},inherit(P,v),P.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);var e={};e.bars=this.m_bars,e.barSpacing=this.m_model.timeScale().barSpacing(),e.wickVisible=this.m_series.properties().hollowCandleStyle.drawWick.value(),e.bodyVisible=this.m_series.properties().hollowCandleStyle.drawBody.value(),e.borderVisible=this.m_series.properties().hollowCandleStyle.drawBorder.value(),e.borderColor=this.m_series.properties().hollowCandleStyle.borderColor.value(),e.wickColor=this.m_series.properties().hollowCandleStyle.wickColor.value(),e.barWidth=f.optimalBarWidth(e.barSpacing),e.isPriceScaleInverted=this.m_series.priceScale().isInverted();var t=new h;return t.append(new u(e)),this.m_model.selection().isSelected(this.m_series)&&this._isMarkersEnabled&&t.append(new s(this._selectionData)),t},C.prototype.update=function(){if(this.m_items=[],this.m_model.timeScale().isEmpty()||!this.m_series.priceScale()||this.m_series.priceScale().isEmpty())return;const e=this.m_model.timeScale().visibleBarsStrictRange();if(null===e)return;if(0===this.m_series.bars().size())return;var t=this.m_series.nearestIndex(e.firstBar()-1,_.NearestLeft),i=this.m_series.nearestIndex(e.lastBar()+1,_.NearestRight);const s=this.m_series.bars().range(t,i);var o=this.m_series.priceScale(),a={color:this.m_series.properties().lineStyle.color.value()},l=this.m_series.barFunction();let c;if(s.each(function(t,i){var s=l(i);if(null==s)return!1;void 0===c&&e.contains(t)&&(c=s);var n=new r(t,s);return n.style=a,this.m_items.push(n),!1}.bind(this)),o.pointsArrayToCoordinates(this.m_items,c),this.m_model.timeScale().timedValuesToCoordinates(this.m_items),this.m_model.selection().isSelected(this.m_series)){var u=this._selectionIndexer.indexes();this._selectionData={points:[],isDark:this.m_model.isDark(),bgColors:[],visible:!0};var d=this.m_model.paneForSource(this.m_series).height();this._selectionData.hittestResult=n.REGULAR
;for(var h=0;h<u.length;h++){var p=u[h],m=this.m_series.data().valueAt(p);if(null!==m){var f=l(m),g=this.m_model.timeScale().indexToCoordinate(p),v=this.m_series.priceScale().priceToCoordinate(f,c);this._selectionData.points.push(new r(g,v)),this._selectionData.bgColors.push(this.m_model.backgroundColorAtYPercentFromTop(v/d))}}}else this._selectionIndexer.clear()},inherit(T,C),T.prototype.update=function(){this._invalidated=!0},T.prototype.renderer=function(){this._invalidated&&(C.prototype.update.call(this),this._invalidated=!1);var e,t,i=this.m_series.properties().lineStyle,r={barSpacing:this.m_model.timeScale().barSpacing(),items:this.m_items,lineColor:i.color.value(),lineStyle:i.linestyle.value(),withMarkers:i.styleType.value()===TradingView.Series.STYLE_LINE_TYPE_MARKERS,lineWidth:i.linewidth.value(),simpleMode:!0};return i.styleType.value()===TradingView.Series.STYLE_LINE_TYPE_STEP?(e=new l).setData(r):e=new a(r),this.m_model.selection().isSelected(this.m_series)?((t=new h).append(e),this._isMarkersEnabled&&t.append(new s(this._selectionData))):t=e,t},inherit(x,C),x.prototype.update=function(){this._invalidated=!0},x.prototype.renderer=function(){this._invalidated&&(C.prototype.update.call(this),this._invalidated=!1);var e={simpleMode:!1};e.barSpacing=this.m_model.timeScale().barSpacing(),e.items=this.m_items,e.lineColor=this.m_series.properties().areaStyle.linecolor.value(),e.lineStyle=this.m_series.properties().areaStyle.linestyle.value(),e.lineWidth=this.m_series.properties().areaStyle.linewidth.value();var t=this.m_series.properties().areaStyle.transparency.value();e.isSeries=!0,e.color1=p.generateColor(this.m_series.properties().areaStyle.color1.value(),t),e.color2=p.generateColor(this.m_series.properties().areaStyle.color2.value(),t),e.bottom=this.m_series.priceScale().height();var i=new h;return i.append(new c(e)),this.m_model.selection().isSelected(this.m_series)&&this._isMarkersEnabled&&i.append(new s(this._selectionData)),i},inherit(I,C),I.prototype.update=function(){this._invalidated=!0},I.prototype._updateImpl=function(){C.prototype.update.call(this);var e=this.m_series.properties().baselineStyle,t=e.transparency.value();this._topFillColor1=p.generateColor(e.topFillColor1.value(),t),this._topFillColor2=p.generateColor(e.topFillColor2.value(),t),this._bottomFillColor1=p.generateColor(e.bottomFillColor1.value(),t),this._bottomFillColor2=p.generateColor(e.bottomFillColor2.value(),t),this._topLineColor=e.topLineColor.value(),this._bottomLineColor=e.bottomLineColor.value(),this._topLineWidth=e.topLineWidth.value(),this._bottomLineWidth=e.bottomLineWidth.value(),this._barSpacing=this.m_model.timeScale().barSpacing(),this._bottom=this.m_series.priceScale().height(),this._baseLevelCoordinate=Math.round(this._bottom*(Math.abs(100-e.baseLevelPercentage.value())/100))},I.prototype.renderer=function(){this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer.setData({items:this.m_items,topFillColor1:this._topFillColor1,topFillColor2:this._topFillColor2,bottomFillColor1:this._bottomFillColor1,
bottomFillColor2:this._bottomFillColor2,topLineColor:this._topLineColor,bottomLineColor:this._bottomLineColor,topLineWidth:this._topLineWidth,bottomLineWidth:this._bottomLineWidth,lineStyle:CanvasEx.LINESTYLE_SOLID,barSpacing:this._barSpacing,baseLevelCoordinate:this._baseLevelCoordinate,bottom:this._bottom});var e=new h;return e.append(this._renderer),this.m_model.selection().isSelected(this.m_series)&&e.append(new s(this._selectionData)),e},t.SeriesBarsPaneView=y,t.SeriesCandlesPaneView=b,t.SeriesHollowCandlesPaneView=P,t.SeriesLinePaneView=T,t.SeriesAreaPaneView=x,t.SeriesHeikenAshiPaneView=w,t.SeriesBaselinePaneView=I,t.SeriesBarCandlesPaneView=v},42461:(e,t,i)=>{"use strict";i.d(t,{sessionsPreferencesDefault:()=>s});var r=i(93669);const s={graphics:{backgrounds:{outOfSession:{color:r.colorsPalette["color-tv-blue-500"],transparency:92,visible:!1},preMarket:{color:"#FF9800",transparency:92,visible:!1},postMarket:{color:r.colorsPalette["color-tv-blue-500"],transparency:92,visible:!1}},vertlines:{sessBreaks:{color:"#4985e7",style:2,visible:!1,width:1}}}}},87576:(e,t,i)=>{"use strict";i.d(t,{StatusProviderBase:()=>r});class r{constructor(e){this._colorProperty=e}size(){return"13px"}bold(){return!1}color(){return this._colorProperty.value()}}},14854:(e,t,i)=>{"use strict";i.d(t,{StatusView:()=>r});class r{constructor(e){this._text="",this._color="",this._size="13px",this._bold=!1,this._statusProvider=e}text(){return this._text}getSplitTitle(){return[this._text]}color(){return this._statusProvider.color()}bold(){return this._bold}size(){return this._size}}},93441:(e,t,i)=>{"use strict";var r;i.d(t,{StoriesTimeLineItemType:()=>r}),function(e){e[e.Image=0]="Image",e[e.Emoji=1]="Emoji"}(r||(r={}))},16584:(e,t,i)=>{"use strict";i.d(t,{seriesPrice:()=>n,positionVisualDirection:()=>a,positionToCoordinate:()=>l,noDataBasePosition:()=>c,seriesBasePosition:()=>u,getNoDataPosition:()=>d,getSeriesPosition:()=>h});var r=i(16282),s=i(40989);function n(e,t,i){const r=e.barFunction();switch(e.style()){case 3:case 10:case 2:return r(t.value);default:return t.value[-1===i?3:2]}}function o(e){return e>=0?1:-1}function a(e,t){return-1===o(e)!==t?-1:1}function l(e,t,i,r){const s=Math.min(t,Math.max(0,1===r?i:t-i));return i-r*Math.abs(s*e/100)}function c(e,t,i){const r=e.index();return null===r?null:{index:r,price:t.coordinateToPrice(t.height()/2,i)}}function u(e,t){const i=e.data().bars(),r=i.first(),a=i.last();if(null===r||null===a)return null;let l;const c=t.index();if(null===c){if(void 0===t.time)return null;const e=t.time(),n=r.value[0],o=a.value[0];if(e<n-86400||e>o)return null;l=i.searchByTime(e,s.PlotRowSearchMode.NearestRight,4)}else l=i.search(c);return null===l?null:{index:l.index,price:n(e,l,o(t.position()))}}function d(e,t,i){const r=c(e,t,i);if(null===r)return null;const s=a(e.position(),t.isInverted());return{index:r.index,price:r.price,poleStartY:t.height(),visualDirection:1,positionPointDirection:s}}function h(e,t){const i=u(e,t),s=e.priceScale(),n=(0,r.ensureNotNull)(e.firstValue());if(null===i)return d(t,s,n);let o=0
;const l=e.properties().childs(),c=e.model().timeScale(),h=s.priceToCoordinate(i.price,n);switch(e.style()){case 3:o=l.areaStyle.childs().linewidth.value()/2;break;case 2:o=l.lineStyle.childs().linewidth.value()/2;break;case 10:const e=Math.abs(100-l.baselineStyle.childs().baseLevelPercentage.value());o=s.height()*e/100>h?l.baselineStyle.childs().topLineWidth.value()/2:l.baselineStyle.childs().bottomLineWidth.value()/2;break;case 1:case 9:case 8:case 12:o=3;break;case 0:o=l.barStyle.childs().thinBars.value()?3:Math.max(3,.25*c.barSpacing());break;case 11:o=l.rangeStyle.childs().thinBars.value()?3:Math.max(3,.25*c.barSpacing());break;case 4:case 7:o=3;break;case 5:o=Math.max(4,.25*c.barSpacing());break;case 6:o=Math.max(5,.25*c.barSpacing())}const p=a(t.position(),s.isInverted()),_=h-p*o;return{index:i.index,price:i.price,poleStartY:_,visualDirection:p,positionPointDirection:p}}},57778:(e,t,i)=>{"use strict";i.d(t,{AbstractFilledAreaPaneView:()=>m});var r=i(16282),s=i(50946),n=i(29295);class o{constructor(){this._items=[],this._actualLength=0,this._invalidations=0}push(e){this._items.length===this._actualLength?this._items.push(e):this._items[this._actualLength]!==e&&(this._items[this._actualLength]=e),this._actualLength+=1}newItem(){const e=this._items.length>this._actualLength?this._items[this._actualLength]:null;return null!==e&&Boolean(e.invalidateCache)&&e.invalidateCache(),e}invalidateCache(){this._invalidations+=1,3e3===this._invalidations&&(this._items.splice(this._actualLength),this._invalidations=0),this._actualLength=0}at(e){return this._items[e]}data(){return this._items}length(){return this._actualLength}}class a{constructor(){this._map=new Map,this._usedKeys=new Set,this._invalidations=0}invalidateCache(){this._invalidations+=1,50===this._invalidations&&(this._deleteUnused(),this._invalidations=0),this._usedKeys.clear(),this._map.forEach((e,t)=>e.invalidateCache())}get(e){const t=this._map.get(e);return void 0!==t&&this._usedKeys.add(e),t}set(e,t){this._usedKeys.add(e),this._map.set(e,t)}forEach(e){this._map.forEach((t,i)=>{this._usedKeys.has(i)&&e(t,i)})}delete(e){const t=this._map.get(e);void 0!==t&&t.invalidateCache(),this._usedKeys.delete(e)}_deleteUnused(){const e=[];this._map.forEach((t,i)=>{this._usedKeys.has(i)||e.push(i)});for(const t of e)this._map.delete(t)}}class l extends o{constructor(){super(),this.points1=new o,this.points2=new o,this.push(this.points1),this.push(this.points2)}addPoints1Point(e,t){let i=this.points1.newItem();null!==i?(i.x=e,i.y=t):i={x:e,y:t},this.points1.push(i)}addPoints2Point(e,t){let i=this.points2.newItem();null!==i?(i.x=e,i.y=t):i={x:e,y:t},this.points2.push(i)}invalidateCache(){this.points1.invalidateCache(),this.points2.invalidateCache()}}class c extends n.ScaledPaneRenderer{constructor(){super(...arguments),this._data=null}setData(e){this._data=e}hitTest(e,t){return null}_drawImpl(e,t){if(null===this._data)return;const i=.25*this._data.barSpacing,r=this._data.transparency;this._data.colorAreas.forEach((t,n)=>{e.beginPath();for(let r=0;r<t.length();r++){
const s=t.at(r);if(0===s.points1.length()||0===s.points2.length())continue;const n=s.points1.at(0).x,o=s.points1.at(0).y;if(e.moveTo(n,o),1!==s.points1.length()&&1!==s.points2.length()){for(let t=1;t<s.points1.length();t++)e.lineTo(s.points1.at(t).x,s.points1.at(t).y);for(let t=s.points2.length()-1;t>=0;t--)e.lineTo(s.points2.at(t).x,s.points2.at(t).y)}else{const t=s.points2.at(0).x,r=s.points2.at(0).y;e.lineTo(n+i,o),e.lineTo(t+i,r),e.lineTo(t-i,r),e.lineTo(n-i,o)}}e.closePath(),e.fillStyle=(0,s.generateColor)(n,r),e.fill()})}}var u=i(40989),d=i(31565),h=i(34250),p=i(87504);class _ extends o{constructor(){super(...arguments),this._startIndex=0}setStartIndex(e){this._startIndex=e}at(e){const t=e-this._startIndex;for(;t>=this._actualLength;){if(this._items.length<=t)this._items.push({plot1Value:void 0,plot2Value:void 0,colorIndex:void 0});else{const e=this._items[this._actualLength];e.plot1Value=void 0,e.plot2Value=void 0,e.colorIndex=void 0}this._actualLength+=1}return this._items[t]}}class m{constructor(e,t,i=!1){this._isHlineFill=!1,this._bandAKey=null,this._bandBKey=null,this._colorPlotIndex=null,this._colorValues=[],this._colors=new o,this._areaRenderer=new c,this._invalidated=!0,this._plIndex1=null,this._plIndex2=null,this._level1=0,this._level2=0,this._studyValuesCache=new _,this._points1=new o,this._points2=new o,this._timePoints=new o,this._colorAreas=new a,this._source=e,this._model=t,this._fillGaps=i}update(){this._invalidated=!0}renderer(e,t){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._areaRenderer}_correctVisibleRange(e){const t=this._source.data(),i=t.search(e.firstBar(),u.PlotRowSearchMode.NearestLeft,this._plotIndex1()),r=t.search(e.firstBar(),u.PlotRowSearchMode.NearestLeft,this._plotIndex2()),s=t.search(e.lastBar(),u.PlotRowSearchMode.NearestRight,this._plotIndex1()),n=t.search(e.lastBar(),u.PlotRowSearchMode.NearestRight,this._plotIndex2()),o=null!==i?i.index:e.firstBar(),a=null!==r?r.index:e.firstBar(),l=null!==s?s.index:e.lastBar(),c=null!==n?n.index:e.lastBar();return[Math.min(o,a),Math.max(l,c)]}_plotNames(){return this._source.metaInfo().plots.map(e=>e.id)}_plotIndex1(){return null===this._plIndex1&&(this._plIndex1=this._plotNames().indexOf(this._plotAId())+1),this._plIndex1}_plotIndex2(){return null===this._plIndex2&&(this._plIndex2=this._plotNames().indexOf(this._plotBId())+1),this._plIndex2}_updateImpl(){var e,t,i;if(this._areaRenderer.setData(null),!this._visible())return;const s=this._source.priceScale(),n=this._model,o=n.timeScale();if(!s||s.isEmpty()||o.isEmpty())return;if(n.mainSeries().bars().isEmpty())return;const a=this._source.firstValue();if(null===a)return;if(this._isHlineFill){const e=this._source.properties().bands[(0,r.ensureNotNull)(this._bandAKey)],t=this._source.properties().bands[(0,r.ensureNotNull)(this._bandBKey)];this._level1=s.priceToCoordinate(e.value.value(),a),this._level2=s.priceToCoordinate(t.value.value(),a)}const l=o.visibleBarsStrictRange();if(null===l)return;this._timePoints.invalidateCache(),this._points1.invalidateCache(),
this._points2.invalidateCache(),null===(e=this._colors)||void 0===e||e.invalidateCache(),this._colorAreas.invalidateCache();const[c,u]=this._correctVisibleRange(l),h=this._isPerBarColoringSupported()?this._colors:null,_=this._source.offset(this._plotAId()),m=this._source.offset(this._plotBId()),f=Math.min(_,m),g=Math.max(_,m),v=this._plotIndex1(),S=this._plotIndex2(),y=this._source.data();if(y.isEmpty())return;let b,w;const P=(0,r.ensureNotNull)(y.firstIndex()),C=(0,r.ensureNotNull)(y.lastIndex()),T=P-Math.max(0,-f),x=C+Math.max(0,g),I=Math.max(c-1,T),L=Math.min(u+1,x),M=this._studyValuesCache;M.invalidateCache();const E=I-g,A=y.rangeIterator(E,L-f),k=Math.max(l.firstBar()-1,Math.min(E-g-1,E-1+f));M.setStartIndex(k);const D=new p.BarsRange(l.firstBar()-1,l.lastBar()+1);for(;A.hasNext();){const e=A.next(),t=e.index,i=e.value,s=i[v],n=i[S],o=t+_,a=t+m;if(o===a&&D.contains(o)){const e=M.at(o);e.plot1Value=s,e.plot2Value=n}else{if(D.contains(o)){M.at(o).plot1Value=s}if(D.contains(a)){M.at(a).plot2Value=n}}if(null!==h){const e=t-1+f;if(l.contains(e)){const t=i[(0,r.ensureNotNull)(this._colorPlotIndex)+1];M.at(e).colorIndex=t}}}const R=this._timePoints,N=this._points1,O=this._points2;let V=null;const B=k+M.length();for(let e=k;e<=B;e++){if(!this._fillGaps&&(null===b||null===w)){const t=e-1;R.push(t),N.push(NaN),O.push(NaN),null==h||h.push(null)}const r=M.at(e);if(null!==h){const e=r.colorIndex;V=null==e?null:this._getColorByPlotValue(e)}if(this._isHlineFill){R.push(e),null!==h&&h.push(V);continue}const s=null!==(t=r.plot1Value)&&void 0!==t?t:null,n=null!==(i=r.plot2Value)&&void 0!==i?i:null;(null!==s||null!==n||Number.isFinite(b)||Number.isFinite(w))&&(b=s,w=n,N.push(s),O.push(n),R.push(e),null!==h&&h.push(V))}s.pricesArrayToCoordinates(N.data(),a,N.length()),s.pricesArrayToCoordinates(O.data(),a,O.length()),o.indexesToCoordinates(R.data(),R.length());const F=this._transparency();let W=(0,d.isNumber)(F)?F:50;W=Math.min(W,100),W=Math.max(W,0);const U={barSpacing:this._model.timeScale().barSpacing(),transparency:W,colorAreas:this._getFilledAreas(R,N,O,h)};this._areaRenderer.setData(U)}_getFilledAreas(e,t,i,r){const s=this._isHlineFill;if(!s&&(0===t.length()||0===i.length()))return new a;const n=this._colorAreas;let c=null,u=null;const d=this._color();for(let a=0;a<e.length();a++){const p=s?this._level1:t.at(a),_=s?this._level2:i.at(a),m=e.at(a),f=(0,h.coordinateIsValid)(p),g=(0,h.coordinateIsValid)(_);if(this._fillGaps?f||g:f&&g){const e=r?r.at(a)||"":d;if(u!==e||null===c){u=e,null!==c&&(f&&c.addPoints1Point(m,p),g&&c.addPoints2Point(m,_));const t=n.get(e)||new o;c=t.newItem()||new l,t.push(c),n.set(e,t)}f&&c.addPoints1Point(m,p),g&&c.addPoints2Point(m,_)}else this._fillGaps||(u=null,c=null)}return n.delete(""),n}}},90542:(e,t,i)=>{"use strict";i.d(t,{AreaBackgroundPaneView:()=>n});var r=i(84162),s=i(57778);class n extends s.AbstractFilledAreaPaneView{constructor(e,t){super(e,t)}_plotAId(){return this._source.properties().area[0].name.value()}_plotBId(){return this._source.properties().area[1].name.value()}_color(){
return this._source.properties().areaBackground.backgroundColor.value()}_transparency(){const e=this._source.properties().areaBackground.transparency.value();return(0,r.clamp)(e,0,100)}_visible(){return this._source.properties().areaBackground.fillBackground.value()}_getColorByPlotValue(e){return this._color()}_isPerBarColoringSupported(){return!1}}},61383:(e,t,i)=>{"use strict";i.d(t,{financialPeriodToString:()=>s,financialPeriodToShortString:()=>n});var r=i(16282);i(20220);function s(e){switch(e){case"FQ":return window.t("Quarterly");case"FY":return window.t("Annual");case"TTM":return window.t("TTM")}(0,r.ensureNever)(e)}function n(e){switch(e){case"FQ":return window.t("FQ");case"FY":return window.t("FY");case"TTM":return window.t("TTM")}(0,r.ensureNever)(e)}},75196:(e,t,i)=>{"use strict";i.d(t,{Fundamental:()=>p});i(20220);var r=i(14127),s=i(61383),n=i(61632);class o extends n.StudyPriceAxisView{constructor(e,t){super(e,t),this._fundamental=e}_showPaneLabel(){return this._model.properties().scalesProperties.showFundamentalNameLabel.value()}_showAxisLabel(){return this._model.properties().scalesProperties.showFundamentalLastValue.value()}_updatePaneRendererData(e){e.text="",this._showPaneLabel()&&(e.text=this._fundamental.labelTitle(),e.visible=!0)}}var a=i(78539);class l extends a.StudyPriceLineAxisView{constructor(e,t){super(e,t),this._model=e.model()}_isVisible(){return this._model.properties().scalesProperties.showFundamentalLastValue.value()&&this._study.properties().styles[this._plotname].trackPrice.value()}}var c=i(56885),u=i(72305);const d=window.t("This fundamental metric is not available for this symbol");class h extends c.StudyStatusProvider{sourceStatusText(){const e=this._source.status();return e.type===u.StudyStatusType.Error&&0===e.errorDescription.error.indexOf("resolve_error ")?d:super.sourceStatusText()}}class p extends r.Study{labelTitle(){return this.title(!0)}createPriceAxisView(e){return new o(this,{plotIndex:e})}createPriceLineAxisView(e){return new l(this,e)}hasStateForAlert(){return!1}titleInParts(e,t,i,r){return[this._title(!!e)]}statusProvider(e){return new h(this,this._model.properties().scalesProperties.textColor)}_title(e){const t=this.metaInfo();let i;if(i=e?t.shortDescription:t.description,void 0!==t.financialPeriod){const r=e?(0,s.financialPeriodToShortString)(t.financialPeriod):(0,s.financialPeriodToString)(t.financialPeriod);i=`${window.t(i,{context:"study"})} · ${r}`}const r=this._titleInputs(!0);return r.length>0&&(i=`${window.t(r[0],{context:"study"})} · ${i}`),i}_titleInputsOptions(e,t){return{...super._titleInputsOptions(e,t),skipOptionalEmptySymbolInputs:!0,allowedInputTypes:["symbol"]}}}},17205:(e,t,i)=>{"use strict";function r(e,t,i){let r=e[`${t}#${i}`]||null;return null===r&&(r=e[t]||null),null===r&&Object.keys(e).forEach(i=>{null===r&&i.startsWith(t+"#")&&(r=e[i]||null)}),r}i.d(t,{getObsoleteIdeaSymbolInfo:()=>r})},49053:(e,t,i)=>{"use strict";i.d(t,{materializeBackground:()=>o,dematerializeBackground:()=>a});var r=i(16282),s=i(41657),n=i(84101);function o(e,t){
if(e.start>=t.length||e.stop>=t.length)return null;const i=t[e.start],n=t[e.stop];return n===s.INVALID_TIME_POINT_INDEX?null:((0,r.assert)(i===s.INVALID_TIME_POINT_INDEX||i<=n,"start should not exceed stop"),{start:i===s.INVALID_TIME_POINT_INDEX?null:i,stop:n})}function a(e,t,i){return{id:t,start:(0,n.ensureTimePointIndexIndex)(i.indexOf(null!==e.start?e.start:s.INVALID_TIME_POINT_INDEX)),stop:(0,n.ensureTimePointIndexIndex)(i.indexOf(e.stop))}}},57123:(e,t,i)=>{"use strict";i.d(t,{DwgBoxStyle:()=>r,DwgBoxExtend:()=>s,mergeDwgBoxExtend:()=>l,materializeDwgBox:()=>c,dematerializeDwgBox:()=>u});var r,s,n,o=i(41657),a=i(84101);function l(e,t){return e===s.None?t:t===s.None?e:e===s.Both||t===s.Both?s.Both:e===t?t:s.Both}function c(e,t){var i;if(e.x1>=t.length||e.x2>=t.length||null===e.y1||null===e.y2)return null;let r=t[e.x1],s=t[e.x2];return r===o.INVALID_TIME_POINT_INDEX&&(r=null),s===o.INVALID_TIME_POINT_INDEX&&(s=null),{left:r,right:s,top:e.y1,bottom:e.y2,borderColorIndex:e.c,backgroundColorIndex:e.bc,extend:e.ex,borderStyle:e.st,borderWidth:e.w,text:e.t,wordWrap:e.tw,horizontalTextAlignment:e.tha,verticalTextAlignment:e.tva,fontSize:e.ts,textColorIndex:null!==(i=e.tc)&&void 0!==i?i:null}}function u(e,t,i){var r,s;return{id:t,x1:(0,a.ensureTimePointIndexIndex)(i.indexOf(null!==(r=e.left)&&void 0!==r?r:o.INVALID_TIME_POINT_INDEX)),x2:(0,a.ensureTimePointIndexIndex)(i.indexOf(null!==(s=e.right)&&void 0!==s?s:o.INVALID_TIME_POINT_INDEX)),y1:e.top,y2:e.bottom,c:e.borderColorIndex,bc:e.backgroundColorIndex,ex:e.extend,st:e.borderStyle,w:e.borderWidth,t:e.text,tw:e.wordWrap,tha:e.horizontalTextAlignment,tva:e.verticalTextAlignment,ts:e.fontSize,tc:e.textColorIndex}}!function(e){e.Solid="sol",e.Dotted="dot",e.Dashed="dsh",e.LeftArrow="al",e.RightArrow="ar",e.BothArrow="ab"}(r||(r={})),function(e){e.None="n",e.Left="l",e.Right="r",e.Both="b"}(s||(s={})),function(e){e.Top="top",e.Center="center",e.Bottom="bottom"}(n||(n={}))},66726:(e,t,i)=>{"use strict";i.d(t,{DwgLabelPaneViewConstants:()=>r,calculateLabelHeight:()=>o,calculateDwgLabelsMargins:()=>a});var r,s=i(55782),n=i(66769);function o(e,t,i){let r=i;switch(t){case s.PlotSymbolSize.Tiny:r=.6*e;break;case s.PlotSymbolSize.Small:r=.8*e;break;case s.PlotSymbolSize.Normal:r=e;break;case s.PlotSymbolSize.Large:r=1.5*e;break;case s.PlotSymbolSize.Huge:r=2*e}return r}function a(e,t,i){const s=e.model().timeScale().barSpacing(),a=Math.round(s*r.AUTO_SIZE_MULT),l=o(r.NORMAL_SIZE,t.size,a)*r.SHAPE_HEIGHT_MULT;switch(t.style){case n.DwgLabelStyle.LabelUp:case n.DwgLabelStyle.LabelLeftUp:case n.DwgLabelStyle.LabelRightUp:return{bottomPixelMargin:l,topPixelMargin:0};case n.DwgLabelStyle.LabelDown:case n.DwgLabelStyle.LabelLeftDown:case n.DwgLabelStyle.LabelRightDown:return{bottomPixelMargin:0,topPixelMargin:l};case n.DwgLabelStyle.LabelLeft:case n.DwgLabelStyle.LabelRight:case n.DwgLabelStyle.LabelCenter:return{bottomPixelMargin:.5*l,topPixelMargin:.5*l}}return{bottomPixelMargin:0,topPixelMargin:0}}!function(e){e.NORMAL_SIZE=50,e.AUTO_SIZE_MULT=1,e.SHAPE_HEIGHT_MULT=.5,
e.SHAPE_WIDTH_MULT=.6,e.FONT_SIZE_MULT=.24}(r||(r={}))},66769:(e,t,i)=>{"use strict";i.d(t,{DwgLabelTextAlign:()=>r,DwgLabelYloc:()=>s,DwgLabelStyle:()=>n,materializeDwgLabel:()=>l,dematerializeDwgLabel:()=>c});var r,s,n,o=i(41657),a=i(84101);function l(e,t){if(e.x>=t.length)return null;const i=t[e.x];return i===o.INVALID_TIME_POINT_INDEX?null:{x:i,y:e.y,yloc:e.yl,text:e.t,style:e.st,size:e.sz,colorIndex:e.ci,textColorIndex:e.tci,textAlign:e.ta||r.Center,tooltip:e.tt||""}}function c(e,t,i){return{id:t,x:(0,a.ensureTimePointIndexIndex)(i.indexOf(e.x)),y:e.y,yl:e.yloc,t:e.text,st:e.style,sz:e.size,ci:e.colorIndex,tci:e.textColorIndex,ta:e.textAlign,tt:e.tooltip}}!function(e){e.Left="left",e.Center="center",e.Right="right"}(r||(r={})),function(e){e.AboveBar="ab",e.BelowBar="bl",e.Price="pr",e.Auto="auto"}(s||(s={})),function(e){e.Xcross="xcr",e.Cross="cr",e.Triangleup="tup",e.Triangledown="tdn",e.Flag="flg",e.Circle="cir",e.Arrowup="aup",e.Arrowdown="adn",e.LabelUp="lup",e.LabelDown="ldn",e.LabelLeft="llf",e.LabelRight="lrg",e.LabelCenter="lcn",e.LabelLeftUp="luplf",e.LabelLeftDown="llwlf",e.LabelRightUp="luprg",e.LabelRightDown="llwrg",e.Square="sq",e.Diamond="dia",e.None="n"}(n||(n={}))},71855:(e,t,i)=>{"use strict";function r(e){return{id:e.id,line1:e.line1,line2:e.line2,colorIndex:e.ci}}function s(e,t){return{id:t,line1:e.line1,line2:e.line2,ci:e.colorIndex}}i.d(t,{materializeDwgLineFill:()=>r,dematerializeDwgLineFill:()=>s})},55401:(e,t,i)=>{"use strict";i.d(t,{DwgLineExtend:()=>s,mergeDwgLineExtend:()=>a,materializeDwgLine:()=>l,dematerializeDwgLine:()=>c,getDwgLineDrawPattern:()=>d});var r,s,n=i(41657),o=i(84101);function a(e,t){return e===s.None?t:t===s.None?e:e===s.Both||t===s.Both?s.Both:e===t?t:s.Both}function l(e,t){if(e.x1>=t.length||e.x2>=t.length||null===e.y1||null===e.y2)return null;let i=t[e.x1],r=t[e.x2];return i===n.INVALID_TIME_POINT_INDEX&&(i=null),r===n.INVALID_TIME_POINT_INDEX&&(r=null),null!==i&&null!==r||e.y1===e.y2?{id:e.id,x1:i,y1:e.y1,x2:r,y2:e.y2,style:e.st,extend:e.ex,width:e.w,colorIndex:e.ci}:null}function c(e,t,i){var r,s;const a=(0,o.ensureTimePointIndexIndex)(i.indexOf(null!==(r=e.x1)&&void 0!==r?r:n.INVALID_TIME_POINT_INDEX)),l=(0,o.ensureTimePointIndexIndex)(i.indexOf(null!==(s=e.x2)&&void 0!==s?s:n.INVALID_TIME_POINT_INDEX));return{id:t,x1:a,y1:e.y1,x2:l,y2:e.y2,st:e.style,ex:e.extend,w:e.width,ci:e.colorIndex}}!function(e){e.Solid="sol",e.Dotted="dot",e.Dashed="dsh",e.LeftArrow="al",e.RightArrow="ar",e.BothArrow="ab"}(r||(r={})),function(e){e.None="n",e.Left="l",e.Right="r",e.Both="b"}(s||(s={}));const u=new Map([[r.Solid,{dashPattern:[],drawLeftArrow:!1,drawRightArrow:!1}],[r.Dashed,{dashPattern:[5,6],drawLeftArrow:!1,drawRightArrow:!1}],[r.Dotted,{dashPattern:[1,2],drawLeftArrow:!1,drawRightArrow:!1}],[r.LeftArrow,{dashPattern:[],drawLeftArrow:!0,drawRightArrow:!1}],[r.RightArrow,{dashPattern:[],drawLeftArrow:!1,drawRightArrow:!0}],[r.BothArrow,{dashPattern:[],drawLeftArrow:!0,drawRightArrow:!0}]]);function d(e){return u.get(e)}},13472:(e,t,i)=>{"use strict";var r
;function s(e,t){return{id:e.id,position:e.pos,rows:e.rows,columns:e.cols,backgroundColorIndex:e.bgc,frameColorIndex:e.frmc,frameWidth:e.frmw,borderColorIndex:e.brdc,borderWidth:e.brdw}}function n(e,t,i){return{id:t,pos:e.position,rows:e.rows,cols:e.columns,bgc:e.backgroundColorIndex,frmc:e.frameColorIndex,frmw:e.frameWidth,brdc:e.borderColorIndex,brdw:e.borderWidth}}function o(e,t){return{tableId:e.tid,row:e.row,column:e.col,widthInPercentsOfPaneWidth:e.w,heightInPercentOfPaneHeight:e.h,text:e.t,textColorIndex:e.tc,horizontalTextAlignment:e.tha,verticalTextAlignment:e.tva,fontSize:e.ts,backgroundColorIndex:e.bgc}}function a(e,t,i){return{id:t,tid:e.tableId,row:e.row,col:e.column,w:e.widthInPercentsOfPaneWidth,h:e.heightInPercentOfPaneHeight,t:e.text,tc:e.textColorIndex,tha:e.horizontalTextAlignment,tva:e.verticalTextAlignment,ts:e.fontSize,bgc:e.backgroundColorIndex}}i.d(t,{materializeDwgTable:()=>s,dematerializeDwgTable:()=>n,materializeDwgTableCell:()=>o,dematerializeDwgTableCell:()=>a}),function(e){e.Top="top",e.Center="center",e.Bottom="bottom"}(r||(r={}))},67642:(e,t,i)=>{"use strict";i.r(t),i.d(t,{LiveStudyGraphics:()=>o.LiveStudyGraphics,StaticStudyGraphics:()=>n.StaticStudyGraphics,createGraphicsPaneViews:()=>h,createGraphicsPriceAxisViews:()=>_,emptyStudyGraphics:()=>n.emptyStudyGraphics,isStudyGraphicsEmpty:()=>s.isStudyGraphicsEmpty,loadStudyGraphics:()=>n.loadStudyGraphics,saveStudyGraphics:()=>n.saveStudyGraphics});var r=i(87380),s=i(94823),n=i(63091),o=i(85192),a=i(32552);class l extends a.PriceAxisView{constructor(e,t){super(),this._source=e,this._data=t}_updateRendererData(e,t,i){e.visible=!1;const r=this._source.priceScale(),s=this._source.properties().visible.value();if(!r||r.isEmpty()||!s)return;const n=this._source.properties().graphics[this._data.lineType][this._data.styleId];if(!(n.visible&&n.visible.value()&&n.showPrice&&n.showPrice.value()))return;const o=this._source.firstValue();if(null===o)return;const a=this._data.line.level,l=n.color.value();i.background=l,i.textColor=this.generateTextColor(l),i.coordinate=r.priceToCoordinate(a,o),e.text=r.formatPrice(a,o,!0),e.visible=!0}}const c=(0,r.getLogger)("Chart.StudyGraphics"),u=new Set(["dwgtablecells"]);async function d(e,t,r,s){switch(e){case"backgrounds":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,51097))).BackgroundPaneView)(t,r,s);case"hlines":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,88218))).LevelPaneView)(t,r,s);case"lines":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,74366))).LinePaneView)(t,r,s);case"polygons":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,70483))).PolygonPaneView)(t,r,s);case"shapemarks":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,31297))).ShapeMarkPaneView)(t,r,s);case"textmarks":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,43601))).TextMarkPaneView)(t,r,s);case"trendchannels":
return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,18230))).TrendChannelPaneView)(t,r,s);case"dwglabels":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,25372))).DwgLabelPaneView)(t,r,s);case"dwglines":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,38163))).DwgLinePaneView)(t,r,s);case"dwgboxes":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,40879))).DwgBoxPaneView)(t,r,s);case"dwgtables":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,74832))).DwgTablePaneView)(t,r,s);case"dwglinefills":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,87637))).DwgLineFillPaneView)(t,r,s)}switch(e){case"hhists":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,10419))).HHistPaneView)(t,r,s);case"horizlines":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,88625))).HorizLinePaneView)(t,r,s);case"vertlines":return new((await Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,40915))).VertLinePaneView)(t,r,s)}return null}async function h(e,t,i){const r=[],s=Object.keys(e.graphicsInfo());s.sort((e,t)=>p(e)-p(t));for(const n of s){const s=await d(n,e,t,i);null!==s?r.push(s):u.has(n)||c.logWarn(n+" is not supported by this build of graphics subsystem, skipping")}return r}function p(e){switch(e){case"polygons":return-100;case"trendchannels":return-90;default:return 0}}function _(e){const t=Object.keys(e.graphicsInfo()),i=[];for(const r of t)switch(r){case"hlines":e.graphics().hlines().forEach((t,s)=>{t.forEach(t=>{void 0!==t.level&&i.push(new l(e,{line:{level:t.level},styleId:s,lineType:r}))})});break;case"horizlines":e.graphics().horizlines().forEach((t,s)=>{t.forEach(t=>{void 0!==t.level&&i.push(new l(e,{line:{level:t.level},styleId:s,lineType:r}))})})}return i}},99924:(e,t,i)=>{"use strict";i.d(t,{HHistDirection:()=>r,HHistLocation:()=>s,materializeHHist:()=>l,dematerializeHHist:()=>c});var r,s,n=i(16282),o=i(41657),a=i(84101);function l(e,t){if(e.firstBarTime>=t.length||e.lastBarTime>=t.length)return null;const i=t[e.firstBarTime],r=t[e.lastBarTime];return i===o.INVALID_TIME_POINT_INDEX||r===o.INVALID_TIME_POINT_INDEX?null:((0,n.assert)(i<=r,"firstBarTime should not exceed lastBarTime"),(0,n.assert)(e.priceLow<=e.priceHigh,"priceLow should not exceed priceHigh"),{firstBarTime:i,lastBarTime:r,rate:e.rate,priceHigh:e.priceHigh,priceLow:e.priceLow})}function c(e,t,i){const r=(0,a.ensureTimePointIndexIndex)(i.indexOf(e.firstBarTime)),s=(0,a.ensureTimePointIndexIndex)(i.indexOf(e.lastBarTime));return{id:t,...e,firstBarTime:r,lastBarTime:s}}!function(e){e.LeftToRight="left_to_right",e.RightToLeft="right_to_left"}(r||(r={})),function(e){e.Relative="relative",e.Absolute="absolute"}(s||(s={}))},13868:(e,t,i)=>{"use strict";i.d(t,{materializeHorizLine:()=>o,dematerializeHorizLine:()=>a});var r=i(16282),s=i(41657),n=i(84101);function o(e,t){if(e.startIndex>=t.length||e.endIndex>=t.length)return null;const i=t[e.startIndex],n=t[e.endIndex]
;return i===s.INVALID_TIME_POINT_INDEX||n===s.INVALID_TIME_POINT_INDEX?null:((0,r.assert)(i<=n,"startIndex should not exceed endIndex"),{startIndex:i,endIndex:n,level:e.level,extendLeft:e.extendLeft,extendRight:e.extendRight})}function a(e,t,i){const r=(0,n.ensureTimePointIndexIndex)(i.indexOf(e.startIndex)),s=(0,n.ensureTimePointIndexIndex)(i.indexOf(e.endIndex));return{id:t,...e,startIndex:r,endIndex:s}}},79045:(e,t,i)=>{"use strict";var r;function s(e){return{level:e.level,text:e.text}}function n(e,t,i){return{id:t,...e}}i.d(t,{TextPos:()=>r,materializeLevel:()=>s,dematerializeLevel:()=>n}),function(e){e[e.TopLeft=0]="TopLeft",e[e.TopCenter=1]="TopCenter",e[e.TopRight=2]="TopRight",e[e.MiddleLeft=3]="MiddleLeft",e[e.MiddleCenter=4]="MiddleCenter",e[e.MiddleRight=5]="MiddleRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomCenter=7]="BottomCenter",e[e.BottomRight=8]="BottomRight"}(r||(r={}))},49888:(e,t,i)=>{"use strict";i.d(t,{materializeLine:()=>o,dematerializeLine:()=>a});var r=i(16282),s=i(41657),n=i(84101);function o(e,t){if(e.startIndex>=t.length||e.endIndex>=t.length)return null;const i=t[e.startIndex],n=t[e.endIndex];return i===s.INVALID_TIME_POINT_INDEX||n===s.INVALID_TIME_POINT_INDEX?null:((0,r.assert)(i<=n,"startIndex should not exceed endIndex"),{startIndex:i,endIndex:n,startOffset:e.startOffset,endOffset:e.endOffset,startPrice:e.startPrice,endPrice:e.endPrice})}function a(e,t,i){const r=(0,n.ensureTimePointIndexIndex)(i.indexOf(e.startIndex)),s=(0,n.ensureTimePointIndexIndex)(i.indexOf(e.endIndex));return{id:t,...e,startIndex:r,endIndex:s}}},85192:(e,t,i)=>{"use strict";i.d(t,{validateGraphicsCommands:()=>w,LiveStudyGraphics:()=>P});var r=i(16282),s=i(73211),n=i(99924),o=i(13868),a=i(26380),l=i(49053),c=i(66769),u=i(55401),d=i(57123),h=i(79045),p=i(49888),_=i(43615),m=i(4224),f=i(81468),g=i(32115),v=i(13472),S=i(71855),y=i(94823),b=i(63091);function w(e){if(!(0,s.isObject)(e))throw new Error("Graphics commands should be wrapped in an object");if((0,s.hasProperty)(e,"create"),(0,s.hasProperty)(e,"erase")){const t=e.erase;(0,r.assert)(Array.isArray(t),"Collection of erase commands should be array");for(const e of t){if(!(0,s.isObject)(e)||!(0,s.hasProperty)(e,"action"))throw new Error("Command should be an object with 'action' property");(0,r.assert)("all"===e.action||"one"===e.action,"Erase command action should be 'all' or 'one'")}}return e}class P{constructor(){this._indexes=[],this._horizlines=new Map,this._vertlines=new Map,this._lines=new Map,this._hlines=new Map,this._textmarks=new Map,this._shapemarks=new Map,this._backgrounds=new Map,this._polygons=new Map,this._trendchannels=new Map,this._hhists=new Map,this._dwglabels=new Map,this._dwgboxes=new Map,this._dwglines=new Map,this._dwgtables=new Map,this._dwgtablecells=new Map,this._dwglinefills=new Map,this._hhistsByTimePointIndex=new Map}horizlines(){return this._horizlines}vertlines(){return this._vertlines}lines(){return this._lines}hlines(){return this._hlines}textmarks(){return this._textmarks}shapemarks(){return this._shapemarks}backgrounds(){
return this._backgrounds}polygons(){return this._polygons}trendchannels(){return this._trendchannels}hhists(){return this._hhists}dwglabels(){return this._dwglabels}dwglines(){return this._dwglines}dwgboxes(){return this._dwgboxes}dwgtables(){return this._dwgtables}dwgtablecells(){return this._dwgtablecells}dwglinefills(){return this._dwglinefills}hhistsByTimePointIndex(){return this._hhistsByTimePointIndex}clear(){this._indexes=[],this._clearPrimitives()}extract(){const e=e=>e.extract(),t={indexes:this._indexes,horizlines:T(this._horizlines,e),vertlines:T(this._vertlines,e),lines:T(this._lines,e),hlines:T(this._hlines,e),textmarks:T(this._textmarks,e),shapemarks:T(this._shapemarks,e),backgrounds:T(this._backgrounds,e),polygons:T(this._polygons,e),trendchannels:T(this._trendchannels,e),hhists:T(this._hhists,e),dwglabels:T(this._dwglabels,e),dwglines:T(this._dwglines,e),dwgboxes:T(this._dwgboxes,e),dwgtables:T(this._dwgtables,e),dwgtablecells:T(this._dwgtablecells,e),dwglinefills:T(this._dwglinefills,e)};return this._hhistsByTimePointIndex=new Map,new b.StaticStudyGraphics("data",t)}replaceIndexesTo(e){this._indexes=e;const t=e=>e.replaceIndexesTo(this._indexes);this._horizlines.forEach(t),this._vertlines.forEach(t),this._lines.forEach(t),this._hlines.forEach(t),this._textmarks.forEach(t),this._shapemarks.forEach(t),this._backgrounds.forEach(t),this._polygons.forEach(t),this._trendchannels.forEach(t),this._hhists.forEach(t),this._dwglabels.forEach(t),this._dwgboxes.forEach(t),this._dwglines.forEach(t),this._dwgtables.forEach(t),this._dwgtablecells.forEach(t),this._dwglinefills.forEach(t),this._hhistsByTimePointIndex=(0,y.splitHHistsByTimePointIndex)(this._hhists)}processCommands(e,t){void 0!==e.erase&&this._processEraseCommands(e.erase),void 0!==e.create&&this._processCreateCommands(e.create,t)}_processCreateCommands(e,t){for(const i in e){if(!e.hasOwnProperty(i))continue;const s=i;switch((0,r.assert)(s in t,`There is a '${s}' in study response, but it doesn't present in graphics info!`),s){case"horizlines":x(this._horizlines,e[s],t[s],this._indexes,o.materializeHorizLine);break;case"vertlines":x(this._vertlines,e[s],t[s],this._indexes,a.materializeVertLine);break;case"lines":x(this._lines,e[s],t[s],this._indexes,p.materializeLine);break;case"hlines":x(this._hlines,e[s],t[s],this._indexes,h.materializeLevel);break;case"textmarks":x(this._textmarks,e[s],t[s],this._indexes,f.materializeTextMark);break;case"shapemarks":x(this._shapemarks,e[s],t[s],this._indexes,m.materializeShapeMark);break;case"backgrounds":x(this._backgrounds,e[s],t[s],this._indexes,l.materializeBackground);break;case"polygons":x(this._polygons,e[s],t[s],this._indexes,_.materializePolygon);break;case"trendchannels":x(this._trendchannels,e[s],t[s],this._indexes,g.materializeTrendChannel);break;case"hhists":x(this._hhists,e[s],t[s],this._indexes,n.materializeHHist);break;case"dwglabels":x(this._dwglabels,e[s],t[s],this._indexes,c.materializeDwgLabel);break;case"dwglines":x(this._dwglines,e[s],t[s],this._indexes,u.materializeDwgLine);break;case"dwgboxes":
x(this._dwgboxes,e[s],t[s],this._indexes,d.materializeDwgBox);break;case"dwgtables":x(this._dwgtables,e[s],t[s],this._indexes,v.materializeDwgTable);break;case"dwgtablecells":x(this._dwgtablecells,e[s],t[s],this._indexes,v.materializeDwgTableCell);break;case"dwglinefills":x(this._dwglinefills,e[s],t[s],this._indexes,S.materializeDwgLineFill)}}this._hhistsByTimePointIndex=(0,y.splitHHistsByTimePointIndex)(this._hhists)}_processEraseCommands(e){for(const t of e)if("all"===t.action)this._clearPrimitives();else{const e=e=>e.deleteById(t.id);switch(t.type){case"horizlines":this._horizlines.forEach(e);break;case"vertlines":this._vertlines.forEach(e);break;case"lines":this._lines.forEach(e);break;case"hlines":this._hlines.forEach(e);break;case"textmarks":this._textmarks.forEach(e);break;case"shapemarks":this._shapemarks.forEach(e);break;case"backgrounds":this._backgrounds.forEach(e);break;case"polygons":this._polygons.forEach(e);break;case"trendchannels":this._trendchannels.forEach(e);break;case"hhists":this._hhists.forEach(e);break;case"dwglabels":this._dwglabels.forEach(e);break;case"dwglines":this._dwglines.forEach(e);break;case"dwgboxes":this._dwgboxes.forEach(e);break;case"dwgtables":this._dwgtables.forEach(e);break;case"dwgtablecells":this._dwgtablecells.forEach(e);break;case"dwglinefills":this._dwglinefills.forEach(e)}}this._hhistsByTimePointIndex=(0,y.splitHHistsByTimePointIndex)(this._hhists)}_clearPrimitives(){this._horizlines.clear(),this._vertlines.clear(),this._lines.clear(),this._hlines.clear(),this._textmarks.clear(),this._shapemarks.clear(),this._backgrounds.clear(),this._polygons.clear(),this._trendchannels.clear(),this._hhists.clear(),this._dwglabels.clear(),this._dwgboxes.clear(),this._dwglines.clear(),this._dwgtables.clear(),this._dwgtablecells.clear(),this._dwglinefills.clear(),this._hhistsByTimePointIndex=new Map}}class C{constructor(e,t){this._primitivesDataById=new Map,this._primitiveById=new Map,this._materializePrimitive=e,this._indexes=t}forEach(e,t){this._primitiveById.forEach(i=>{e.call(t,i,i,this)})}has(e){let t=!1;return this._primitiveById.forEach(i=>{t=t||i===e}),t}get size(){return this._primitiveById.size}[Symbol.iterator](){throw new Error("Not implemented")}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}values(){throw new Error("Not implemented")}hasId(e){return this._primitiveById.has(e)}addData(e){this._primitivesDataById.set(e.id,e),this._tryMaterialize(e)}deleteById(e){this._primitiveById.delete(e),this._primitivesDataById.delete(e)}clear(){this._primitivesDataById.clear(),this._primitiveById.clear()}replaceIndexesTo(e){this._indexes=e,this._primitiveById.clear(),this._primitivesDataById.forEach(this._tryMaterialize,this)}extract(){const e=new Set(this._primitivesDataById.values());return this._primitivesDataById=new Map,this._primitiveById.clear(),e}_tryMaterialize(e){const t=this._materializePrimitive(e,this._indexes);null!==t&&((0,r.assert)(!this._primitiveById.has(e.id),"primitive with specified id should not exist"),
this._primitiveById.set(e.id,t))}}function T(e,t){const i=new Map;return e.forEach((e,r)=>i.set(r,t(e))),i}function x(e,t,i,s,n){if(void 0!==t)for(const o of t){const t=o.styleId;void 0!==i&&(0,r.assert)(t in i,"Every style used by graphics primitive should be declared in study metainfo");let a=e.get(t);void 0===a&&(a=new C(n,s),e.set(t,a)),o.data.forEach(a.addData.bind(a))}}},43615:(e,t,i)=>{"use strict";i.d(t,{materializePolygon:()=>n,dematerializePolygon:()=>o});var r=i(41657),s=i(84101);function n(e,t){for(const i of e.points){if(i.index>=t.length)return null;if(t[i.index]===r.INVALID_TIME_POINT_INDEX)return null}return{points:e.points.map(e=>({index:t[e.index],offset:e.offset,level:e.level}))}}function o(e,t,i){return{id:t,points:e.points.map(e=>({...e,index:(0,s.ensureTimePointIndexIndex)(i.indexOf(e.index))}))}}},4224:(e,t,i)=>{"use strict";i.d(t,{materializeShapeMark:()=>o,dematerializeShapeMark:()=>a});var r,s=i(41657),n=i(84101);function o(e,t){if(e.time>=t.length)return null;const i=t[e.time];return i===s.INVALID_TIME_POINT_INDEX?null:{time:i,price:e.price}}function a(e,t,i){const r=(0,n.ensureTimePointIndexIndex)(i.indexOf(e.time));return{id:t,...e,time:r}}!function(e){e.Circle="circle",e.ArrowUp="arrowUp",e.ArrowDown="arrowDown",e.ArrowRight="arrowRight",e.ArrowLeft="arrowLeft",e.Square="square"}(r||(r={}))},63091:(e,t,i)=>{"use strict";i.d(t,{StaticStudyGraphics:()=>y,emptyStudyGraphics:()=>C,loadStudyGraphics:()=>T,saveStudyGraphics:()=>x});var r=i(41657),s=i(13868),n=i(26380),o=i(49053),a=i(99924),l=i(79045),c=i(49888),u=i(43615),d=i(4224),h=i(81468),p=i(32115),_=i(66769),m=i(55401),f=i(57123),g=i(13472),v=i(71855),S=i(94823);class y{constructor(e,t){if(this._indexes=[],this._horizlines=new Map,this._vertlines=new Map,this._lines=new Map,this._hlines=new Map,this._textmarks=new Map,this._shapemarks=new Map,this._backgrounds=new Map,this._polygons=new Map,this._trendchannels=new Map,this._hhists=new Map,this._dwglabels=new Map,this._dwglines=new Map,this._dwgboxes=new Map,this._dwgtables=new Map,this._dwgtablecells=new Map,this._dwglinefills=new Map,"data"===e){const e=t;this._indexes=e.indexes,this._vertlines=b(e.vertlines,this._indexes,n.materializeVertLine),this._horizlines=b(e.horizlines,this._indexes,s.materializeHorizLine),this._lines=b(e.lines,this._indexes,c.materializeLine),this._hlines=b(e.hlines,this._indexes,l.materializeLevel),this._textmarks=b(e.textmarks,this._indexes,h.materializeTextMark),this._shapemarks=b(e.shapemarks,this._indexes,d.materializeShapeMark),this._backgrounds=b(e.backgrounds,this._indexes,o.materializeBackground),this._polygons=b(e.polygons,this._indexes,u.materializePolygon),this._trendchannels=b(e.trendchannels,this._indexes,p.materializeTrendChannel),this._hhists=b(e.hhists,this._indexes,a.materializeHHist),this._dwglabels=b(e.dwglabels,this._indexes,_.materializeDwgLabel),this._dwglines=b(e.dwglines,this._indexes,m.materializeDwgLine),this._dwgboxes=b(e.dwgboxes,this._indexes,f.materializeDwgBox),this._dwgtables=b(e.dwgtables,this._indexes,g.materializeDwgTable),
this._dwgtablecells=b(e.dwgtablecells,this._indexes,g.materializeDwgTableCell),this._dwglinefills=b(e.dwglinefills,this._indexes,v.materializeDwgLineFill)}else if("state"===e){const e=t;this._indexes=e.indexes||[],this._vertlines=w(e.vertlines,this._indexes,n.materializeVertLine),this._horizlines=w(e.horizlines,this._indexes,s.materializeHorizLine),this._lines=w(e.lines,this._indexes,c.materializeLine),this._hlines=w(e.hlines,this._indexes,l.materializeLevel),this._textmarks=w(e.textmarks,this._indexes,h.materializeTextMark),this._shapemarks=w(e.shapemarks,this._indexes,d.materializeShapeMark),this._backgrounds=w(e.backgrounds,this._indexes,o.materializeBackground),this._polygons=w(e.polygons,this._indexes,u.materializePolygon),this._trendchannels=w(e.trendchannels,this._indexes,p.materializeTrendChannel),this._hhists=w(e.hhists,this._indexes,a.materializeHHist),this._dwglabels=w(e.dwglabels,this._indexes,_.materializeDwgLabel),this._dwglines=w(e.dwglines,this._indexes,m.materializeDwgLine),this._dwgboxes=w(e.dwgboxes,this._indexes,f.materializeDwgBox),this._dwgtables=w(e.dwgtables,this._indexes,g.materializeDwgTable),this._dwgtablecells=w(e.dwgtablecells,this._indexes,g.materializeDwgTableCell),this._dwglinefills=w(e.dwglinefills,this._indexes,v.materializeDwgLineFill)}this._hhistsByTimePointIndex=(0,S.splitHHistsByTimePointIndex)(this._hhists)}horizlines(){return this._horizlines}vertlines(){return this._vertlines}lines(){return this._lines}hlines(){return this._hlines}textmarks(){return this._textmarks}shapemarks(){return this._shapemarks}backgrounds(){return this._backgrounds}polygons(){return this._polygons}trendchannels(){return this._trendchannels}hhists(){return this._hhists}dwglabels(){return this._dwglabels}dwglines(){return this._dwglines}dwgboxes(){return this._dwgboxes}dwgtables(){return this._dwgtables}dwgtablecells(){return this._dwgtablecells}dwglinefills(){return this._dwglinefills}hhistsByTimePointIndex(){return this._hhistsByTimePointIndex}}function b(e,t,i){const r=new Map;return e.forEach((e,s)=>{const n=r.get(s)||new Set;e.forEach(e=>{const r=i(e,t);null!==r&&n.add(r)}),r.set(s,n)}),r}function w(e,t,i){const r=new Map;if(void 0===e)return r;for(const s of e){const e=s.styleId,n=r.get(e)||new Set;s.data.forEach(e=>{const r=i(e,t);null!==r&&n.add(r)}),r.set(e,n)}return r}function P(e,t,i,r){const s=[];return e.forEach((e,n)=>{e.forEach(e=>{!function(e,t,i){let r=null;for(const i of e)i.styleId===t&&(r=i);null===r&&(r={styleId:t,data:[]},e.push(r)),r.data.push(i)}(s,n,r(e,t(e),i))})}),s.length>0?s:void 0}function C(){return new y}function T(e){return new y("state",e)}function x(e){const t=function(e){const t=new Set;e.horizlines().forEach((e,i)=>{e.forEach(e=>{t.add(e.startIndex),t.add(e.endIndex)})}),e.vertlines().forEach((e,i)=>{e.forEach(e=>{t.add(e.index)})}),e.lines().forEach((e,i)=>{e.forEach(e=>{t.add(e.startIndex),t.add(e.endIndex)})}),e.textmarks().forEach((e,i)=>{e.forEach(e=>{t.add(e.time)})}),e.shapemarks().forEach((e,i)=>{e.forEach(e=>{t.add(e.time)})}),e.backgrounds().forEach((e,i)=>{
e.forEach(e=>{t.add(null!==e.start?e.start:r.INVALID_TIME_POINT_INDEX),t.add(e.stop)})}),e.polygons().forEach((e,i)=>{e.forEach(e=>{e.points.forEach(e=>{t.add(e.index)})})}),e.trendchannels().forEach((e,i)=>{e.forEach(e=>{t.add(e.startIndex),t.add(e.endIndex)})}),e.hhists().forEach((e,i)=>{e.forEach(e=>{t.add(e.firstBarTime),t.add(e.lastBarTime)})}),e.dwglabels().forEach((e,i)=>{e.forEach(e=>{t.add(e.x)})}),e.dwglines().forEach((e,i)=>{e.forEach(e=>{var i,s;t.add(null!==(i=e.x1)&&void 0!==i?i:r.INVALID_TIME_POINT_INDEX),t.add(null!==(s=e.x2)&&void 0!==s?s:r.INVALID_TIME_POINT_INDEX)})}),e.dwgboxes().forEach((e,i)=>{e.forEach(e=>{var i,s;t.add(null!==(i=e.left)&&void 0!==i?i:r.INVALID_TIME_POINT_INDEX),t.add(null!==(s=e.right)&&void 0!==s?s:r.INVALID_TIME_POINT_INDEX)})});const i=Array.from(t);return i.sort((e,t)=>e-t),i}(e),i={indexes:t};let S=0;const y=()=>++S,b=e=>e.id,w=e=>e.id;return i.vertlines=P(e.vertlines(),y,t,n.dematerializeVertLine),i.horizlines=P(e.horizlines(),y,t,s.dematerializeHorizLine),i.lines=P(e.lines(),y,t,c.dematerializeLine),i.hlines=P(e.hlines(),y,t,l.dematerializeLevel),i.textmarks=P(e.textmarks(),y,t,h.dematerializeTextMark),i.shapemarks=P(e.shapemarks(),y,t,d.dematerializeShapeMark),i.backgrounds=P(e.backgrounds(),y,t,o.dematerializeBackground),i.polygons=P(e.polygons(),y,t,u.dematerializePolygon),i.trendchannels=P(e.trendchannels(),y,t,p.dematerializeTrendChannel),i.hhists=P(e.hhists(),y,t,a.dematerializeHHist),i.dwglabels=P(e.dwglabels(),y,t,_.dematerializeDwgLabel),i.dwglines=P(e.dwglines(),w,t,m.dematerializeDwgLine),i.dwgboxes=P(e.dwgboxes(),y,t,f.dematerializeDwgBox),i.dwgtables=P(e.dwgtables(),b,t,g.dematerializeDwgTable),i.dwgtablecells=P(e.dwgtablecells(),y,t,g.dematerializeDwgTableCell),i.dwglinefills=P(e.dwglinefills(),y,t,v.dematerializeDwgLineFill),i}},69647:(e,t,i)=>{"use strict";var r,s,n,o;i.d(t,{MarkLocation:()=>r,HAlign:()=>s,LineStyle:()=>o}),function(e){e.AboveBar="AboveBar",e.BelowBar="BelowBar",e.Top="Top",e.Bottom="Bottom",e.Right="Right",e.Left="Left",e.Absolute="Absolute",e.AbsoluteUp="AbsoluteUp",e.AbsoluteDown="AbsoluteDown"}(r||(r={})),function(e){e.Left="left",e.Center="center",e.Right="right"}(s||(s={})),function(e){e.Top="top",e.Middle="middle",e.Bottom="bottom"}(n||(n={})),function(e){e[e.Solid=0]="Solid",e[e.Dotted=1]="Dotted",e[e.Dashed=2]="Dashed"}(o||(o={}))},94823:(e,t,i)=>{"use strict";i.d(t,{isStudyGraphicsEmpty:()=>s,splitHHistsByTimePointIndex:()=>n});const r=["horizlines","vertlines","lines","hlines","textmarks","shapemarks","backgrounds","polygons","trendchannels","hhists","dwglabels","dwglines","dwgboxes","dwgtables","dwgtablecells","dwglinefills"];function s(e){return!r.some(t=>e[t]().size>0)}function n(e){const t=new Map;return e.forEach((e,i)=>{e.forEach(e=>{const r={...e,styleId:i},s=e.firstBarTime;let n=t.get(s);void 0===n&&(n=new Set,t.set(s,n)),n.add(r)})}),t}},81468:(e,t,i)=>{"use strict";i.d(t,{TextMarkType:()=>r,materializeTextMark:()=>a,dematerializeTextMark:()=>l});var r,s,n=i(41657),o=i(84101);function a(e,t){
if(e.time>=t.length)return null;const i=t[e.time];return i===n.INVALID_TIME_POINT_INDEX?null:{time:i,offset:e.offset,text:e.text,price:e.price}}function l(e,t,i){const r=(0,o.ensureTimePointIndexIndex)(i.indexOf(e.time));return{id:t,...e,time:r}}!function(e){e.Triangle="triangle",e.Rectangle="rectangle"}(r||(r={})),function(e){e.Verdana="Verdana",e.CourierNew="Courier New",e.TimesNewRoman="Times New Roman",e.Arial="Arial"}(s||(s={}))},32115:(e,t,i)=>{"use strict";i.d(t,{materializeTrendChannel:()=>o,dematerializeTrendChannel:()=>a});var r=i(16282),s=i(41657),n=i(84101);function o(e,t){if(e.startIndex>=t.length||e.endIndex>=t.length)return null;const i=t[e.startIndex],n=t[e.endIndex];return i===s.INVALID_TIME_POINT_INDEX||n===s.INVALID_TIME_POINT_INDEX?null:((0,r.assert)(i<=n,"startIndex should not exceed endIndex"),{startIndex:i,endIndex:n,extendLeft:e.extendLeft,extendRight:e.extendRight,startHighPrice:e.startHighPrice,startLowPrice:e.startLowPrice,endHighPrice:e.endHighPrice,transparency:e.transparency})}function a(e,t,i){const r=(0,n.ensureTimePointIndexIndex)(i.indexOf(e.startIndex)),s=(0,n.ensureTimePointIndexIndex)(i.indexOf(e.endIndex));return{id:t,...e,startIndex:r,endIndex:s}}},26380:(e,t,i)=>{"use strict";i.d(t,{materializeVertLine:()=>n,dematerializeVertLine:()=>o});var r=i(41657),s=i(84101);function n(e,t){if(e.index>=t.length)return null;const i=t[e.index];return i===r.INVALID_TIME_POINT_INDEX?null:{startPrice:e.startPrice,endPrice:e.endPrice,index:i,extendTop:e.extendTop,extendBottom:e.extendBottom}}function o(e,t,i){const r=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.index));return{id:t,...e,index:r}}},3898:(e,t,i)=>{"use strict";var r;i.d(t,{InsertionErrorCode:()=>r}),function(e){e.StudyCannotBeChild="cannot_be_child",e.StubWasRemoved="stub_was_removed",e.CannotGetMetainfo="cannot_get_metainfo",e.Cancelled="cancelled",e.Unknown="unknown"}(r||(r={}))},30805:(e,t,i)=>{"use strict";i.d(t,{makeNextSymbolId:()=>s,makeNextStudyId:()=>o});let r=0;function s(){return r++,"ss_"+r}let n=0;function o(){return n++,"st"+n}},74845:(e,t,i)=>{"use strict";i.d(t,{migrateMetaInfoAndPropState:()=>l});var r=i(16282),s=i(84234),n=i.n(s),o=i(31565);const a=[new class{targetMetaInfoVersion(){return 47}migrateMetaInfo(e){const t=e,i=e;if(i._metainfoVersion=47,!t.defaults||void 0===t.defaults.precision)return void(i.format={type:"inherit"});const r=t.defaults&&t.defaults.precision,s=(0,o.isNumber)(r)?r:parseInt(r);0===s?i.format={type:"volume"}:isFinite(s)?i.format={type:"price",precision:s}:i.format={type:"inherit"},delete t.defaults.precision}migratePropState(e){}},new class{targetMetaInfoVersion(){return 50}migrateMetaInfo(e){const t=e,i=e;if(i._metainfoVersion=50,void 0===t.defaults||void 0===t.defaults.ohlcPlots||void 0===t.ohlcPlots)return;const s=t.ohlcPlots,n=t.defaults.ohlcPlots,o=(0,r.ensureDefined)((0,r.ensureDefined)(i.defaults).ohlcPlots);for(const e of Object.keys(n)){const t=n[e];if("ohlc_candles"===t.plottype){let i=!1;const r=s[e];void 0!==r&&(i=!!r.drawBorder,delete r.drawBorder),o[e]={borderColor:"#000000",
drawBorder:i,...t}}}}migratePropState(e){}}];function l(e,t){const i=n().versionOf(e),s=e;void 0===s._serverMetaInfoVersion&&(s._serverMetaInfoVersion=i),a.forEach(s=>{i<0||i>=s.targetMetaInfoVersion()||(s.migrateMetaInfo(e),void 0!==t&&s.migratePropState(t),(0,r.assert)(e._metainfoVersion===s.targetMetaInfoVersion()))})}a.sort((function(e,t){return e.targetMetaInfoVersion()-t.targetMetaInfoVersion()}))},24322:(e,t,i)=>{"use strict";i.d(t,{NonSeriesStudy:()=>n});var r=i(16282),s=i(14127);class n extends s.Study{clearData(){this._customData=null,this._indexes=null}restoreData(e,t,i){s.Study.prototype.restoreData.call(this,e),this._customData=t,this._indexes=i}state(e){const t=super.state(e);return e&&(t.nonSeriesData=this._customData,t.indexes=this._indexes),t}customData(){return this._customData}_setPaneViews(e){this._paneViews=e,this.model().lightUpdate()}_onDataUpdated(e,t,i){null!==t&&(t.indexes_replace?((0,r.assert)("nochange"!==i),this._indexes=i):(this._customData=t.data,"nochange"!==i&&(this._indexes=i))),super._onDataUpdated(e,t,i)}}},52950:(e,t,i)=>{"use strict";i.d(t,{OverlayDataWindowView:()=>u});var r=i(75496),s=i(51424),n=i(68724),o=i(32719),a=i(14397),l=i(36367);const c=n.CheckMobile.any();class u extends s.DataWindowView{constructor(e,t){super(),this._invalidated=!0,this._study=e,this._model=t,this._valueProvider=this._createValuesProvider(e,t),this._items=this._valueProvider.getItems().map(e=>new s.DataWindowItem(e.title,"")),this.update()}items(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._items}update(){this._invalidated=!0}study(){return this._study}_updateImpl(){this._header=this._study.title();let e;this._showLastPriceAndChangeOnly()?e=this._study.data().lastIndex():(e=this._model.crossHairSource().appliedIndex(),(0,r.isNumber)(e)||(e=this._study.data().lastIndex()));const t=this._valueProvider.getValues(e);for(let e=0;e<t.length;++e){const i=t[e],r=this._items[e];r.setValue(i.value),r.setVisible(i.visible),r.setColor(i.color)}}_showLastPriceAndChangeOnly(){return c&&(null===this._model.crossHairSource().pane||(0,o.isLineToolName)(a.tool.value())||null!==this._model.lineBeingEdited())}_createValuesProvider(e,t){return new l.StudyLegendValuesProvider(e,t)}}},39755:(e,t,i)=>{"use strict";i.d(t,{OverlayLegendValuesProvider:()=>w});var r=i(20554),s=i(75496),n=i(20220),o=i(68724),a=i(50946),l=i(82755),c=i(14704),u=i(31741),d=i(40989),h=i(87048),p=i(14397),_=i(26587),m=i(66786),f=i(11403);const g=o.CheckMobile.any(),v=g&&!1,S=new c.PercentageFormatter,y=(0,n.t)("n/a"),b=`${y} (${y}%)`;class w extends class{constructor(e,t){this._study=e,this._model=t,this._emptyValues=[{title:(0,n.t)("Open"),visible:!1,value:"",index:0,id:""},{title:(0,n.t)("High"),visible:!1,value:"",index:1,id:""},{title:(0,n.t)("Low"),visible:!1,value:"",index:2,id:""},{title:(0,n.t)("Close"),visible:!1,value:"",index:3,id:""},{title:"",visible:!1,value:"",index:4,id:""},{title:"",visible:!1,value:"",index:5,id:""},{title:(0,n.t)("Change"),visible:!1,value:"",index:6,id:""}]}getItems(){
return this._emptyValues}getValues(e){const t=this._emptyValues.map(e=>({...e}));if(this._model.timeScale().isEmpty())return t;if(0===this._study.data().size())return t;const i=this._showLastPriceAndChangeOnly();if((0,s.isNumber)(e)||(i?e=this._study.data().lastIndex():(e=this._model.crossHairSource().appliedIndex(),(0,s.isNumber)(e)||(e=this._study.data().lastIndex()))),null===e||!(0,s.isNumber)(e))return t;const r=this._study.data().search(e,d.PlotRowSearchMode.NearestLeft,1),n=(0,u.paneBackgroundColor)(this._model.paneForSource(this._study));if(null===r||null===n)return t;const o=r.index,c=r.value,h=c[1],p=c[2],_=c[3],g=c[4];if(null==h||null==p||null==_||null==g)return t;t[0].value=y,t[1].value=y,t[2].value=y,t[3].value=y,t[6].value=b;for(const e of t)e.visible=!i;const w=t[4];w.visible=!1;const{values:P}=this._changesData(g,h,o,i),C=(0,f.getPriceValueFormatterForSource)(this._study);if((0,f.shouldBeFormattedAsPercent)(this._study))t[6].value="";else if(void 0!==P){const e=this._study.formatter();t[6].value=(0,l.forceLTRStr)(`${e.format(P.change,!0)} (${S.format(P.percentChange,!0)})`)}i?(t[5].value=C(g),t[5].visible=!0,t[6].visible=!0):(t[0].value=C(h),t[1].value=C(p),t[2].value=C(_),t[3].value=C(g),w.value=C(this._study.barFunction()(c)),t[5].visible=!1);let T=null;if(i&&!v)T=void 0===P||P.change>=0?m.SeriesBarColorer.upColor(this._study.properties()):m.SeriesBarColorer.downColor(this._study.properties());else{const e=this._study.barColorer().barStyle(o,!1),t=null!=e.barBorderColor?e.barBorderColor:e.barColor;T=(0,u.calculateColor)(n,t)}T=(0,a.resetTransparency)((0,u.calculateColor)(n,T));for(const e of t)e.color=T;return t}_showLastPriceAndChangeOnly(){return g&&(null===this._model.crossHairSource().pane||(0,h.isLineToolName)(p.tool.value())||null!==this._model.lineBeingEdited())}_changesData(e,t,i,r){if(r&&!v){const e=this._study.quotes();if(null!==e)return{values:{change:e.change,percentChange:e.change_percent},priceDirection:{basedOnCurrentBar:e.change>=0?0:1,basedOnPrevClose:e.change>=0?0:1}}}else{const r=this._study.data().search(i-1,d.PlotRowSearchMode.NearestLeft,1),s=r&&r.value[4]||null;if(null!==s)return{values:{change:e-s,percentChange:(0,_.barPercentChange)(s,e)},priceDirection:{basedOnCurrentBar:e>=t?0:1,basedOnPrevClose:e>=s?0:1}}}return{priceDirection:{basedOnCurrentBar:e>=t?0:1,basedOnPrevClose:e>=t?0:1}}}}{constructor(e,t){super(e,t),this._showBarChange=t.properties().paneProperties.legendProperties.showBarChange,this._showSeriesOHLC=t.properties().paneProperties.legendProperties.showSeriesOHLC,this._seriesStyle=e.properties().childs().style}getValues(e){const t=super.getValues(e);if(!this._showLastPriceAndChangeOnly()){const e=(0,r.isPriceSourceStyle)(this._seriesStyle.value()),i=this._showSeriesOHLC.value(),s=i&&!e,n=i&&e;t[0].visible=s,t[1].visible=s,t[2].visible=s,t[3].visible=s,t[6].visible=this._showBarChange.value(),t[4].visible=n}return t}}},71330:(e,t,i)=>{"use strict";i.d(t,{OverlayLegendView:()=>o});var r=i(52950),s=i(39755),n=i(81704);class o extends r.OverlayDataWindowView{
constructor(e,t){super(e,t),this._additional=null,this._showBarChange=t.properties().paneProperties.legendProperties.showBarChange,this._showSeriesOHLC=t.properties().paneProperties.legendProperties.showSeriesOHLC,this._studyOverlay=e,this._showBarChange.subscribe(this,this.update),this._showSeriesOHLC.subscribe(this,this.update)}isValuesVisible(){return this._showSeriesOHLC.value()||this._showBarChange.value()}additional(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._additional}destroy(){this._showBarChange.unsubscribeAll(this),this._showSeriesOHLC.unsubscribeAll(this)}_updateImpl(){super._updateImpl();{const e=(0,n.getDataVendorString)(this._studyOverlay.symbolInfo());this._additional=e?window.t("Data Provided by")+" "+e:null}}_createValuesProvider(e,t){return new s.OverlayLegendValuesProvider(e,t)}}},49949:(e,t,i)=>{"use strict";i.d(t,{OverlayStudyPriceLineAxisView:()=>s});var r=i(78539);class s extends r.PriceLineAxisView{constructor(e){super(),this._study=e}_value(){return this._study.lastValueData("",!0)}_priceLineColor(e){return e}_lineWidth(){return 1}_isVisible(){const e=this._study.model().properties().scalesProperties.showSeriesLastValue.value();return this._study.properties().childs().showPriceLine.value()&&e}}},24966:(e,t,i)=>{"use strict";i.d(t,{OverlayStatusProvider:()=>s});var r=i(56885);class s extends r.StudyStatusProvider{getSplitTitle(){return this._source.titleInParts(!0,void 0,!1,!1)}text(){return this._source.isActualInterval()?this._source.isFailed()?`${this._source.title(!0,void 0,!1,!1)}: ${this.sourceStatusText()}`:`${this._source.title(!0,void 0,!1,!1)} ${this.sourceStatusText()}`:this._source.title(!0,void 0,!1,!1)}}},61681:(e,t,i)=>{"use strict";i.d(t,{PivotPointsStandardLastPricesView:()=>o});var r=i(40989);const s=["p","s1","r1","s2","r2","s3","r3","s4","r4","s5","r5"],n={P:"P",S1:"S1/R1",S2:"S2/R2",S3:"S3/R3",S4:"S4/R4",S5:"S5/R5",R1:"S1/R1",R2:"S2/R2",R3:"S3/R3",R4:"S4/R4",R5:"S5/R5"};class o{constructor(e){this._visiblePivots=new Set,this._invidated=!0,this._prices=[],this._source=e}visiblePivots(){return this._visiblePivots}update(){this._invidated=!0}prices(){return this._invidated&&(this._updateImpl(),this._invidated=!1),this._prices}_updateImpl(){this._visiblePivots.clear();const e=this._source.model(),t=this._source.priceScale();if(null===t)return;if(e.timeScale().isEmpty()||t.isEmpty())return;const i=e.timeScale().visibleBarsStrictRange();if(null===i)return;if(!this._source.customData()||!this._source.customData().pivots)return;const o=e.mainSeries().bars().search(i.lastBar(),r.PlotRowSearchMode.NearestLeft);if(null===o)return;const a=o.index,l=this._source.customData().pivots,c=this._source.indexes(),u=this._source.properties(),d=this._source.firstValue();for(let e=0;e<l.length;e++){if(!l[e])continue;const i=c[l[e].startIndex],r=c[l[e].endIndex],o=u.inputs.showHistoricalPivots.value();if(i<=a&&(r>=a||o)){this._visiblePivots.add(l[e]),this._prices=[];for(let i=0;i<s.length;i++){const r=s[i],o=l[e][r];if(void 0===o||null===d)continue
;const a=t.priceToCoordinate(o,d),c=r.toUpperCase(),h=n[c],p=u.levelsStyle.colors[h].value();this._prices.push({formatted:t.formatPrice(o,d),price:o,coordinate:a,color:p})}}}}}},36691:(e,t,i)=>{"use strict";i.d(t,{PaneRendererStandardPivotLabel:()=>s});var r=i(62288);class s{constructor(e,t,i){this._drawRects=[],this._cacheProvider=e,this._point=t,this._label=i}draw(e,t){const i=this._cacheProvider(t);e.save(),e.setTransform(1,0,0,1,0,0);const r=t.pixelRatio;this._drawRects=[];const s=t=>{const s=i.labelRectByIndex(t),n={left:Math.round(this._point.x-s.width+o),top:Math.round(this._point.y-s.height/2),width:s.width,height:s.height};return e.drawImage(i.canvas(),Math.round(s.left*r),Math.round(s.top*r),s.width*r,s.height*r,Math.round(n.left*r),Math.round(n.top*r),n.width*r,n.height*r),this._drawRects.push(n),s.width},n=this._label.split("/");let o=0;for(let e=0;e<n.length;e++){const t=["P","S1","R1","S2","R2","S3","R3","S4","R4","S5","R5"].indexOf(n[e]);e>0&&(o+=s(t+11)/2),o+=s(t)/2}e.restore()}hitTest(e){for(const t of this._drawRects)if(e.x>=t.left&&e.x<=t.left+t.width&&e.y>=t.top&&e.y<=t.top+t.height)return new r.HitTestResult(r.HitTestResult.REGULAR);return null}}},14042:(e,t,i)=>{"use strict";i.d(t,{StandardPivotPointsImageCache:()=>n});var r=i(14900),s=i(16282);class n{constructor(e,t,i,s){this._priceAxisFontSize=11,this._prices=[],this._labelWidth=0,this._paneRenderParams=e,this._recreateCanvasAndContext(new r.Size(0,0)),this.reset({font:t,fontSize:i,backColors:s})}destroy(){delete this._canvas,delete this._cache}canvas(){return this._canvas}reset(e){this._renderParams=e,this._prices=[],this._cache.font=e.fontSize+"px "+e.font,this._labelWidth=["P","S1","R1","S2","R2","S3","R3","S4","R4","S5","R5","/"].reduce((e,t)=>{const i=this._cache.measureText(t).width;return Math.max(i,e)},0)}rowHeight(){return this._priceAxisFontSize+4}labelRectByIndex(e){return{left:0,top:Math.round(this._topByIndex(e)),width:Math.round(this._labelWidth+4),height:Math.round(this._renderParams.fontSize+8)}}setPrices(e){let t=!1;const i=(e,t)=>{const i=void 0===e,r=void 0===t;return(!i&&!r||i===r)&&(0,s.ensureDefined)(e).formatted===(0,s.ensureDefined)(t).formatted};if(e.length!==this._prices.length)t=!0;else for(let r=0;r<this._prices.length;r++)if(!i(this._prices[r],e[r])){t=!0;break}if(t){const t=this._labelWidth+6,i=this._renderParams.fontSize,s=Math.max(e.length,22)*(i+8);this._recreateCanvasAndContext(new r.Size(t,s)),this._prices=e,this._cache.save(),(0,r.drawScaled)(this._cache,this._paneRenderParams.pixelRatio,()=>{this._cache.translate(.5,.5),this._cache.font=this._renderParams.fontSize+"px "+this._renderParams.font,this._cache.textBaseline="middle";for(let e=0;e<this._prices.length;e++){if(!this._prices[e])continue;const t=["P","S1","R1","S2","R2","S3","R3","S4","R4","S5","R5"][e];this._cache.fillStyle=this._renderParams.backColors[e],this._cache.fillText(t,0,this._centerByIndex(e)),this._cache.fillText("/",0,this._centerByIndex(e+11))}}),this._cache.restore(),this._prices=e}}_recreateCanvasAndContext(e){
this._canvas=document.createElement("canvas"),this._canvas.width=e.w*this._paneRenderParams.pixelRatio,this._canvas.height=e.h*this._paneRenderParams.pixelRatio,this._cache=(0,s.ensureNotNull)(this._canvas.getContext("2d"))}_centerByIndex(e){return Math.round((e+.5)*(this._renderParams.fontSize+8))}_topByIndex(e){return Math.round(e*(this._renderParams.fontSize+8))}}},70904:(e,t,i)=>{"use strict";i.d(t,{StandardPivotPointsPriceAxisView:()=>n});var r=i(32552);const s=["P","S1","R1","S2","R2","S3","R3","S4","R4","S5","R5"];class n extends r.PriceAxisView{constructor(e,t){super(),this._source=e,this._data=t;const i=t.name;this._completeName="P"===i.toUpperCase()?"P":`S${i[1]}/R${i[1]}`}_updateRendererData(e,t,i){e.visible=!1,t.visible=!1;const r=this._source.properties();if(!r.visible.value())return;const n=this._completeName,o=r.levelsStyle.visibility;if(!o[n]||!o[n].value())return;const a=this._source.model().timeScale(),l=this._source.priceScale();if(a.isEmpty()||null===a.visibleBarsStrictRange()||null!==l&&l.isEmpty())return;const c=this._source.customData();if(!c||!c.pivots)return;const u=this._source.pricesView().prices()[s.indexOf(this._data.name.toUpperCase())];if(!u)return;i.background=u.color,i.textColor=this.generateTextColor(u.color),i.coordinate=u.coordinate,i.floatCoordinate=u.floatCoordinate;const d=this._source.model().properties().scalesProperties;d.showStudyLastValue.value()&&(e.text=u.formatted,e.visible=!0),d.showStudyPlotLabels.value()&&(t.text=this._source.priceLabelText(this._data.name),t.visible=!0)}}},41814:(e,t,i)=>{"use strict";var r=i(59757).PriceRange,s=i(72927).Point,n=i(14716).StudyStatusView,o=i(55068).StudyDataWindowView,a=i(24322).NonSeriesStudy,l=i(70904).StandardPivotPointsPriceAxisView,c=i(63956).PanePriceAxisView,u=i(62288).HitTestResult,d=i(56288).CompositeRenderer,h=i(85789).areEqualPaneRenderParams,p=i(14042).StandardPivotPointsImageCache,_=i(61681).PivotPointsStandardLastPricesView,m=i(36691).PaneRendererStandardPivotLabel,f=i(11258).HorizontalLineRenderer;class g{constructor(e,t){this._model=e,this._source=t,this._pivots=[],this._textCache={}}setCache(e){this._cache=e}priceAxisViews(e,t){return this._priceAxisViews}mergeLabel(e,t,i){var r=""+t;void 0===e[r]?(e[r]={},e[r].text=i,e[r].ids=[this.complete(i)]):(e[r].text+="/"+i,e[r].ids.push(this.complete(i)))}complete(e){return"P"===e?e:"S"+e[1]+"/R"+e[1]}update(){this._invalidated=!0}_updateImpl(){if(this._source.pricesView().prices(),this._pivots=[],this._source.customData()&&this._source.customData().pivots&&this._source.properties().visible.value()){var e=this._source.customData().pivots,t=this._source._indexes,i=this._model.timeScale(),r=this._source.priceScale();if(r&&!r.isEmpty()&&!i.isEmpty()&&e){var s=i.visibleBarsStrictRange(),n=s.firstBar(),o=s.lastBar();if(this._source.ownerSource())for(var a=this._source.ownerSource().firstValue(),l=0;l<e.length;l++)if(e[l]){var c=t[e[l].startIndex],u=t[e[l].endIndex];if(!(u<n||c>o)){var d={},h=this._source.properties().levelsStyle.visibility
;h.P.value()&&this.mergeLabel(d,e[l].p,"P"),h["S1/R1"].value()&&(this.mergeLabel(d,e[l].s1,"S1"),this.mergeLabel(d,e[l].r1,"R1")),h["S2/R2"].value()&&(this.mergeLabel(d,e[l].s2,"S2"),this.mergeLabel(d,e[l].r2,"R2")),h["S3/R3"].value()&&(this.mergeLabel(d,e[l].s3,"S3"),this.mergeLabel(d,e[l].r3,"R3")),h["S4/R4"].value()&&(this.mergeLabel(d,e[l].s4,"S4"),this.mergeLabel(d,e[l].r4,"R4")),h["S5/R5"].value()&&(this.mergeLabel(d,e[l].s5,"S5"),this.mergeLabel(d,e[l].r5,"R5"));var p=i.indexToCoordinate(c),_=i.indexToCoordinate(u);for(var m in d){var f=parseFloat(m),g=r.priceToCoordinate(f,a);this._pivots.push({x1:p,x2:_,y:g,label:d[m].text,labelIds:d[m].ids,src:e[l]})}}}}}}renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);for(var e=new d,t=this._source.properties().levelsStyle.colors,i=this._source.properties().levelsStyle.widths,r=this._source.visiblePivots(),n=0;n<this._pivots.length;n++){var o=this._pivots[n];if(r.has(o.src)){var a={width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:t[o.labelIds[0]].value(),linewidth:i[o.labelIds[0]].value(),linestyle:CanvasEx.LINESTYLE_SOLID,y:o.y,left:o.x1,right:o.x2},l=new f;if(l.setData(a),l.setHitTest(new u(u.REGULAR)),e.append(l),this._source.properties().levelsStyle.showLabels.value()){var c=function(e){return this._source.getCache(e)}.bind(this);e.append(new m(c,new s(o.x1,o.y),o.label))}}}return e}}t.study_PivotPointsStandard=class extends a{constructor(e,t,i,r){super(e,t,i,r);for(var s=["P","S1/R1","S2/R2","S3/R3","S4/R4","S5/R5"],n=this.properties().levelsStyle.visibility,o=0;o<s.length;o++)n[s[o]].listeners().subscribe(this,this.processHibernate);this._cacheDrawParams=null,this._cache=null}indexes(){return this._indexes}getCache(e){return this.createCacheIfRequred(e),this._cache}createCacheIfRequred(e){if(null===this._cache||null==this._cacheDrawParams||!h(e,this._cacheDrawParams)){this._cache&&this._cache.destroy();var t=this._getActualCacheParams();this._cache=new p(e,t.font,t.fontSize,t.backColors),this._cache.setPrices(this._pricesView.prices()),this._cacheDrawParams=e,this._cacheInvalidated=!1,this._cache.reset(t),this._cache.setPrices(this._pricesView.prices())}}lastValueData(e,t,i){var r=["P","S1","R1","S2","R2","S3","R3","S4","R4","S5","R5"].indexOf(e.toUpperCase()),s=this._pricesView.prices()[r];return null!=s?s:{noData:!0}}priceLabelText(e){return this._metaInfo.shortDescription+":"+e.toUpperCase()}pricesView(){return this._pricesView}_getActualCacheParams(){var e={};return e.font=this.properties().font.value(),e.fontSize=this.properties().fontsize.value(),
e.backColors=[this.properties().levelsStyle.colors.P.value(),this.properties().levelsStyle.colors["S1/R1"].value(),this.properties().levelsStyle.colors["S1/R1"].value(),this.properties().levelsStyle.colors["S2/R2"].value(),this.properties().levelsStyle.colors["S2/R2"].value(),this.properties().levelsStyle.colors["S3/R3"].value(),this.properties().levelsStyle.colors["S3/R3"].value(),this.properties().levelsStyle.colors["S4/R4"].value(),this.properties().levelsStyle.colors["S4/R4"].value(),this.properties().levelsStyle.colors["S5/R5"].value(),this.properties().levelsStyle.colors["S5/R5"].value()],e}updateAllViews(){super.updateAllViews(),this._pricesView.update()}_createViews(){this._cache&&(this._cache.destroy(),this._cache=null),this._priceAxisViews=[];var e=["P","S1","R1","S2","R2","S3","R3","S4","R4","S5","R5"];this._paneViews.length=0,this._labelPaneViews=[];var t=new g(this._model,this);t.setCache(this._cache),this._paneViews.push(t),this._mainPaneView=t;for(var i=0;i<e.length;i++){var r=new l(this,{name:e[i],cache:this._cache});this._priceAxisViews.push(r),this._labelPaneViews.push(new c(r,this,this._model))}this._dataWindowView||(this._dataWindowView=new o(this,this._model)),this._statusView||(this._statusView=new n(this,this._model.properties().scalesProperties.textColor)),this._legendView=null,this._pricesView=new _(this)}visiblePivots(){return this._pricesView.visiblePivots()}_postProcessGraphics(){}isVisible(){if(!this.properties().visible.value()||!this.isActualInterval())return!1;for(var e=["P","S1/R1","S2/R2","S3/R3","S4/R4","S5/R5"],t=this.properties().levelsStyle.visibility,i=0;i<e.length;i++)if(t[e[i]].value())return!0;return!1}stop(){super.stop(),this._cache&&(this._cache.destroy(),this._cache=null)}priceRange(e,t){if(!this.customData()||!this.customData().pivots||!this._indexes)return null;if(!this.priceScale())return null;for(var i=this.customData().pivots,s=this._indexes,n=null,o=0;o<i.length;o++)if(i[o]){var a=s[i[o].startIndex];if(!(s[i[o].endIndex]<e||a>t)){var l=[],c=this._properties.levelsStyle.visibility;c.P.value()&&l.push(i[o].p),c["S1/R1"].value()&&l.push(i[o].s1,i[o].r1),c["S2/R2"].value()&&l.push(i[o].s2,i[o].r2),c["S3/R3"].value()&&l.push(i[o].s3,i[o].r3),c["S4/R4"].value()&&l.push(i[o].s4,i[o].r4),c["S5/R5"].value()&&l.push(i[o].s5,i[o].r5);for(var u=0;u<l.length;u++)l[u]&&(null===n?n=new r(l[u],l[u]):n.apply(l[u],l[u]))}}return this.priceScale().isLog()&&n?new r(this.priceScale().priceToLogical(n.minValue()),this.priceScale().priceToLogical(n.maxValue())):n}}},91677:(e,t,i)=>{"use strict";var r;function s(e){e.lineWidth=void 0,e.lineStyle=void 0;for(let t=0;t<e.colors.length;t++)e.colors[t]=void 0;return e}function n(){return{colors:[void 0,void 0,void 0,void 0,void 0,void 0,void 0]}}i.d(t,{ColorerType:()=>r,clearStyle:()=>s,createEmptyStyle:()=>n}),function(e){e[e.Main=0]="Main",e[e.Background=1]="Background",e[e.Text=2]="Text",e[e.Border=3]="Border",e[e.Wick=4]="Wick",e[e.Up=5]="Up",e[e.Down=6]="Down"}(r||(r={}))},39426:(e,t,i)=>{"use strict";i.d(t,{StudyPlotPaneView:()=>k})
;var r=i(16282),s=i(72927),n=i(14563),o=i(22842),a=i(84162),l=i(31565),c=i(50946),u=i(1694);function d(e,t){const i=new Map;return function(...r){const s=""+(t?t.apply(null,r):r[0]);if(!i.has(s)){const t=e.apply(this,r);return i.set(s,t),t}return i.get(s)}}var h=i(62288),p=i(93321),_=i(56288),m=i(24090),f=i(72472),g=i(40989),v=i(5722),S=i(26184),y=i(91677),b=i(34250),w=i(68724);class P{constructor(e){this._data=e}draw(e,t){const i=this._data,r=t.pixelRatio,s=Math.max(1,Math.floor(r))%2?.5:0,n=i.vertOffset||0,o=i.lineColor||i.color,a=i.lineWidth||i.height/2;let c="",u=!1;for(const t of i.items){const i=t.x,d=t.y+n;if((0,l.isNaN)(i)||(0,l.isNaN)(d))continue;let h,p;null!=t.style?(h=t.style.color,p=t.style.width):(h=o,p=a),(h!==c||w.isSafari)&&(c=h,u&&e.fill(),e.beginPath(),e.fillStyle=h);const _=Math.round(i*r)+s,m=Math.round(d*r)+s,f=Math.round(p*r)+s;e.moveTo(_+f,m),e.arc(_,m,f,0,2*Math.PI,!1),u=!0}u&&e.fill()}hitTest(e){const t=this._data,i=t.lineWidth||t.height/2,r=t.vertOffset||0,n=(0,b.interactionTolerance)().series+i;for(const o of t.items){if(!o)continue;if(new s.Point(o.x,o.y+r).subtract(e).length()+i<=n)return new h.HitTestResult(h.HitTestResult.REGULAR)}return null}}class C{constructor(e){this._data=null,this._precalculatedCache=[],this.setData(e)}setData(e){this._data=e,this._precalculatedCache=[]}draw(e,t){if(null===this._data||0===this._data.items.length)return;const i=t.pixelRatio;this._precalculatedCache.length||this._fillPrecalculatedCache(i);const r=Math.max(1,Math.floor(i)),s=Math.round(this._data.histogramBase*i)-Math.floor(r/2),n=s+r,o=this._data.lineColor;for(let t=0;t<this._data.items.length;t++){const a=this._data.items[t],l=this._precalculatedCache[t],c=Math.round(a.y*i),u=a.style?a.style.color:o;let d,h;e.fillStyle=u,c<=s?(d=c,h=n):(d=s,h=c-Math.floor(r/2)+r),e.fillRect(l.left,d,l.right-l.left+1,h-d)}}hitTest(e){if(null===this._data)return null;const t=.5*this._data.barSpacing,i=e.x-t,r=e.x+t;for(const t of this._data.items){const s=t.x;if(s>=i&&s<=r){const i=t.y;if(e.y>=Math.min(i,this._data.histogramBase)&&e.y<=Math.max(i,this._data.histogramBase))return new h.HitTestResult(h.HitTestResult.REGULAR)}}return null}_fillPrecalculatedCache(e){if(null===this._data||0===this._data.items.length)return void(this._precalculatedCache=[]);const t=Math.ceil(this._data.barSpacing*e)<=1?0:Math.max(1,Math.floor(e)),i=Math.round(this._data.barSpacing*e)-t;this._precalculatedCache=new Array(this._data.items.length);for(let t=0;t<this._data.items.length;t++){const r=this._data.items[t],s=Math.round(r.x*e);let n,o;if(i%2){const e=(i-1)/2;n=s-e,o=s+e}else{const e=i/2;n=s-e,o=s+e-1}this._precalculatedCache[t]={left:n,right:o,roundedCenter:s,center:r.x*e,time:r.timePointIndex}}for(let e=1;e<this._data.items.length;e++){const i=this._precalculatedCache[e],r=this._precalculatedCache[e-1];i.time===r.time+1&&(i.left-r.right!==t+1&&(r.roundedCenter>r.center?r.right=i.left-t-1:i.left=r.right+t+1))}let r=Math.ceil(this._data.barSpacing*e);for(let e=0;e<this._data.items.length;e++){const t=this._precalculatedCache[e]
;t.right<t.left&&(t.right=t.left);const i=t.right-t.left+1;r=Math.min(i,r)}if(t>0&&r<4)for(let e=0;e<this._data.items.length;e++){const t=this._precalculatedCache[e];t.right-t.left+1>r&&(t.roundedCenter>t.center?t.right-=1:t.left+=1)}}}var T=i(89684);class x{constructor(e){this._data=e}draw(e,t){var i,r,s,n;const o=t.pixelRatio;let a="",c=!1;for(const t of this._data.items){if((0,l.isNaN)(t.x)||(0,l.isNaN)(t.y))continue;const u=null!==(r=null===(i=t.style)||void 0===i?void 0:i.color)&&void 0!==r?r:this._data.lineColor,d=Math.max(1,Math.floor((null!==(n=null===(s=t.style)||void 0===s?void 0:s.width)&&void 0!==n?n:this._data.lineWidth)*o));(u!==a||w.isSafari)&&(a=u,c&&e.fill(),e.beginPath(),e.fillStyle=u);let h=3*d;h%2!=d%2&&(h+=1);const p=Math.round(Math.round(t.x*o)-h/2),_=Math.round(Math.round(t.y*o)-h/2),m=p+Math.floor(h/2-d/2),f=_+Math.floor(h/2-d/2);e.rect(p,f,h,d),e.rect(m,_,d,h),c=!0}c&&e.fill()}hitTest(e){const t=(0,b.interactionTolerance)().series+this._data.lineWidth/2;let i,r,n,o;for(let a=1;a<this._data.items.length;++a){i=this._data.items[a-1],r=this._data.items[a],n=i.x,o=r.x;if((0,T.distanceToSegment)(new s.Point(n,i.y),new s.Point(o,r.y),new s.Point(e.x,e.y)).distance<=t)return new h.HitTestResult(h.HitTestResult.REGULAR)}return null}}class I{constructor(e){this._data=e}draw(e,t){if(0===this._data.items.length)return;const i=t.pixelRatio;e.fillStyle=this._data.lineColor;const r=Math.max(1,Math.floor(this._data.lineWidth*i)),s=r/2,n=Math.max(1,Math.floor(i)),o=Math.round(this._data.histogramBase*i)-Math.floor(n/2),a=o+n;for(const t of this._data.items){let l=r,c=s;t.style?(e.fillStyle=t.style.color,l=Math.max(1,Math.floor(t.style.width*i)),c=l/2):e.fillStyle=this._data.lineColor;const u=l%2?.5:0,d=Math.round(t.x*i)+u,h=Math.round(t.y*i);let p,_;h<=o?(p=h,_=a):(p=o,_=h-Math.floor(n/2)+n),e.fillRect(Math.floor(d-c),p,l,_-p)}}hitTest(e){const t=(0,b.interactionTolerance)().series+this._data.lineWidth/2,i=new Map;for(const n of this._data.items){const o=n.x,a=n.y;let l=t;n.style&&(i.has(n.style.width)?l=(0,r.ensureDefined)(i.get(n.style.width)):i.set(this._data.lineWidth,l));if((0,T.distanceToSegment)(new s.Point(o,a),new s.Point(o,this._data.histogramBase),new s.Point(e.x,e.y)).distance<=l)return new h.HitTestResult(h.HitTestResult.REGULAR)}return null}}var L=i(55782),M=i(96625);const E=e=>{const t=(0,n.rgbToHsl)((0,n.parseRgb)(e)),i=t[0]+.05;return t[0]=i-Math.floor(i),(0,n.rgbToHexString)((0,n.hslToRgb)(t))},A=d(E);class k{constructor(e,t,i,r){this._histogramBase=null,this._items=[],this._selectionData=null,this._lineColor="",this._lineWidth=1,this._color1="",this._color2="",this._invalidated=!1,this._renderer=new _.CompositeRenderer,this._isMarkersEnabled=o.enabled("source_selection_markers"),this._study=e,this._series=t,this._model=i,this._plotName=r,this._plotIndex=e.metaInfo().plots.findIndex(e=>e.id===r),this._colorProvider=(0,M.createStudyPlotColorProvider)(e.metaInfo(),e.properties(),r),this._selectionIndexer=new v.SelectionIndexes(i.timeScale())}items(){return this._items}update(){
this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer}_getTranspValue(){const e=this._study.properties(),t=e.styles[this._plotName];let i=0;const r=this._study.metaInfo();return"Volume@tv-basicstudies"===r.id&&r.version<=46&&"transparency"in e?(i=e.transparency.value(),i=(0,l.isNumber)(i)?i:0,i):(t.transparency&&(i=t.transparency.value(),i=(0,l.isNumber)(i)?i:0),i)}_updateImpl(){var e,t,i,n,o;this._renderer.clear();const d=this._study.properties().styles[this._plotName];if(!d.visible.value())return;if(!this._study.priceScale())return;this._histogramBase=null,this._items=[];const _=this._study.priceScale();if(this._model.timeScale().isEmpty()||null===_||_.isEmpty())return;const v=this._model.timeScale().visibleBarsStrictRange();if(null===v)return;let b=null!==(e=this._series.nearestIndex(v.firstBar()-1,g.PlotRowSearchMode.NearestLeft))&&void 0!==e?e:this._series.bars().firstIndex(),w=null!==(t=this._series.nearestIndex(v.lastBar()+1,g.PlotRowSearchMode.NearestRight))&&void 0!==t?t:this._series.bars().lastIndex();if(null===b||null===w)return;const T=this._study.offset(this._plotName);T>0?(b-=T,w+=T):(b+=T,w-=T);const M=this._study.getMinFirstBarIndexForPlot(this._plotName);if(M>w)return;b=Math.max(M,b);const k=d.plottype.value(),D=[L.LineStudyPlotStyle.Line,L.LineStudyPlotStyle.Area,L.LineStudyPlotStyle.Circles,L.LineStudyPlotStyle.Cross].indexOf(k)>=0,R=this._study.data(),N=this._study.firstValue();if(null===N)return;const O=R.rangeIterator(b,w),V=this._study.priceScale();if(null===V)return;const B=(0,a.clamp)(this._getTranspValue(),0,100),F=new Map,W=(e,t)=>{let i=F.get(e);void 0===i&&(i=new Map,F.set(e,i));let r=i.get(t);if(void 0===r){const s=!this._plotName||"vol"!==this._plotName;r=(0,c.generateColor)(e,t,s),i.set(t,r)}return r};let U=NaN,H=NaN;const z=(0,y.createEmptyStyle)();for(;O.hasNext();){const e=O.next();let t=e.index;const o=e.value;t+=T,t=Math.floor(t);let a=o[this._plotIndex+1];const l=null==a;if(a=l?NaN:a,D&&l){H=a;continue}const u=new s.Point(t,(0,r.ensure)(a));u.timePointIndex=t,u.valIsNotSameAsPrev=a!==H;if(this._colorProvider.isColorDefined()&&(u.style={color:W(d.color.value(),100),width:d.linewidth.value(),style:d.linestyle.value()},null!=a)){const e=this._colorProvider.getPlotPointStyle(o,z),t=e.colors[y.ColorerType.Main];void 0!==t&&(u.style.color=(0,c.isHexColor)(t)?W(t,B):t),u.style.width=null!==(i=e.lineWidth)&&void 0!==i?i:u.style.width,u.style.style=null!==(n=e.lineStyle)&&void 0!==n?n:u.style.style}D||isNaN(U)||U===t-1||this._items.push(new s.Point(t-1,NaN)),U=t,H=a,this._items.push(u)}if(V.pointsArrayToCoordinates(this._items,N),this._model.timeScale().timedValuesToCoordinates(this._items),d.histogramBase&&(this._histogramBase=V.priceToCoordinate(d.histogramBase.value(),N)),this._model.selection().isSelected(this._study)){const e=this._selectionIndexer.indexes();this._selectionData={points:[],bgColors:[],visible:!0,hittestResult:h.HitTestResult.REGULAR,barSpacing:this._model.timeScale().barSpacing()};const t=(0,
r.ensureNotNull)(this._model.paneForSource(this._study)).height();for(let i=0;i<e.length;i++){let r=e[i];const n=this._study.data().valueAt(r);if(r+=T,null===n)continue;const o=n[this._plotIndex+1];if(null==o)continue;const a=this._model.timeScale().indexToCoordinate(Math.floor(r)),l=V.priceToCoordinate(o,N);this._selectionData.points.push(new s.Point(a,l)),this._selectionData.bgColors.push(this._model.backgroundColorAtYPercentFromTop(l/t))}}else this._selectionIndexer.clear();const j=d;this._lineColor=(0,c.generateColor)(j.color.value(),B),this._lineWidth=j.linewidth.value();let Y=j.color.value();const G=this._colorProvider.getDefaultPlotPointStyle();G&&(Y=G.colors[y.ColorerType.Main],this._lineWidth=null!==(o=G.lineWidth)&&void 0!==o?o:this._lineWidth,this._lineColor=Y?(0,c.generateColor)(Y,B):this._lineColor),this._color2=(0,c.generateColor)(Y,B);const q=this._study.metaInfo().isRGB?E(Y):A(Y);this._color1=(0,c.generateColor)(q,B);const X={};X.barSpacing=this._model.timeScale().barSpacing(),X.items=this._items,X.histogramBase=this._histogramBase?this._histogramBase:(0,r.ensureNotNull)(this._study.priceScale()).height(),X.lineIndex=0,X.lineStyle=d.linestyle.value(),X.lineColor=this._lineColor,X.lineWidth=this._lineWidth,X.lineWidth=(0,l.isNumber)(X.lineWidth)?X.lineWidth:1,X.color1=this._color1,X.color2=this._color2,X.bottom=X.histogramBase,X.simpleMode=this._colorProvider.singleColor();const $=this._renderer,K=!!d.joinPoints&&d.joinPoints.value();switch(d.plottype.value()){case L.LineStudyPlotStyle.Line:case L.LineStudyPlotStyle.LineWithBreaks:$.append(new m.PaneRendererLine(X));break;case L.LineStudyPlotStyle.Area:case L.LineStudyPlotStyle.AreaWithBreaks:$.append(new p.PaneRendererArea(X));break;case L.LineStudyPlotStyle.Histogram:$.append(new I(X));break;case L.LineStudyPlotStyle.Columns:$.append(new C(X));break;case L.LineStudyPlotStyle.Cross:if($.append(new x(X)),K){const e=(0,u.deepCopy)(X);e.lineWidth=1,e.forceLineWidth=!0,$.append(new m.PaneRendererLine(e))}break;case L.LineStudyPlotStyle.Circles:if($.append(new P(X)),K){const e=(0,u.deepCopy)(X);e.lineWidth=1,e.ignorePaletteLineWidth=!0,$.append(new m.PaneRendererLine(e))}break;case L.LineStudyPlotStyle.StepLine:case L.LineStudyPlotStyle.StepLineWithDiamonds:{X.decoration=j.plottype.value()===L.LineStudyPlotStyle.StepLineWithDiamonds?f.StepLineDecoration.Diamonds:f.StepLineDecoration.None;const e=new f.PaneRendererStepLine;e.setData(X),$.append(e);break}default:$.append(new m.PaneRendererLine(X))}this._model.selection().isSelected(this._study)&&this._isMarkersEnabled&&this._selectionData&&$.append(new S.SelectionRenderer(this._selectionData))}}},56017:(e,t,i)=>{"use strict";i.d(t,{PaneRendererAbstractShape:()=>h,PaneRendererAbstractStrokeShape:()=>p,PaneRendererAbstractFillStrokeShape:()=>_});var r=i(16282),s=i(72927),n=i(71044),o=i(62288),a=i(99909),l=i(10175),c=i(39304),u=i(14900),d=i(68724);class h{constructor(e,t={skipRenderingOptimizations:!1}){this._items=[],this._barSpacing=0,this._vertOffset=0,
this._textCache=t.textCache||new a.TextImageCachesContainer(5e3),this._drawOperation=t.skipRenderingOptimizations?this._drawWithoutOptimizations.bind(this):this._drawWithOptimizations.bind(this),null!==e&&this.setData(e)}draw(e,t){this._preDrawInit(),this._drawOperation(e,t)}hitTest(e){const t=o.HitTestResult.REGULAR;let i=null;for(const r of this._items){if(!r)continue;const s=this._calcBoundingBox(r);if(s&&(0,n.pointInBox)(e,s)){const e={tooltip:this._getTooltip(r,s)};i=new o.HitTestResult(t,e)}}return i}setData(e){this._height=void 0!==e.height?e.height:e.width,this._width=void 0!==e.width?e.width:e.height,this._color=e.color,this._borderColor=e.borderColor,this._vertOffset=e.vertOffset||0,e.text&&(this._text=e.text,this._fontSize=e.fontSize,this._lineSpacing=e.lineSpacing,this._textColor=e.textColor,this._textAlign=e.textAlign||"center"),void 0!==e.items&&void 0!==e.barSpacing&&this.setItems(e.items,e.barSpacing)}setItems(e,t){this._setBaseData(e,t)}_calcBoundingBox(e){const t=e.vertOffset,i=this._getTextCache(e);if(!i)return;const r=i.textImageWidth,n=i.textImageHeight,o=r/2,a=e.y+t+e.textVertOffset,l=t>0?0:-n,c=t>0?n:0,u=new s.Point(e.x-o,a+l),d=new s.Point(e.x+o,a+c);return(0,s.box)(u,d)}_unionBox(e,t){const i=Math.min(e.min.x,t.min.x),r=Math.max(e.max.x,t.max.x),n=Math.min(e.min.y,t.min.y),o=Math.max(e.max.y,t.max.y),a=new s.Point(i,n),l=new s.Point(r,o);return(0,s.box)(a,l)}_getTooltip(e,t){if(e.tooltip)return{content:{type:"text",data:e.tooltip},tooltipDelay:200,extendMargin:!0,rect:{x:t.min.x,y:t.min.y,w:Math.abs(t.max.x-t.min.x),h:Math.abs(t.max.y-t.min.y)}}}_setBaseData(e,t){this._items.length=0,this._barSpacing=t;for(const t of e){const e=void 0===t.width?(0,r.ensureDefined)(this._width):t.width,i=void 0===t.height?(0,r.ensureDefined)(this._height):t.height,s=void 0===t.vertOffset?this._vertOffset:t.vertOffset,n=s>0?i:-i;this._items.push({width:e,height:i,vertOffset:s,textVertOffset:n,shapeWidth:0,shapeHeight:0,stepX:0,stepY:0,...t})}}_drawItemText(e,t,i){const r=this._getTextCache(i);if(null===r)return;const s=i.x,n=i.vertOffset,o=i.y+n+i.textVertOffset;let a;a=i.style&&void 0!==i.style.textColor?i.style.textColor:this._textColor,r.paintTo(e,t,a,s,o,l.HorizontalAlign.Center,n>0?l.VerticalAlign.Top:l.VerticalAlign.Bottom)}_drawWithOptimizations(e,t){let i,r,s=null,n=!1;for(const o of this._items)o.style&&void 0!==o.style.color?(i=o.style.color||"rgba(0, 0, 0, 0)",r=o.style.borderColor||"rgba(0, 0, 0, 0)"):(i=this._color,r=this._borderColor),(s!==i||d.isSafari)&&(s=i,n&&this._endPath(e),this._startPath(e,t,i,r)),this._drawItemShape(e,t,o),n=!0;n&&this._endPath(e);for(const i of this._items)this._drawItemText(e,t,i)}_drawWithoutOptimizations(e,t){let i,s;for(const n of this._items){const o=(0,r.ensureDefined)(n.style);i=o.color||"rgba(0, 0, 0, 0)",s=o.borderColor||"rgba(0, 0, 0, 0)",this._startPath(e,t,i,s),this._drawItemShape(e,t,n),this._endPath(e),this._drawItemText(e,t,n)}}_drawItemShape(e,t,i){(0,u.drawScaled)(e,t.pixelRatio,()=>this._drawItemShapeUsingCSSPixels(e,i))}
_drawItemShapeUsingCSSPixels(e,t){}_preDrawInit(){}_startPath(e,t,i,r){}_endPath(e){}_getTextCache(e){var t;const i=e.text||this._text,r=e.fontSize||this._fontSize,s=null!==(t=e.lineSpacing)&&void 0!==t?t:this._lineSpacing,n=e.textAlign||this._textAlign;return this._textCache.get({text:i,bold:!1,italic:!1,font:c.CHART_FONT_FAMILY,fontSize:r,lineSpacing:s,align:n})}}class p extends h{_startPath(e,t,i,r){e.beginPath(),e.lineWidth=this._lineWidth(t),e.lineCap="butt",e.strokeStyle=i}_endPath(e){e.stroke()}_lineWidth(e){return Math.max(1,Math.floor(2*e.pixelRatio))}}class _ extends h{_startPath(e,t,i,r){e.beginPath(),e.lineWidth=this._lineWidth(t),e.lineCap="butt",e.fillStyle=i,e.strokeStyle=r}_endPath(e){e.fill(),e.stroke()}_lineWidth(e){return Math.max(1,Math.floor(e.pixelRatio))}}},8278:(e,t,i)=>{"use strict";i.d(t,{PaneRendererArrowUp:()=>a,PaneRendererArrowDown:()=>l});var r=i(56017),s=i(72927),n=i(84162);class o extends r.PaneRendererAbstractFillStrokeShape{constructor(){super(...arguments),this._sign=0,this._thinArrow=!1,this._thinArrowLineWidth=0,this._headHeight=0,this._arrowWidth=0}setItems(e,t){this._setBaseData(e,t)}_drawItemShape(e,t,i){const r=t.pixelRatio,s=this._lineWidth(t)%2?.5:0,o=this._sign,a=this._arrowWidth,l=this._headHeight,c=Math.abs(i.height),u=Math.round(i.x*r)+s,d=i.vertOffset,h=Math.round((i.y+d+o*c/2)*r)+s,p=(0,n.ceiledEven)(a*r),_=p/2,m=Math.round(c*r),f=Math.round(l*r);e.translate(u,h),this._thinArrow?(e.moveTo(0,0),e.lineTo(-_,-_*o),e.moveTo(0,0),e.lineTo(_,-_*o),e.moveTo(0,0),e.lineTo(0,-m*o),e.moveTo(-_,-m*o),e.lineTo(_,-m*o)):(e.moveTo(0,0),m<f?(e.lineTo(p,-m*o),e.lineTo(-p,-m*o)):(e.lineTo(p,-f*o),e.lineTo(_,-f*o),e.lineTo(_,-m*o),e.lineTo(-_,-m*o),e.lineTo(-_,-f*o),e.lineTo(-p,-f*o)),e.lineTo(0,0)),e.translate(-u,-h)}_preDrawInit(){const e=this._calculateWidth();this._arrowWidth=e,this._sign=this._isUp()?-1:1,this._thinArrow=e<4,this._thinArrowLineWidth=Math.max(e/2,1),this._headHeight=Math.round(e)}_startPath(e,t,i,r){e.beginPath(),e.fillStyle=i,e.strokeStyle=r,e.lineWidth=this._lineWidth(t)}_lineWidth(e){return this._thinArrow?this._thinArrowLineWidth:super._lineWidth(e)}_calcBoundingBox(e){const t=e.vertOffset,i=this._sign,r=this._arrowWidth,n=this._headHeight,o=Math.abs(e.height),a=e.x-r,l=a+2*r,c=e.y+t+i*Math.round(o/2),u=c+(-o-n)*i,d=new s.Point(a,c),h=new s.Point(l,u);let p=(0,s.box)(d,h);const _=super._calcBoundingBox(e);return _&&(p=this._unionBox(p,_)),p}_calculateWidth(){return Math.round(this._barSpacing/4)}}class a extends o{_isUp(){return!0}}class l extends o{_isUp(){return!1}}},12029:(e,t,i)=>{"use strict";i.d(t,{PaneRendererCircleShape:()=>o});var r=i(56017),s=i(72927);const n=2*Math.PI;class o extends r.PaneRendererAbstractFillStrokeShape{_drawItemShapeUsingCSSPixels(e,t){const i=Math.max(t.width,t.height)/2,r=t.x,s=t.vertOffset,o=t.y+s;e.moveTo(r+i,o),e.arc(r,o,i,0,n,!1)}_calcBoundingBox(e){const t=Math.max(e.width,e.height)/2,i=e.x,r=e.vertOffset,n=e.y+r,o=i-t,a=i+t,l=n-t,c=n+t,u=new s.Point(o,l),d=new s.Point(a,c);let h=(0,s.box)(u,d)
;const p=super._calcBoundingBox(e);return p&&(h=this._unionBox(h,p)),h}}},35803:(e,t,i)=>{"use strict";i.d(t,{PaneRendererCrossShape:()=>n});var r=i(56017),s=i(72927);class n extends r.PaneRendererAbstractStrokeShape{_drawItemShape(e,t,i){const r=i.width,s=i.height,n=i.x-r/2,o=i.vertOffset,a=i.y-s/2+o,l=t.pixelRatio,c=this._lineWidth(t),u=c%2?.5:0,d=Math.round(n*l);let h=Math.round((n+r)*l);(h-d)%2!=c%2&&(h+=1);const p=Math.floor((d+h)/2)+u,_=Math.round(a*l);let m=Math.round((a+s)*l);(m-_)%2!=c%2&&(m+=1);const f=Math.floor((_+m)/2)+u;e.moveTo(p,_),e.lineTo(p,m),e.moveTo(d,f),e.lineTo(h,f)}_calcBoundingBox(e){const t=e.width,i=e.height,r=e.x-t/2,n=e.vertOffset,o=e.y-i/2+n,a=r,l=r+t,c=o,u=o+i,d=new s.Point(a,c),h=new s.Point(l,u);let p=(0,s.box)(d,h);const _=super._calcBoundingBox(e);return _&&(p=this._unionBox(p,_)),p}}},55625:(e,t,i)=>{"use strict";i.d(t,{PaneRendererDiamond:()=>n});var r=i(56017),s=i(72927);class n extends r.PaneRendererAbstractFillStrokeShape{_drawItemShapeUsingCSSPixels(e,t){const i=Math.round(t.height/2),r=t.x,s=t.vertOffset,n=t.y+s;e.moveTo(r,n-i),e.lineTo(r+i,n),e.lineTo(r,n+i),e.lineTo(r-i,n),e.lineTo(r,n-i)}_calcBoundingBox(e){const t=Math.round(e.height/2),i=e.x,r=e.vertOffset,n=e.y+r,o=i-t,a=i+t,l=n-t,c=n+t,u=new s.Point(o,l),d=new s.Point(a,c);let h=(0,s.box)(u,d);const p=super._calcBoundingBox(e);return p&&(h=this._unionBox(h,p)),h}}},26438:(e,t,i)=>{"use strict";i.d(t,{PaneRendererFlagShape:()=>n});var r=i(56017),s=i(72927);class n extends r.PaneRendererAbstractFillStrokeShape{_drawItemShapeUsingCSSPixels(e,t){const i=t.width,r=t.height,s=r/2,n=(i-3)/3,o=t.x-i/2,a=t.vertOffset,l=t.y-s+a;e.moveTo(o,l),e.lineTo(o+3,l),e.bezierCurveTo(o+n,l-n,o+2*n,l+n,o+i,l),e.lineTo(o+i,l+s),e.bezierCurveTo(o+i-n,l+s+n,o+i-2*n,l+s-n,o+3,l+s),e.lineTo(o+3,l+r),e.lineTo(o,l+r),e.lineTo(o,l)}_calcBoundingBox(e){const t=e.width,i=e.height,r=i/2,n=e.x-t/2,o=e.vertOffset,a=e.y-r+o,l=n,c=n+t,u=a,d=a+i,h=new s.Point(l,u),p=new s.Point(c,d);let _=(0,s.box)(h,p);const m=super._calcBoundingBox(e);return m&&(_=this._unionBox(_,m)),_}}},24638:(e,t,i)=>{"use strict";i.d(t,{PaneRendererLabelBase:()=>a,CornerVectorsClockwise:()=>r});var r,s=i(16282),n=i(56017),o=i(10175);class a extends n.PaneRendererAbstractFillStrokeShape{setItems(e,t){this._setBaseData(e,t);for(const e of this._items){const t=e.height;e.stepX=Math.round(t/2*.65)+.5,e.stepY=e.stepX;const i=e.stepX/2,r=this._getTextCache(e);if(null===r){e.shapeWidth=2*e.stepX,e.shapeHeight=2.5*e.stepY,e.vertOffset=this._calcVertOffset(e);continue}const s=r.textImageWidth,n=r.textImageHeight;e.shapeWidth=s+2*e.stepX,e.shapeHeight=n+2*i+e.stepY,e.vertOffset=this._calcVertOffset(e),e.textHorizOffset=this._getHorizontalTextOffset(e),e.textVertOffset=this._getVerticalTextOffset(e)}}_calcVertOffset(e){return e.vertOffset}_drawCorner(e,t,i,r,s){const n=Math.max(1,Math.floor(2*s));e.lineTo(t-n*r.prevPointSignX,i-n*r.prevPointSignY),e.arcTo(t,i,t+n*r.nextPointSignX,i+n*r.nextPointSignY,n)}_getArrowSize(e){return e.stepX}_getHorizontalTextOffset(e){return 0}
_getVerticalTextOffset(e){return 0}_hasText(e){return Boolean(e.text)||Boolean(this._text)}_drawItemText(e,t,i){var r;const n=this._getTextCache(i);if(null===n)return;const a=i.textHorizOffset||0,l=i.x+a,c=i.vertOffset,u=i.y+c+i.textVertOffset,d=(null===(r=i.style)||void 0===r?void 0:r.textColor)||this._textColor;n.paintTo(e,t,(0,s.ensureDefined)(d),l,u,o.HorizontalAlign.Center,o.VerticalAlign.Middle)}}class l{constructor(e,t,i,r){this.prevPointSignX=e,this.prevPointSignY=t,this.nextPointSignX=i,this.nextPointSignY=r}}!function(e){e.rightUp=new l(1,0,0,1),e.rightDown=new l(0,1,-1,0),e.leftDown=new l(-1,0,0,-1),e.leftUp=new l(0,-1,1,0)}(r||(r={}))},19028:(e,t,i)=>{"use strict";i.d(t,{PaneRendererLabelUp:()=>n,PaneRendererLabelDown:()=>o,PaneRendererLabelLeft:()=>a,PaneRendererLabelRight:()=>l,PaneRendererLabelCenter:()=>c});var r=i(72927),s=i(24638);class n extends s.PaneRendererLabelBase{_calcBoundingBox(e){const t=e.x-e.shapeWidth/2,i=e.x+e.shapeWidth/2,s=e.y+e.vertOffset,n=e.y+e.shapeHeight+e.vertOffset,o=new r.Point(t,s),a=new r.Point(i,n);return(0,r.box)(o,a)}_drawItemShape(e,t,i){const r=t.pixelRatio,n=this._lineWidth(t)%2?.5:0,o=Math.max(1,Math.floor(r))%2?.5:0,a=this._getArrowSize(i);let l=Math.round(a*r);(o+l)%1!=n%1&&(l+=.5);let c=Math.round(i.shapeWidth/2*r);(o+c)%1!=n%1&&(c+=.5);const u=Math.round(i.x*r)+o,d=Math.round((i.y+i.vertOffset)*r)+n,h=u-l,p=Math.round((i.y+i.vertOffset+a)*r)+n,_=u+l,m=u+c,f=Math.round((i.y+i.vertOffset+i.shapeHeight)*r)+n,g=u-c;e.moveTo(h,p),e.lineTo(u,d),e.lineTo(_,p),i.shapeWidth<=2*a?(e.lineTo(m,p),this._drawCorner(e,m,f,s.CornerVectorsClockwise.rightDown,r),this._drawCorner(e,g,f,s.CornerVectorsClockwise.leftDown,r),e.lineTo(g,p)):(this._drawCorner(e,m,p,s.CornerVectorsClockwise.rightUp,r),this._drawCorner(e,m,f,s.CornerVectorsClockwise.rightDown,r),this._drawCorner(e,g,f,s.CornerVectorsClockwise.leftDown,r),this._drawCorner(e,g,p,s.CornerVectorsClockwise.leftUp,r)),e.lineTo(h,p)}_getVerticalTextOffset(e){return e.shapeHeight/2+this._getArrowSize(e)/2}_calcVertOffset(e){return Math.sign(e.vertOffset)>=0?e.vertOffset:e.vertOffset-e.shapeHeight}}class o extends s.PaneRendererLabelBase{_calcBoundingBox(e){const t=e.x-e.shapeWidth/2,i=e.x+e.shapeWidth/2,s=e.y-e.shapeHeight+e.vertOffset,n=e.y+e.vertOffset,o=new r.Point(t,s),a=new r.Point(i,n);return(0,r.box)(o,a)}_drawItemShape(e,t,i){const r=t.pixelRatio,n=this._lineWidth(t)%2?.5:0,o=Math.max(1,Math.floor(r))%2?.5:0,a=this._getArrowSize(i);let l=Math.round(a*r);(o+l)%1!=n%1&&(l+=.5);let c=Math.round(i.shapeWidth/2*r);(o+c)%1!=n%1&&(c+=.5);const u=Math.round(i.x*r)+o,d=Math.round((i.y+i.vertOffset)*r)+n,h=u+l,p=Math.round((i.y+i.vertOffset-a)*r)+n,_=u-l,m=u+c,f=Math.round((i.y+i.vertOffset-i.shapeHeight)*r)+n,g=u-c;e.moveTo(h,p),e.lineTo(u,d),e.lineTo(_,p),i.shapeWidth<=2*a?(e.lineTo(g,p),this._drawCorner(e,g,f,s.CornerVectorsClockwise.leftUp,r),this._drawCorner(e,m,f,s.CornerVectorsClockwise.rightUp,r),e.lineTo(m,p)):(this._drawCorner(e,g,p,s.CornerVectorsClockwise.leftDown,r),
this._drawCorner(e,g,f,s.CornerVectorsClockwise.leftUp,r),this._drawCorner(e,m,f,s.CornerVectorsClockwise.rightUp,r),this._drawCorner(e,m,p,s.CornerVectorsClockwise.rightDown,r)),e.lineTo(h,p)}_getVerticalTextOffset(e){return-e.shapeHeight/2-this._getArrowSize(e)/2}_calcVertOffset(e){return Math.sign(e.vertOffset)<=0?e.vertOffset:e.vertOffset+e.shapeHeight}}class a extends s.PaneRendererLabelBase{_calcBoundingBox(e){const t=e.x,i=e.x+e.shapeWidth,s=e.y-e.shapeHeight/2+e.vertOffset,n=e.y+e.shapeHeight/2+e.vertOffset,o=new r.Point(t,s),a=new r.Point(i,n);return(0,r.box)(o,a)}_drawItemShape(e,t,i){const r=t.pixelRatio,n=this._lineWidth(t)%2?.5:0,o=this._getArrowSize(i),a=this._hasText(i),l=a?i.shapeHeight/2:o,c=Math.round(i.x*r)+n,u=Math.round((i.y+i.vertOffset)*r)+n,d=Math.round((i.x+o)*r)+n,h=Math.round((i.y+i.vertOffset+o)*r)+n,p=Math.round((i.y+i.vertOffset-o)*r)+n,_=Math.round((i.y+i.vertOffset-l)*r)+n,m=Math.round((i.x+i.shapeWidth)*r)+n,f=Math.round((i.y+i.vertOffset+l)*r)+n;e.moveTo(d,h),e.lineTo(c,u),e.lineTo(d,p),a?this._drawCorner(e,d,_,s.CornerVectorsClockwise.leftUp,r):e.lineTo(d,_),this._drawCorner(e,m,_,s.CornerVectorsClockwise.rightUp,r),this._drawCorner(e,m,f,s.CornerVectorsClockwise.rightDown,r),a?this._drawCorner(e,d,f,s.CornerVectorsClockwise.leftDown,r):e.lineTo(d,f),e.lineTo(d,h)}_getHorizontalTextOffset(e){return e.shapeWidth/2+this._getArrowSize(e)/2}}class l extends s.PaneRendererLabelBase{_calcBoundingBox(e){const t=e.x-e.shapeWidth,i=e.x,s=e.y-e.shapeHeight/2+e.vertOffset,n=e.y+e.shapeHeight/2+e.vertOffset,o=new r.Point(t,s),a=new r.Point(i,n);return(0,r.box)(o,a)}_drawItemShape(e,t,i){const r=t.pixelRatio,n=this._lineWidth(t)%2?.5:0,o=this._getArrowSize(i),a=this._hasText(i),l=a?i.shapeHeight/2:o,c=Math.round(i.x*r)+n,u=Math.round((i.y+i.vertOffset)*r)+n,d=Math.round((i.x-o)*r)+n,h=Math.round((i.y+i.vertOffset-o)*r)+n,p=Math.round((i.y+i.vertOffset+o)*r)+n,_=Math.round((i.y+i.vertOffset-l)*r)+n,m=Math.round((i.x-i.shapeWidth)*r)+n,f=Math.round((i.y+i.vertOffset+l)*r)+n;e.moveTo(d,h),e.lineTo(c,u),e.lineTo(d,p),a?this._drawCorner(e,d,f,s.CornerVectorsClockwise.rightDown,r):e.lineTo(d,f),this._drawCorner(e,m,f,s.CornerVectorsClockwise.leftDown,r),this._drawCorner(e,m,_,s.CornerVectorsClockwise.leftUp,r),a?this._drawCorner(e,d,_,s.CornerVectorsClockwise.rightUp,r):e.lineTo(d,_),e.lineTo(d,h)}_getHorizontalTextOffset(e){return-e.shapeWidth/2-this._getArrowSize(e)/2}}class c extends s.PaneRendererLabelBase{_calcBoundingBox(e){const t=e.x-e.shapeWidth/2,i=e.x+e.shapeWidth/2,s=e.y-e.shapeHeight/2+e.vertOffset,n=e.y+e.shapeHeight/2+e.vertOffset,o=new r.Point(t,s),a=new r.Point(i,n);return(0,r.box)(o,a)}_drawItemShape(e,t,i){const r=t.pixelRatio,n=this._lineWidth(t)%2?.5:0,o=i.shapeHeight/2,a=i.shapeWidth/2,l=Math.round(i.x*r)+n,c=Math.round((i.x-a)*r)+n,u=Math.round((i.x+a)*r)+n,d=Math.round((i.y+i.vertOffset-o)*r)+n,h=Math.round((i.y+i.vertOffset+o)*r)+n;e.moveTo(l,d),this._drawCorner(e,u,d,s.CornerVectorsClockwise.rightUp,r),this._drawCorner(e,u,h,s.CornerVectorsClockwise.rightDown,r),
this._drawCorner(e,c,h,s.CornerVectorsClockwise.leftDown,r),this._drawCorner(e,c,d,s.CornerVectorsClockwise.leftUp,r),e.lineTo(l,d)}}},58305:(e,t,i)=>{"use strict";i.d(t,{PaneRendererSquare:()=>n});var r=i(56017),s=i(72927);class n extends r.PaneRendererAbstractFillStrokeShape{_drawItemShape(e,t,i){const r=t.pixelRatio,s=Math.max(1,Math.floor(r))%2?.5:0,n=this._lineWidth(t)%2?.5:0;let o=Math.round(i.height/2*r);(s+o)%1!=n%1&&(o+=.5);const a=Math.round(i.x*r)+s,l=Math.round((i.y+i.vertOffset)*r)+s,c=a-o,u=l-o,d=a+o,h=l+o;e.rect(c,u,d-c,h-u)}_calcBoundingBox(e){const t=e.height,i=Math.round(t/2),r=e.x-i,n=e.vertOffset,o=e.y+n-i,a=r,l=r+t,c=o,u=o+t,d=new s.Point(a,c),h=new s.Point(l,u);let p=(0,s.box)(d,h);const _=super._calcBoundingBox(e);return _&&(p=this._unionBox(p,_)),p}}},54452:(e,t,i)=>{"use strict";i.d(t,{PaneRendererTriangleApexUp:()=>o,PaneRendererTriangleApexDown:()=>a});var r=i(56017),s=i(72927);class n extends r.PaneRendererAbstractFillStrokeShape{_calcBoundingBox(e){const t=e.width,i=e.height,r=t/2,n=Math.round(i/3),o=e.x,a=e.vertOffset-2*n,l=e.y+a,c=o-r,u=o+r,d=l,h=l+i,p=new s.Point(c,d),_=new s.Point(u,h);let m=(0,s.box)(p,_);const f=super._calcBoundingBox(e);return f&&(m=this._unionBox(m,f)),m}}class o extends n{_drawItemShape(e,t,i){const r=i.width,s=i.height,n=Math.round(s/3),o=i.vertOffset-2*n,a=t.pixelRatio,l=this._lineWidth(t)%2?.5:0,c=Math.max(1,Math.floor(a)),u=c%2?.5:0;let d=Math.round(r*a);d%2!=c%2&&(d+=1);const h=Math.round(i.x*a)+u,p=Math.round((i.y+o)*a),_=h+d/2,m=Math.round((i.y+o+s)*a)+l,f=h-d/2;e.moveTo(h,p),e.lineTo(_,m),e.lineTo(f,m),e.lineTo(h,p)}}class a extends n{_drawItemShape(e,t,i){const r=i.width,s=i.height,n=Math.round(s/3),o=i.vertOffset-n,a=t.pixelRatio,l=this._lineWidth(t)%2?.5:0,c=Math.max(1,Math.floor(a)),u=c%2?.5:0;let d=Math.round(r*a);d%2!=c%2&&(d+=1);const h=Math.round(i.x*a)+u,p=Math.round((i.y+o)*a)+l,_=h+d/2,m=Math.round((i.y+o+s)*a),f=h-d/2;e.moveTo(f,p),e.lineTo(_,p),e.lineTo(h,m),e.lineTo(f,p)}}},78029:(e,t,i)=>{"use strict";i.d(t,{PaneRendererXCross:()=>n});var r=i(56017),s=i(72927);class n extends r.PaneRendererAbstractStrokeShape{_drawItemShapeUsingCSSPixels(e,t){const i=t.width,r=t.height,s=t.x-i/2,n=t.vertOffset,o=t.y-r/2+n;e.moveTo(s,o),e.lineTo(s+i,o+r),e.moveTo(s,o+r),e.lineTo(s+i,o)}_calcBoundingBox(e){const t=e.width,i=e.height,r=e.x-t/2,n=e.vertOffset,o=e.y-i/2+n,a=r,l=r+t,c=o,u=o+i,d=new s.Point(a,c),h=new s.Point(l,u);let p=(0,s.box)(d,h);const _=super._calcBoundingBox(e);return _&&(p=this._unionBox(p,_)),p}}},96625:(e,t,i)=>{"use strict";i.d(t,{createStudyPlotColorProvider:()=>h});var r=i(91677),s=i(55782),n=i(16282);const o=new Map([[r.ColorerType.Main,"color"],[r.ColorerType.Text,"textColor"],[r.ColorerType.Border,"borderColor"],[r.ColorerType.Wick,"wickColor"],[r.ColorerType.Up,"colorup"],[r.ColorerType.Down,"colordown"]]);class a{constructor(e){this._plotStyle=e}getPlotPointStyle(e,t){const i=t?(0,r.clearStyle)(t):(0,r.createEmptyStyle)();return o.forEach((e,t)=>{this._plotStyle[e]&&(i.colors[t]=this._plotStyle[e].value())}),
i.lineWidth=this._plotStyle.linewidth?this._plotStyle.linewidth.value():void 0,i.lineStyle=this._plotStyle.linestyle?this._plotStyle.linestyle.value():void 0,i}isColorDefined(){return!0}singleColor(){return!0}getDefaultPlotPointStyle(){return null}}class l{constructor(e,t,i,r){this._palettes=new Map,this._metaInfo=e,this._properties=t,this._indexes=r,this._plotStyle=t.styles[i];const s=(0,n.ensureDefined)(this._metaInfo.palettes);r.forEach((t,i)=>{const r=e.plots[t];if(r&&"palette"in r){const e=s[r.palette],t=this._properties.palettes[r.palette];e&&t&&this._palettes.set(i,{palette:e,props:t})}})}getPlotPointStyle(e,t){const i=t?(0,r.clearStyle)(t):(0,r.createEmptyStyle)();if(this._palettes.has(r.ColorerType.Main)){const t=(0,n.ensureDefined)(this._indexes.get(r.ColorerType.Main)),s=e[t+1];if(null!=s){const e=(0,n.ensureDefined)(this._palettes.get(r.ColorerType.Main)),t=e.palette,o=e.props,a=(0,n.ensureDefined)(t.valToIndex?t.valToIndex[s]:s),l=o.colors[a];i.lineWidth=l.width.value(),i.lineStyle=l.style.value()}}return Object.keys(r.ColorerType).forEach(t=>{const r=parseInt(t);if(this._palettes.has(r)){const t=(0,n.ensureDefined)(this._indexes.get(r)),s=e[t+1];if(null!=s){const e=(0,n.ensureDefined)(this._palettes.get(r)),t=(0,n.ensureDefined)(e.palette.valToIndex?e.palette.valToIndex[s]:s),o=e.props.colors[t];i.colors[r]=o.color.value()}else i.colors[r]="transparent"}else if(this._plotStyle){const e=o.get(r);void 0!==e&&this._plotStyle[e]&&(i.colors[r]=this._plotStyle[e].value())}}),i}getDefaultPlotPointStyle(){const e=(0,n.ensureDefined)(this._palettes.get(r.ColorerType.Main)).props.colors[0];if(null!=e){return{colors:[e.color.value(),void 0,void 0,void 0,void 0,void 0,void 0],lineWidth:e.width.value()}}return null}isColorDefined(){return!!this._palettes.size}singleColor(){return!1}}var c=i(50946);class u{constructor(e){this._indexes=e}getPlotPointStyle(e,t){const i=t?(0,r.clearStyle)(t):(0,r.createEmptyStyle)();return this._indexes.forEach((t,r)=>{const s=e[t+1];if(null!=s){const e=(0,c.rgbaFromInteger)(s);i.colors[r]=e}else i.colors[r]="transparent"}),i}isColorDefined(){return!0}singleColor(){return!1}getDefaultPlotPointStyle(){return null}}const d=new Map([[r.ColorerType.Main,function(e,t){const i=(0,s.isColorerPlot)(t)||(0,s.isOhlcColorerPlot)(t);return"target"in t&&t.target===e&&i}],[r.ColorerType.Text,function(e,t){const i=(0,s.isTextColorerPlot)(t);return"target"in t&&t.target===e&&i}],[r.ColorerType.Background,function(e,t){return(0,s.isBgColorerPlot)(t)&&t.id===e}],[r.ColorerType.Border,function(e,t){const i=(0,s.isCandleBorderColorerPlot)(t);return"target"in t&&t.target===e&&i}],[r.ColorerType.Wick,function(e,t){const i=(0,s.isCandleWickColorerPlot)(t);return"target"in t&&t.target===e&&i}],[r.ColorerType.Up,function(e,t){const i=(0,s.isUpColorerPlot)(t);return"target"in t&&t.target===e&&i}],[r.ColorerType.Down,function(e,t){const i=(0,s.isDownColorerPlot)(t);return"target"in t&&t.target===e&&i}]]);function h(e,t,i){const{colorers:r}=function(e,t){const i=e.plots,r=i.findIndex(e=>e.id===t),s=new Map
;return i.forEach((e,i)=>{d.forEach((r,n)=>{r(t,e)&&s.set(n,i)})}),{plotIndex:-1===r?null:r,colorers:s}}(e,i);if(r.size)return e.isRGB?new u(r):new l(e,t,i,r);{const e=t.ohlcPlots;if(e&&e[i])return new a(e[i]);const r=t.styles[i];return new a(r)}}},55782:(e,t,i)=>{"use strict";var r,s;function n(e){return"line"===e.type}function o(e){return"shapes"===e.type}function a(e){return"chars"===e.type}function l(e){return"arrows"===e.type}function c(e){return"dataoffset"===e.type}function u(e){return"ohlc_open"===e.type}function d(e){return"ohlc_high"===e.type}function h(e){return"ohlc_low"===e.type}function p(e){return"ohlc_close"===e.type}function _(e){return u(e)||d(e)||h(e)||p(e)}function m(e){return"colorer"===e.type}function f(e){return"bar_colorer"===e.type}function g(e){return"bg_colorer"===e.type}function v(e){return"text_colorer"===e.type}function S(e){return"ohlc_colorer"===e.type}function y(e){return"wick_colorer"===e.type}function b(e){return"border_colorer"===e.type}function w(e){return"up_colorer"===e.type}function P(e){return"down_colorer"===e.type}function C(e){return"alertcondition"===e.type}function T(e){return"Plot"!==e}function x(e){return"ohlc_bars"===e.plottype}function I(e){return"ohlc_candles"===e.plottype}function L(e){return m(e)||f(e)||g(e)||c(e)||S(e)||C(e)||w(e)||P(e)||b(e)||y(e)||v(e)}function M(e){return m(e)||v(e)||f(e)||c(e)||S(e)||y(e)||b(e)||w(e)||P(e)||C(e)}i.r(t),i.d(t,{LineStudyPlotStyle:()=>r,isLinePlot:()=>n,isShapesPlot:()=>o,isCharsPlot:()=>a,isArrowsPlot:()=>l,isDataOffsetPlot:()=>c,isOhlcOpenPlot:()=>u,isOhlcHighPlot:()=>d,isOhlcLowPlot:()=>h,isOhlcClosePlot:()=>p,isOhlcPlot:()=>_,isColorerPlot:()=>m,isBarColorerPlot:()=>f,isBgColorerPlot:()=>g,isTextColorerPlot:()=>v,isOhlcColorerPlot:()=>S,isCandleWickColorerPlot:()=>y,isCandleBorderColorerPlot:()=>b,isUpColorerPlot:()=>w,isDownColorerPlot:()=>P,isAlertConditionPlot:()=>C,isPlotTitleDefined:()=>T,isOhlcPlotStyleBars:()=>x,isOhlcPlotStyleCandles:()=>I,PlotSymbolSize:()=>s,isPlotWithTechnicalValues:()=>L,isNonVisualPlot:()=>M}),function(e){e[e.Line=0]="Line",e[e.Histogram=1]="Histogram",e[e.Cross=3]="Cross",e[e.Area=4]="Area",e[e.Columns=5]="Columns",e[e.Circles=6]="Circles",e[e.LineWithBreaks=7]="LineWithBreaks",e[e.AreaWithBreaks=8]="AreaWithBreaks",e[e.StepLine=9]="StepLine",e[e.StepLineWithDiamonds=10]="StepLineWithDiamonds"}(r||(r={})),function(e){e.Auto="auto",e.Tiny="tiny",e.Small="small",e.Normal="normal",e.Large="large",e.Huge="huge"}(s||(s={}))},55304:(e,t,i)=>{"use strict";i.r(t),i.d(t,{createStudy:()=>oe,isESDStudy:()=>re,isFundamentalStudy:()=>ie,isFundamentalStudyMetaInfo:()=>se,isStudy:()=>Q,isStudyStrategy:()=>ee,isStudyStub:()=>te,studyColorRotationMode:()=>ae,useSameColorRotationComparator:()=>ce});var r=i(84234),s=i.n(r),n=i(14127),o=i(79318),a=i(32411),l=i(75196),c=i(29237),u=i(41657),d=i(24322);class h extends d.NonSeriesStudy{startIndex(){const e=this.customData();if(null==e||null==this._indexes)return null;const t=this._indexes[e.startIndex];return t!==u.INVALID_TIME_POINT_INDEX?t:null}endIndex(){
const e=this.customData();if(null==e||null==this._indexes)return null;const t=this._indexes[e.endIndex];return t!==u.INVALID_TIME_POINT_INDEX?t:null}baseLine(){const e=this.customData();return null!=e?e.baseLine:null}downLine(){const e=this.customData();return null!=e?e.downLine:null}upLine(){const e=this.customData();return null!=e?e.upLine:null}pearsons(){const e=this.customData();return null!=e&&void 0!==e.pearsons?e.pearsons:null}isVisible(){if(!this.properties().visible.value()||!this.isActualInterval())return!1;const e=this.properties().styles;return e.upLine.visible.value()||e.downLine.visible.value()||e.baseLine.visible.value()}_createViews(){super._createViews(),Promise.all([i.e(13935),i.e(20507)]).then(i.bind(i,3028)).then(({LinearRegressionPaneView:e})=>{this._setPaneViews([new e(this.model(),this)])})}}var p=i(92582),_=i(16282),m=i(59757);class f extends n.Study{priceRange(e,t){let i=!1;this.graphics().hhists().forEach((e,t)=>{i=i||this.properties().child("graphics").child("hhists").child(t).child("showValues").value()});const r=function(e,t,i,r){let s=null;return e.forEach((e,r)=>{e.forEach(e=>{e.firstBarTime<=i&&e.lastBarTime>=t&&(null===s?s={low:{l:e.priceLow,h:e.priceHigh},high:{h:e.priceHigh}}:(e.priceLow<s.low.l&&(s.low.l=e.priceLow,s.low.h=e.priceHigh),s.high.h=Math.max(s.high.h,e.priceHigh)))})}),null===s?null:r?new m.PriceRange(s.low.l-.8*(s.low.h-s.low.l),s.high.h):new m.PriceRange(s.low.l,s.high.h)}(this.graphics().hhists(),e,t,i);if(null===r)return null;const s=(0,_.ensureNotNull)(this.priceScale());return s.isLog()?new m.PriceRange(s.priceToLogical(r.minValue()),s.priceToLogical(r.maxValue())):r}}class g extends f{}var v=i(72218),S=i(40989),y=i(84819),b=i(58241),w=i(72305),P=i(31570),C=i(45433),T=i(67642);class x{constructor(e,t){this._rough=e,this._detailed=t}forEach(e,t){this._mostDetailedHorizLines().forEach(i=>{e.call(t,i,i,this)})}has(e){let t=!1;return this._mostDetailedHorizLines().forEach(i=>{t=t||i===e}),t}get size(){return this._rough.size}[Symbol.iterator](){throw new Error("Not implemented")}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}values(){throw new Error("Not implemented")}_mostDetailedHorizLines(){const e=new Map;this._rough.forEach(t=>e.set(t.startIndex,t));for(let t=this._detailed.length-1;t>=0;t--){this._detailed[t].forEach(t=>{e.has(t.startIndex)&&e.set(t.startIndex,t)})}return e}}class I{constructor(e,t){this._roughHorizLineSets=e,this._detailedHorizLineSets=t}forEach(e,t){this._roughHorizLineSets.forEach((i,r)=>{e.call(t,(0,_.ensureDefined)(this.get(r)),r,this)})}get(e){if(this._roughHorizLineSets.has(e))return new x((0,_.ensureDefined)(this._roughHorizLineSets.get(e)),this._detailedHorizLineSets.map(t=>t.get(e)).filter(e=>void 0!==e))}has(e){return this._roughHorizLineSets.has(e)}get size(){return this._roughHorizLineSets.size}[Symbol.iterator](){throw new Error("Not implemented")}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}values(){throw new Error("Not implemented")}}class L{
constructor(e,t){this._rough=e,this._detailed=t}forEach(e,t){this._rough.forEach((i,r)=>{for(const i of this._detailed){const s=i.get(r);if(void 0!==s)return void e.call(t,s,r,this)}e.call(t,i,r,this)})}get(e){for(const t of this._detailed){const i=t.get(e);if(void 0!==i)return i}return this._rough.get(e)}has(e){for(const t of this._detailed){if(t.has(e))return!0}return this._rough.has(e)}get size(){return this._rough.size}[Symbol.iterator](){throw new Error("Not implemented")}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}values(){throw new Error("Not implemented")}}class M{constructor(e,t){this._graphics=e,this._styleId=t}forEach(e,t){this._graphics.hhistsByTimePointIndex().forEach(i=>{i.forEach(i=>{if(i.styleId===this._styleId){const r={firstBarTime:i.firstBarTime,lastBarTime:i.lastBarTime,rate:i.rate,priceHigh:i.priceHigh,priceLow:i.priceLow};e.call(t,r,r,this)}})})}has(e){let t=!1;return this._graphics.hhistsByTimePointIndex().forEach(i=>{i.forEach(i=>{i.styleId===this._styleId&&i===e&&(t=!0)})}),t}get size(){let e=0;return this._graphics.hhistsByTimePointIndex().forEach(t=>{t.forEach(t=>{t.styleId===this._styleId&&e++})}),e}[Symbol.iterator](){throw new Error("Not implemented")}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}values(){throw new Error("Not implemented")}}class E{constructor(e,t){this._graphicsInfo=e,this._graphics=t}forEach(e,t){if(void 0===this._graphicsInfo.hhists)return;const i=Object.keys(this._graphicsInfo.hhists);for(const r of i)e.call(t,(0,_.ensureDefined)(this.get(r)),r,this)}get(e){if(void 0!==this._graphicsInfo.hhists)return new M(this._graphics,e)}has(e){return void 0!==this._graphicsInfo.hhists&&e in this._graphicsInfo.hhists}get size(){return void 0===this._graphicsInfo.hhists?0:Object.keys(this._graphicsInfo.hhists).length}[Symbol.iterator](){throw new Error("Not implemented")}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}values(){throw new Error("Not implemented")}}class A{constructor(e,t,i){this._graphicsInfo=e,this._roughStudyGraphics=t,this._detailedStudyGraphics=i}horizlines(){return new I(this._roughStudyGraphics.horizlines(),this._detailedStudyGraphics.map(e=>e.horizlines()))}vertlines(){return this._roughStudyGraphics.vertlines()}lines(){return this._roughStudyGraphics.lines()}hlines(){return this._roughStudyGraphics.hlines()}textmarks(){return this._roughStudyGraphics.textmarks()}shapemarks(){return this._roughStudyGraphics.shapemarks()}backgrounds(){return this._roughStudyGraphics.backgrounds()}polygons(){return this._roughStudyGraphics.polygons()}trendchannels(){return this._roughStudyGraphics.trendchannels()}hhists(){return new E(this._graphicsInfo,this)}hhistsByTimePointIndex(){return new L(this._roughStudyGraphics.hhistsByTimePointIndex(),this._detailedStudyGraphics.map(e=>e.hhistsByTimePointIndex()))}dwglabels(){return this._roughStudyGraphics.dwglabels()}dwglines(){return this._roughStudyGraphics.dwglines()}dwgboxes(){
return this._roughStudyGraphics.dwgboxes()}dwgtables(){return this._roughStudyGraphics.dwgtables()}dwgtablecells(){return this._roughStudyGraphics.dwgtablecells()}dwglinefills(){return this._roughStudyGraphics.dwglinefills()}}const k="tv-volumebyprice",D=(0,y.studyIdString)("VbPSessionsRough",k),R=(0,y.studyIdString)("VbPSessionsDetailed",k),N=(0,y.studyIdString)("VbPSessionsDetailedAlerts",k),O=Number.MAX_SAFE_INTEGER,V=window.t("study package is not available");class B extends f{constructor(e,t,i,r){super(e,t,i,r),this._isPackageAvailable=F(),this._alertsStudyMetaInfo=null,this._roughDataSource=null,this._detailedDataSource=null,this._detailedDataBuffer=new v.CircularBuffer(7),this._loadedGraphics=null,this._loadedPlots=null,this._mergedGraphics=(0,T.emptyStudyGraphics)(),this._mergedPlots=this._emptyPlotList(),this._isPackageAvailable||this._setStatus({type:w.StudyStatusType.Error,errorDescription:{error:V}})}destroy(){null!==this._detailedDataSource&&(this._detailedDataSource.dataUpdated().unsubscribe(this,this._onRoughOrDetailedDataUpdated),this._detailedDataSource.dataCleared().unsubscribe(this,this._onRoughOrDetailedDataCleared),this._detailedDataSource.studyStatusChanged().unsubscribe(this,this._onStudyStatusChanged),this._detailedDataSource.destroy(),this._detailedDataSource=null),null!==this._roughDataSource&&(this._roughDataSource.dataUpdated().unsubscribe(this,this._onRoughOrDetailedDataUpdated),this._roughDataSource.dataCleared().unsubscribe(this,this._onRoughOrDetailedDataCleared),this._roughDataSource.studyStatusChanged().unsubscribe(this,this._onStudyStatusChanged),this._roughDataSource.destroy(),this._roughDataSource=null)}data(){return this._loadedPlots||this._mergedPlots}graphics(){return this._loadedGraphics||this._mergedGraphics}clearData(){null!==this._roughDataSource&&this._roughDataSource.clearData(),null!==this._detailedDataSource&&this._detailedDataSource.clearData()}restoreData(e){this._invalidateLastNonEmptyPlotRowCache(),this._loadedPlots=this._emptyPlotList(),this._loadedPlots.restoreState(e),void 0!==e.graphics&&(this._loadedGraphics=(0,T.loadStudyGraphics)(e.graphics)),this._postProcessGraphics()}isFailed(){return!this._isPackageAvailable||null!==this._roughDataSource&&this._roughDataSource.studyStatus().type===w.StudyStatusType.Error||null!==this._detailedDataSource&&this._detailedDataSource.studyStatus().type===w.StudyStatusType.Error}isLoading(){return null!==this._roughDataSource&&this._roughDataSource.studyStatus().type===w.StudyStatusType.Loading||null!==this._detailedDataSource&&this._detailedDataSource.studyStatus().type===w.StudyStatusType.Loading}isStarted(){return null!==this._roughDataSource&&this._roughDataSource.isStarted()||null!==this._detailedDataSource&&this._detailedDataSource.isStarted()}sourceId(){throw new Error("Invalid operation")}idForAlert(){return super._collectDepsForAlert().idForAlert}hasStateForAlert(){return super.hasStateForAlert()&&null!==this._alertsStudyMetaInfo}canHaveChildren(){return!1}isChildStudy(){return!1}hasChildren(){return!1}
getAllChildren(){return[]}processHibernate(){this.isVisible()?(null===this._roughDataSource||this._roughDataSource.isStarted()||this._roughDataSource.start(),null===this._detailedDataSource||this._detailedDataSource.isStarted()||this._detailedDataSource.start()):(null!==this._roughDataSource&&this._roughDataSource.isStarted()&&this._roughDataSource.stop(),null!==this._detailedDataSource&&this._detailedDataSource.isStarted()&&this._detailedDataSource.stop())}_stopStudyOnServer(){var e,t;this._chartApi&&this._chartApi.isConnected().value()&&((null===(e=this._roughDataSource)||void 0===e?void 0:e.isStarted())&&this._roughDataSource.stop(),(null===(t=this._detailedDataSource)||void 0===t?void 0:t.isStarted())&&this._detailedDataSource.stop())}async _startAfterSymbolsResolved(e,t){if(this.isStarted()&&!this.isRestarting())return;if(this._restarting=!1,this._isPackageAvailable=F(),!this._isPackageAvailable)return void this._setStatus({type:w.StudyStatusType.Error,errorDescription:{error:V}});if(!this._allInputsAreValid())return;this._inputs=this.inputs();const i=this.model().studyMetaInfoRepository();if(null===this._roughDataSource){const e=await i.findById({type:"java",studyId:D});this._roughDataSource=new P.StudyDataSource(this.model().chartApi(),this.model().mainSeries().seriesSource(),"vbpsessionsrough_",e),this._roughDataSource.studyStatusChanged().subscribe(this,this._onStudyStatusChanged),this._roughDataSource.dataCleared().subscribe(this,this._onRoughOrDetailedDataCleared),this._roughDataSource.dataUpdated().subscribe(this,this._onRoughOrDetailedDataUpdated)}else this._roughDataSource.stop();if(this._roughDataSource.setInputs(W(this._roughDataSource.metaInfo().inputs,this._inputs)),this.processHibernate(),null===this._detailedDataSource){const e=await i.findById({type:"java",studyId:R});this._detailedDataSource=new P.StudyDataSource(this.model().chartApi(),this.model().mainSeries().seriesSource(),"vbpsessionsdetailed_",e),this._detailedDataSource.studyStatusChanged().subscribe(this,this._onStudyStatusChanged),this._detailedDataSource.dataCleared().subscribe(this,this._onRoughOrDetailedDataCleared),this._detailedDataSource.dataUpdated().subscribe(this,this._onRoughOrDetailedDataUpdated)}else this._detailedDataSource.stop();this._detailedDataSource.setInputs(U(this._inputs)),this.processHibernate(),this._createStudyGraphics(),this._subscribeToSessionId(),this._setStatus(this._statusValueFromDataSources()),this.onStart.fire(),null===this._alertsStudyMetaInfo&&(this._alertsStudyMetaInfo=await i.findById({type:"java",studyId:N}))}_changeInputsImpl(e,t){if(null!==this._roughDataSource){if((0,b.areStudyInputsEqual)(this._roughDataSource.metaInfo().inputs,t,e)){if(null!==this._detailedDataSource){const t=U(e),i=(0,b.rangeDependentStudyInputsToTimeRange)(t);if(this._moreDetailedDataRequiredForTimeRange(i)){if(this._detailedDataSource.isActive()){const e=this._detailedDataSource.stopAndStealData();if(e.plots.size()>0||!(0,T.isStudyGraphicsEmpty)(e.graphics)){const t=(0,_.ensureNotNull)(this._detailedDataSource.inputs())
;e.plots=this._extractEffectiveDetailedPlotValues(e.plots,t),this._detailedDataBuffer.enqueue({lod:H(t),value:e})}}this._detailedDataSource.setInputs(t),this._detailedDataSource.start()}}}else this._roughDataSource.setInputs(W(this._roughDataSource.metaInfo().inputs,e)),this._detailedDataBuffer.clear(),null!==this._detailedDataSource&&this._detailedDataSource.setInputs(U(e));null!==this._detailedDataSource&&this._createStudyGraphics()}}_collectDepsForAlert(){const e=super._collectDepsForAlert();if(null===this._alertsStudyMetaInfo)throw new Error("Alerts study metainfo is not ready yet. Have you checked the alert availability using hasStateForAlert()?");return{...e,studyDependencies:e.studyDependencies.map(e=>{const t=e.study===z(this.metaInfo());return{id:e.id,inputs:t?(i=e.inputs,{...i,subscribeRealtime:!0}):e.inputs,study:t&&null!==this._alertsStudyMetaInfo?z(this._alertsStudyMetaInfo):e.study};var i})}}isHibernated(){return!(this.isVisible()||null!==this._roughDataSource&&this._roughDataSource.isStarted()||null!==this._detailedDataSource&&this._detailedDataSource.isStarted())}_statusValueFromDataSources(){const e={type:w.StudyStatusType.Undefined};if(null===this._roughDataSource||null===this._detailedDataSource)return e;if(!this._roughDataSource.isStarted()&&!this._detailedDataSource.isStarted())return e;const t=this._roughDataSource.studyStatus(),i=this._detailedDataSource.studyStatus();if(t.type===w.StudyStatusType.Completed&&i.type===w.StudyStatusType.Completed)return{type:w.StudyStatusType.Completed};if(t.type===w.StudyStatusType.Error)return t;if(i.type===w.StudyStatusType.Error)return i;if(t.type===w.StudyStatusType.Loading||i.type===w.StudyStatusType.Loading){const e=t.type===w.StudyStatusType.Loading?t.startTime:1/0,r=i.type===w.StudyStatusType.Loading?i.startTime:1/0;return{type:w.StudyStatusType.Loading,startTime:Math.min(e,r)}}return e}_emptyPlotList(){return new S.PlotList((0,C.studyPlotFunctionMap)(this.metaInfo()),C.studyEmptyPlotValuePredicate)}_createStudyPlots(){const e=(0,_.ensureNotNull)(this._roughDataSource),t=(0,_.ensureNotNull)(this._detailedDataSource);this._mergedPlots.clear();const i=[];i.push({lod:O,value:e.plots()}),this._detailedDataBuffer.forEach(e=>{i.push({lod:e.lod,value:e.value.plots})});const r=(0,_.ensureNotNull)(t.inputs());i.push({lod:H(r),value:this._extractEffectiveDetailedPlotValues(t.plots(),r)}),i.sort((e,t)=>t.lod-e.lod);for(const e of i)e.value.each((e,t)=>{for(const e of t)if(void 0===e)return!1;return this._mergedPlots.add(e,t),!1});this._invalidateLastNonEmptyPlotRowCache()}_createStudyGraphics(){const e=(0,_.ensureNotNull)(this._roughDataSource),t=(0,_.ensureNotNull)(this._detailedDataSource),i=[];this._detailedDataBuffer.forEach(e=>{i.push({lod:e.lod,value:e.value.graphics})}),void 0!==this._inputs&&i.push({lod:H(this._inputs),value:t.graphics()}),i.sort((e,t)=>e.lod-t.lod);const r=i.map(e=>e.value);this._mergedGraphics=new A(this.metaInfo().graphics,e.graphics(),r)}_extractEffectiveDetailedPlotValues(e,t){const i=(0,
b.rangeDependentStudyInputsToTimeRange)(t),r=this.model().timeScale().timePointToIndex(i.from),s=this.model().timeScale().timePointToIndex(i.to);return e.size()>0?e.range(r||(0,_.ensureNotNull)(e.firstIndex()),s||(0,_.ensureNotNull)(e.lastIndex())):this._emptyPlotList()}_moreDetailedDataRequiredForTimeRange(e){const{from:t,to:i}=e;let r=!1;return(0,_.ensureNotNull)(this._roughDataSource).graphics().hhistsByTimePointIndex().forEach((e,s)=>{if(r)return;const n=this.model().timeScale().indexToTimePoint(s);if(null===n||n<t||i<n)return;const o=i-t;let a=!1;this._detailedDataBuffer.forEach(e=>{if(e.lod<=o){e.value.graphics.hhistsByTimePointIndex().has(s)&&(a=!0)}}),a||(r=!0)}),r}_onStudyStatusChanged(){this._setStatus(this._statusValueFromDataSources()),(0,_.ensureDefined)(this._statusView).update()}_onRoughOrDetailedDataCleared(){null!==this._roughDataSource&&null!==this._detailedDataSource&&(this._invalidateLastNonEmptyPlotRowCache(),this._detailedDataBuffer.clear(),this._createStudyPlots(),this._createStudyGraphics(),this.updateAllViews(),this.model().updateSource(this))}_onRoughOrDetailedDataUpdated(e){null!==this._roughDataSource&&null!==this._detailedDataSource&&(e.length>0&&this._createStudyPlots(),this.updateAllViews(),this.model().updateSource(this))}}function F(){return void 0!==window.pro&&window.pro.hasPackage(k)}function W(e,t){const i={};for(const r of e)i[r.id]=t[r.id];return i}function U(e){const t=e.last_visible_bar_time-e.first_visible_bar_time;return{...e,first_visible_bar_time:e.first_visible_bar_time-t,last_visible_bar_time:e.last_visible_bar_time+t}}function H(e){const{from:t,to:i}=(0,b.rangeDependentStudyInputsToTimeRange)(e);return i-t}function z(e){return`${e.id}-${e.version}`}var j=i(79093),Y=i(41814),G=i(16834),q=i(39610),X=i(40952),$=i(97133);class K extends n.Study{constructor(e,t,i,r){super(e,t,i,r),this.properties().styles.vol_ma.visible.listeners().subscribe(this,()=>this.invalidateTitleCache())}base(){return 1}destroy(){this.properties().styles.vol_ma.visible.listeners().unsubscribeAll(this),super.destroy()}_titleInputs(){const e={symbolsForDisplay:!0,skipHiddenInputs:!0,fakeInputsForDisplay:!0,asObject:!1};return this.properties().styles.vol_ma.visible.value()?this.inputs(e):this.inputs({...e,skippedInputs:["length"]})}}function J(e,t="shift",i){return{studyConstructor:e,colorRotationMode:t,colorRotationComparator:i}}const Z={study_PivotPointsStandard:J(Y.study_PivotPointsStandard),study_Overlay:J(G.study_Overlay,"loop"),study_Compare:J(q.StudyCompare,"loop"),study_Volume:J(K),study_VbPVisible:J(class extends f{}),study_ScriptWithDataOffset:J(X.study_ScriptWithDataOffset)};{Z.study_Earnings=J(a.study_ESD$TV_EARNINGS),Z.study_Splits=J(a.study_ESD$TV_SPLITS),Z.study_Dividends=J(a.study_ESD$TV_DIVIDENDS);const e=(e,t)=>se(t);Z["study_Internal$STD;Fund_"]=J(l.Fundamental,"loop",e),Z.study_ElliottWave=J(c.study_ElliottWave),Z.study_LinearRegression=J(h),Z.study_PivotPointsHighLow=J(p.study_PivotPointsHighLow),Z.study_VbPSessions=J(g),Z.study_VbPSessionsRoughDetailed=J(B),
Z.study_ZigZag=J(j.study_ZigZag),TradingView.StudyStrategy=J(o.StudyStrategy).studyConstructor}for(const e in Z)Z.hasOwnProperty(e)&&(TradingView[e]=Z[e].studyConstructor);function Q(e){return e instanceof n.Study}function ee(e){return e instanceof o.StudyStrategy}function te(e){return e instanceof $.StudyStub}function ie(e){return e instanceof l.Fundamental}function re(e){return e instanceof a.ESDStudyBase}function se(e){return"study_Internal$STD;Fund_"===ne(e)}function ne(e){const t="study_"+(e.classId||e.shortId);return t.startsWith("study_Internal$STD;Fund_")?"study_Internal$STD;Fund_":t}function oe(e,t,i,r,a){if(s().isScriptStrategy(r))return new o.StudyStrategy(e,t,i,r);const l=ne(r),c=new(l in Z?Z[l].studyConstructor:n.Study)(e,t,i,r);return void 0!==a&&c.setId(a),c}function ae(e){const t=ne(e);return t in Z?Z[t].colorRotationMode:void 0===e.pine||s().isStandardPine(e.id)?1!==e.plots.length?"shift":"loop":null}function le(e,t){return e.id===t.id&&(r=t,((i=e).pine?i.pine.version:void 0)===(r.pine?r.pine.version:void 0));var i,r}function ce(e){const t=ne(e);if(t in Z){const e=Z[t].colorRotationComparator;if(void 0!==e)return e}return le}},43948:(e,t,i)=>{"use strict";i.d(t,{StudyColorRotatorFactory:()=>u});var r=i(93669),s=i(14563),n=i(50946),o=i(55304);const a=["color-sky-blue-400","color-banana-yellow-700","color-deep-blue-500","color-grapes-purple-a700","color-iguana-green-500","color-minty-green-a700","color-ripe-red-a200","color-berry-pink-200","color-tv-blue-a100","color-tan-orange-a200","color-sky-blue-a400","color-deep-blue-a100","color-grapes-purple-400","color-iguana-green-a700","color-minty-green-200","color-ripe-red-200","color-berry-pink-a200","color-ripe-red-500","color-grapes-purple-500","color-deep-blue-400","color-tv-blue-a200","color-sky-blue-500","color-iguana-green-400","color-minty-green-400","color-banana-yellow-600","color-tan-orange-500","color-berry-pink-400","color-ripe-red-300","color-grapes-purple-300","color-deep-blue-300","color-tv-blue-300","color-sky-blue-300","color-iguana-green-300","color-minty-green-300","color-banana-yellow-400","color-tan-orange-300","color-berry-pink-300","color-tan-orange-a700"];class l{constructor(e){this._offset=0,this._offset=e}getColor(e){if(0===this._offset)return e;const t=a[(this._offset-1)%a.length],i=r.colorsPalette[t],o=(0,n.isHexColor)(e)?1:(0,s.parseRgba)(e)[3];return(0,n.generateColor)(i,(0,n.alphaToTransparency)(o))}}class c{constructor(e,t){this._offset=e,this._modelStartOffset=t}getColor(e){if((0,n.isHexColor)(e)){const t=(0,s.parseRgb)(e);return(0,s.rgbToHexString)((0,s.shiftRgb)(t,this._offset,this._modelStartOffset))}{const t=(0,s.parseRgba)(e);return(0,s.rgbaToString)((0,s.shiftRgba)(t,this._offset,this._modelStartOffset))}}}class u{constructor(e){this._chartModel=e}getColorRotator(e){const t=(0,o.studyColorRotationMode)(e);if(null===t)return null;const i=this._calcDefaultColorsOffset(e);switch(t){case"loop":return new l(i);case"shift":{const e=this._chartModel.getStudyShiftColorStartOffset();return new c(i,e)}}}
_calcDefaultColorsOffset(e){let t=0;const i=(0,o.useSameColorRotationComparator)(e);return this._chartModel.dataSources().filter(o.isStudy).forEach(r=>{i(e,r.metaInfo())&&t++}),t}}},31570:(e,t,i)=>{"use strict";i.d(t,{StudyDataSource:()=>_});var r=i(16282),s=i(96276),n=i.n(s),o=i(40989),a=i(84101),l=i(30805),c=i(45433),u=i(67642);const d=(0,i(87380).getLogger)("Chart.StudyDataSource");var h,p;!function(e){e[e.Undefined=0]="Undefined",e[e.Loading=1]="Loading",e[e.Completed=2]="Completed",e[e.Error=3]="Error"}(h||(h={})),function(e){e[e.Idle=0]="Idle",e[e.AwaitingConnection=1]="AwaitingConnection",e[e.AwaitingParent=2]="AwaitingParent",e[e.AwaitingFirstDataUpdate=3]="AwaitingFirstDataUpdate",e[e.Active=4]="Active"}(p||(p={}));class _{constructor(e,t,i,r){this._inputs=null,this._status=p.Idle,this._studyId=null,this._turnaroundCounter=1,this._studyStatus={type:h.Undefined},this._studyStatusChanged=new(n()),this._graphics=new u.LiveStudyGraphics,this._dataCleared=new(n()),this._dataUpdated=new(n()),this._boundOnGatewayIsConnectedChanged=this._onGatewayIsConnectedChanged.bind(this),this._ongoingDataUpdate=Promise.resolve(),this._gateway=e,this._metaInfo=r,this._seriesSource=t,this._turnaroundPrefix=i,this._plots=new o.PlotList((0,c.studyPlotFunctionMap)(r),c.studyEmptyPlotValuePredicate),this._gateway.isConnected().subscribe(this._boundOnGatewayIsConnectedChanged)}destroy(){this.stop(),this._gateway.isConnected().unsubscribe(this._boundOnGatewayIsConnectedChanged),this._dataUpdated.destroy(),this._dataCleared.destroy(),this._studyStatusChanged.destroy()}metaInfo(){return this._metaInfo}inputs(){return this._inputs}setInputs(e){this._inputs=e,null!==this._studyId&&(this._turnaroundCounter++,this._onStudyStatusChangedTo({type:h.Undefined}),this._gateway.modifyStudy(this._studyId,this._turnaround(),e,this._onMessage.bind(this)),this._status===p.Active&&this._changeStatusTo(p.AwaitingFirstDataUpdate))}isStarted(){return this._status!==p.Idle}isActive(){return this._status===p.Active}start(){this.isStarted()?d.logNormal("start: data source is already started, nothing to do"):((0,r.assert)(null!==this._inputs,"Inputs should be defined when starting a study data source"),this._gateway.isConnected().value()?this._createStudy():this._changeStatusTo(p.AwaitingConnection))}stop(){this.isStarted()?(null!==this._studyId&&(this._gateway.removeStudy(this._studyId),this._studyId=null,this._onStudyStatusChangedTo({type:h.Undefined})),this._changeStatusTo(p.Idle)):d.logNormal("stop: data source is already stopped, nothing to do")}studyId(){return this._studyId}studyStatus(){return this._studyStatus}studyStatusChanged(){return this._studyStatusChanged}plots(){return this._plots}graphics(){return this._graphics}clearData(){this._plots.clear(),this._graphics.clear(),this._dataCleared.fire()}stopAndStealData(){(0,r.assert)(this._status===p.Active,"Couldn't steal data from non-active data source"),this.stop();const e=this._plots,t=this._graphics.extract();return this._plots=new o.PlotList((0,
c.studyPlotFunctionMap)(this._metaInfo),c.studyEmptyPlotValuePredicate),{plots:e,graphics:t}}dataCleared(){return this._dataCleared}dataUpdated(){return this._dataUpdated}moveData(e){this._ongoingDataUpdate=this._ongoingDataUpdate.then(()=>{this._plots.move(e)})}_changeStatusTo(e){(0,r.assert)(this._status!==e,"Source and destination status should be distinct"),d.logNormal(`Status changed from ${p[this._status]} to ${p[e]}`),this._status=e}_createStudy(){const e=this._seriesSource.instanceId();null!==e?this._createStudyUsingParentId(e):(this._changeStatusTo(p.AwaitingParent),this._seriesSource.dataEvents().completed().subscribe(this,this._onSeriesCompleted,!0))}_createStudyUsingParentId(e){(0,r.assert)(this._status!==p.Active,'Status should not be "Active" when creating a study'),(0,r.assert)(this._studyStatus.type===h.Undefined,'Study status should be "Undefined" when creating a study'),(0,r.assert)(null===this._studyId,"Study id should be empty when creating a study"),this._studyId=(0,l.makeNextStudyId)(),this._gateway.createStudy(this._studyId,this._turnaround(),e,this._metaInfo.fullId+("tv-basicstudies"===this._metaInfo.packageId?"":"!"),(0,r.ensureNotNull)(this._inputs),this._onMessage.bind(this)),this._changeStatusTo(p.AwaitingFirstDataUpdate)}_onGatewayIsConnectedChanged(e){e?this._onGatewayConnected():this._onGatewayDisconnected()}_onGatewayConnected(){this._status===p.AwaitingConnection&&this._createStudy()}_onGatewayDisconnected(){this._status!==p.Idle&&this._status!==p.AwaitingConnection&&(this._studyId=null,this._changeStatusTo(p.AwaitingConnection),this._studyStatus.type!==h.Undefined&&this._onStudyStatusChangedTo({type:h.Undefined})),this._turnaroundCounter=1}_onSeriesCompleted(){this._status===p.AwaitingParent&&this._createStudyUsingParentId((0,r.ensure)(this._seriesSource.instanceId()))}_onStudyStatusChangedTo(e){const t=this._studyStatus;this._studyStatus=e,d.logNormal(`Study status type changed from ${h[t.type]} to ${h[e.type]}`),this._studyStatusChanged.fire(t,e)}_onMessage(e){if("data_update"===e.method){const{customId:t,turnaround:i,plots:s,nonseries:n}=e.params;t===this._studyId&&this._checkTurnaround(i)&&this._onDataUpdate(s,(0,r.ensureDefined)(n))}else if("study_loading"===e.method){const[t,i,r]=e.params;t===this._studyId&&this._checkTurnaround(i)&&this._onStudyLoading(r)}else if("study_completed"===e.method){const[t,i,r]=e.params;t===this._studyId&&this._checkTurnaround(i)&&this._onStudyCompleted(r)}else if("study_error"===e.method){const[t,i,r,s,n]=e.params;t===this._studyId&&this._checkTurnaround(i)&&this._onStudyError(r,s,n)}else"clear_data"===e.method&&this._checkTurnaround(e.params.turnaround)&&this.clearData()}_onDataUpdate(e,t){const i=(0,a.unpackNonSeriesData)(t.d);return this._ongoingDataUpdate=this._ongoingDataUpdate.then(()=>i,()=>i).then(this._onDataUnpacked.bind(this,e,t.indexes)),this._ongoingDataUpdate}_onDataUnpacked(e,t,i){this._status!==p.Idle&&(this._status===p.AwaitingFirstDataUpdate&&(this._changeStatusTo(p.Active),this.clearData()),this._mergePlots(e),
null!==i&&(i.indexes_replace?((0,r.assert)("nochange"!==t),this._graphics.replaceIndexesTo(t)):("nochange"!==t&&this._graphics.replaceIndexesTo(t),void 0!==i.graphicsCmds&&this._graphics.processCommands(i.graphicsCmds,this._metaInfo.graphics))),this._dataUpdated.fire(e,i,t))}_onStudyLoading(e){this._onStudyStatusChangedTo({type:h.Loading,startTime:Date.now()})}_onStudyError(e,t,i){this.clearData();const r="string"==typeof e?{error:e.split(":",2)[0]}:e;this._onStudyStatusChangedTo({type:h.Error,errorDescription:r})}_onStudyCompleted(e){this._onStudyStatusChangedTo({type:h.Completed})}_mergePlots(e){this._plots.merge(e)}_turnaround(){return`${this._turnaroundPrefix}${this._turnaroundCounter}`}_checkTurnaround(e){const t=this._turnaround();return e===t||e===this._seriesSource.turnaround()||e===`${this._seriesSource.turnaround()}_${t}`}}},55068:(e,t,i)=>{"use strict";i.d(t,{StudyDataWindowView:()=>n});var r=i(51424),s=i(69810);class n extends r.DataWindowView{constructor(e,t){super(),this._invalidated=!0,this._study=e,this._model=t,this._valueProvider=this._createValuesProvider(e,t),this._items=this._valueProvider.getItems().map(e=>new r.DataWindowItem(e.title,"")),this.update()}update(){this._invalidated=!0}items(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._items}study(){return this._study}_updateImpl(){this._header=this._study.title(!0),this._title=this._study.title();const e=this._valueProvider.getValues(this._currentIndex());for(let t=0;t<e.length;++t){const i=e[t],r=this._items[t];r.setValue(i.value),r.setVisible(i.visible),r.setColor(i.color)}}_currentIndex(){const e=this._model.crossHairSource().lockedIndex;return void 0!==e?e:null!==this._model.crossHairSource().pane?this._model.crossHairSource().appliedIndex():null}_createValuesProvider(e,t){return new s.StudyValuesProvider(e,t)}}},45433:(e,t,i)=>{"use strict";function r(e){const t=new Map;return e.plots.forEach((e,i)=>{t.set(e.id,e=>e[i+1])}),t}function s(e,t){return null==e[t]}i.d(t,{studyPlotFunctionMap:()=>r,studyEmptyPlotValuePredicate:()=>s})},84819:(e,t,i)=>{"use strict";function r(e,t){return`${e}@${t}`}function s(e){return e.replace(/(@[^-]+-[^-]+).*$/,"$1")}i.d(t,{studyIdString:()=>r,extractStudyId:()=>s})},58241:(e,t,i)=>{"use strict";function r(e){return["text","integer","float","price","session","resolution"].includes(e.type)&&e.hasOwnProperty("options")}function s(e,t,i){for(const r of e)if(t[r.id]!==i[r.id])return!1;return!0}function n(e){return{from:Math.round(e.first_visible_bar_time/1e3),to:Math.round(e.last_visible_bar_time/1e3)}}function o(e){const t=e.filter(e=>"time"===e.type||"price"===e.type);if(0===t.length)return[];const i=new Map,r=[];t.forEach(e=>{var t;const{group:s,inline:n}=e;if(void 0===n)return void r.push(e);const o=n+(s||"");if(i.has(o))null===(t=i.get(o))||void 0===t||t.push(e);else{const t=[e];i.set(o,t),r.push(t)}});const s=[];for(let e=0;e<r.length;e++){const t=r[e];Array.isArray(t)?2===t.length&&t[0].type!==t[1].type?s.push(t):s.push(...t):s.push(t)}return s}i.d(t,{
isStudyInputOptionsInfo:()=>r,areStudyInputsEqual:()=>s,rangeDependentStudyInputsToTimeRange:()=>n,editableStudyInputs:()=>o})},9193:(e,t,i)=>{"use strict";i.d(t,{StudyInserter:()=>a});var r=i(84234),s=i.n(r),n=i(3898);const o=(0,i(87380).getLogger)("Chart.Studies.StudyInserter");class a{constructor(e,t,i){this._parentSource=void 0,this._propsState=void 0,this._preferredPriceScale=void 0,this._allowChangeCurrency=!1,this._allowChangeUnit=!1,this._paneSize=void 0,this._forceOverlay=!1,this._studyMetaInfoRepository=t,this._inserterImpl=i,this._studyDescriptor=e}setParentSource(e){this._parentSource=e||void 0}setPaneSize(e){this._paneSize=e}setPreferredPriceScale(e){this._preferredPriceScale=e}setAllowChangeCurrency(e){this._allowChangeCurrency=e}setAllowChangeUnit(e){this._allowChangeUnit=e}setForceOverlay(e){this._forceOverlay=e}setPropertiesState(e){this._propsState=e}setTargetPriceScaleMode(e){this._targetPriceScaleMode=e}async insert(e,t){const i=void 0!==(r=this._inserterImpl).createStub&&void 0!==r.removeStub?this._inserterImpl.createStub():null;var r;let s,a=!0;try{s=await this._studyMetaInfoRepository.findById(this._studyDescriptor)}catch(e){return o.logWarn("Cannot get study "+JSON.stringify(this._studyDescriptor)),Promise.reject(n.InsertionErrorCode.CannotGetMetainfo)}finally{null!==i&&(a=this._inserterImpl.removeStub(i))}if(!a)return Promise.reject(n.InsertionErrorCode.StubWasRemoved);if(void 0!==t&&t.cancelled)return Promise.reject(n.InsertionErrorCode.Cancelled);if(!this._canApplyStudyToParent(s))return Promise.reject(n.InsertionErrorCode.StudyCannotBeChild);const l={...s.defaults.inputs};let c={};if(void 0!==e){const t=await e(l,s.inputs,s);c=t.inputs,void 0===this._parentSource&&t.parentSource&&(this._parentSource=t.parentSource)}if(void 0!==t&&t.cancelled)return Promise.reject(n.InsertionErrorCode.Cancelled);const u=this._insertStudy(s,c);return null===u?Promise.reject(n.InsertionErrorCode.Unknown):u}_insertStudy(e,t){return this._inserterImpl.createStudy(e,t,null,this._propsState,this._forceOverlay,this._parentSource,this._preferredPriceScale,this._allowChangeCurrency,this._allowChangeUnit,this._paneSize,this._targetPriceScaleMode)}_canApplyStudyToParent(e){return void 0===this._parentSource||s().canBeChild(e)}}},36367:(e,t,i)=>{"use strict";i.d(t,{StudyLegendValuesProvider:()=>s});var r=i(69810);class s extends r.StudyValuesProvider{constructor(e,t){super(e,t),this._showStudyValues=t.properties().paneProperties.legendProperties.showStudyValues}getValues(e){const t=super.getValues(e),i=this._showStudyValues.value();for(const e of t)e.visible=e.visible&&i;return t}}},52994:(e,t,i)=>{"use strict";i.d(t,{StudyMetaInfoRepository:()=>h});i(20220);var r=i(16282),s=i(84234),n=i.n(s),o=i(74845),a=i(44560),l=i(57746),c=i(95294),u=i.n(c);const d=(0,i(87380).getLogger)("Chart.Studies.StudyMetaInfoRepository",{color:"#606"});class h{constructor(e){this._nextRequestNumber=1,this._rawStudiesMetaInfo=[],this._isReady=!1,this._metaInfoQueryQueue=[],this._javaMetaInfoQueryQueue=[],this._javaStudiesMetaInfo=[],
this._pineMetaInfoCache=[],this._studiesMigrations=[],this._gateway=e}requestMetaInfo(){this._requestStarted();const e=this._makeNextRequestId();return d.logNormal("Requesting metainfo #"+e),new Promise(t=>{d.logNormal("Requesting studies metadata #"+e),this._gateway.requestMetadata(e,i=>{d.logNormal(`Requesting studies metadata #${e} finished`);const r=i.params[1].metainfo.slice();{const e=i.params[1].migrations.slice();this._processSiteMetaInfo(r,e)}this._requestFinished(),t()})})}findById(e){if(!this._isReady)return this._enqueueMetaInfoQuery(e);const t=this._findStudyMetaInfo(e);return null!==t?Promise.resolve(t):"pine"===e.type?this._compilePine(e):Promise.reject(`unexpected study id=${e.studyId} with type=${e.type}`)}findByIdSync(e){return this._findStudyMetaInfo(e)}isReady(){return this._isReady}findAllJavaStudies(){return this._isReady?Promise.resolve(this._javaStudiesMetaInfo):this._enqueueJavaMetaInfoQuery()}getInternalMetaInfoArray(){return this._javaStudiesMetaInfo}getMigrations(){return this._studiesMigrations}addPineMetaInfo(e){return _(this._pineMetaInfoCache,e)}_processMigrations(e){this._studiesMigrations=[];for(let t=0;e&&t<e.length;t++)this._studiesMigrations.push(e[t])}_processSiteMetaInfo(e,t){for(const t of e)u()._verifyInputsMaxValue(t),p(t);this._rawStudiesMetaInfo=e,this._processMigrations(t);for(const e of this._rawStudiesMetaInfo)_(this._javaStudiesMetaInfo,e);n().overrideDefaults(this._javaStudiesMetaInfo)}_processLibraryMetaInfo(e){}_requestStarted(){this._isReady=!1,this._javaStudiesMetaInfo=[],this._pineMetaInfoCache=[],this._studiesMigrations=[],this._rawStudiesMetaInfo=[]}_requestFinished(){this._isReady=!0,this._processPendingMetaInfoQueries(),this._processPendingFullMetaInfoQueries()}_enqueueMetaInfoQuery(e){return new Promise(t=>{this._metaInfoQueryQueue.push({studyDescriptor:e,resolver:t})})}_enqueueJavaMetaInfoQuery(){return new Promise(e=>{this._javaMetaInfoQueryQueue.push({resolver:e})})}_processPendingMetaInfoQueries(){for(;this._metaInfoQueryQueue.length;){const e=this._metaInfoQueryQueue.shift();this.findById(e.studyDescriptor).then(e.resolver)}}_processPendingFullMetaInfoQueries(){for(;this._javaMetaInfoQueryQueue.length;){this._javaMetaInfoQueryQueue.shift().resolver(this._javaStudiesMetaInfo)}}_findStudyMetaInfo(e){return"java"===e.type?this._javaStudiesMetaInfo.find(t=>t.id===e.studyId)||null:this._pineMetaInfoCache.find(t=>t.scriptIdPart===e.pineId&&(void 0===e.pineVersion||(0,r.ensureDefined)(t.pine).version===e.pineVersion))||null}_makeNextRequestId(){return"metadata_"+this._nextRequestNumber++}_compilePine(e){d.logNormal(`Compiling ${e.pineId} script`);const t=Promise.resolve((0,l.translateScriptAsync2)(e.pineId,e.pineVersion||"last")).then(t=>(d.logNormal(`Compiling ${e.pineId} is successful`),this.addPineMetaInfo((0,r.ensureDefined)(t))));return t.catch(()=>{d.logNormal(`Compiling ${e.pineId} is failed`)}),t}}function p(e){e.description_localized=window.t(e.description,{context:"study"})}function _(e,t){const i=new(n())(t);(0,o.migrateMetaInfoAndPropState)(i)
;let r=!0;const s=e.findIndex(e=>e.id===i.id);if(-1===s)e.push(i);else{const t=e[s],n=void 0!==t.pine?a.Version.parse(t.pine.version):null,o=void 0!==i.pine?a.Version.parse(i.pine.version):null;null===o||null===n||o.isGreaterOrEqual(n)?(t.removeDefaults(),e[s]=i):r=!1}return r&&i.createDefaults(),i}},25059:(e,t,i)=>{"use strict";i.d(t,{StudyStatusProviderBase:()=>u});var r=i(87576),s=i(97105),n=i(72305),o=i(20220);const a={NONE:"Default"},l=(0,o.t)("No volume data"),c=new Map([["Pine cannot determine the referencing length of a series. Try using max_bars_back",s.solutionIds.PINE_CANNOT_DETERMINE],["Memory limits exceeded",s.solutionIds.MEMORY_LIMITS_EXCEEDED]]);class u extends r.StatusProviderBase{constructor(e,t){super(t),this._source=e}getSplitTitle(){return this._source.titleInParts(!0,a,void 0,!0)}text(){return this._source.isActualInterval()?this._source.isFailed()?`${this._source.title(!0,a,void 0,!0)}: ${this.sourceStatusText()}`:`${this._source.title(!0,a,void 0,!0)} ${this.sourceStatusText()}`:this._source.title(!0,a,void 0,!0)}sourceStatusText(){return(0,n.convertStudyStatusToString)(this._source.status(),!0)}sourceStatusSolutionId(){const e=this._source.status();if(e.type===n.StudyStatusType.Error)return e.errorDescription.solution_id?e.errorDescription.solution_id:function(e){for(const t of Array.from(c.keys()))if(e.includes(t))return c.get(t)}(e.errorDescription.error)}errorStatus(){if(!this._source.isActualInterval()||this._source.isSymbolInvalid())return null;return this._source.status().type===n.StudyStatusType.Error?{error:this.sourceStatusText(),solutionId:this.sourceStatusSolutionId(),title:this.sourceStatusTitle()}:null}sourceStatusTitle(){const e=this._source.status();if(e.type===n.StudyStatusType.Error)return-1!==e.errorDescription.error.toLowerCase().indexOf("the data vendor doesn't provide volume data for this symbol.")?l:void 0}}},56885:(e,t,i)=>{"use strict";i.d(t,{StudyStatusProvider:()=>a});var r=i(72305),s=i(11490),n=i(25059);const o=window.t("Fundamental studies are no longer available on charts");class a extends n.StudyStatusProviderBase{constructor(e,t){super(e,t),this._study=e}color(){return this._study.isFailed()||this._study.metaInfo&&this._study.metaInfo().isTVScriptStub?"#ff0000":super.color()}sourceStatusText(){if(this._study.status().type===r.StudyStatusType.Error){const e=this._study.metaInfo(),t=(0,s.extractPineId)(e.fullId);if(e.scriptIdPart&&(0,s.isEdgrPineId)(e.scriptIdPart)||t&&(0,s.isEdgrPineId)(t))return o}return super.sourceStatusText()}}},14716:(e,t,i)=>{"use strict";i.d(t,{StudyStatusView:()=>s});var r=i(14854);class s extends r.StatusView{constructor(e){super(e.statusProvider())}color(){return this._statusProvider.color()}getSplitTitle(){return this._statusProvider.getSplitTitle()}update(){this._text=this._statusProvider.text()}}},72305:(e,t,i)=>{"use strict";i.r(t),i.d(t,{StudyStatusType:()=>s,convertStudyStatusToString:()=>n});const r=window.t("loading...");var s;function n(e,t){if(e.type===s.Loading)return t?r:"loading...";if(e.type===s.Error){
const i=e.errorDescription,r=t?window.t(i.error):i.error;if(i.ctx){const e={};return Object.entries(i.ctx).forEach(([t,i])=>{e[t]=i.toString()}),r.format(e)}return r}return""}!function(e){e[e.Undefined=0]="Undefined",e[e.Loading=1]="Loading",e[e.Completed=2]="Completed",e[e.Error=3]="Error"}(s||(s={}))},97133:(e,t,i)=>{"use strict";i.d(t,{StudyStub:()=>m});var r=i(14716),s=i(43854),n=i(11228),o=i(96276),a=i.n(o),l=i(27937),c=i.n(l),u=i(25059);class d extends u.StudyStatusProviderBase{text(){return this._source.isActualInterval()?`${this._source.title()} ${this.sourceStatusText()}`:this._source.title()}}var h=i(72305);class p{getItems(){return[]}getValues(e){return[]}}const _=new(a());class m extends s.PriceDataSource{constructor(e,t,i){super(e),this._priceStep=.01,this._status={type:h.StudyStatusType.Undefined},this._statusChanged=new(a()),this._formatter=new n.PriceFormatter(100),this._origState=t,this._title=i;this._properties=new(c())({visible:!0}),this._statusView=new r.StudyStatusView(this)}properties(){return this._properties}statusView(){return this._statusView}legendView(){return null}state(e){return this._origState}setStatus(e){this._status=e,this._statusChanged.fire()}formatter(){return this._formatter}title(){return this._title}titleInParts(){return[this._title]}isFailed(){return this._status.type===h.StudyStatusType.Error}isLoading(){return this._status.type===h.StudyStatusType.Loading}setFailed(e){this.setStatus({type:h.StudyStatusType.Error,errorDescription:{error:e}}),this._model.updateSource(this)}isSymbolInvalid(){return!1}isActualInterval(){return!0}onIsActualIntervalChange(){return _}start(){}status(){return this._status}onStatusChanged(){return this._statusChanged}firstValue(){return null}currency(){return null}sessionId(){return this._model.mainSeries().sessionId()}sessionIdChanged(){return this._model.mainSeries().sessionIdChanged()}unit(){return null}symbolSource(){return this._model.mainSeries()}valuesProvider(){return new p}statusProvider(e){return new d(this,this._model.properties().scalesProperties.textColor)}}},69810:(e,t,i)=>{"use strict";i.d(t,{StudyValuesProvider:()=>y});var r=i(75496),s=i(20220),n=i(68724),o=i(50946),a=i(22842),l=i(40989),c=i(87048),u=i(14397),d=i(55782),h=i(91677),p=i(96625),_=i(11403),m=i(16282),f=i(81293);const g=n.CheckMobile.any(),v=(0,s.t)("n/a"),S=a.enabled("hide_last_na_study_output");class y{constructor(e,t){this._emptyValues=[],this._colorProviders=new Map,this._study=e,this._model=t;const i=e.metaInfo().plots;i&&i.forEach((t,i)=>{if((0,d.isPlotWithTechnicalValues)(t))return;const r=t.id;this._emptyValues.push({id:r,index:i,title:this._study.guiPlotName(r),value:"",visible:!1});const s=(0,d.isOhlcPlot)(t)?t.target:t.id;this._colorProviders.set(s,(0,p.createStudyPlotColorProvider)(e.metaInfo(),e.properties(),s))})}getItems(){return this._emptyValues}getValues(e){const t=this._emptyValues.map(e=>({...e}));let i=null;const s=this._study.data().lastIndex();if(null!==s)for(const e of t){if(!this._study.properties().styles[e.id].visible.value())continue
;const t=this._study.nearestIndex(s,l.PlotRowSearchMode.NearestLeft,e.index+1);if(void 0===t)continue;const r=t+this._study.offset(e.id);i=null!==i?Math.max(r,i):r}(null===e||null!==i&&e>i)&&(e=i);const n=this._hideValues(),a=this._study.isVisible()&&!n?v:"";for(const e of t)e.value=a;if(n)return t;if(S&&t.length&&(t[t.length-1].value=""),this._study.metaInfo().graphics.hhists)return this._getValuesForHHist(t,e);const c=this._study.priceScale();if(!this._study.isVisible()||null===e||null===c||c.isEmpty()||this._model.timeScale().isEmpty())return t;const u=this._study.metaInfo().plots,p=(0,_.getPriceValueFormatterForSource)(this._study),m={};for(const i of t){let t=i.id;const n=this._study.properties().styles[t].visible.value();if(i.visible=n,!n)continue;const a=i.index,c=e-this._study.offset(t),_=null!==s&&c>s?l.PlotRowSearchMode.NearestLeft:l.PlotRowSearchMode.Exact,f=this._study.nearestIndex(c,_);if(void 0===f)continue;let g=m[t];if(void 0===g&&(g=this._study.getMinFirstBarIndexForPlot(t),Number.isFinite(g)&&(m[t]=g)),g>f)continue;const v=this._study.data().last(),S=this._study.data().valueAt(f)||(null!==v?v.value:null);if(null===S)continue;const y=S[a+1];if(!(0,r.isNumber)(y))continue;const b=y>0;i.value=p(y);const w=this._study.properties().styles[t];let P=w.color.value();const C=u[a];(0,d.isOhlcPlot)(C)?(t=C.target||t,P=this._study.properties().ohlcPlots[t].color.value()):(0,d.isArrowsPlot)(C)&&(P=b?w.colorup.value():w.colordown.value());let T=P;const x=this._colorProviders.get(t),I=x&&x.getPlotPointStyle(S);I&&((0,d.isArrowsPlot)(C)?(b&&void 0!==I.colors[h.ColorerType.Up]&&(T=I.colors[h.ColorerType.Up]),b||void 0===I.colors[h.ColorerType.Down]||(T=I.colors[h.ColorerType.Down])):void 0!==I.colors[h.ColorerType.Main]&&(T=I.colors[h.ColorerType.Main])),"transparent"===T&&(T=P),T=(0,o.resetTransparency)(T),i.color=T}return t}_hideValues(){return g&&(null===this._model.crossHairSource().pane||(0,c.isLineToolName)(u.tool.value())||null!==this._model.lineBeingEdited())}_getValuesForHHist(e,t){e.forEach(e=>{e.visible=this._study.isVisible(),e.value=v});const i=this._study.priceScale(),s=this._model.timeScale();if(null===i||i.isEmpty()||s.isEmpty()||this._hideValues())return e;if(null===t||!isFinite(t)){const i=this._study.data().last();if(null===i)return e;t=i.index}const n=this._model.crossHairSource(),o=n.price;if(!isFinite(n.y)&&null===(t=function(e,t){var i;const r=null===(i=e.visibleBarsStrictRange())||void 0===i?void 0:i.lastBar();if(!r)return null;const s=t.data().search(r,l.PlotRowSearchMode.NearestLeft);return s?s.index:null}(this._model.timeScale(),this._model.mainSeries())))return e;const a=function(e,t,i,r){if(0===e.size)return null;if(!i){const e=(0,m.ensureNotNull)(r.data().valueAt(t));i=r.barFunction()(e)}const s=function(e,t){let i=null;return e.forEach((e,r)=>{r<=t&&(null===i||r>i)&&(i=r)}),i}(e,t);if(null===s)return null;const n=e.get(s);if(!n||0===n.size)return null;return function(e,t){let i=null;return e.forEach(e=>{e.priceLow<=t&&t<e.priceHigh&&(i=e)}),i}(n,i)
}(this._study.graphics().hhistsByTimePointIndex(),t,o,this._model.mainSeries());if(null===a)return e;const c=this._study.metaInfo().graphics.hhists;if(void 0===c)return e;const u=c[a.styleId];if(void 0===u)return e;const d=this._study.properties().child("graphics").child("hhists").child(a.styleId),h=new f.VolumeFormatter;return e.forEach((e,t)=>{if(t<d.colors.childCount())if(t<a.rate.length){const i=a.rate[t];e.title=u.titles[t],e.value=(0,r.isNumber)(i)?h.format(i):"",e.color=d.colors[t].value()}else e.title="",e.value="",e.color=void 0;else{if(a.rate.length>1&&t===d.colors.childCount()){const t=a.rate.reduce((e,t)=>e+t,0);return e.value=h.format(t),void(e.color=d.valuesColor.value())}e.value=""}}),e}}},999:(e,t,i)=>{"use strict";i.r(t),i.d(t,{collectDepsForAlert:()=>g,dependenciesForAlerts:()=>v,idForAlert:()=>m,patchChildIdInInputs:()=>_,plotsForAlert:()=>f});var r=i(16282),s=i(87380),n=i(24985);var o=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},a=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},i=[];for(var r in e)t.call(e,r)&&i.push(r);return i},l=i(84819),c=i(84234),u=i.n(c),d=i(55782),h=i(31565);const p=(0,s.getLogger)("Chart.Study");function _(e,t,i){void 0!==t&&void 0!==i&&i.forEach(i=>{const r=e[i];if("string"==typeof r){const s=r.split("$")[1];e[i]=t+(void 0===s?"":"$"+s)}else if((0,h.isObject)(r)&&"source"===r.t){const e=r.v.split("$")[1];r.v=t+(void 0===e?"":"$"+e)}else p.logError("Cannot patch source input, its type is not source: "+JSON.stringify(r))})}function m(e,t,i){return(0,n.hash)(e+function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var i=t.space||"";"number"==typeof i&&(i=Array(i+1).join(" "));var r,s="boolean"==typeof t.cycles&&t.cycles,n=t.replacer||function(e,t){return t},l=t.cmp&&(r=t.cmp,function(e){return function(t,i){var s={key:t,value:e[t]},n={key:i,value:e[i]};return r(s,n)}}),c=[];return function e(t,r,u,d){var h=i?"\n"+new Array(d+1).join(i):"",p=i?": ":":";if(u&&u.toJSON&&"function"==typeof u.toJSON&&(u=u.toJSON()),void 0!==(u=n.call(t,r,u))){if("object"!=typeof u||null===u)return JSON.stringify(u);if(o(u)){for(var _=[],m=0;m<u.length;m++){var f=e(u,m,u[m],d+1)||JSON.stringify(null);_.push(h+i+f)}return"["+_.join(",")+h+"]"}if(-1!==c.indexOf(u)){if(s)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}c.push(u);var g=a(u).sort(l&&l(u));for(_=[],m=0;m<g.length;m++){var v=e(u,r=g[m],u[r],d+1);if(v){var S=JSON.stringify(r)+p+v;_.push(h+i+S)}}return c.splice(c.indexOf(u),1),"{"+_.join(",")+h+"}"}}({"":e},"",e,0)}(t)+(null!=i?i:"")).toString()}function f(e,t,i){const s=[d.isLinePlot,d.isShapesPlot,d.isCharsPlot,d.isArrowsPlot,d.isOhlcPlot,d.isAlertConditionPlot];return e.plots.map((e,t)=>({...e,pinePlotIndex:t})).filter(e=>!(void 0!==i&&!i.includes(e.id))&&s.some(t=>t(e))).map(i=>{const s={id:i.id,type:i.type,pinePlotIndex:i.pinePlotIndex,offset:t(i.id)};if(e.styles&&void 0!==e.styles[i.id]){const t=(0,r.ensureDefined)((0,r.ensureDefined)(e.styles)[i.id])
;s.title=t.title||"",s.text=t.text||""}return(0,d.isOhlcPlot)(i)&&i.target&&e.ohlcPlots&&e.ohlcPlots[i.target]&&(s.ohlcTitle=(0,r.ensureDefined)((0,r.ensureDefined)(e.ohlcPlots)[i.target]).title),s})}function g(e,t){const i=[];let s,n;for(let r=e.length-1;r>=0;r--){const o=e[r],a=(0,l.extractStudyId)(o.metaInfo().id),c=u().getStudyIdWithLatestVersion(o.metaInfo());n=o.inputsForAlertState();_(n,s,o.metaInfo().inputs.filter(e=>"source"===e.type).map(e=>e.id));const d=Object.assign({},n);o.metaInfo().isTVScript&&delete d.text;const h=m(a,d,t);i.push({id:h,study:c,inputs:n}),s=h}return{idForAlert:(0,r.ensureDefined)(s),inputsForAlert:(0,r.ensureDefined)(n),studyDependencies:i.reverse()}}function v(e,t){return e.map(e=>{const i=e.inputs(),s=e.metaInfo();let n=u().cutDollarHash(s.fullId);if("tv-scripting"===s.productId){n=(0,r.ensureNotNull)(t.findByIdSync({type:"java",studyId:"Script@tv-scripting"})).fullId}const o={id:e.sourceId(),study:n,inputs:i,scriptIdPart:void 0,scriptVersion:void 0};return s.pine?{...o,scriptIdPart:s.scriptIdPart,scriptVersion:s.pine.version}:o})}},676:(e,t,i)=>{"use strict";i.d(t,{StudyBase:()=>at});var r=i(16282),s=i(87380),n=i(68724),o=i(44197),a=i(8155),l=i(77018),c=i(55055),u=i(82379);var d=i(999),h=i(96276),p=i.n(h),_=i(43854),m=i(59757),f=i(40989),g=i(84234),v=i.n(g),S=i(67642),y=i(69647),b=i(55068),w=i(36367);class P extends b.StudyDataWindowView{constructor(e,t){super(e,t),this._showStudyValues=t.properties().paneProperties.legendProperties.showStudyValues,this._showStudyValues.subscribe(this,this.update)}isValuesVisible(){return this._showStudyValues.value()}additional(){return null}destroy(){this._showStudyValues.unsubscribeAll(this)}_createValuesProvider(e,t){return new w.StudyLegendValuesProvider(e,t)}}var C=i(14397),T=i(14716),x=i(43607),I=i(30805),L=i(21218),M=i(56885),E=i(31565),A=i(80790),k=i(55782),D=i(66726);class R{constructor(e,t,i=!1){this.price=t,this.index=e,this.useMainSeriesForPriceRange=i}}var N=i(55401);function O(e,t,i,s){if(e.y1===e.y2)return function(e,t,i){const{x1:s,x2:n,y1:o,y2:a}=e;let l;switch((0,r.assert)(o===a),e.extend){case N.DwgLineExtend.Both:l=!0;break;case N.DwgLineExtend.Right:l=null===n||null===s||s<=i;break;case N.DwgLineExtend.Left:l=null===n||n>=t;break;default:l=null!==s&&null!==n?!(s<t&&n<t||s>i&&n>i):null===s&&null!==n&&n>=t||null===n&&null!==s&&s<=i}return l?[new R(t,e.y1,!1),new R(i,e.y2,!1)]:[]}(e,i,s);const n=[];return null!==e.x1&&n.push(new R(e.x1,e.y1,!1)),null!==e.x2&&n.push(new R(e.x2,e.y2,!1)),n}var V=i(57123);function B(e,t,i,r){const{left:s,right:n}=e;let o;switch(e.extend){case V.DwgBoxExtend.Both:o=!0;break;case V.DwgBoxExtend.Right:o=null===n||null===s||s<=r;break;case V.DwgBoxExtend.Left:o=null===n||n>=i;break;default:o=null!==s&&null!==n?!(s<i&&n<i||s>r&&n>r):null===s&&null!==n&&n>=i||null===n&&null!==s&&s<=r}return o?[new R(i,e.top,!1),new R(r,e.bottom,!1)]:[]}var F=i(66769);function W(e,t,i,r){let s;const n=e.yloc!==F.DwgLabelYloc.Price&&e.yloc!==F.DwgLabelYloc.Auto;if(n){
const i=e.yloc===F.DwgLabelYloc.AboveBar?2:3,r=t.valueAt(e.x);null!==r&&(s=r[i])}else s=e.y;return null==s?null:[new R(e.x,s,n)]}class U{constructor(e,t,i,r,s){this._map=e,this._study=t,this._bars=t.series().bars(),this._props=t.properties().graphics[i],this._getPoints=r,this._getMargins=s}groupPriceRange(e,t){let i=null;return this._map.forEach((r,s)=>{this._props[s].visible.value()&&r.forEach(r=>{const s=this._getPoints(r,this._bars,e,t);if(null===s)return;let n=1/0,o=-1/0,a=!1,l=!1,c=!1;for(const i of s){const r=i.index<=t,s=i.index>=e;a=a||r,l=l||s,c=c||r&&s;let u=i.price,d=i.price;if(i.useMainSeriesForPriceRange){const e=this._bars.valueAt(i.index);if(null===e)return;const t=e[2];if(null==t)return;const r=e[3];if(null==r)return;u=r,d=t}u<n&&(n=u),d>o&&(o=d)}if(!(c||a&&l))return;const u=new m.PriceRange(n,o);i=null===i?u:i.merge(u)})}),i}firstValue(e,t){let i=1/0,r=1/0,s=-1/0,n=1/0,o=1/0,a=1/0;return this._map.forEach((l,c)=>{this._props[c].visible.value()&&l.forEach(l=>{const c=this._getPoints(l,this._bars,e,t);if(null!==c)for(const l of c){const c=l.index;c<e&&c>s?(s=c,n=l.price):c>t&&c<o?(o=c,a=l.price):c<i&&(i=c,r=l.price)}})}),{firstVisible:i===1/0?null:new R(i,r),leftClosest:s===-1/0?null:new R(s,n),rightClosest:o===1/0?null:new R(o,a)}}groupPixelMargins(e,t){const i={topPixelMargin:0,bottomPixelMargin:0};if(null===this._study.priceScale())return i;return null===this._study.firstValue()||this._map.forEach((r,s)=>{this._props[s].visible.value()&&r.forEach(r=>{const s=this._getPoints(r,this._bars,e,t);if(null===s)return;if(0===s.filter(i=>{const r=i.index;return r>=e&&r<=t}).length)return;const n=this._getMargins(r,this._bars);i.bottomPixelMargin=Math.max(i.bottomPixelMargin,n.bottomPixelMargin),i.topPixelMargin=Math.max(i.topPixelMargin,n.topPixelMargin)})}),i}}function H(e,t,i){const r=e.graphics(),s=()=>({bottomPixelMargin:0,topPixelMargin:0});return[new U(r.dwglabels(),e,"dwglabels",W,D.calculateDwgLabelsMargins.bind(null,e)),new U(r.dwglines(),e,"dwglines",O,s),new U(r.dwgboxes(),e,"dwgboxes",B,s)]}function z(e,t,i){return null===t?e:null===e?t:e.index<t.index?i?t:e:i?e:t}class j{constructor(){this.firstVisible=null,this.leftClosest=null,this.rightClosest=null}improve(e){this.firstVisible=z(this.firstVisible,e.firstVisible,!0),this.leftClosest=z(this.leftClosest,e.leftClosest,!0),this.rightClosest=z(this.rightClosest,e.rightClosest,!1)}bestPrice(){return null!==this.firstVisible?this.firstVisible.price:null!==this.leftClosest?this.leftClosest.price:null!==this.rightClosest?this.rightClosest.price:null}}var Y=i(58241),G=i(22842),q=i(72927),X=i(50946),$=i(56288);class K{constructor(e){this._data=e}draw(e,t){}drawBackground(e,t){e.save();const i=this._data,r=t.pixelRatio;let s=null;const n=Math.round(this._data.w*r);for(let t=0;t<i.items.length;++t){const o=i.items[t];if(null==o.color){s=null;continue}e.fillStyle=o.color;const a=Math.round(o.x*r);let l=a;if(t>0){i.items[t-1].index===o.index-1&&null!==s&&(l=s+1)}const c=a+n,u=c-l+1;e.fillRect(l,Math.round(i.y*r),u,Math.round(i.h*r)),s=c}e.restore()}
hitTest(e){return null}}var J=i(91677),Z=i(96625);class Q{constructor(e,t,i,s){this._items=[],this._invalidated=!0,this._isMarkersEnabled=G.enabled("source_selection_markers"),this._study=e,this._series=t,this._model=i,this._plotName=s;const n=this._study.metaInfo().plots;for(let e=0;e<n.length;e++){const t=n[e];t.id===this._plotName&&(this._plotIndex=e,(0,r.assert)((0,k.isBgColorerPlot)(t),"Plot '"+this._plotName+"' is not a background colorer!"))}this._colorProvider=(0,Z.createStudyPlotColorProvider)(e.metaInfo(),e.properties(),s)}items(){return this._items}update(){this._invalidated=!0}renderer(){if(!this._study.properties().styles[this._plotName].visible)return null;if(!this._study.properties().styles[this._plotName].visible.value())return null;if(!this._scalesReady())return null;this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={items:this._items,y:0,h:(0,r.ensureNotNull)(this._study.priceScale()).height(),w:this._model.timeScale().barSpacing()},t=new $.CompositeRenderer;return t.append(new K(e)),t}_scalesReady(){const e=this._model.timeScale(),t=this._study.priceScale();return e&&!e.isEmpty()&&null!==t&&!t.isEmpty()}_getTranspValue(){const e=this._study.properties().styles[this._plotName];let t=0;return e.transparency&&(t=e.transparency.value(),t=(0,E.isNumber)(t)?t:40),t}_updateImpl(){this._items=[],(0,r.assert)(this._scalesReady(),"Scales must be ready!");const e=this._model.timeScale().visibleBarsStrictRange();if(null===e)return;const t=this._getTranspValue();let i=(0,r.ensureDefined)(this._series.nearestIndex(e.firstBar(),f.PlotRowSearchMode.NearestRight)),s=(0,r.ensureDefined)(this._series.nearestIndex(e.lastBar(),f.PlotRowSearchMode.NearestLeft));const n=this._study.offset(this._plotName);n>0?(i-=n,s+=n):(i+=n,s-=n);const o=this._study.getMinFirstBarIndexForPlot(this._plotName);if(o>s)return;i=Math.max(o,i);const a=this._study.data().rangeIterator(i,s);for(;a.hasNext();){const e=a.next();let i=e.index;const s=e.value;i+=n;const o=new q.Point(Math.floor(i)-.5,NaN);let l=(0,E.isNumber)(t)?t:50;l=Math.min(l,100),l=Math.max(l,0);const c=this._colorProvider.getPlotPointStyle(s);void 0!==c.colors[J.ColorerType.Background]&&(o.color=(0,X.generateColor)((0,r.ensureDefined)(c.colors[J.ColorerType.Background]),l)),o.index=i,this._items.push(o)}this._model.timeScale().timedValuesToCoordinates(this._items)}}var ee=i(26184),te=i(82814),ie=i(84162),re=i(62288),se=i(5722),ne=i(46561),oe=i(8278),ae=i(12029),le=i(35803),ce=i(55625),ue=i(26438),de=i(19028),he=i(58305),pe=i(54452),_e=i(78029);const me=new Map;me.set("PaneRendererArrowUp",oe.PaneRendererArrowUp),me.set("PaneRendererArrowDown",oe.PaneRendererArrowDown),me.set("PaneRendererCircleShape",ae.PaneRendererCircleShape),me.set("PaneRendererCrossShape",le.PaneRendererCrossShape),me.set("PaneRendererDiamond",ce.PaneRendererDiamond),me.set("PaneRendererFlagShape",ue.PaneRendererFlagShape),me.set("PaneRendererLabelUp",de.PaneRendererLabelUp),me.set("PaneRendererLabelDown",de.PaneRendererLabelDown),me.set("PaneRendererSquare",he.PaneRendererSquare),
me.set("PaneRendererTriangleApexUp",pe.PaneRendererTriangleApexUp),me.set("PaneRendererTriangleApexDown",pe.PaneRendererTriangleApexDown),me.set("PaneRendererXCross",_e.PaneRendererXCross);class fe{constructor(e,t,i,r){this._items=[],this._invalidated=!1,this._renderer=null,this._isMarkersEnabled=G.enabled("source_selection_markers"),this._selectionData=null,this._plotIndex=null,this._topCoord=0,this._bottomCoord=0,this._study=e,this._series=t,this._model=i,this._plotName=r;const s=e.metaInfo().plots;for(let e=0;e<s.length;e++)if(s[e].id===this._plotName){this._plotIndex=e;break}this._colorProvider=(0,Z.createStudyPlotColorProvider)(e.metaInfo(),e.properties(),r),this._selectionIndexer=new se.SelectionIndexes(i.timeScale())}items(){return this._items}update(){this._invalidated=!0}renderer(){if(!this._study.properties().styles[this._plotName].visible)return null;if(!this._study.properties().styles[this._plotName].visible.value())return null;if(!this._scalesReady())return null;if(this._invalidated){const e=this._study.properties().styles[this._plotName];this._updateRenderer(e),this._invalidated=!1}return this._renderer}_scalesReady(){const e=this._model.timeScale(),t=this._study.priceScale();return e&&null!==t&&!e.isEmpty()&&!t.isEmpty()}_updateImpl(){if(this._items=[],!this._scalesReady())return;const e=this._model.timeScale(),t=this._study.priceScale(),i=e.visibleBarsStrictRange();if(null===i||null===t)return;let s=this._series.nearestIndex(i.firstBar(),f.PlotRowSearchMode.NearestRight),n=this._series.nearestIndex(i.lastBar(),f.PlotRowSearchMode.NearestLeft);if(void 0===s||void 0===n)return;const o=this._study.offset(this._plotName);o>0?(s-=o,n+=o):(s+=o,n-=o);const a=this._study.getMinFirstBarIndexForPlot(this._plotName);if(a>n)return;s=Math.max(a,s);const l=this._study.data(),c=this._study.firstValue();if(null===c)return;const u=l.rangeIterator(s,n),d=this._getTranspValue();let h=[];const p=this._model.selection().isSelected(this._study);p?(h=this._selectionIndexer.indexes(),this._selectionData={points:[],hittestResult:re.HitTestResult.REGULAR,vertOffset:0,bgColors:[],barSpacing:e.barSpacing(),visible:!0}):(this._selectionIndexer.clear(),this._selectionData=null);const _=this._series.properties().childs().style.value(),m=2===_?"lineStyle":3===_?"areaStyle":null;let g,v;m?(g=this._series.properties().childs()[m].childs().priceSource.value(),v=g):(g="high",v="low");const S=t.isInverted(),y=t.coordinateToPrice(t.height()*t.topMargin(),c),b=t.coordinateToPrice(t.height()*(1-t.bottomMargin()),c);this._topCoord=S?b:y,this._bottomCoord=S?y:b;const w=(0,r.ensureNotNull)(this._model.paneForSource(this._study)).height(),P=this._study.properties().styles[this._plotName],C=P.color.value(),T=P.textColor?P.textColor.value():void 0,x=C,I=C,L=void 0===T?void 0:T,M=(0,r.ensureNotNull)(this._plotIndex),E=(0,J.createEmptyStyle)();for(;u.hasNext();){const e=u.next(),t=e.index,i=e.value,r=Math.floor(t+o),s=i[M+1];if(null==s)continue;const n=this._createItem(r,s,g,v);if(null!==n){if(this._colorProvider.isColorDefined()){n.style={
color:x,borderColor:I,textColor:L};const e=this._colorProvider.getPlotPointStyle(i,E);this._fillItemWithPointStyle(n,e,d)}p&&-1!==h.indexOf(t)&&null!==this._selectionData&&(this._selectionData.points.push(n),this._selectionData.bgColors.push(this._model.backgroundColorAtYPercentFromTop(n.y/w))),this._items.push(n)}}this._convertItemsToCoordinates()}_fillItemWithPointStyle(e,t,i){const s=(0,r.ensureDefined)(e.style);if(void 0!==t.colors[J.ColorerType.Main]){s.color=(0,X.generateColor)((0,r.ensureDefined)(t.colors[J.ColorerType.Main]),i);const e=i>9?i-10:0;s.borderColor=(0,X.generateColor)(s.color,e)}void 0!==t.colors[J.ColorerType.Text]&&(s.textColor=(0,X.generateColor)((0,r.ensureDefined)(t.colors[J.ColorerType.Text]),i))}_updateRenderer(e){this._updateImpl();const t=this._model.timeScale(),i={},r=this._getTranspValue(),s=t.barSpacing(),n=this._calculateShapeHeight(s),o=this._study.properties().styles[this._plotName].location.value(),a=this._calculateVerticalOffset(o,n+n/2);i.barSpacing=s,i.items=this._items,i.color=(0,X.generateColor)(this._study.properties().styles[this._plotName].color.value(),r),i.height=n,i.vertOffset=a;const l=this._study.properties().styles[this._plotName].plottype.value(),c=te.plotShapesData[l],u=new $.CompositeRenderer;c&&u.append(this._createRenderer(c.paneRendererClass,i)),this._model.selection().isSelected(this._study)&&this._isMarkersEnabled&&null!==this._selectionData&&(this._selectionData.vertOffset=a,u.append(new ee.SelectionRenderer(this._selectionData))),this._renderer=u}_createRenderer(e,t){const i=me.get(e);return new((0,r.ensureDefined)(i))(t)}_getSeriesVal(e,t){const i=(0,ne.barFunction)(e),r=this._series.data().valueAt(t);return null===r?null:i(r)}_getTranspValue(){let e=0;this._study.properties().transparency&&(e=this._study.properties().transparency.value(),e=(0,E.isNumber)(e)?e:50);const t=this._study.properties().styles[this._plotName];return t.transparency&&(e=t.transparency.value(),e=(0,E.isNumber)(e)?e:50),(0,ie.clamp)(e,0,100)}_createItem(e,t,i,s){const n=this._study.properties().styles[this._plotName].location.value();if((null===t||0===t)&&n!==y.MarkLocation.Absolute)return null;let o;switch(n){case y.MarkLocation.AboveBar:const a=this._getSeriesVal(i,e);if(null===a)return null;o=a;break;case y.MarkLocation.BelowBar:const l=this._getSeriesVal(s,e);if(null===l)return null;o=l;break;case y.MarkLocation.Top:o=this._topCoord;break;case y.MarkLocation.Bottom:o=this._bottomCoord;break;case y.MarkLocation.Absolute:o=(0,r.ensureNotNull)(t);break;default:throw new Error("Bad value: "+n)}return new q.Point(e,o)}_convertItemsToCoordinates(){const e=this._model.timeScale(),t=this._study.priceScale();e.timedValuesToCoordinates(this._items);const i=(0,r.ensureNotNull)(this._study.firstValue());(0,r.ensureNotNull)(t).pointsArrayToCoordinates(this._items,i)}_calculateVerticalOffset(e,t){let i=0;switch(e){case y.MarkLocation.AboveBar:case y.MarkLocation.Bottom:i=-t;break;case y.MarkLocation.BelowBar:case y.MarkLocation.Top:i=t}return(0,
r.ensureNotNull)(this._study.priceScale()).isInverted()&&(i*=-1),i}_calculateShapeHeight(e,t){let i=e;switch(t){case k.PlotSymbolSize.Tiny:i=.3*e;break;case k.PlotSymbolSize.Small:i=.6*e;break;case k.PlotSymbolSize.Normal:i=e;break;case k.PlotSymbolSize.Large:i=1.5*e;break;case k.PlotSymbolSize.Huge:i=2*e}return i}}class ge extends fe{renderer(){const e=this._study.properties().styles[this._plotName];return e.visible&&e.visible.value()&&this._scalesReady()?(this._invalidated&&(this._updateRenderer(e),this._invalidated=!1),this._renderer):null}_updateRenderer(e){this._updateImpl();const t=this._model.timeScale(),i={},r=this._getTranspValue(),s=t.barSpacing();let n;if(e.size){const t=e.size.value();n=this._calculateShapeHeight(25,t)}else n=Math.round(s/2);n=Math.max(n,1);const a=e.location.value(),l=(0,X.generateColor)(e.color.value(),r),c=r>19?r-10:0,u=this._calculateVerticalOffset(a,Math.round(1.5*n));i.barSpacing=s,i.items=this.items(),i.color=l,i.borderColor=(0,X.generateColor)(e.color.value(),c),i.height=n,i.vertOffset=u;const d=e.plottype.value(),h=te.plotShapesData[d],p=new $.CompositeRenderer,_=e.text?e.text.value():void 0;if(void 0!==_&&""!==_.trim()){let t=_.trim().replace(/\\n/gm,"\n");t=(0,o.cleanButAmpersand)(t,!0),i.text=t,i.fontSize=12;const s=e.textColor?e.textColor.value():void 0;i.textColor=s?(0,X.generateColor)(s,r):l}p.append(super._createRenderer(h.paneRendererClass,i)),this._model.selection().isSelected(this._study)&&this._isMarkersEnabled&&null!==this._selectionData&&(this._selectionData.vertOffset=u,p.append(new ee.SelectionRenderer(this._selectionData))),this._renderer=p}}var ve=i(68277),Se=i.n(ve),ye=i(56017),be=i(34250),we=i(39304),Pe=i(10175);class Ce extends ye.PaneRendererAbstractShape{constructor(e,t){super(null,t),this._heightEnsured=0,this._ch="",this._fontFamily=we.CHART_FONT_FAMILY,this._charCache=null,null!==e&&this.setData(e)}setData(e){super.setData(e),this._heightEnsured=(0,r.ensureDefined)(this._height);const t=e.char.slice(0,40);this._ch=Se()(t)[0]||" ",this._fontFamily=e.fontFamily||we.CHART_FONT_FAMILY}hitTest(e){const t=(0,be.interactionTolerance)().series+this._heightEnsured/2;for(const i of this._items){if(new q.Point(i.x,i.y+i.vertOffset).subtract(e).length()<=t)return new re.HitTestResult(re.HitTestResult.REGULAR)}return null}_drawItemShape(e,t,i){const r=i.x,s=i.vertOffset>0?1:-1,n=i.y+i.vertOffset-s*Math.round(this._heightEnsured/2);let o;o=i.style&&void 0!==i.style.color?i.style.color:this._color,this._textImageCache().paintTo(e,t,o,r,n,Pe.HorizontalAlign.Center,i.vertOffset>0?Pe.VerticalAlign.Top:Pe.VerticalAlign.Bottom)}_startPath(e,t,i,r){}_endPath(e){}_textImageCache(){return null!==this._charCache&&this._charCache.fontFamily===this._fontFamily&&this._charCache.fontSize===this._heightEnsured||(this._charCache={fontSize:this._heightEnsured,fontFamily:this._fontFamily,cache:new Pe.TextImageCache(this._ch,!1,!1,this._fontFamily,this._heightEnsured)}),this._charCache.cache}}class Te extends fe{constructor(){super(...arguments),
this._compositeRenderer=new $.CompositeRenderer,this._charRenderer=new Ce(null)}renderer(){const e=this._study.properties().styles[this._plotName];return e.visible&&e.visible.value()&&this._scalesReady()?(this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._compositeRenderer):null}_updateImpl(){if(this._compositeRenderer.clear(),super._updateImpl(),0===this._items.length)return;const e=this._getTranspValue(),t=this._model.timeScale().barSpacing();let i;const r=this._study.properties().styles[this._plotName];if(r.size){const e=r.size.value();i=this._calculateShapeHeight(50,e)}else i=Math.round(t);const s=r.location.value(),n=(0,X.generateColor)(r.color.value(),e),a=this._calculateVerticalOffset(s,i),l={items:this.items(),barSpacing:t,char:r.char.value(),height:i,vertOffset:a,color:n},c=r.text?r.text.value():void 0;if(void 0!==c&&""!==c.trim()){let t=c.trim().replace(/\\n/gm,"\n");t=(0,o.cleanButAmpersand)(t,!0),l.text=t,l.fontSize=12;const i=r.textColor?r.textColor.value():void 0;l.textColor=i?(0,X.generateColor)(i,e):n}this._charRenderer.setData(l),this._compositeRenderer.append(this._charRenderer),this._model.selection().isSelected(this._study)&&this._isMarkersEnabled&&null!==this._selectionData&&(this._selectionData.vertOffset=a,this._compositeRenderer.append(new ee.SelectionRenderer(this._selectionData)))}}var xe=i(14563);class Ie extends q.Point{constructor(e,t,i,r){super(e,t),this.height=i,this.isUp=r,this.style={}}}function Le(e){return Math.round(e/4)}function Me(e){return Math.round(e/2)}class Ee{constructor(e){this._data=e}draw(e,t){var i;const r=t.pixelRatio,s=this._data,n=Me(s.barSpacing),o=Le(s.barSpacing),a=n<4,l=Math.max(n/2,1),c=(0,ie.ceiledEven)(n*r),u=c/2,d=Math.round(n*r);e.lineCap="butt",e.lineWidth=Math.max(1,Math.floor(r));const h=e.lineWidth%2?.5:0;for(const t of s.items){const n=t.isUp?-1:1,p=Math.round(Math.abs(t.height)*r),_=Math.round(t.x*r)+h,m=Math.round((t.y-n*o)*r)+h;e.beginPath(),e.translate(_,m);const f=null!==(i=t.style&&t.style.color)&&void 0!==i?i:t.isUp?s.colorup:s.colordown;a?(e.moveTo(0,0),e.lineTo(-u,-u*n),e.moveTo(0,0),e.lineTo(u,-u*n),e.moveTo(0,0),e.lineTo(0,-p*n),e.moveTo(-u,-p*n),e.lineTo(u,-p*n),e.lineWidth=l,e.strokeStyle=f,e.stroke()):(e.moveTo(0,0),p<d?(e.lineTo(c,-p*n),e.lineTo(-c,-p*n)):(e.lineTo(c,-d*n),e.lineTo(u,-d*n),e.lineTo(u,-p*n),e.lineTo(-u,-p*n),e.lineTo(-u,-d*n),e.lineTo(-c,-d*n)),e.lineTo(0,0),e.strokeStyle=t.isUp?s.colorBorderUp:s.colorBorderDown,e.stroke(),e.fillStyle=f,e.fill()),e.translate(-_,-m)}}hitTest(e){const t=this._data,i=Me(t.barSpacing),r=Math.round(i/2),s=Math.round(i),n=Le(t.barSpacing);for(const i of t.items){if(!i)continue;if(!Number.isFinite(i.x)||!Number.isFinite(i.y))continue;const t=Math.abs(i.height),o=i.isUp?-1:1,a=t+s,l=i.y-o*n,c=l-o*a,u=i.x-r,d=i.x+r;if(u<e.x&&e.x<d&&(i.isUp?l<e.y&&e.y<c:c<e.y&&e.y<l))return new re.HitTestResult(re.HitTestResult.REGULAR)}return null}}class Ae extends ee.SelectionRenderer{_drawMarker(e,t,i,s,n){const o=(0,r.ensureNotNull)(this._data),a=t.isUp?1:-1
;const l=i+a*Le(o.barSpacing)+a*Me(o.barSpacing);let c=Math.round(3.5*n*2);c%2!=s%2&&(c+=1);const u=s%2/2,d=Math.round(t.x*n)+u,h=Math.round((t.y+l)*n)+u;e.beginPath(),e.arc(d,h,c/2,0,2*Math.PI,!0),e.closePath(),e.fill(),e.stroke()}}class ke extends fe{constructor(){super(...arguments),this._maxAbsValue=0}renderer(){if(!this._study.properties().styles[this._plotName].visible)return null;if(!this._study.properties().styles[this._plotName].visible.value())return null;if(!this._scalesReady())return null;this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={},t=(0,ie.clamp)(this._getTranspValue(),0,100),i=this._model.timeScale().barSpacing();e.items=this._items,e.barSpacing=i,e.colorup=(0,X.generateColor)(this._study.properties().styles[this._plotName].colorup.value(),t),e.colordown=(0,X.generateColor)(this._study.properties().styles[this._plotName].colordown.value(),t);const r=(0,xe.parseRgba)(e.colorup),s=r?100*(1-r[3]):0,n=(0,xe.parseRgba)(e.colordown),o=n?100*(1-n[3]):0;e.colorBorderUp=(0,X.generateColor)("#000000",s),e.colorBorderDown=(0,X.generateColor)("#000000",o),e.minHeight=this._study.properties().styles[this._plotName].minHeight.value(),e.maxHeight=this._study.properties().styles[this._plotName].maxHeight.value();const a=new $.CompositeRenderer;if(a.append(new Ee(e)),this._model.selection().isSelected(this._study)&&null!==this._selectionData){const e=this._selectionData;e.barSpacing=i,a.append(new Ae(e))}return a}_fillItemWithPointStyle(e,t,i){const s=(0,r.ensureDefined)(e.style);e.isUp?void 0!==t.colors[J.ColorerType.Up]?s.color=(0,X.generateColor)((0,r.ensureDefined)(t.colors[J.ColorerType.Up]),i):s.color=(0,X.generateColor)(this._study.properties().styles[this._plotName].colorup.value(),i):void 0!==t.colors[J.ColorerType.Down]?s.color=(0,X.generateColor)((0,r.ensureDefined)(t.colors[J.ColorerType.Down]),i):s.color=(0,X.generateColor)(this._study.properties().styles[this._plotName].colordown.value(),i)}_createItem(e,t,i,r){if(0===t)return null;Math.abs(t)>this._maxAbsValue&&(this._maxAbsValue=Math.abs(t));const s=t>0;let n;if(s){const t=this._getSeriesVal(r,e);if(null===t)return null;n=t}else{const t=this._getSeriesVal(i,e);if(null===t)return null;n=t}return new Ie(e,n,t,s)}_convertItemsToCoordinates(){const e=this._model.timeScale(),t=(0,r.ensureNotNull)(this._study.priceScale());e.timedValuesToCoordinates(this._items),t.pointsArrayToCoordinates(this._items,(0,r.ensureNotNull)(this._study.firstValue()));let i=Math.abs(this._study.properties().styles[this._plotName].minHeight.value()),s=Math.abs(this._study.properties().styles[this._plotName].maxHeight.value());if(i>s){const e=i;i=s,s=e}const n=(s-i)/this._maxAbsValue,o=this._items;for(let e=0;e<o.length;e++){const t=o[e],r=Math.abs(t.height);t.height=r*n+i}}}var De=i(30807);class Re{constructor(e,t,i,r){this._bars=[],this._invalidated=!1,this._isMarkersEnabled=G.enabled("source_selection_markers"),this._selectionData=null,this._ohlcPlotIndexes=new Map,this._study=e,this._series=t,this._model=i,this._plotName=r,
this._isMarkersEnabled=G.enabled("source_selection_markers"),this._colorProvider=(0,Z.createStudyPlotColorProvider)(e.metaInfo(),e.properties(),r),this._selectionIndexer=new se.SelectionIndexes(i.timeScale());const s=this._study.metaInfo().plots;for(let e=0;e<s.length;e++){const t=s[e];"target"in t&&(t.target===this._plotName&&((0,k.isOhlcOpenPlot)(t)&&this._ohlcPlotIndexes.set(1,e),(0,k.isOhlcHighPlot)(t)&&this._ohlcPlotIndexes.set(2,e),(0,k.isOhlcLowPlot)(t)&&this._ohlcPlotIndexes.set(3,e),(0,k.isOhlcClosePlot)(t)&&this._ohlcPlotIndexes.set(4,e)))}}update(){this._invalidated=!0}items(){return this._bars}_updateImpl(){this._bars.length=0;const e=this._study.priceScale();if(this._model.timeScale().isEmpty()||null===e||e.isEmpty())return;const t=this._model.timeScale().visibleBarsStrictRange();if(null===t)return;let i=this._series.nearestIndex(t.firstBar(),f.PlotRowSearchMode.NearestRight);const s=this._series.nearestIndex(t.lastBar(),f.PlotRowSearchMode.NearestLeft);if(void 0===i||void 0===s)return;const n=this._study.getMinFirstBarIndexForPlot(this._plotName);if(n>s)return;i=Math.max(n,i);const o=this._study.data(),a=this._study.firstValue();if(null===a)return;const l=o.rangeIterator(i,s),c=this._study.properties().ohlcPlots[this._plotName],u=new Map,d=(e,t)=>{const i=e+"@"+t;if(!u.has(i)){const r=(0,X.generateColor)(e,t);return u.set(i,r),r}return u.get(i)},h=(0,J.createEmptyStyle)();for(;l.hasNext();){const e=l.next();let t=e.index;const i=e.value;t=Math.floor(t);let s=!0;const n=new Map;for(let e=1;e<=4;++e){const t=this._ohlcPlotIndexes.get(e);if(void 0===t){s=!1;break}const r=i[t+1];if(null==r){s=!1;break}n.set(e,r)}if(!s)continue;const o=(0,r.ensureDefined)(n.get(1)),a=(0,r.ensureDefined)(n.get(4)),u=(0,r.ensureDefined)(n.get(2)),p=(0,r.ensureDefined)(n.get(3)),_=Math.max(o,u,p,a),m=Math.min(o,u,p,a);let f=(0,r.ensureDefined)(d(c.color.value(),0));const g=this._colorProvider.getPlotPointStyle(i,h);void 0!==g.colors[J.ColorerType.Main]&&(f=(0,r.ensureDefined)(g.colors[J.ColorerType.Main]));const v={time:Math.round(t),open:o,high:_,low:m,close:a,color:f,wickColor:g.colors[J.ColorerType.Wick],borderColor:g.colors[J.ColorerType.Border],hollow:null};this._bars.push(v)}if(e.barPricesToCoordinates(this._bars,a),this._model.timeScale().barIndexesToCoordinates(this._bars),this._model.selection().isSelected(this._study)){const t=this._selectionIndexer.indexes();this._selectionData={points:[],hittestResult:re.HitTestResult.REGULAR,bgColors:[],visible:!0,barSpacing:this._model.timeScale().barSpacing()};const i=(0,r.ensureNotNull)(this._model.paneForSource(this._study)).height(),s=(0,r.ensureDefined)(this._ohlcPlotIndexes.get(4));for(let r=0;r<t.length;r++){const n=t[r],o=this._study.data().valueAt(n);if(null===o)continue;const l=o[s+1];if(null==l)continue;const c=this._model.timeScale().indexToCoordinate(Math.floor(n)),u=e.priceToCoordinate(l,a);this._selectionData.points.push(new q.Point(c,u)),this._selectionData.bgColors.push(this._model.backgroundColorAtYPercentFromTop(u/i))}}else this._selectionIndexer.clear()}}
class Ne extends Re{renderer(){if(!this._study.properties().ohlcPlots[this._plotName].visible.value())return null;this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={bars:this._bars,barSpacing:this._model.timeScale().barSpacing(),dontDrawOpen:this._series.properties().childs().barStyle.childs().dontDrawOpen.value(),thinBars:this._series.properties().childs().barStyle.childs().thinBars.value()},t=new $.CompositeRenderer;return t.append(new De.PaneRendererBars(e)),this._model.selection().isSelected(this._study)&&this._isMarkersEnabled&&this._selectionData&&t.append(new ee.SelectionRenderer(this._selectionData)),t}}var Oe=i(67003);class Ve extends Re{renderer(){const e=this._study.properties().ohlcPlots[this._plotName];if(!e.visible.value())return null;this._invalidated&&(this._updateImpl(),this._invalidated=!1);const t=this._model.timeScale().barSpacing(),i={bars:this._bars,barSpacing:t,wickVisible:e.drawWick.value(),bodyVisible:!0,borderVisible:e.drawBorder.value(),barWidth:(0,be.optimalBarWidth)(t),borderColor:e.borderColor.value(),wickColor:e.wickColor.value()},r=new $.CompositeRenderer;return r.append(new Oe.PaneRendererCandles(i)),this._model.selection().isSelected(this._series)&&this._isMarkersEnabled&&this._selectionData&&r.append(new ee.SelectionRenderer(this._selectionData)),r}}var Be=i(63956),Fe=i(39426),We=i(17627),Ue=i(3707);class He extends We.HorizontalLinePaneView{constructor(e,t){super(),this._lineRendererData.linestyle=Ue.LINESTYLE_DOTTED,this._study=e,this._plotName=t}_updateImpl(){this._lineRendererData.visible=!1;const e=this._study.properties().styles[this._plotName];if(!e.trackPrice.value())return;const t=this._study.lastValueData(this._plotName,!0);t.noData||(this._lineRendererData.visible=!0,this._lineRendererData.y=t.coordinate,this._lineRendererData.color=t.color,this._lineRendererData.linewidth=e.linewidth.value())}}var ze=i(90542),je=i(57778);class Ye extends je.AbstractFilledAreaPaneView{constructor(e,t,i,s){super(e,t,!!i.fillgaps),this._isHlineFill="hline_hline"===i.type,(0,r.assert)(this._isHlineFill||"plot_plot"===i.type,"Wrong filledArea type: "+i.type),this._isHlineFill&&this._initBandIndexes(i.objAId,i.objBId),this._fillMetaInfo=i,this._fillStyleProps=s;const n=e.metaInfo();for(let t=0;t<n.plots.length;++t){const s=n.plots[t];if("palette"in s&&s.palette===i.palette){this._colorPlotIndex=t,this._colorsMap=(0,r.ensureDefined)((0,r.ensureDefined)(n.palettes)[i.palette]).valToIndex,this._colorValues=e.properties().palettes[i.palette].colors;break}if(n.isRGB&&"target"in s&&s.target===i.id){this._colorPlotIndex=t;break}}}_getColorByPlotValue(e){if(this._colorsMap){const t=(0,r.ensureDefined)(this._colorsMap)[e];return this._colorValues[(0,r.ensureDefined)(t)].childs().color.value()}return(0,X.rgbaFromInteger)(e)}_isPerBarColoringSupported(){return null!==this._colorPlotIndex}_plotAId(){return this._fillMetaInfo.objAId}_plotBId(){return this._fillMetaInfo.objBId}_color(){return this._fillStyleProps.childs().color.value()}_transparency(){
return this._fillStyleProps.childs().transparency.value()}_correctVisibleRange(e){const[t,i]=super._correctVisibleRange(e),r=this._source.getMinFirstBarIndexForPlot(this._fillMetaInfo.id);return[Math.max(r,t),i]}_visible(){return this._fillStyleProps.childs().visible.value()}_initBandIndexes(e,t){this._bandAKey=null,this._bandBKey=null;const i=this._source.metaInfo().bands;if(void 0!==i)for(let r=0;r<i.length;++r){const s=i[r];null!==this._bandAKey||s.id!==e?null===this._bandBKey&&s.id===t&&(this._bandBKey=r):this._bandAKey=r}}}var Ge=i(11258);class qe{constructor(e,t){this._invalidated=!0,this._lineRenderer=new Ge.HorizontalLineRenderer,this._source=t,this._points=[new q.Point(-1,-1)],this._invalidated=!0,this._properties=e}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={y:this._points[0].y,color:this._properties.childs().color.value(),linewidth:this._properties.childs().linewidth.value(),linestyle:this._properties.childs().linestyle.value()};return this._lineRenderer.setData(e),this._lineRenderer}_updateImpl(){const e=this._source.priceScale();if(!e||e.isEmpty())return void(this._points[0]=new q.Point(-1,-1));const t=this._properties.childs().value.value(),i=this._source.firstValue(),r=(0,E.isNumber)(t)&&null!==i?e.priceToCoordinate(t,i):NaN;this._points[0]=new q.Point(-1,r)}}var Xe=i(29295);class $e extends Xe.ScaledPaneRenderer{constructor(){super(),this._data=null,this._data=null}setData(e=null){this._data=e}hitTest(){return null}_drawImpl(e,t){if(null===this._data||0===this._data.points.length)return;const i=t.cssWidth;e.fillStyle=(0,X.generateColor)(this._data.backcolor,this._data.transparency);const r=Math.min(this._data.points[0],this._data.points[1]),s=Math.max(this._data.points[0],this._data.points[1]);e.fillRect(0,r,i,s-r)}}class Ke{constructor(e){this._points=[],this._bandBgRenderer=new $e,this._source=e}update(){if(this._points=[],this._source.properties().bands.length<2)return;if(!this._source.properties().bandsBackground.fillBackground.value())return;const e=this._source.properties().bands[0],t=this._source.properties().bands[1],i=this._source.priceScale(),r=this._source.firstValue();i&&!i.isEmpty()&&null!==r&&(this._points.push(i.priceToCoordinate(e.value.value(),r)),this._points.push(i.priceToCoordinate(t.value.value(),r)))}renderer(){const e={points:this._points,backcolor:this._source.properties().bandsBackground.backgroundColor.value(),transparency:this._source.properties().bandsBackground.transparency.value()};return this._bandBgRenderer.setData(e),this._bandBgRenderer}}class Je{constructor(e,t,i){this._points=[],this._bandBgRenderer=new $e,this._bandAKey=null,this._bandBKey=null,this._source=e,(0,r.assert)("hline_hline"===t.type,"Wrong filledArea type: "+t.type),this._initBandIndexes(t.objAId,t.objBId),this._fillStyleProps=i,this._bandBgRenderer=new $e}update(){if(this._points=[],!this._fillStyleProps.childs().visible.value())return;if(null===this._bandAKey||null===this._bandBKey)return
;const e=this._source.properties().bands[this._bandAKey],t=this._source.properties().bands[this._bandBKey],i=this._source.priceScale(),r=this._source.firstValue();i&&!i.isEmpty()&&null!==r&&(this._points.push(i.priceToCoordinate(e.value.value(),r)),this._points.push(i.priceToCoordinate(t.value.value(),r)))}renderer(){let e=this._fillStyleProps.childs().transparency.value();e=(0,ie.clamp)(e,0,100);const t={points:this._points,backcolor:(0,X.generateColor)(this._fillStyleProps.childs().color.value(),e),transparency:this._fillStyleProps.childs().transparency.value()};return this._bandBgRenderer.setData(t),this._bandBgRenderer}_initBandIndexes(e,t){this._bandAKey=null,this._bandBKey=null;(0,r.ensureDefined)(this._source.metaInfo().bands).forEach((i,r)=>{null===this._bandAKey&&i.id===e&&(this._bandAKey=r),null===this._bandBKey&&i.id===t&&(this._bandBKey=r)})}}var Ze=i(72305),Qe=i(53423);const et=(0,s.getLogger)("Chart.Study"),tt=window.t("Invalid Symbol");const it={symbolsForDisplay:!1,symbolsForChartApi:!0,skipHiddenInputs:!1,skipFakeInputs:!1,skipBooleanInputs:G.enabled("dont_show_boolean_study_arguments"),asObject:!0,skippedGroups:[],skippedInputs:[],noExchanges:!1,noResolution:!1,keepOptionalSymbolsEmpty:!1,skipColorInputs:!1,skipTimeInputs:!1,skipOptionalEmptySymbolInputs:!1,skipTextareaInputs:!0,priceInputsForDisplay:!1},rt=G.enabled("study_symbol_ticker_description");function st(e,t){const i=e.plots[t];if(!i||!(0,k.isOhlcPlot)(i))return!1;const r=i.target,s=e.defaults.styles&&e.defaults.styles[r],n=e.defaults.ohlcPlots&&e.defaults.ohlcPlots[r],o=e.ohlcPlots&&e.ohlcPlots[r];return s&&(0,k.isOhlcPlotStyleBars)(s)||n&&(0,k.isOhlcPlotStyleBars)(n)||!!o&&(0,k.isOhlcPlotStyleBars)(o)}function nt(e,t){const i=e.plots[t];if(!i||!(0,k.isOhlcPlot)(i))return!1;const r=i.target,s=e.defaults.styles&&e.defaults.styles[r],n=e.defaults.ohlcPlots&&e.defaults.ohlcPlots[r],o=e.ohlcPlots&&e.ohlcPlots[r];return s&&(0,k.isOhlcPlotStyleCandles)(s)||n&&(0,k.isOhlcPlotStyleCandles)(n)||!!o&&(0,k.isOhlcPlotStyleCandles)(o)}function ot(e,t){(0,r.assert)(void 0!==e,"zOrder must be defined"),(0,r.assert)(!t.has(e),"zOrder must be unique")}class at extends _.PriceDataSource{constructor(e,t,i,r){super(e),this.onStart=new(p()),this._symbolsResolved=new(p()),this._statusChanged=new(p()),this._paneViews=[],this._priceAxisViews=[],this._inputsAnchorsPaneView=null,this._inputsLinesPaneView=null,this._inputsTimeAxisPaneViews=[],this._inputsPriceAxisPaneViews=[],this._resolvedSymbols={},this._resolvedSymbolsByInput={},this._isChildStudy=!1,this._status={type:Ze.StudyStatusType.Undefined},this._studyId=null,this._isSubscribedToSessionId=!1,this._titleStrCache={},this._titleInPartsCache={},this._children=[],this._numericFormatter=new A.NumericFormatter,this._priceAxisViewsBase=[],this._priceLinesAxisViews=[],this._labelPaneViews=[],this._ownFirstValue=null,this._plotOffsets={},this._formatter=null,this._pendingResolveSymbols=new Map,this._onIsActualIntervalChange=new(p()),this._lastNonEmptyPlotRowCache={},this._startMovingPoint=null,
this._processHibernateBound=this.processHibernate.bind(this),this._chartApi=e.chartApi(),this._properties=t,this._metaInfo=r,this._series=this._model.mainSeries(),this._series.onIntervalChanged().subscribe(this,this._calcIsActualInterval),this._showStudyArgumentsProperty=e.properties().paneProperties.legendProperties.showStudyArguments,e.collapsed().subscribe(this._processHibernateBound),i instanceof at&&(this._source=i,this._isChildStudy=!0,this._source.setChild(this));const s=this.parentSource();s.currencyChanged().subscribe(this,this._onSourceCurrencyChanged),s.unitChanged().subscribe(this,this._onSourceUnitChanged),s.priceRangeReadyChanged().subscribe(this,this._onSourcePriceRangeReadyChanged),s.formatterChanged().subscribe(this,this._onSourceFormatterChanged),s.priceStepChanged().subscribe(this,this._onSourcePriceStepChanged),rt&&this._model.mainSeries().properties().childs().statusViewStyle.childs().symbolTextSource.listeners().subscribe(this,()=>{this.invalidateTitleCache(!0)}),this._properties.subscribe(this,this._onPropertiesChanged),this._properties.visible.subscribe(this,this._visibleChanged),this._properties.visible.subscribe(this,this.processHibernate),this._properties.intervalsVisibilities.subscribe(this,this._calcIsActualInterval),C.hideAllIndicators().subscribe(this,this._visibleChanged);for(let e=0;e<this._metaInfo.plots.length;e++){const t=this._metaInfo.plots[e].id,i=this.properties().styles[t];null!=i&&null!=i.visible&&i.visible.subscribe(this,this.processHibernate)}for(const e of Object.keys(this._metaInfo.graphics))for(const t of Object.keys(this._metaInfo.graphics[e])){const i=this._properties.graphics[e][t];i.visible&&i.visible.subscribe(this,this.processHibernate)}this._isActualInterval=(0,Qe.isActualInterval)(this._series.intervalObj(),this.properties().intervalsVisibilities),this._initializeStudyInputsPaneViews()}destroy(){const e=this.parentSource();e.currencyChanged().unsubscribeAll(this),e.unitChanged().unsubscribeAll(this),e.priceRangeReadyChanged().unsubscribeAll(this),e.formatterChanged().unsubscribeAll(this),e.priceStepChanged().unsubscribeAll(this),this._series.properties().childs().statusViewStyle.childs().symbolTextSource.unsubscribeAll(this),this._series.onIntervalChanged().unsubscribeAll(this),this.formatterChanged().unsubscribe(this,this.invalidateTitleCache),C.hideAllIndicators().unsubscribe(this,this._visibleChanged),this._model.collapsed().unsubscribe(this._processHibernateBound)}lastValueData(e,t,i){const r={noData:!0},s=this.priceScale();if(this._model.timeScale().isEmpty()||null===s||s.isEmpty()||this.data().isEmpty())return r;const n=this._model.timeScale().visibleBarsStrictRange(),o=this.firstValue(!0);if(null===n||null===o)return r;if(!this.properties().visible.value())return r;const a=this.properties().styles,l=this.properties().ohlcPlots;let c,u;if(a&&a[e]&&(c=a[e]),l&&l[e]&&(c=l[e]),!c||!c.visible.value())return r;const d=this.metaInfo().plots;for(u=0;u<d.length;u++){const t=d[u];if(t.id===e||(0,k.isOhlcClosePlot)(t)&&t.target===e)break}
const h=u+1,p=this.offset(e),_=this.nearestIndex(n.lastBar()-p,f.PlotRowSearchMode.NearestLeft,h);if(void 0===_)return r;const m=this._lastNonEmptyPlotRow(h),g=null!==m&&n.contains(m.index),v=null!==m?m.value:null,S=t||g?v:this.data().valueAt(_);if(!S||!(0,E.isNumber)(S[h]))return r;const y=S[h],b=(0,Z.createStudyPlotColorProvider)(this.metaInfo(),this.properties(),e).getPlotPointStyle(S).colors[J.ColorerType.Main],w=s.priceToCoordinate(y,o),P=s.formatPriceAbsolute(y),C=s.formatPricePercentage(y,o,!0),T={noData:!1,text:s.isPercentage()?C:P,formattedPriceAbsolute:P,formattedPricePercentage:C,color:b||c.color.value(),floatCoordinate:w,coordinate:w};return i&&(T.price=y),T}isSymbolInvalid(){return this._status.type===Ze.StudyStatusType.Error&&this._status.errorDescription.error===tt}state(e,t){var i;const s=(0,r.ensureNotNull)((0,n.className)(this.constructor)),o=this.metaInfo();let a;o instanceof v()?a=(0,E.clone)(o.state()):(a=(0,E.clone)(this.metaInfo()),a.id=v().parseIdString(a.id+(a.version?"-"+a.version:"")).fullId);const l={type:s,id:this.id(),state:this.properties().state(),zorder:this.zorder(),ownFirstValue:this.isVisible()?null:this._ownFirstValue,metaInfo:a};e&&(l.data=this.data().state(),l.data.symbols=this._resolvedSymbols,l.data.graphics=(0,S.saveStudyGraphics)(this.graphics()),l.data.plotOffsets=this._plotOffsets),this.ownerSource()&&(l.ownerSource=null===(i=this.ownerSource())||void 0===i?void 0:i.id());for(let e=0;e<o.inputs.length;e++)if("bar_time"===o.inputs[e].type){const t=o.inputs[e].id,i=l.state.inputs[t];if(i<0){const e=this._rightOffsetToUnixTime(-i);l.state.inputs[t]=e&&e>=0?e:0}}var c;return this._isChildStudy&&v().patchChildStudyMetaInfoState(l),t&&(c=l).metaInfo&&c.metaInfo.scriptIdPart&&c.metaInfo.scriptIdPart.startsWith("USER;")&&(function(e){if(!e.metaInfo)return;const t=e.metaInfo.scriptIdPart;if(!t)return;const i=t.split(";")[0],r=e.metaInfo;r.id=(r.id||"").replace(t,i),r.fullId=(r.fullId||"").replace(t,i),r.name=(r.name||"").replace(t,i),r.shortId=(r.shortId||"").replace(t,i),r.scriptIdPart=(r.scriptIdPart||"").replace(t,i),e.state&&(e.state.id=(e.state.id||"").replace(t,i),e.state.fullId=(e.state.fullId||"").replace(t,i),e.state.name=(e.state.name||"").replace(t,i),e.state.shortId=(e.state.shortId||"").replace(t,i),e.state.scriptIdPart=(e.state.scriptIdPart||"").replace(t,i))}(c),function(e){const t=(e.metaInfo&&e.metaInfo.inputs||[]).find(e=>"ILScript"===e.name);t&&(t.defval="",e.state&&e.state.inputs&&(e.state.inputs[t.id]=""),e.metaInfo.defaults.inputs&&(e.metaInfo.defaults.inputs[t.id]=""))}(c)),l}hasStateForAlert(){return G.enabled("alerts")&&!this.isFailed()&&(this.metaInfo().isTVScript?this._hasAlertConditions()||this._hasAvailableAlertPlots()||this._hasAlertFunction():this._hasAlertablePlots())}stateForAlert(){const e=this.metaInfo(),t=this._plotsForAlert(),i=this._collectDepsForAlert(),s=i.idForAlert,n=i.studyDependencies,l=i.inputsForAlert,d=(this.priceScale()||this.model().mainSeries().priceScale()).formatter(),h=d?c.FormattersSerializer.serialize(d):null,p={id:s,
uniqueId:s,type:(0,r.ensureNotNull)(window.TradingView.className(this.constructor)),title:(0,o.clean)(this._title(!1,{},!1),!0),shortTitle:(0,o.clean)(this._title(!0,{},!1),!0),shortDescription:(0,o.clean)(e.shortDescription||"Study",!0),fullId:e.fullId,isTVScript:Boolean(e.isTVScript),isTVScriptStrategy:Boolean(e.isTVScriptStrategy),hasAlertFunction:Boolean(e.hasAlertFunction),plots:t,inputs:l,alerts:e.alerts,scriptIdPart:e.scriptIdPart,scriptVersion:e.pine?e.pine.version:"-1",callStudyDependencies:(0,a.formatCallstudyArg)(this._dependenciesForAlerts()),studyDependencies:n,formatter:h},_=function e(t){const i=t.metaInfo();if(!0===i.historyCalculationMayChange)return u.DataSourceDangerReason.PineRepainting;const r=i.inputs.filter(e=>"symbol"===e.type).map(e=>e.id);for(const e of r){const i=t.properties().inputs[e].value(),r=t.resolvedSymbolInfoBySymbol(i);if(r){if("spread"===r.type)return u.DataSourceDangerReason.Spread;if("CRYPTOCAP"===r.exchange)return u.DataSourceDangerReason.CryptoCap}}const s=t.ownerSource();return t.isChildStudy()&&s?e(s):null}(this);return _&&(p.dangerReason=_),p}disconnect(){this._studyId=null,this._model.isSnapshot()||(this._resolvedSymbols={},this._resolvedSymbolsByInput={})}isChildStudy(){return this._isChildStudy}hasChildren(){return this._children.length>0}isActualInterval(){return this._isActualInterval}onIsActualIntervalChange(){return this._onIsActualIntervalChange}isVisible(){if(this._model.collapsed().value()||!this.properties().visible.value()||!this.isActualInterval())return!1;const e=this.metaInfo();if(e.plots.length>0)return!0;for(const t of Object.keys(e.graphics))for(const i of Object.keys(e.graphics[t])){const e=this.properties().graphics[t][i];if(!e.visible||e.visible.value())return!0}return!(!e.isTVScriptStrategy&&!e.hasAlertFunction)}inputs(e){const t=(0,E.merge)((0,E.clone)(it),e||{});return t.skipOptionalEmptySymbolInputs&&(t.keepOptionalSymbolsEmpty=!0),this._buildInputs(t)}status(){return this._status}title(e,t,i,r){i=void 0===i?!this._showStudyArgumentsProperty.value():i;const s=JSON.stringify([e,t,i,r]);if(this._titleStrCache[s])return this._titleStrCache[s];if(this._titleInPartsCache[s])return this._joinTitlesParts(this._titleInPartsCache[s]);const n=this._title(e,t,i,r);return this._titleStrCache[s]=n,n}titleInParts(e,t,i,r){i=void 0===i?!this._showStudyArgumentsProperty.value():i;const s=JSON.stringify([e,t,i,r]);if(this._titleInPartsCache[s])return this._titleInPartsCache[s];const n=this._titleInParts(e,t,i,r);return this._titleInPartsCache[s]=n,n}invalidateTitleCache(e){if(this._titleStrCache={},this._titleInPartsCache={},!0===e&&this._children)for(let t=0;t<this._children.length;++t)this._children[t].invalidateTitleCache(e)}setOwnFirstValue(e){this._ownFirstValue=e}firstValue(e){var t,i,r;if(!this._isChildStudy&&"Compare@tv-basicstudies"===(null===(t=this._metaInfo)||void 0===t?void 0:t.id)||!(null===(i=this._metaInfo)||void 0===i?void 0:i.is_price_study)){const t=this._model.timeScale().visibleBarsStrictRange();if(null===t)return null
;if(!this.properties().visible.value()||!this.isActualInterval()||null!==this._startMovingPoint)return this._ownFirstValue;const i=t.firstBar(),s=t.lastBar();let n=function(e){const t=e.model().timeScale();if(t.isEmpty())return null;const i=t.visibleBarsStrictRange();if(null===i)return null;const r=i.firstBar(),s=i.lastBar(),n=H(e),o=new j;for(const e of n){const t=e.firstValue(r,s);o.improve(t)}return o.bestPrice()}(this);const o=(null===(r=this._metaInfo)||void 0===r?void 0:r.plots)||[];if(null===n){const t=this.data().rangeIterator(i,s);for(;t.hasNext();){const i=t.next().value;for(let t=0;t<o.length;++t){if((0,k.isColorerPlot)(o[t]))continue;const r=i[t+1];if(null==r)continue;const s=o[t].id,a=this.properties().styles[s];if(a.visible&&a.visible.value()&&!(e&&Math.abs(r)<1e-10)){n=r;break}}if(null!==n)break}}return this._ownFirstValue=n,null!==n?n:this._bandsFirstValue(e)}if(this._isChildStudy){const e=this._getNonPriceParent();if(e&&this.priceScale()===e.priceScale())return null!==e._ownFirstValue?e._ownFirstValue:e.firstValue()}return this._series.firstValue()}priceRange(e,t){let i=null;const s=(0,r.ensureNotNull)(this._metaInfo),n=this._fillPrecalculatedAutoscaleInfo(e,t);let o=this.data().minMaxOnRangeCached(e,t,n.fields);if(o=(0,f.mergeMinMax)(n.baseValueMinMax,o),n.useMainSeriesRange){const i=[{name:"low",offset:0},{name:"high",offset:0}],r=this.series().data().bars().minMaxOnRangeCached(e,t,i);o=(0,f.mergeMinMax)(o,r)}if(null!==o&&(i=new m.PriceRange(o.min,o.max)),s.bands)for(let e=0;e<s.bands.length;e++)if(this.properties().bands[e].visible.value()){const t=this.properties().bands[e].value.value();if(!(0,E.isNumber)(t))continue;i?i.apply(t,t):i=new m.PriceRange(t,t)}{const r=function(e,t,i){const r=H(e);let s=null;for(const e of r){const r=e.groupPriceRange(t,i);null!==r&&(s=null===s?r:s.merge(r))}return s}(this,e,t);r&&(i=i?i.merge(r):r)}return this._postProcessPriceRange(i)}autoScaleInfo(e,t){const i=this.priceRange(e,t),r=function(e,t,i){const r={topPixelMargin:0,bottomPixelMargin:0},s=H(e);for(const e of s){const s=e.groupPixelMargins(t,i);r.bottomPixelMargin=Math.max(r.bottomPixelMargin,s.bottomPixelMargin),r.topPixelMargin=Math.max(r.topPixelMargin,s.topPixelMargin)}return r}(this,e,t);return{range:i,topPixelMargin:r.topPixelMargin,bottomPixelMargin:r.bottomPixelMargin}}formatter(){return this._formatter||this.parentSource().formatter(!1)}updateAllViews(){var e,t,i,r,s;this._paneViews.forEach(e=>e.update()),this._labelPaneViews.forEach(e=>e.update()),null===(e=this._dataWindowView)||void 0===e||e.update(),null===(t=this._legendView)||void 0===t||t.update(),null===(i=this._statusView)||void 0===i||i.update(),this._priceAxisViews.forEach(e=>e.update()),this._priceLinesAxisViews.forEach(e=>e.update()),null===(r=this._inputsLinesPaneView)||void 0===r||r.update(),null===(s=this._inputsAnchorsPaneView)||void 0===s||s.update(),this._inputsTimeAxisPaneViews.forEach(e=>e.update()),this._inputsPriceAxisPaneViews.forEach(e=>e.update())}resolvedSymbolInfoBySymbol(e){
return this._resolvedSymbols&&e&&this._resolvedSymbols[this._getSymbolForResolve(e)]||null}currency(){const e=this.metaInfo();return Boolean(e)&&e.is_price_study?this.parentSource().currency():null}unit(){const e=this.metaInfo();return Boolean(e)&&e.is_price_study?this.parentSource().unit():null}inputsForAlertState(){return this.inputs()}sessionId(){return this.parentSource().sessionId()}sessionIdChanged(){return this.parentSource().sessionIdChanged()}getSymbolString(e){return""===e?"":(0,x.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getSymbolObject(e))}onStatusChanged(){return this._statusChanged}symbolsResolved(){return this._symbolsResolved}valuesProvider(){return new w.StudyLegendValuesProvider(this,this.model())}statusProvider(e){return new M.StudyStatusProvider(this,this._model.properties().scalesProperties.textColor)}correctScaleMargins(e){if("Volume"===this.metaInfo().shortId){const t=this.model().paneForSource(this);return null!==t&&t.isOverlay(this)&&t.containsMainSeries()?{top:.75,bottom:0}:{top:e.top,bottom:0}}return e}canBeHiddenByGlobalFlag(){return!0}isSourceHidden(){return!this.isVisible()||this.canBeHiddenByGlobalFlag()&&C.hideAllIndicators().value()}paneViews(){if(this.isSourceHidden())return null;const e=[];return this._startMovingPoint||e.push(...this._paneViews),this._inputsLinesPaneView&&(this._startMovingPoint||this._model.selection().isSelected(this))&&e.push(this._inputsLinesPaneView),this._inputsAnchorsPaneView&&e.push(this._inputsAnchorsPaneView),e}timeAxisViews(){return this._model.selection().isSelected(this)?this._inputsTimeAxisPaneViews:null}priceAxisViews(e,t){if(this.properties().oldShowLastValue&&!this.properties().oldShowLastValue.value())return null;let i=this._priceAxisViews.slice();return this._model.selection().isSelected(this)&&(i=i.concat(this._inputsPriceAxisPaneViews)),e.findTargetPriceAxisViews(this,t,i,this._priceLinesAxisViews)}movable(){return null!==this._inputsAnchorsPaneView}startMoving(e,t,i,r){this._startMovingPoint=e,this.stop()}move(e,t,i,r){if(void 0!==e.logical&&null!==this._startMovingPoint){if(Array.isArray(t)){const i=t;this._updateInputValue(e.logical,i[0]),this._updateInputValue(e.logical,i[1])}else this._updateInputValue(e.logical,t);this.updateAllViews()}}endMoving(e,t){return this._startMovingPoint=null,this.start(),{indexesChanged:!1,pricesChanged:!1}}convertYCoordinateToPriceForMoving(e,t){const i=this.priceScale();if(!t||!i||i.isEmpty())return null;const r=t.firstValue();return null===r?null:i.coordinateToPrice(e,r)}processHibernate(){const e=this.isVisible();if(!this.isStarted()&&e&&(this._isChildStudy&&(0,r.ensureDefined)(this._source).processHibernate(),this.start()),this.isHibernationAllowed()&&this.isStarted()&&!e){for(const e of this._children)e.processHibernate();this.stop()}}isHibernationAllowed(){return!this.hasChildren()||!!this._model.collapsed().value()&&this._children.every(e=>e.isHibernationAllowed())}_rightOffsetToUnixTime(e){if(this._series.bars().size()>=e){const t=(0,r.ensureNotNull)(this._series.bars().lastIndex())-e
;return(0,r.ensureNotNull)(this._series.bars().valueAt(t))[0]}return null}_invalidateLastNonEmptyPlotRowCache(){this._lastNonEmptyPlotRowCache={}}_collectDepsForAlert(){const e=[this,...this._getAllOwnerSources().filter(e=>e instanceof at)];return(0,d.collectDepsForAlert)(e)}isHibernated(){return!this.isVisible()&&!this.isStarted()}_createViews(){var e,t,i;this._priceAxisViewsBase=[],this._priceLinesAxisViews=[],this._paneViews=[],this._labelPaneViews=[];const s=new Set,n=this.metaInfo(),o=Boolean(n.usePlotsZOrder),a=new Map;if(n.plots)for(let t=0;t<n.plots.length;t++){const i=n.plots[t];let l,c,u,d,h;if((0,k.isNonVisualPlot)(i))continue;let p=n.plots[t].id,_=n.styles;if((0,k.isBgColorerPlot)(i))l=new Q(this,this._series,this._model,p);else if((0,k.isShapesPlot)(i))l=new ge(this,this._series,this._model,p);else if((0,k.isCharsPlot)(i))l=new Te(this,this._series,this._model,p);else if((0,k.isArrowsPlot)(i))l=new ke(this,this._series,this._model,p);else if((0,k.isOhlcPlot)(i)){const e=i.target;if(s.has(e))continue;if(s.add(e),st(n,t))l=new Ne(this,this._series,this._model,e);else{if(!nt(n,t)){et.logError(`plot ${i.id} looks to be invalid`);continue}l=new Ve(this,this._series,this._model,e)}d=this.createPriceAxisView(e),u=new Be.PanePriceAxisView(d,this,this._model),p=e,_=n.ohlcPlots}else d=this.createPriceAxisView(p),h=this.createPriceLineAxisView(p),l=new Fe.StudyPlotPaneView(this,this._series,this._model,p),this.properties().styles[p].trackPrice.value()&&(c=new He(this,p)),u=new Be.PanePriceAxisView(d,this,this._model);const m=o?(0,r.ensureDefined)(null===(e=null==_?void 0:_[p])||void 0===e?void 0:e.zorder):a.size;ot(m,a);const f={paneViews:[l],labelView:u,priceAxisView:d,priceLineAxisView:h};void 0!==c&&f.paneViews.push(c),a.set(m,f)}(null!==(i=null===(t=this._metaInfo)||void 0===t?void 0:t.bands)&&void 0!==i?i:[]).forEach((e,t)=>{const i=this._properties.bands[t];if(i&&i.visible.value()){const t=new qe(i,this),s=o?(0,r.ensureDefined)(e.zorder):a.size;ot(s,a),a.set(s,{paneViews:[t]})}}),this._properties.bandsBackground&&((0,r.assert)(!o,"'usePlotsZOrder' flag does not supported"),a.set(a.size,{paneViews:[new Ke(this)]}));const l=this._paneViews;(0,S.createGraphicsPaneViews)(this,this.model()).then(e=>{for(let t=0;t<e.length;t++)l.push(e[t]);this._model.lightUpdate()}),this._properties.areaBackground&&((0,r.assert)(!o,"'usePlotsZOrder' flag does not supported"),a.set(a.size,{paneViews:[new ze.AreaBackgroundPaneView(this,this.model())]}));const c=e=>n.plots.some(t=>(0,k.isColorerPlot)(t)&&t.target===e);if(this._properties.filledAreas&&n.filledAreas)for(let e=0;e<n.filledAreas.length;++e){const t=n.filledAreas[e],i=this._properties.filledAreasStyle[t.id],s=c(t.id);let l;if("plot_plot"===t.type||s?l=new Ye(this,this.model(),t,i):"hline_hline"===t.type?l=new Je(this,t,i):et.logWarn("Unsupported filledArea type: "+t.type),void 0!==l){const e=o?(0,r.ensureDefined)(t.zorder):a.size;ot(e,a),a.set(e,{paneViews:[l]})}}const u=Array.from(a.keys()).sort((e,t)=>e-t);for(let e=0;e<u.length;e++){const t=(0,
r.ensureDefined)(a.get(u[e]));this._paneViews.push(...t.paneViews),t.labelView&&this._labelPaneViews.push(t.labelView),t.priceAxisView&&this._priceAxisViewsBase.push(t.priceAxisView),t.priceLineAxisView&&this._priceLinesAxisViews.push(t.priceLineAxisView)}this._dataWindowView||(this._dataWindowView=new b.StudyDataWindowView(this,this._model)),this._legendView||(this._legendView=new P(this,this._model)),this._statusView||(this._statusView=new T.StudyStatusView(this)),this._concatPriceAxisViews()}_titleInputs(e,t){return this.inputs(this._titleInputsOptions(e,t))}_titleInputsOptions(e,t){return{symbolsForDisplay:!0,skipHiddenInputs:!0,skipFakeInputs:!1,fakeInputsForDisplay:!0,asObject:!1,skippedGroups:[],noExchanges:e,noResolution:t,skipColorInputs:!0,skipTimeInputs:!0,priceInputsForDisplay:!0}}_subscribeToSessionId(){!this._isSubscribedToSessionId&&this.hasSymbolInputs()&&(this.sessionIdChanged().subscribe(this,this._onSessionIdChanged),this._isSubscribedToSessionId=!0)}_unsubscribeToSessionId(){this._isSubscribedToSessionId&&(this.sessionIdChanged().unsubscribe(this,this._onSessionIdChanged),this._isSubscribedToSessionId=!1)}_onSessionIdChanged(){this.restart(!0)}_title(e,t,i,r){const s=this._titleInParts(e,t,i,r);return this._joinTitlesParts(s)}_postProcessPriceRange(e){if(e&&e.minValue()===e.maxValue()&&!this.metaInfo().is_price_study){const t=.005*e.minValue();e=new m.PriceRange(e.minValue()-t,e.maxValue()+t)}const t=this.priceScale();return t&&t.isLog()&&e?new m.PriceRange(t.priceToLogical(e.minValue()),t.priceToLogical(e.maxValue())):e}_joinTitlesParts(e){const t=e[1]?e[1].join(", "):"";return e[0]+(t.length>0?" ("+t+")":"")}_titleInParts(e,t,i,r){var s;let n="";n=e?this.metaInfo().shortDescription||this._properties.shortDescription&&this._properties.shortDescription.value()||"Study":this.metaInfo().description||this._properties.description&&this._properties.description.value()||"Study",t=t||{};const o=[window.t(n,{context:"study"})];let a=[];if(!i){const i=this._getMTFResolutionInputTitle();null!==i&&i.length>0&&o.push(i);const n=this.metaInfo(),l=this._titleInputs(r,!0)||[];if(l.length>0){const i={};if(this._isChildStudy)for(let t=0;t<n.inputs.length;++t){const o=n.inputs[t];if(!v().isSourceInput(o))continue;const a=o.id,l=this._properties.inputs[a].value();if(l.indexOf("$")>=0&&this._source){const t=this._source.metaInfo(),n=this._source.title(e,{},!0,r);if(1===t.plots.length)i[l]=n;else{const e=l.split("$")[1],r=null===(s=t.plots[parseInt(e)])||void 0===s?void 0:s.id,o=t.styles&&t.styles[r],a=o&&o.title||r;i[l]=n+": "+a}}break}a=l.map(e=>{let r=(0,E.isNumber)(e)?this._numericFormatter.format(e):i&&i[e.toString()]||e.toString();return t&&t[r.toString()]&&(r=t[r.toString()]),r})}}return[o.join(" · "),a]}_getMTFResolutionInputTitle(){const e=this.metaInfo();for(let t=0;t<e.inputs.length;t++){const i=e.inputs[t];if("resolution"===i.type&&i.isMTFResolution)return this._properties.inputs[i.id].value()}return null}_hasAvailableAlertPlots(){const e=this.stateForAlert(),t=l.alertBandFactory.create(e).getPlots()
;return null!=t&&t.length>0}_hasAlertablePlots(){return(this.metaInfo().plots||[]).some(e=>"line"===e.type)}_hasAlertConditions(){if(this.metaInfo().plots.some(k.isAlertConditionPlot))return!0;const e=this.stateForAlert();return Boolean(e.alerts&&e.alerts.conditions)}_hasAlertFunction(){const e=this.metaInfo();return Boolean(e.hasAlertFunction)}_getSymbolForResolve(e){return this.getSymbolString(this._getSymbolForApi(e))}_allSymbolsAreResolved(){const e=this.metaInfo(),t=[];let i=!1;for(let r=0;r<e.inputs.length;r++)if("symbol"===e.inputs[r].type){const s=e.inputs[r].id,n=this._properties.inputs[s].value(),o=this._getSymbolForResolve(n);if(""!==o)if(this._resolvedSymbols[o])i=!0;else{const e=this._resolveSymbol(o,n);t.push(e)}}if(0===t.length){const e=Promise.resolve();return i?e.then(()=>this._symbolsResolved.fire()):e}return Promise.all(t).catch(e=>(this._setStatus({type:Ze.StudyStatusType.Error,errorDescription:{error:tt}}),this.stop(!0),this._model.updateSource(this),Promise.reject("Invalid symbol, "+e))).then(()=>{null!==this._studyId&&this.stop(!0),this.start(!0),this._symbolsResolved.fire(),this._recheckLineToolsActuality()})}_getSymbolForApi(e){return e}_resolveSymbol(e,t){if(""===e)return Promise.resolve();let i=this._pendingResolveSymbols.get(e);return void 0!==i||(i=new Promise((i,r)=>{this._onSymbolResolvingStart(),this._chartApi.resolveSymbol((0,I.makeNextSymbolId)(),e,s=>{switch(this._pendingResolveSymbols.delete(e),s.method){case"symbol_resolved":this._setStatus({type:Ze.StudyStatusType.Undefined}),this._resolvedSymbols[e]=s.params[1],this._resolvedSymbolsByInput[t]=s.params[1],this._onSymbolResolved(e,t,s.params[1]),this.invalidateTitleCache(!0),i();break;case"symbol_error":if(this._setStatus({type:Ze.StudyStatusType.Error,errorDescription:{error:s.params[1]}}),this._onSymbolError(),s.params[1]===L.permissionDenied&&s.params[2])switch(s.params[2]){case L.SymbolErrorPermissionDeniedReason.Symbol:if(s.params[3])return void this._resolveSymbol(s.params[3],t).then(i);break;default:return void this._resolveSymbol(s.params[2],t).then(i)}this._sendTelemetryCounter("symbol_error",Object.assign(this._getTelemetryAdditionalData(),{symbol:e,reason:s.params[1]})),r()}})}),this._pendingResolveSymbols.set(e,i)),i}_recheckLineToolsActuality(){const e=this._model.paneForSource(this);null!==e&&e.sourcesByGroup().lineSourcesForAllSymbols().forEach(e=>{e.ownerSource()===this&&e.calcIsActualSymbol()})}_getSymbolObject(e){const t={symbol:e};return t.session=this.sessionId(),t}_onSymbolResolved(e,t,i){{const e=(0,r.ensureNotNull)(this._model.alertsWatcher());e.syncSourceAlertLabels(this);const t=this.getAllChildren();for(const i of t)e.syncSourceAlertLabels(i)}}_onSymbolResolvingStart(){}_onSymbolError(){}_setStatus(e){this._status=e,this._statusView&&this._statusView.update(),this._model.updateSource(this),this._statusChanged.fire(e)}_bandsFirstValue(e){const t=(0,r.ensureNotNull)(this._metaInfo);if(!t.bands)return null;for(let i=0;i<t.bands.length;i++){const t=this.properties().childs().bands.childs()[i]
;if(t.childs().visible.value()){const i=t.childs().value.value();if(e&&0===i)continue;return i}}return null}_prepareInputs(e){(0,r.assert)(!!e,"options not set");const t=this.metaInfo(),i={},s=e.allowedInputTypes?new Set(e.allowedInputTypes):null;for(let r=0;r<t.inputs.length;r++){const n=t.inputs[r];if(null!==s&&!s.has(n.type))continue;if(n.isFake&&e.skipFakeInputs)continue;if(n.isMTFResolution&&e.noResolution)continue;if(n.isHidden&&e.skipHiddenInputs)continue;if("bool"===n.type&&e.skipHiddenInputs&&e.skipBooleanInputs)continue;if("color"===n.type&&e.skipHiddenInputs&&e.skipColorInputs)continue;if("time"===n.type&&e.skipHiddenInputs&&e.skipTimeInputs)continue;if("text_area"===n.type&&e.skipHiddenInputs&&e.skipTextareaInputs)continue;if(void 0!==n.groupId&&-1!==e.skippedGroups.indexOf(n.groupId))continue;if(-1!==e.skippedInputs.indexOf(n.id))continue;const o=this._prepareInput(n,e);"symbol"===n.type&&e.skipOptionalEmptySymbolInputs&&""===o||(i[n.id]=(0,E.clone)(o))}return i}_getAllOwnerSources(){const e=[];let t=this.ownerSource();for(;null!==t;)e.push(t),t=t.ownerSource();return e}_getStudyIdWithLatestVersion(){return v().getStudyIdWithLatestVersion(this.metaInfo())}_lastNonEmptyPlotRow(e){var t;if(!(0,E.isInteger)(e))return et.logDebug("_lastNonEmptyPlotRow: incorrect plotIndex"),null;let i=null!==(t=this._lastNonEmptyPlotRowCache[e])&&void 0!==t?t:null;if(null!==i)return i;return i=this.data().findLast((t,i)=>void 0!==i[e],1e3),null===i?null:(this._lastNonEmptyPlotRowCache[e]=i,i)}_applyPlotToPrecalculatedAutoscaleInfo(e,t,i,r){const s=r.id,n=this.properties().styles[s],o=(0,k.isShapesPlot)(r)||(0,k.isCharsPlot)(r);i.useMainSeriesRange=i.useMainSeriesRange||(0,k.isArrowsPlot)(r);let a=(0,k.isLinePlot)(r)||(0,k.isOhlcPlot)(r);if(o){const e=n.location.value(),t=[y.MarkLocation.Absolute,y.MarkLocation.Top,y.MarkLocation.Bottom].indexOf(e)<0;i.useMainSeriesRange=i.useMainSeriesRange||o&&t,a=a||e===y.MarkLocation.Absolute}if(!a)return i;const l={name:s,offset:this.offset(s)},c=n.plottype.value();if(!this.properties().skipHistogramBaseOnAutoScale&&[k.LineStudyPlotStyle.Histogram,k.LineStudyPlotStyle.Columns,k.LineStudyPlotStyle.Area].indexOf(c)>=0){const r=n.histogramBase.value(),s=this.data().minMaxOnRangeCached(e,t,[l]);return(0,E.isNumber)(r)&&null!==s&&(i.baseValueMinMax=(0,f.mergeMinMax)(i.baseValueMinMax,{min:r,max:r}),i.baseValueMinMax=(0,f.mergeMinMax)(i.baseValueMinMax,s)),i}return i.fields.push(l),i}_fillPrecalculatedAutoscaleInfo(e,t){return(0,r.ensureNotNull)(this._metaInfo).plots.filter(e=>!(0,k.isPlotWithTechnicalValues)(e)).filter(e=>{const t=e.id;let i;if((0,k.isOhlcPlot)(e)){const t=e.target;i=this.properties().ohlcPlots[t]}else i=this.properties().styles[t];return i.visible.value()}).reduce((i,r)=>this._applyPlotToPrecalculatedAutoscaleInfo(e,t,i,r),{fields:[],useMainSeriesRange:!1,baseValueMinMax:null})}_buildInputs(e){(0,r.assert)(!!e,"options not set");let t={};try{t=this._prepareInputs(e)}catch(e){et.logWarn("Failed to prepare study inputs: "+e)}if(e.asObject){const e={}
;return Object.keys(t).forEach(i=>{null!=t[i]&&(e[i]=t[i])}),e}{const e=[];return Object.keys(t).forEach(i=>{null!=t[i]&&e.push(t[i])}),e}}_prepareInput(e,t){const i=this._prepareInputValue(e,t);return!e.isFake||t.fakeInputsForDisplay||t.onlyAtomValues?i:{v:i,f:!0,t:e.type}}_plotsForAlert(){return(0,d.plotsForAlert)(this.metaInfo(),this.offset.bind(this))}_dependenciesForAlerts(){const e=this._getAllOwnerSources().filter(e=>e instanceof at);return(0,d.dependenciesForAlerts)(e,this._model.studyMetaInfoRepository())}_calcIsActualInterval(){const e=this._isActualInterval;this._isActualInterval=(0,Qe.isActualInterval)(this._series.intervalObj(),this.properties().intervalsVisibilities),e!==this._isActualInterval&&(this._onIsActualIntervalChange.fire(),this._visibleChanged(),this.processHibernate())}_visibleChanged(){this._series.invalidateBarColorerCache()}_getNonPriceParent(){const e=this.source();if(e instanceof at){const t=e.metaInfo();return t.is_price_study&&"Compare@tv-basicstudies"!==t.id?e._getNonPriceParent():e}return null}_updateInputValue(e,t){const i=this._properties.inputs;if(i[t.id])if("price"===t.type)i[t.id].setValue(e.price);else if("time"===t.type){const r=this._model.timeScale().indexToTimePoint(e.index);null!==r&&i[t.id].setValue(1e3*r)}}_initializeStudyInputsPaneViews(){const e=(0,Y.editableStudyInputs)((0,r.ensureNotNull)(this._metaInfo).inputs);if(0===e.length)return;const t={convertPriceToCoordinate:e=>{const t=this.priceScale();if(null!==t&&!t.isEmpty()){const i=this.firstValue();if(null!==i)return t.priceToCoordinate(e,i)}return null},formatPrice:e=>{const t=this.priceScale();if(null!==t&&!t.isEmpty()){const i=this.firstValue();if(null!==i)return t.formatPrice(e,i)}return""},getInputValue:e=>{var t,i;return null!==(i=null===(t=this._properties.inputs[e])||void 0===t?void 0:t.value())&&void 0!==i?i:null},isSelected:()=>this._model.selection().isSelected(this),isHovered:()=>this===this._model.hoveredSource()};Promise.all([i.e(62183).then(i.bind(i,93532)),i.e(62183).then(i.bind(i,9793)),i.e(62183).then(i.bind(i,28029)),i.e(62183).then(i.bind(i,72362))]).then(i=>{const[r,s,n,o]=i;this._inputsAnchorsPaneView=new r.StudyInputsAnchorsPaneView(e,this._model,t);const a=e.filter(e=>!Array.isArray(e));this._inputsLinesPaneView=new s.StudyInputsLinesPaneView(a,this._model,t);let l=!1;e.forEach(e=>{if(Array.isArray(e)){const i="time"===e[0].type?e[0]:e[1],r="price"===e[0].type?e[0]:e[1];this._inputsTimeAxisPaneViews.push(new n.StudyInputTimeAxisPaneView(i,this._model,t.getInputValue)),this._inputsPriceAxisPaneViews.push(new o.StudyInputPriceAxisPaneView(r,t)),l=!0}else"time"===e.type?this._inputsTimeAxisPaneViews.push(new n.StudyInputTimeAxisPaneView(e,this._model,t.getInputValue)):(this._inputsPriceAxisPaneViews.push(new o.StudyInputPriceAxisPaneView(e,t)),l=!0)}),l&&this.formatterChanged().subscribe(this,this.invalidateTitleCache)})}}},39610:(e,t,i)=>{"use strict";i.d(t,{StudyCompare:()=>B});var r=i(16282),s=i(98006),n=i(17205),o=i(14127),a=i(20554),l=i(27937),c=i.n(l),u=i(22842),d=i(57086),h=i(32552)
;const p=u.enabled("force_exchange_as_title");class _ extends h.PriceAxisView{constructor(e,t){super(),this._studyCompare=e,this._data=t}_updateRendererData(e,t,i){e.visible=!1,t.visible=!1;const r=this._studyCompare.priceScale(),s=this._studyCompare.lastValueData(this._data.plotIndex,!1);if(s.noData||null===r||r.isEmpty())return;i.background=s.color,i.textColor=this.generateTextColor(s.color),i.coordinate=s.coordinate,i.floatCoordinate=s.floatCoordinate;const n=this._studyCompare.model().properties().scalesProperties;if(n.showSeriesLastValue.value()){const t=r.isPercentage();e.text=t?s.formattedPricePercentage:s.formattedPriceAbsolute,n.seriesLastValueMode.value()!==d.PriceAxisLastValueMode.LastPriceAndPercentageValue?e.secondLine="":e.secondLine=t?s.formattedPriceAbsolute:s.formattedPricePercentage,e.visible=!0}t.text="",n.showSymbolLabels.value()&&(t.text=this._paneText(),t.visible=t.text.length>0)}_paneText(){let e="";const t=this._studyCompare.symbolInfo();return p?e=(0,a.displayedSymbolExchange)(t):this._studyCompare.model().properties().scalesProperties.showSymbolLabels.value()&&(e=(0,a.displayedSymbolName)(t)),e}}var m=i(55068),f=i(32719),g=i(14397),v=i(68724),S=i(31565),y=i(69810);class b extends y.StudyValuesProvider{constructor(e,t){super(e,t),this._emptyValues[0].title=e.guiPlotName("")}_hideValues(){return!1}}const w=v.CheckMobile.any();class P extends m.StudyDataWindowView{constructor(e,t){super(e,t),this._studyCompare=e}_hideValues(){return!1}_createValuesProvider(e,t){return new b(e,t)}_currentIndex(){const e=this._model.crossHairSource().lockedIndex;let t;return w&&(null===this._model.crossHairSource().pane&&void 0===e||(0,f.isLineToolName)(g.tool.value())||null!==this._model.lineBeingEdited())?t=this._study.data().lastIndex():(t=this._model.crossHairSource().appliedIndex(),(0,S.isNumber)(t)||(t=this._study.data().lastIndex())),t}}var C=i(81704);class T extends P{constructor(e,t){super(e,t),this._additional=null,this._showSeriesOHLC=t.properties().paneProperties.legendProperties.showSeriesOHLC,this._showSeriesOHLC.subscribe(this,this.update)}isValuesVisible(){return this._showSeriesOHLC.value()}destroy(){this._showSeriesOHLC.unsubscribeAll(this)}additional(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._additional}_updateImpl(){{const e=(0,C.getDataVendorString)(this._studyCompare.symbolInfo());this._additional=e?window.t("Data Provided by")+" "+e:null}super._updateImpl()}}var x=i(14716),I=i(56885);class L extends I.StudyStatusProvider{getSplitTitle(){return this._source.titleInParts(!0,void 0,!1,!1)}text(){return this._source.isActualInterval()?this._source.isFailed()?`${this._source.title(!0,void 0,!1,!1)}: ${this.sourceStatusText()}`:`${this._source.title(!0,void 0,!1,!1)} ${this.sourceStatusText()}`:this._source.title(!0,void 0,!1,!1)}}var M=i(5489),E=i(65066),A=i.n(E);const k=(0,
s.isFeatureEnabled)("unit_conversion"),D=u.enabled("study_overlay_compare_legend_option"),R=u.enabled("force_exchange_as_title"),N=u.enabled("uppercase_instrument_names"),O=!u.enabled("hide_study_compare_legend_item"),V=u.enabled("hide_unresolved_symbols_in_legend");class B extends o.Study{constructor(e,t,i,r){t.hasChild("currencyId")||t.addChild("currencyId",new(c())(null)),t.hasChild("unitId")||t.addChild("unitId",new(c())(null)),t.addExclusion("currencyId"),t.addExclusion("unitId"),super(e,t,i,r),this.properties().childs().minTick.subscribe(null,()=>this._recreatePriceFormattingDependencies()),this.properties().childs().minTick.subscribe(null,()=>this._model.fullUpdate()),this.properties().childs().currencyId.subscribe(this,this._onCurrencyChanged),this.properties().childs().unitId.subscribe(this,this._onUnitChanged),this.properties().merge({skipHistogramBaseOnAutoScale:!0}),this._symbolResolvingActive=new(A())(!1),this._symbolHibernated=new(A())(!1)}properties(){return super.properties()}createPriceAxisView(e){return new _(this,{plotIndex:"compare"})}setSymbolParams(e){this._setSymbolCurrencyUnitInternal(e)}symbol(){return this._properties.inputs.symbol.value()}setSymbol(e){this.setSymbolParams({symbol:e})}symbolInfo(){if(!this._resolvedSymbols)return null;const e=this._properties.inputs.symbol.value();if(!e)return null;let t;return t=this._model.isSnapshot()?this._resolvedSymbols.___snapshot||null:this._resolvedSymbols[this._getSymbolForResolve(e)]||null,this._model.isSnapshot()&&null===t&&(t=(0,n.getObsoleteIdeaSymbolInfo)(this._resolvedSymbols,e,this.currency()),null!==t&&(this._resolvedSymbols.___snapshot=t)),t}symbolResolved(){return this.symbolsResolved()}symbolResolvingActive(){return this._symbolResolvingActive}symbolHibernated(){return this._symbolHibernated}isVisible(){const e=super.isVisible();return this._symbolHibernated.setValue(!e),e}symbolSameAsCurrent(e){return(0,M.symbolSameAsCurrent)(e,this.symbol(),this.symbolInfo())}currency(){return this._properties.currencyId.value()||null}setCurrency(e){this.setSymbolParams({currency:e})}isConvertedToOtherCurrency(){return(0,a.isConvertedToOtherCurrency)(this.symbolInfo())}unit(){return this._properties.unitId.value()||null}setUnit(e){this._properties.unitId.setValue(e)}isConvertedToOtherUnit(){return(0,a.isConvertedToOtherUnit)(this.symbolInfo())}style(){return 2}setStyle(e){}interval(){return this._model.mainSeries().interval()}setInterval(e){}symbolSource(){return this}state(e,t){const i=super.state(e,t);return k||delete i.state.unitId,e&&((0,r.ensureDefined)(i.data).symbols={___snapshot:this.symbolInfo()||void 0}),i}symbolTitle(e,t){return this.title(!0,{},!1,e)}titleInParts(e,t,i,r){const s=this._titleInParts(e,t,i,r).join(", ");return[N?s.toUpperCase():s]}tags(){const e=this.symbol();return e?[e]:[]}statusView(){return O?super.statusView():null}guiPlotName(e){return this.properties().childs().inputs.childs().symbol.value()}canOverrideMinTick(){return!0}canBeHiddenByGlobalFlag(){return!1}valuesProvider(){return new b(this,this.model())}
statusProvider(e){return new L(this,this._model.properties().scalesProperties.textColor)}_createViews(){this._legendView||(this._legendView=new T(this,this._model)),this._dataWindowView||(this._dataWindowView=new P(this,this._model)),this._statusView||(this._statusView=new x.StudyStatusView(this)),super._createViews()}_showLastValueOnPriceScale(){return this._model.properties().scalesProperties.showSeriesLastValue.value()}_onCurrencyChanged(){this.isStarted()&&this._tryChangeInputs(),this._currencyChanged.fire()}_onUnitChanged(){k&&this.isStarted()&&this._tryChangeInputs(),this._unitChanged.fire()}_getSymbolObject(e){const t=super._getSymbolObject(e),i=this.currency();null!==i&&(t["currency-id"]=i);const r=this.unit();return k&&null!==r&&(t["unit-id"]=r),t}_getSymbolForApi(e){return(0,a.symbolForApi)(this._resolvedSymbolsByInput[e]||null,e)}_onSymbolResolvingStart(){super._onSymbolResolvingStart(),this._symbolResolvingActive.setValue(!0)}_onSymbolError(){super._onSymbolError(),this._symbolResolvingActive.setValue(!1)}_onSymbolResolved(e,t,i){super._onSymbolResolved(e,t,i),this._recreatePriceFormattingDependencies();const r=t===this.symbol()?(0,a.extractSymbolNameFromSymbolInfo)(i,this.symbol()):null,s=(0,a.symbolCurrency)(i),n=(0,a.symbolUnit)(i);this._setSymbolCurrencyUnitInternal({symbol:null!=r?r:void 0,currency:s,unit:n},i),this.model().realignLineTools(),this._symbolResolvingActive.setValue(!1)}_changeInputsImpl(e,t){super._changeInputsImpl(e,t),e.symbol!==t.symbol&&this._model.realignLineTools()}_createStudyOnServer(){super._createStudyOnServer(),this._model.realignLineTools()}_tryCreateFormatter(){const e=this.symbolInfo();return(0,a.createSeriesFormatter)(e,this.properties().childs().minTick.value())}_titleInParts(e,t,i,r){const s=this.properties().childs().inputs.childs().symbol.value(),n=this.symbolInfo(),o=n&&n.exchange&&0!==n.exchange.length;let a;if(R&&o&&n)a=n.exchange;else if(n){if(a=n.name,D)switch(this._model.mainSeries().symbolTextSourceProxyProperty().value()){case"description":a=n.description;break;case"ticker-and-description":a=`${n.name}, ${n.description}`}else if(o&&!r)return[a,[n.exchange]]}else a=V?"":s;return[a]}_setSymbolCurrencyUnitInternal(e,t){const{symbol:i,currency:r,unit:s}=e,n=this.properties().childs(),o=n.inputs.childs().symbol.value(),l=n.currencyId.value(),c=n.unitId.value();if(void 0!==i&&i!==o&&n.inputs.childs().symbol.setValueSilently(i),void 0!==r&&r!==l&&n.currencyId.setValueSilently(r),void 0!==s&&s!==c&&n.unitId.setValueSilently(s),t)this._resolvedSymbolsByInput[this.symbol()]=t,this._resolvedSymbols[this._getSymbolForResolve(this.symbol())]=t;else{const e=this.symbolInfo();null!==e&&(n.currencyId.setValueSilently((0,a.symbolCurrency)(e)),n.unitId.setValueSilently((0,a.symbolUnit)(e)))}n.inputs.childs().symbol.value()!==o&&n.inputs.childs().symbol.listeners().fire(n.inputs.childs().symbol),n.currencyId.value()!==l&&n.currencyId.listeners().fire(n.currencyId),n.unitId.value()!==c&&n.unitId.listeners().fire(n.unitId)}}},52496:(e,t,i)=>{"use strict";i.d(t,{
StudyOverlayBase:()=>E});var r=i(16282),s=i(98006),n=i(17205),o=i(68724),a=i(87380),l=i(14127),c=i(46561),u=i(20554),d=i(27937),h=i.n(d),p=i(43607),_=i(22842),m=i(76018),f=i(5489),g=(i(92462),i(19453)),v=i(40989),S=i(31565),y=i(59757),b=i(65066),w=i.n(b);const P=(0,s.isFeatureEnabled)("unit_conversion"),C=o.CheckMobile.any()&&!0,T=_.enabled("uppercase_instrument_names"),x=_.enabled("study_overlay_compare_legend_option"),I=(_.enabled("secondary_series_extend_time_scale"),_.enabled("hide_unresolved_symbols_in_legend")),L=(0,a.getLogger)("Chart.StudyOverlay");function M(e,t){return null==e[t]}class E extends l.Study{constructor(e,t,i,r){super(e,function(e){return e.hasChild("currencyId")||e.addChild("currencyId",new(h())(null)),e.hasChild("unitId")||e.addChild("unitId",new(h())(null)),e.addExclusion("currencyId"),e.addExclusion("unitId"),e}(t),i,r),this._quotesProvider=new m.QuotesProvider,this._seriesSource=null,this._symbolResolvingActive=new(w())(!1),this._symbolHibernated=new(w())(!1),this._styleToRecover=null,this.m_data=new v.PlotList((0,c.seriesPlotFunctionMap)(),M),C&&this._quotesProvider.quotesUpdate().subscribe(this,this._onQuotesUpdate);const s=this.properties().childs();s.currencyId.subscribe(this,this._onCurrencyChanged),s.unitId.subscribe(this,this._onUnitChanged),s.allowExtendTimeScale.subscribe(this,this._onAllowExtendTimeScaleChanged),this._onAllowExtendTimeScaleChanged(),this._model.mainSeries().properties().childs().dividendsAdjustment.subscribe(this,()=>{this._tryChangeInputs()}),s.style.subscribe(this,this._onChartStyleChanged),s.lineStyle.childs().priceSource.subscribe(this,this._updateBarFunction),s.areaStyle.childs().priceSource.subscribe(this,this._updateBarFunction),s.baselineStyle.childs().priceSource.subscribe(this,this._updateBarFunction),this._updateBarFunction(),this._formatter=null}destroy(){this._model.mainSeries().properties().childs().dividendsAdjustment.unsubscribeAll(this),super.destroy()}setSymbolParams(e){this._setSymbolParamsInternal(e)}symbol(){return this.properties().childs().inputs.childs().symbol.value()}setSymbol(e){this.setSymbolParams({symbol:e})}symbolInfo(){if(!this._resolvedSymbols)return null;const e=this._properties.inputs.symbol.value();if(!e)return null;let t;return t=this._model.isSnapshot()?this._resolvedSymbols.___snapshot||null:this._resolvedSymbols[this._getSymbolForResolve(e)]||null,this._model.isSnapshot()&&null===t&&(t=(0,n.getObsoleteIdeaSymbolInfo)(this._resolvedSymbols,e,this.currency()),null!==t&&(this._resolvedSymbols.___snapshot=t)),t}data(){return null===this._seriesSource?super.data():this._seriesSource.data().bars()}symbolResolved(){return this.symbolsResolved()}symbolResolvingActive(){return this._symbolResolvingActive}symbolHibernated(){return this._symbolHibernated}isVisible(){const e=super.isVisible();return this._symbolHibernated.setValue(!e),e}symbolSameAsCurrent(e){return(0,f.symbolSameAsCurrent)(e,this.symbol(),this.symbolInfo())}priceSource(){switch(this._properties.style.value()){case 2:return this._properties.lineStyle.priceSource.value()
;case 3:return this._properties.areaStyle.priceSource.value();case 10:return this._properties.baselineStyle.priceSource.value()}return null}barFunction(){return this._barFunction}quotes(){return this._quotesProvider.quotes()}currency(){return this._properties.currencyId.value()||null}setCurrency(e){this.setSymbolParams({currency:e})}isConvertedToOtherCurrency(){return(0,u.isConvertedToOtherCurrency)(this.symbolInfo())}unit(){return this._properties.unitId.value()||null}setUnit(e){this._properties.unitId.setValue(e)}isConvertedToOtherUnit(){return(0,u.isConvertedToOtherUnit)(this.symbolInfo())}style(){return this.properties().childs().style.value()}setStyle(e){this.properties().childs().style.setValue(e)}interval(){return this._model.mainSeries().interval()}setInterval(e){}symbolSource(){return this}state(e,t){const i=super.state(e,t);return P||delete i.state.unitId,e&&((0,r.ensureDefined)(i.data).symbols={___snapshot:this.symbolInfo()||void 0}),i}symbolTitle(e,t){return this.title(!0,{},!1,e)}title(e,t,i,r){const s=this._titleInParts(e,t,i,r).join(", ");return T?s.toUpperCase():s}titleInParts(e,t,i,r){const s=this._titleInParts(e,t,i,r).join(", ");return[T?s.toUpperCase():s]}isStarted(){return null===this._seriesSource?super.isStarted():this._seriesSource.isStarted()}sourceId(){return null===this._seriesSource?super.sourceId():(0,r.ensureNotNull)(this._seriesSource.instanceId())}moveData(e){null===this._seriesSource?super.moveData(e):this._seriesSource.moveData(e)}firstValue(){const e=this._model.timeScale().visibleBarsStrictRange();if(null===e)return null;const t=e.firstBar();if(0===this.data().size())return this._ownFirstValue;const i=this.data().search(t,v.PlotRowSearchMode.NearestRight,1);return this._ownFirstValue=null!==i?this._barFunction(i.value):null,this._ownFirstValue}lastValueData(e,t,i){const r={noData:!0},s=this.priceScale();if(this._model.timeScale().isEmpty()||null===s||s.isEmpty()||this.data().isEmpty())return r;const n=this._model.timeScale().visibleBarsStrictRange();if(null===n)return r;const o=this.properties().childs();if(!o.visible.value())return r;const a=this.nearestIndex(n.lastBar(),v.PlotRowSearchMode.NearestLeft,1);if(void 0===a)return r;const l=this.firstValue();if(null===l)return r;const c=this._lastNonEmptyPlotRow(4),u=null!==c&&n.contains(c.index),d=null!==c?c.value:null,h=t||u?d:this.data().valueAt(a);if(null===h)return r;const p=this._barFunction(h);if(!(0,S.isNumber)(p))return r;const _=s.priceToCoordinate(p,l);let m;switch(o.style.value()){case 0:m=h[1]<=h[4]?o.barStyle.childs().upColor.value():o.barStyle.childs().downColor.value();break;case 1:case 9:m=h[1]<=h[4]?o.candleStyle.childs().upColor.value():o.candleStyle.childs().downColor.value();break;case 2:m=o.lineStyle.childs().color.value();break;case 3:m=o.areaStyle.childs().color1.value();break;case 10:{const e=o.baselineStyle.childs();m=_<Math.round(s.height()*(Math.abs(100-e.baseLevelPercentage.value())/100))?e.topLineColor.value():e.bottomLineColor.value();break}default:throw new Error("Not supported overlay style")}
const f=s.formatPriceAbsolute(p),g=s.formatPricePercentage(p,l,!0),y={noData:!1,text:s.isPercentage()?g:f,formattedPriceAbsolute:f,formattedPricePercentage:g,floatCoordinate:_,coordinate:_,color:m};return i&&(y.price=p),y}priceRange(e,t){if(!(0,S.isInteger)(e))return L.logDebug("priceRange: incorrect startBar"),null;if(!(0,S.isInteger)(t))return L.logDebug("priceRange: incorrect endBar"),null;if(0===this.data().size())return null;const i=this.priceSource();let r;r=null!==i?this.data().minMaxOnRangeCached(e,t,[{name:i,offset:0}]):this.data().minMaxOnRangeCached(e,t,[{name:"low",offset:0},{name:"high",offset:0}]);const s=null!==r?new y.PriceRange(r.min,r.max):null;return this._postProcessPriceRange(s)}bars(){return this.data()}open(e){return(0,r.ensureNotNull)(this.bars().valueAt(e))[1]}high(e){return(0,r.ensureNotNull)(this.bars().valueAt(e))[2]}low(e){return(0,r.ensureNotNull)(this.bars().valueAt(e))[3]}close(e){return(0,r.ensureNotNull)(this.bars().valueAt(e))[4]}hl2(e){return(this.high(e)+this.low(e))/2}hlc3(e){return(this.high(e)+this.low(e)+this.close(e))/3}ohlc4(e){return(this.open(e)+this.high(e)+this.low(e)+this.close(e))/4}canBeHiddenByGlobalFlag(){return!1}start(e,t){var i;this._formatter=null,super.start(e,t),null===(i=this.priceScale())||void 0===i||i.updateFormatter(),C&&this._setQuotesSymbol(this.symbol())}stop(e){super.stop(e),this._quotesProvider.setQuotesSessionSymbol(null)}formatter(){return this._formatter||this._recreateFormatter(),(0,r.ensureNotNull)(this._formatter)}_tryCreateFormatter(){return(0,u.createSeriesFormatter)(this.symbolInfo(),this.properties().childs().minTick.value())}_onCurrencyChanged(){this.isStarted()&&this._tryChangeInputs(),this._currencyChanged.fire()}_onUnitChanged(){P&&this.isStarted()&&this._tryChangeInputs(),this._unitChanged.fire()}_getSymbolObject(e){const t=super._getSymbolObject(e),i=this.currency();null!==i&&(t["currency-id"]=i);const r=this.unit();return P&&null!==r&&(t["unit-id"]=r),t.adjustment=this._model.mainSeries().properties().childs().dividendsAdjustment.value()?"dividends":"splits",t}_getSymbolForApi(e){return(0,u.symbolForApi)(this._resolvedSymbolsByInput[e]||null,e)}_onSymbolResolvingStart(){super._onSymbolResolvingStart(),this._symbolResolvingActive.setValue(!0)}_onSymbolError(){super._onSymbolError(),this._symbolResolvingActive.setValue(!1)}_onSymbolResolved(e,t,i){super._onSymbolResolved(e,t,i),this._recreatePriceFormattingDependencies();const r=t===this.symbol()?(0,u.extractSymbolNameFromSymbolInfo)(i,this.symbol()):null,s=(0,u.symbolCurrency)(i),n=(0,u.symbolUnit)(i);if(this._setSymbolParamsInternal({symbol:null!=r?r:void 0,currency:s,unit:n},i),this.model().realignLineTools(),C){const e=this.getSymbolString(this._getSymbolForApi(this.symbol()));this._setQuotesSymbol(e)}this._checkStyle(),this._symbolResolvingActive.setValue(!1)}_changeInputsImpl(e,t){super._changeInputsImpl(e,t),e.symbol!==t.symbol&&this._model.realignLineTools()}_setQuotesSymbol(e){const t=this.symbolInfo(),i=(0,u.extractSymbolNameFromSymbolInfo)(t,e),r=i&&this.getSymbolString(i)
;this._quotesProvider.setQuotesSessionSymbol(r)}_createStudyOnServer(){null===this._seriesSource?super._createStudyOnServer():this._modifyStudyOnServer((0,r.ensureDefined)(this._inputs)),this._model.realignLineTools()}_modifyStudyOnServer(e){null===this._seriesSource?super._modifyStudyOnServer(e):(this._seriesSource.modifySeries((0,p.decodeExtendedSymbol)(e.symbol),(0,g.getServerInterval)(this._series.properties().childs().interval.value())),this._seriesSource.isStarted()||this._seriesSource.start())}_stopStudyOnServer(){null===this._seriesSource?super._stopStudyOnServer():this._seriesSource.stop()}_titleInParts(e,t,i,r){const s=this.properties().childs().inputs.childs().symbol.value(),n=this.symbolInfo();let o;if(n){if(o=n.name,x){const e=this._model.mainSeries().symbolTextSourceProxyProperty().value();"description"===e?o=n.description:"ticker-and-description"===e&&(o=`${n.name}, ${n.description}`)}if(!r&&n.exchange&&0!==n.exchange.length)return[o,[n.exchange]]}else o=I?"":s;return[o]}_onAllowExtendTimeScaleChanged(){const e=this.isStarted();if(e&&this.stop(!0),null!==this._seriesSource){const e=this._seriesSource.dataEvents();e.seriesError().unsubscribeAll(this),e.loading().unsubscribeAll(this),e.completed().unsubscribeAll(this),e.dataUpdated().unsubscribeAll(this),this._seriesSource.destroy()}this._seriesSource=null,e&&this.start(!0)}_convertSeriesErrorToStudy(e){return{error:e.error,ctx:e.ctx,solution_id:e.solution_id}}_setSymbolParamsInternal(e,t){const{symbol:i,currency:r,unit:s,style:n}=e,o=this.properties().childs(),a=o.inputs.childs().symbol.value(),l=o.currencyId.value(),c=o.unitId.value(),d=o.style.value();if(void 0!==i&&i!==a&&o.inputs.childs().symbol.setValueSilently(i),void 0!==r&&r!==l&&o.currencyId.setValueSilently(r),void 0!==s&&s!==c&&o.unitId.setValueSilently(s),void 0!==n&&o.style.setValueSilently(n),t)this._resolvedSymbolsByInput[this.symbol()]=t,this._resolvedSymbols[this._getSymbolForResolve(this.symbol())]=t;else{const e=this.symbolInfo();null!==e&&(o.currencyId.setValueSilently((0,u.symbolCurrency)(e)),o.unitId.setValueSilently((0,u.symbolUnit)(e)))}o.inputs.childs().symbol.value()!==a&&o.inputs.childs().symbol.listeners().fire(o.inputs.childs().symbol),o.currencyId.value()!==l&&o.currencyId.listeners().fire(o.currencyId),o.unitId.value()!==c&&o.unitId.listeners().fire(o.unitId),o.style.value()!==d&&o.style.listeners().fire(o.style),this._checkStyle()}_updateBarFunction(){var e;const t=null!==(e=this.priceSource())&&void 0!==e?e:"close";this._barFunction=(0,c.barFunction)(t)}_onChartStyleChanged(){var e;this._updateBarFunction(),(null===(e=this._styleToRecover)||void 0===e?void 0:e.originalStyle)!==this.style()&&(this._styleToRecover=null)}_checkStyle(){const e=this.style();(0,u.isCloseBasedSymbol)(this.symbolInfo())?(0,u.isSingleValueBasedStyle)(e)||(this.setStyle(2),this._styleToRecover={correctedStyle:this.style(),originalStyle:e}):null!==this._styleToRecover&&(this.setStyle(this._styleToRecover.originalStyle),this._styleToRecover=null)}}},61632:(e,t,i)=>{"use strict";i.d(t,{
StudyPriceAxisView:()=>s});var r=i(32552);class s extends r.PriceAxisView{constructor(e,t){super(),this._model=e.model(),this._source=e,this._data=t}_updateRendererData(e,t,i){e.visible=!1,t.visible=!1;const r=this._source.model(),s=this._source.priceScale();if(null===s)return;if(!r.isPriceScaleVisible(s))return;const n=this._source.lastValueData(this._data.plotIndex,!1);if(n.noData)return;i.background=n.color;let o=n.color;"transparent"===o&&(o=this._model.properties().scalesProperties.backgroundColor.value()),i.textColor=this.generateTextColor(o),i.coordinate=n.coordinate,i.floatCoordinate=n.floatCoordinate,this._showAxisLabel()&&(e.text=n.text,e.visible=!0),this._updatePaneRendererData(t)}_showPaneLabel(){return this._model.properties().scalesProperties.showStudyPlotLabels.value()}_showAxisLabel(){return this._model.properties().scalesProperties.showStudyLastValue.value()}_updatePaneRendererData(e){e.text="",this._showPaneLabel()&&(e.text=this._source.priceLabelText(this._data.plotIndex),e.visible=!0)}}},93962:(e,t,i)=>{"use strict";i.d(t,{applyOverridesToStudyDefaults:()=>c});var r=i(16282),s=i(55782);const n=(0,i(87380).getLogger)("Chart.Model.StudyPropertiesOverrider");var o,a;function l(e,t,i,r){const s=i.split(".");if(0===s.length||0===s[0].length)return;const l=function(e){const t=e.split(":");return{name:t[0],type:2===t.length?t[1]:null}}(s[0]),c=l.name,u=l.type,d=null!==u,h=!d||"band"===u,p=!d||"area"===u,_=!d||"input"===u,m=!d||"plot"===u?a.getPlotIdByTitle(e,c):null,f=h?a.getBandIndexByName(e,c):null,g=p?a.getFilledAreaIdByTitle(e,c):null,v=_?a.getInputByName(e,c):null,S=t.hasOwnProperty(c);if((null!==m?1:0)+(null!==f?1:0)+(null!==g?1:0)+(null!==v?1:0)+(S?1:0)>1)return void n.logWarn(`Study '${e.description}' has ambiguous identifier '${c}'`);const y=s[1];if(null!==m){if(1===s.length)return void n.logWarn(`Path of sub-property of '${c}' plot for study '${e.description}' must be not empty`);const i=s.slice(1);o.applyPlotProperty(e,t,m,i,r)}else if(null!==v)o.applyInputValue(t,v,r);else if(null!==f){if(void 0===y)return void n.logWarn(`Property name of '${c}' band for study '${e.description}' must be set`);o.applyBandProperty(t,f,y,r)}else if(null!==g){if(void 0===y)return void n.logWarn(`Property name of '${c}' area for study '${e.description}' must be set`);o.applyFilledAreaProperty(t,g,y,r)}else S?o.setRootProperty(t,s,r):n.logWarn(`Study '${e.description}' has no plot or input '${c}'`)}function c(e,t,i){for(const r in e){if(!e.hasOwnProperty(r))continue;const s=r.indexOf(".");if(-1===s)continue;const o=r.substr(0,s),c=a.getMetaInfoByDescription(t,o);if(null===c){n.logWarn("There is no such study "+o);continue}const u=i(c);null!==u?l(c,u,r.substr(s+1),e[r]):n.logWarn("Cannot apply overrides for study "+o)}}!function(e){const t={line:s.LineStudyPlotStyle.Line,histogram:s.LineStudyPlotStyle.Histogram,cross:s.LineStudyPlotStyle.Cross,area:s.LineStudyPlotStyle.Area,columns:s.LineStudyPlotStyle.Columns,circles:s.LineStudyPlotStyle.Circles,line_with_breaks:s.LineStudyPlotStyle.LineWithBreaks,
area_with_breaks:s.LineStudyPlotStyle.AreaWithBreaks};e.applyPlotProperty=function(e,i,o,a,l){if(void 0===i.styles)return void n.logWarn("Study does not have styles");const c=a[0];if("color"===c){return void function(e,t,i,s,o){if(void 0!==e.styles)if(null===t&&!isNaN(s)&&s>0)n.logWarn("Study plot does not have color #"+s);else{if(0===s||isNaN(s)){(0,r.ensureDefined)(e.styles[i]).color=String(o),s=0}null!==t&&((0,r.ensureDefined)(t.colors[s]).color=String(o))}else n.logWarn("Study does not have styles")}(i,function(e,t,i){if(void 0===e.plots)return null;for(const r of e.plots){if(!(0,s.isColorerPlot)(r)||void 0===t.palettes)continue;const e=t.palettes[r.palette];if(r.target===i&&void 0!==e)return e}return null}(e,i,o),o,a.length>1?parseInt(a[1]):NaN,l)}const u=i.styles[o];if(void 0!==u&&u.hasOwnProperty(c)){if("plottype"===c){const e=t[String(l)];if(void 0===e)return void n.logWarn("Unsupported plot type for plot: "+l);l=e}u[c]=l}else n.logWarn(`Study plot does not have property '${c}'`)},e.applyBandProperty=function(e,i,r,s){if(void 0===e.bands)return void n.logWarn("Study does not have bands");const o=e.bands[i];if(void 0!==o&&o.hasOwnProperty(r)){if("plottype"===r){const e=t[String(s)];if(void 0===e)return void n.logWarn("Unsupported plot type for band: "+s);s=e}o[r]=s}else n.logWarn(`Study band does not have property '${r}'`)},e.applyFilledAreaProperty=function(e,t,i,r){if(void 0===e.filledAreasStyle)return void n.logWarn("Study does not have areas");const s=e.filledAreasStyle[t];void 0!==s&&s.hasOwnProperty(i)?s[i]=r:n.logWarn(`Study area does not have property '${i}'`)},e.applyInputValue=function(e,t,i){void 0!==e.inputs&&e.inputs.hasOwnProperty(t)?e.inputs[t]=i:n.logWarn(`Study does not have input '${t}'`)},e.setRootProperty=function(e,t,i){if(0===t.length)return;let r=e;for(const e of t.slice(0,-1)){if(null==r||!r.hasOwnProperty(e))break;r=r[e]}const s=t[t.length-1];null!=r&&r.hasOwnProperty(s)?r[s]=i:n.logWarn("Study does not have property "+t.join("."))}}(o||(o={})),function(e){e.getInputByName=function(e,t){if(void 0===e.inputs)return null;t=t.toLowerCase();for(const i of e.inputs)if(i.name.toLowerCase()===t)return i.id;return null},e.getPlotIdByTitle=function(e,t){if(void 0===e.styles)return null;t=t.toLowerCase();for(const i in e.styles){const r=e.styles[i];if((void 0!==r&&void 0!==r.title?r.title:i).toLowerCase()===t)return i}return null},e.getFilledAreaIdByTitle=function(e,t){if(void 0===e.filledAreas)return null;t=t.toLowerCase();for(const i of e.filledAreas)if(i.title.toLowerCase()===t)return i.id;return null},e.getBandIndexByName=function(e,t){if(void 0===e.bands)return null;t=t.toLowerCase();for(let i=0;i<e.bands.length;++i)if(e.bands[i].name.toLowerCase()===t)return i;return null},e.getMetaInfoByDescription=function(e,t){t=t.toLowerCase();for(const i of e)if(i.description.toLowerCase()===t||i.shortDescription.toLowerCase()===t)return i;return null}}(a||(a={}))},59246:(e,t,i)=>{"use strict";i.d(t,{StudyStrategyOrdersPaneView:()=>I})
;var r=i(93669),s=i(16282),n=i(72927),o=i(14563),a=i(62288),l=i(85789),c=i(14900),u=i(84162);function d(e,t,i){return i?Math.sign(e)*(Math.round(Math.abs(e))+t):Math.round(e)+t}class h{constructor(e,t){this._data=e,this._textWidths=t}draw(e,t){const i=t.pixelRatio;void 0!==this._textWidths.rendererParams&&(0,l.areEqualPaneRenderParams)(this._textWidths.rendererParams,t)||(this._textWidths.rendererParams=t,this._textWidths.width.clear());const r=this._data;e.lineJoin="miter",e.miterLimit=Math.round(2*i),e.strokeStyle=r.bgColor,e.lineWidth=Math.max(2,(0,u.ceiledEven)(2*i));for(const t of r.items){e.beginPath();const s="lower"===t.pos;e.save();const n=Math.round(r.orderArrow.vMargin*i);e.translate(0,s?n:-n),this._drawOrderArrow(e,t.orderPoint,r.orderArrow,r.exitLineWidth,s,i),e.restore(),e.save(),this._drawPriceArrow(e,t.pricePoint,r.priceArrow,!s,i),e.restore(),e.closePath(),e.stroke(),e.fillStyle=r.exitLineWidth?r.exitColor:"buy"===t.type?r.buyColor:r.sellColor,e.fill()}const s=r.text;s.visible&&(0,c.drawScaled)(e,i,()=>{e.font=s.fontSize+"px "+s.font,e.textAlign="center",e.textBaseline="top",e.fillStyle=r.labelColor,e.strokeStyle=r.bgColor,e.lineWidth=Math.min(2,Math.floor(2*i));for(const t of r.items){const i="lower"===t.pos;e.save();const n=i?1:-1,o=r.orderArrow;e.translate(0,(o.height+o.vMargin+r.exitLineWidth)*n);const a=i?s.vMargin:-s.fontSize-s.vMargin,l=n*(s.fontSize+s.lineSpacing);if(t.label&&(e.translate(0,a),e.strokeText(t.label,Math.ceil(t.orderPoint.x),t.orderPoint.y),e.fillText(t.label,Math.ceil(t.orderPoint.x),t.orderPoint.y),this._textWidths.width.has(t.label)||this._textWidths.width.set(t.label,e.measureText(t.label).width)),t.qty){const i=Boolean(t.label)?l:a;e.translate(0,i),e.strokeText(t.qty,Math.ceil(t.orderPoint.x),t.orderPoint.y),e.fillText(t.qty,Math.ceil(t.orderPoint.x),t.orderPoint.y),this._textWidths.width.has(t.qty)||this._textWidths.width.set(t.qty,e.measureText(t.qty).width)}e.restore()}})}hitTest(e){const t=this._testOrderArrows(e),i=!t&&this._data.text&&this._testText(e);return t||i?new a.HitTestResult(a.HitTestResult.REGULAR):null}_drawOrderArrow(e,t,i,r,s,n){let o,a;s?(e.rotate(Math.PI),o=-t.x,a=-t.y):(o=t.x,a=t.y),a-=i.height+r;const l=Math.max(1,Math.floor(n)),c=l%2?.5:0,h=s?"floor":"ceil";o=d(o*n,c,s),a=Math.round((Math[h](a)+.5)*n),e.translate(o,a);const p=(0,u.ceiledEven)(i.width*n)/2+c,_=(0,u.ceiledEven)(i.tailWidth*n)/2+c,m=Math.round(i.tailHeight*n);if(e.moveTo(-_,0),e.lineTo(_,0),e.lineTo(_,m),e.lineTo(p,m),e.lineTo(0,Math.round(i.height*n)),r){const t=Math.floor(l/2);e.lineTo(p+t,Math.round(i.height*n)),e.lineTo(p+t,Math.round((i.height+r)*n)),e.lineTo(-p-t,Math.round((i.height+r)*n)),e.lineTo(-p-t,Math.round(i.height*n)),e.lineTo(0,Math.round(i.height*n))}e.lineTo(-p,m),e.lineTo(-_,m),e.lineTo(-_,0),e.lineTo(_,0)}_drawPriceArrow(e,t,i,r,s){let n,o;r?(e.rotate(Math.PI),n=-t.x,o=-t.y):(n=t.x,o=t.y);const a=Math.max(1,Math.floor(s)),l=a%2?.5:0;n=d(n*s,l,r)-a,o=d(o*s,l,r);const c=(0,u.ceiledEven)(2*i.width*s)/2,h=-(Math.round(i.width*s)+l);e.translate(n,o),e.moveTo(0,0),
e.lineTo(h,-c),e.lineTo(h,c),e.lineTo(0,0),e.lineTo(h,-c)}_testOrderArrows(e){const t=this._data,i=t.orderArrow.width/2;for(const r of t.items){const s=r.orderPoint;if(e.x<s.x-i||e.x>s.x+i)continue;const n="lower"===r.pos;let o=t.orderArrow.height+t.exitLineWidth;n||(o=-o);const a=s.y+(n?t.orderArrow.vMargin:-t.orderArrow.vMargin),l=Math.min(a,a+o),c=Math.max(a,a+o);if(!(e.y<l||e.y>c))return!0}return!1}_testText(e){const t=this._data,i=t.text;if(!i.visible)return!1;for(const r of t.items){const s=r.orderPoint,n="lower"===r.pos;let o=t.orderArrow.vMargin+t.orderArrow.height+t.exitLineWidth;n||(o=-o);const a=s.y+o,l=(r.label?1:0)+(r.qty?1:0);let c=i.vMargin+i.fontSize*l+i.lineSpacing*Math.max(0,l-1);n||(c=-c);const u=Math.min(a,a+c),d=Math.max(a,a+c);if(e.y<u||e.y>d)continue;const h=r.label&&r.qty?n&&e.y<a+i.fontSize||!n&&e.y>a-i.fontSize?r.label:r.qty:r.label||r.qty,p=this._textWidths.width.get(h);if(!(void 0===p||e.x<s.x-p/2||e.x>s.x+p/2))return!0}return!1}}var p=i(39304),_=i(40989),m=i(56288);const f={BuyColor:r.colorsPalette["color-tv-blue-500"],SellColor:"#FF1744",ExitColor:"#D500F9",LabelDarkColor:"#B2B5BE",LabelLightColor:r.colorsPalette["color-mirage-1"]};function g(e){return!1===e.e?"exit":e.b?"entryBuy":"entrySell"}function v(e){return e.b?"buy":"sell"}function S(e,t){return t?!e.b:e.b}function y(e,t){return S(e,t)?"lower":"upper"}function b(e,t,i){let r=e[t].get(i);return void 0===r&&(r=0,e[t].set(i,r)),r}function w(e,t,i,r){const n=(0,s.ensureDefined)(e[t].get(i));e[t].set(i,n+r)}function P(e,t){return t&&(e.c||e.id||"Untitled")||""}function C(e,t){return t&&(e.b?"+":"-")+e.q||""}function T(e,t,i){return(0,s.ensureNotNull)(e.b?i.low(t):i.high(t))}function x(e,t){return("exit"===g(e)?2:0)+t.vMargin+t.height}class I{constructor(e,t,i){this._invalidated=!0,this._textWidths={width:new Map},this._study=e,this._series=t,this._model=i,this._orderArrow={vMargin:11,width:10,height:15,tailWidth:2,tailHeight:10},this._priceArrow={width:5},this._text={vMargin:7,font:p.CHART_FONT_FAMILY,fontSize:12,lineSpacing:2,visible:!0},this._items={entryBuy:[],entrySell:[],exit:[]},this._study.properties().strategy.orders.subscribe(this,this.update)}update(){this._invalidated=!0}clearItems(){this._items.entryBuy=[],this._items.entrySell=[],this._items.exit=[]}renderer(e,t){const i=this._study.properties();if(!i.visible.value()||!i.strategy.orders.visible.value())return null;if(this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._items.entryBuy.length||this._items.entrySell.length||this._items.exit.length){const e=new m.CompositeRenderer;return this._items.entryBuy.length&&e.append(this._strategyOrdersRenderer(this._items.entryBuy,!1)),this._items.entrySell.length&&e.append(this._strategyOrdersRenderer(this._items.entrySell,!1)),this._items.exit.length&&e.append(this._strategyOrdersRenderer(this._items.exit,!0)),e}return null}_strategyOrdersRenderer(e,t){const i=this._model.backgroundColor().value(),r="black"===(0,o.rgbToBlackWhiteString)((0,o.parseRgb)(i),150);return new h({items:e,buyColor:f.BuyColor,
sellColor:f.SellColor,exitColor:f.ExitColor,labelColor:r?f.LabelDarkColor:f.LabelLightColor,bgColor:i,orderArrow:this._orderArrow,exitLineWidth:t?2:0,priceArrow:this._priceArrow,text:this._text},this._textWidths)}_updateImpl(){this.clearItems();const e=this._study.ordersData();if(!e||!e.length)return;const t=this._model.timeScale(),i=this._series.priceScale(),r=t.visibleBarsStrictRange();if(t.isEmpty()||i.isEmpty()||null===r)return;const o=this._study.barsIndexes(),a=this._series.nearestIndex(r.firstBar(),_.PlotRowSearchMode.NearestRight),l=this._series.nearestIndex(r.lastBar(),_.PlotRowSearchMode.NearestLeft);if(void 0===a||void 0===l)return;const[c,u]=function(e,t,i,r){const s=[],n=[];for(let o=0;o<e.length;++o){const a=r[o];a<t||a>i||(s.push(e[o]),n.push(a))}return[s,n]}(e,a,l,o),[d,h]=this._labelAndQtyVisibility(c.length),p=d||h,m=this._textHeight(d,h),f=(0,s.ensureNotNull)(this._series.firstValue()),I=i.isInverted(),L={upper:new Map,lower:new Map};for(let e=0;e<c.length;e++){const r=c[e],s=S(r,I),o=u[e],a=t.indexToCoordinate(o),l=T(r,o,this._series);let p=i.priceToCoordinate(l,f);const _=y(r,I),M=b(L,_,o);p+=s?M:-M;w(L,_,o,x(r,this._orderArrow)+m);const E=i.priceToCoordinate(r.p,f),A=g(r);this._items[A].push({orderPoint:new n.Point(a,p),pricePoint:new n.Point(a,E),label:P(r,d),qty:C(r,h),pos:_,type:v(r)})}this._text.visible=p}_labelAndQtyVisibility(e){const t=this._model.timeScale();if(t.barSpacing()<10&&this._orderArrow.width*e*2>t.width())return[!1,!1];const i=this._study.properties();return[i.strategy.orders.showLabels.value(),i.strategy.orders.showQty.value()]}_textHeight(e,t){return e||t?e&&t?2*this._text.fontSize+this._text.vMargin+this._text.lineSpacing:this._text.fontSize+this._text.vMargin:0}}},14127:(e,t,i)=>{"use strict";var r=i(27937),s=i(96276),n=i(16282).assert,o=i(84101).unpackNonSeriesData,a=i(20554).symbolTitle,l=i(66786).StudyBarColorer,c=i(61632).StudyPriceAxisView,u=i(67642),d=u.emptyStudyGraphics,h=u.loadStudyGraphics,p=u.LiveStudyGraphics,_=u.createGraphicsPriceAxisViews,m=i(78087).ChartApiInterface,f=i(10164).telemetry,g=i(57746),v=i(23946).createGoProDialog,S=i(1771).DefaultProperty,y=i(11228).PriceFormatter,b=i(81293).VolumeFormatter,w=i(14704).PercentageFormatter,P=i(40989).PlotList,C=i(84234),T=i(88001),x=i(55782),I=x.LineStudyPlotStyle,L=i(78539).StudyPriceLineAxisView,M=i(45433).studyPlotFunctionMap,E=i(45433).studyEmptyPlotValuePredicate,A=i(30805).makeNextStudyId,k=i(22842),D=i(676).StudyBase,R=i(94420).InvalidationMask,N=i(72305),O=i(57415).IntervalsVisibilitiesProperty,V=N.StudyStatusType,B=N.convertStudyStatusToString,F=i(50946).colorToInteger,W=i(45087).intervalsVisibilitiesDefaults,U=i(87380).getLogger("Chart.Study"),H=k.enabled("datasource_copypaste"),z=k.enabled("study_symbol_ticker_description"),j=k.enabled("hide_unresolved_symbols_in_legend");function Y(e,t,i){var r=new S(t,i,!0);r.removeProperty("intervalsVisibilities"),r.addChild("intervalsVisibilities",new O(i&&i.intervalsVisibilities)),r.addExclusion("visible"),r.addExclusion("precision"),r.addExclusion("minTick"),
r.addExclusion("intervalsVisibilities");for(var s=0;s<e.inputs.length;++s){var n=e.inputs[s];n.isHidden&&(r.addExclusion("inputs."+s.toString()),r.addExclusion("inputs."+n.id))}return r}function G(e,t){if(t.plots)for(var i=0;i<t.plots.length;i++){var r=t.plots[i],s=r.id;if(!x.isColorerPlot(r)){var n={visible:!0,color:"#0496FF",linestyle:CanvasEx.LINESTYLE_SOLID,linewidth:2,plottype:I.Line,histogramBase:0,transparency:50,trackPrice:!1,joinPoints:!1};x.isBarColorerPlot(r)&&(n.transparency=0),n.plottype=r.type,n.title=s,e.styles&&s in e.styles&&TradingView.merge(n,e.styles[s]),e.styles[s]=n}}}function q(e,t){return e&&e[t]&&e[t].hasOwnProperty("showLast")?e[t].showLast.value():null}class X extends D{constructor(e,t,i,r){super(e,t,i,r),this._resolvedSymbols={},this._priceAxisViewsBase=[],this._graphicsPriceAxisViews=[],this._priceLinesAxisViews=[],this._hlinesPriceAsisViews=[],this._horizlinesPriceAsisViews=[],this._chartApi=e._chartApi,this._turnaroundCounter=0,this._turnaround="st"+this._turnaroundCounter,this._plotFields=[];var n=this.metaInfo().plots;if(n)for(var o=0,a=n.length;o<a;o++){var l=n[o].id;this._plotFields.push(l)}this._invalidateLastNonEmptyPlotRowCache(),this.m_data=new P(M(this._metaInfo),E),this._graphics=new p,this._plotOffsetsMetaInfoOverride={},this._studyModified=!1,this._tagsChanged=new s,this._labelPaneViews=[],this._createViews();var c=this;this._handler=function(e){c.onData(e)},this._handler.isTVScriptStrategy=this._metaInfo.isTVScriptStrategy,this._recreatePriceFormattingDependencies(),this._properties.precision.listeners().subscribe(this,this._precisionChanged),this._showStudyArgumentsProperty.listeners().subscribe(this,this.invalidateTitleCache),this._properties.description.listeners().subscribe(this,this.invalidateTitleCache),this._properties.inputs.listeners().subscribe(this,this.invalidateTitleCache),this._properties.shortDescription&&this._properties.shortDescription.listeners().subscribe(this,this.invalidateTitleCache),k.enabled("update_study_formatter_on_symbol_resolve")&&e.mainSeries().dataEvents().symbolResolved().subscribe(this,this._recreatePriceFormattingDependencies),e.mainSeries().dataEvents().symbolResolved().subscribe(this,this.invalidateTitleCache);c=this;var u={};this._simplePlotsCount=r.plots.filter((function(e,t){if(x.isLinePlot(e))return!0;if(x.isOhlcPlot(e)){var i=c.metaInfo().plots[t].target;return!u[i]&&(u[i]=i,!0)}return!1})).length,this._properties.showInDataWindow.listeners().subscribe(e,e.fullUpdate),this.hasBarColorer()&&this._properties.visible.listeners().subscribe(e.mainSeries(),e.mainSeries().invalidateBarStylesCache),this._childStudyByRebind=new s,this._formatterChanged=new s,this._priceStepChanged=new s,this._aboutToBeDestroyed=new s,this._ongoingDataUpdate=Promise.resolve(),this._isDestroyed=!1,this._definitionsViewModel=null}isFailed(){return this._status.type===V.Error}isLoading(){return this._status.type===V.Loading}series(){return this._series}model(){return this._model}clearData(){this._invalidateLastNonEmptyPlotRowCache(),this.data().clear(),
this._graphics.clear&&this._graphics.clear(),this._plotOffsets={},this.hasBarColorer()&&this._model.mainSeries().invalidateBarStylesCache()}onTagsChanged(){return this._tagsChanged}properties(){return this._properties}idForAlert(){return this._collectDepsForAlert().idForAlert}isSavedInStudyTemplates(){for(var e=0;e<this._metaInfo.inputs.length;e++)if("bar_time"===this._metaInfo.inputs[e].type)return!1;return!0}restoreData(e){this._invalidateLastNonEmptyPlotRowCache(),this.data().restoreState(e),this._resolvedSymbols=e.symbols,this._graphics=e.graphics?h(e.graphics):d(),this._postProcessGraphics(),this._plotOffsets=e.plotOffsets,this._status={type:V.Completed}}restart(e){this._restarting=!0,this.clearData(),(e||k.enabled("stop_study_on_restart"))&&this.stop(),setTimeout(this.start.bind(this),0)}stop(e){if(!0===e&&this._children)for(var t=0;t<this._children.length;++t)this._children[t].stop(!0);this._stopStudyOnServer(),this.clearData(),this._unsubscribeToSessionId(),this.recalculate()}_allInputsAreValid(){for(var e=0;e<this._metaInfo.inputs.length;e++)if("bar_time"===this._metaInfo.inputs[e].type){var t=this._metaInfo.inputs[e].id,i=this._properties.inputs[t].value();if(void 0===i||null==i)return!1}return!0}sourceId(){return this._studyId}parentSource(){return this._source||this._series}symbolSource(){return this.parentSource().symbolSource()}source(){return this.parentSource()}ownerSource(){return this._isChildStudy?this._source:D.prototype.ownerSource.call(this)}setChild(e){e instanceof X&&e.source()===this&&(this._children||(this._children=[]),-1===this._children.indexOf(e)&&this._children.push(e))}unsetChild(e){if(e instanceof X&&e.source()===this&&this._children){var t=this._children.indexOf(e);~t&&this._children.splice(t,1)}}getAllChildren(){if(!Array.isArray(this._children))return[];for(var e=this._children.slice(),t=0;t<e.length;++t)for(var i=e[t].getAllChildren(),r=0;r<i.length;++r)~e.indexOf(i[r])||e.push(i[r]);return e}_debugId(){var e=[];return this._studyId&&e.push(this._studyId),e.push(this._metaInfo.fullId),e.push(this._metaInfo.description),JSON.stringify({study:e})}isStarted(){return!!this._studyId}_isStopped(){return!this.isStarted()}isRestarting(){return!!this._restarting}start(e,t){var i=this._model.mainSeries();if(!i.isStarted())return void i.dataEvents().completed().subscribe(this,(function(){this.start(e,t)}),!0);this._isChildStudy&&this._source.isHibernated()&&this._source.start();const r=!(!this._isChildStudy&&!this.hasChildren()&&!this.isVisible())||!0===t;this._chartApi&&this._chartApi.connected()&&r&&this._allSymbolsAreResolved().then(function(){this._startAfterSymbolsResolved(e,t)}.bind(this)).catch(function(e){U.logError("ERROR: "+this._debugId()+" start failed, "+e),delete this._restarting}.bind(this))}_startAfterSymbolsResolved(e,t){if(!this.isStarted()||this._restarting){if(this._isChildStudy){if(!this._source.isStarted()||this._source.isRestarting())return void this._source.onStart.subscribe(this,this._startAfterSymbolsResolved,!0)
;C.setChildStudyMetaInfoPropertiesSourceId(this._metaInfo,this._source.sourceId(),this._properties)}if(delete this._restarting,this._allInputsAreValid()&&(this._inputs=this.inputs({keepOptionalSymbolsEmpty:!0}),this._createStudyOnServer(),this._subscribeToSessionId(),this.onStart.fire(),!0===e&&this._children))for(var i=0;i<this._children.length;++i)this._children[i].start(!0,t)}}_createStudyOnServer(){var e=this._getStudyIdWithLatestVersion();this._studyId=A(),this._incrementTurnaround(),this._studyName=e,this._chartApi.createStudy(this._studyId,this._turnaround,this._isChildStudy?this._source.sourceId():this._series.seriesSource().instanceId(),this._studyName,this._inputs,this._handler,this._isChildStudy)}_modifyStudyOnServer(e){this._chartApi.modifyStudy(this._studyId,this._turnaround,e,this._handler)}_stopStudyOnServer(){this._chartApi&&this._chartApi.connected()&&this.isStarted()&&(this._chartApi.removeStudy(this._studyId,this._isChildStudy),this._setStatus({type:V.Undefined})),this._studyId=null}inputsForAlert(){var e=this.offset(),t=this.inputs();return e&&t.push(e),t}_prepareInputValue(e,t){var i=e.id;if(t.valuesAsIsFromProperties)return this._properties.inputs[i].value();if("symbol"===e.type){var r=t&&t.symbolsForDisplay,s=this._properties.inputs[i].value(),n=r?s:this._getSymbolForApi(s),o=this._resolvedSymbols&&this._resolvedSymbols[this._getSymbolForResolve(n)];if(""===n&&e.optional){if(t&&t.keepOptionalSymbolsEmpty)return n;n=this._model.mainSeries().symbol(),o=this._model.mainSeries().symbolInfo()}if(r)if(o)if(z){switch(this._model.mainSeries().symbolTextSourceProxyProperty()){case"description":n=o.description;break;case"ticker-and-description":n=`${o.name}, ${o.description}`;break;case"ticker":n=o.name}}else n=a(o,t.noExchanges);else j&&(n="");else o&&(n=o.ticker||o.full_name),!this.isPine()&&t&&t.symbolsForChartApi&&(n=this.getSymbolString(n));return n}if("bar_time"===e.type){var l=this._properties.inputs[i].value();if(l<0){var c=this._rightOffsetToUnixTime(-l);l=c&&c>=0?c:l}return l}if(this._metaInfo.isTVScript||this._metaInfo.pine){if("text"===i)return this._metaInfo.defaults.inputs.text;if("pineId"===i)return this._metaInfo.scriptIdPart;if("pineVersion"===i)return this._metaInfo.pine?this._metaInfo.pine.version:"-1";if("color"===e.type&&this._metaInfo.isRGB){var u=this._properties.inputs[i].value();return F(u)}if("price"===e.type){var d=this._properties.inputs[i].value();return t.priceInputsForDisplay?this.formatter().format(d):d}return this._properties.inputs[i].value()}return this._properties.inputs[i].value()}_rebindToSource(e,t){var i=this.parentSource();if(this._isChildStudy){var r;this._source.unsetChild(this);var s=null;if(e===this._model.mainSeries())delete this._source,this._isChildStudy=!1,delete this._ownerSource,r=this._series.seriesSource().instanceId(),s=m.REBIND_STUDY_CHILD_TO_STANDALONE;else{if(!(e instanceof X))return U.logError("Unable to rebind study to source of this type"),!1;this._ownerSource=e,this._source=e,r=this._source.sourceId(),this._source.setChild(this),
this._source.isHibernated()&&this._source.start()}this._incrementTurnaround(),this.disablePriceRangeReady(),this._chartApi.rebindStudy(this._studyId,this._turnaround,r,this._studyName,t,this._handler,s)}else{if(!(e instanceof X))return U.logError("Unable to rebind study to source of this type"),!1;var n=e.isHibernated();n&&e.start();var o=!1;if(this._canCreateStudyWithRebindType(m.REBIND_STUDY_STANDALONE_TO_CHILD)?(this._incrementTurnaround(),this.disablePriceRangeReady(),o=this._chartApi.rebindStudy(this._studyId,this._turnaround,e.sourceId(),this._studyName,t,this._handler,m.REBIND_STUDY_STANDALONE_TO_CHILD)):v({feature:"studyOnStudy"}),!o)return n&&e.stop(),!1;this._isChildStudy=!0,this._ownerSource=e,this._source=e,this._source.setChild(this),this._childStudyByRebind.fire()}var a=this.m_priceScale,l=e.priceScale();if(a!==l){var c=this._model.paneForSource(this),u=this._model.paneForSource(e);c===u&&u.move(this,l,!0)}const d=this.parentSource();return i.formatterChanged().unsubscribe(this,this._onSourceFormatterChanged),d.formatterChanged().subscribe(this,this._onSourceFormatterChanged),i.priceStepChanged().unsubscribe(this,this._onSourcePriceStepChanged),d.priceStepChanged().subscribe(this,this._onSourcePriceStepChanged),i.currencyChanged().unsubscribeAll(this),d.currencyChanged().subscribe(this,this._onSourceCurrencyChanged),i.unitChanged().unsubscribeAll(this),d.unitChanged().subscribe(this,this._onSourceUnitChanged),i.priceRangeReadyChanged().unsubscribeAll(this),d.priceRangeReadyChanged().subscribe(this,this._onSourcePriceRangeReadyChanged),this._recreatePriceFormattingDependencies(),!0}childStudyByRebind(){return this._childStudyByRebind}_changeInputsImpl(e,t){var i=this.source(),r=this._properties.inputs&&this._properties.inputs.state(),s=C.getSourceIdByInputs(this._metaInfo.inputs,r),n=!0;if(s)if("high"===s||"open"===s||"low"===s||"close"===s||"hl2"===s||"ohl3"===s||"ohlc4"===s)i=this._model.mainSeries();else for(var o=this._model.dataSources().filter((function(e){return e instanceof X&&e.canHaveChildren()})),a=0;a<o.length;++a)if(o[a].sourceId()===s){i=o[a];break}if(i!==this.source()){if(!this._rebindToSource(i,e)&&r)for(var l in t)if(t.hasOwnProperty(l)&&t[l]!==e[l]&&0===e[l].indexOf(s)){var c=this._properties.inputs[l],u=t[l];c.setValue(u),n=!1;break}}else this._incrementTurnaround(),this.disablePriceRangeReady(),this._modifyStudyOnServer(e);this.invalidateTitleCache(),n&&(this._studyModified=n)}_incrementTurnaround(){this._turnaround="st"+ ++this._turnaroundCounter}_tryChangeInputs(){var e=TradingView.clone(this._inputs);this.isStarted()&&this._chartApi.connected()?this._allInputsAreValid()?this._allSymbolsAreResolved().then(function(){var t=this.inputs({keepOptionalSymbolsEmpty:!0});const i=JSON.stringify(t)!==JSON.stringify(this._inputs);this._isStopped()?i&&this.disablePriceRangeReady():i&&(this._changeInputsImpl(t,e),this._inputs=t,this.model().alertsWatcher().syncSourceAlertLabels(this))}.bind(this)).catch(function(e){
U.logError("ERROR: "+this._debugId()+" _tryChangeInputs: cannot modify study, "+e)}.bind(this)):this.stop():(this.stop(!0),this.start(!0)),this._tagsChanged.fire()}testInputValue(e,t){if(!C.canBeChild(this._metaInfo)||!C.isSourceInput(e))return!0;var i=this._properties.inputs&&this._properties.inputs[e.id];if(!i)return!0;var r=X.getInputRebindType(e,i.value(),t);return!!this._canCreateStudyWithRebindType(r)||(v({feature:"studyOnStudy"}),!1)}_canCreateStudyWithRebindType(e){return e!==m.REBIND_STUDY_STANDALONE_TO_CHILD||this._chartApi.isCanCreateStudy(!0)}changeStyles(){var e=void 0!==this._metaInfo.inputs.find((function(e){return"symbol"===e.type}));!this.isStarted()&&!e||this._restarting||(this._inputs?this._tryChangeInputs():this._chartApi&&this._chartApi.connected()&&this.restart(),this._metaInfo.isTVScript&&this._metaInfo.TVScriptMetaInfoExprs&&(this._pinePatchProps(),this.invalidateTitleCache()),this.hasBarColorer()&&this._model.mainSeries().invalidateBarStylesCache(),this._createViews(),this.recalculate(!0),this.updateAllViews())}_onPropertiesChanged(){this.changeStyles(),T.emit("study_properties_changed",this._id)}_isModifiedStudyInputs(e){if(0===Object.keys(e).length)return!1;if(void 0===this._oldStudyInputs)return this._oldStudyInputs=e,!0;var t=Object.keys(this._oldStudyInputs);return n(t.length===Object.keys(e).length,"keys quantity should be equal"),t.forEach((function(t){n(e.hasOwnProperty(t),"key '"+t+"' should existing in studyInputs"),this._oldStudyInputs[t]!==e[t]&&(this._oldStudyInputs=e)}),this),this._oldStudyInputs===e}_pinePatchProps(){var e=this._prepareInputs({fakeInputsForDisplay:!1,symbolsForDisplay:!1,symbolsForChartApi:!0,skipHiddenInputs:!0,skipFakeInputs:!1,onlyAtomValues:!0,skipBooleanInputs:!1,skipColorInputs:!1,skipTimeInputs:!1,skipOptionalEmptySymbolInputs:!1,skippedGroups:[],skippedInputs:[],noExchanges:!1,noResolution:!1,keepOptionalSymbolsEmpty:!1});if(this._isModifiedStudyInputs(e)){var t=g.patchPropertiesAsync(this._properties,this._metaInfo,e),i=this._allSymbolsAreResolved();Promise.all([t,i]).then(function(){this._createViews(),this.recalculate(!0),this.updateAllViews()}.bind(this)).catch(function(e){U.logError("ERROR: "+this._debugId()+" _pinePatchProps failed, reason: "+e)}.bind(this))}}priceLabelText(e){var t,i=this._metaInfo.styles,r=this._metaInfo.ohlcPlots;i&&i[e]&&(t=i[e]),r&&r[e]&&(t=r[e]);var s=t.title;return 1!==this._simplePlotsCount||x.isPlotTitleDefined(s)?this._metaInfo.is_price_study&&s!==this._metaInfo.shortDescription?""===s?this._metaInfo.shortDescription:this._metaInfo.shortDescription+":"+s:s:this._metaInfo.shortDescription}createPriceAxisView(e){return new c(this,{plotIndex:e})}createPriceLineAxisView(e){return new L(this,e)}_concatPriceAxisViews(){this._priceAxisViews=[].concat(this._priceAxisViewsBase,this._graphicsPriceAxisViews,this._hlinesPriceAsisViews,this._horizlinesPriceAsisViews)}recalculate(e){var t=this._model.paneForSource(this);this._model.recalculatePane(t,e),this._model.updateSource(this)}data(){return this.m_data}metaInfo(){
return this._metaInfo}graphicsInfo(){return this._metaInfo.graphics}graphics(){return this._graphics}turnaround(e){var t=this.source();return!0===e?(t===this._series?t.seriesSource().turnaround():t.turnaround(!0))+"_"+this._turnaround:this._turnaround}_checkTurnaround(e){return e===this._turnaround||e===this._model.mainSeries().seriesSource().turnaround()||e===this.turnaround(!0)}_handleStudyError(e){this.clearData(),this._setStatus(e);var t=B(e),i=this._getTelemetryAdditionalData();if(void 0!==t){var r=t.indexOf("Command info");i.reason=r>=0?t.slice(0,r).trim():t}if(!/study in error state|the data vendor doesn\'t provide volume data for this symbol.|error in series|unsupported resolution/gi.test(i.reason.toLowerCase())){var s=this._getTelemetryObjectName();this._sendTelemetryCounter(s+"_error",i)}this._statusView.update(),this._model.updateSource(this)}_onStudyLoading(){this._setStatus({type:V.Loading,startTime:Date.now()}),this._statusView.update(),this._model.updateSource(this)}_onStudyError(e){var t="string"==typeof e?{error:e.split(":",2)[0]}:e;this._handleStudyError({type:V.Error,errorDescription:t}),this._enablePriceRangeReady()}_onStudyCompleted(e){this._studyModified&&(this.clearData(),this._studyModified=!1),this._sendTelemetryCounter(this._getTelemetryObjectName()+"_loaded"),this._setStatus({type:V.Completed}),this._statusView.update();var t=this._model.paneForSource(this);this._model.recalculatePane(t),this._updateSources();var i=R.full();null!==this._model.appliedTimeFrame().value()&&i.lockVisibleTimeRangeOnResize(),this._model.invalidate(i)}onData(e){switch(e.method){case"study_loading":this._onStudyLoading();break;case"study_error":this._onStudyError(e.params[2]);break;case"study_completed":if(!this._checkTurnaround(e.params[1]))return;this._onStudyCompleted(e.params[e.params.length-1]);break;case"data_update":if(e.params.customId!==this.sourceId()||!this._checkTurnaround(e.params.turnaround))return;n(!!e.params.nonseries,"data.params.nonseries is missing"),this._onDataUpdate(e.params.plots,e.params.nonseries);break;case"clear_data":this._checkTurnaround(e.params.turnaround)&&this.clearData()}}_onDataUpdate(e,t){this._studyModified&&(this.clearData(),this._studyModified=!1);var i=o(t.d);return this._ongoingDataUpdate=this._ongoingDataUpdate.then((function(){return i}),(function(){return i})).then(this._onDataUnpacked.bind(this,e,t.indexes)),this._ongoingDataUpdate}_onDataUnpacked(e,t,i){this._isDestroyed||("nochange"!==t&&this._processPlotOffsets(i),this.transformData(e),this._mergeData(e),null!==i&&(i.indexes_replace?(n("nochange"!==t),this._graphics.replaceIndexesTo(t)):("nochange"!==t&&this._graphics.replaceIndexesTo(t),void 0!==i.graphicsCmds&&this._graphics.processCommands(i.graphicsCmds,this._metaInfo.graphics))),this._onDataUpdated(e,i,t),this.priceRangeReady()||this._enablePriceRangeReady())}_onDataUpdated(e,t,i){if(this.hasBarColorer()&&e.length>0){var r=this.barColorer().firstColoredBar(e[0].index);this._model.mainSeries().invalidateBarStylesCache(r)}null!==t&&this._postProcessGraphics()
;var s=this._model.paneForSource(this);this._model.recalculatePane(s),this._updateSources()}transformData(e){}moveData(e){this._ongoingDataUpdate=this._ongoingDataUpdate.then(function(){this._invalidateLastNonEmptyPlotRowCache(),this.data().move(e)}.bind(this))}replaceData(e,t,i){this._invalidateLastNonEmptyPlotRowCache(),this.data().remove(e+1),this.data().addTail(i,t)}_updateSources(){this._model.updateSource(this),this.hasBarColorer()&&this._model.updateSource(this._model.mainSeries())}static processPlotOffsets(e,t){t&&t.indexes_replace||(e._plotOffsets=t&&t.offsets||{})}_processPlotOffsets(e){X.processPlotOffsets(this,e)}_mergeData(e){this._invalidateLastNonEmptyPlotRowCache(),this.data().merge(e)}_postProcessGraphics(){this._graphicsPriceAxisViews=_(this),this._concatPriceAxisViews()}static offset(e,t){var i=0;return e._plotOffsets&&void 0!==e._plotOffsets[t]&&(i+=e._plotOffsets[t]),void 0!==e._plotOffsetsMetaInfoOverride[t]?i+=e._plotOffsetsMetaInfoOverride[t]:e.properties().offsets&&void 0!==e.properties().offsets[t]&&(i+=e.properties().offsets[t].val.value()),e.properties().offset&&(i+=e.properties().offset.val.value()),i}offset(e){return X.offset(this,e)}labelPaneViews(){return this.isSourceHidden()?null:this._labelPaneViews}dataWindowView(){return this._dataWindowView}legendView(){return this._legendView}statusView(){return this._statusView}_showLastValueOnPriceScale(){return this._model.properties().scalesProperties.showStudyLastValue.value()}hasBarColorer(){for(var e=0;e<this._metaInfo.plots.length;++e)if(x.isBarColorerPlot(this._metaInfo.plots[e]))return!0;return!1}barColorer(){const e=this._metaInfo.plots;let t=null;for(let i=0;i<e.length;++i)if(x.isBarColorerPlot(e[i])){const e=new l(this,i);null==t?t=e:t.pushBackBarColorer(e)}if(null==t)throw new Error("Cannot create BarColorer: study doesn't have a bar_colorer plot!");return t}base(){return 0}_priceScaleByProperties(){if("default"===this.properties().precision.value())return null;var e=parseInt(this.properties().precision.value());return isFinite(e)?Math.pow(10,e):null}_formatterByProperties(){var e=this._priceScaleByProperties();return null!==e?new y(e):null}_priceScaleByMetaInfo(){var e=this.metaInfo().format,t=isNumber(e.precision)?Math.pow(10,e.precision):void 0;if("price"===e.type||"percent"===e.type)return t||100;if("volume"===e.type){if(void 0===e.precision){var i=this.series().symbolInfo();if(null!==i&&isNumber(i.volume_precision))return Math.pow(10,i.volume_precision)}return 1}return"inherit"===e.type||U.logWarn("Unsupported format type: "+e.type),null}_formatterByMetaInfo(){var e=this.metaInfo().format,t=isNumber(e.precision)?Math.pow(10,e.precision):void 0;switch(e.type){case"price":return new y(t);case"volume":var i=e.precision;if(void 0===i){var r=this.series().symbolInfo();i=r&&isNumber(r.volume_precision)?r.volume_precision:0}return new b(i);case"percent":return new w(t);case"inherit":return null;default:return U.logWarn("Unsupported format type: "+e.type),null}}_onSourceFormatterChanged(){
null===this._formatter&&(null!==this.priceScale()&&this.priceScale().updateFormatter(),this._formatterChanged.fire())}_onSourcePriceStepChanged(){null===this._priceStep&&this._priceStepChanged.fire()}_precisionChanged(){this._recreatePriceFormattingDependencies()}_recreatePriceFormattingDependencies(){this._recreateFormatter(),this._recreatePriceStep()}_recreateFormatter(){this._formatter=this._tryCreateFormatter(),this._formatterChanged.fire(),null!==this.priceScale()&&this.priceScale().updateFormatter(),this._model.fullUpdate()}_recreatePriceStep(){var e=null,t=this._tryToGetPriceScale();null!==t&&(e=1/t),this._priceStep!==e&&(this._priceStep=e,this._priceStepChanged.fire())}_tryToGetPriceScale(){var e=this._priceScaleByProperties();return null===e&&(e=this._priceScaleByMetaInfo()),e}_tryCreateFormatter(){var e=this._formatterByProperties();return null===e&&(e=this._formatterByMetaInfo()),e}priceStep(){return this._priceStep||this.parentSource().priceStep(!1)}setOwnerSource(e){super.setOwnerSource(e),this._recreatePriceFormattingDependencies()}nearestIndex(e,t,i){if(TradingView.isInteger(e)){var r=this.data().search(e,t,i);return null!==r?r.index:void 0}U.logDebug("nearestIndex: incorrect logicalPoint")}tags(){return!this._metaInfo||!this._metaInfo.description||this._metaInfo.isTVScriptStub||this._metaInfo.is_hidden_study||this._metaInfo.isTVScript&&"tv-scripting"===this._metaInfo.productId?[]:[this._metaInfo.description]}onExtendedHoursChanged(){this.restart(!0)}hasSymbolInputs(){for(var e=this._metaInfo.inputs.length;e--;)if("symbol"===this._metaInfo.inputs[e].type)return!0;return!1}canOverrideMinTick(){return!1}_subscribeExtendedHours(){!this._isSubscribedToExtendedHours&&this.hasSymbolInputs()&&(this._series.onExtendedHoursChanged().subscribe(this,this.onExtendedHoursChanged),this._isSubscribedToExtendedHours=!0)}removeByRemoveAllStudies(){return!0}canHaveChildren(){return void 0===this._canHaveChildren&&(this._canHaveChildren=!!C.canHaveChildren(this._metaInfo)),this._canHaveChildren}static getInputRebindType(e,t,i){var r=C.isSourceInput(e);return r&&!~t.indexOf("$")&&~i.indexOf("$")?m.REBIND_STUDY_STANDALONE_TO_CHILD:r&&~t.indexOf("$")&&!~i.indexOf("$")?m.REBIND_STUDY_CHILD_TO_STANDALONE:0}getPlotFields(){return this._plotFields}getMinFirstBarIndexForPlot(e){var t=q(this._properties.styles,e)||q(this._properties.ohlcPlots,e)||q(this._properties.filledAreasStyle,e);if(null===t)return-1/0;var i=this.data().lastIndex();return null===i?-1/0:i-t+1}_getPropertyDefinitionsViewModelClass(){return Promise.resolve(null)}getPropertyDefinitionsViewModel(){if(null===this._definitionsViewModel){var e=this;return e._getPropertyDefinitionsViewModelClass().then((function(t){return null===t||e._isDestroyed?null:(null===e._definitionsViewModel&&(e._definitionsViewModel=new t(e._model.undoModel(),e)),e._definitionsViewModel)}))}return Promise.resolve(this._definitionsViewModel)}isPine(){return void 0!==this._metaInfo.pine}isStandardPine(){return this.isPine()&&C.isStandardPine(this._metaInfo.id)}isLinkedToSeries(){
return!0===this._metaInfo.linkedToSeries}_getTelemetryObjectName(){return"study"}_getTelemetryAdditionalData(){var e="";return this._metaInfo.pine&&this._metaInfo.pine.version&&this._metaInfo.shortId.indexOf("USER")>=0&&(e="_v"+this._metaInfo.pine.version),{symbol:this.series().actualSymbol(),resolution:this.series().interval(),study:this._metaInfo.shortId+e}}_sendTelemetryReport(e,t,i){void 0===i&&(i=this._getTelemetryAdditionalData());var r=Object.assign(t,{additional:i});f.sendChartReport(e,r)}_sendTelemetryCounter(e,t){this._sendTelemetryReport(e,{count:1},t)}onAboutToBeDestroyed(){return this._aboutToBeDestroyed}destroy(){this._aboutToBeDestroyed.fire(),this._isDestroyed=!0,this._legendView&&this._legendView.destroy(),null!==this._definitionsViewModel&&(this._definitionsViewModel.destroy(),this._definitionsViewModel=null),this._properties.precision.listeners().unsubscribe(this,this._precisionChanged),this._showStudyArgumentsProperty.listeners().unsubscribe(this,this.invalidateTitleCache),this._properties.description.listeners().unsubscribe(this,this.invalidateTitleCache),this._properties.shortDescription&&this._properties.shortDescription.listeners().unsubscribe(this,this.invalidateTitleCache),this._model.mainSeries().dataEvents().symbolResolved().unsubscribeAll(this),this._properties.showInDataWindow.listeners().unsubscribe(this._model,this._model.fullUpdate),this.hasBarColorer()&&this._properties.visible.listeners().unsubscribe(this._model.mainSeries(),this._model.mainSeries().invalidateBarStylesCache),this._model.mainSeries().dataEvents().symbolResolved().unsubscribe(this,this._recreatePriceFormattingDependencies),super.destroy()}desiredPriceScalePosition(){return this.metaInfo().isTVScriptStub?"overlay":this.metaInfo().linkedToSeries?"as-series":void 0===this.metaInfo().priceScale?null:["right","left","overlay"][this.metaInfo().priceScale]}guiPlotName(e){var t=this.properties().styles;return t&&t[e]&&t[e].title?t[e].title.value():this.title()}defaultPlotIdForAlert(){return this._metaInfo.plots.length?this._metaInfo.plots[0].id:null}formatterChanged(){return this._formatterChanged}copiable(){return H&&!this.isChildStudy()}setPriceScale(e){super.setPriceScale(e),T.emit("study_event",this.id(),"price_scale_changed")}getStudyName(){return this._studyName}}TradingView.Study=X,t.Study=X,t.prepareStudyProperties=function(e,t,s,o,a){return function(e,t,s,o,a,l){var c=function(e,t,s,o){var a=i(95294);if(C.versionOf(e)<1)throw new Error("This function cannot work with metainfo of the old format version. Required format version >= 1");var l=TradingView.clone(defaults("study"));G(l,e);var c=C.getStudyPropertyRootName(e),u=TradingView.clone(defaults(c,o));u.intervalsVisibilities=TradingView.clone(W),("Overlay"===e.shortId||"Compare"===e.shortId)&&(u.currencyId=null,u.unitId=null);e.isTVScript&&e.TVScriptSourceCode!==u.TVScriptSourceCode&&(u=TradingView.clone(TradingView.factoryDefaults(c,o)));TradingView.merge(l,u),t&&(n(!(t instanceof r),"propsState should not be an instance of Property"),TradingView.merge(l,t))
;var d=TradingView.clone(e),h={};a.mergeInputsObjPart(h,d.defaults.inputs),a.mergeInputsObjPart(h,l.inputs),l.inputs=h,delete d.inputs,delete d.defaults.inputs;var p={};if(TradingView.merge(p,d.defaults),TradingView.merge(p,TradingView.factoryDefaults(c)),TradingView.merge(p,l),TradingView.merge(p,d),delete p.defaults,l=p,null!==s){var _=s.model().studiesColorRotatorFactory().getColorRotator(e);null!==_&&("Overlay@tv-basicstudies"===e.id?l.lineStyle.color=_.getColor(l.lineStyle.color,e):TradingView.merge(l,function(e,t){for(var i in e.styles){var r=e.styles[i].color;r&&(e.styles[i].color=t.getColor(r))}return e}(l,_)))}t&&TradingView.merge(l.styles,t.styles);return l}(e,t,s,o),u=C.getSourceInputIds(e);if(u.length>0){var d=u[0];l instanceof X?c.inputs[d]="{pid}$0":void 0!==c.inputs[d]&&-1!==c.inputs[d].indexOf("$")&&(c.inputs[d]="close")}return Y(e,a,c)}(e,t,s,o,C.getStudyPropertyRootName(e),a)},t.prepareStudyPropertiesForLoadChart=function(e,t,r,s,n,o){return function(e,t,r,s,n,o,a){var l=function(e,t,r,s,n,o){var a=i(95294);e.version&&r.version&&e.version!==r.version&&U.logWarn("Serialized metaInfo version "+e.version+" is not equal to the saved state version "+r.version);var l=TradingView.clone(defaults("study"));l.intervalsVisibilities=TradingView.clone(W),TradingView.merge(l,TradingView.factoryDefaults(C.getStudyPropertyRootName(e))),G(l,e),TradingView.merge(l,r),l=n.updateStudyState(l,e,t),void 0!==o&&(l=o(r,l,e,t));var c=TradingView.clone(t||e);if(c&&C.versionOf(c)>=1){var u={};a.mergeInputsObjPart(u,(c.defaults||{}).inputs),a.mergeInputsObjPart(u,l.inputs),l.inputs=u,delete c.inputs,c.defaults&&delete c.defaults.inputs;var d={};TradingView.merge(d,c.defaults),TradingView.merge(d,TradingView.factoryDefaults(C.getStudyPropertyRootName(c))),TradingView.merge(d,l),delete c.defaults,TradingView.merge(d,c),l=d}return l}(e,t,r,0,n,a);return Y(t||e,o,l)}(e,t,r,0,n,C.getStudyPropertyRootName(e),o)}},82814:(e,t,i)=>{"use strict";i.d(t,{plotShapesData:()=>r});i(20220);const r={shape_arrow_down:{guiName:window.t("Arrow Down"),id:"shape_arrow_down",paneRendererClass:"PaneRendererArrowDown",pineName:"shape.arrowdown",icon:"arrow_down"},shape_arrow_up:{guiName:window.t("Arrow Up"),id:"shape_arrow_up",paneRendererClass:"PaneRendererArrowUp",pineName:"shape.arrowup",icon:"arrow_up"},shape_circle:{guiName:window.t("Circle"),id:"shape_circle",paneRendererClass:"PaneRendererCircleShape",pineName:"shape.circle",icon:"circle"},shape_cross:{guiName:window.t("Cross"),id:"shape_cross",paneRendererClass:"PaneRendererCrossShape",pineName:"shape.cross",icon:"cross"},shape_diamond:{guiName:window.t("Diamond"),id:"shape_diamond",paneRendererClass:"PaneRendererDiamond",pineName:"shape.diamond",icon:"diamond"},shape_flag:{guiName:window.t("Flag"),id:"shape_flag",paneRendererClass:"PaneRendererFlagShape",pineName:"shape.flag",icon:"flag"},shape_label_down:{guiName:window.t("Label Down"),id:"shape_label_down",paneRendererClass:"PaneRendererLabelDown",pineName:"shape.labeldown",icon:"label_down"},shape_label_up:{guiName:window.t("Label Up"),
id:"shape_label_up",paneRendererClass:"PaneRendererLabelUp",pineName:"shape.labelup",icon:"label_up"},shape_square:{guiName:window.t("Square"),id:"shape_square",paneRendererClass:"PaneRendererSquare",pineName:"shape.square",icon:"square"},shape_triangle_down:{guiName:window.t("Triangle Down"),id:"shape_triangle_down",paneRendererClass:"PaneRendererTriangleApexDown",pineName:"shape.triangledown",icon:"triangle_down"},shape_triangle_up:{guiName:window.t("Triangle Up"),id:"shape_triangle_up",paneRendererClass:"PaneRendererTriangleApexUp",pineName:"shape.triangleup",icon:"triangle_up"},shape_xcross:{guiName:window.t("X Cross"),id:"shape_xcross",paneRendererClass:"PaneRendererXCross",pineName:"shape.xcross",icon:"x_cross"}}},29237:(e,t,i)=>{"use strict";var r=i(16282).ensureNotNull,s=i(72927).Point,n=i(90789).TextRenderer,o=i(24322).NonSeriesStudy,a=i(32579).TrendLineRenderer,l=i(62288).HitTestResult,c=i(56288).CompositeRenderer,u=i(50946),d=i(98815).LineEnd,h=i(39304).CHART_FONT_FAMILY;class p{constructor(e,t){this._model=e,this._source=t,this._waves=[],this._highlights=[],this._retracements=[],this._invalidated=!0}update(){this._invalidated=!0}updateImpl(){if(this._waves=[],this._highlights=[],this._retracements=[],this._source.customData()&&this._source.properties().visible.value()){var e=this._source.customData().waves,t=this._source._indexes,i=this._model.timeScale(),n=this._source.priceScale(),o=this._model.mainSeries(),a=o.firstBar();if(n&&!n.isEmpty()&&!i.isEmpty()&&a&&e){for(var l=i.visibleBarsStrictRange(),c=l.lastBar(),u=l.firstBar(),d=["m0StartIndex","startIndex","endIndex","m2EndIndex","m3EndIndex"],h=o.firstValue(),_=0;_<e.length;_++)if(e[_]){for(var m=[],f=0;f<5;f++){var g=t[e[_][d[f]]];if(!isFinite(g))break;m.push(g)}if(0!==m.length&&!(m[0]>c||m[m.length-1]<u)){var v=+e[_].size;if(isFinite(v)){var S="level"+v,y=this._source.properties()[S];if(y.visible.value()){var b=parseInt(e[_].direction,10),w=[];w.dir=b,w.prices=[],w.orig_prices=[];for(var P=0;P<m.length;P++){if(void 0!==m[P]){var C={};if((A=m[P])<(a=r(o.bars().first())).index)continue;if(C.x=i.indexToCoordinate(A),null===(E=o.bars().valueAt(A))){w.push(void 0),w.prices.push(void 0),w.orig_prices.push(void 0),b=-b;continue}var T,x=1===b?E[TradingView.HIGH_PLOT]:E[TradingView.LOW_PLOT];if(w.orig_prices.push(x),w.prices.push(x),C.y=n.priceToCoordinate(x,h),C.label=p._wave5Labels[v][P],C.align=-1===b?"top":"bottom",C.color=y.color.value(),delete C.backgroundColor,w.id="wave_"+_,this._source===this._model.hoveredSource())(T=this._model.lastHittestData())&&T.wave&&T.wave.id===w.id&&(C.color="#FFFFFF",C.backgroundColor=y.color.value());C.fontsize=p._fontSizes[v],C._textCache={widths:[]},C.wave=w,w.push(C)}else w.push(void 0),w.prices.push(void 0);b=-b}w.inds=m,w.dir=b,w.color=y.color.value(),this._waves.push(w)}}}}if(this._source===this._model.hoveredSource())if(T=this._model.lastHittestData()){m=T.wave.inds,b=-T.wave.dir;var I=T.backgroundColor?T.backgroundColor:T.color,L=T.wave.orig_prices,M=null;for(P=0;P<m.length;P++){if(void 0!==m[P]){
var E,A=m[P],k=i.indexToCoordinate(A);if(null===(E=o.bars().valueAt(A))){b=-b;continue}x=L[P];var D=n.priceToCoordinate(x,h),R=new s(k,D);M&&this._highlights.push({points:[M,R],color:I}),M=R}b=-b}if(void 0!==L[1]&&void 0!==L[2]){var N=L[1],O=L[2],V=L[3],B=L[0];this._retracements.push({y:n.priceToCoordinate(N,h),x:0,extendLeft:!0,extendRight:!0,color:I,text:"",style:CanvasEx.LINESTYLE_SOLID}),this._retracements.push({y:n.priceToCoordinate(N,h),x:0,extendLeft:!0,extendRight:!0,color:I,text:"",style:CanvasEx.LINESTYLE_SOLID});b=O-N;if(void 0!==L[0]){x=N+(F=(B-N)/b)*b,k=i.indexToCoordinate(m[0]);this._retracements.push({y:n.priceToCoordinate(x,h),x:k,extendLeft:!1,extendRight:!0,color:I,text:""+F.toFixed(3),style:CanvasEx.LINESTYLE_DASHED})}if(void 0!==V){var F;x=O-(F=(O-V)/b)*b,k=i.indexToCoordinate(m[3]);this._retracements.push({y:n.priceToCoordinate(x,h),x:k,extendLeft:!0,extendRight:!1,color:I,text:""+F.toFixed(3),style:CanvasEx.LINESTYLE_DASHED})}}}}}}renderer(){this._invalidated&&(this.updateImpl(),this._invalidated=!1);for(var e=new c,t=this.CIRCLE_SIZE,i={},r=0;r<this._waves.length;r++)for(var o=this._waves[r],p=0;p<o.length;p++){var _=o[p];if(void 0!==_){var m,f;"top"===_.align?(m=_.y+4,i["top_"+_.x]?(m+=i["top_"+_.x]*t,i["top_"+_.x]=i["top_"+_.x]+1):i["top_"+_.x]=1,f=m+t):(m=_.y-t-4,i["bottom_"+_.x]?(m-=i["bottom_"+_.x]*t,i["bottom_"+_.x]=i["bottom_"+_.x]+1):i["bottom_"+_.x]=1,f=m+t);var g={};g.points=[new s(_.x,(m+f)/2)],g.text=_.label,g.color=_.color,g.backgroundColor=_.backgroundColor,g.font="Verdana",g.bold=!0,g.offsetX=0,g.offsetY=0,g.vertAlign="middle",g.horzAlign="center",g.fontsize=_.fontsize;var v=new l(l.REGULAR,_);e.append(new n(g,v))}}for(r=0;r<this._highlights.length;r++){var S=this._highlights[r],y={points:S.points,width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:u.generateColor(S.color,50),linewidth:3,linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:d.Circle,rightend:d.Circle};(b=new a).setData(y),e.append(b)}for(r=0;r<this._retracements.length;r++){var b,w=this._retracements[r];y={points:[new s(w.x+1,w.y),new s(w.x,w.y)],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:u.generateColor(w.color,50),linewidth:1,linestyle:w.style,extendleft:w.extendLeft,extendright:w.extendRight,leftend:d.Normal,rightend:d.Normal};(b=new a).setData(y),e.append(b);var P={points:[new s(w.x,w.y)],text:this._retracements[r].text,backgroundColor:"#606060",color:"#FFFFFF",vertAlign:"middle",horzAlign:"center",font:h,offsetX:w.extendRight?-50:50,offsetY:2,fontsize:12};e.append(new n(P))}return e}}p.prototype.CIRCLE_SIZE=16,p._wave5Labels=[["i","ii","iii","iv","v"],["(i)","(ii)","(iii)","(iv)","(v)"],["((i))","((ii))","((iii))","((iv))","((v))"],["1","2","3","4","5"],["(1)","(2)","(3)","(4)","(5)"],["((1))","((2))","((3))","((4))","((5))"],["I","II","III","IV","V"],["(I)","(II)","(III)","(IV)","(V)"],["((I))","((II))","((III))","((IV))","((V))"]],p._wave3Labels=[["a","b","c"],["A","B","C"]],
p._fontSizes=[10,10,10,11,11,11,12,12,12];t.study_ElliottWave=class extends o{margins(){return[.1,.1]}isVisible(){if(!this.properties().visible.value()||!this.isActualInterval())return!1;for(var e=0;e<=8;e++)if(this.properties()["level"+e].visible.value())return!0;return!1}_createViews(){super._createViews(),this._setPaneViews([new p(this.model(),this)])}}},32411:(e,t,i)=>{"use strict";var r=i(24194),s=i(14127).Study,n=i(14716).StudyStatusView,o=i(51424).DataWindowView,a=i(18748),l=a.DividendsPaneView,c=a.SplitsPaneView,u=a.EarningsPaneView,d=i(31565).isNumber,h=i(41657).INVALID_TIME_POINT_INDEX,p=i(70734).sortSourcesPreOrdered,_=p.Dividends,m=p.Splits,f=p.Earnings;class g extends s{destroy(){this._paneView.destroy(),super.destroy()}_createViews(){this._paneViews=[this._paneView],this._priceAxisViews=[],this._dataWindowView||(this._dataWindowView=new o),this._legendView=null,this._statusView||(this._statusView=new n(this,this._model.properties().scalesProperties.textColor))}onClickOutside(e){this._paneView.onClickOutside(e)}preferNoScale(){return!0}showInObjectTree(){return!1}isSavedInStudyTemplates(){return!1}isRemovedByStudyTemplates(){return!1}removeByRemoveAllStudies(){return!1}isDraggable(){return!1}copiable(){return!1}statusView(){return null}hasStateForAlert(){return!1}start(){super.start(),this._model.mainSeries().dataEvents().symbolResolved().subscribe(this,this._initPlotStash),this._initPlotStash()}stop(){super.stop(),this._model.mainSeries().dataEvents().symbolResolved().unsubscribe(this,this._initPlotStash)}isSavedInChart(e){return e}isSpeciallyZOrderedSource(){return!0}isUserDeletable(){return!1}_initPlotStash(){this._plotStash={}}_updatePlotStash(e,t){if(!this._restartRequired&&this._plotStash){var i=e.value.slice(),r=i.shift(),s=String(r);t?this._plotStash[s]?String(this._plotStash[s])!==String(i)&&(this._restartRequired=!0):this._plotStash[s]=i:this._plotStash[s]&&(this._restartRequired=!0)}}transformData(e){for(var t,i,r=e.length-1;r>=0;--r)i=(t=e[r]).index!==h&&this.isValid(t.value),this._updatePlotStash(t,i),i||e.splice(r,1)}isValid(e){throw new Error("Not Implemented")}restoreData(e){this.transformData(e.data),e.end=e.data.length,super.restoreData(e)}canHaveChildren(){return!1}isIncludedInAutoScale(){return!1}isCurrencySource(){return!1}_showTooltip(e,t){var r=this._model,s=this._model.timeScale(),n=[s.onScroll(),s.barSpacingChanged(),r.mainSeries().onSymbolIntervalChanged()],o=this.onClickOutside.bind(this),a=this._paneView.clearLastClicked.bind(this._paneView);return Promise.all([i.e(37610),i.e(43894),i.e(24115),i.e(73935),i.e(45867),i.e(49039)]).then(i.bind(i,80834)).then((function({showLollipopTooltip:i}){i({items:t(),position:e,customCloseSubscriptions:n,onClickOutside:o,onCustomClose:a,showScrollFades:!0})}))}isUnitSource(){return!1}}t.ESDStudyBase=g,t.study_ESD$TV_EARNINGS=class extends g{constructor(e,t,i,r){super(e,t,i,r),this._estimatePlotRow=null}_createViews(){this._paneView=new u(this._model,this,this._showTooltip.bind(this)),super._createViews()}zorder(){return f}isValid(e){
var t=e[3],i=e[4];return d(t)&&d(i)}_restorePointset(e){return{index:e.index,value:[e.tickmark,void 0,e.estimate,d(e.period)?e.period:r(e.period).unix(),d(e.date)?e.date:r(e.date).unix()]}}restoreData(e){super.restoreData(e);var t=null;if(e.estimate)t=this._restorePointset(e.estimate);else if(e.pointSets&&null==e.pointSetsVersion){if(null!==(r=this._getSymbol())){var i=r.split(":")[1].toUpperCase();e.pointSets[r]?t=this._restorePointset(e.pointSets[r]):e.pointSets[i]&&(t=this._restorePointset(e.pointSets[i]))}}else if(e.pointSets&&"1"===e.pointSetsVersion){var r;if(null!==(r=this._getSymbol())){i=r.split(":")[1].toUpperCase();e.pointSets[r]?t=e.pointSets[r].estimate:e.pointSets[i]&&(t=e.pointSets[i].estimate)}}else null!=e.estimatePlotRow&&"2"===e.pointSetsVersion&&(t=e.estimatePlotRow);this._estimatePlotRow=t}getEstimate(){return this._estimatePlotRow}_getSymbol(){var e=this._series.symbolInfo();return e?e.base_name[0].toLowerCase():null}},t.study_ESD$TV_SPLITS=class extends g{_createViews(){this._paneView=new c(this._model,this,this._showTooltip.bind(this)),super._createViews()}zorder(){return m}isValid(e){var t=e[3];return d(t)}},t.study_ESD$TV_DIVIDENDS=class extends g{_createViews(){this._paneView=new l(this._model,this,this._showTooltip.bind(this)),super._createViews()}zorder(){return _}isValid(e){var t=e[2];return d(t)}}},85763:(e,t,i)=>{"use strict";var r=i(44560).Version,s=i(87380).getLogger("Chart.StudyMigration");function n(e){this._studyId=e,this._maxToVers=r.ZERO,this._maxFromVers=r.ZERO,this._migrs=[]}n.prototype.addMigration=function(e,t,i){var s=r.parse(e),n=r.parse(t);s.isGreater(this._maxFromVers)&&(this._maxFromVers=s),n.isGreater(this._maxToVers)&&(this._maxToVers=n),this._migrs.push({fromVers:s,toVers:n,rules:i})},n.prototype.updateInputs=function(e,t,i){if(!i)return i;for(var r=TradingView.clone(i),n=e;n.isLess(t);){var o=this._findMigration(n);if(null==o)break;if(s.logNormal("Migrating study inputs from "+o.fromVers+" to "+o.toVers+" version, studyId: "+this._studyId+", migration: "+JSON.stringify(o)+", inputs: "+JSON.stringify(i)),r=this._applyMigration(r,o),!n.isLess(o.toVers))throw new Error("Problems in study migration process... Possible infinite cycle has been detected and stopped.");n=o.toVers}return n>e&&s.logNormal("Study inputs migration is done, studyId: "+this._studyId+", inputs: "+JSON.stringify(r)),r},n.prototype._findMigration=function(e){for(var t=-1,i=this._maxFromVers,r=0;r<this._migrs.length;r++){var s=this._migrs[r];s.fromVers.isLess(e)||s.fromVers.isLessOrEqual(i)&&(i=s.fromVers,t=r)}return t<0?null:this._migrs[t]},n.prototype._applyMigration=function(e,t){for(var i=e,r=0;r<t.rules.length;r++){var s=t.rules[r];i=this._getApplyRuleFun(s.type)(i,s)}return i},n.prototype._getApplyRuleFun=function(e){if("inputRemoved"===e)return n._applyInputRemovedRule;if("inputChangedType"===e)return n._applyInputChangedTypeRule;if("inputChangedMinMax"===e)return n._applyInputChangedMinMaxRule;if("inputChangedOptions"===e)return n._applyInputChangedOptionsRule
;throw new Error("Unknown migration rule type: "+e)},n._applyInputRemovedRule=function(e,t){if(!(t.inputId in e))return e;if("removeVal"!==t.action)throw new Error("Unexpected rule.action="+t.action+" in rule.type="+t.type);var i=e[t.inputId];return delete e[t.inputId],s.logNormal("Input "+t.inputId+"="+i+" removed"),e},n._applyInputChangedTypeRule=function(e,t){var i=e[t.inputId];if("resetToDefVal"===t.action)return e[t.inputId]=t.defVal,s.logNormal("Input "+t.inputId+"="+i+" reset to default value "+t.defVal),e;if("convertVal"===t.action){if(null==i)return e;if("float"===t.inputTypeFrom&&"integer"===t.inputType)return e[t.inputId]=Math.round(e[t.inputId]),s.logNormal("Input "+t.inputId+"="+i+" converted to value "+e[t.inputId]),e;if("integer"===t.inputTypeFrom&&"float"===t.inputType)return e;if("text"===t.inputTypeFrom&&"source"===t.inputType)return n._isValidSource(i,t.options)||(e[t.inputId]=t.defVal),e;throw new Error("Cannot convertVal from "+t.inputTypeFrom+" to "+t.inputType)}throw new Error("Unknown action "+t.action+" for rule with type "+t.type)},n._isValidSource=function(e,t){return e.indexOf("$")>=0||t.indexOf(e)>=0},n._applyInputChangedMinMaxRule=function(e,t){if("adjustValIfNeeded"!==t.action)throw new Error("Unknown action "+t.action+" for rule with type "+t.type);var i=e[t.inputId];return i<t.minVal?e[t.inputId]=t.minVal:i>t.maxVal&&(e[t.inputId]=t.maxVal),s.logNormal("Input "+t.inputId+"="+i+" adjusted to value "+e[t.inputId]),e},n._applyInputChangedOptionsRule=function(e,t){if(!(["text"].indexOf(t.inputType)>=0&&"resetToDefValIfNeeded"===t.action))throw new Error("Unexpected rule.inputType="+t.inputType+" in rule.action="+t.action);var i=e[t.inputId];return t.options.indexOf(i)<0&&(e[t.inputId]=t.defVal,s.logNormal("Input "+t.inputId+"="+i+" reset to default value "+t.defVal)),e},e.exports=n},16834:(e,t,i)=>{"use strict";var r=i(72927).Point,s=i(47658).Series,n=i(14127).Study,o=i(12372).OverlayPriceAxisView,a=i(63956).PanePriceAxisView,l=i(87782),c=l.SeriesAreaPaneView,u=l.SeriesLinePaneView,d=l.SeriesHollowCandlesPaneView,h=l.SeriesCandlesPaneView,p=l.SeriesBarsPaneView,_=l.SeriesBaselinePaneView,m=i(82862).SeriesWaterlinePaneView,f=i(14716).StudyStatusView,g=i(52950).OverlayDataWindowView,v=i(71330).OverlayLegendView,S=i(39755).OverlayLegendValuesProvider,y=i(24966).OverlayStatusProvider,b=i(66786).SeriesBarColorer,w=i(11258).HorizontalLineRenderer,P=i(22842),C=i(49949).OverlayStudyPriceLineAxisView,T=i(52496).StudyOverlayBase,x=!P.enabled("hide_study_overlay_legend_item");class I{constructor(e,t){this._source=e,this._model=t,this._points=[new r(0,0)],this._lineRenderer=new w}update(){if(this._visible=!1,this._source.properties().showPriceLine.value()){var e=this._source.lastValueData(void 0,!0);e.noData||(this._visible=!0,this._points=[new r(0,e.coordinate)],this._color=e.color)}}renderer(){var e={};return e.width=this._model.timeScale().width(),e.height=this._source.priceScale().height(),e.y=this._points[0].y,e.color=this._color,e.linewidth=1,e.linestyle=CanvasEx.LINESTYLE_DOTTED,
e.visible=this._visible,this._lineRenderer.setData(e),this._lineRenderer}}t.study_Overlay=class extends T{constructor(e,t,i,r){super(e,t,i,r),this._paneView=null;var s=this;this.properties().minTick.listeners().subscribe(null,(function(){s._recreatePriceFormattingDependencies(),s.updateAllViews(),s._model.fullUpdate()}))}_showLastValueOnPriceScale(){return this._model.properties().scalesProperties.showSeriesLastValue.value()}_createViews(){this._priceAxisViews=[];var e=new o(this);this._priceAxisViewsBase=[e];var t=new C(this);this._priceLinesAxisViews=[t],this._paneViews=[],this._labelPaneViews=[];var i=null,r=null;switch(this._properties.style.value()){case s.STYLE_BARS:r=new p(this,this._model);break;case s.STYLE_CANDLES:r=new h(this,this._model);break;case s.STYLE_HOLLOW_CANDLES:r=new d(this,this._model);break;case s.STYLE_LINE:r=new u(this,this._model);break;case s.STYLE_AREA:r=new c(this,this._model);break;case s.STYLE_BASELINE:r=new _(this,this._model),i=new m(this)}r&&this._paneViews.push(r),null!==i&&this._paneViews.push(i),this._paneViews.push(new I(this,this._model)),this._dataWindowView||(this._dataWindowView=new g(this,this._model)),this._legendView||(this._legendView=new v(this,this._model)),this._statusView||(this._statusView=new f(this)),this._priceAxisViews=[].concat(this._priceAxisViewsBase,this._hlinesPriceAsisViews,this._horizlinesPriceAsisViews),this._labelPaneViews.push(new a(e,this,this._model))}barColorer(){return new b(this)}_tryChangeInputs(){n.prototype._tryChangeInputs.call(this),this.m_formatter=null,this.priceScale().updateFormatter()}_onQuotesUpdate(e,t){!this._legendView||void 0===t.values.change&&void 0===t.values.change_percent||(this._legendView.update(),this._model.updateSource(this))}destroy(){this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._quotesProvider.destroy(),super.destroy()}tags(){var e=[],t=this.symbolInfo();return t?e.push(t.name):this._properties.inputs.symbol.value()&&e.push(this._properties.inputs.symbol.value()),e}statusView(){return x?n.prototype.statusView.call(this):null}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(60006),i.e(71667),i.e(16e3),i.e(75291),i.e(60607)]).then(i.bind(i,56487))).StudyOverlayDefinitionsViewModel}defaultPlotIdForAlert(){return""}changeStyles(){this.data().each((function(e,t){t[TradingView.STYLE_PLOT]=null})),n.prototype.changeStyles.call(this)}valuesProvider(){return new S(this,this.model())}statusProvider(e){return new y(this,this.model())}}},92582:(e,t,i)=>{"use strict";var r=i(24322).NonSeriesStudy,s=i(62288).HitTestResult,n=i(56288).CompositeRenderer,o=i(29295).ScaledPaneRenderer;class a extends o{constructor(e,t){super(),this._data=e,this._textCache=t}_drawImpl(e){e.textBaseline="bottom",e.font=(this._data.bold?"bold ":"normal ")+this._data.fontsize+"px "+this._data.font;var t=Math.round(e.measureText(this._data.text).width+4);this._textCache.width=t,e.translate(this._data.x+.5,this._data.y),e.strokeStyle=this._data.borderColor,e.fillStyle=this._data.backColor,e.beginPath(),e.moveTo(0,0),
1===this._data.type?(e.lineTo(5,-5),e.lineTo(t/2,-5),e.lineTo(t/2,-5-this._data.fontsize),e.lineTo(-t/2,-5-this._data.fontsize),e.lineTo(-t/2,-5),e.lineTo(-5,-5),e.lineTo(0,0)):(e.lineTo(5,5),e.lineTo(t/2,5),e.lineTo(t/2,5+this._data.fontsize),e.lineTo(-t/2,5+this._data.fontsize),e.lineTo(-t/2,5),e.lineTo(-5,5),e.lineTo(0,0)),e.fill(),e.stroke(),e.fillStyle=this._data.textColor,e.textAlign="center",e.textBaseline="middle",1===this._data.type?e.fillText(this._data.text,0,-5-this._data.fontsize/2):e.fillText(this._data.text,0,5+this._data.fontsize/2)}hitTest(e){var t=this._textCache.width,i=this._data.fontsize+15,r=this._data.x-t/2,n=this._data.y;return 1===this._data.type&&(n-=i),e.x>=r&&e.x<=r+t&&e.y>=n&&e.y<=n+i?new s(s.REGULAR):null}}class l{constructor(e,t){this._model=e,this._source=t,this._pivots=[],this._textCache={},this._invalidated=!0}update(){this._invalidated=!0}updateImpl(){if(this._pivots=[],this._source.customData()&&this._source.customData().pivots&&this._source.properties().visible.value()){var e=this._source.customData().pivots,t=this._source._indexes,i=this._model.timeScale(),r=this._source.priceScale(),s=this._model.mainSeries(),n=s.firstValue();if(r&&!r.isEmpty()&&!i.isEmpty()&&n)for(var o=i.visibleBarsStrictRange(),a=o.firstBar(),l=o.lastBar(),c=0;c<e.length;c++)if(e[c]){var u=t[e[c].index];if(!(u<a||u>l)){var d=e[c].type,h=s.bars().valueAt(u);if(null!==h){var p=1===d?h[TradingView.HIGH_PLOT]:h[TradingView.LOW_PLOT],_=Math.round(i.indexToCoordinate(u)),m=r.priceToCoordinate(p,n);1===d?m-=i.barSpacing()/6:m+=i.barSpacing()/6+1,m=Math.round(m),this._pivots.push({x:_,y:m,price:r.formatPrice(p,n),type:d})}}}}}_pixelMargins(){return this._source.properties().fontsize.value()+15}topPixelMargin(){return this._pixelMargins()}bottomPixelMargin(){return this._pixelMargins()}renderer(){if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),0!==this._pivots.length){for(var e=this._source.properties().font.value(),t=this._source.properties().fontsize.value(),i=this._source.properties().borderColor.value(),r=this._source.properties().backColor.value(),s=this._source.properties().textColor.value(),o=new n,l=0;l<this._pivots.length;l++){var c=this._pivots[l],u={x:c.x,y:c.y,type:c.type,text:c.price,font:e,fontsize:t,borderColor:i,backColor:r,textColor:s},d=l;this._textCache[d]||(this._textCache[d]={}),o.append(new a(u,this._textCache[d]))}return o}}}t.study_PivotPointsHighLow=class extends r{isVisible(){return this.properties().visible.value()&&this.isActualInterval()}_createViews(){super._createViews(),this._setPaneViews([new l(this.model(),this)])}autoScaleInfo(e,t){return{range:this._series.priceRange(e,t),topPixelMargin:this._paneViews.length>0?this._paneViews[0].topPixelMargin():0,bottomPixelMargin:this._paneViews.length>0?this._paneViews[0].bottomPixelMargin():0}}}},40952:(e,t,i)=>{"use strict";var r=i(16282).assert,s=i(31565).clone,n=i(14127).Study,o=i(40989).PlotList,a=i(45433).studyPlotFunctionMap,l=i(45433).studyEmptyPlotValuePredicate;class c{constructor(e,t,i){this._strategyPlotIndex=e,
this._targetPlotIndex=t,this._startIndex=i}rebuildData(e){var t=this._targetPlotIndex+1,i=this._strategyPlotIndex+1,r=null,s=null;e.range(this._startIndex||e.firstIndex(),e.lastIndex()).each((function(n,o){var a=o[t],l=o[i]?Math.round(o[i]):null;if(o[t]=null,o[i]=null,!l||l>0)return!1;var c=n+l,u={pointIndex:c,value:a};if(s){if(s.pointIndex!==u.pointIndex){c>=0&&(e.valueAt(c)[t]=a);var d=!1;r&&(d=r.value<=s.value&&s.value<=a||r.value>=s.value&&s.value>=a),d?s.pointIndex>=0&&(e.valueAt(s.pointIndex)[t]=null):r=s,s=u}}else s=u;return!1}))}}t.study_ScriptWithDataOffset=class extends n{constructor(e,t,i,r){super(e,t,i,r),this._underlyingData=new o(a(r),l)}clearData(){super.clearData(),this._underlyingData.clear()}_mergeData(e){this._invalidateLastNonEmptyPlotRowCache();var t=this._underlyingData.firstIndex();this._underlyingData.merge(e),t!==this._underlyingData.firstIndex()&&(this.m_data=new o(a(this._metaInfo),l));var i=this.m_data.lastIndex();this._underlyingData.range(i,this._underlyingData.lastIndex()).each(function(e,t){return this.m_data.add(e,s(t)),!1}.bind(this)),this._plotsForStrategyProcessing().forEach((function(e){new c(e.strategyIndex,e.targetIndex,i).rebuildData(this.m_data)}),this)}_plotsForStrategyProcessing(){var e=[];return this._metaInfo.plots.forEach((function(t,i){if("dataoffset"===t.type){var s=this._metaInfo.plots.findIndex((function(e){return e.id===t.target}));r(s>=0,"target plot not found for strategy plot "+t.id);var n={strategyIndex:i,targetIndex:s};e.push(n)}}),this),e}}},79318:(e,t,i)=>{"use strict";var r=i(65066),s=i(18184),n=i(22842),o=i(14127).Study,a=i(59246).StudyStrategyOrdersPaneView,l=["strategy_props"];e.exports.StudyStrategy=class extends o{constructor(e,t,i,s){super(e,t,i,s),this._barsIndexes=[],this._srcBarsIndexes=[],this._reportDataBuffer=null,this._reportData=null,this.watchedData=new r,this.model().addStrategySource(this)}stop(){super.stop(),this.model().removeStrategySource(this)}start(){this.model().addStrategySource(this),super.start()}hasStateForAlert(){return n.enabled("alerts")}inputsForAlertState(){var e=this.inputs();return this._metaInfo.inputs.forEach((function(t){var i=e[t.id];i&&t.internalID&&(i.internalID=t.internalID)})),e}onData(e){e.method&&"data_update"!==e.method&&this.watchedData.setValue({method:e.method}),super.onData(e)}_onDataUpdated(e,t,i){var r=t&&t.data&&t.data.report;r?(t.isUpdate&&this._reportDataBuffer&&(r=s.extend(this._reportDataBuffer,r)),this._reportDataBuffer=this._reportData=s.extend(this._reportDataBuffer||{},r),this.watchedData.setValue({method:"data_update",nonSeriesData:t})):this.watchedData.setValue({method:"data_update",nonSeriesData:{data:{report:this._reportDataBuffer}}});var n=!(!t||!t.indexes_replace);("nochange"!==i&&i.length>0||this._reportData.filledOrders.length!==this._barsIndexes.length)&&(r||n)&&this._collateBarsIndexes(Array.isArray(i)?i:this._srcBarsIndexes),super._onDataUpdated(e,t,i)}_collateBarsIndexes(e){this._srcBarsIndexes=e;var t=this._reportData&&this._reportData.filledOrders;if(t&&t.length){
this._barsIndexes.length=0;for(var i=0;i<t.length;i++)this._barsIndexes[i]=e[t[i].tm]}}reportData(){return this._reportData}ordersData(){return this._reportData&&this._reportData.filledOrders}barsIndexes(){return this._barsIndexes}clearData(){super.clearData(),this._strategyOrdersPaneView&&this._strategyOrdersPaneView.clearItems()}strategyOrdersPaneView(){return this.isSourceHidden()?null:this._strategyOrdersPaneView}restoreData(e){o.prototype.restoreData.apply(this,arguments),this.model().addStrategySource(this),e.reportData&&e.barsIndexes&&(this._reportData=e.reportData,this._barsIndexes=e.barsIndexes,this.watchedData.setValue({method:"data_update",nonSeriesData:{data:{report:this._reportData}}})),e.activeState&&(this._activeState=!0)}activeState(){return this._activeState}updateAllViews(){super.updateAllViews(),this._strategyOrdersPaneView&&this._strategyOrdersPaneView.update()}_createViews(){super._createViews(),this._strategyOrdersPaneView=new a(this,this._series,this._model)}state(e){var t=o.prototype.state.apply(this,arguments);return e&&this._reportData&&this._barsIndexes&&(t.data||(t.data={}),t.data.reportData=this._reportData,t.data.barsIndexes=this._barsIndexes,t.data.activeState=this.model().activeStrategySource().value()===this),t}_titleInputs(e){return this.inputs({symbolsForDisplay:!0,skipHiddenInputs:!0,skipFakeInputs:!1,fakeInputsForDisplay:!0,asObject:!1,skippedGroups:l,noExchanges:e,skipColorInputs:!0,skipTimeInputs:!0})}_getTelemetryObjectName(){return"strategy"}_getTelemetryAdditionalData(){return{symbol:this.series().actualSymbol(),resolution:this.series().interval()}}}},95294:(e,t,i)=>{"use strict";var r=i(16282).assert,s=i(90211).patchSourceState,n=i(57746),o=i(44560).Version,a=i(87380).getLogger("Chart.Study.Versioning"),l=i(11767),c=i(84234),u=i(11490).extractPineId,d=i(74845).migrateMetaInfoAndPropState;function h(e,t){if(!e)throw new Error("No studies metainfo");var r=i(85763);if(this._studiesMetainfo=e,!t)throw new Error("No studies migrations");this._studiesMigrations=t,this._migrations={};for(var s=0;s<this._studiesMigrations.length;s++)for(var n=this._studiesMigrations[s],o=n.versFrom,l=n.versTo,c=0;c<n.studyMigrations.length;c++){var u=n.studyMigrations[c],d=u.studyId;if(0!==u.rules.length){var h=d in this._migrations?this._migrations[d]:new r(d);h.addMigration(o,l,u.rules),this._migrations[d]=h}else a.logError("Study Migration should have at least one convertion rule")}this._clientMigrations=[function(e,t){if(0===this._studiesMetainfo.length||!e.isTVScript||e.version>=22)return t;for(var i={},r=0,s=0;;){var n=t[s];if(void 0===n)break;var o=t[n.id];n.isFake&&(n.id="in_"+r++),i[s]=n,i[n.id]=o,s++}return i}]}h.prototype.updateMetaInfo=function(e){if(!e)return e;r(!e.isTVScript,"This method should update only built-in java indicators metaInfo. For Pine indicators use updateMetaInfoAsync");for(var t=null,i=this._studiesMetainfo,s=0;s<i.length;s++)if(i[s].id===e.id){t=i[s];break}return TradingView.clone(t)},h.prototype.updateMetaInfoAsync=function(e){if(!e)return{sync:!1,
result:Promise.reject("No old metaInfo was given")};var t=new c(e),i=c.versionOf(e);if(e.isTVScript&&!e.pine&&i<c.VERSION_PINE_PROTECT_TV_4164){r(TradingView.isExistent(e.scriptIdPart),"scriptIdPart is missing, study "+JSON.stringify(e));var s=e.scriptIdPart;return{sync:!1,result:new Promise((function(i,r){n.processLegacy(s,e.TVScriptSourceCode).done((function(e){t.removeDefaults();var r=new c(e);r.createDefaults(),d(r),i(r)})).fail((function(e,t){r(e)}))}))}}if(e.isTVScript&&e.pine)return(e._serverMetaInfoVersion||i)<c.CURRENT_METAINFO_FORMAT_VERSION?{sync:!1,result:new Promise((function(i,r){n.translateScriptAsync2(e.scriptIdPart,e.pine.version).done((function(e){t.removeDefaults();var r=new c(e);r.createDefaults(),d(r),i(r)})).fail((function(e,t){r(e)}))}))}:(t.createDefaults(),{sync:!0,result:t});for(var o=null,a=this._studiesMetainfo,l=0;l<a.length;l++)if(a[l].id===e.id){o=a[l];break}return{sync:!0,result:o?TradingView.clone(o):null}},h.prototype.lastVersionOfStudy=function(e){return this._studiesMetainfo.find((function(t){return t.id===e})).version},h.prototype.updateStudyInputs=function(e,t,i,r,s){var n=TradingView.clone(r);if(e in this._migrations){var l,c=o.parse(t);if("last"===i){var u=this.lastVersionOfStudy(e);l=o.parse(u)}else l=o.parse(i);n=this._migrations[e].updateInputs(c,l,n)}if(null==s)return n;for(var d in s)d in n||(n[d]=s[d]);for(var d in n)if(!(d in s)){var h=n[d];a.logWarn("Extra input detected, studyId="+e+", versionFrom="+t+", inputId="+d+", inputValue="+h+", removing it and continue..."),delete n[d]}return n},h.prototype.updateStudyState=function(e,t,i){if(null==e||null==t||null==i)return e;if(e=TradingView.clone(e),!(t.isTVScript||!!t.pine)&&t.version!==i.version){var r=i&&i.defaults.inputs,s=this.updateStudyInputs(t.id,t.version,i.version,e.inputs,r);e.inputs=s}for(var n=0;n<this._clientMigrations.length;++n){s=this._clientMigrations[n].call(this,t,e.inputs);Object.keys(s).length===Object.keys(e.inputs).length?e.inputs=s:a.logWarn("StudyVersioning._clientMigrations application returned bad result. Skipping it...")}var o=c.versionOf(t);if(t.isTVScript&&t.TVScriptSourceCode&&o>=12&&o<=26){var l={};for(n=0;n<t.plots.length;++n){var u=t.plots[n],d=i.plots[n];l[u.id]=d.id}var h=Object.keys(e.styles);for(n=0;n<h.length;++n){var p=h[n],_=e.styles[p];delete e.styles[p];var m=l[p];e.styles[m]=_}var f=Object.keys(e.plots);for(n=0;n<f.length;++n){var g=f[n];p=e.plots[g].id;e.plots[g].id=l[p]}}return e},h.prototype.patchPointsBasedStudyState=function(e){return h._fixInputsMaxValue(e.state,e.metaInfo),"LineToolRegressionTrend"===e.type&&(e=s(e)),e},h.prototype.patchPointsBasedStudyData=function(e,t){if(!l.isProd())return t;if(!e||!t)return t;var i=TradingView.clone(t);return"VbPFixed@tv-volumebyprice"===e.id&&e.version&&e.version<=4&&h._patchOldVolumeProfiles(0,i),i},h.prototype.patchStudyData=function(e,t,i,r){if(!l.isProd())return{data:t,nsData:i,indexes:r};var s=TradingView.clone(t),n=TradingView.clone(i),o=TradingView.clone(r)
;"VbPVisible@tv-volumebyprice"===e.id&&e.version&&e.version<=4&&h._patchOldVolumeProfiles(0,s.graphics),"VbPSessions@tv-volumebyprice"===e.id&&e.version&&e.version<=4&&h._patchOldVolumeProfiles(0,s.graphics);var a=c.versionOf(e);if(e.isTVScript&&e.TVScriptSourceCode&&a>=12&&a<=26){var u=s.columns;s.columns=[];for(var d=0;d<u.length;++d){var p="plot_"+d;s.columns.push(p)}}return{data:s,nsData:n,indexes:o}},h._patchOldVolumeProfiles=function(e,t){var i=t.hhists[e].data,r=[];for(var s in i)r=r.concat(i[s]);t.hhists[0].data=r},h._fixInputsOrder=function(e,t){for(var i=c.getOrderedInputIds(t),r=h.splitInputs(e.inputs),s=r.arr,n=r.obj,o=TradingView.merge({},n),a=0;a<i.length;++a){var l=i[a],u=h.findInputKeyById(s,l);if(null!==u){var d=s[u];o[a]=d}}e.inputs=o},h.INPUT_MAX_VALUE=1e12,h._verifyInputsMaxValue=function(e){var t=h.INPUT_MAX_VALUE;if(e.inputs)for(var i=0;i<e.inputs.length;i++){var r=e.inputs[i];"integer"===r.type&&(r.max&&r.max>t&&a.logWarn("Bad integer input max value in metaInfo id="+e.id+" title="+e.description))}},h._fixInputsMaxValue=function(e,t){if(!TradingView.isAbsent(t)){var i=h.INPUT_MAX_VALUE;if(t.inputs)for(var r=0;r<t.inputs.length;r++){"integer"===(a=t.inputs[r]).type&&(a.max&&a.max>i&&(a.max=i))}if(e&&e.inputs){var s=h.splitInputs(e.inputs),n=s.arr;for(var o in n){var a;"integer"===(a=n[o]).type&&(a.max&&a.max>i&&(a.max=i))}e.inputs=TradingView.merge(s.obj,s.arr)}}},h.prototype.patchPropsStateAndMetaInfo=function(e,t,i){"Script$BOOKER"!==t.productId||t.alerts||delete e.alerts,h._fixInputsOrder(e,t),h._fixInputsMaxValue(e,t);var r=h.splitInputs(e.inputs);e.inputs=r.obj;var s=c.versionOf(t);s<c.METAINFO_FORMAT_VERSION_SOS_V2&&t.isChildStudy&&(e.isChildStudy=t.isChildStudy);if(t.isTVScript&&t.version<60&&("Script$TV_EARNINGS@tv-scripting"!==t.id&&"Script$TV_DIVIDENDS@tv-scripting"!==t.id&&"Script$TV_SPLITS@tv-scripting"!==t.id||delete t.TVScriptSourceCode),"Volume"!==t.id&&"Volume@tv-basicstudies"!==t.id||0!==t.inputs.length||(t.inputs=[{id:"length",type:"integer",defval:20,min:1,max:1e3}],t.plots.push({id:"vol_ma",type:"line"})),"Volume@tv-basicstudies"===t.id&&t.version&&t.version<=46&&void 0===e.styles.vol.transparency&&(e.styles.vol.transparency=e.transparency||87),"PivotPointsStandard@tv-basicstudies"===t.id&&(0===t.inputs.length?(e.inputs={kind:"Traditional",showHistoricalPivots:!0},t.inputs=[{defval:"Traditional",id:"kind",type:"text",options:["Traditional","Fibonacci","Woodie","Classic","DeMark","Camarilla"]},{id:"showHistoricalPivots",type:"bool",defval:!0}]):1===t.inputs.length&&(e.inputs={kind:"Traditional"},t.inputs=[{defval:"Traditional",id:"kind",type:"text",options:["Traditional","Fibonacci","Woodie","Classic","DeMark","Camarilla"]},{id:"showHistoricalPivots",type:"bool",defval:!0}]),void 0===e._hardCodedDefaultsVersion)){e._hardCodedDefaultsVersion=1;var n=e.color;delete e.color,e.levelsStyle={colors:{P:n,"S1/R1":n,"S2/R2":n,"S3/R3":n,"S4/R4":n,"S5/R5":n}}}"CMF"===t.shortId&&2===t.inputs.length&&(e.inputs={length:e.inputs["length fast"]},t.inputs=t.inputs.splice(0,1),
t.inputs[0].id="length"),t.defaults&&void 0===t.defaults.precision&&s<c.VERSION_NEW_STUDY_PRECISION_FORMAT&&(-1!==["Volume@tv-basicstudies","VbPVisible@tv-volumebyprice","VbPSessions@tv-volumebyprice"].indexOf(t.id)?t.defaults.precision=0:t.defaults.precision=4);if(t.version<60)for(var o=["TV_DIVIDENDS","TV_SPLITS","TV_EARNINGS"],a="Script".length,l=0;l<o.length;l++)t.id.startsWith("Script$"+o[l]+"@tv-scripting")&&(t.fullId="ESD"+t.fullId.substring(a),t.id="ESD"+t.id.substring(a),t.name="ESD"+t.name.substring(a),t.shortId="ESD"+t.shortId.substring(a),t.productId="ESD"+t.productId.substring(a));var p={"ESD$TV_EARNINGS@tv-scripting":{fullId:"Earnings@tv-basicstudies-129!",id:"Earnings@tv-basicstudies",name:"Earnings@tv-basicstudies",shortId:"Earnings",productId:"tv-basicstudies"},"ESD$TV_SPLITS@tv-scripting":{fullId:"Splits@tv-basicstudies-129!",id:"Splits@tv-basicstudies",name:"Splits@tv-basicstudies",shortId:"Splits",productId:"tv-basicstudies"},"ESD$TV_DIVIDENDS@tv-scripting":{fullId:"Dividends@tv-basicstudies-129!",id:"Dividends@tv-basicstudies",name:"Dividends@tv-basicstudies",shortId:"Dividends",productId:"tv-basicstudies"}};if(t.id in p&&Object.assign(t,p[t.id]),s<c.VERSION_PINE_PROTECT_TV_4164){var _={"StrategyScript$STD;Consecutive%1Ups/Downs%1Strategy":{pineId:"STD;Consecutive%1Ups%1Downs%1Strategy",className:"StrategyScript"},Script$EDGR_NET_INCOME_FROM_CONTINUING_OPERATIONS_APPLICABLE_TO_COMMON_V2:{pineId:"Script$EDGR_NET_INCOME_FROM_CONTINUING_OPS_APPLICABLE_TO_COMMON_V2",className:"Script"}};if(t.shortId in _){var m=_[t.shortId].className+"$"+_[t.shortId].pineId,f={scriptIdPart:_[t.shortId].pineId,fullId:t.fullId.replace(t.shortId,m),id:t.id.replace(t.shortId,m),name:t.name.replace(t.shortId,m),shortId:m};TradingView.merge(t,f),TradingView.merge(e,f)}var g=u(t.fullId),v=g&&g.match(/^(USER)(_\d+)(;)(.*)$/);if(v){var S=v[0],y=v[1]+v[3]+v[2]+v[4];f={scriptIdPart:y,fullId:t.fullId.replace(S,y),id:t.id.replace(S,y),name:t.name.replace(S,y),shortId:t.shortId.replace(S,y)};TradingView.merge(t,f),TradingView.merge(e,f)}}if("MA"===t.id){var b=new c({id:"MAExp",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgExp",type:"line"}],palettes:{}}),w=new c({id:"MASimple",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgSimple",type:"line"}],palettes:{}}),P=new c({id:"MAVolumeWeighted",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgVolumeWeighted",type:"line"}],palettes:{}}),C=new c({id:"MAWeighted",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{
id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgWeighted",type:"line"}],palettes:{}});switch(e.inputs.type){case"exp":t=b;break;case"simple":t=w;break;case"weighted":t=C;break;case"volume weighted":t=P}e.styles[t.plots[0].id]=e.styles.MovAvg,delete e.styles.MovAvg,delete e.inputs.type}return i.oldShowStudyLastValueProperty&&(e.oldShowLastValue=e.showLastValue),delete e.showLastValue,delete e.showStudyArguments,d(t,e),{propsState:e,metaInfo:t}},h.mergeInputs=function(e,t){h.mergeInputsArrPart(e,t),h.mergeInputsObjPart(e,t)},h.mergeInputsArrPart=function(e,t){var i=h.splitInputs(t);for(var r in i.arr){var s=h.findInputKeyById(e,i.arr[r].id);s?TradingView.merge(e[s],i.arr[r]):h.appendInputInfoToArr(e,i.arr[r])}},h.mergeInputsObjPart=function(e,t){var i=h.splitInputs(t);TradingView.merge(e,i.obj)},h.appendInputInfoToArr=function(e,t){var i=-1;for(var r in e){var s=parseInt(r,10);isNumber(s)&&(s>i&&(i=s))}e[i+1]=t},h.splitInputs=function(e){var t={},i={};for(var r in e)isNumber(parseInt(r,10))?t[r]=e[r]:i[r]=e[r];return{arr:t,obj:i}},h.findInputKeyById=function(e,t){var i=null;for(var r in e)if(isNumber(parseInt(r,10))&&e[r].id===t){i=r;break}return i},h.getInputKeyById=function(e,t){var i=h.findInputKeyById(e,t);if(!i)throw new Error("Cannot find input with id: "+t);return i},e.exports=h},79093:(e,t,i)=>{"use strict";var r=i(72927).Point,s=i(24322).NonSeriesStudy,n=i(32579).TrendLineRenderer,o=i(62288).HitTestResult,a=i(56288).CompositeRenderer,l=i(98815).LineEnd;class c{constructor(e,t){this._model=e,this._source=t,this._pivots=[],this._textCache={},this._invalidated=!0}update(){this._invalidated=!0}updateImpl(){if(this._pivots=[],this._source.customData()&&this._source.customData().zigzag&&this._source.properties().visible.value()){var e=this._source.customData().zigzag,t=this._source._indexes,i=this._model.timeScale(),r=this._source.priceScale(),s=this._model.mainSeries(),n=s.firstValue();if(r&&!r.isEmpty()&&!i.isEmpty()&&n)for(var o=0;o<e.length;o++)if(e[o]){var a=t[e[o].index],l=e[o].type,c=s.bars().valueAt(a);if(null!==c){var u=1===l?c[TradingView.HIGH_PLOT]:c[TradingView.LOW_PLOT],d=Math.round(i.indexToCoordinate(a)),h=r.priceToCoordinate(u,n);this._pivots.push({x:d,y:h})}}}}renderer(){this._invalidated&&(this.updateImpl(),this._invalidated=!1);for(var e=new a,t=this._source.properties().color.value(),i=this._source.properties().linewidth.value(),s=1;s<this._pivots.length;s++){var c=this._pivots[s],u=this._pivots[s-1],d={points:[new r(u.x,u.y),new r(c.x,c.y)],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:t,linewidth:i,linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:l.Normal,rightend:l.Normal},h=new n;h.setData(d),h.setHitTest(new o(o.REGULAR)),e.append(h)}return e}}t.study_ZigZag=class extends s{isVisible(){return this.properties().visible.value()&&this.isActualInterval()}_createViews(){super._createViews(),this._setPaneViews([new c(this.model(),this)])}}},88444:(e,t,i)=>{"use strict";i.d(t,{
translateSessionDescription:()=>n,translateSessionShortDescription:()=>c,translateSessionExtendedDescription:()=>p});var r=i(20220);const s=new Map([["Premarket",(0,r.t)("Premarket",{context:"sessions"})],["Postmarket",(0,r.t)("Postmarket",{context:"sessions"})],["Regular Trading Hours",(0,r.t)("Regular Trading Hours",{context:"sessions"})],["Extended Trading Hours",(0,r.t)("Extended Trading Hours",{context:"sessions"})],["Electronic Trading Hours",(0,r.t)("Electronic Trading Hours",{context:"sessions"})]]);function n(e){var t;return null!==(t=s.get(e))&&void 0!==t?t:e}const o=[["Premarket",(0,r.t)("pre",{context:"sessions"})],["Postmarket",(0,r.t)("post",{context:"sessions"})]],a=new Map([...o,["Regular Trading Hours",(0,r.t)("reg",{context:"sessions"})],["Extended Trading Hours",(0,r.t)("ext",{context:"sessions"})]]),l=new Map([...o,["Regular Trading Hours",(0,r.t)("RTH",{context:"sessions"})],["Extended Trading Hours",(0,r.t)("ETH",{context:"sessions"})],["Electronic Trading Hours",(0,r.t)("ETH",{context:"sessions"})]]);function c(e,t){var i;return null!==(i=("futures"===t?l:a).get(e))&&void 0!==i?i:e}const u=[["Premarket",(0,r.t)("Premarket session")],["Postmarket",(0,r.t)("Postmarket session")]],d=new Map([...u,["Regular Trading Hours",(0,r.t)("Regular session")],["Extended Trading Hours",(0,r.t)("Extended session")]]),h=new Map([...u,["Regular Trading Hours",(0,r.t)("Regular Trading Hours session")],["Extended Trading Hours",(0,r.t)("Extended Trading Hours session")],["Electronic Trading Hours",(0,r.t)("Electronic Trading Hours session")]]);function p(e,t){var i;return null!==(i=("futures"===t?h:d).get(e))&&void 0!==i?i:e}},5489:(e,t,i)=>{"use strict";i.d(t,{areEqualSymbols:()=>n,symbolSameAsCurrent:()=>a});var r=i(22842);const s=r.enabled("uppercase_instrument_names");function n(e,t){return void 0===e?void 0===t:void 0!==t&&(s?e.toUpperCase()===t.toUpperCase():e===t)}function o(e,t){return e.some(e=>n(t,e))}function a(e,t,i){if(n(t,e))return!0;if(i){if(n(i.full_name,e)||n(i.pro_name,e))return!0;if(n(i.ticker,e))return!0;if(i.aliases&&o(i.aliases,e))return!0;if(i.alternatives&&o(i.alternatives,e))return!0;if(0===e.indexOf("FRA:")&&n(i.pro_name,e.replace("FRA:","FWB:")))return!0}return!1}},56598:(e,t,i)=>{"use strict";i.r(t),i.d(t,{types:()=>r});const r={ECONOMIC:"economic",QUANDL:"quandl"}},54567:(e,t,i)=>{"use strict";i.d(t,{TextWidthCache:()=>r});class r{constructor(e=150){this._actualSize=0,this._usageTick=1,this._oldestTick=1,this._tick2Labels=new Map,this._cache=new Map,this._maxSize=e}reset(){this._actualSize=0,this._cache.clear(),this._usageTick=1,this._oldestTick=1,this._tick2Labels.clear()}measureText(e,t){return this._getMetrics(e,t).width}yMidCorrection(e,t){const i=this._getMetrics(e,t);return((i.actualBoundingBoxAscent||0)-(i.actualBoundingBoxDescent||0))/2}_getMetrics(e,t){const i=this._cache.get(t);if(void 0!==i)return i.metrics;if(this._actualSize===this._maxSize){const e=this._tick2Labels.get(this._oldestTick);this._tick2Labels.delete(this._oldestTick),this._cache.delete(e),this._oldestTick++,
this._actualSize--}e.save(),e.textBaseline="middle";const r=e.measureText(t);return e.restore(),0===r.width&&t.length||(this._cache.set(t,{metrics:r,tick:this._usageTick}),this._tick2Labels.set(this._usageTick,t),this._actualSize++,this._usageTick++),r}}},28901:(e,t,i)=>{"use strict";var r=i(96276);function s(){this._marksByIndex=new Map,this._marksBySpan=[],this.changed=new r,this.minIndex=void 0,this.maxIndex=void 0}s.prototype.reset=function(){this._resetImpl(),this.changed.fire()},s.prototype._resetImpl=function(){this._marksByIndex=new Map,this._marksBySpan=[],this.minIndex=void 0,this.maxIndex=void 0,this._cache=void 0},s.prototype.merge=function(e){if(0!==e.length){var t=e[0].index,i=e[e.length-1].index;t<=this.minIndex&&i>=this.maxIndex&&this._resetImpl();for(var r=this._marksBySpan,s=new Set,n=0;n<e.length;n++){var o=(c=e[n]).index,a=c.span,l=this._marksByIndex.get(c.index);if(l){if(l.index===c.index&&l.span===c.span){l.time=c.time;continue}this._removeTickmark(l)}}for(n=0;n<e.length;n++){var c;o=(c=e[n]).index,a=c.span;if(!this._marksByIndex.has(c.index)){this._marksByIndex.set(o,c);var u=r[a];void 0===u&&(u=[],r[a]=u);var d=0===u.length||u[u.length-1].index<c.index;r[a].push(c),d||s.add(a)}}this.minIndex=void 0===this.minIndex?t:Math.min(this.minIndex,t),this.maxIndex=void 0===this.maxIndex?i:Math.max(this.maxIndex,i);for(a=r.length;a--;)r[a]&&(r[a].length||delete r[a],s.has(a)&&r[a].sort(this._sortByIndexAsc));this._cache=void 0,this.changed.fire()}},s.prototype._removeTickmark=function(e){var t=e.index;if(this._marksByIndex.get(t)===e){this._marksByIndex.delete(t),t<=this.minIndex&&this.minIndex++,t>=this.maxIndex&&this.maxIndex--,this.maxIndex<this.minIndex&&(this.minIndex=void 0,this.maxIndex=void 0);var i=this._marksBySpan[e.span],r=i.indexOf(e);-1!==r&&i.splice(r,1)}},s.prototype._sortByIndexAsc=function(e,t){return e.index-t.index},s.prototype.removeTail=function(e){var t=new Map;this.maxIndex=0,this._marksByIndex.forEach(function(i,r){i.time<e&&(t.set(r,i),this.maxIndex=Math.max(this.maxIndex,r))}.bind(this)),this._marksByIndex=t},s.prototype.addTail=function(e){for(var t=0;t<e.length;t++)e[t].index=this.maxIndex+t+1;this.merge(e)},s.prototype.indexToTime=function(e){var t=this._marksByIndex.get(e);return t?new Date(1e3*t.time):null},s.prototype.density=function(){var e=this.maxIndex-this.minIndex;if(0!==e)return 1e3*(this._marksByIndex.get(this.maxIndex).time-this._marksByIndex.get(this.minIndex).time)/e},s.prototype.estimateLeft=function(e){var t=this.density();if(t)return(1e3*this._marksByIndex.get(this.minIndex).time-e)/t},s.prototype.nearestIndex=function(e){for(var t=this.minIndex,i=this.maxIndex;i-t>2;){if(1e3*this._marksByIndex.get(t).time===e)return t;if(1e3*this._marksByIndex.get(i).time===e)return i;var r=Math.round((t+i)/2);1e3*this._marksByIndex.get(r).time>e?i=r:t=r}return t},s.prototype.build=function(e,t){var i=Math.ceil(t/e);if(this._maxbar===i&&this._cache)return this._cache;this._maxbar=i;for(var r=[],s=this._marksBySpan.length;s--;)if(this._marksBySpan[s]){var n=r;r=[]
;for(var o=n.length,a=0,l=this._marksBySpan[s],c=l.length,u=1/0,d=-1/0,h=0;h<c;h++){for(var p=l[h],_=p.index;a<o;){var m=n[a],f=m.index;if(!(f<_)){u=f;break}a++,r.push(m),d=f,u=1/0}u-_>=i&&_-d>=i&&(r.push(p),d=_)}for(;a<o;a++)r.push(n[a])}return this._cache=r,this._cache},s.prototype.state=function(){for(var e=[],t=this._marksBySpan.length;t--;)this._marksBySpan[t]&&(e=e.concat(this._marksBySpan[t]));return{marks:e=e.map((function(e){return[e.span,e.time,e.index]})),version:2}},s.prototype.restoreState=function(e){if(this._marksByIndex=new Map,this._marksBySpan=[],this.maxIndex=void 0,this.minIndex=void 0,e&&e.marks&&e.marks.length)if(2===e.version){var t=e.marks.map((function(e){return{span:e[0],time:e[1],index:e[2]}}));this.merge(t)}else this.merge(e.marks)},e.exports.Tickmarks=s},81265:(e,t,i)=>{"use strict";i.d(t,{TimeAxisView:()=>o});var r=i(50946),s=i(14900);class n{constructor(){this._data=null}setData(e){this._data=e}draw(e,t,i){if(null===this._data||!this._data.visible||0===this._data.text.length)return;const r=this._data;e.font=t.font;const n=Math.round(t.widthCache.measureText(e,r.text));if(n<=0)return;e.save();const o=t.paddingHorizontal,a=n+2*o,l=a/2;let c=r.coordinate,u=Math.floor(c-l)+.5;if(r.alwaysInViewPort){const e=r.width;u<0?(c+=Math.abs(0-u),u=Math.floor(c-l)+.5):u+a>e&&(c-=Math.abs(e-(u+a)),u=Math.floor(c-l)+.5)}const d=u+a,h=Math.ceil(0+t.borderSize+t.offsetSize+t.paddingTop+t.fontSize+t.paddingBottom);e.fillStyle=r.background;const p=Math.round(u*i),_=Math.round(0*i),m=Math.round(d*i),f=Math.round(h*i),g=Math.round(2*i);e.beginPath(),e.moveTo(p,_),e.lineTo(p,f-g),e.arcTo(p,f,p+g,f,g),e.lineTo(m-g,f),e.arcTo(m,f,m,f-g,g),e.lineTo(m,_),e.fill();const v=0+t.borderSize+t.offsetSize+t.paddingTop+t.fontSize/2;e.textAlign="left",e.textBaseline="middle",e.fillStyle=r.color;const S=t.widthCache.yMidCorrection(e,"Apr0");e.translate((u+o)*i,(v+S)*i),(0,s.drawScaled)(e,i,()=>e.fillText(r.text,0,0)),e.restore()}}class o{constructor(e){this._renderer=new n,this._rendererData={background:"",color:"",coordinate:0,text:"",visible:!1,width:0,alwaysInViewPort:!0},this._invalidated=!0,this._model=e,this._renderer.setData(this._rendererData)}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer}coordinate(){return this._rendererData.coordinate}_getAlwaysInViewPort(){return!0}_updateImpl(){const e=this._rendererData;if(e.visible=!1,this._model.timeScale().isEmpty())return;const t=this._getIndex();if(null===t)return;e.visible=!0,e.width=this._model.timeScale().width(),e.background=this._getBgColor(),e.color=(0,r.colorFromBackground)(e.background),e.coordinate=this._model.timeScale().indexToCoordinate(t),e.alwaysInViewPort=this._getAlwaysInViewPort();const i=this._model.timeScale().indexToUserTime(t);e.text=null!==i?this._model.dateTimeFormatter().format(i):"",this._invalidated=!1}}},41657:(e,t,i)=>{"use strict";i.d(t,{INVALID_TIME_POINT_INDEX:()=>r});const r=-2e6},2779:(e,t,i)=>{"use strict";i.d(t,{SyncModel:()=>a});var r=i(43175),s=i(96566)
;function n(e,t,i,r,n){let o=0,a=t;e.moveTo(a);let l=0,c=Number.MAX_VALUE,u=!1,d=t;const h=[];for(;!r(o,a);){if(l>15)throw new Error("Internal error 0x10 while extrapolating.");const r=e.indexOfBar(a);if(r===s.SessionStage.PRE_SESSION&&1===i)a=e.startOfBar(0),e.moveTo(a);else if(r===s.SessionStage.PRE_SESSION&&-1===i)a=e.startOfBar(s.SessionStage.PRE_SESSION),e.moveTo(a);else if(r===s.SessionStage.POST_SESSION&&1===i)a=e.startOfBar(s.SessionStage.POST_SESSION),e.moveTo(a);else{if(r===s.SessionStage.POST_SESSION&&-1===i)throw new Error("Internal error 0x12 while extrapolating.");{const p=e.startOfBar(r);if(p>t&&i>0||t>p&&i<0){if(u&&c===p)throw new Error("Internal error 0x11 while extrapolating.");u=!0,c=p,l=0,o++,d=p,n&&h.push(d)}if(0===r&&-1===i)a=p-1;else{a=e.startOfBar(r+i);const t=e.startOfBar(s.SessionStage.POST_SESSION);a>t&&(e.moveTo(t),a=e.startOfBar(0))}}}l++}return{time:d,times:h,count:o}}let o=0;class a{constructor(e,t){this._extrapolatedData=[],this._cacheForFuture=!1,this._modelId=o++,this._builderCache=null,this._resolution=t,this._symbolInfo=e,this._valid=Boolean(e.timezone)&&Boolean(e.session),this._session=new r.SessionInfo(e.timezone,e.session,e.session_holidays,e.corrections)}getSymbolInfo(){return this._symbolInfo}getSession(){return this._session}getResolution(){return this._resolution}uniqueId(){return this._modelId}distance(e,t){if(!this.isValid())return{success:!1};if(e>t)return{success:!1};if(e===t)return{success:!0,result:0};let i=this._extrapolatedData.length,r=0!==i?this._extrapolatedData[0]:null,s=null!==r?this._extrapolatedData[i-1]:null;const o=e<t;if(1e3*e===r&&this._cacheForFuture===o||(this._extrapolatedData=[1e3*e],i=1,r=null,s=null),null===r||null!==s&&1e3*t>s){const r=function e(t,i,r,s,o=!1){if(i>r){const n=e(t,r,i,s,o);return n.count=-n.count,n}return n(t,i,1,(e,t)=>t>r||0!==s&&e>s,o)}(this._barBuilder(),s||1e3*e,1e3*t,2e3,!0);this._extrapolatedData=this._extrapolatedData.concat(r.times),i=this._extrapolatedData.length,this._cacheForFuture=o}if(s=this._extrapolatedData[i-1],s<1e3*t)return{success:!1};const a=this._extrapolatedData.indexOf(1e3*t);return-1===a?{success:!1}:{success:!0,result:a}}projectTime(e,t){if(!this.isValid())return e;let i=this._extrapolatedData.length,r=i>0?this._extrapolatedData[0]:null,s=null!==r?this._extrapolatedData[i-1]:null;const o=t>=0;1e3*e===r&&this._cacheForFuture===o||(this._extrapolatedData=[1e3*e],i=1,r=null,s=null);const a=Math.abs(t);if(null===r||a>=i){const r=function(e,t,i,r=!1){const s=i<0?-1:1;return n(e,t,s,(e,t)=>e>=i*s,r)}(this._barBuilder(),s||1e3*e,Math.sign(t)*(a-i+1),!0);this._extrapolatedData=this._extrapolatedData.concat(r.times),i=this._extrapolatedData.length,this._cacheForFuture=o}return i<a?e:this._extrapolatedData[a]/1e3}isValid(){return this._valid}dataSize(){return this._extrapolatedData.length}createNewModelWithResolution(e){return new a(this._symbolInfo,e)}_barBuilder(){return null===this._builderCache&&(this._builderCache=(0,r.newBarBuilder)(this._resolution,this._session,this._session)),this._builderCache}}},
55760:(e,t,i)=>{"use strict";i.d(t,{TimeSynchronizer:()=>l});var r=i(2459),s=i(4033),n=i.n(s),o=i(43175);let a=null;class l{constructor(e,t){var i,s;this._sourceTargetBarBuilder=null,this._cache=new Map,this._source=e,this._target=t,this._isResolutionTheSame=r.Interval.isEqual(e.getResolution(),t.getResolution()),this._isSessionTheSame=(i=e.getSymbolInfo(),s=t.getSymbolInfo(),i.timezone===s.timezone&&i.session===s.session),this._shouldCorrectTradingDay=r.Interval.isDWM(e.getResolution())&&!this._isSessionTheSame}sourceTimeToTargetTime(e){if(this._isSessionTheSame&&this._isResolutionTheSame)return e;if(!this._source.isValid()||!this._target.isValid())return e;let t=this._cache.get(e);if(void 0===t){let i=1e3*e;if(this._shouldCorrectTradingDay){let e=n().utc_to_cal(this._source.getSession().timezone,i);e=this._source.getSession().spec.correctTradingDay(e);const t=new Date(e);n().set_hms(t,0,0,0,0,this._source.getSession().timezone),i=t.valueOf()}const r=this._sourceTargetBuilder();r.moveTo(i);const s=r.indexOfBar(i);t=r.startOfBar(Math.max(0,s))/1e3,this._cache.set(e,t)}return t}_sourceTargetBuilder(){if(null===this._sourceTargetBarBuilder){const e=this._isSessionTheSame?this._target.getSession():(null===a&&(a=new o.SessionInfo("Etc/UTC","24x7")),a);this._sourceTargetBarBuilder=(0,o.newBarBuilder)(this._target.getResolution(),this._target.getSession(),e)}return this._sourceTargetBarBuilder}}},84434:(e,t,i)=>{"use strict";i.r(t),i.d(t,{MINUTE_SPAN:()=>r,HOUR_SPAN:()=>s,DAY_SPAN:()=>n,WEEK_SPAN:()=>o,MONTH_SPAN:()=>a,YEAR_SPAN:()=>l,DEFAULT_BAR_SPACING:()=>c});const r=20,s=30,n=40,o=50,a=60,l=70,c=6},8218:(e,t,i)=>{"use strict";i.d(t,{trackDrawingCreated:()=>a,trackDrawingPasted:()=>l,trackDrawingCloned:()=>c,trackChartStyleChanged:()=>u});var r=i(71073),s=i(16282),n=i(97786);function o(e,t){(0,r.getTracker)().then(i=>{if(null!==i){const r=(0,s.ensureNotNull)(e.model().mainSeries().symbolInfo()),n=r.pro_name||r.name;i.trackDrawingsAnalytics(n,e.name(),t)}})}function a(e){o(e,"create")}function l(e){o(e,"paste")}function c(e){o(e,"clone")}function u(e){(0,r.getTracker)().then(t=>{if(null!==t){const i=n.STYLE_SHORT_NAMES[e];t.trackChartStyle(i)}})}},57976:(e,t,i)=>{"use strict";i.d(t,{translatedIntervalString:()=>s});i(20220);var r=i(19453);function s(e){const t=(0,r.getTranslatedResolutionModel)(e,!0);return null===t?e:t.multiplier+(t.mayOmitShortKind?"":t.shortKind)}},5617:(e,t,i)=>{"use strict";i.d(t,{ApplyLineToolTemplateUndoCommand:()=>s});var r=i(36270);class s extends r.UndoCommand{constructor(e,t,i){super(i),this._source=e,this._newState=t,this._oldState=e.properties().state()}redo(){this._source.applyTemplate(this._newState)}undo(){this._source.applyTemplate(this._oldState)}}},27247:(e,t,i)=>{"use strict";i.d(t,{ChangeToolBarsThemeUndoCommand:()=>o});var r=i(34698),s=i(87479),n=i(36270);class o extends n.UndoCommand{constructor(e,t,i=!0){super("Apply Toolbars Theme"),this._prevThemeName=e,this._themeName=t,this._syncState=i}undo(){(0,r.isStdThemeName)(this._prevThemeName)&&((0,s.setTheme)(this._prevThemeName),
this._syncState&&(0,r.syncTheme)())}redo(){(0,r.isStdThemeName)(this._themeName.toLowerCase())&&((0,s.setTheme)(this._themeName.toLowerCase()),this._syncState&&(0,r.syncTheme)())}}},50543:(e,t,i)=>{"use strict";i.d(t,{ChartLoadThemeUndoCommand:()=>h});var r=i(21318),s=i(1771),n=i(68981),o=i(36270);function a(e){const{visible:t,...i}=e;return i}function l(e){const{visible:t,...i}=e;return i}function c(e){const{visible:t,style:i,symbol:r,interval:s,sessionId:n,highLowAvgPrice:o,showCountdown:c,bidAsk:u,prePostMarket:d,priceAxisProperties:h,...p}=e;return{bidAsk:a(u),prePostMarket:l(d),...p}}function u(e){const{scaleSeriesOnly:t,showSeriesLastValue:i,showStudyLastValue:r,showSymbolLabels:s,showBidAskLabels:n,showPrePostMarketPriceLabel:o,showStudyPlotLabels:a,showFundamentalNameLabel:l,showFundamentalLastValue:c,seriesLastValueMode:u,...d}=e;return d}function d(e){const{topMargin:t,bottomMargin:i,...r}=e;return r}class h extends o.UndoCommand{constructor(e,t,i){var s,o,a;super("Apply Chart Theme"),this._model=e,this._newSessionProps=t.sessions||(0,n.factoryDefaults)("sessions"),["candleStyle","hollowCandleStyle","haStyle"].forEach(e=>{t.mainSourceProperties[e].wickUpColor=t.mainSourceProperties[e].wickUpColor||t.mainSourceProperties[e].wickColor,t.mainSourceProperties[e].wickDownColor=t.mainSourceProperties[e].wickDownColor||t.mainSourceProperties[e].wickColor}),t.chartProperties=null!==(s=t.chartProperties)&&void 0!==s?s:{paneProperties:void 0,scalesProperties:void 0},t.chartProperties.paneProperties.vertGridProperties=null!==(o=t.chartProperties.paneProperties.vertGridProperties)&&void 0!==o?o:t.chartProperties.paneProperties.gridProperties,t.chartProperties.paneProperties.horzGridProperties=null!==(a=t.chartProperties.paneProperties.horzGridProperties)&&void 0!==a?a:t.chartProperties.paneProperties.gridProperties,t.chartProperties.paneProperties.legendProperties=this._model.properties().state().paneProperties.legendProperties;const l=(0,n.factoryDefaults)("chartproperties"),h=(0,r.deepExtend)({},l,t.chartProperties);this._newChartProps={paneProperties:d(h.paneProperties),scalesProperties:u(h.scalesProperties)},e.timeScale().preserveBarSpacing()&&delete this._newChartProps.scalesProperties.barSpacing;const p=(0,n.factoryDefaults)("chartproperties.mainSeriesProperties"),_=(0,r.deepExtend)({},p,t.mainSourceProperties);this._newSeriesProps=i?_:c(_);const m=e.properties().state();this._oldChartProps={paneProperties:d(m.paneProperties),scalesProperties:u(m.scalesProperties)};const f=e.mainSeries().properties().state();this._oldSeriesProps=i?f:c(f),this._oldSessionProps=this._model.sessions().properties().state()}undo(){this._merge(this._oldChartProps,this._oldSeriesProps,this._oldSessionProps),this._model.mainSeries().onChartStyleChanged(),this._model.updateScales(),this._model.chartThemeLoaded()}redo(){this._merge(this._newChartProps,this._newSeriesProps,this._newSessionProps),this._model.mainSeries().onChartStyleChanged(),this._model.updateScales(),this._model.chartThemeLoaded()}_merge(e,t,i){var r,n,o,a
;const l=this._model;(0,s.saveDefaultProperties)(!0),e&&(l.properties().paneProperties.mergeAndFire(e.paneProperties),l.properties().scalesProperties.mergeAndFire(e.scalesProperties)),"priceAxisProperties"in t&&l.mainSeries().priceScale().setMode({autoScale:null===(r=t.priceAxisProperties)||void 0===r?void 0:r.autoScale,percentage:null===(n=t.priceAxisProperties)||void 0===n?void 0:n.percentage,log:null===(o=t.priceAxisProperties)||void 0===o?void 0:o.log,lockScale:null===(a=t.priceAxisProperties)||void 0===a?void 0:a.lockScale}),l.mainSeries().properties().mergeAndFire(t),l.mainSeries().properties().saveDefaults(),l.mainSeries().createPaneView(),l.mainSeries().invalidateBarStylesCache(),l.recalculateAllPanes(),l.fullUpdate(),l.properties().saveDefaults(),l.sessions().restoreState({properties:i},!1),(0,s.saveDefaultProperties)(!1)}}},31654:(e,t,i)=>{"use strict";i.d(t,{ExcludeLineToolsFromGroupUndoCommand:()=>o});var r=i(16282),s=(i(20220),i(68421),i(36270));const n=window.t("Exclude line tools from group {group}");class o extends s.UndoCommand{constructor(e,t,i){super(n.format({group:t.name()})),this._model=e,this._groupId=t.id,this._groupName=t.name(),this._lineToolsIds=i.map(e=>e.id())}redo(){const e=(0,r.ensureNotNull)(this._model.lineToolsGroupModel().groupForId(this._groupId)),t=this._lineToolsIds.map(e=>this._model.dataSourceForId(e));e.excludeLineTools(t),0===e.lineTools().length&&this._model.lineToolsGroupModel().removeGroup(e)}undo(){const e=this._lineToolsIds.map(e=>this._model.dataSourceForId(e)),t=this._model.lineToolsGroupModel().groupForId(this._groupId);null!==t?t.addLineTools(e):this._model.lineToolsGroupModel().createGroup(e,this._groupName,this._groupId)}}},44913:(e,t,i)=>{"use strict";i.d(t,{PriceScaleChangeUndoCommand:()=>a});var r=i(16282),s=i(87380),n=i(36270);const o=(0,s.getLogger)("Chart.ChartUndoModel");class a extends n.UndoCommand{constructor(e,t,i,r,s){super("Scale price",!1),this._newPriceScaleState=null,this._model=e,this._paneIndex=e.panes().indexOf(t),this._priceScaleId=i.id(),this._state=r,this._timestamp=s?performance.now():null}undo(){if(null!==this._newPriceScaleState)return void o.logDebug("PriceScaleChangeUndoCommand.undo: Command is already undone");const[e,t]=this._paneAndScale();this._newPriceScaleState=t.state(),this._model.restorePriceScaleState(e,t,this._state)}redo(){if(null===this._newPriceScaleState)return void o.logDebug("PriceScaleChangeUndoCommand.redo: Command is not undone");const[e,t]=this._paneAndScale();this._model.restorePriceScaleState(e,t,this._newPriceScaleState),this._newPriceScaleState=null}canMerge(e){return e instanceof a&&null!==this._timestamp&&null!==e._timestamp&&null===this._newPriceScaleState&&e._model===this._model&&e._paneIndex===this._paneIndex&&e._priceScaleId===this._priceScaleId&&Math.abs(e._timestamp-this._timestamp)<1e3}merge(e){this._timestamp=e._timestamp}_paneAndScale(){const e=this._model.panes()[this._paneIndex],t=(0,r.ensureNotNull)(e.getPriceScaleById(this._priceScaleId));return[e,t]}}},77903:(e,t,i)=>{"use strict";i.d(t,{
RemoveSourcesCommand:()=>h});var r=i(16282),s=i(2001),n=i(36270),o=i(87048),a=i(87380),l=i(77371),c=i(55304),u=i(31654);const d=(0,a.getLogger)("Chart.RemoveSourcesCommand");class h extends n.UndoCommand{constructor(e,t,i){super(i),this._excludeLineToolsUndoCommands=[],this._initialPriceScaleMode=null,this._chartModel=e,this._sourceIds=(0,l.closeSourcesSet)(e,t).map(e=>e.id()),this._sourceStates=[],this._paneIndexes=[],this._priceScalePositionIds=[],this._paneStates=[],this._restorePanes=[];const s=t[0];1===t.length&&(0,c.isStudy)(s)&&(this._initialPriceScaleMode=(0,r.ensureNotNull)(s.priceScale()).mode())}removedIds(){return this._sourceIds}redo(){const e=this._chartModel.panes().length,t=this._sourceIds.map(e=>(0,r.ensureNotNull)(this._chartModel.dataSourceForId(e)));this._sourceStates=t.map(e=>(0,r.ensureNotNull)(e.state(!1)));const i=t.map(e=>(0,r.ensureNotNull)(this._chartModel.paneForSource(e)));this._paneIndexes=i.map(e=>this._chartModel.panes().indexOf(e));const n=this._chartModel.lineToolsGroupModel(),a=new Map;t.forEach(e=>{if((0,o.isLineTool)(e)){e.deleteAlert();const t=n.groupForLineTool(e);if(null!==t){const i=a.get(t)||[];i.push(e),a.set(t,i)}}}),a.forEach((e,t)=>{const i=new u.ExcludeLineToolsFromGroupUndoCommand(this._chartModel,t,e);i.redo(),this._excludeLineToolsUndoCommands.push(i)}),this._priceScalePositionIds=t.map((e,t)=>{if((0,o.isLineTool)(e))return null;const r=e.priceScale();if(null===r)return null;const s=i[t].priceScalePosition(r);return{id:r.id(),position:s,priceScaleIndex:i[t].priceScaleIndex(r,s)}});const l=new Set;t.forEach((e,t)=>{(0,o.isLineTool)(e)||l.add(this._paneIndexes[t])}),this._paneStates=t.map((e,t)=>{const r=this._paneIndexes[t];return l.has(r)?i[t].state(!1,!0):null}),this._restorePanes=t.map(e=>this._chartModel.removeSource(e)),t.forEach(e=>{(0,c.isStudy)(e)&&(0,s.trackStudies)(e,"remove")}),e!==this._chartModel.panes().length&&this._chartModel.setShouldBeSavedEvenIfHidden(!0)}undo(){const e=[];for(let t=this._sourceStates.length-1;t>=0;t--){const i=this._chartModel.restoreSource(this._restorePanes[t],this._paneIndexes[t],this._paneStates[t],this._sourceStates[t],this._priceScalePositionIds[t]);i&&e.push(i)}e.some((t,i)=>t.id()!==this._sourceIds[e.length-i-1])&&d.logError("Source was restored improperly - source ids does not match"),null!==this._initialPriceScaleMode&&(0,r.ensureNotNull)(e[0].priceScale()).setMode(this._initialPriceScaleMode),this._excludeLineToolsUndoCommands.forEach(e=>e.undo())}}},82386:(e,t,i)=>{"use strict";i.d(t,{RestoreDefaultsPreferencesUndoCommand:()=>u});var r=i(16282),s=i(36270),n=i(44079),o=i(59503),a=i(60744),l=i(42258),c=i(23939);class u extends s.UndoCommand{constructor(e){super("Apply All Chart Properties"),this._trading=null,this._oldShowSellBuyButtons=null,this._oldNoConfirmEnabled=null,this._oldShowOnlyRejectionNotifications=null,this._oldShowPricesWithZeroVolume=null,this._oldShowPricesWithSpread=null,this._oldOrderExecutedSoundEnabled=null,this._prevWatermarkPreferences=null,this._model=e,this._trading=(0,l.tradingService)(),
null!==this._trading&&(this._oldShowSellBuyButtons=this._trading.showSellBuyButtons.value(),this._oldNoConfirmEnabled=this._trading.noConfirmEnabled.value(),this._oldShowOnlyRejectionNotifications=this._trading.showOnlyRejectionNotifications.value(),this._oldShowPricesWithZeroVolume=this._trading.showPricesWith().zeroVolume.value(),this._oldShowPricesWithSpread=this._trading.showPricesWith().spread.value(),this._oldOrderExecutedSoundEnabled=this._trading.orderExecutedSoundParams.enabled.value()),this._defaultsPreferences=(0,n.defaultsPreferencesByWhiteList)(this._model,this._model.mainSeries()),this._oldPreferences=e.preferences(),this._prevDateFormat=o.dateFormatProperty.value(),this._prevAddPlusButton=c.addPlusButtonProperty.value(),this._prevShowOpenMarkerStatus=a.showMarketOpenStatusProperty.value();const t=this._model.watermarkSource();null!==t&&(this._prevWatermarkPreferences=t.properties().state())}redo(){null!==this._trading&&(this._trading.showSellBuyButtons.setValue(!0),this._trading.noConfirmEnabled.setValue(!1),this._trading.showOnlyRejectionNotifications.setValue(!1),this._trading.showPricesWith().zeroVolume.setValue(!0),this._trading.showPricesWith().spread.setValue(!0),this._trading.orderExecutedSoundParams.enabled.setValue(!1)),this._model.applyPreferences(this._defaultsPreferences),this._model.mainSeries().onChartStyleChanged(),this._model.updateScales(),(0,o.restoreDateFormatSettingsValue)(),(0,c.restoreAddPlusButtonSettingsValue)(),(0,a.restoreShowMarketOpenStatusProperty)();const e=this._model.watermarkSource();null!==e&&e.restorePropertiesDefaults()}undo(){null!==this._trading&&(this._trading.showSellBuyButtons.setValue((0,r.ensureNotNull)(this._oldShowSellBuyButtons)),this._trading.noConfirmEnabled.setValue((0,r.ensureNotNull)(this._oldNoConfirmEnabled)),this._trading.showOnlyRejectionNotifications.setValue((0,r.ensureNotNull)(this._oldShowOnlyRejectionNotifications)),this._trading.showPricesWith().zeroVolume.setValue((0,r.ensureNotNull)(this._oldShowPricesWithZeroVolume)),this._trading.showPricesWith().spread.setValue((0,r.ensureNotNull)(this._oldShowPricesWithSpread)),this._trading.orderExecutedSoundParams.enabled.setValue((0,r.ensureNotNull)(this._oldOrderExecutedSoundEnabled))),this._model.applyPreferences(this._oldPreferences),this._model.mainSeries().onChartStyleChanged(),this._model.updateScales(),o.dateFormatProperty.setValue(this._prevDateFormat),a.showMarketOpenStatusProperty.setValue(this._prevShowOpenMarkerStatus),c.addPlusButtonProperty.setValue(this._prevAddPlusButton);const e=this._model.watermarkSource();null!==e&&null!==this._prevWatermarkPreferences&&e.properties().mergeAndFire(this._prevWatermarkPreferences)}}},66597:(e,t,i)=>{"use strict";i.d(t,{SetPriceScaleModeCommand:()=>n});var r=i(1771),s=i(36270);class n extends s.UndoCommand{constructor(e,t,i,r){super(i),this._newMode=e,this._priceScaleId=t.id(),this._model=r,this._oldMode=t.mode()}redo(){this._applyMode(this._newMode)}undo(){this._applyMode(this._oldMode)}_applyMode(e){const t=this._findPriceScaleById();null!==t&&((0,
r.saveDefaultProperties)(!0),t.setMode(e),(0,r.saveDefaultProperties)(!1),this._model&&(this._model.recalculateAllPanes(),this._model.lightUpdate()))}_findPriceScaleById(){const e=this._model.panes();for(let t=0;t<e.length;t++){const i=e[t].getPriceScaleById(this._priceScaleId);if(null!==i)return i}return null}}},14022:(e,t,i)=>{"use strict";i.d(t,{SetPriceScaleSelectionStrategyCommand:()=>a});var r=i(16282),s=i(36270),n=i(36436);class o{constructor(e){this._leftScales=e.leftPriceScales().map(e=>e.id()),this._rightScales=e.rightPriceScales().map(e=>e.id())}restorePane(e){this._leftScales.reverse().map(t=>(0,r.ensureNotNull)(e.getPriceScaleById(t))).forEach(t=>e.movePriceScale(t,"left")),this._rightScales.reverse().map(t=>(0,r.ensureNotNull)(e.getPriceScaleById(t))).forEach(t=>e.movePriceScale(t,"right"))}}class a extends s.UndoCommand{constructor(e,t,i){super(i),this._chartModel=e,this._targetStrategy=(0,n.createPriceScaleSelectionStrategy)(t),this._initialState=e.panes().map(e=>new o(e))}redo(){this._chartModel.panes().forEach(e=>e.setPriceScaleSelectionStrategy(this._targetStrategy)),this._chartModel.fullUpdate()}undo(){const e=this._chartModel.panes();for(let t=0;t<e.length;t++)this._initialState[t].restorePane(e[t]);this._chartModel.fullUpdate()}}},95277:(e,t,i)=>{"use strict";i.d(t,{SetResolutionUndoCommand:()=>o});var r=i(36270),s=i(2459),n=i(20554);class o extends r.UndoCommand{constructor(e,t,i,r){super(r),this._property=e,this._value=t,this._prevValue=e.value(),this._chartWidget=i}redo(){this._chartWidget.screen.show(),this._property.setValue(this._value),this._handleResolution(this._value)}undo(){this._chartWidget.screen.show(),this._property.setValue(this._prevValue),this._handleResolution(this._prevValue)}_handleResolution(e){const t=this._chartWidget.model().mainSeries().properties().childs(),i=t.style.value(),r=(0,n.isRangeStyle)(i),o=s.Interval.isRange(e);!r&&o?t.style.setValue(11):r&&!o&&t.style.setValue((0,n.getLastUsedStyle)())}}},1626:(e,t,i)=>{"use strict";i.d(t,{SetScaleRatioPropertiesCommand:()=>n});var r=i(36270),s=i(1771);class n extends r.UndoCommand{constructor(e,t,i,r){super(i),this._property=e,this._newValue=t,this._model=r,this._priceScale=this._model.mainSeries().priceScale(),this._oldValue=this._property.value(),this._oldMode=this._priceScale.mode()}redo(){this._oldValue=this._property.value(),this._oldMode=this._priceScale.mode(),(0,s.saveDefaultProperties)(!0),this._priceScale.setMode({autoScale:!1,percentage:!1,log:!1}),this._property.setValue(this._newValue),(0,s.saveDefaultProperties)(!1),this._model.recalculateAllPanes(),this._model.lightUpdate()}undo(){(0,s.saveDefaultProperties)(!0),this._property.setValue(this._oldValue),this._priceScale.setMode(this._oldMode),(0,s.saveDefaultProperties)(!1),this._model.recalculateAllPanes(),this._model.lightUpdate()}}},50225:(e,t,i)=>{"use strict";i.d(t,{SetChartLayoutCommand:()=>n});var r=i(36270),s=i(86913);class n extends r.UndoCommand{constructor(e,t){super("Change Chart Layout to "+s.layouts[t].title),this._chartWidgetCollection=e,
this._newLayoutType=t,this._oldLayoutType=e.layout.value()}redo(){this._chartWidgetCollection.setLayout(this._newLayoutType)}undo(){this._chartWidgetCollection.setLayout(this._oldLayoutType)}}},77371:(e,t,i)=>{"use strict";function r(e,t){const i=new Set,r=t=>{e.children(t,!1).forEach(e=>{i.has(e)||(i.add(e),r(e))})};return t.forEach(r),t.filter(e=>!i.has(e)).map(t=>function e(t,i){let r=[];const s=t.children(i,!1);for(let i=0;i<s.length;i++)r=r.concat(e(t,s[i]));return r.push(i),r}(e,t)).reduce((e,t)=>e.concat(t),[])}i.d(t,{closeSourcesSet:()=>r})},7456:(e,t,i)=>{"use strict";i.d(t,{SwapChartsUndoCommand:()=>s});var r=i(36270);class s extends r.UndoCommand{constructor(e,t,i){super("Swap Charts in the Layout"),this._swapper=e,this._from=t,this._to=i}redo(){this._swapper(this._from,this._to)}undo(){this._swapper(this._from,this._to)}}},77928:(e,t,i)=>{"use strict";i.d(t,{TimeScaleChangeUndoCommand:()=>o});var r=i(87380),s=i(36270);const n=(0,r.getLogger)("Chart.ChartUndoModel");class o extends s.UndoCommand{constructor(e,t,i){super(i,!1),this._newRightOffsetAndBarSpacing=null,this.setCustomFlag("doesnt_affect_save",!0),this._model=e,this._rightOffsetAndBarSpacing=t}undo(){if(null!==this._newRightOffsetAndBarSpacing)return void n.logDebug("TimeScaleChangeUndoCommand.undo: Command is already undone");const e=this._model.timeScale();this._newRightOffsetAndBarSpacing={barSpacing:e.barSpacing(),rightOffset:e.rightOffset()},e.setBarSpacing(this._rightOffsetAndBarSpacing.barSpacing),e.setRightOffset(this._rightOffsetAndBarSpacing.rightOffset),this._model.lightUpdate()}redo(){if(null===this._newRightOffsetAndBarSpacing)return void n.logDebug("TimeScaleChangeUndoCommand.redo: Command is not undone");const e=this._model.timeScale();e.setBarSpacing(this._newRightOffsetAndBarSpacing.barSpacing),e.setRightOffset(this._newRightOffsetAndBarSpacing.rightOffset),this._model.lightUpdate(),this._newRightOffsetAndBarSpacing=null}}},36270:(e,t,i)=>{"use strict";i.d(t,{UndoCommand:()=>r});class r{constructor(e,t=!0){this._customFlags={},this._text=e,this._executeOnPush=t}text(){return this._text}executeOnPush(){return this._executeOnPush}customFlag(e){return this._customFlags[e]}setCustomFlag(e,t){this._customFlags[e]=t}canMerge(e){return!1}merge(e){throw new Error("Should be re-implemented in child classes")}}},67413:(e,t,i)=>{"use strict";i.d(t,{createUndoHistory:()=>h});var r=i(16282),s=i(51506),n=i(82870),o=i(36270);class a extends o.UndoCommand{constructor(e,t,i){super(i),this._wv=e,this._newValue=t,this._oldValue=e.value()}redo(){this._wv.setValue(this._newValue)}undo(){this._wv.setValue(this._oldValue)}}var l=i(87380),c=i(96276),u=i.n(c);const d=(0,l.getLogger)("Common.UndoHistory");function h(){const e=[],t=new s.UndoStack,i=new s.UndoStack,o=new(u());function l(r){if(e.length>0)e[e.length-1].addCommand(r);else{i.clear();const e=t.head(),s=e&&e.text();e&&e.canMerge(r)?e.merge(r):t.push(r);const n=r.text();""!==n&&n!==s&&d.logNormal("DO: "+n)}r.executeOnPush()&&r.redo(),e.length||o.fire(c())}function c(){const e=t.head(),r=i.head()
;return{enableUndo:!t.isEmpty(),undoText:void 0===e?void 0:e.text(),enableRedo:!i.isEmpty(),redoText:void 0===r?void 0:r.text()}}return{beginUndoMacro:function(t){const i=new n.UndoMacroCommand(t);return e.push(i),i},clearStack:function(){t.clear(),i.clear(),o.fire(c())},createUndoCheckpoint:function(){return{lastActualCommand:t.isEmpty()?null:t.head()}},endUndoMacro:function(){const t=(0,r.ensureDefined)(e.pop());t.isEmpty()||l(t)},pushUndoCommand:l,redo:function(){if(i.isEmpty())return!1;const e=i.pop();return!!e&&(e.redo(),t.push(e),d.logNormal("REDO: "+e.text()),o.fire(c()),!0)},redoStack:function(){return i},setWatchedValue:function(e,t,i){if(e.value()!==t){const r=new a(e,t,i);l(r),r.redo()}},undo:function(){if(t.isEmpty())return!1;const e=t.pop();return!!e&&(e.undo(),i.push(e),d.logNormal("UNDO: "+e.text()),o.fire(c()),!0)},undoStack:function(){return t},undoToCheckpoint:function(e){for(;!t.isEmpty()&&e.lastActualCommand!==t.head();)t.pop().undo();i.clear(),o.fire(c())},state:c,onChange:function(){return o}}}},82870:(e,t,i)=>{"use strict";i.d(t,{UndoMacroCommand:()=>s});var r=i(36270);class s extends r.UndoCommand{constructor(e){super(e,!1),this._subcommands=[]}addCommand(e){this._subcommands.push(e)}isEmpty(){return 0===this._subcommands.length}redo(){for(let e=0;e<this._subcommands.length;e++)this._subcommands[e].redo()}undo(){for(let e=this._subcommands.length-1;e>=0;e--)this._subcommands[e].undo()}commands(){return this._subcommands}}},51506:(e,t,i)=>{"use strict";i.d(t,{UndoStack:()=>a});var r=i(36270),s=i(96276),n=i.n(s);const o=(0,i(87380).getLogger)("Common.UndoStack");class a{constructor(){this._commands=[],this._onChange=new(n())}onChange(){return this._onChange}isEmpty(){return 0===this._commands.length}clear(){this.isEmpty()||(this._commands.length=0,this._onChange.fire())}push(e){if(!(e instanceof r.UndoCommand))throw new TypeError("argument must be an instance of UndoCommand");this._commands.push(e),this._onChange.fire(e)}pop(){if(this.isEmpty())return void o.logDebug("pop: undo stack is empty");const e=this._commands.pop();return this._onChange.fire(e),e}head(){if(!this.isEmpty())return this._commands[this._commands.length-1]}}},64547:(e,t,i)=>{"use strict";i.d(t,{unitConvertibleGroups:()=>n,sourceNewUnitOnPinningToPriceScale:()=>o});var r=i(88987),s=i(20554);function n(e,t,i){const r=(0,s.symbolUnitConvertibleGroupsIfExist)(e);if(null!==r)return r;const n=i.unitGroupById(t);return null===n?[]:[n]}function o(e,t,i,s){let o=null;if(i.unitConversionEnabled()&&(0,r.isSymbolSource)(e)){const r=i.availableUnits(),a=t.unit(r),l=e.unit(),c=null===l?[]:n(e.symbolInfo(),l,r);null!==a&&null!==a.selectedUnit&&!a.allUnitsAreOriginal&&a.selectedUnit!==l&&(s&&null===l||null!==l&&r.convertible(l,c))&&(o=a.selectedUnit)}return o}},16559:(e,t,i)=>{"use strict";i.r(t),i.d(t,{watermarkProperty:()=>u,restoreWatermarkPropertyDefaults:()=>d});var r=i(14563),s=i(42098),n=i(27937),o=i.n(n);const a={visibility:!1,color:"rgba(80, 83, 94, 0.25)"};function l(){const e=s.getJSON("symbolWatermark")
;let t=Object.assign({},a,e);if(void 0===e){if(void 0!==s.getJSON("chartproperties")){const e=s.getJSON("chartproperties").symbolWatermarkProperties;if(void 0!==e){const i=(0,r.tryParseRgba)(e.color);t=Object.assign(t,e),null!==i&&(0!==i[3]?t.visibility=!0:(i[3]=.25,t.color=(0,r.rgbaToString)(i)))}}delete t.transparency}return t}let c=null;function u(){return null===c&&(c=new(o())(l()),s.onSync.subscribe(null,()=>{null!==c&&c.mergeAndFire(l())}),c.listeners().subscribe(null,()=>{null!==c&&s.setJSON("symbolWatermark",c.state())})),c}function d(){null!==c&&c.mergeAndFire(a)}},37594:(e,t,i)=>{"use strict";var r=i(57976).translatedIntervalString,s=i(5956).getTranslatedSymbolDescription,n=i(39304).CHART_FONT_FAMILY,o=i(16559),a=o.watermarkProperty,l=o.restoreWatermarkPropertyDefaults,c=i(14900).drawScaled;t.Watermark=function(e,t){var i={},o=a();function u(e,t){var r=e.font;return i.hasOwnProperty(r)||(i[r]={}),i[r].hasOwnProperty(t)||(i[r][t]=e.measureText(t).width),i[r][t]}o.listeners().subscribe(this,(function(){e.updateSource(this)})),this.destroy=function(){o.listeners().unsubscribeAll(this)},this.properties=function(){return o},this.restorePropertiesDefaults=function(){l()};var d={renderer:function(e,i){return{draw:function(a,l){c(a,l.pixelRatio,(function(){var l=t.symbolInfo();a.fillStyle=o.color.value();var c,d=l.name;/QUANDL/.test(l.exchange)&&((c=d.split(/\//)).length&&(d=c[c.length-1]));for(var h={description:l.description,short_description:l.short_description,pro_name:l.pro_name,short_name:l.name,local_description:l.local_description,language:l.language},p=[{text:d?d+", "+r(t.interval()):"",font:"96px "+n,lineHeight:117,vertOffset:0},{text:s(h)||"",font:"48px "+n,lineHeight:58,vertOffset:5}],_=0,m=0;m<p.length;m++){if((v=p[m]).text){a.font=v.font;var f=u(a,v.text);v.zoom=f>i?i/f:1,_+=v.lineHeight*v.zoom}}var g=Math.max((e-_)/2,0);for(m=0;m<p.length;m++){var v;(v=p[m]).text&&(a.save(),a.translate(i/2,g),a.textBaseline="top",a.textAlign="center",a.font=v.font,a.scale(v.zoom,v.zoom),a.fillText(v.text,0,v.vertOffset),a.restore(),g+=v.lineHeight*v.zoom)}}))}}},update:function(){}};this.paneViews=function(){return t.symbolInfo()&&o.visibility.value()?[d]:[]}}},93006:(e,t,i)=>{"use strict";i.r(t),i.d(t,{reorderCollection:()=>S,reorderDataSourcesStateZOrder:()=>y,reorderDataSourcesZOrder:()=>b,newLineToolZOrder:()=>C,newLineToolStateZOrder:()=>T,newStudyZOrder:()=>x,isReorderRequired:()=>M,moveAtIndex:()=>A,moveAfterItem:()=>k,moveBeforeItem:()=>D,moveAfterSource:()=>R,moveBeforeSource:()=>N,moveAfterSourceState:()=>O,moveBeforeSourceState:()=>V});var r=i(87048),s=i(55304),n=i(47658),o=i(70734),a=i(5877),l=i(4543);function c(e){return(0,r.isLineTool)(e)&&!e.isSpeciallyZOrderedSource()}function u(e){return(0,s.isStudy)(e)&&!e.isSpeciallyZOrderedSource()}function d(e,t){return e.zorder-t.zorder}function h(e,t){return e.zorder()-t.zorder()}function p(e,t){(0,a.isMainSeriesState)(e)?e.zorder=0:e.zorder=t}function _(e,t){e.setZorder(t)}function m(e){return e.zorder}function f(e){return e.zorder()}function g(e,t,i,r,s,n,o){
let a=0;for(let l=t;l>=0;--l){const t=e[l];void 0!==o&&o(t)||(n(t)?(s(t,i),a=Math.max(a,I(i)),r=i-1,i-=1e4,0===r&&(i-=1e4)):(s(t,r),a=Math.max(a,L(r)),r-=1))}return a}function v(e,t,i,r,s,n,o){let a=0;for(let l=t;l<e.length;++l){const t=e[l];void 0!==o&&o(t)||(n(t)?(s(t,i),a=Math.max(a,I(i)),r=i+1,0===(i+=1e4)&&(r+=1e4)):(s(t,r),a=Math.max(a,L(r)),r+=1))}return a}function S(e,t,i,r,s,n){let o=null;const a=[];for(const s of e)t(s)?(a.push(s),o=s):(i(s)||r(s))&&a.push(s);a.sort(n),null!==o&&s(o,0);const l=null===o?-1:a.indexOf(o),c=g(a,l-1,-1e4,-1,s,i),u=v(a,l+1,1e4,1,s,i);return Math.max(c,u)<.7}function y(e){return S(e,a.isMainSeriesState,a.isStudyState,a.isLineToolState,p,d)}function b(e){return S(e,n.isSeries,u,c,_,h)}function w(e,t){const i=Math.floor(e/1e4);let r=t.get(i);return void 0===r&&(r=[],t.set(i,r)),r}function P(e,t,i,r,s,n){let o=-1/0,a=1/0,l=0;const c=new Map;for(let r=0;r<e.length;++r){const n=e[r],u=s(n);t(n)?(o=Math.max(o,u),w(u,c).push(n)):i(n)&&(u<0&&(a=Math.min(a,u)),l=Math.max(l,u))}if(n){return Math.max(l,o)+1}if(o===-1/0)return a===1/0?-100:a-100;if(o>0||o%1e4<-1)return o+1;if((o+1)%1e4==0)for(const e of w(o,c))r(e,s(e)-100);return o+1-100}function C(e,t){return P(e,c,u,_,f,t)}function T(e,t){return P(e,a.isLineToolState,a.isStudyState,p,m,t)}function x(e){let t=-1e4;for(const i of e)u(i)&&(t=Math.min(t,i.zorder()-1e4));return 0===t?-1e4:t}function I(e){return Math.abs(e/o.specialZOrderBase)}function L(e){return Math.abs(e%1e4/1e4)}function M(e,t){return null!==e&&I(e)>=.7||null!==t&&L(t)>.7}function E(e,t){const i=1e4*((r=e/1e4)>=0?Math.ceil(r):Math.floor(r));var r;return i===e?i+1e4*t:i}function A(e,t,i,r,s,n,a,c,u){if(r(t[0]))return void(i<e.length&&c(e[i])<0?v(e,i,1e4,1,a,s,r):g(e,Math.max(0,Math.min(i-1,e.length-1)),-1e4,-1,a,s,r));const{newItems:d,movedItemsStartIndex:h}=i>0?(0,l.moveAfter)(e,t,i-1):(0,l.moveBefore)(e,t,0),p=h,_=h+t.length-1,m=p>0?c(d[p-1]):c(d[p])-1,f=_<e.length-1?c(d[_+1]):c(d[_])+1;if(m>=0&&f>0)v(d,p,E(m,1),m+1,a,s,r);else if(f<=0&&m<0)g(d,_,E(f,-1),f-1,a,s,r);else{let e=-o.specialZOrderBase;for(const t of d)r(t)?e=1:(a(t,e),e+=1);S(d,r,s,n,a,u)}}function k(e,t,i,r,s,n,o,a,l){const c=e.indexOf(i)+1;A(e,t,c,r,s,n,o,a,l)}function D(e,t,i,r,s,n,o,a,l){const c=e.indexOf(i);A(e,t,c,r,s,n,o,a,l)}function R(e,t,i){k(e,t,i,n.isSeries,u,c,_,f,h)}function N(e,t,i){D(e,t,i,n.isSeries,u,c,_,f,h)}function O(e,t,i){k(e,t,i,a.isMainSeriesState,a.isStudyState,a.isLineToolState,p,m,d)}function V(e,t,i){D(e,t,i,a.isMainSeriesState,a.isStudyState,a.isLineToolState,p,m,d)}},84234:(e,t,i)=>{"use strict";e=i.nmd(e);var r=i(27937),s=i(87380).getLogger("Chart.Study.MetaInfo"),n=i(93962).applyOverridesToStudyDefaults,o=i(26265).PineKind,a={};function l(e){TradingView.merge(this,{palettes:{},inputs:[],plots:[],graphics:{},defaults:{}}),TradingView.merge(this,e);var t=e.fullId||e.id;TradingView.merge(this,l.parseIdString(t))}l.VERSION_STUDY_ARG_SOURCE=41,l.METAINFO_FORMAT_VERSION_SOS_V2=42,l.VERSION_PINE_PROTECT_TV_4164=43,l.CURRENT_METAINFO_FORMAT_VERSION=52,
l.VERSION_NEW_STUDY_PRECISION_FORMAT=46,l.CHILD_STUDY_ALLOWED_PLOT_TYPES=["line"],l.canPlotBeSourceOfChildStudy=function(e){return l.CHILD_STUDY_ALLOWED_PLOT_TYPES.includes(e)},l.CHILD_STUDY_EXCLUDE_IDS=["CorrelationCoefficient@tv-basicstudies","Correlation - Log@tv-basicstudies-1"],l.CHILD_STUDY_PARENT_EXCLUDE_IDS=[],l.FilledArea={},l.FilledArea.TYPE_PLOTS="plot_plot",l.FilledArea.TYPE_HLINES="hline_hline",l.versionOf=function(e){var t="_metainfoVersion"in e&&isNumber(e._metainfoVersion)?e._metainfoVersion:0;return t<0&&s.logError("Metainfo format version cannot be negative: "+t),t},l.parseIdString=function(e){var t={};if(-1===e.indexOf("@"))t.shortId=e,t.packageId="tv-basicstudies",t.id=e+"@"+t.packageId,t.version=1;else{var i=e.split("@");t.shortId=i[0];var r=i[1].split("-");if(3===r.length)t.packageId=r.slice(0,2).join("-"),t.id=t.shortId+"@"+t.packageId,t.version=r[2];else if(1===r.length&&"decisionbar"===r[0])t.packageId="les-"+r[0],t.id=t.shortId+"@"+t.packageId,t.version=1;else{if(1!==r.length)throw new Error("unexpected study id:"+e);t.packageId="tv-"+r[0],t.id=t.shortId+"@"+t.packageId,t.version=1}}if(t.fullId=t.id+"-"+t.version,"tv-scripting"===t.packageId){var s=t.shortId;if(0===s.indexOf("Script$")||0===s.indexOf("StrategyScript$")){var n=s.indexOf("_");t.productId=n>=0?s.substring(0,n):t.packageId}else t.productId=t.packageId}else t.productId=t.packageId;return t},l.getPackageName=function(e){return(/^[^@]+@([^-]+-[^-]+)/.exec(e||"")||[0,"tv-basicstudies"])[1]},l.cutDollarHash=function(e){var t=e.indexOf("$"),i=e.indexOf("@");return-1===t?e:e.substr(0,t)+(i>=0?e.substr(i):"")},l.hasUserIdSuffix=function(e){return/^USER;[\d\w]+;\d+$/.test(e)},l.isStandardPine=function(e){return/^(Strategy)?Script\$STD;.*@tv-scripting$/.test(e)},l.getSourceIdByInputs=function(e,t){if(!Array.isArray(e)||!t)return null;for(var i=0;i<e.length;++i){var r=e[i];if(l.isSourceInput(r)&&"string"==typeof t[r.id]){var s=t[r.id];return~s.indexOf("$")&&(s=s.split("$")[0]),s}}return null},l.getSourceInputIds=function(e){for(var t=[],i=e.inputs,r=0;r<i.length;++r){var s=i[r];l.isSourceInput(s)&&t.push(s.id)}return t},l.setChildStudyMetaInfoPropertiesSourceId=function(e,t,i){for(var s=0;s<e.inputs.length;++s){var n=e.inputs[s];if(l.isSourceInput(n)&&(i instanceof r&&i.inputs&&i.inputs[n.id])){var o=i.inputs[n.id].value();if(o.indexOf("$")>0){var a=o.replace(/^[^\$]+/,t);i.inputs[n.id].setValue(a)}}}},l.patchChildStudyMetaInfoState=function(e){e.state&&function e(t){if("object"==typeof t)for(var i in t)"string"==typeof t[i]&&/^[^\$]+\$\d+$/.test(t[i])?t[i]=t[i].replace(/^[^\$]+/,"{pid}"):e(t[i])}(e.state.inputs),e.state.isChildStudy=!0},l.getStudyIdWithLatestVersion=function(e){const t=l.cutDollarHash(e.id);let i=t;return t.indexOf("@tv-scripting")>=0?i+="-101!":i+="-"+e.version,i},l.prototype.parseValue=function(e,t){return"bool"===e?TradingView.parseBool(t):t},l.prototype.defaultInputs=function(){for(var e=[],t=0;t<this.inputs.length;t++)e.push(this.inputs[t].defval);return e},l.prototype.state=function(e){var t={}
;for(var i in this)this.hasOwnProperty(i)&&(t[i]=this[i],!0!==e&&"id"===i&&(t[i]+="-"+this.version));return t},l.prototype.symbolInputId=function(){var e=this.inputs.filter((function(e){return"symbol"===e.type}));return e.length>0?e[0].id:null},l.prototype.createDefaults=function(){if(this.defaults){var e=TradingView.clone(this.defaults);e.precision="default";var t=l.getStudyPropertyRootName(this);defaults.create(t,e)}},l.prototype.removeDefaults=function(){defaults.remove(l.getStudyPropertyRootName(this))},l.findStudyMetaInfoByDescription=function(e,t){if(e){for(var i=0;i<e.length;++i)if(e[i].description.toLowerCase()===t.toLowerCase())return e[i];throw new Error("unexpected study id:"+t)}throw new Error("There is no studies metainfo")},l.isParentSourceId=function(e){return"string"==typeof e&&/^[^\$]+\$\d+$/.test(e)},l.isSourceInput=function(e){return e.id&&(("source"===e.id||"src"===e.id)&&("text"===e.type||"source"===e.type)||"source"===e.type)},l.getChildSourceInputTitles=function(e,t,i){var r={};if(t.plots&&t.plots.length&&e.options&&e.options.length)for(var s,n,o,a=0;a<e.options.length;++a)n=(s=e.options[a])&&+s.split("$")[1],(o=isFinite(n)&&t.plots[n])&&~l.CHILD_STUDY_ALLOWED_PLOT_TYPES.indexOf(o.type)&&(r[s]=t.styles&&t.styles[o.id]&&t.styles[o.id].title||o.id,i&&(r[s]=i+": "+r[s]));return r};var c=new Map([["AnchoredVWAP@tv-basicstudies","linetoolanchoredvwap"],["RegressionTrend@tv-basicstudies","linetoolregressiontrend"]]);l.getStudyPropertyRootName=function(e){var t=c.get(e.id);if(void 0!==t)return t;var i="study_"+e.id;return e.pine&&e.pine.version&&(i+="_"+e.pine.version.replace(".","_")),i},l.getStudyPropertyRootNameById=function(e){var t=c.get(e);return void 0!==t?t:"study_"+e},l.overrideDefaults=function(e){0!==e.length&&n(a,e,(function(e){return TradingView.defaultProperties[l.getStudyPropertyRootName(e)]||null}))},l.mergeDefaultsOverrides=function(e){TradingView.merge(a,e)},l.isScriptStrategy=function(e){if(e.extra&&e.extra.kind)return e.extra.kind===o.Strategy;if(!0===e.isTVScriptStrategy)return!0;var t=e.TVScriptSourceCode||e.scriptSource;return!!t&&TVScript.isStrategy(t)},l.getOrderedInputIds=function(e){for(var t=[],i=e.inputs,r=0;r<i.length;++r){var s=i[r];t.push(s.id)}return t},l.canBeChild=function(e){if(e&&"string"==typeof e)return!0;if(!e||e.extra&&!l.isAllowedSourceInputsCount(e.extra.sourceInputsCount)||!0===e.canNotBeChild||!1===e.canBeChild||~l.CHILD_STUDY_EXCLUDE_IDS.indexOf(e.id))return!1;for(var t=e.inputs,i=0,r=0;r<t.length;++r)l.isSourceInput(t[r])&&++i;return l.isAllowedSourceInputsCount(i)},l.isAllowedSourceInputsCount=function(e){return 1===e},l.canHaveChildren=function(e){if(e){if(e.isTVScriptStrategy||e.TVScriptSourceCode&&TVScript.isStrategy(e.TVScriptSourceCode))return!1;if(e.id&&!~l.CHILD_STUDY_PARENT_EXCLUDE_IDS.indexOf(e.id)&&Array.isArray(e.plots))for(var t=0;t<e.plots.length;++t)if(~l.CHILD_STUDY_ALLOWED_PLOT_TYPES.indexOf(e.plots[t].type))return!0}return!1},TradingView.StudyMetaInfo=l,e&&e.exports&&(e.exports=l)},57233:(e,t,i)=>{var r;e=i.nmd(e),
"undefined"!=typeof window&&(r=window.TVScript=window.TVScript||{}),(r=r||{}).Access={},r.Access.ACCESS_OPEN_NO_AUTH="open_no_auth",r.Access.ACCESS_CLOSED_NO_AUTH="closed_no_auth",r.Access.ACCESS_CLOSED_NEEDS_AUTH="closed_needs_auth",r.Access.MAP_ID_TO_NAME={1:r.Access.ACCESS_OPEN_NO_AUTH,2:r.Access.ACCESS_CLOSED_NO_AUTH,3:r.Access.ACCESS_CLOSED_NEEDS_AUTH},r.Access.MAP_NAME_TO_ID={},Object.keys(r.Access.MAP_ID_TO_NAME).forEach((function(e){r.Access.MAP_NAME_TO_ID[r.Access.MAP_ID_TO_NAME[e]]=e})),r.PinePrefix={},r.PinePrefix.USER="USER;",r.PinePrefix.PUB="PUB;",r.PinePrefix.STD="STD;",r.PinePrefix.TV="TV_",r.PinePrefix.EDGR="EDGR_",r.PineType={},r.PineType.UserSaved="PineType_UserSaved",r.PineType.UserPublished="PineType_UserPublished",r.PineType.BuiltIn="PineType_BuiltIn",r.PineType.Addon="PineType_Addon",r.Type=r.Type||function(){},r.Type.VOID="void",r.Type.INTEGER="integer",r.Type.FLOAT="float",r.Type.STRING="string",r.Type.BOOL="bool",r.Type.COLOR="color",r.Type.SERIES="series",r.Type.PLOT="plot",r.Type.HLINE="hline",r.Type.BARCOLOR="barcolor",r.Type.BGCOLOR="bgcolor",r.Type.PLOTSHAPES="plotshape",r.Type.PLOTCHARS="plotchar",r.Type.PLOTARROWS="plotarrow",r.Type.NA="na",r.Type.ARRAY="array",r.TranslatorDefaultVersion=1,r.TranslatorReferenceVersioningIntroduced=4,r.TranslatorLastVersion=5,r.pineType=function(e){return e.startsWith(r.PinePrefix.USER)?r.PineType.UserSaved:e.startsWith(r.PinePrefix.PUB)?r.PineType.UserPublished:e.startsWith(r.PinePrefix.STD)||e.startsWith(r.PinePrefix.TV)||e.startsWith(r.PinePrefix.EDGR)?r.PineType.BuiltIn:r.PineType.Addon},r.patchILTemplate=function(e,t,i){var s=i||{};return r._patchTemplate(/<(in_\d+)>/g,e,t,s)},r.decorateQuotes=function(e){if(!e)return e;var t=/([^\\']+?)(')[^']*?/g,i=e;return"'"==i.charAt(0)&&"'"==i.charAt(i.length-1)?"'"+(i=i.substr(1,i.length-2)).replace(t,"$1\\$2")+"'":i.replace(t,"$1\\$2")},r.patchInputs=function(e,t){var i={};for(var r in e)if(e.hasOwnProperty(r)){var s,n=e[r];s=n.isFake?{v:t[n.id],f:!0,t:n.type}:t[n.id],i[n.id]=s}return i},r._patchTemplate=function(e,t,i,s){var n=s||{};return t.replace(e,(function(e,t){for(var s=(t in n?n[t]:i.defaults.inputs[t]),o=0;o<i.inputs.length;++o)if(i.inputs[o].id===t)if("bool"===i.inputs[o].type)s=s?"1.0":"0.0";else if(["text","symbol","resolution","session"].indexOf(i.inputs[o].type)>=0)s="'"+r.decorateQuotes(s)+"'";else if("source"===i.inputs[o].type){var a=s.split("$");a[0]="'"+a[0]+"'",s="source("+a.join(",")+")"}return s}))},r.isStrategy=function(e){return/^\s*strategy\s*\(/m.test(e)};var s=/^\s*\/\/\s*?@version\s*?=\s*?(\S*?)\s*?$/gm,n=/^[0-9]+$/;r.extractVersion=function(e){s.lastIndex=0;var t=s.exec(e);if(null===t)return r.TranslatorDefaultVersion;var i=t[1],o=n.test(i)?Number(i):NaN;return isNaN(o)?r.TranslatorDefaultVersion:o},r.canUpgradeVersion=function(e){return e>=3&&e<r.TranslatorLastVersion},r.canDowngradeVersion=function(e){return e>=4&&e<=r.TranslatorLastVersion},e&&e.exports&&(e.exports=r)},57298:(e,t,i)=>{"use strict";window.TradingView=window.TradingView||{},window.requireAll=function(e){
return e.keys().map(e)},i(23673),i(18184),i(57147),i(20220),i(95355).setClasses(),i(92733),i(28846).install(),i(15634),i(15365),i(69441),i(16820),i(68724),i(31565),i(99438),i(68421),i(51612),i(757),i(15027),i(51762),i(79891),i(55119),i(44197),i(83554),i(42098),i(98006)},50688:(e,t,i)=>{"use strict";var r=i(22842),s=i(18184);i(57298),i(94066),r.enabled("use_localstorage_for_settings")&&TVSettings.sync();var n=i(68981),o=i(69202);i(44583);var a=i(2872).ChartSaver,l=i(20233).takeChartSnapshot,c=i(2188),u=i(87665),d=i(52946).linking,h=i(73715),p=i(6798).getQuoteSessionInstance,_=i(51762),m=i(97786),f=i(20554),g=f.isRangeStyle,v=f.getDefaultStyle,S=i(2459).Interval,y=i(19453).getDefaultResolution,b=i(66967),w=i(50946),P=i(26132).EmbedFooterWidget,C=i(89381).StudyMarket,T=i(12578).isDrawingToolbarVisible,x=i(34698),I=i(87479).setTheme,L=i(95355).mobiletouch,M=i(14801).availableTimeFrames,E=i(75657).dispatchEventToParent,A=i(75657).listenEventFromParent,k=i(74174).IFrameEvents,D=i(74174).ParentEvents,R=i(74554).resolveByCustomer,N=i(79024).addBrandingSource,O=i(6802).setupChartEventHint,V=i(19225).setupChartScreenshotHint,B=i(95498).whenDocumentReadyPromise,F=i(25443).initGA,W=i(62134).registerSingleSymbolListBackend,U=i(55928).registerSettingsSymbolListBackend;var H=window.initData,z=window.urlParams,j=H.defSymbol,Y=void 0!==H.def_extended_hours?H.def_extended_hours?"extended":"regular":H.def_session_id,G=H.hide_ideas,q=H.hide_ideas_button,X=H.def_interval,$=H.def_style,K=H.def_timezone,J=H.customer;const Z=H.customerReadableName;var Q,ee=z.range||H.def_range,te=z.enablepublishing||H.def_enable_publishing,ie=z.withdateranges||H.def_withdateranges,re=H.def_save_image,se=!(z.hideIdeas||z.hideideasbutton||G||q);void 0!==z.saveimage&&(re="0"!==z.saveimage),r.setEnabled("header_screenshot",re?1:0),z.fundamental&&(r.setEnabled("create_volume_indicator_by_default",0),r.setEnabled("header_chart_type",0),r.setEnabled("header_compare",0),r.setEnabled("display_market_status",0),r.setEnabled("delete_button_in_legend",0),r.setEnabled("study_buttons_in_legend",0),r.setEnabled("format_button_in_legend",0),r.setEnabled("show_hide_button_in_legend",0),r.setEnabled("fundamental_widget",1),r.setEnabled("legend_context_menu",0),q=!0,G=!0,ie=!0,X="D","seekingalpha"===J&&(ie=!1,r.setEnabled("header_resolutions",0),r.setEnabled("header_fullscreen_button",0))),"bovespa"===J&&(r.disable("header_settings"),Q=[{symbol:"IBOV",title:"Bovespa Index"},{symbol:"IBXX",title:"Brazil 100 Index"},{symbol:"IBXL",title:"Brazil 50 Index"},{symbol:"IBRA",title:"Brazil Broad-Based Index"},{symbol:"IGCX",title:"Special Corporate Governance Stock Index"},{symbol:"ITAG",title:"Special Tag-Along Stock Index"},{symbol:"IGNM",title:"Novo Mercado Corporate Governance Equity Index"}]),(void 0===z.symboledit?H.def_hide_symbol_edit:!parseInt(z.symboledit))&&r.setEnabled("header_symbol_search",0),window.pro=new c(window.shopConf);j=z.symbol||j;"cme"===z.symbology&&(j=function(e){var t=new h.SymbolToken(e);if(!t.root())return e
;var i=u.convertSymbolDataToTV(t.root(),t.exchange(),z.venue);return"ok"!==i.status?e:(i.data.symbol&&t.root(i.data.symbol),i.data.exchange&&t.exchange(i.data.exchange),t.toString())}(j));var ne=Y;"1"!==z.extended_hours&&"1"!==z.session_id||(ne="extended"),"0"!==z.extended_hours&&"0"!==z.session_id||(ne="regular");var oe=_(parent),ae=i(2153).Root,le=new(0,i(15869).ChartPage)(new ae(window).allocate());if(ee){var ce=M(null,m.STATUS_READY).find((function(e){return e.value.value===ee}));ce&&(z.range=ee,z.interval=ce.targetResolution)}var ue,de,he=G;function pe(e,t){return void 0===e?t:"1"===e}ue=void 0===z.interval?void 0===z.style?X:y(g(parseInt(z.style))):z.interval,de=void 0===z.style?void 0===z.interval?parseInt($):v(S.isRange(z.interval)):parseInt(z.style);var _e=window.chartWidgetCollection=new o({resizerBridge:le.allocate({areaName:"center"}),topOffset:z.hidetoptoolbar?0:1,padding:5,edge:z.padding||0,publishedChartsEnabled:!1,saveChartEnabled:!1,widgetOptions:{onWidget:!0,addToWatchlistEnabled:!1,propertyPagesEnabled:!1,chartEventsEnabled:!0,esdEnabled:!z.fundamental,sourceStatusesWidget:{errorSolution:!1},marketStatusWidgetEnabled:!z.fundamental,chartWarningWidget:{subscriptionFullInfo:!1},widgetCustomer:J,customerReadableName:Z,hideIdeas:he,controlBarEnabled:!0,addVolume:!z.hidevolume,muteSessionErrors:!r.enabled("referral_program_for_widget_owners"),defSymbol:j,defInterval:ue,defStyle:de,defSessionId:ne,timezone:z.timezone||K,defTimeframe:ee,isDrawingToolbarVisible:T,watermarkEnabled:!z.fundamental,crossHairMenuEnabled:!1,paneContextMenuEnabled:!1,compareSymbols:Q,timeScaleWidget:{contextMenuEnabled:!1,timezoneMenuEnabled:!1},timeScale:{preserveBarSpacing:!0,lockVisibleTimeRangeOnResize:!1},legendWidgetEnabled:!z.hidelegend,legendWidget:{contextMenuEnabled:!z.fundamental,contextMenu:{settings:!1,fundamentals:!1,showOpenMarketStatus:!z.fundamental},alertWidgetEnabled:!1},goToDateEnabled:!1,handleScroll:{vertTouchDrag:pe(z.verttouchdrag,!1),horzTouchDrag:pe(z.horztouchdrag,!0)},handleScale:{mouseWheel:pe(z.mousewheelscale,"investopedia"!==J)}},seriesControlBarEnabled:!!ie,seriesControlBar:{timeFramesWidgetEnabled:!0,timeFramesWidget:{goToDateEnabled:!1,availableTimeFrames:M},timeWidgetEnabled:!z.fundamental,timeWidget:{timezoneMenuEnabled:!1},adjustForDividendsButtonEnabled:!0,sessionIdButtonEnabled:Y,backAdjustmentButtonEnabled:!1,settlementAsCloseButtonEnabled:!1,percentageScaleButtonEnabled:!0,logScaleButtonEnabled:!z.fundamental,autoScaleButtonEnabled:!z.fundamental,fullscreenButtonEnabled:!0,mobileChangeLayoutEnabled:!1},mobileForceChartMaximizeEnabled:!1});N(_e);var me,fe=_e.activeChartWidget.value();if(window.chartWidget=fe,_e.readOnly()||(window.studyMarket=new C(_e,{onWidget:!0})),d.bindToChartWidgetCollection(_e),E(k.Names.WidgetLoad,z.frameElementId||null,void 0),z.theme){var ge=z.theme.toLowerCase(),ve=x.themes[ge];if(ve&&(I(ge),!ve.noChartTheme)){var Se=z.theme&&z.theme.toLowerCase(),ye=x.getStdTheme(Se);ye&&ye.content&&(me=ye.content,z.style&&(me.mainSourceProperties.style=parseInt(z.style)),
z.fundamental&&(me.mainSourceProperties.visible=!1),n.applyDefaultsOverrides(me,{mainSeriesProperties:"mainSourceProperties"},!0))}}fe.withModel(null,(function(){var e=fe.model().mainSeries();fe.applyOverrides({"mainSeriesProperties.showCountdown":!1}),me&&fe.model().model().restoreTheme(me),e.dataEvents().symbolResolved().subscribe(e,(function(){!function(e,t){if(!t)return;var i=e.model().model();try{JSON.parse(decodeURIComponent(t)).forEach((function(e){var t=i.createStudyInserter({type:"java",studyId:e.id});t.setForceOverlay(e.overlay),t.insert((function(){return Promise.resolve({inputs:e.inputs})}))}))}catch(e){(t.split(/\x1f/)||[]).forEach((function(e){i.createStudyInserter({type:"java",studyId:e}).insert()}))}}(window.chartWidget,z.studies)}),!0),e.dataEvents().completed().subscribe(this,(function(){me&&s(".loading-indicator").hide(),O&&(O(_e,!0),O=null),V&&(V(_e,{seriesControlBarEnabled:!!ie}),V=null)})),e.dataEvents().symbolError().subscribe(null,(function(){E(k.Names.NoData,z.frameElementId||null,void 0)}))})),te&&(new P({resizerBridge:le.allocate({areaName:"bottom"}),publishOptions:{onWidget:!0,publishSource:z.publishsource}}),s.get("/accounts/status_full/",{},(function(e){e.is_authenticated&&(window.is_authenticated=!0,window.user=e.user_data)})));var be=window.saver=new a(_e);if(TradingView.setWidgetLogoOverlayVisibility=function(e){oe.post(parent,"setLogoOverlayVisibility",{visible:!!e})},
void 0===z.hidesidetoolbar||+z.hidesidetoolbar?s(".tv-side-toolbar").addClass("js-hidden"):Promise.all([Promise.all([i.e(23876),i.e(99459),i.e(29448),i.e(37610),i.e(32795),i.e(76473),i.e(43894),i.e(33996),i.e(60700),i.e(87936),i.e(19843),i.e(68604),i.e(96637),i.e(2359),i.e(47607),i.e(60959),i.e(76548),i.e(30209),i.e(63170),i.e(92309),i.e(38602),i.e(4331),i.e(90739),i.e(73935),i.e(45867),i.e(1529),i.e(36982),i.e(64011),i.e(38676),i.e(38464),i.e(9394),i.e(59963),i.e(80594),i.e(15382),i.e(33289),i.e(57276),i.e(91890),i.e(88655),i.e(69458),i.e(73558)]).then(i.t.bind(i,67294,19)),Promise.all([i.e(23876),i.e(99459),i.e(29448),i.e(37610),i.e(32795),i.e(76473),i.e(43894),i.e(33996),i.e(60700),i.e(87936),i.e(19843),i.e(68604),i.e(96637),i.e(2359),i.e(47607),i.e(60959),i.e(76548),i.e(30209),i.e(63170),i.e(92309),i.e(38602),i.e(4331),i.e(90739),i.e(73935),i.e(45867),i.e(1529),i.e(36982),i.e(64011),i.e(38676),i.e(38464),i.e(9394),i.e(59963),i.e(80594),i.e(15382),i.e(33289),i.e(57276),i.e(91890),i.e(88655),i.e(69458),i.e(73558)]).then(i.t.bind(i,73935,19)),Promise.all([i.e(23876),i.e(99459),i.e(29448),i.e(37610),i.e(32795),i.e(76473),i.e(43894),i.e(33996),i.e(60700),i.e(87936),i.e(19843),i.e(68604),i.e(96637),i.e(2359),i.e(47607),i.e(60959),i.e(76548),i.e(30209),i.e(63170),i.e(92309),i.e(38602),i.e(4331),i.e(90739),i.e(73935),i.e(45867),i.e(1529),i.e(36982),i.e(64011),i.e(38676),i.e(38464),i.e(9394),i.e(59963),i.e(80594),i.e(15382),i.e(33289),i.e(57276),i.e(91890),i.e(88655),i.e(69458),i.e(73558)]).then(i.bind(i,3993)),Promise.all([i.e(23876),i.e(99459),i.e(29448),i.e(37610),i.e(32795),i.e(76473),i.e(43894),i.e(33996),i.e(60700),i.e(87936),i.e(19843),i.e(68604),i.e(96637),i.e(2359),i.e(47607),i.e(60959),i.e(76548),i.e(30209),i.e(63170),i.e(92309),i.e(38602),i.e(4331),i.e(90739),i.e(73935),i.e(45867),i.e(1529),i.e(36982),i.e(64011),i.e(38676),i.e(38464),i.e(9394),i.e(59963),i.e(80594),i.e(15382),i.e(33289),i.e(57276),i.e(91890),i.e(88655),i.e(69458),i.e(73558)]).then(i.t.bind(i,39374,23))]).then(([e,t,{DrawingToolbar:i},{default:r}])=>{var s=le.allocate({areaName:"left"});t.render(e.createElement(i,{chartWidgetCollection:_e,forceVisible:!(void 0===z.hidesidetoolbar||+z.hidesidetoolbar),resizerBridge:s,screenshotButton:"cme"===J}),s.container.value()),window.lineToolPropertiesToolbar=new r(_e)}),!z.hidetoptoolbar){var we=R(J);Promise.all([Promise.all([i.e(40587),i.e(4331),i.e(59354),i.e(73935),i.e(1529),i.e(36982),i.e(91050),i.e(79022)]).then(i.t.bind(i,67294,19)),Promise.all([i.e(40587),i.e(4331),i.e(59354),i.e(73935),i.e(1529),i.e(36982),i.e(91050),i.e(79022)]).then(i.t.bind(i,73935,19)),Promise.all([i.e(40587),i.e(4331),i.e(59354),i.e(73935),i.e(1529),i.e(36982),i.e(91050),i.e(79022)]).then(i.bind(i,8501)),Promise.all([i.e(40587),i.e(4331),i.e(59354),i.e(73935),i.e(1529),i.e(36982),i.e(91050),i.e(79022)]).then(i.bind(i,41898)),Promise.all([i.e(40587),i.e(4331),i.e(59354),i.e(73935),i.e(1529),i.e(36982),i.e(91050),i.e(79022)]).then(i.bind(i,76756))]).then(([e,t,{HeaderToolbar:i},{SaveChartService:r},{LoadChartService:s}])=>{
var n=le.allocate({areaName:"top"});we.then((function(e){return e.getToolSet()})).then((function(o){var a=L?["full"]:void 0;t.render(e.createElement(i,{tools:o,chartSaver:be,chartApiInstance:ChartApiInstance,availableTimeFrames:M,chartWidgetCollection:_e,ideas:se,hideProperties:!0,hideStudyTemplates:!0,resizerBridge:n,popupButton:z.showpopupbutton,studyMarket:window.studyMarket,windowMessageService:oe,isFundamental:Boolean(z.fundamental),allowedModes:a,saveChartService:new r(_e,be),loadChartService:new s(_e)}),n.container.value())}))})}if(z.toolbarbg){var Pe=w.isHexColor(z.toolbarbg)?"#"+z.toolbarbg:z.toolbarbg;s("#widget-container").css("background-color",Pe)}var Ce,Te=[],xe=[];if(z.watchlist&&(xe=z.watchlist.split(/\x1f/).map((function(e){return e.trim()})).filter(Boolean)),xe.length||z.editablewatchlist){var Ie={type:"watchlist",properties:{list:xe}};z.editablewatchlist?(Ie.readonly=!1,Ie.data={hideTitleButton:!0},Ie.settingsKey="onwidget.watchlist",Ie.unAuthEditable=!0,U(xe)):W(xe),Te.push(Ie)}"details"in z&&Te.push({type:"detail"}),"widgetbarwidth"in z&&(Ce=+z.widgetbarwidth),(!isFinite(Ce)||Ce<200)&&(Ce=200);var Le,Me,Ee=Te.length?[{name:"base",title:window.t("Widgets"),icon:"base",widgets:Te.map((function(e){return e}))}]:[];z.hotlist&&Ee.push({name:"hotlist",title:window.t("Hotlists"),icon:"hotlists",widgets:[{type:"hotlist",properties:{exchangeByLocale:{default:window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE.en},groupByLocale:{default:"volume_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:{default:window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE.en},groupByLocale:{default:"percent_change_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:{default:window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE.en},groupByLocale:{default:"percent_change_loosers"}}}]}),z.calendar&&Ee.push({name:"calendar",title:window.t("Calendar"),icon:"calendar",widgets:[{type:"reuters_calendar",properties:{}},{type:"earnings_calendar",properties:{}}]}),Ee.length&&Promise.all([i.e(13523),i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(38817),i.e(39409),i.e(54551),i.e(59678),i.e(78918),i.e(37653),i.e(6585),i.e(42732),i.e(94782),i.e(53684),i.e(62602),i.e(40114),i.e(29890),i.e(92309),i.e(76192),i.e(73935),i.e(1529),i.e(14563),i.e(466),i.e(36982),i.e(64011),i.e(44740),i.e(9622),i.e(73715),i.e(45623),i.e(41242),i.e(38140),i.e(92765),i.e(80594),i.e(45856),i.e(18555),i.e(40604),i.e(37620),i.e(95848),i.e(80643),i.e(35829),i.e(96663),i.e(55490),i.e(53513),i.e(25120),i.e(54876)]).then(i.bind(i,60614)).then(({WidgetBar:e})=>{Ee.forEach((function(e){e.widgets=e.widgets.filter((function(e){return!(void 0!==e.isEnabled&&!e.isEnabled)}))}));const t=i(87451).configuration;window.widgetbar=new e({resizerBridge:le.allocate({areaName:"right"}),readonly:!0,state:{width:Ce,pages:Ee},overlayThreshold:640,showCloseButton:!0,configuration:()=>t({chartApiInstance:window.ChartApiInstance})})}),fe.onDisconnected().subscribe(null,(function(e){s(".loading-indicator").hide(),e&&b.showCriticalErrorMessage((function(){ChartApiInstance.disconnect(),setTimeout((function(){
ChartApiInstance.connect(),fe.reconnect()}),500)}))})),fe.onReconnectBailout().subscribe(null,(function(){b.showDisconnectedMessage((function(){setTimeout((function(){ChartApiInstance.connect()}),0)}))})),s(".tv-content").bind("contextmenu",(function(e){var t=s(e.originalEvent.target);if(!t.is("input")&&!t.is("textarea"))return!1})),z.whotrades&&r.setEnabled("whotrades_auth_only",!0),s(window).resize(),s(".loading-indicator").remove(),Me=function(e){void 0!==Le&&p("simple").unsubscribe("widgetQuoteListener",Le),Le=e,p("simple").subscribe("widgetQuoteListener",e,(function(e){for(var t=e.values,i=["change","change_percent","last_price","original_name","short_name","exchange","description","volume"],r={},s=0;s<i.length;s++){var n=i[s];if(!t.hasOwnProperty(n))return;r[n]=t[n]}r.volume=1e100===t.volume?void 0:t.volume,oe.post(parent,"quoteUpdate",r)}))},fe.withModel(null,(function(){var e=fe.model().mainSeries();e.properties().symbol.subscribe(e,(function(e){Me(e.value())}))})),oe.on("quoteSubscribe",(function(){var e=fe.model().mainSeries().properties().symbol.value();Me(e)})),oe.on("imageURL",(function(e,t){l(_e,(function(e){t(e)}),(function(){t("")}),{wl:"1"===z.whitelabel},H.cme_widget?{cme:!0}:void 0)})),oe.on("symbolInfo",(function(e,t){var i=fe.model().mainSeries().symbolInfo(),r=fe.model().mainSeries().properties().interval.value();t({name:i.name,exchange:i.exchange,description:i.description,type:i.type,interval:r})})),oe.on("widgetReady",(function(e,t){fe.withModel(null,(function(){var e;fe.model().mainSeries().symbolInfo()?t():(e=function(){t(),fe.model().mainSeries().dataEvents().symbolResolved().unsubscribe(null,e)},fe.model().mainSeries().dataEvents().symbolResolved().subscribe(null,e))}))})),A(D.Names.SetSymbol,(function(e){e&&e.symbol&&_e.setSymbol(e.symbol)})),A(D.Names.SetInterval,(function(e){e&&e.interval&&_e.setResolution(e.interval)})),window.applyStudiesOverrides=function(e){e&&window.chartWidgetCollection.applyStudiesOverrides(e)},Promise.all([new Promise((function(e){fe.withModel(null,(function(){fe.model().mainSeries().dataEvents().completed().subscribe(null,e,{once:!0})}))})),B]).then(F)},16820:()=>{try{!function(e){"use strict";var t,i,r=e.document,s=e.Image,n=e.globalStorage,o=e.swfobject;try{var a=e.localStorage}catch(e){}try{var l=e.sessionStorage}catch(e){}var c={history:!1,java:!1,tests:10,baseurl:"",lso:!0,silverlight:!1,domain:"",authPath:!1,pngCookieName:"png",pngPath:"/ec/png",etagCookieName:"etg",etagPath:"/ec/etag",cacheCookieName:"cachec",cachePath:"/ec/cache",staticurl:"/static/images/"},u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e._evercookie_flash_var=function(e){t=e;var i=r.getElementById("myswf");i&&i.parentNode&&i.parentNode.removeChild(i)},e.evercookie=e.Evercookie=function(d){d=d||{};var h={};for(var p in c){var _=d[p];h[p]=void 0!==_?_:c[p]}"function"==typeof h.domain&&(h.domain=h.domain(e));var m=h.history,f=h.java,g=h.tests,v=h.baseurl,S=h.staticurl,y=h.domain,b=this;this._ec={},this.get=function(e,t,i){b._evercookie(e,t,void 0,void 0,i)},
this.set=function(e,t){b._evercookie(e,(function(){}),t)},this._evercookie=function(s,n,o,a,l){if(void 0===b._evercookie&&(b=this),void 0===a&&(a=0),0===a&&(b.evercookie_database_storage(s,o),b.evercookie_indexdb_storage(s,o),b.evercookie_png(s,o),b.evercookie_etag(s,o),b.evercookie_cache(s,o),h.lso&&b.evercookie_lso(s,o),h.silverlight&&b.evercookie_silverlight(s,o),h.authPath&&b.evercookie_auth(s,o),f&&b.evercookie_java(s,o),b._ec.userData=b.evercookie_userdata(s,o),b._ec.cookieData=b.evercookie_cookie(s,o),b._ec.localData=b.evercookie_local_storage(s,o),b._ec.globalData=b.evercookie_global_storage(s,o),b._ec.sessionData=b.evercookie_session_storage(s,o),b._ec.windowData=b.evercookie_window(s,o),m&&(b._ec.historyData=b.evercookie_history(s,o))),void 0!==o)(void 0===t||void 0===i)&&a++<g&&setTimeout((function(){b._evercookie(s,n,o,a,l)}),300);else if((e.openDatabase&&void 0===b._ec.dbData||("indexedDB"in e||(e.indexedDB=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB))&&(void 0===b._ec.idbData||""===b._ec.idbData)||void 0===t||void 0===b._ec.etagData||void 0===b._ec.cacheData||void 0===b._ec.javaData||r.createElement("canvas").getContext&&(void 0===b._ec.pngData||""===b._ec.pngData)||void 0===i)&&a++<g)setTimeout((function(){b._evercookie(s,n,o,a,l)}),300);else{b._ec.lsoData=b.getFromStr(s,t),t=void 0,b._ec.slData=b.getFromStr(s,i),i=void 0;var c,u,d=b._ec,p=[],_=0;for(u in b._ec={},d)d[u]&&"null"!==d[u]&&"undefined"!==d[u]&&(p[d[u]]=void 0===p[d[u]]?1:p[d[u]]+1);for(u in p)p[u]>_&&(_=p[u],c=u);void 0===c||void 0!==l&&1===l||b.set(s,c),"function"==typeof n&&n(c,d)}},this.evercookie_window=function(t,i){try{if(void 0===i)return this.getFromStr(t,e.name);e.name=function(e,t,i){if(e.indexOf("&"+t+"=")>-1||0===e.indexOf(t+"=")){var r,s=e.indexOf("&"+t+"=");return-1===s&&(s=e.indexOf(t+"=")),-1!==(r=e.indexOf("&",s+1))?e.substr(0,s)+e.substr(r+(s?0:1))+"&"+t+"="+i:e.substr(0,s)+"&"+t+"="+i}return e+"&"+t+"="+i}(e.name,t,i)}catch(e){}},this.evercookie_userdata=function(e,t){try{var i=this.createElem("div","userdata_el",1);if(i.style.behavior="url(#default#userData)",void 0===t)return i.load(e),i.getAttribute(e);i.setAttribute(e,t),i.save(e)}catch(e){}},this.ajax=function(e){var t,i,r,s,n,o;for(t={"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},n=0,o=(r=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}]).length;n<o;n++){s=r[n];try{s=s();break}catch(e){console.error(e)}}for(i in s.onreadystatechange=function(){4===s.readyState&&e.success(s.responseText)},s.open("get",e.url,!0),t)s.setRequestHeader(i,t[i]);try{s.send()}catch(e){console.error(e)}},this.evercookie_cache=function(e,t){if(void 0!==t)r.cookie=h.cacheCookieName+"="+t+"; path=/; domain="+y,b.ajax({url:v+h.cachePath+"?name="+e,success:function(e){}});else{var i=this.getFromStr(h.cacheCookieName,r.cookie);b._ec.cacheData=void 0,
r.cookie=h.cacheCookieName+"=; expires=Mon, 20 Sep 2010 00:00:00 UTC; path=/; domain="+y,b.ajax({url:v+h.cachePath+"?name="+e,success:function(e){r.cookie=h.cacheCookieName+"="+i+"; expires=Tue, 31 Dec 2030 00:00:00 UTC; path=/; domain="+y,b._ec.cacheData=e}})}},this.evercookie_auth=function(e,t){var i,r;void 0!==t?(i="//"+t+"@"+location.host+v+h.authPath+"?name="+e,(r=new s).style.visibility="hidden",r.style.position="absolute",r.src=i):b.ajax({url:v+h.authPath+"?name="+e,success:function(e){b._ec.authData=e}})},this.evercookie_etag=function(e,t){if(void 0!==t)r.cookie=h.etagCookieName+"="+t+"; path=/; domain="+y,b.ajax({url:v+h.etagPath+"?name="+e,success:function(e){}});else{var i=this.getFromStr(h.etagCookieName,r.cookie);b._ec.etagData=void 0,r.cookie=h.etagCookieName+"=; expires=Mon, 20 Sep 2010 00:00:00 UTC; path=/; domain="+y,b.ajax({url:v+h.etagPath+"?name="+e,success:function(e){r.cookie=h.etagCookieName+"="+i+"; expires=Tue, 31 Dec 2030 00:00:00 UTC; path=/; domain="+y,b._ec.etagData=e}})}},this.evercookie_java=function(e,t){var i=r.getElementById("ecAppletContainer");function s(i){var s=r.getElementById(i);void 0!==t?s.set(e,t):b._ec.javaData=s.get(e)}"undefined"!=typeof dtjava&&(null!=i&&i.length||((i=r.createElement("div")).setAttribute("id","ecAppletContainer"),i.style.position="absolute",i.style.top="-3000px",i.style.left="-3000px",i.style.width="1px",i.style.height="1px",r.body.appendChild(i)),"undefined"==typeof ecApplet?dtjava.embed({id:"ecApplet",url:S+"evercookie.jnlp",width:"1px",height:"1px",placeholder:"ecAppletContainer"},{},{onJavascriptReady:s}):s("ecApplet"))},this.evercookie_lso=function(e,t){var i=r.getElementById("swfcontainer"),s={},n={},a={};null!=i&&i.length||((i=r.createElement("div")).setAttribute("id","swfcontainer"),r.body.appendChild(i)),void 0!==t&&(s.everdata=e+"="+t),n.swliveconnect="true",a.id="myswf",a.name="myswf",o.embedSWF(S+"evercookie.swf","swfcontainer","1","1","9.0.0",!1,s,n,a)},this.evercookie_png=function(e,t){var i,n,o,a=r.createElement("canvas");a.style.visibility="hidden",a.style.position="absolute",a.width=200,a.height=1,a&&a.getContext&&((i=new s).style.visibility="hidden",i.style.position="absolute",void 0!==t?r.cookie=h.pngCookieName+"="+t+"; path=/; domain="+y:(b._ec.pngData=void 0,n=a.getContext("2d"),o=this.getFromStr(h.pngCookieName,r.cookie),r.cookie=h.pngCookieName+"=; expires=Mon, 20 Sep 2010 00:00:00 UTC; path=/; domain="+y,i.onload=function(){r.cookie=h.pngCookieName+"="+o+"; expires=Tue, 31 Dec 2030 00:00:00 UTC; path=/; domain="+y,b._ec.pngData="",n.drawImage(i,0,0);var e,t,s=n.getImageData(0,0,200,1).data;for(e=0,t=s.length;e<t&&0!==s[e]&&(b._ec.pngData+=String.fromCharCode(s[e]),0!==s[e+1])&&(b._ec.pngData+=String.fromCharCode(s[e+1]),0!==s[e+2]);e+=4)b._ec.pngData+=String.fromCharCode(s[e+2])}),i.src=v+h.pngPath+"?name="+e)},this.evercookie_local_storage=function(e,t){try{if(a){if(void 0===t)return a.getItem(e);a.setItem(e,t)}}catch(e){}},this.evercookie_database_storage=function(t,i){try{if(e.openDatabase){
var r=e.openDatabase("sqlite_evercookie","","evercookie",1048576);void 0!==i?r.transaction((function(e){e.executeSql("CREATE TABLE IF NOT EXISTS cache(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, value TEXT NOT NULL, UNIQUE (name))",[],(function(e,t){}),(function(e,t){})),e.executeSql("INSERT OR REPLACE INTO cache(name, value) VALUES(?, ?)",[t,i],(function(e,t){}),(function(e,t){}))})):r.transaction((function(e){e.executeSql("SELECT value FROM cache WHERE name=?",[t],(function(e,t){t.rows.length>=1?b._ec.dbData=t.rows.item(0).value:b._ec.dbData=""}),(function(e,t){}))}))}}catch(e){}},this.evercookie_indexdb_storage=function(t,i){try{if("indexedDB"in e||(indexedDB=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,IDBTransaction=e.IDBTransaction||e.webkitIDBTransaction||e.msIDBTransaction,IDBKeyRange=e.IDBKeyRange||e.webkitIDBKeyRange||e.msIDBKeyRange),indexedDB){var r=indexedDB.open("idb_evercookie",1);r.onerror=function(e){},r.onupgradeneeded=function(e){e.target.result.createObjectStore("evercookie",{keyPath:"name",unique:!1})},r.onsuccess=void 0!==i?function(e){var r=e.target.result;if(r.objectStoreNames.contains("evercookie"))r.transaction(["evercookie"],"readwrite").objectStore("evercookie").put({name:t,value:i});r.close()}:function(e){var i=e.target.result;if(i.objectStoreNames.contains("evercookie")){var r=i.transaction(["evercookie"]).objectStore("evercookie").get(t);r.onsuccess=function(e){void 0===r.result?b._ec.idbData=void 0:b._ec.idbData=r.result.value}}else b._ec.idbData=void 0;i.close()}}}catch(e){}},this.evercookie_session_storage=function(e,t){try{if(l){if(void 0===t)return l.getItem(e);l.setItem(e,t)}}catch(e){}},this.evercookie_global_storage=function(e,t){if(n){var i=this.getHost();try{if(void 0===t)return n[i][e];n[i][e]=t}catch(e){}}},this.evercookie_silverlight=function(e,t){var i,s="";void 0!==t&&(s='<param name="initParams" value="'+e+"="+t+'" />'),i='<object style="position:absolute;left:-500px;top:-500px" data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="mysilverlight" width="0" height="0">'+s+'<param name="source" value="'+(S+"evercookie.xap")+'"/><param name="onLoad" value="onSilverlightLoad"/><param name="onError" value="onSilverlightError"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="minRuntimeVersion" value="4.0.50401.0"/><param name="autoUpgrade" value="false"/><a href="http://go.microsoft.com/fwlink/?LinkID=149156&v=4.0.50401.0" style="display:none">Get Microsoft Silverlight</a></object>';try{r.body.appendChild(i)}catch(e){}},this.encode=function(e){var t,i,r,s,n,o,a,l="",c=0;for(e=this._utf8_encode(e);c<e.length;)s=(t=e.charCodeAt(c++))>>2,n=(3&t)<<4|(i=e.charCodeAt(c++))>>4,o=(15&i)<<2|(r=e.charCodeAt(c++))>>6,a=63&r,isNaN(i)?o=a=64:isNaN(r)&&(a=64),l=l+u.charAt(s)+u.charAt(n)+u.charAt(o)+u.charAt(a);return l},this.decode=function(e){var t,i,r,s,n,o,a="",l=0
;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)t=u.indexOf(e.charAt(l++))<<2|(s=u.indexOf(e.charAt(l++)))>>4,i=(15&s)<<4|(n=u.indexOf(e.charAt(l++)))>>2,r=(3&n)<<6|(o=u.indexOf(e.charAt(l++))),a+=String.fromCharCode(t),64!==n&&(a+=String.fromCharCode(i)),64!==o&&(a+=String.fromCharCode(r));return a=this._utf8_decode(a)},this._utf8_encode=function(e){for(var t,i="",r=0,s=(e=e.replace(/\r\n/g,"\n")).length;r<s;r++)(t=e.charCodeAt(r))<128?i+=String.fromCharCode(t):t>127&&t<2048?(i+=String.fromCharCode(t>>6|192),i+=String.fromCharCode(63&t|128)):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128),i+=String.fromCharCode(63&t|128));return i},this._utf8_decode=function(e){for(var t="",i=0,r=e.length,s=0,n=0,o=0;i<r;)(s=e.charCodeAt(i))<128?(t+=String.fromCharCode(s),i+=1):s>191&&s<224?(n=e.charCodeAt(i+1),t+=String.fromCharCode((31&s)<<6|63&n),i+=2):(n=e.charCodeAt(i+1),o=e.charCodeAt(i+2),t+=String.fromCharCode((15&s)<<12|(63&n)<<6|63&o),i+=3);return t},this.evercookie_history=function(e,t){var i,r,s=(u+"-").split(""),n="http://www.google.com/evercookie/cache/"+this.getHost()+"/"+e,o="",a="",l=1;if(void 0!==t){if(this.hasVisited(n))return;for(this.createIframe(n,"if"),n+="/",r=this.encode(t).split(""),i=0;i<r.length;i++)n+=r[i],this.createIframe(n,"if"+i);n+="-",this.createIframe(n,"if_")}else if(this.hasVisited(n)){for(n+="/";"-"!==o&&1===l;)for(l=0,i=0;i<s.length;i++)if(this.hasVisited(n+s[i])){"-"!==(o=s[i])&&(a+=o),n+=o,l=1;break}return this.decode(a)}},this.createElem=function(e,t,i){var s;return(s=void 0!==t&&r.getElementById(t)?r.getElementById(t):r.createElement(e)).style.visibility="hidden",s.style.position="absolute",t&&s.setAttribute("id",t),i&&r.body.appendChild(s),s},this.createIframe=function(e,t){var i=this.createElem("iframe",t,1);return i.setAttribute("src",e),i};var w=this.waitForSwf=function(e){void 0===e?e=0:e++,e<g&&void 0===o&&setTimeout((function(){w(e)}),300)};this.evercookie_cookie=function(e,t){if(void 0===t)return this.getFromStr(e,r.cookie);r.cookie=e+"=; expires=Mon, 20 Sep 2010 00:00:00 UTC; path=/; domain="+y,r.cookie=e+"="+t+"; expires=Tue, 31 Dec 2030 00:00:00 UTC; path=/; domain="+y},this.getFromStr=function(e,t){if("string"==typeof t){var i,r,s=e+"=",n=t.split(/[;&]/);for(i=0;i<n.length;i++){for(r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(s))return r.substring(s.length,r.length)}}},this.getHost=function(){return e.location.host.replace(/:\d+/,"")},this.toHex=function(e){for(var t,i="",r=e.length,s=0;s<r;){for(t=e.charCodeAt(s++).toString(16);t.length<2;)t="0"+t;i+=t}return i},this.fromHex=function(e){for(var t,i="",r=e.length;r>=0;)t=r-2,i=String.fromCharCode("0x"+e.substring(t,r))+i,r=t;return i},this.hasVisited=function(e){-1===this.no_color&&(-1===this._getRGB("http://samy-was-here-this-should-never-be-visited.com",-1)&&(this.no_color=this._getRGB("http://samy-was-here-"+Math.floor(9999999*Math.random())+"rand.com")))
;return 0===e.indexOf("https:")||0===e.indexOf("http:")?this._testURL(e,this.no_color):this._testURL("http://"+e,this.no_color)||this._testURL("https://"+e,this.no_color)||this._testURL("http://www."+e,this.no_color)||this._testURL("https://www."+e,this.no_color)};var P,C,T=this.createElem("a","_ec_rgb_link"),x="#_ec_rgb_link:visited{display:none;color:#FF0000}";try{P=1,(C=r.createElement("style")).styleSheet?C.styleSheet.innerHTML=x:C.innerHTML?C.innerHTML=x:C.appendChild(r.createTextNode(x))}catch(e){P=0}this._getRGB=function(e,t){return t&&0===P?-1:(T.href=e,T.innerHTML=e,r.body.appendChild(C),r.body.appendChild(T),r.defaultView?r.defaultView.getComputedStyle(T,null).getPropertyValue("color"):T.currentStyle.color)},this._testURL=function(e,t){var i=this._getRGB(e);return"rgb(255, 0, 0)"===i||"#ff0000"===i||t&&i!==t?1:0}}}(window)}catch(e){}},15634:(e,t,i)=>{"use strict";i.r(t);i(36912),i(26891),i(66177),i(91822),i(63762)},73356:(e,t,i)=>{"use strict";i.d(t,{ActionCreators:()=>h});i(20220);var r=i(54281),s=i(82324),n=i(11585),o=i(66715),a=i(35447),l=i(99673),c=i(35961),u=i(54500),d=i(18972);const h={stopAlerts:e=>new r.Action({label:window.t("Stop",{context:"alert"}),icon:a,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(t=>t.stopAlerts({ids:e.map(e=>e.id)}))}),restartAlerts:e=>new r.Action({label:window.t("Restart"),icon:o,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(t=>t.restartAlerts({ids:e.map(e=>e.id)}))}),cloneAlerts:e=>new r.Action({label:window.t("Clone"),icon:c,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(t=>t.cloneAlerts({ids:e.map(e=>e.id)}))}),deleteAlerts:e=>new r.Action({label:window.t("Remove"),icon:u,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(t=>t.deleteAlerts({ids:e.map(e=>e.id),showConfirm:!0}))}),stopAlert:e=>new r.Action({label:window.t("Stop",{context:"alert"}),icon:a,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(t=>t.stopAlert(e))}),restartAlert:(e,t)=>new r.Action({label:window.t("Restart"),icon:o,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(i=>i.restartAlert(e,{actionSource:t}))}),editAlert:(e,t,i)=>new r.Action({label:i?(0,n.appendEllipsis)(window.t("Edit alert")):(0,n.appendEllipsis)(window.t("Edit")),icon:l,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(i=>i.openEditDialog(e,{actionSource:t}))}),cloneAlert:(e,t,i)=>new r.Action({label:window.t("Clone"),icon:c,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(r=>r.cloneAlert(e,{actionSource:t,eventLabel:i}))}),deleteAlert:e=>new r.Action({label:window.t("Remove"),icon:u,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(t=>t.deleteAlert(e,{showConfirm:!0}))}),restartAllAlerts:(e,t)=>{const i=e||t?window.t("Restart as per filter"):window.t("Restart all inactive");return new r.Action({label:i,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(i=>i.restartAllAlerts({showConfirm:!0,symbol:e,resolution:t,active:!1}))})},stopAllAlerts:(e,t)=>{const i=e||t?window.t("Stop as per filter"):window.t("Stop all");return new r.Action({label:i,onExecute:()=>(0,
s.getPriceAlertsDispatcher)().then(i=>i.stopAllAlerts({showConfirm:!0,symbol:e,resolution:t}))})},deleteAllInactiveAlerts:()=>new r.Action({label:window.t("Remove all inactive"),onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(e=>e.deleteAllAlerts({active:!1,showConfirm:!0,symbol:null,resolution:null}))}),deleteAllAlerts:(e,t,i)=>{const n=e||t||i?window.t("Remove as per filter"):window.t("Remove all");return new r.Action({label:n,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(r=>r.deleteAllAlerts({showConfirm:!0,symbol:e,resolution:t,active:!!i||null}))})},deleteAllEvents:()=>new r.Action({label:window.t("Clear Log"),icon:d,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(e=>e.deleteEvents())}),deleteEvents:e=>new r.Action({label:window.t("Remove"),icon:u,onExecute:()=>(0,s.getPriceAlertsDispatcher)().then(t=>t.deleteEvents({ids:e.map(e=>e.id)}))})}},17476:(e,t,i)=>{"use strict";i.d(t,{alertEditorInvocationHandler:()=>l});var r=i(65066),s=i.n(r),n=i(11132),o=i(16282);class a{constructor(){this._state=new(s())(!1)}subscribe(e){this._state.subscribe(e)}unsubscribe(e){this._state.unsubscribe(e)}value(){return this._state.value()}abort(){this._state.setValue(!0)}}const l=new class{constructor(){this._dialogInvocations=new(s())(new Map)}getDialogInvocations(){return this._dialogInvocations}isAllowedToInvoke(e){return e.silent||!this._dialogInvocations.value().has(c(e))}lockInvocation(e){if(e.silent)return{unlockInvocation:()=>{}};const t=c(e),i=new a,r=new Map(this._dialogInvocations.value());return r.set(t,i),this._dialogInvocations.setValue(r),{abortSignal:i,unlockInvocation:()=>{const e=new Map(this._dialogInvocations.value());e.delete(t),this._dialogInvocations.setValue(e)}}}};function c(e){return"create_alert"===(0,n.getAlertDialogType)(e)?-1:(0,o.ensureDefined)(e.alert).id}},18771:(e,t,i)=>{"use strict";i.d(t,{alertsMaintenanceTracker:()=>o});var r=i(65066),s=i.n(r),n=i(98006);const o=new class{constructor(){this._state=new(s())((0,n.isFeatureEnabled)("alerts-maintenance"))}value(){return this._state.value()}subscribe(e){this._state.subscribe(e)}unsubscribe(e){this._state.unsubscribe(e)}sync(){this._state.setValue((0,n.isFeatureEnabled)("alerts-maintenance"))}}},60470:(e,t,i)=>{"use strict";i.d(t,{confirmDatasourceRemoving:()=>s});var r=i(79407);function s(){return new Promise(e=>(0,r.showConfirm)({text:window.t("This drawing is used in alert. If you remove the drawing, the alert will be also removed. Do you want to remove the drawing anyway?"),onConfirm:({dialogClose:t})=>{e(!0),t()},onClose:()=>e(!1)}))}},21234:(e,t,i)=>{"use strict";var r;i.d(t,{Constants:()=>r}),function(e){e.DrawingIconColor="rgba( 170, 170, 170, 1)",e[e.NameLengthLimit=300]="NameLengthLimit"}(r||(r={}))},82379:(e,t,i)=>{"use strict";var r;i.d(t,{DataSourceDangerReason:()=>r}),function(e){e.Spread="spread",e.PineRepainting="pine-repainting",e.CryptoCap="cryptocap"}(r||(r={}))},95658:(e,t,i)=>{"use strict";i.d(t,{getSeriesDangerReason:()=>s});var r=i(82379);function s(e){if(e.isSpread())return r.DataSourceDangerReason.Spread
;const t=e.symbolInfo();return t&&"CRYPTOCAP"===t.exchange?r.DataSourceDangerReason.CryptoCap:null}},20552:(e,t,i)=>{"use strict";function r(e){return n().then(t=>t.hasUserAccessToDataSource(e))}function s(e){return n().then(t=>t.filterAccessibleDataSources(e))}i.d(t,{hasUserAccessToDataSource:()=>r,filterAccessibleDataSources:()=>s});const n=()=>Promise.all([i.e(32637),i.e(14563),i.e(73715),i.e(34698),i.e(4033),i.e(68981),i.e(45623),i.e(19453),i.e(93669),i.e(84101),i.e(84234),i.e(18319),i.e(81627),i.e(4982),i.e(18555),i.e(87048),i.e(43887),i.e(35829),i.e(28022),i.e(83441)]).then(i.bind(i,79890))},82324:(e,t,i)=>{"use strict";i.r(t),i.d(t,{getPriceAlertsDispatcher:()=>s,getPriceAlertsDispatcherIfExists:()=>n,setPriceAlertsDispatcherIfNotExists:()=>o});i(65194);let r=null;function s(){return new Promise(e=>{null===r?Promise.all([i.e(73715),i.e(24194),i.e(41242),i.e(19453),i.e(84234),i.e(81627),i.e(43887),i.e(52946),i.e(59958),i.e(11228),i.e(267),i.e(35683),i.e(44820),i.e(48158)]).then(i.bind(i,35797)).then(t=>{null===r&&(r=new t.AlertsDispatcher),e(r)}):e(r)})}function n(){return r}function o(e){return null===r&&(r=e,!0)}},77018:(e,t,i)=>{"use strict";var r=i(18184),s=i(12012).isStudyStateForAlertType,n=i(55782),o=i(86837).generateTitleForGui,a=i(87380).getLogger("Alerts.Band"),l=i(20554),c=i(82755);TradingView="object"==typeof i.g?i.g.TradingView:TradingView||{};var u={create:function(e){var t,i=e||{},r=i.type;if("MainSeries"===r)t=h;else if(s(r,!0))t=p;else if("Value"===r)t=_;else{if(!/^LineTool.*/i.test(r))return a.logError("Unknown alert band type "+r),null;t=m}return new t(i)}};function d(e){this._band=e||{}}function h(){d.apply(this,arguments)}function p(){d.apply(this,arguments)}function _(){d.apply(this,arguments)}function m(){d.apply(this,arguments)}d.prototype.id=function(){return this._band.id},d.prototype.type=function(){return this._band.type},d.prototype.title=function(){return this._band.title},d.prototype.hasPlots=function(){return this._band.plots&&this._band.plots.length},d.prototype.getActualSymbol=function(){return this._band.actualSymbol},d.prototype.getSymbolString=function(){return this._band.symbolString},d.prototype.getPlotTitle=function(e){return e.title?e.title:n.isOhlcOpenPlot(e)?e.ohlcTitle+" "+r.t("Open"):n.isOhlcHighPlot(e)?e.ohlcTitle+" "+r.t("High"):n.isOhlcLowPlot(e)?e.ohlcTitle+" "+r.t("Low"):n.isOhlcClosePlot(e)?e.ohlcTitle+" "+r.t("Close"):"vol"===e.id?r.t("Volume"):"vol_ma"===e.id?r.t("Volume MA"):"open"===e.id?r.t("Open"):"high"===e.id?r.t("High"):"low"===e.id?r.t("Low"):"close"===e.id?r.t("Close"):e.id},d.prototype.getPlots=function(e){var t=e||{};if(!this._band.plots||!this._band.plots.length)return this._band.plots;if("inputSelect"===t.format){var i=-1;return this._band.plots.map((function(e){return{value:++i,title:this.getPlotTitle(e)}}),this)}return this._band.plots},d.prototype.hasUsualPlots=function(){var e=this._band.plots;return!e||e.filter(n.isAlertConditionPlot).length<e.length},d.prototype.getInputs=function(){return{}},inherit(h,d),h.prototype.title=function(e){
var t=i(73715),r=e||{},s=!!r.withInterval,n=this._band.actualSymbol;return t&&(n=t.shortName(n)),o({symbol:n,interval:s?this._band.interval:null,style:this._band.style,inputs:this._band.styleInputs||{},boxSize:this._band.boxSize,reversalAmount:this._band.reversalAmount,sessionDescription:r.sessionDescription})},h.prototype.getInterval=function(){return this._band.interval},h.prototype.getStyle=function(){return this._band.style},h.prototype.getStyleInputs=function(){return this._band.styleInputs},h.prototype.isRangeBasedStyle=function(){return l.isRangeBasedStyle(this._band.style)},h.prototype.isSpread=function(){return this._band.isSpread},h.prototype.sessionId=function(){return this._band.sessionId},h.prototype.sessionDescription=function(){return this._band.sessionDescription},h.prototype.getDividendsAdjustment=function(){return this._band.dividendsAdjustment},h.prototype.getBackAdjustment=function(){return this._band.backAdjustment},h.prototype.getSettlementAsClose=function(){return this._band.settlementAsClose},inherit(p,d),p.prototype.title=function(e){var t,i,s,n=e||{},o=n.withPlotTitle,a=this._band;return n.short&&a.shortTitle?t=a.shortTitle:a.title?t=a.title:(t=a.shortDescription||"Study",i=[],Object.keys(a.inputs).forEach((function(e){var t=a.inputs[e]&&a.inputs[e].id;t&&!a.inputs[e].isHidden&&void 0!==a.inputs[t]&&i.push(a.inputs[t])})),i.length&&(t+=" ("+i.join(", ")+")")),o&&(s=this.selectedPlot())&&(t+=" "+(s.title||r.t("Untitled Plot"))),c.isRtl()&&(t=c.forceLTRStr(t)),t},p.prototype.selectedPlot=function(){var e=this._band;return void 0===e.plotIndex?null:this.getPlots().filter((function(t){return t.value===e.plotIndex}))[0]||null},p.prototype.getInputs=function(){return this._band.inputs||{}},inherit(_,d),_.prototype.title=function(e){var t=this._band.value||0;return e.formatter?e.formatter.format(parseFloat(t)):parseFloat(t).toString()},inherit(m,d),e.exports.AlertBandAbstract=d,e.exports.AlertBandValue=_,e.exports.alertBandFactory=u},12012:(e,t,i)=>{"use strict";var r;function s(e,t){let i="Study"===e||e===r.StudyLineTool||/^study_\w+/.test(e);return t&&(i=i||"StudyStrategy"===e),i}i.r(t),i.d(t,{StateForAlertType:()=>r,isStudyStateForAlertType:()=>s}),function(e){e.StudyLineTool="StudyLineTool"}(r||(r={}))},36989:(e,t,i)=>{"use strict";i.d(t,{canPlaceAlertOnResolution:()=>o,isAlertResolutionEqual:()=>a});var r=i(2459),s=i(3851),n=i(5803);function o(e){return!r.Interval.isSeconds(e)||(0,s.enabled)(n.ProductFeatures.ALERTS_ON_SECONDS)}function a(e,t){return e.get("crossInterval")||r.Interval.isEqual(e.get("resolution"),t)}},44197:(e,t,i)=>{e=i.nmd(e),TradingView.cleanButAmpersand=function(e,t){var i=t?["&amp;"]:["&"];return TradingView.clean(e,t,i)},TradingView.strip_tags=function(e){return e&&e.replace?e.replace(/(<([^>]+)>)/gi,""):e},TradingView.encodeSpread=function(e){return encodeURIComponent(e)},TradingView.clean=function(e,t,i){var r=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&#039;"],["'","&#39;"]],s=e;if(!e||!e.replace)return s;for(var n=0;n<r.length;n++){
var o=r[n][0],a=r[n][1];i&&i.indexOf&&-1!==i.indexOf(t?a:o)||(s=t?s.replace(new RegExp(a,"g"),o):s.replace(new RegExp(o,"g"),a))}return s},e&&e.exports&&(e.exports={clean:TradingView.clean,cleanButAmpersand:TradingView.cleanButAmpersand,stripTags:TradingView.strip_tags})},83554:(e,t,i)=>{"use strict";i.r(t);var r=i(41962),s=i(29098),n=i(85864),o=i(15642),a=(i(16820),i(75443)),l=i(11767),c=i(55119),u=i(87380);const d=(0,u.getLogger)("Common.Evercookie");const h=(0,u.getLogger)("Common.Evercookie"),p=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;class _{constructor(){this._cookieName="tv_ecuid",this._env=null,this._ec=null,this.check=()=>{if(this._isEcNotAvailable()||c.TVLocalStorage.getItem("_tv_ec_ignore_username")===window.user.username)return;const e=window.user.id;this._getEcUids().catch(e=>{h.logWarn(`Error thrown inside getEcUids(). Leave evercookie data untouched. User: ${window.user.username} (${window.user.id})\nActual error: ${e}`)}).then(t=>{if(void 0===t)return void h.logWarn(`getEcUids() returned no data. Leave evercookie data untouched. User: ${window.user.username} (${window.user.id})`);let r=t.localEcUid;const s=t.remoteEcUids;r&&p.test(r)||(r=(0,a.guid)(),this._getEc().set(this._cookieName,r));const o=t=>{t.subscription_canceled&&Promise.all([i.e(26822),i.e(99459),i.e(74814),i.e(18436),i.e(53471),i.e(63949),i.e(73935),i.e(93568),i.e(18932)]).then(i.bind(i,53373)).then(e=>e.createTrialCanceledDialog()),e===window.user.id&&t.is_suspicious?c.TVLocalStorage.setItem("is_suspicious","1"):c.TVLocalStorage.removeItem("is_suspicious")};s&&0!==s.length&&-1!==s.indexOf(r)||e!==window.user.id||function(e){const t=new FormData;return t.append("ecuid",e),(0,n.fetch)("/accounts/set-ecuid/",{body:t,credentials:"include",method:"POST"}).then(e=>{if(e.ok)return e.json().catch(e=>{d.logWarn(`Error in reponse.json() of /accounts/set-ecuid/. User: ${window.user.username} (${window.user.id})\nActual error: ${e}`)});throw new Error("Unable to set remote ecuids. Response was not OK")})}(r).then(o)}).catch(e=>{h.logError(e.message+` User: ${window.user.username} (${window.user.id})`)})},this._isEcNotAvailable()||(this._env=(0,l.environment)(),(0,l.isDebug)()&&(this._cookieName+="_"+this._env))}_isEcNotAvailable(){return TradingView.onWidget&&TradingView.onWidget()||!window.user}_getEc(){return this._ec||(this._ec=new window.evercookie({domain:(0,l.isProd)()?".tradingview.com":location.hostname,lso:!1})),this._ec}_getLocalEcUid(){return new Promise(e=>{this._getEc().get(this._cookieName,t=>{e(t)})})}_getEcUids(){return new Promise((e,t)=>{let i;this._getLocalEcUid().then(e=>(i=e,function(e){return new Promise((t,i)=>{const r=new FormData;e&&r.append("local_ecuid",e),(0,n.fetch)("/accounts/get-ecuid/",{body:r,credentials:"include",method:"POST"}).then(e=>{if(e.ok)return e.json().catch(e=>{d.logWarn(`Error in reponse.json() of /accounts/get-ecuid/. User: ${window.user.username} (${window.user.id})\nActual error: ${e}`)});throw new Error("Unable to get remote ecuids. Response was not OK")
}).then(e=>{t(e)}).catch(e=>{i(e)})})}(e))).then(t=>{if(void 0===t)throw new Error(`getRemoteEcUids() returned no response. User: ${window.user.username} (${window.user.id})`);e({localEcUid:i,remoteEcUids:t.ecuids})}).catch(e=>{t(e)})})}}i(18184),i(20220);var m=i(65009),f=i(96107),g=i(88674),v=i(36053),S=i(18184);S("body").on("click",".js-follow-user",(function(e){const t=S(e.currentTarget),r=t.data("id"),s=t.is(".js-follow-user--followed")?"Unfollow":"Follow",n={authorId:r};window.runOrSignIn(async()=>{if(!t.is(".self")){const e=t.is(".js-follow-user--followed")?0:1;(await Promise.all([i.e(9029),i.e(57853)]).then(i.bind(i,58406))).protectedFetch("/social/follow-the-user/",{follow:e,targetId:r},"follow").then(e=>{"max_followings_exceed"!==e.error_code?e.error?(0,g.showNoticeDialog)({content:e.error,title:e.errorTitle||S.t("Error")}):(S(".js-follow-user-"+r).toggleClass("js-follow-user--followed").toggleClass("i-checked"),(0,m.trackActionFollow)("User",s,n)):Promise.all([i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(38817),i.e(466),i.e(64011),i.e(44740),i.e(94795),i.e(13469),i.e(34834)]).then(i.bind(i,64161)).then(({createDialog:e})=>{const t=e({type:"modal",closeOnEsc:!1,closeOnOutsideClick:!1,closeButton:!1,width:546,contentWrapTemplate:'\n\t\t\t\t\t\t\t\t\t\t<div class="tv-dialog__section tv-dialog__section--no-border">\n\t\t\t\t\t\t\t\t\t\t\t<div class="tv-text"></div>\n\t\t\t\t\t\t\t\t\t\t</div>',content:`\n\t\t\t\t\t\t\t\t\t\t<div class="tv-dialog__header">\n\t\t\t\t\t\t\t\t\t\t\t<div class="tv-dialog__header-logo">${v}</div>\n\t\t\t\t\t\t\t\t\t\t\t<h2 class="tv-dialog__header-title">${S.t("Unfollow some authors")}</h2>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<p class="tv-text__font tv-text__font--size_semilarge">\n\t\t\t\t\t\t\t\t\t\t\t\t${S.t("Sorry, follow limit reached and you cannot follow more authors without removing some first.")}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>`,actions:[{name:"goToProfile",type:"primary",text:S.t("Go to Profile"),key:13},{addClass:"tv-button--no-padding i-float_left",name:"cancel",type:"link",text:S.t("No thanks"),method:"close"}]});t.on("action:goToProfile",e=>{window.location.replace((0,f.getUserProfilePath)(window.user,{page:f.ProfilePages.FollowingPeople})),e.destroy()}),t.open()})}).catch(e=>{(0,g.showNoticeDialog)({content:e.message,title:S.t("Oops!")})})}},{source:"Follow user",verifiedPhoneRequired:!0})}));var y=i(82143);document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("click",e=>{const t=e.target.closest(".js-profile-message");t instanceof HTMLElement&&(e.preventDefault(),function(e){const t=Number(e.dataset.id),i=e.dataset.username;window.runOrSignIn(()=>(0,y.openPMDialog)(t,i),{source:"Private message from broker popup",verifiedPhoneRequired:!0})}(t))})});var b=i(71141),w=i(68724),P=i(40142),C=(i(42127),i(96276)),T=i.n(C),x=i(21318),I=i(95498);i(18184)(document).ajaxSend((e,t,i)=>{
i.crossDomain&&!i.forceLanguageHeader||(window.locale?t.setRequestHeader("X-Language",window.locale):console.warn("window.locale is not defined"))});var L=i(23619);var M=i(85622);let E,A;function k(){if(window.initData.lfs){const e=document.getElementsByClassName("js-admin-warning")[0];document.body.removeChild(e)}let e=!0;[/^\/chart\//,/^\/share-your-love\//].forEach(t=>{t.test(window.location.pathname)&&(e=!1)}),e&&window.location.reload()}function D(e,t){window.TVDialogs&&window.TVDialogs.signModal&&window.TVDialogs.signModal.close(),window.user=(0,x.deepExtend)({},e),window.TradingView.changeLoginState(!0),"function"==typeof t&&window.TVDialogs&&window.TVDialogs.signModal?window.TVDialogs.signModal.on("signinSuccess",()=>{t()}):"function"==typeof t&&t()}function R(e){window.iframeAuthWidget&&!1===window.user.profile_data_filled&&(window.iframeAuthWidget.preventClose=!0);const t=window.user.available_offers||{};{const e=document.documentElement;e.classList.toggle("is-authenticated",window.is_authenticated),e.classList.toggle("is-not-authenticated",!window.is_authenticated)}window.TVSettings&&window.TVSettings.sync(window.user.settings),window.is_authenticated?(e&&!1!==window.user.profile_data_filled||void 0===A||A.check(),e||(Promise.all([i.e(73935),i.e(19158)]).then(i.bind(i,6795)).then(e=>e.offerButtonLoginStateChangeInit()),(0,w.onGoPro)()&&window.user.is_pro&&window.location.reload()),!1===window.user.profile_data_filled&&((0,w.checkPageType)("mobile")||(0,P.isOnMobileAppPage)("any")||(0,I.whenDocumentReady)(()=>{(0,b.showSignModal)({mode:"create-account",noCloseButton:!!window.user.social_registration,dontCloseOnEsc:!!window.user.social_registration,nameFields:!window.user.social_registration,noUsernameField:!window.user.social_registration}).then(e=>{window.iframeAuthWidget&&(window.iframeAuthWidget.preventClose=!1,e.on("destroy",()=>{window.iframeAuthWidget.postClose()}))}),window.user.social_registration?(i.e(22947).then(i.bind(i,2508)).then(({default:e})=>{e("Social")}),delete window.user.social_registration):r.TVXWindowEvents.emit("loginStateChange",JSON.stringify({is_authenticated:window.is_authenticated,user:window.user}))},!0),(0,s.trackEvent)("Conversion","First login"),delete window.user.profile_data_filled),window.TradingView.setTrialAvailiable(void 0!==t[o.OFFERS.trial])):(Object.keys(t).forEach(e=>{const i=e;t[i].available_for_anons||delete t[i]}),window.user={username:"Guest",following:"0",followers:"0",ignore_list:[],available_offers:t},c.TVLocalStorage.removeItem("trial_availiable"))}E=window.loginStateChange?window.loginStateChange:window.loginStateChange=new(T()),E.subscribe(null,R),r.TVXWindowEvents.on("loginStateChange",e=>{const t=JSON.parse(e);window.user=t.user,window.is_authenticated=!!t.is_authenticated,E.fire()}),r.TVXWindowEvents.on("signOut",()=>{k()}),(()=>{const e={};window.crossTabSyncUserAttr=e=>{const t={};e instanceof Array?e.forEach(e=>{t[e]=window.user[e]}):t[e]=window.user[e],r.TVXWindowEvents.emit("user-obj-changed",JSON.stringify(t))},
r.TVXWindowEvents.on("user-obj-changed",t=>{const i=JSON.parse(t);let r;for(r in i)if(i.hasOwnProperty(r)){window.user[r]=i[r];(e[r]||[]).forEach(e=>{e.fire(i[r])})}})})(),window.TradingView.changeLoginState=e=>{window.is_authenticated=!!e,r.TVXWindowEvents.emit("loginStateChange",JSON.stringify({is_authenticated:window.is_authenticated,user:window.user})),E.fire()},window.loginUser=D,window.addEventListener("storage",e=>{"login_user"===e.key&&null!==e.newValue&&D(JSON.parse(e.newValue))}),window.TradingView.signOut=()=>{const e={...window.user};(0,n.fetch)("/accounts/logout/",{method:"POST",headers:{accept:"html"},credentials:"same-origin"}).then(()=>{window.TradingView.changeLoginState(!1),r.TVXWindowEvents.emit("signOut"),k()}).catch(()=>{window.user=e,window.TradingView.changeLoginState(!0)})},A=new _,window.loginRequiredDelegate=new(T()),window.runOrSignIn=(e,t)=>{t||(t={});const i=[];if(t.paidAccountCheck&&i.push(()=>(0,M.paidAccountCheck)({successButtonText:t.paidAccountSuccessButtonText})),t.verifiedPhoneRequired){const e=()=>Promise.resolve((0,L.whenVerified)({showDialog:!0,source:t.source,doNotCheckSuspicious:t.doNotCheckSuspicious,doNotCheckSocialActivity:t.doNotCheckSocialActivity,customPhoneCheck:t.customPhoneCheck,doNotShowConfirmation:t.doNotShowConfirmation}));i.push(e)}window.is_authenticated?i.reduce((e,t)=>e.then(t),Promise.resolve()).then(e).catch(()=>{}):(0,b.showSignModal)({source:t.source,sourceMeta:t.sourceMeta,feature:t.feature,mode:t.mode,signinSuccess:e,startTrial:t.startTrial})},window.onLoginStateChange=R,window.TradingView.setTrialAvailiable=e=>{c.TVLocalStorage.setItem("trial_availiable",e?"1":"0")},window.TradingView.notificationsChanged=new(T())},64553:(e,t,i)=>{"use strict";i.d(t,{handleJSONRequest:()=>n});var r=i(85864);function s({path:e,requestData:t}){const i=new URL(e,window.origin);if("GET"===t.method&&t.query)for(const[e,r]of Object.entries(t.query))void 0!==r&&i.searchParams.append(e,r);const s={method:t.method,credentials:"same-origin"};return"POST"!==t.method&&"PUT"!==t.method||(s.body=JSON.stringify(t.body),s.headers=new Headers({"Content-Type":"application/json"})),(0,r.fetch)(i.toString(),s)}async function n(e){const t=await s(e);try{const e=await t.json();return t.ok?e:Promise.reject(new o(t.status,e))}catch(e){return Promise.reject(new o(t.status,{}))}}class o extends Error{constructor(e,t){super([e,t.code,t.detail].filter(Boolean).join(" - ")),this.status=e,this.payload=t,this.name="APIError",Object.setPrototypeOf(this,new.target.prototype)}}},50946:(e,t,i)=>{"use strict";i.r(t),i.d(t,{generateColor:()=>s,alphaToTransparency:()=>n,transparencyToAlpha:()=>o,applyTransparency:()=>a,resetTransparency:()=>l,getLuminance:()=>c,isHexColor:()=>u,colorFromBackground:()=>d,gradientColorAtPercent:()=>h,isColorDark:()=>p,rgbaFromInteger:()=>_,rgbaToInteger:()=>m,colorToInteger:()=>f});var r=i(14563);function s(e,t,i){if(t=t||0,!u(e))return i?(0,r.rgbaToString)((0,r.rgba)((0,r.parseRgb)(e),(0,r.normalizeAlphaComponent)(o(t)))):e;const[s,n,a]=(0,r.parseRgb)(e),l=(0,
r.normalizeAlphaComponent)(o(t));return(0,r.rgbaToString)([s,n,a,l])}function n(e){return 100*(1-e)}function o(e){if(e<0||e>100)throw new Error("invalid transparency");return 1-e/100}function a(e,t){if("transparent"===e)return e;const i=(0,r.parseRgba)(e),s=i[3];return(0,r.rgbaToString)((0,r.rgba)(i[0],i[1],i[2],o(t)*s))}function l(e){return"transparent"===e||u(e)?e:(0,r.rgbaToString)((0,r.rgba)((0,r.parseRgb)(e),(0,r.normalizeAlphaComponent)(1)))}function c(e){const t=(0,r.parseRgb)(e).map(e=>(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function u(e){return 0===e.indexOf("#")}function d(e){return"black"===(0,r.rgbToBlackWhiteString)((0,r.parseRgb)(e),150)?"#ffffff":"#000000"}function h(e,t,i){const[s,n,o,a]=(0,r.parseRgba)(e),[l,c,u,d]=(0,r.parseRgba)(t),h=(0,r.rgba)(Math.round(s+i*(l-s)),Math.round(n+i*(c-n)),Math.round(o+i*(u-o)),a+i*(d-a));return(0,r.rgbaToString)(h)}function p(e){return c(l(e))<.5}function _(e){const t=(e=Math.round(e))%256;e-=t;const i=(e/=256)%256;e-=i;const r=(e/=256)%256;e-=r;return`rgba(${t},${i},${r},${(e/=256)/255})`}function m(e){const t=Math.round(255*e[3]);return e[0]+256*e[1]+65536*e[2]+16777216*t}function f(e){const t=(0,r.tryParseRgba)(e);return null===t?0:m(t)}},68450:(e,t,i)=>{"use strict";function r(e,t,i){return e*(1-i)+t*i}i.d(t,{lerp:()=>r,doAnimate:()=>o});const s={from:0,duration:250,easing:i(71928).easingFunc.easeOutCubic};class n{constructor(e){this._doing=!0,this._completed=!1,this._options={...s,...e};const t=performance.now();window.requestAnimationFrame(e=>{this._animation(t,this._options.from,e)})}stop(){this._doing=!1}completed(){return this._completed}_animation(e,t,i){if(!this._doing)return void this._finishAnimation();const s=(i=!i||i<1e12?performance.now():i)-e,n=s>=this._options.duration||t===this._options.to,o=r(this._options.from,this._options.to,this._options.easing(s/this._options.duration)),a=n?this._options.to:o,l=a-t;this._options.onStep(l,a),n?this._finishAnimation():window.requestAnimationFrame(t=>{this._animation(e,a,t)})}_finishAnimation(){this._options.onComplete&&this._options.onComplete(),this._completed=!0}}function o(e){return new n(e)}},85864:(e,t,i)=>{"use strict";i.d(t,{fetch:()=>s});const r=(0,i(87380).getLogger)("Fetch");function s(e,t,i={}){{t=t||{},function(e){{const t=document.createElement("a");return t.href=e,t.hostname||(t.href=t.href),t.hostname===location.hostname&&!t.username}}(e)&&(t.headers?t.headers instanceof Headers||(t.headers=new Headers(t.headers)):t.headers=new Headers,window.locale&&t.headers.set("X-Language",window.locale),t.headers.set("X-Requested-With","XMLHttpRequest")),void 0===t.credentials&&(t.credentials="same-origin");const s=window.fetch(e,t);return s.then(s=>{if(!s.ok){let n="";t.method&&(n+=t.method.toUpperCase()+" "),n+=e,n+=". Status "+s.status,s.statusText&&(n+=". "+s.statusText),s.headers.via&&(n+=". Via: "+s.headers.via),i.logBodyOnError&&"string"==typeof t.body&&(n+=". Body: "+t.body.slice(0,1024)),r.logError(n)}return s},i=>{
if(i&&"AbortError"===i.name)return;let s="";t.method&&(s+=t.method.toUpperCase()+" "),s+=e,navigator.onLine?s+=". "+i:s+=". User is offline.",r.logError(s)}),s}}},87380:(e,t,i)=>{"use strict";i.r(t),i.d(t,{LOGLEVEL:()=>n,getLogLevel:()=>_,isHighRateEnabled:()=>m,setLogLevel:()=>f,getRawLogHistory:()=>g,serializeLogHistoryEntry:()=>v,getLogHistory:()=>S,getLogger:()=>b,loggingOn:()=>P,loggingOff:()=>C});const r="undefined"!=typeof window?window:{};let s=!1;try{localStorage.getItem(""),s=!0}catch(e){}var n;!function(e){e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.INFO=3]="INFO",e[e.NORMAL=4]="NORMAL",e[e.DEBUG=5]="DEBUG"}(n||(n={}));let o=0;const a=[];let l=null,c=null,u=null,d=NaN,h=n.WARNING,p=!1;function _(){return h}function m(){return p}function f(e){e=Math.max(n.ERROR,Math.min(n.DEBUG,e)),h=e,T()}function g(e,t){let i=a.reduce((e,t)=>e.concat(t),[]);return i.sort((e,t)=>e.id-t.id),void 0!==t&&(i=i.filter(e=>e.subSystemId===t)),"number"==typeof e&&(i=i.slice(-e)),i}function v(e){return new Date(e.timestamp).toISOString()+":"+e.subSystemId+":"+e.message.replace(/"/g,"'")}function S(e,t){return function(e,t){let i,r=0,s=0;for(i=e.length-1;i>=1&&(r+=8*(1+encodeURIComponent(e[i]).length),!(i-1>0&&(s=8*(1+encodeURIComponent(e[i-1]).length),r+s>t)));i--);return e.slice(i)}(g(e,t).map(v),75497472)}function y(e,t,i,r){if(t===c&&r.id===u)return;const s=new Date;if(e<=n.NORMAL&&function(e,t,i,r,s){const n={id:o,message:String(t),subSystemId:r,timestamp:Number(e)};o+=1,i.push(n),void 0!==s&&i.length>s&&i.splice(0,1)}(s,t,i,r.id,r.maxCount),e<=h&&(!r.highRate||m())&&(!l||r.id.match(l))){const i=s.toISOString()+":"+r.id+":"+t;switch(e){case n.DEBUG:console.debug(i);break;case n.INFO:case n.NORMAL:r.color?console.log("%c"+i,"color: "+r.color):console.log(i);break;case n.WARNING:console.warn(i);break;case n.ERROR:console.error(i)}c=t,u=r.id,d&&clearTimeout(d),d=setTimeout(()=>{c=null,u=null,d=NaN},1e3)}}function b(e,t={}){const i=[];a.push(i);const r=Object.assign(t,{id:e});function s(e){return t=>y(e,t,i,r)}return{logDebug:s(n.DEBUG),logError:s(n.ERROR),logInfo:s(n.INFO),logNormal:s(n.NORMAL),logWarn:s(n.WARNING)}}const w=b("logger"),P=r.lon=(e,t)=>{f(n.DEBUG),w.logNormal("Debug logging enabled"),p=Boolean(e),l=t||null,T()},C=r.loff=()=>{f(n.INFO),w.logInfo("Debug logging disabled")};function T(){try{s&&(localStorage.setItem("tv.logger.logHighRate",String(p)),localStorage.setItem("tv.logger.loglevel",String(h)))}catch(e){w.logWarn(`Cannot save logger state (level: ${h}, high-rate: ${p}) to localStorage: ${e.message}`)}}!function(){p=!!s&&"true"===localStorage.getItem("tv.logger.logHighRate");let e=parseInt(s&&localStorage.getItem("tv.logger.loglevel")||"");Number.isNaN(e)&&(e=n.WARNING),f(e),w.logNormal(`Init with settings - level: ${h}, high-rate: ${p}`)}(),r.performance&&r.performance.now?w.logNormal("Sync logger and perf times, now is "+r.performance.now()):w.logWarn("Perf time is not available")},32022:(e,t,i)=>{"use strict";function r(e,t,i,r){return`${r?r+" ":""}${i?i+" ":""}${e}px ${t}`}i.d(t,{makeFont:()=>r,
parseFont:()=>n});const s=/(bold )?(italic )?(\d+)(px|pt) (.*)$/;function n(e){const t=s.exec(e);return null===t?null:{family:t[5],size:parseInt(t[3])*("pt"===t[4]?.75:1),bold:Boolean(t[1]),italic:Boolean(t[2])}}},5958:(e,t,i)=>{"use strict";var r;i.d(t,{ConnectionStatus:()=>r}),function(e){e[e.Closed=0]="Closed",e[e.Connecting=1]="Connecting",e[e.Open=2]="Open"}(r||(r={}))},4950:(e,t,i)=>{"use strict";i.d(t,{PersistentTransport:()=>u});var r=i(5958),s=i(82713),n=i(65066),o=i.n(n),a=i(96276),l=i.n(a),c=i(98388);class u{constructor(e,t){this._url="",this._socket=null,this._reconnectCount=0,this._onlineCancellationToken=null,this._connectionStatus=new(o())(r.ConnectionStatus.Closed),this._socketCloseHandler=this._onCloseCallback.bind(this),this._socketErrorHandler=this._onErrorCallback.bind(this),this._socketOpenHandler=this._onOpenCallback.bind(this),this._socketMessageHandler=this._onMessageCallback.bind(this),this._maxReconnectReachedEventDelegate=new(l()),this._shouldReconnect=!0,this._maxReconnectCount=null,this._reconnectTimeoutId=0,this._connectAbortController=null,this._tryReconnect=()=>{if(this._disconnect(),this._shouldReconnect){const e=this._getReconnectTimeout();this._logger.logNormal(`Sleeping some time before reconnect ${e}ms`),this._reconnectTimeoutId=setTimeout(this._tryReconnectImpl.bind(this),e)}else this._logger.logNormal("Skip reconnecting because of shouldReconnect state")},this._onOfflineHandler=()=>{this._removeOnOfflineListener(),this._logger.logInfo("Network status changed to offline - trying to reconnect"),this._tryReconnect()},this._logger=t,this._messageHandler=e,window.addEventListener("unload",()=>{t.logNormal("Unload event comes - disconnecting without reconnect after that..."),this._shouldReconnect=!1,this._disconnect()},!1)}setUrl(e){if(this._url===e)return;const t=this._connectionStatus.value()!==r.ConnectionStatus.Closed;t&&this._disconnect(),this._url=e,t&&this.connect()}url(){return this._url}connect(){this._connectImpl()}setMaxReconnectCount(e){this._maxReconnectCount=e}connectionStatus(){return this._connectionStatus.readonly()}disconnect(){this._shouldReconnect=!1,this._disconnect()}maxReconnectReachedEvent(){return this._maxReconnectReachedEventDelegate}async _prepareParamsForConnection(e){}_disconnect(){var e;null===(e=this._connectAbortController)||void 0===e||e.abort(),this._connectAbortController=null,clearTimeout(this._reconnectTimeoutId),this._reconnectTimeoutId=0,this._connectionStatus.value()!==r.ConnectionStatus.Closed?this._socket?(this._logger.logNormal(`Closing connection to: ${this._socket.url}, currentStatus: ${r.ConnectionStatus[this._connectionStatus.value()]}`),this._disconnectTransport()):this._logger.logNormal("Disconnecting without socket - probably within preparing, it should be already scheduled for aborting"):this._logger.logNormal("Attempt to close connection but it is closed already")}_onErrorCallback(){this._logger.logInfo("Connection is closed by error"),this._tryReconnect()}_onCloseCallback(e){
this._logger.logInfo(`Connection is closed - code=${e.code} msg=${e.reason}`),this._tryReconnect()}_tryReconnectImpl(){return null!==this._maxReconnectCount&&this._reconnectCount===this._maxReconnectCount?(this._logger.logWarn("Maximum attempts to reconnect to websocket reached"),void this._maxReconnectReachedEventDelegate.fire()):(this._reconnectCount+=1,this._logger.logInfo("Reconnecting count: "+this._reconnectCount),navigator.onLine?(this._logger.logInfo("Network status: online - trying to connect"),void this.connect()):(this._logger.logInfo("Network status: offline - wait until online"),void(this._onlineCancellationToken=(0,s.callWhenOnline)(()=>{this._logger.logInfo("Network status changed to online - trying to connect"),this.connect()}))))}_onOpenCallback(){this._logger.logNormal("Connection opened"),this._reconnectCount=0,this._connectionStatus.setValue(r.ConnectionStatus.Open)}_onMessageCallback(e){this._messageHandler(e.data)}_getReconnectTimeout(){return this._reconnectCount<5?300:5e3}_setOnOfflineListener(){window.addEventListener("offline",this._onOfflineHandler)}_removeOnOfflineListener(){window.removeEventListener("offline",this._onOfflineHandler)}async _connectImpl(){if(this._connectionStatus.value()!==r.ConnectionStatus.Closed)return void this._logger.logNormal("Attempt to open connection but it is not closed");this._socket&&(this._logger.logError("Something went wrong - code 0x2"),this.disconnect()),this._onlineCancellationToken&&(this._onlineCancellationToken(),this._onlineCancellationToken=null),this._logger.logNormal("Connecting to "+this._url),this._shouldReconnect=!0,this._connectAbortController=new AbortController;const e=this._connectAbortController.signal;try{if(this._connectionStatus.setValue(r.ConnectionStatus.Connecting),await this._prepareParamsForConnection(e),e.aborted)throw(0,c.createAbortError)();this._socket=this._createNativeTransport(this._url),this._setOnOfflineListener()}catch(e){this._connectionStatus.setValue(r.ConnectionStatus.Closed),(0,c.skipAbortError)(e)}finally{this._connectAbortController=null}}}},29412:(e,t,i)=>{"use strict";function r(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}i.d(t,{regExpEscape:()=>r})},82755:(e,t,i)=>{"use strict";i.r(t),i.d(t,{isRtl:()=>s,stripLTRMarks:()=>o,startWithLTR:()=>a,forceLTRStr:()=>l,forceLTRStrSsr:()=>c,forceRTLStr:()=>u,getLTRScrollLeft:()=>d,getLTRScrollLeftOffset:()=>h,detectAutoDirection:()=>m});var r=i(46417);const s=()=>"rtl"===window.document.dir,n=new RegExp("‎|‪|‫|‬","g");function o(e){return""!==e&&s()&&null!=e?e.replace(n,""):e}function a(e){return""!==e&&s()&&null!=e?"‎"+e:e}function l(e){return""!==e&&s()&&null!=e?"‪"+e+"‬":e}function c(e){return"‪"+e+"‬"}function u(e){return""!==e&&s()&&null!=e?"‫"+e+"‬":e}function d(e){return(0,r.getNormalizedScrollLeft)(e,"rtl")}function h(e,t){const i=(0,r.detectScrollType)();if("indeterminate"===i)return 0;switch(i){case"negative":t=e.clientWidth-e.scrollWidth+t;break;case"reverse":t=e.scrollWidth-e.clientWidth-t}return t}
const p=/[^\u0000-\u0040\u005B-\u0060\u007B-\u00BF\u00D7\u00F7\u02B9-\u02FF\u2000-\u200E\u2010-\u2029\u202C\u202F-\u2BFF]/,_=/[\u0590-\u07FF\u200F\u202B\u202E\uFB1D-\uFDFD\uFE70-\uFEFC]/;function m(e){const t=p.exec(e);return t?_.test(t[0])?"rtl":"ltr":""}},71928:(e,t,i)=>{"use strict";i.r(t),i.d(t,{CubicBezier:()=>r.CubicBezier,color:()=>r.color,dur:()=>r.dur,easingFunc:()=>r.easingFunc});var r=i(69388)},65754:(e,t,i)=>{"use strict";var r;i.d(t,{BillingCycle:()=>r}),function(e){e.Monthly="m",e.ThreeMonths="3m",e.OneYear="y",e.TwoYears="2y"}(r||(r={}))},60555:(e,t,i)=>{"use strict";i.d(t,{getCountries:()=>n});var r=i(85864);let s=null;async function n(){var e;if(null!==s)return s;const t=await(0,r.fetch)("/accounts/countries/",{credentials:"include"});if(!t.ok){const e=await t.json();throw Error(String(e))}const i=await t.json();return s={...i,current_country_code:null!==(e=i.current_country_code)&&void 0!==e?e:"US"},s}},15642:(e,t,i)=>{"use strict";i.d(t,{OFFERS:()=>r,OfferKind:()=>s});const r={trial:"trial",early_access:"early_access",upsell:"upsell",black_friday:"black_friday",cyber_monday:"cyber_monday",custom_discount:"custom_discount",longer_cycle:"longer_cycle",upgrade:"upgrade",last_chance:"last_chance",one_usd:"one_usd",six_months:"six_months"},s={early_access:"early_access",black_friday:"black_friday",last_chance:"last_chance",one_usd:"1 usd offer",six_months:"six_months",custom_discount:"custom_discount"}},8276:(e,t,i)=>{"use strict";var r,s,n;i.d(t,{ProPlans:()=>r,BrokerPlansIds:()=>n}),function(e){e.Free="free",e.Pro="pro",e.ProTrial="pro_trial",e.ProRealtime="pro_realtime",e.ProRealtimeTrial="pro_realtime_trial",e.ProPremium="pro_premium",e.ProPremiumTrial="pro_premium_trial",e.ProMiniAlerts="pro_mini_alerts",e.ProMiniAds="pro_mini_ads",e.ProMiniLayouts="pro_mini_layouts",e.ProEdu="pro_edu"}(r||(r={})),function(e){e.Platinum="platinum",e.Gold="gold",e.Silver="silver",e.Free="free"}(s||(s={})),function(e){e[e.Platinum=3]="Platinum",e[e.Gold=2]="Gold",e[e.Silver=1]="Silver",e[e.Free=0]="Free"}(n||(n={}))},30511:(e,t,i)=>{"use strict";function r(e,t){const i=t||window.locale||"en";let r=e[i]?e[i]:e.en;return r="tradingview.com"===r?"www.tradingview.com":r,r?document.location.protocol+"//"+r:""}i.d(t,{determineBaseUrl:()=>r})},44937:(e,t,i)=>{"use strict";function r(){return Promise.all([i.e(23876),i.e(26822),i.e(69756),i.e(88278),i.e(63193),i.e(61212),i.e(85597),i.e(82614),i.e(73935),i.e(43424),i.e(19894),i.e(32077)]).then(i.bind(i,53672))}i.d(t,{loadChangeIntervalDialog:()=>r})},21331:(e,t,i)=>{"use strict";i.d(t,{showChangeIntervalDialogAsync:()=>n});var r=i(44937);let s=null;function n(e){const t=s=(0,r.loadChangeIntervalDialog)().then(i=>{t===s&&i.showChangeIntervalDialog(e)});return t}},66967:(e,t,i)=>{"use strict";function r(){return i.e(45702).then(i.bind(i,98426))}function s(e){r().then(t=>t.showDisconnectedMessage(e))}function n(e){r().then(t=>t.showCriticalErrorMessage(e))}i.r(t),i.d(t,{showDisconnectedMessage:()=>s,showCriticalErrorMessage:()=>n})},47107:(e,t,i)=>{"use strict";function r(e){
return Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(63193),i.e(52802),i.e(61212),i.e(85597),i.e(94595),i.e(94269),i.e(99305),i.e(40587),i.e(98755),i.e(69602),i.e(81778),i.e(86333),i.e(29082),i.e(82321),i.e(74323),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(36982),i.e(19894),i.e(27420),i.e(53011),i.e(91050),i.e(62348),i.e(15623),i.e(91859)]).then(i.bind(i,34265)).then(t=>t.showGoToDateDialog(e))}i.d(t,{showGoToDateDialog:()=>r})},1073:(e,t,i)=>{"use strict";async function r(e){(await Promise.all([i.e(23876),i.e(26822),i.e(69756),i.e(88278),i.e(74814),i.e(36778),i.e(18436),i.e(92907),i.e(73935),i.e(43424),i.e(26066)]).then(i.bind(i,20366))).renderGoToTradingViewReferralDialog(e)}i.d(t,{showGoToTradingViewReferralDialog:()=>r})},23946:(e,t,i)=>{"use strict";async function r(e){var t;const r=await Promise.all([i.e(23876),i.e(26822),i.e(69756),i.e(88278),i.e(74814),i.e(36778),i.e(18436),i.e(3178),i.e(93576),i.e(73935),i.e(43424),i.e(14563),i.e(38578),i.e(98762),i.e(78451),i.e(5246)]).then(i.bind(i,55175));await(null===(t=window.pro)||void 0===t?void 0:t.ensureValidShopConf()),r.renderGoproDialog(e)}i.d(t,{createGoProDialog:()=>r}),window.TradingView.createGoProDialog=r},42926:(e,t,i)=>{"use strict";var r,s;i.d(t,{PredefinedAction:()=>r,ContentAlign:()=>s}),function(e){e.Close="close",e.OpenGopro="openGopro"}(r||(r={})),function(e){e.Center="center",e.Left="left"}(s||(s={}))},88674:(e,t,i)=>{"use strict";i.r(t),i.d(t,{createNoticeDialog:()=>n,showNoticeDialog:()=>o});var r=i(20220);const s={width:400,destroyOnClose:!0,title:(0,r.t)("Notification"),content:(0,r.t)("You are notified"),contentWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--no-border"><div class="tv-text"><p></p></div></div>',actionsWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--actions tv-dialog__section--no-border">',actions:[{name:"ok",type:"primary",text:(0,r.t)("Ok"),method:"close",key:[13,32]}]};async function n(e){return(await Promise.all([i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(38817),i.e(466),i.e(64011),i.e(44740),i.e(94795),i.e(13469),i.e(34834)]).then(i.bind(i,64161))).createDialog({...s,...e})}function o(e){n(e).then(e=>e.open())}},28308:(e,t,i)=>{"use strict";function r(e){return Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(32795),i.e(91877),i.e(63193),i.e(61212),i.e(85597),i.e(45266),i.e(60700),i.e(74814),i.e(99305),i.e(36778),i.e(90901),i.e(38968),i.e(40587),i.e(70650),i.e(39409),i.e(97259),i.e(52951),i.e(55318),i.e(85833),i.e(93921),i.e(58748),i.e(28647),i.e(42732),i.e(4351),i.e(26566),i.e(22124),i.e(35583),i.e(62124),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(14563),i.e(36982),i.e(19894),i.e(53011),i.e(52616),i.e(91050),i.e(9622),i.e(34698),i.e(68981),i.e(1114),i.e(91712),i.e(93669),i.e(51308),i.e(48418),i.e(36073),i.e(84534),i.e(26726),i.e(13985),i.e(39476),i.e(62932),i.e(78703)]).then(i.bind(i,6878)).then(t=>t.openPaymentOrderDialog(e))}i.d(t,{showPaymentOrderDialog:()=>r})},
77541:(e,t,i)=>{"use strict";var r;i.d(t,{StatusExtraData:()=>r}),function(e){e.Enable="enable",e.Disable="disable"}(r||(r={}))},80271:(e,t,i)=>{"use strict";i.d(t,{check:()=>s});var r=i(60555);async function s(){const{is_restricted:e}=await(0,r.getCountries)();return e}},90645:(e,t,i)=>{"use strict";i.r(t),i.d(t,{showRestrictedCountryNotificationDialog:()=>n});var r=i(20220),s=i(79407);function n(){(0,s.showWarning)({title:(0,r.t)("We can't accept your payment right now"),text:(0,r.t)("TradingView needs to comply with U.S. trade embargoes and economic sanctions, so we're unable to accept any payments from the region you're in at the moment.")})}},82143:(e,t,i)=>{"use strict";function r(){return Promise.all([i.e(13523),i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(38817),i.e(39409),i.e(54551),i.e(59678),i.e(53617),i.e(78918),i.e(37653),i.e(6585),i.e(94782),i.e(40114),i.e(80842),i.e(73935),i.e(466),i.e(64011),i.e(44740),i.e(94795),i.e(13469),i.e(45623),i.e(24194),i.e(41242),i.e(4516),i.e(38140),i.e(92765),i.e(40604),i.e(37620),i.e(95848),i.e(52946),i.e(80643),i.e(55490),i.e(24025)]).then(i.t.bind(i,93533,19))}function s(e,t,i){r().then(r=>r.noteForAuthor(e,t,i))}function n(e,t,i){r().then(r=>r.openPMDialog(e,t,i))}function o(){r().then(e=>e.newPrivateChatDialog())}i.d(t,{noteForAuthor:()=>s,openPMDialog:()=>n,newPrivateChatDialog:()=>o})},14764:(e,t,i)=>{"use strict";i.d(t,{showDeleteStudyTreeConfirm:()=>s});var r=i(79407);function s(e){(0,r.showConfirm)({title:window.t("Confirm Remove Study Tree"),text:window.t("Do you really want to delete study and all of it's children?"),onConfirm:({dialogClose:t})=>{e(),t()}})}},28709:(e,t,i)=>{"use strict";i.d(t,{showGoProAlertsOnSecondsDialog:()=>s});var r=i(23946);function s(){(0,r.createGoProDialog)({feature:"alertsOnSeconds"})}},6450:(e,t,i)=>{"use strict";i.d(t,{showTooManyStudiesNotice:()=>a});var r=i(20220),s=i(3851),n=i(5803),o=i(79407);function a(e){"number"!=typeof e&&(e=TradingView.STUDY_COUNT_LIMIT,e=(0,s.getConfig)(n.ProductFeatures.STUDY_ON_STUDY).limit),(0,o.showWarning)({title:(0,r.t)("Warning"),text:(0,r.t)("Studies limit exceeded: {number} studies per layout.\nPlease, remove some studies.").format({number:e})})}},71141:(e,t,i)=>{"use strict";i.r(t),i.d(t,{showSignModal:()=>s,isSignModalOpen:()=>n});let r=()=>!1;async function s(e){if(window.TVD&&window.TVD.signIn)return window.TVD.signIn(e);{const t=await Promise.all([i.e(99752),i.e(59456),i.e(91877),i.e(25535),i.e(70964),i.e(54551),i.e(9029),i.e(85113),i.e(14563),i.e(466),i.e(94795),i.e(13469),i.e(23600),i.e(76809),i.e(36123)]).then(i.bind(i,32665));return r=t.isSignModalOpen,t.showSignModal(e)}}function n(){return r()}},89381:(e,t,i)=>{"use strict";i.d(t,{StudyMarket:()=>o});var r=i(66661),s=i(65066),n=i.n(s);class o{constructor(e,t){this._visibility=new(n())(!1),this._dialogPromise=null,this._dialog=null,this._chartWidgetCollection=e,this._options=t,this._indicatorsPreloader=new r.IndicatorsPreloader(e)}visible(){return this._visibility.readonly()}show(e){var t
;const i=this._indicatorsPreloader.getIndicatorPromises();null===this._dialog&&this._requestDialog(e),null===(t=this._dialog)||void 0===t||t.open(e,i)}hide(){var e;null===(e=this._dialog)||void 0===e||e.hide()}resetAllPages(){var e;null===(e=this._dialog)||void 0===e||e.resetAllStudies()}_requestDialog(e){var t;if(null===this._dialogPromise){let r;r=(null===(t=this._options)||void 0===t?void 0:t.onWidget)?Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(52802),i.e(43894),i.e(33996),i.e(94595),i.e(94269),i.e(55442),i.e(19843),i.e(26992),i.e(96271),i.e(93228),i.e(2359),i.e(10446),i.e(63660),i.e(502),i.e(24468),i.e(38954),i.e(13990),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(27420),i.e(9881),i.e(38464),i.e(9394),i.e(12503),i.e(38012),i.e(6456)]).then(i.bind(i,57391)).then(e=>new e.IndicatorsLibraryContainer(this._chartWidgetCollection,this._options)):Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(52802),i.e(43894),i.e(33996),i.e(94595),i.e(94269),i.e(55442),i.e(19843),i.e(26992),i.e(96271),i.e(93228),i.e(2359),i.e(10446),i.e(63660),i.e(502),i.e(24468),i.e(38954),i.e(13990),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(27420),i.e(9881),i.e(38464),i.e(9394),i.e(12503),i.e(38012),i.e(6456)]).then(i.bind(i,20301)).then(e=>new e.IndicatorsContainer(this._chartWidgetCollection)),this._dialogPromise=r.then(t=>{this._dialog=t,this._dialog.visible().subscribe(e=>{this._visibility.setValue(e)}),this._dialog.open(e)})}return this._dialogPromise}}},55034:(e,t,i)=>{"use strict";function r(e,t){Promise.all([i.e(23876),i.e(26822),i.e(69756),i.e(88278),i.e(84479),i.e(48252),i.e(73935),i.e(43424),i.e(9374)]).then(i.t.bind(i,3688,19)).then(i=>{i.showSymbolInfoDialog(e,t)})}i.d(t,{showSymbolInfoDialog:()=>r})},31672:(e,t,i)=>{"use strict";async function r(e){return(await Promise.all([i.e(99459),i.e(69756),i.e(99752),i.e(59456),i.e(91877),i.e(63193),i.e(61212),i.e(25535),i.e(85597),i.e(60700),i.e(70964),i.e(74814),i.e(99305),i.e(90901),i.e(70650),i.e(85833),i.e(42732),i.e(49406),i.e(73935),i.e(14563),i.e(466),i.e(19894),i.e(53011),i.e(94795),i.e(13469),i.e(9622),i.e(34698),i.e(68981),i.e(93669),i.e(51308),i.e(2598),i.e(68606)]).then(i.bind(i,84087))).createPhoneDialog(e)}async function s(e){return(await Promise.all([i.e(99459),i.e(69756),i.e(99752),i.e(59456),i.e(91877),i.e(63193),i.e(61212),i.e(25535),i.e(85597),i.e(60700),i.e(70964),i.e(74814),i.e(99305),i.e(90901),i.e(70650),i.e(85833),i.e(42732),i.e(49406),i.e(73935),i.e(14563),i.e(466),i.e(19894),i.e(53011),i.e(94795),i.e(13469),i.e(9622),i.e(34698),i.e(68981),i.e(93669),i.e(51308),i.e(2598),i.e(68606)]).then(i.bind(i,84087))).createEmailDialog(e)}i.d(t,{createPhoneDialog:()=>r,createSMSEmailDialog:()=>s})},22817:(e,t,i)=>{"use strict";var r;i.d(t,{PublishIntroDialogContent:()=>r}),function(e){e.Idea="ideaPublishing",e.Script="scriptPublishing",e.Stream="startStreaming",e.VideoIdea="videoIdeaPublishing"}(r||(r={}))},85622:(e,t,i)=>{"use strict";i.d(t,{paidAccountCheck:()=>n})
;var r=i(55119);const s=(0,i(87380).getLogger)("PaidAccountCheck");async function n(e){const t=window.user,n=r.TVLocalStorage.getItem("previous_username");if(t&&window.is_authenticated&&!t.is_pro&&n){const[{getProfile:t},{showWrongAccountDialog:r}]=await Promise.all([i.e(90254).then(i.bind(i,27358)),Promise.all([i.e(90530),i.e(14563),i.e(12019)]).then(i.bind(i,86273))]);try{const i=await t(n);if(Boolean(i.pro_plan))return r({userName:n,isNeedCancelButton:e.isNeedCancelButton,successButtonText:e.successButtonText})}catch(e){s.logError(e.message)}}return Promise.resolve(!0)}},51612:(e,t,i)=>{"use strict";var r=i(18184);const s=i(87380).getLogger("Chart.FollowSymbolsButton"),n=i(65009).trackActionFollow,o=i(78264).followSymbol;!function(){var e={};function t(t){if(!t.symbol)return r.Deferred().reject().promise();if(null==t.follow&&Object.prototype.hasOwnProperty.call(e,t.symbol))return e[t.symbol].promise;var i=r.Deferred(),s=i.promise();return e[t.symbol]||(e[t.symbol]={}),e[t.symbol].promise=s,o(t).then(r=>{r.error?i.reject(r):(i.resolve(r),r.symbol!==t.symbol&&(e[r.symbol]=e[t.symbol]))}).catch(()=>{i.reject.apply(i,arguments)}),s}function i(e,i){return t({symbol:e,follow:+!!i}).done((function(t){var i=t.followTheSymbol;a(e,i)})).promise()}function a(e,t){r(".js-follow-symbol").each((function(){var i=r(this);i.data("symbol")===e&&c(i,t)}))}function l(){for(var t in e)delete e[t];c(r(".js-follow-symbol"),!1)}function c(e,t){t=!!t,e.each((function(){var e=r(this);e.toggleClass("js-follow-symbol--followed",t).toggleClass(e.data("follow-symbol-button-followed-style-class")?e.data("follow-symbol-button-followed-style-class"):"i-checked",t)}))}r(document).on("click",".js-follow-symbol",(function(e){var t=r(this),s=t.data("symbol"),o=t.data("type");s&&runOrSignIn((function(){var e=function(e){return e.hasClass("js-follow-symbol--followed")}(t),r=i(s,!e),a=e?"Unfollow":"Follow",l={symbol:s,symbolType:o};c(t,!e),n("Symbol",a,l),r.fail((function(){c(t,e)}))}),{source:"Follow symbol button"})})),TradingView.FollowSymbols={changeState:i,makeButton:function(e){var i=(e=e||{}).$button,n=e.symbol;return i?(i.addClass("js-follow-symbol tv-button tv-button--success"),n||(n=i.data("symbol"))):i=r('<span class="js-follow-symbol tv-button tv-button--success">'),i.data({"follow-symbol-button-followed-style-class":"i-checked","follow-symbol-button-change-text":void 0===e.changeText||!!e.changeText}),n?(t({symbol:n}).pipe((function(e){i.attr("data-symbol",e.symbol),c(i,e.followTheSymbol)})),i):(s.logError("symbol is required"),i)},request:t},r((function(){loginStateChange.subscribe(TradingView.FollowSymbols,(function(i){i||(window.is_authenticated?(l(),r(".js-follow-symbol").each((function(){var i=r(this).data("symbol");i&&(Object.prototype.hasOwnProperty.call(e,i)||t({symbol:i}).done((function(e){a(e.symbol,e.followTheSymbol)})))}))):l())}))}))}()},38140:(e,t,i)=>{"use strict";i.d(t,{getSymbolPagePath:()=>o,makeSymbolChartUrl:()=>p,makeSymbolPageUrl:()=>h,makeSymbolTechnicalsPageUrl:()=>_,makeTemplateSymbolUrl:()=>u})
;var r=i(44990),s=i(30511),n=i(50284);function o(e,t){return l(c(e,t),a(e))}function a(e){const t={shortName:e.shortName,exchange:e.exchange,proName:e.proName,type:e.type};return e.proName&&e.proName.includes(":")&&([t.exchange,t.shortName]=e.proName.split(":")),t}function l(e,t){const i=encodeURIComponent(t.shortName||""),r=encodeURIComponent(t.exchange||""),s=encodeURIComponent(t.proName||"");return e.replace("{tvexchange}",r).replace("{tvsymbol}",i).replace("{tvprosymbol}",s)}function c(e,t=""){const i=["UKOIL","USOIL","XAGAUD","XAGCAD","XAGCHF","XAGEUR","XAGGBP","XAGHKD","XAGJPY","XAGUSD","XAUAUD","XAUCAD","XAUCHF","XAUEUR","XAUGBP","XAUHKD","XAUJPY","XAUNZD","XAUUSD","XPDUSD","XPTUSD","SPX"];return e.type&&["spread","expression"].includes(e.type)?e.proName?"/symbols/spread/{tvprosymbol}/"+t:"/"+t:void 0===e.shortName&&void 0===e.proName?(console.warn("Params missed"),"/"):m(e)?e.exchange?"/symbols/{tvsymbol}/?exchange={tvexchange}":"/symbols/{tvsymbol}/"+t:e.exchange||e.proName?e.shortName&&i.includes(e.shortName)?"/symbols/{tvsymbol}/"+t:"/symbols/{tvexchange}-{tvsymbol}/"+t:"/symbols/{tvsymbol}/"+t}function u(e,t){let i=e;if(!/{tvsymbol}|{tvexchange}|{tvprosymbol}/.test(e)){let r="tvprosymbol";void 0===t.proName&&(r="tvsymbol"),i=`${e}?tvwidgetsymbol={${r}}`}const r=l(i,a(t));if(!(0,n.isSafeUrl)(r))throw new Error(`The symbol URL ${r} is not allowed.`);return r}function d(e,t,i,n){const o=(window.locale_domains?(0,s.determineBaseUrl)(window.locale_domains,n):window.location.origin)+l(e,a(t));return i?(0,r.addUtmToUrl)(o,i):o}function h(e,t,i,r){return d(c(e,r),e,t,i)}function p(e,t){return d("/chart/?symbol={tvprosymbol}",e,t)}function _(e,t,i){return h(e,t,i,"technicals/")}function m(e){return!!e.type&&(t=e.type,["forex","bitcoin","crypto"].includes(t));var t}},24194:(e,t,i)=>{"use strict";i(20220),i(68421);var r=i(30381),s=i(57014),n=s.WeekDays,o=s.Months,a=i(80697),l=a.monthsFullNames,c=a.monthsShortNames,u=a.weekDaysFullNames,d=a.weekDaysShortNames,h=a.weekDaysMiniNames;window.language&&(r.locale(window.language,{months:[l[o.JANUARY],l[o.FEBRUARY],l[o.MARCH],l[o.APRIL],l[o.MAY],l[o.JUNE],l[o.JULY],l[o.AUGUST],l[o.SEPTEMBER],l[o.OCTOBER],l[o.NOVEMBER],l[o.DECEMBER]],monthsShort:[c[o.JANUARY],c[o.FEBRUARY],c[o.MARCH],c[o.APRIL],c[o.MAY],c[o.JUNE],c[o.JULY],c[o.AUGUST],c[o.SEPTEMBER],c[o.OCTOBER],c[o.NOVEMBER],c[o.DECEMBER]],weekdays:[u[n.SUNDAY],u[n.MONDAY],u[n.TUESDAY],u[n.WEDNESDAY],u[n.THURSDAY],u[n.FRIDAY],u[n.SATURDAY]],weekdaysShort:[d[n.SUNDAY],d[n.MONDAY],d[n.TUESDAY],d[n.WEDNESDAY],d[n.THURSDAY],d[n.FRIDAY],d[n.SATURDAY]],weekdaysMin:[h[n.SUNDAY],h[n.MONDAY],h[n.TUESDAY],h[n.WEDNESDAY],h[n.THURSDAY],h[n.FRIDAY],h[n.SATURDAY]],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MMM D",l:"M/D/YYYY",LL:"MMM D, YYYY",ll:"MMM D LT",LLL:"LT - LL",lll:"MMM D, YYYY LT",LLLL:"ddd D MMMM YYYY LT",llll:"ddd D MMM YYYY LT"},calendar:{sameDay:window.t("{specialSymbolOpen}Today at{specialSymbolClose} {dayTime}").format({specialSymbolOpen:"[",specialSymbolClose:"]",dayTime:"LT"}),
nextDay:window.t("{specialSymbolOpen}Tomorrow at{specialSymbolClose} {dayTime}").format({specialSymbolOpen:"[",specialSymbolClose:"]",dayTime:"LT"}),nextWeek:window.t("{dayName} {specialSymbolOpen}at{specialSymbolClose} {dayTime}").format({specialSymbolOpen:"[",specialSymbolClose:"]",dayTime:"LT",dayName:"dddd"}),lastDay:window.t("{specialSymbolOpen}Yesterday at{specialSymbolClose} {dayTime}").format({specialSymbolOpen:"[",specialSymbolClose:"]",dayTime:"LT"}),lastWeek:window.t("{specialSymbolOpen}Last{specialSymbolClose} {dayName} {specialSymbolOpen}at{specialSymbolClose} {dayTime}").format({specialSymbolOpen:"[",specialSymbolClose:"]",dayTime:"LT",dayName:"dddd"}),sameElse:"L"},relativeTime:{future:function(e){return e===window.t("just now")?e:window.t("in %s",{context:"time_range"}).replace("%s",e)},past:function(e){return e===window.t("just now")?e:window.t("%s ago",{context:"time_range"}).replace("%s",e)},s:window.t("just now"),m:function(e){return window.t("%d minute",{plural:"%d minutes",count:e}).replace("%d",e)},mm:function(e){return window.t("%d minute",{plural:"%d minutes",count:e}).replace("%d",e)},h:window.t("an hour"),hh:function(e){return window.t("%d hour",{plural:"%d hours",count:e}).replace("%d",e)},d:window.t("a day"),dd:function(e){return window.t("%d day",{plural:"%d days",count:e}).replace("%d",e)},M:window.t("a month"),MM:function(e){return window.t("%d month",{plural:"%d months",count:e}).replace("%d",e)},y:window.t("a year"),yy:function(e){return window.t("%d year",{plural:"%d years",count:e}).replace("%d",e)}},week:{dow:1,doy:4}}),r.locale(window.language)),e.exports=r},23619:(e,t,i)=>{"use strict";i.d(t,{verificationIsRequired:()=>d,whenVerified:()=>h,requestPhoneNumber:()=>p});var r=i(29098),s=i(31672),n=i(55119),o=i(18184),a=i(22842);let l=o.Deferred();function c(e,t){var i=TVSettings.getBool("_phone_verif_dlg_initial",!0);TVSettings.setValue("_phone_verif_dlg_initial",!1),(0,r.trackEvent)("Phone verification",e+(i?" initial":""),t)}function u(e){const t=o.Deferred();return(0,s.createPhoneDialog)({featureSource:e.source,doNotShowConfirmation:e.doNotShowConfirmation}).then(i=>{i.on("afterOpen",()=>c("Show dialog",e.source)).on("verification:success",i=>{t.resolve(i),c("Verified",e.source)}).on("verification:cancel",()=>{t.reject("cancelled"),c("Cancelled",e.source)}).on("verification:codeExpired",()=>c("Show dialog",e.source)).open()}),t}function d(e={}){return new Promise(t=>{!window.is_authenticated||user.is_staff||user.is_superuser||user.is_pro||user.is_moderator?t([!1]):e.customPhoneCheck?e.customPhoneCheck()?t([!0,"date-joined"]):t([!1]):a.enabled("phone_verification")&&!user.has_phone?!0!==e.doNotCheckSocialActivity?t([!0,"date-joined"]):(!0!==e.doNotCheckSuspicious&&t([Boolean(n.TVLocalStorage.getItem("is_suspicious")),"suspicious"]),t([!0,"default"])):t([!1])})}function h(e={}){const t=o.Deferred();return d({doNotCheckSuspicious:e.doNotCheckSuspicious,doNotCheckSocialActivity:e.doNotCheckSocialActivity,customPhoneCheck:e.customPhoneCheck}).then(([i,r])=>{if(!i)return l.resolve(),
t.resolve();if(i&&e.silentPhoneVerification)return t.reject("phone_verification_required");if(!e.showDialog)return l.done(()=>t.resolve());const s={source:e.source,doNotShowConfirmation:e.doNotShowConfirmation};"suspicious"!==r&&(s.topMessage=window.t("Verify your phone number and get access to more tools on TradingView.")),u(s).done(()=>t.resolve()).always(()=>t.reject("phone_verification_declined"))}).catch(e=>e),t.promise()}function p(e={}){return new Promise((t,i)=>{u(e).done(t).always(i)})}window.loginStateChange&&loginStateChange.subscribe(null,()=>{window.is_authenticated&&(l=o.Deferred(),d().then(([e,t])=>{e||l.resolve()}))})},2188:(e,t,i)=>{"use strict";var r=i(85864).fetch,s=i(84257).visitPaymentPage,n=i(65754).BillingCycle,o=i(96276),a=i(4346).getFreshInitData;i(60272);var l=a();function c(e){if(this._freeProductIds=["tv-scripting","tv-basicstudies","tv-prostudies","Script$USER","Script$EDGR","ESD$TV"],this.packagesUpdated=new o,!e)return this._products=this._discounts={},void(this._offers=this._order=[]);this._products={},this._discounts={},this._offers=e.offers,this._order=[],this._invalidShopConf=!0,"undefined"!=typeof window&&window.loginStateChange.subscribe(this,this.onLoginStateChange)}c.prototype.PRODUCT_TYPES={pro_plan:1,study_package:2,news_feed:3,exchange:4,connection:6,coins:8},c.prototype.updateShopConf=function(e){return this._shopConfPromise||(this._shopConfPromise=r("/market/shopconf/",{credentials:"include"}).then((function(e){return e.json()})).then(function(t){this._products=t.all_products&&JSON.parse(t.all_products)||{},this._discounts=t.discounts&&JSON.parse(t.discounts)||{},this._offers=t.offers&&JSON.parse(t.offers)||[],this._order=t.order&&JSON.parse(t.order)||[],this._invalidShopConf=!1,delete this._shopConfPromise,e||this.packagesUpdated.fire()}.bind(this)).catch(function(){delete this._shopConfPromise}.bind(this))),this._shopConfPromise},c.prototype.invalidateShopConf=function(){this._invalidShopConf=!0},c.prototype.isInvalidShopConf=function(){return!!this._invalidShopConf},c.prototype.ensureValidShopConf=function(){return new Promise(function(e){return this.runOrUpdate(e)}.bind(this))},c.prototype.onLoginStateChange=function(e){e||this.updateShopConf()},c.prototype.runOrUpdate=function(e,t){this.isInvalidShopConf()?this.updateShopConf(t).then(e):e()},c.prototype.getIDCExchanges=function(e){var t=this._products;if(l)if(e){if(l.idc_delay_exchanges_list)return l.idc_delay_exchanges_list}else if(l.idc_exchanges_list)return l.idc_exchanges_list;return Object.keys(t).filter((function(i){return e?t[i].idc_service_codes_delay:t[i].idc_service_codes})).map((function(e){return t[e].exchange}))},c.prototype.getProduct=function(e){if(e in this._products)return this._products[e];if(this.isDiscountProductId(e)){var t=this._discounts[e],i=Object.assign({discount_text_id:e},this._products[t.product]);return t.cost&&(i.cost=t.cost),t.cost_annual&&(i.cost_annual=t.cost_annual),t.cost_biennial&&(i.cost_biennial=t.cost_biennial),void 0!==t.fixed_cost&&(i.fixed_cost=t.fixed_cost),
void 0!==t.extra_days&&(i.extra_days=t.extra_days),void 0!==t.billing_cycle&&(i.billing_cycle=t.billing_cycle),i}return{}},c.prototype.findProduct=function(e){return new Promise(function(t){var i=function(){t(this.getProduct(e))}.bind(this);if(!this.isInvalidShopConf())return i();this.updateShopConf().then(i).catch(i)}.bind(this))},c.prototype.isProductDefined=function(e){return!(!e||!Object.keys(e).length)},c.prototype.getDiscountProduct=function(e){return this._discounts[e]||{}},c.prototype.isOffer=function(e,t){var i=this._discounts;return Object.keys(i).filter((function(e){return!i[e].expired&&i[e].offer_type===t})).includes(e)},c.prototype.getProductId=function(e){return e&&(e.discount_text_id||e.text_id)||""},c.prototype.isDiscountProductId=function(e){return e in this._discounts},c.prototype.isPlan=function(e){return e.type===this.PRODUCT_TYPES.pro_plan},c.prototype.isExchange=function(e){return e.type===this.PRODUCT_TYPES.exchange},c.prototype.getActiveExchanges=function(){return this.getProductsByType(this.PRODUCT_TYPES.exchange).filter((function(e){return!e.disabled&&Boolean(e.cost)}))},c.prototype.getExchange=function(e){for(var t,i=this.getProductsByType(this.PRODUCT_TYPES.exchange),r=0;r<i.length;r+=1)if((t=i[r]).exchange===e||t.included_exchanges&&t.included_exchanges.includes(e))return t;return{}},c.prototype.getCost=function(e,t){var i=1;if(n.TwoYears===t){if(e.fixed_cost||(i=24),e.cost_biennial)return e.cost_biennial*i;if(e.cost_annual)return e.cost_annual*i}else if(n.OneYear===t){if(e.fixed_cost||(i=12),e.cost_annual)return e.cost_annual*i}else n.ThreeMonths===t&&(e.fixed_cost||(i=3));return e.cost,e.cost*i},c.prototype.getProductsByType=function(e){return Object.keys(this._products).filter((function(t){return this._products[t].type===e}),this).map((function(e){return this.getProduct(e)}),this).sort((function(e,t){return t.order>e.order?-1:t.order<e.order?1:0}))},c.prototype.getProPlans=function(e){return this.getProductsByType(this.PRODUCT_TYPES.pro_plan).filter((function(t){return!e||!t.is_limited})).map((function(e){return e.text_id}))},c.prototype.getStudies=function(){for(var e={},t=0;t<this._order.length;t++){var i=this._order[t];this._products[i]&&this._products[i].type===this.PRODUCT_TYPES.study_package&&(e[i]=this._products[i])}return e},c.prototype.getSuperProduct=function(e){for(var t in this._products){var i=this._products[t];if(i.subproduct_ids&&i.subproduct_ids.indexOf(e)>=0)return i.id}},c.prototype.getStudiesOrder=function(){return this._order.filter((function(e){return this._products[e]&&this._products[e].type===this.PRODUCT_TYPES.study_package}),this)},c.prototype.hasPackage=function(e){return this._offers.includes(e)||this._freeProductIds.includes(e)},c.prototype._getUser=function(){return window.user},c.prototype.updateUser=function(){},c.prototype.isPro=function(){return!!this._getUser().pro_plan},c.prototype.isTrial=function(){return!!this._getUser().is_trial},c.prototype.isPaidPro=function(){return this.isPro()&&!this.isTrial()},
c.prototype.userHasRealtimeForExchange=function(e){e=(e||"").toLowerCase().replace("exchange-","");var t=this.getExchange(e);if(!this.isProductDefined(t))return!1;if(this._offers.includes("exchange-"+t.exchange))return!0;if(t.included_exchanges)for(var i=0;i<t.included_exchanges.length;i+=1)if(this._offers.includes("exchange-"+t.included_exchanges[i]))return!0;return!1},c.prototype._exHasRealtimeForType=function(e,t){return!("stock"===t&&!e.is_stocks)&&(!("index"===t&&!e.is_indices)&&!("futures"===t&&!e.is_futures))},c.prototype.hasRealtimeForExchange=function(e,t){var i,r,s=pro.getProductsByType(pro.PRODUCT_TYPES.exchange);e=(e||"").toLowerCase();for(var n=0;n<s.length;n+=1)if((i=s[n]).exchange===e||(i.included_exchanges||[]).includes(e)){if(i.disabled&&!i.included_exchanges)return!1;if(!t)return!0;if(i.included_exchanges){for(var o,a=0;a<i.included_exchanges.length;a+=1)if(r=this.getProduct("exchange-"+i.included_exchanges[a]),this.isProductDefined(r)&&this._exHasRealtimeForType(r,t)){o=!0;break}if(!o)return!1}else if(!this._exHasRealtimeForType(i,t))return!1;return!0}return!1},c.prototype.visitExchangesPage=function(e){var t=n.Monthly,i=!0,r=this._getUser();r.is_trial||(t=r.pro_plan_billing_cycle||n.OneYear,i=!1),s(t,{exchangesOnly:!0,newWindow:(e=e||{}).newWindow,paymentMethod:e.paymentMethod,fixedCycle:i})},c.prototype.offerLogoSrc=function(e){return e.has_logo?"/static/images/indicators/logos/"+e.text_id+".png":null},c.prototype.offers=function(){return this._offers},c.prototype.isSupportAvailable=function(){return Boolean(l.is_support_available)},c.prototype.discounts=function(){return this._discounts},c.prototype.hash=function(){var e=this._offers.slice(0);e.sort();var t={offers:e};return JSON.stringify(t)},"undefined"!=typeof window&&window.TradingView&&(window.TradingView.Pro=c),e.exports=c},88015:(e,t,i)=>{"use strict";i.r(t),i.d(t,{TRIAL_SUFFIX:()=>o,EA_SUFFIX:()=>a,CUSTOM_SUFFIX:()=>l,billingCycleToTimeUnit:()=>c,getReadableCycle:()=>u,billingPeriodText:()=>d,isEarlyAccess:()=>h,isTrialProduct:()=>p,getProductForTrial:()=>_,getDiscountFromEarlyAccess:()=>m,toEarlyAccess:()=>f,humanizeProPlan:()=>g,humanizeCardPlan:()=>v,getAmountOfDaysForBillingCycle:()=>S,countDiscountByBillingCycle:()=>y,billingCycleToMonth:()=>b,round2:()=>w,round0:()=>P,floor0:()=>C,round2or0:()=>T,round1or0:()=>x,roundMinimal:()=>I,getPlanName:()=>L});i(68421);var r=i(20220),s=i(8276),n=i(65754);const o="_trial",a="_discount",l="_custom";function c(e){return{y:r.t("year",{plural:"years",count:1}),m:r.t("month",{plural:"months",count:1}),"3m":r.t("three months"),"2y":r.t("two years")}[e]}function u(e){return{m:r.t("monthly"),y:r.t("annually"),"3m":r.t("3 months"),"2y":r.t("2-year")}[e]||""}function d(e){var t;return null!==(t={y:r.t("Billed every year."),m:r.t("Billed every month."),"2y":r.t("Billed every two years.")}[e])&&void 0!==t?t:""}function h(e){return/\d{0,2}_discount$/.test(e)}function p(e){return new RegExp(o+"$").test(e)}function _(e){return e.split(o)[0]}function m(e){const t=e.match(new RegExp("^(d{0,2})"+a+"$"))
;return t?+t[1]||50:0}function f(e,t){return`${e}_${t}${a}`}function g(e,t){let i=e;switch(e){case s.ProPlans.Pro:i="Pro";break;case s.ProPlans.ProRealtime:i="Pro+";break;case s.ProPlans.ProPremium:i="Premium";break;case s.ProPlans.ProMiniAds:case s.ProPlans.ProMiniLayouts:case s.ProPlans.ProMiniAlerts:i=r.t("1-feature");break;case s.ProPlans.ProEdu:i=r.t("Rookie")}return t&&(i+=" "+r.t("trial")),i}function v(e){let t=e;switch(e){case s.ProPlans.Pro:t="Pro";break;case s.ProPlans.ProRealtime:t="Pro+";break;case s.ProPlans.ProPremium:t="Premium";break;case s.ProPlans.Free:t="Basic"}return t}function S(e){switch(e){case n.BillingCycle.TwoYears:return 730;case n.BillingCycle.OneYear:return 365;case n.BillingCycle.ThreeMonths:return 90;case n.BillingCycle.Monthly:return 30;default:return 1}}function y(e,t,i){return Math.round((t-e)*b(i))}function b(e){switch(e){case n.BillingCycle.TwoYears:return 24;case n.BillingCycle.OneYear:return 12;default:return 1}}function w(e){return(Math.round(100*e)/100).toFixed(2)}function P(e){const t=Math.round(100*e)/100;return Math.round(t).toFixed(0)}function C(e){return Math.floor(e).toString()}function T(e){const t=Math.round(100*e)/100,i=Math.round(t);return Math.abs(t-i)>0?t.toFixed(2):i.toFixed(0)}function x(e){return Number.isInteger(e)?e.toFixed(0):(Math.round(10*e)/10).toFixed(1)}function I(e){const t=Math.round(100*e)/100,i=Math.round(10*e)/10,r=Math.round(t);return Math.abs(t-r)>0?Math.abs(t-i)>0?t.toFixed(2):i.toFixed(1):r.toFixed(0)}function L(e){const t=r.t("{proPlanName} Trial");if(p(e)){const i=g(_(e));return t.format({proPlanName:i})}return g(e)}},11088:(e,t,i)=>{"use strict";i.r(t),i.d(t,{publishChart:()=>d,publishChartWidget:()=>h,setPublishChartOptions:()=>p});i(18184);var r=i(23619),s=i(22817),n=i(98006),o=i(42098),a=i(18184);let l,c=0;function u(){clearTimeout(c),a(".publish-chart-button").removeClass("process")}function d(e,t){const d={...e,...l};return new Promise(e=>{window.runOrSignIn(()=>{!function(){const e=a(".publish-chart-button");0!==e.length&&(e.addClass("process"),c=setTimeout(u,3e4))}(),(0,r.whenVerified)({showDialog:!0,source:"Publish chart",silentPhoneVerification:null==d?void 0:d.silentPhoneVerification}).done(()=>{e(async function(e,t){if(!(0,n.isFeatureEnabled)("show_checkbox_of_house_rules_to_idea_and_script")){if(!0===t||!o.getBool("publish.showIntroText",!0))return window.saver.publishChart(e);const{createWarningPopup:r}=await i.e(63746).then(i.bind(i,14615)),n=await r({type:s.PublishIntroDialogContent.Idea,dataDialogName:"publish-intro-dialog"});o.setValue("publish.showIntroText",!n)}return window.saver.publishChart(e)}(d,t))}).fail(e=>(null==d?void 0:d.onPublishError)&&d.onPublishError(e)).always(u)},{source:"Publish chart",sourceMeta:"Chart"})})}function h(e){d(e,!0)}function p(e){l=e}},20525:(e,t,i)=>{"use strict";var r,s=i(18184),n=(r={},{suggest:function(e,t){var i=s.ajax({url:t||"/pubscripts-suggest-json/",type:"GET",data:{search:e},dataType:"json"});return i.done((function(e){
if(e&&e.results)for(var t=0;t<e.results.length;t++)r[e.results[t].scriptIdPart]=TradingView.clone(e.results[t])})),i},info:function(e,t=!1){for(var i=s.Deferred(),n=[],o=[],a=0;a<e.length;a++){var l=e[a];r[l]?n.push(TradingView.clone(r[l])):o.push(l)}if(!o.length)return i.resolve(n).promise();var c={scriptIdPart:o.join(","),show_hidden:t};return s.ajax({url:"/pubscripts-get/",type:"POST",data:c,dataType:"json"}).done((function(e){for(var t in e=e||[]){var s=e[t];r[s.scriptIdPart]=TradingView.clone(s),n.push(s)}i.resolve(n)})).fail((function(){i.reject()})),i},invalidateCache:function(e){e.forEach((function(e){delete r[e]}))},cleanCache:function(){r=[]}});e.exports=n},15027:(e,t,i)=>{"use strict";i.r(t),i.d(t,{QuoteTicker:()=>b});var r=i(21318),s=i(87380),n=i(31565),o=i(14704),a=i(30879),l=i(11228),c=i(81293),u=i(20446),d=i(15701),h=i(5956),p=i(6798),_=i(50077),m=i(29755);const f=(0,s.getLogger)("QuoteTicker"),g={addDescriptionTitle:!0,changeDirectionDownClass:"down",changeDirectionUpClass:"up",changeDirectionNeutralClass:"neutral",changeInBrackets:!1,changePercentInBrackets:!1,lastPriceTimeInBrackets:!0,rtcTimeInBrackets:!0,clientName:"quote-ticker",dontDyePrice:!1,fallingBg:null,growingBg:null,lastFallingClass:"falling",lastGrowingClass:"growing",quoteSession:null,signNegative:!0,signPositive:!1,customPriceFormatter:null,customTimeFormatter:null,sessionStatusClassSuffix:"--for-ticker",dataModeClassSuffix:"--for-ticker",showInvalidSymbolStatus:!1,indicatorsTooltipType:"custom",lastPriceLastCharSup:!1,lastPriceHighlightDiffOnly:!1,initedHook:void 0,setStateHook:void 0,sfPermissionDeniedHook:void 0,noSuchSymbolHook:void 0},v=["aboard","about","above","abreast","abroad","absent","across","adjacent","after","against","along","alongside","amid","among","an","apropos","apud","around","as","astride","at","atop","bar","before","behind","below","beneath","beside","besides","between","beyond","but","by","chez","circa","come","despite","down","during","except","for","from","in","inside","into","less","like","minus","near","notwithstanding","of","off","on","onto","ontop","opposite","out","outside","over","pace","past","per","post","pre","pro","qua","re","sans","save","short","since","than","through","throughout","to","toward, towards","under","underneath","unlike","until","up","upon","upside","versus","via","vice","with","within","without","worth"],S=String.fromCharCode(8198),y=/[K,M,B]/;function b(e,t,i={}){this.enabled=!0,this._symbol=e,this._symbolOriginal=null,this._options=(0,r.deepExtend)({},g,i),!1!==this._options.signNegative&&!0!==this._options.signNegative&&delete this._options.signNegative,i.customPriceFormatter&&(this._customPriceFormatter=i.customPriceFormatter),i.customTimeFormatter&&(void 0!==i.customTimeFormatter.lastPrice||void 0!==i.customTimeFormatter.rtc?this._timeFormatter=i.customTimeFormatter:this._timeFormatter={lastPrice:i.customPriceFormatter,rtc:i.customPriceFormatter}),this._percentFormatter=new o.PercentageFormatter,this._priceFormatter=this._customPriceFormatter||new l.PriceFormatter(100),
this._volumeFormatter=new c.VolumeFormatter,this._cache={},this._lastPrice=null,this._lastPriceFormatted="",this._elements={},this._textNodes={},this._changeVolumeLetter=this._getChangeVolumeLetterCallback(),this._setElements(t),this._highlighters={},this._initHighlighters(),this._options.setStateHook&&this.setStateHook(this._options.setStateHook),this.quoteSession=this._options.quoteSession||(0,p.getQuoteSessionInstance)("simple"),this._quoteSessionEventHandler=this.onData.bind(this),this._connectTimeoutId=setTimeout(this.connect.bind(this),0)}function w(e){const t=e.search(y),i=t>=0?`${S}${e.slice(t)}`:"";return[t>0?e.substring(t,0):0===t?"":e,i]}function P(e,t,i,r,s){var n,o=null;function a(){if(n&&(clearTimeout(n),n=void 0),i||t)for(var o=0;o<e.length;o++)e[o].style.background="";if(!i||!t)for(o=0;o<e.length;o++)e[o].classList.remove(s,r)}return{show:function(l){var c=0;if(l!==o){if(null!==o&&null!==l&&(c=l-o),a(),n=setTimeout(a,750),0<c)if(t)for(var u=0;u<e.length;u++)e[u].style.background=t;else for(u=0;u<e.length;u++)e[u].classList.add(r);else if(c<0)if(i)for(u=0;u<e.length;u++)e[u].style.background=i;else for(u=0;u<e.length;u++)e[u].classList.add(s);null!==l&&(o=l)}},hide:a}}b.prototype._setElements=function(e){this._container=e,this._elements.change=this._findElements(e,["js-symbol-change","symbol-change"]),this._elements.changeDirection=this._findElements(e,["js-symbol-change-direction","symbol-change-direction"]),this._elements.extHrsChangeDirection=this._findElements(e,["js-symbol-ext-hrs-change-direction"]),this._elements.changePercent=this._findElements(e,["js-symbol-change-pt","symbol-change-pt"]),this._elements.description=this._findElements(e,["js-symbol-description-name","symbol-description-name"]),this._elements.extHrsChange=this._findElements(e,"js-symbol-ext-hrs-change"),this._elements.extHrsChangePercent=this._findElements(e,"js-symbol-ext-hrs-change-pt"),this._elements.extHrsClose=this._findElements(e,"js-symbol-ext-hrs-close"),this._elements.industry=this._findElements(e,["js-symbol-industry","symbol-industry"]),this._elements.last=this._findElements(e,["js-symbol-last","symbol-last"]),this._elements.sector=this._findElements(e,["js-symbol-sector","symbol-sector"]),this._elements.sessionStatus=this._findElements(e,"js-symbol-session-status"),this._elements.shortName=this._findElements(e,["js-symbol-short-name","symbol-short-name"]),this._elements.updateMode=this._findElements(e,"js-data-mode"),this._elements.updateMode.forEach(e=>e.classList.add("i-hidden")),this._textNodes.change=this._getOrCreateTextNodes(this._elements.change),this._textNodes.changePercent=this._getOrCreateTextNodes(this._elements.changePercent),this._textNodes.extHrsChange=this._getOrCreateTextNodes(this._elements.extHrsChange),this._textNodes.extHrsChangePercent=this._getOrCreateTextNodes(this._elements.extHrsChangePercent),this._textNodes.extHrsClose=this._getOrCreateTextNodes(this._elements.extHrsClose),this._textNodes.last=this._getOrCreateTextNodes(this._elements.last),
this._textNodes.open=this._findTextNodes(e,"js-symbol-open"),this._textNodes.eps=this._findTextNodes(e,"js-symbol-eps"),this._textNodes.marketCap=this._findTextNodes(e,"js-symbol-market-cap"),this._textNodes.prevClose=this._findTextNodes(e,"js-symbol-prev-close"),this._textNodes.dividends=this._findTextNodes(e,"js-symbol-dividends"),this._textNodes.priceEarnings=this._findTextNodes(e,"js-symbol-pe"),this._textNodes.volume=this._findTextNodes(e,"js-symbol-volume"),this._textNodes.high=this._findTextNodes(e,"js-symbol-high"),this._textNodes.low=this._findTextNodes(e,"js-symbol-low"),this._textNodes.currency=this._findTextNodes(e,"js-symbol-currency"),this._textNodes.lastPriceTime=this._findTextNodes(e,"js-symbol-lp-time"),this._textNodes.rtcTime=this._findTextNodes(e,"js-symbol-rtc-time"),this._elements.lastHighlight=this._options.lastPriceHighlightDiffOnly?this._elements.last.map(e=>this._appendAndGetNewElement(e,"span")):this._elements.last,this._textNodes.lastHighlight=this._getOrCreateTextNodes(this._elements.lastHighlight),this._elements.lastSup=this._options.lastPriceLastCharSup?this._elements.lastHighlight.map(e=>this._appendAndGetNewElement(e,"sup")):[],this._textNodes.lastSup=this._getOrCreateTextNodes(this._elements.lastSup)},b.prototype._findElements=function(e,t){var i=(0,n.isArray)(t)?t:[t];return Array.prototype.concat.apply([],i.map(t=>Array.prototype.slice.call(e.getElementsByClassName(t))))},b.prototype._findTextNodes=function(e,t){return this._getOrCreateTextNodes(this._findElements(e,t))},b.prototype._getOrCreateTextNodes=function(e){return e.map(e=>{var t=this._getFirstTextNode(e);return t||(t=e.ownerDocument.createTextNode(""),e.appendChild(t)),t})},b.prototype._appendAndGetNewElement=function(e,t){const i=document.createElement(t);return e.appendChild(i),i},b.prototype._getFirstTextNode=function(e){for(var t=e.childNodes,i=t.length-1;i>=0;i--)if(3===t.item(i).nodeType)return t.item(i);return null},b.prototype.connect=function(e){this._subscribed||(this._subscribedSymbol=e||this._symbol,this.quoteSession.subscribe(this._options.clientName,this._subscribedSymbol,this._quoteSessionEventHandler),this._subscribed=!0)},b.prototype.disconnect=function(){clearTimeout(this._connectTimeoutId),this._subscribed&&(this.quoteSession.unsubscribe(this._options.clientName,this._subscribedSymbol,this._quoteSessionEventHandler),this._subscribed=!1)},b.prototype.onData=function(e,t){this.enabled&&("ok"===e.status?this.successData(e,t):"permission_denied"===e.status?this.onPermissionDenied(e):"error"===e.status&&this.errorData(e))},b.prototype.successData=function(e,t){e.values&&this.setState(e.values,e,t)},b.prototype.onPermissionDenied=function(e){(0,m.isSfQuoteData)(e)?this._options.sfPermissionDeniedHook?this._options.sfPermissionDeniedHook(e,this._symbolOriginal||this._symbol):this.errorData(e):this.downgradeData(e)},b.prototype.errorData=function(e){this._options.showInvalidSymbolStatus&&(this.setShortName(this._symbol),this._elements.sessionStatus.map(e=>new u.MarketStatusIndicator({
classSuffix:this._options.sessionStatusClassSuffix,el:e,data:{values:{current_session:"invalid"}},tooltipType:this._options.indicatorsTooltipType}))),this._options.noSuchSymbolHook?(this._symbolOriginal&&this.setShortName(this._symbolOriginal),this._options.noSuchSymbolHook.call(this,e,this._symbolOriginal||this._symbol)):f.logWarn("No data for: "+this._symbol)},b.prototype.downgradeData=function(e){{const t=e&&e.values&&e.values.alternative,i=this._symbol===t;if(!(t&&-1!==t.indexOf(":"))||i)return void this.errorData(e);this._symbolOriginal=this._symbol,this._symbol=t,this._subscribed=!1,this.connect()}},b.prototype.setState=function(e,t,i){const r=i.values;this._isVolumeFormat="volume"===e.format,null==r.pricescale&&null==r.minmov&&null==r.fractional&&null==r.minmove2||(this._priceFormatter=this._customPriceFormatter||this._isVolumeFormat&&this._volumeFormatter||new l.PriceFormatter(e.pricescale||100,e.minmov||1,e.fractional,e.minmove2));const s=this._options,n=this._percentFormatter,o=this._priceFormatter,a=this._volumeFormatter;r.timezone&&this._timeFormatter&&(this._timeFormatter.lastPrice&&this._timeFormatter.lastPrice.setTimezone(r.timezone),this._timeFormatter.rtc&&this._timeFormatter.rtc.setTimezone(r.timezone));const p=(e,t=!0)=>t?`(${e})`:e,_=void 0!==s.signPositiveChange?s.signPositiveChange:s.signPositive,m=e=>{const t=o.format(e,_,void 0,s.signNegative);return p(t,s.changeInBrackets)},g=e=>{const t=n.format(e,_,void 0,s.signNegative);return p(t,s.changePercentInBrackets)},v=o.format.bind(o),S=a.format.bind(a),y=e=>null==e?c.PLACE_HOLDER:v(e);s.disableChange||(this._setNodesValue(this._textNodes.change,r.change,m),this._setNodesValue(this._textNodes.changePercent,r.change_percent,g),null!=r.change&&(s.dontDyePrice||this._setChangeFontColor([].concat(this._elements.change,this._elements.changePercent),r.change,s.changeUpFontColor,s.changeDownFontColor,s.changeNeutralFontColor),this._setChangeDirection(this._elements.changeDirection,r.change)),this._setNodesValue(this._textNodes.extHrsChange,r.rch,m),this._setNodesValue(this._textNodes.extHrsChangePercent,r.rchp,g),null!=r.rch&&(s.dontDyePrice||this._setChangeFontColor([].concat(this._elements.extHrsChange,this._elements.extHrsChangePercent),r.rch,s.changeUpFontColor,s.changeDownFontColor,s.changeNeutralFontColor),this._setChangeDirection(this._elements.extHrsChangeDirection,r.rch))),this._setNodesValue(this._textNodes.prevClose,r.prev_close_price,v),this._setNodesValue(this._textNodes.dividends,e.dividends_yield,e=>null==e?c.PLACE_HOLDER:n.format(e,s.signPositive,void 0,s.signNegative),!0);let b=(0,h.getTranslatedSymbolDescription)(r);if(b&&(b=this._prepareSymbolDescription(b),this._setTextsContent(this._elements.description,b),this._options.addDescriptionTitle))for(var w=0;w<this._elements.description.length;w++)this._elements.description[w].setAttribute("title",b);if((null!=r.short_name||null!=r.exchange)&&e.short_name){var P=e.short_name
;"QUANDL"===e.exchange&&void 0!==e.short_name.split("/")[1]&&(P=e.short_name.split("/")[1]+", "+e.short_name.split("/")[0]),this.setShortName(P)}if(this._setLastValue(r.last_price,v),this._setNodesValue(this._textNodes.extHrsClose,r.rtc,v),r.rtc&&this._highlighters.extHrsClose.show(r.rtc),r.industry&&this._setTextsContent(this._elements.industry,e.industry,e=>e),r.sector&&this._setTextsContent(this._elements.sector,e.sector),this._elements.sessionStatus&&r.current_session&&(this._sessionStatusInstances?this._sessionStatusInstances.forEach(e=>e.setStatus(r.current_session)):this._sessionStatusInstances=this._elements.sessionStatus.map(t=>new u.MarketStatusIndicator({classSuffix:this._options.sessionStatusClassSuffix,el:t,short:!0,data:{values:r},quoteSession:this.quoteSession,symbol:e.original_name,manualUpdate:!0,tooltipType:this._options.indicatorsTooltipType}))),this._setNodesValue(this._textNodes.open,r.open_price,v),this._setNodesValue(this._textNodes.high,r.high_price,v),this._setNodesValue(this._textNodes.low,r.low_price,v),this._setNodesValue(this._textNodes.eps,e.earnings_per_share_basic_ttm,y,!0),this._setNodesValue(this._textNodes.priceEarnings,e.price_earnings_ttm,y,!0),this._setNodesValue(this._textNodes.marketCap,e.market_cap_basic,S,!0),this._setNodesValue(this._textNodes.volume,e.volume,S,!0),this._setNodesValue(this._textNodes.currency,e.currency_code,null,!0),(r.lp_time||r.timezone&&e.lp_time)&&this._textNodes.lastPriceTime.length&&(this._timeFormatter&&this._timeFormatter.lastPrice?this._setNodesValue(this._textNodes.lastPriceTime,p(this._timeFormatter.lastPrice.format(e.lp_time),this._options.lastPriceTimeInBrackets)):f.logError("last price time field requested with no formatter provided")),(r.rtc_time||r.timezone&&e.rtc_time)&&this._textNodes.rtcTime.length&&(this._timeFormatter&&this._timeFormatter.rtc?this._setNodesValue(this._textNodes.rtcTime,p(this._timeFormatter.rtc.format(e.rtc_time),this._options.rtcTimeInBrackets)):f.logError("rtc time field requested with no formatter provided")),null!=r.last_price)for(w=0;w<this._elements.updateMode.length;w++)this._elements.updateMode[w].classList.remove("i-hidden");this._elements.updateMode&&(r.update_mode||r.update_mode_seconds)&&(this._updateModeInstances?this._updateModeInstances.forEach(t=>t.update({values:e})):this._updateModeInstances=this._elements.updateMode.map(t=>new d.DataModeIndicator({classSuffix:this._options.dataModeClassSuffix,el:t,data:{values:e},modeInterval:e.update_mode_seconds,short:!0,tooltipType:this._options.indicatorsTooltipType}))),this._setStateHook&&this._setStateHook(t.values,i.values,t.complete),this._lastPrice?this._highlighters.last.show(e.last_price):null===this._lastPrice&&(this._container.classList.add("quote-ticker-inited"),"function"==typeof this._options.initedHook&&this._options.initedHook("last_price"in e)),this._lastPrice=e.last_price},b.prototype._setNodesValue=function(e,t,i,r){if(null!=t||r)for(var s="function"==typeof i?i(t):t,n=0;n<e.length;n++)e[n].nodeValue=s},
b.prototype._setTextsContent=function(e,t,i){if(e&&e.length&&t)for(var r="function"==typeof i?i(t):t,s=0;s<e.length;s++)e[s].textContent=r},b.prototype._setLastValue=function(e,t){if(null==e)return;const i="function"==typeof t?t(e):String(e);if(i===this._lastPriceFormatted)return;const[r,s,n]=this._options.lastPriceHighlightDiffOnly?this._getLastValueStringDiff(this._lastPriceFormatted,i):["",i,""],o=r,[a,l]=this._options.lastPriceLastCharSup?[s.slice(0,-1),s.slice(-1)]:[s,""];this._options.lastPriceHighlightDiffOnly&&(this._isVolumeFormat&&this._changeVolumeLetter.call(this,n),this._setNodesValue(this._textNodes.last,o)),this._setNodesValue(this._textNodes.lastHighlight,a),this._setNodesValue(this._textNodes.lastSup,l),this._lastPriceFormatted=i},b.prototype._getChangeVolumeLetterCallback=function(){let e;return function(t){t!==e&&(e=t,this._elements.last.forEach(t=>{3!==t.childNodes.length?t.appendChild(document.createTextNode(e)):t.childNodes[2].nodeValue=e}))}},b.prototype._getLastValueStringDiff=function(e,t){if(e===t){const[e,i]=w(t);return[e,"",i]}let i=0;for(;e[i]===t[i];)i++;const[r,s]=w(t.slice(i));return[t.slice(0,i),r,s]},b.prototype._setChangeFontColor=function(e,t,i,r,s){for(var n=a.PriceColorer.formatSign(t,{up:i,down:r,neutral:s}),o=0;o<e.length;o++)e[o].style.color=n},b.prototype._setChangeDirection=function(e,t){for(var i=0;i<e.length;i++){var r=e[i].classList;r.toggle(this._options.changeDirectionUpClass,t>0),r.toggle(this._options.changeDirectionDownClass,t<0),r.toggle(this._options.changeDirectionNeutralClass,0===t)}},b.prototype.setShortName=function(e=""){this._setTextsContent(this._elements.shortName,e)},b.prototype._prepareSymbolDescription=function(e){var t,i=this._getCache("symbol-description:"+e);if(i)return i;return i=(i=(t=e)===t.toUpperCase()?e.toLowerCase():e).replace(/[^\s]\S*/g,(function(e){return function(e){return 1!==e.length&&!~v.indexOf(e)}(e)?(0,_.capitalizeFirstLetter)(e):e})),i=(0,_.capitalizeFirstLetter)(i),this._setCache("symbol-description:"+e,i),i},b.prototype._initHighlighters=function(){this._highlighters.last=new P(this._elements.lastHighlight,this._options.growingBg,this._options.fallingBg,this._options.lastGrowingClass,this._options.lastFallingClass),this._highlighters.extHrsClose=new P(this._elements.extHrsClose,this._options.growingBg,this._options.fallingBg,this._options.lastGrowingClass,this._options.lastFallingClass)},b.prototype.disable=function(){this.enabled=!1,this.disconnect()},b.prototype.enable=function(){this.enabled=!0,this.connect()},b.prototype.setStateHook=function(e){null===e&&this._setStateHook?delete this._setStateHook:"function"==typeof e&&(this._setStateHook=e)},b.prototype._setCache=function(e,t){null==t?delete this._cache[e]:this._cache[e]=t},b.prototype._getCache=function(e){return this._cache&&this._cache[e]}},94211:(e,t,i)=>{"use strict";i.d(t,{enable:()=>a,referenceToTradingView:()=>l});var r=i(29098),s=i(61424),n=i(22842);let o;function a(e,t){o=e,t=t||"aggressive",n.enable("referral_program_for_widget_owners"),
n.enable("referral_program_policy_"+t),(0,r.trackEvent)("Referral program enabled",t)}function l(){const e="https://www.tradingview.com";return o?e+"?aff_id="+o+"&"+(0,s.buildUtmQueryStringFromUrlParams)(!1):e+(0,s.buildUtmQueryStringFromUrlParams)(!0)}},23112:(e,t,i)=>{"use strict";i.d(t,{ChartSaverBase:()=>r});class r{constructor(e){this._chartWidgetCollection=e}_getCommonSavingInfo(e){const t=this._chartWidgetCollection,i=this._chartWidgetCollection.chartsSymbols(),r=i[t.activeChartWidget.value().id()],s={...(n=r,{...n,legs:JSON.stringify(null!==(o=n.legs)&&void 0!==o?o:[])})};var n,o;const a=t.metaInfo;return a.id.value()&&(s.id=a.id.value()),s.name=a.name.value()||"",s.description=a.description.value()||"",s.charts_symbols=function(e){const t={};for(const i of Object.keys(e))t[i]={symbol:e[i].symbol};return JSON.stringify(t)}(i),s.is_realtime=s.is_realtime=e?"0":"1",s}}},2872:(e,t,i)=>{"use strict";var r=i(96276),s=i(18184),n=i(20220).t,o=i(16282).assert,a=i(57746),l=i(29098).trackEvent,c=i(23946).createGoProDialog,u=i(79200).reloginOrGoPro,d=i(20525),h=i(88001),p=i(50137).getChartStorage,_=i(98006).isFeatureEnabled,m=i(93010).asyncWindowOpen,f=i(57233),g=i(79407).showWarning,v=i(21318).deepExtend,S=i(31565).deepEquals,y=i(20895).backend,b=i(23112).ChartSaverBase;const w={saverOnPublishError:n("The publication preview could not be loaded. Please disable your browser extensions and try again."),saveLibraryError:n("Failed to save library"),saveScriptError:n("Failed to save script")};function P(e,t){e.content=JSON.stringify(t)}function C(e){return e.returnValue=window.t("Script may be not updated if you leave the page."),e.returnValue}t.ChartSaver=class extends b{constructor(e){super(e),this._chartAboutToBeSavedDelegate=new r,this._chartSavedDelegate=new r,this._prevChartState=null,this._chartSizeLimitExceededDelegate=new r,this._savingToken=null}chartSizeLimitExceeded(){return this._chartSizeLimitExceededDelegate}chartAboutToBeSaved(){return this._chartAboutToBeSavedDelegate}chartSaved(){return this._chartSavedDelegate}whenReadyToSave(e){var t=this._chartWidgetCollection.activeChartWidget.value().model().mainSeries();if(t.hasDelayedSymbolIntervalChange()){var i,r=null;i=function(){t.dataEvents().symbolError().unsubscribe(null,r,!0),e()},r=function(){t.dataEvents().symbolResolved().unsubscribe(null,i,!0)},t.dataEvents().symbolResolved().subscribe(null,i,!0),t.dataEvents().symbolError().subscribe(null,r,!0)}else e()}saveToJSON(){var e=this._getCommonSavingInfo(!1);return P(e,this._getChartWidgetCollectionState(!1,!0)),e}_fillAsyncInfo(e,t){var i=JSON.parse(e.content),r=this._chartWidgetCollection;return(t?r.asyncState():r.activeChartWidget.value().asyncState()).then((function(t){return e.content=JSON.stringify(v(i,t)),e}))}_getChartWidgetCollectionState(e,t,i,r,s){return e||(t=!0,r=!1),t?this._chartWidgetCollection.state(!!e,i,r,s):this._chartWidgetCollection.activeChartWidget.value().state(!!e,i,r,s)}publishChart(e){var t=this;return new Promise((function(r){l("GUI","Publish Chart");var n=t,o={
accessType:(e=e||{}).isPrivate||TVSettings.getBool("publishchart.private",!1)?0:1,publishSource:e.publishSource,videoFilename:e.videoFilename,videoDuration:e.videoDuration,videoCam:e.videoCam},a=s(".publish-dropdown-container"),c=s(".publish-chart-button"),u={savePrivacySetting:!e.doNotSavePrivacySetting,onWidget:e.onWidget},d=e.onPublishUrl,h=e.onPublishError;n._ideaPublisher?r(n._ideaPublisher.openPublication(o,u)):Promise.all([Promise.all([i.e(23876),i.e(99459),i.e(29448),i.e(37610),i.e(99752),i.e(32795),i.e(59456),i.e(63193),i.e(61212),i.e(25535),i.e(85597),i.e(45266),i.e(60700),i.e(70964),i.e(99305),i.e(90901),i.e(38968),i.e(81542),i.e(67890),i.e(22124),i.e(57198),i.e(45066),i.e(58882),i.e(84716),i.e(73935),i.e(45867),i.e(1529),i.e(466),i.e(36982),i.e(19894),i.e(53011),i.e(52616),i.e(72417),i.e(22021),i.e(97732),i.e(80235),i.e(17279),i.e(20929),i.e(50629)]).then(i.bind(i,72637)),Promise.all([i.e(23876),i.e(99459),i.e(29448),i.e(37610),i.e(99752),i.e(32795),i.e(59456),i.e(63193),i.e(61212),i.e(25535),i.e(85597),i.e(45266),i.e(60700),i.e(70964),i.e(99305),i.e(90901),i.e(38968),i.e(81542),i.e(67890),i.e(22124),i.e(57198),i.e(45066),i.e(58882),i.e(84716),i.e(73935),i.e(45867),i.e(1529),i.e(466),i.e(36982),i.e(19894),i.e(53011),i.e(52616),i.e(72417),i.e(22021),i.e(97732),i.e(80235),i.e(17279),i.e(20929),i.e(50629)]).then(i.bind(i,40609)),Promise.all([i.e(23876),i.e(99459),i.e(29448),i.e(37610),i.e(99752),i.e(32795),i.e(59456),i.e(63193),i.e(61212),i.e(25535),i.e(85597),i.e(45266),i.e(60700),i.e(70964),i.e(99305),i.e(90901),i.e(38968),i.e(81542),i.e(67890),i.e(22124),i.e(57198),i.e(45066),i.e(58882),i.e(84716),i.e(73935),i.e(45867),i.e(1529),i.e(466),i.e(36982),i.e(19894),i.e(53011),i.e(52616),i.e(72417),i.e(22021),i.e(97732),i.e(80235),i.e(17279),i.e(20929),i.e(50629)]).then(i.bind(i,2200)),Promise.all([i.e(23876),i.e(99459),i.e(29448),i.e(37610),i.e(99752),i.e(32795),i.e(59456),i.e(63193),i.e(61212),i.e(25535),i.e(85597),i.e(45266),i.e(60700),i.e(70964),i.e(99305),i.e(90901),i.e(38968),i.e(81542),i.e(67890),i.e(22124),i.e(57198),i.e(45066),i.e(58882),i.e(84716),i.e(73935),i.e(45867),i.e(1529),i.e(466),i.e(36982),i.e(19894),i.e(53011),i.e(52616),i.e(72417),i.e(22021),i.e(97732),i.e(80235),i.e(17279),i.e(20929),i.e(50629)]).then(i.bind(i,74942))]).then(([{CategoriesProvider:e},{ChartInfoProvider:t},{IdeasProvider:i},{IdeaPublisher:s}])=>{var l=new t({chartWidgetCollection:n._chartWidgetCollection}),p=new i({publish:function(e,t){return new Promise((function(i,r){var s={closeForm:function(){i()},showError:function(e){r(e)},onPublishUrl:d,onPublishError:h};try{n.onPublish(e,Object.assign({},t,s))}catch(e){r(w.saverOnPublishError)}}))}}),_=new e;n._ideaPublisher=new s({chartInfoProvider:l,ideasProvider:p,categoriesProvider:_,onOpenEditor:function(){a.addClass("disabled")},onMinimizeEditor:function(){a.removeClass("disabled"),c.addClass("inprogress")},onCloseEditor:function(){a.removeClass("disabled"),c.removeClass("inprogress")}}),r(n._ideaPublisher.openPublication(o,u))})}))}publishScript(e,t,i){var r=this
;if(r._scriptPublisher)r._scriptPublisher.openPublication(e,t);else{var s=i.scriptPublisher,n=i.scriptsProvider,o=i.categoriesProvider,a=new n({publish:function(e){return new Promise((function(t,i){var s={closeForm:function(){if(e&&e.scriptPublication&&e.scriptPublication.updateScriptIdPart){var i=e.scriptPublication.updateScriptIdPart;d.invalidateCache([i]),window.studyMarket&&window.studyMarket.resetAllPages()}t()},showError:function(e){i(e)}};try{r.onPublish(e,s)}catch(e){i(w.saverOnPublishError)}}))}});r._scriptPublisher=new s({scriptsProvider:a,categoriesProvider:new o,scriptType:e.scriptType,scriptTitle:e.title,existingLibraryInfo:e.existingLibraryInfo}),r._scriptPublisher.openPublication(e,t)}}onPublish(e,t){{var i=this;if(i.publishInProgress)return;var r=t&&t.publishAllLayout,n=i._getCommonSavingInfo(!0),o=!1;e.scriptPublication&&(e.scriptPublication.scriptProtection===f.Access.ACCESS_CLOSED_NEEDS_AUTH&&(o=!0),n.scriptProtection=parseInt(f.Access.MAP_NAME_TO_ID[e.scriptPublication.scriptProtection])),P(n,this._getChartWidgetCollectionState(!0,r,!0,o)),n.image=JSON.stringify(this._chartWidgetCollection.images({onlyActiveChart:!r}));const c=r=>{window.removeEventListener("beforeunload",C),i.publishInProgress=!1;var s=r.responseText||"";if("ok:"===s.substr(0,3)){var n=!1;if(t.savePrivacySetting){n=!e.is_public;TVSettings.setValue("publishchart.private",n)}var o=s.substr(3),a=JSON.parse(o);i._chartWidgetCollection.metaInfo.id.value()||i._chartWidgetCollection.metaInfo.id.setValue(a.id),t.closeForm&&t.closeForm(),t.onPublishUrl&&t.onPublishUrl(a.publishUrl,a.uuid),h.emit("onPublishUrl",a.uuid),i._lastPublishUrl=a.publishUrl,i.setPopupUrl&&i.setPopupUrl(a.publishUrl)}else{(413===r.status||/^[\d\s]*request.+large/i.test(s.trim()))&&(s=window.t("This Chart Layout has a lot of objects and can't be published. Please remove the unused objects (drawings/indicators) through the Object Tree to continue publishing."));var l=s||window.t("Error occurred while publishing");t.showError&&t.showError(l,{html:!0}),t.onPublishError&&t.onPublishError(l),i.setPopupUrl&&i.setPopupUrl(void 0)}};i._fillAsyncInfo(n,t&&t.publishAllLayout).then((function(t){var i=e.scriptPublication,r=!(!i||!i.updateScriptIdPart),n=new Promise((function(e,t){var s;i?(r?(window.addEventListener("beforeunload",C),s=a.publishNext(i.scriptSource,i.updateScriptIdPart)):s=a.publishNew(i.scriptSource,i.scriptProtection),s.done((function(t){e(t.publishedstudyscript_id)})).fail((function(e){let i="";i=-1!==e.indexOf("already published library")?w.saveLibraryError:w.saveScriptError,g({title:i,text:e}),t()}))):e()}));r?n.then((function(i){var r={publishedstudyscript_id:i,script_terms:e.script_terms,description:e.description,tags:e.tags,preserve_old_chart:e.preserveOldChart};s.ajax({url:"/script-update/",type:"post",dataType:"text",data:s.extend({},t,r),complete:c})}),c):n.then((function(i){i&&(e.publishedstudyscript_id=i);for(var r=e.tags.split(","),n=e.scriptPublication?"Script":"Idea",o=0;o<r.length;o++)l(n+" Publication",n+" Tag",r[o]);if(e.scriptPublication){
var a=e.scriptPublication.scriptProtection;l("Script Publication","Script Visibility",{open_no_auth:"Open",closed_no_auth:"Protected",closed_needs_auth:"Invite Only"}[a])}else{var u=e.is_education?"Education":"Analysis",d=e.is_public?"Public":"Private";l("Idea Publication","Idea Type",u),l("Idea Publication","Idea Strategy",["Neutral","Long","Short"][e.direction]),l("Idea Publication","Idea Privacy",d)}s.ajax({url:"/publishchart/",type:"post",dataType:"text",data:s.extend({},t,e),complete:c})}),c)}),c),i.publishInProgress=!0,t.onWidget||""!==e.name&&""!==e.description&&e.description.length<=7e4&&e.name.length<=64&&m(new Promise((function(e){i.setPopupUrl=e})))}}saveChartLineTools(e,t){var i=p(),r=this._chartWidgetCollection.metaInfo.uid.value();return i.saveLineToolsAndGroups(r,e,t)}_saveLineToolsToStorage(){var e=this._chartWidgetCollection.lineToolsAndGroupsDTOs(),t=performance.now(),i=Array.from(e.entries()).filter((function(e){var t=e[1];return t.sources.size>0||t.groups.size>0})).map(function(e){var t=e[0],i=e[1];return this.saveChartLineTools(t,i)}.bind(this));return Promise.all(i).then(function(e){var i=new Map;e.forEach(e=>{i.set(e.chartId,e.savedDto)}),this._chartWidgetCollection.resetLineToolsInvalidated(t,i)}.bind(this))}_saveChartImpl(e,t,i,r,n,o){var a=i,l=r;if(this._savingToken=String(Math.random()),e.savingToken=this._savingToken,a=function(o){if(this._savingToken=null,"ok:"===o.substr(0,3)){var a=o.substr(3),l=JSON.parse(a);t.id.value()||(t.id.setValue(l.id),t.uid.setValue(l.uid)),t.lastModified.setValue(l.lastModified),"function"==typeof i&&i(t,e)}else if("saved_chart_limit_reached"===o||""===o){if("function"==typeof r&&r(),n.noDefaultOnFail)return;c({feature:"savedChartsLimit"})}else"function"==typeof r&&r(),s("#error").html(o);s(window).off("beforeunload.savechart")},l=function(e){return this._savingToken=null,e&&413===e.status?(this._chartSizeLimitExceededDelegate.fire(),void("function"==typeof r&&r.apply(null,arguments))):e&&403===e.status?(u({feature:"savedChartsLimit"}),void("function"==typeof r&&r.apply(null,arguments))):void(n.retry?"function"==typeof r&&r.apply(null,arguments):(n.retry=!0,this._saveChart(o,i,r,n)))},!e.name)return console.warn("Saving chart with empty name is not allowed"),void r();y.saveChart(e.name,e.short_name,e.resolution,e,t).then(a.bind(this)).catch(l.bind(this))}_saveChart(e,t,i,r){var s=this._chartWidgetCollection.metaInfo,n=function(n){return S(this._prevChartState,n)[0]&&null!=s.id.value()?(this._chartSavedDelegate.fire(!0),void(t&&t(s,n))):this._saveChartImpl(n,s,t,i,r,e)}.bind(this);this._saveLineToolsToStorage().then((function(){var t=e(!0);return n(t)})).catch((function(t){var i=e(!1);return n(i)}))}saveChartSilently(e,t,i){i=i||{};var r=function(e){var t=e&&_("remove_line_tools_from_content"),r=this._getChartWidgetCollectionState(!1,void 0,void 0,void 0,t),s=this._getCommonSavingInfo(!1,t);return P(s,r),i.chartName&&(s.name=i.chartName),s.name&&0!==s.name.length||!i.defaultChartName||(s.name=i.defaultChartName),i.autoSave&&(s.autoSave=!0),s}.bind(this)
;s(window).on("beforeunload.savechart",(function(){return window.t("Your chart is being saved, please wait a moment before you leave this page.")})),this._isSaveInProcess=!0,this._chartAboutToBeSavedDelegate.fire(),this._saveChart(r,function(t,i){o(!this._chartWidgetCollection.readOnly(),"Trying to save layout in read-only mode"),this._chartWidgetCollection.metaInfo.name.setValue(i.name),this._prevChartState=i,this._chartSavedDelegate.fire(!0),this._isSaveInProcess=!1,e&&e({uid:t.uid.value(),data:i}),delete this._prevChartState.savingToken}.bind(this),function(){this._chartSavedDelegate.fire(!1),this._isSaveInProcess=!1,t&&t.apply(null,arguments)}.bind(this),i),s(window).off("beforeunload.savechart")}isSaveInProcess(){return this._isSaveInProcess}}},79891:(e,t,i)=>{"use strict";var r=i(23946).createGoProDialog,s=i(71141).showSignModal;window.TVDialogs={showSignInDialog:function(e){return s(e)},signModal:null,showGoProDialog:function(e){r(e)}}},87665:e=>{"use strict";var t={},i={XCBT:"CBOT",XNYM:"NYMEX",XCME:"CME",XCEC:"COMEX"};t.convertSymbolDataToTV=function(e,t,r){return r=2===r||"floor"===r||"pit"===r?"PIT":"GBX",t&&i[t]?{status:"ok",data:{symbol:e,exchange:i[t]+"_"+r}}:{status:"error",data:"Exchange `"+t+"` is not supported"}},e.exports=t},64075:(e,t,i)=>{"use strict";i.d(t,{timeFrames:()=>r});i(20220);const r={"1d":{text:window.t("1D"),value:{value:"1D",type:"period-back"},targetResolution:"1",description:window.t("%d day",{plural:"%d days",count:1}).replace("%d","1")},"5d":{text:window.t("5D"),value:{value:"5D",type:"period-back"},targetResolution:"5",description:window.t("%d day",{plural:"%d days",count:5}).replace("%d","5")},"1m":{text:window.t("1M"),value:{value:"1M",type:"period-back"},targetResolution:"30",description:window.t("%d month",{plural:"%d months",count:1}).replace("%d","1")},"3m":{text:window.t("3M"),value:{value:"3M",type:"period-back"},targetResolution:"60",description:window.t("%d month",{plural:"%d months",count:3}).replace("%d","3")},"6m":{text:window.t("6M"),value:{value:"6M",type:"period-back"},targetResolution:"120",description:window.t("%d month",{plural:"%d months",count:6}).replace("%d","6")},ytd:{text:window.t("YTD"),value:{value:"YTD",type:"period-back"},targetResolution:"1D"},"12m":{text:window.t("1Y"),value:{value:"12M",type:"period-back"},targetResolution:"1D",description:window.t("%d year",{plural:"%d years",count:1}).replace("%d","1")},"60m":{text:window.t("5Y"),value:{value:"60M",type:"period-back"},targetResolution:"1W",description:window.t("%d year",{plural:"%d years",count:5}).replace("%d","5")},all:{text:window.t("All"),value:{value:"ALL",type:"period-back"},targetResolution:"1M"}}},14801:(e,t,i)=>{"use strict";i.d(t,{availableTimeFrames:()=>o});i(20220);var r=i(97786),s=i(64075);const n={[r.STATUS_DELAYED]:[s.timeFrames.ytd,s.timeFrames["12m"],s.timeFrames["60m"],s.timeFrames.all],[r.STATUS_READY]:[s.timeFrames["1d"],s.timeFrames["5d"],s.timeFrames["1m"],s.timeFrames["3m"],s.timeFrames["6m"],s.timeFrames.ytd,s.timeFrames["12m"],s.timeFrames["60m"],s.timeFrames.all]}
;function o(e,t){return t===r.STATUS_DELAYED_STREAMING&&(t=r.STATUS_READY),t===r.STATUS_EOD&&(t=r.STATUS_DELAYED),n[t]||[]}},5956:(e,t,i)=>{"use strict";i.d(t,{getTranslatedSymbolDescription:()=>o});var r=i(20220);const s=(0,i(98006).isFeatureEnabled)("short_descriptions");function n(e){const t=`#${e}-symbol-description`,i=(0,r.t)(t);return i===t?null:i}function o(e){if(void 0!==e.pro_name){const t=n(e.pro_name);if(null!==t)return t;if(void 0!==e.short_name){const t=n(e.short_name);if(null!==t)return t}}return"en"!==e.language&&void 0!==e.local_description&&e.language===window.language?e.local_description:s&&void 0!==e.short_description?e.short_description:"en"===e.language&&void 0!==e.local_description&&e.language===window.language?e.local_description:e.description||""}},11585:(e,t,i)=>{"use strict";function r(e){return e+"…"}i.r(t),i.d(t,{appendEllipsis:()=>r})},98388:(e,t,i)=>{"use strict";function r(e){let t=null;return(i,...r)=>(null==t||t.abort(),t=new AbortController,null==i||i.addEventListener("error",()=>null==t?void 0:t.abort(),{once:!0}),e(t.signal,...r))}function s(e){if(!l(e))throw e}function n(e){if(l(e))throw e}function o(e){return(null==e?void 0:e.aborted)?Promise.reject(a()):new Promise((t,i)=>{null==e||e.addEventListener("abort",()=>i(a()),{once:!0})})}function a(){return new DOMException("Aborted","AbortError")}function l(e){return e instanceof Error&&"AbortError"===e.name}function c(e,t){return Promise.race([o(e),t])}async function u(e,t){let i;try{await c(e,new Promise(e=>{i=setTimeout(e,t)}))}finally{clearTimeout(i)}}i.d(t,{respectLatest:()=>r,skipAbortError:()=>s,rethrowAbortError:()=>n,createAbortError:()=>a,isAbortError:()=>l,respectAbort:()=>c,delay:()=>u})},82713:(e,t,i)=>{"use strict";i.d(t,{callWhenOnline:()=>s,waitForOnline:()=>n});var r=i(98388);function s(e){let t=e;const i=()=>{window.removeEventListener("online",i),t&&t()};return window.addEventListener("online",i),()=>{t=null}}async function n(e=null){return!0===navigator.onLine||void 0===navigator.onLine?Promise.resolve():(0,r.respectAbort)(e,new Promise(e=>{const t=()=>{window.removeEventListener("online",t),e()};window.addEventListener("online",t)}))}},50077:(e,t,i)=>{"use strict";function r(e){return e.charAt(0).toUpperCase()+e.substr(1)}i.d(t,{capitalizeFirstLetter:()=>r})},32010:(e,t,i)=>{"use strict";function r(e,t,i,r,s){let n="";if(r=r?"; path="+r:"",s=s?"; domain="+s:"",i){const e=new Date;e.setTime(e.getTime()+24*i*60*60*1e3),n="; expires="+e.toUTCString()}else n="";document.cookie=e+"="+t+n+s+r}function s(e){const t=e+"=",i=document.cookie.split(";");for(let e=0;e<i.length;e++){let r=i[e];for(;" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}i.d(t,{set:()=>r,get:()=>s})},1694:(e,t,i)=>{"use strict";function r(e){let t;if("object"!=typeof e||null==e||"number"==typeof e.nodeType)t=e;else if(e instanceof Date)t=new Date(e.valueOf());else if(Array.isArray(e)){t=[];let i=0;const s=e.length;for(;i<s;i++)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=r(e[i]))
}else{t={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=r(e[i]))}return t}i.d(t,{deepCopy:()=>r})},21318:(e,t,i)=>{"use strict";function r(e,...t){return e&&"object"==typeof e?(0===t.length||t.forEach(t=>{null!=t&&"object"==typeof t&&Object.keys(t).forEach(i=>{const n=e[i],o=t[i];if(o===e)return;const a=Array.isArray(o);if(o&&(s(o)||a)){let t;t=a?n&&Array.isArray(n)?n:[]:n&&s(n)?n:{},e[i]=r(t,o)}else void 0!==o&&(e[i]=o)})}),e):e}function s(e){if(!e||"[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);if(!t)return!0;const i=Object.hasOwnProperty.toString,r=t.hasOwnProperty("constructor")&&t.constructor;return"function"==typeof r&&i.call(r)===i.call(Object)}i.d(t,{deepExtend:()=>r})},36757:(e,t,i)=>{"use strict";function r(e){if(void 0===e)return"";if(e instanceof Error){let t=e.message;return e.stack&&(t+=" "+e.stack),t}return"string"==typeof e?e.toString():JSON.stringify(e)}i.d(t,{errorToString:()=>r})},551:(e,t,i)=>{"use strict";i.d(t,{getTwemojiUrl:()=>s});var r=i(45623);function s(e,t){let i="";return r.default.parse(e,e=>(i=r.default.base+("svg"===t?`svg/${e}.svg`:`72x72/${e}.png`),!1)),i}},75443:(e,t,i)=>{"use strict";i.r(t),i.d(t,{guid:()=>s,randomHash:()=>n,randomHashN:()=>o});const r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function n(){return o(12)}function o(e){let t="";for(let i=0;i<e;++i){const e=Math.floor(Math.random()*r.length);t+=r[e]}return t}},24985:(e,t,i)=>{"use strict";function r(e){let t,i=0;if(0===e.length)return i;for(var r=0;r<e.length;r++)t=e.charCodeAt(r),i=(i<<5)-i+t,i&=i;return i}i.r(t),i.d(t,{hash:()=>r})},44385:(e,t,i)=>{"use strict";i.d(t,{listen:()=>l,pushBackListener:()=>c,disable:()=>u,enable:()=>d});var r=i(75443);const s=[];let n=null;function o(e){for(let t=0;t<s.length;t++)if(s[t].name===e)return t;return-1}function a(e){if(!n)for(let t=s.length-1;t>=0&&!0!==s[t].func(e);t--);}function l(e){e.addEventListener("keypress",a,!1)}function c(e,t){const i={name:e,func:t},r=o(i.name);r>-1&&s.splice(r,1),s.unshift(i)}function u(){return n?null:(n=(0,r.randomHashN)(4),n)}function d(e){if(e!==n)throw Error("Lock id is outdated");n=null}l(window)},13548:(e,t,i)=>{"use strict";i.d(t,{parseHtml:()=>s,parseHtmlElement:()=>n});const r=new WeakMap;function s(e,t){let i,s;return i=null==t?document.documentElement:9===t.nodeType?t.documentElement:t,r&&(s=r.get(i)),s||(s=i.ownerDocument.createRange(),s.selectNodeContents(i),r&&r.set(i,s)),s.createContextualFragment(e)}function n(e,t){const i=s(e,t);let r;if("firstElementChild"in i)r=i.firstElementChild;else{r=null;for(let e=0;e<i.childNodes.length;e++){const t=i.childNodes[e];if(1===t.nodeType){r=t;break}}}return null!==r&&i.removeChild(r),r}},37945:(e,t,i)=>{"use strict";function r(e,t){const i=Object.create(Object.getPrototypeOf(e));for(const r of t)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r]);return i}
i.d(t,{pickFields:()=>r})},53549:(e,t,i)=>{"use strict";function r(e){e.preventDefault()}i.d(t,{preventDefault:()=>r,preventDefaultForContextMenu:()=>n});const s=["input:not([type])",'input[type="text"]','input[type="email"]','input[type="password"]','input[type="search"]','input[type="number"]','input[type="url"]',"textarea","a[href]",'*[contenteditable="true"]',"[data-allow-context-menu]"];function n(e){const t=e.target;t&&!t.closest(s.join(", "))&&e.preventDefault()}},36170:(e,t,i)=>{"use strict";i.d(t,{htmlEscape:()=>n,removeSpaces:()=>o,capitalizeFirstLetterInWord:()=>a});const r=/[<"'&>]/g,s=e=>`&#${e.charCodeAt(0)};`;function n(e){return e.replace(r,s)}function o(e=""){return e.replace(/\s+/g,"")}function a(e=""){return e.replace(/\b\w/g,e=>e.toUpperCase())}},94972:(e,t,i)=>{"use strict";function r(e){return e.reduce((function(e,t,i){return~e.indexOf(t)||e.push(t),e}),[])}i.r(t),i.d(t,{uniq:()=>r})},17238:(e,t,i)=>{"use strict";function r(e){return decodeURIComponent(e.replace(/\+/g," ")).replace(/<\/?[^>]+(>|$)/g,"")}function s(e){const t=/([^&=]+)=?([^&]*)/g,i={};if(!e)return i;let s=t.exec(e);for(;s;)i[r(s[1])]=r(s[2]),s=t.exec(e);return i}function n(){return s(window.location.search.substring(1))}function o(){return s(window.location.hash.split("#")[1])}function a(e){const t=[];for(const i in e)e.hasOwnProperty(i)&&null!=e[i]&&t.push({key:i,pair:encodeURIComponent(i)+"="+encodeURIComponent(e[i])});return t.sort((e,t)=>e.key>t.key?1:e.key<t.key?-1:0).map(e=>e.pair).join("&")}i.r(t),i.d(t,{decode:()=>r,getQueryParams:()=>s,getUrlParams:()=>n,getHashUrlParams:()=>o,createUrlParams:()=>a})},50284:(e,t,i)=>{"use strict";function r(e){const t=document.createElement("a");return t.href=e,l(t)&&a(t)&&o(t)}function s(e){const t=document.createElement("a");return t.href=e,a(t)&&o(t)}function n(e){return!e.split(/(\s+)/).filter(e=>e.trim().length>0).some(e=>{try{const t=new URL(e);return!(!t||!t.hostname.length)&&!s(e)}catch(e){return!1}})}i.d(t,{isInternalUrl:()=>r,isSafeUrl:()=>s,validateUrlsInText:()=>n,isInternalHost:()=>c});const o=e=>!e.username,a=e=>"http:"===e.protocol||"https:"===e.protocol,l=e=>e.hostname===location.hostname||!/^\d+\.\d+\.\d+\.\d+$/.test(e.hostname)&&c(e.hostname);function c(e,t=window.location.hostname){const i="."===t.slice(-1)?3:2,r=t.toLowerCase().split(".").slice(-i),s=e.toLowerCase().split(".").slice(-r.length);return r.join(".")===s.join(".")}},44990:(e,t,i)=>{"use strict";i.d(t,{addUtmToUrl:()=>s});var r=i(61424);function s(e,t){if(!/([a-zA-Z0-9.-]*tradingview.com)|localhost/.test(e))return e;const i=(0,r.buildUtmQueryString)(t);if(""===i)return e;const s=e.indexOf("?"),n=e.indexOf("#"),o=-1!==n;if(-1!==s&&(!o||s<n)){return`${e.slice(0,s)}?${o?e.slice(s+1,n):e.slice(s+1)}&${i}${o?e.slice(n):""}`}if(o){return`${e.slice(0,n)}?${i}${e.slice(n)}`}return`${e}?${i}`}},96107:(e,t,i)=>{"use strict";var r;function s(e,t={}){const{page:i,query:s}=t;let n="/u/",o=!1,a=null;if(function(e){return e.is_broker||1===e.account_type}(e))switch(n="/broker/",i){case r.PublishedCharts:a="ideas/";break
;case r.FollowingPeople:a="following/";break;case r.Followers:a="followers/";break;case r.Reviews:a="reviews/";break;case r.Settings:case r.SettingsProfile:case r.Notifications:case r.Billing:n="/u/",o=!0}else o=!0;return"Guest"!==e.username&&(n+=e.username+"/"),s&&(n+="?"+s),void 0!==i&&(o?n+="#"+i:null!==a&&(n+=""+a)),n}i.r(t),i.d(t,{ProfilePages:()=>r,getUserProfilePath:()=>s}),function(e){e.Settings="settings",e.SettingsProfile="settings-profile",e.Notifications="notifications",e.Billing="billing",e.PublishedCharts="published-charts",e.FollowingPeople="following-people",e.Followers="followers",e.Reviews="reviews"}(r||(r={}))},61424:(e,t,i)=>{"use strict";i.d(t,{filterUtmInfo:()=>o,buildUtmQueryString:()=>a,buildUtmQueryStringFromUrlParams:()=>l});var r=i(17238),s=i(36170);const n=["utm_source","utm_medium","utm_campaign"];function o(e){const t={};return n.forEach(i=>{const r=e[i];"string"==typeof r&&""!==r&&(t[i]=(0,s.htmlEscape)(r))}),t}function a(e,t=!1){const i=(0,r.createUrlParams)(e);return i&&t?"?"+i:i}function l(e){return a(o((0,r.getUrlParams)()),e)}},95498:(e,t,i)=>{"use strict";function r(e,t=!1){("attachEvent"in document?"complete"===document.readyState:"loading"!==document.readyState)?t?setTimeout(()=>e(),1):e():document.addEventListener("DOMContentLoaded",()=>e())}i.d(t,{whenDocumentReady:()=>r,whenDocumentReadyPromise:()=>s});const s=new Promise(e=>{r(e)})},84257:(e,t,i)=>{"use strict";i.d(t,{visitPaymentPage:()=>d});var r=i(20220),s=i(13548),n=i(28308),o=i(65754),a=i(98006),l=i(77541),c=i(80271),u=i(90645);function d(e="y",t={}){var i;const d=null!==(i=t.productName)&&void 0!==i?i:"pro",h=t.paymentMethod||"paypal",p="bitcoin"===h?"Bitcoin payment":"Paypal payment";window.runOrSignIn(async()=>{if(await(0,c.check)())return void(0,u.showRestrictedCountryNotificationDialog)();if("function"==typeof t.canVisit&&!t.canVisit())return void(location.href="/");if((0,a.isFeatureEnabled)("braintree-trial-implementation"))return void(0,n.showPaymentOrderDialog)({productId:t.productName,billingCycle:t.exchangesOnly?o.BillingCycle.Monthly:e,fixedCycle:t.fixedCycle,statusExtraData:t.exchangesExpanded?l.StatusExtraData.Enable:void 0});const i=(0,s.parseHtmlElement)(`<form action="/order/" method="post" ${t.newWindow?'target="_blank"':""}>\n\t\t\t\t\t<input type="hidden" name="product" value="${d}"/>\n\t\t\t\t\t<input type="hidden" name="billing_cycle" value="${e}"/>\n\t\t\t\t\t<input type="hidden" name="fixed_billing_cycle" value="${t.fixedCycle?"1":""}"/>\n\t\t\t\t\t<input type="hidden" name="exchanges_only" value="${t.exchangesOnly?"1":""}"/>\n\t\t\t\t\t<input type="hidden" name="exchanges_expanded" value="${t.exchangesExpanded?"1":""}"/>\n\t\t\t\t\t<input type="hidden" name="selected_packages" value="${(t.selectedPackages||[]).join(",")}"/>\n\t\t\t\t\t<input type="hidden" name="payment_method" value="${h}"/>\n\t\t\t\t</form>`);i&&(document.body.appendChild(i),i.submit())},{source:p,paidAccountCheck:window.pro&&window.pro.getProduct(d).type===window.pro.PRODUCT_TYPES.pro_plan,paidAccountSuccessButtonText:(0,
r.t)("Continue purchasing")})}},43080:(e,t,i)=>{"use strict";i.d(t,{handleTVLinksClick:()=>n,sendWidgetTrackData:()=>o});var r=i(61424),s=i(50284);function n(){document.addEventListener("click",e=>{const t=e.target.closest(":link");if(!(null==t?void 0:t.hostname)||!(0,s.isInternalHost)(t.hostname,"tradingview.com"))return;const i=t.classList.contains("js-copyright-label")?"copyright":null;o(t.href,i)})}function o(e,t){const s=function(){const e=window.initData.hashSettings;if(Object.keys(e).length>0)return(0,r.filterUtmInfo)(e);const t=new URLSearchParams(location.href);return{utm_campaign:t.get("utm_campaign")||void 0,utm_source:t.get("utm_source")||void 0}}(),n=function(e){var t;const i=(null===(t=location.ancestorOrigins)||void 0===t?void 0:t[0])||document.referrer;return e.utm_source||(i.length>0?new URL(i).host:"")}(s);!async function(e){var t;null===(t=await async function(){const e=(await Promise.all([i.e(46797),i.e(36683)]).then(i.bind(i,47413))).getTrackerInstance();return e||null}())||void 0===t||t.trackWidgetTVLinkClick(e)}({widget_type:a(s),domain:n,link:e,target_type:t})}function a(e){if(e.utm_campaign)return e.utm_campaign;const t=location.pathname;return t.includes("embed-widget")?t.split("/")[2]:t}},64390:(e,t,i)=>{"use strict";i.d(t,{appendScript:()=>n,createImage:()=>o,marketingAnalyticsEnabled:()=>a,yandexAnalyticsEnabled:()=>l});var r=i(26357),s=i(98006);function n(e,t=!0){const i=document.createElement("script");i.async=t,i.src=e;const s=(0,r.getCspNonce)();return s&&i.setAttribute("nonce",s),document.head.appendChild(i),i}function o(e){const t=document.createElement("img");return t.src=e,t}function a(){return(0,s.isFeatureEnabled)("marketing-analytics")}function l(){return(0,s.isFeatureEnabled)("yandex_metric_enabled")}},25443:(e,t,i)=>{"use strict";i.d(t,{initGA:()=>a,trackTiming:()=>l});var r=i(4346),s=i(68724),n=i(64390);let o=!1;function a(){if(o)return;(0,r.updateInitData)();const e=(0,r.getInitData)();if(!e.gaId)return;o=!0,(0,n.appendScript)("https://www.googletagmanager.com/gtag/js?id="+(0,r.getInitData)().gaId),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date);const t={optimize_id:e.optimizeId,anonymize_ip:!0};window.TVD&&(t.app_name="TVD",t.app_version=(0,s.desktopAppVersion)()),e.gaVars&&window.gtag("set",e.gaVars),window.gtag("config",e.gaId,t)}function l(e,t,i,r){a(),window.gtag("event","timing_complete",{name:t,value:i,event_category:e,event_label:r})}},93010:(e,t,i)=>{"use strict";i.d(t,{asyncWindowOpen:()=>n});var r=i(40142);const s=i(20220).t("Loading...");const n=window.TVD||(0,r.isOnMobileAppPage)("any")?function(e){return e.then(e=>{void 0!==e&&open(e)},()=>{})}:async function(e){const t=URL.createObjectURL(new Blob([`<!doctype html><html style="background-color:${getComputedStyle(document.documentElement).backgroundColor}"><head><meta charset="utf-8"><title>${s}</title></head><body style="background-color:${getComputedStyle(document.body).backgroundColor}"></body></html>`],{type:"text/html"}));try{
const i=open(t);if(!i)throw new Error("cound not open a new tab");const r=await e.catch(()=>{});void 0!==r?i.location.replace(r):i.close()}finally{URL.revokeObjectURL(t)}}},28771:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ChartStorageChangesSubscription:()=>b,isChartStorageChangesSubscriptionSupported:()=>S});var r=i(16282),s=i(87380),n=i(98006),o=i(5958),a=i(4950);const l=(0,s.getLogger)("PersistentWebsocketTransport");class c extends a.PersistentTransport{constructor(e){super(e,l),this._specializedErrorHandlerBound=this._specializedErrorHandler.bind(this)}_createNativeTransport(e){const t=new EventSource(e,{withCredentials:!0});return t.addEventListener("error",this._specializedErrorHandlerBound),t.addEventListener("open",this._socketOpenHandler),t.addEventListener("message",this._socketMessageHandler),t}_disconnectTransport(){if(null===this._socket)return;this._socket.removeEventListener("error",this._specializedErrorHandlerBound),this._socket.removeEventListener("open",this._socketOpenHandler),this._socket.removeEventListener("message",this._socketMessageHandler),this._removeOnOfflineListener();const e=this._socket;this._socket=null,this._connectionStatus.setValue(o.ConnectionStatus.Closed),e.readyState!==WebSocket.CLOSED&&e.close()}_specializedErrorHandler(e){e.eventPhase===EventSource.CLOSED?this._socketCloseHandler(e):this._socketErrorHandler()}}var u=i(44431),d=i(71276),h=i(98388),p=i(32183);const _=new class{constructor(){this._timerWorker=null,this._timerIdCounter=1,this._timersMap=new Map,this._rejectsToCall=new Set,this._processMessage=e=>{const t=this._timersMap.get(e.data.turnaround);switch(e.data.type){case"timerCreated":t&&(t.scheduledForRemoving?("interval"===t.type?this._getTimerWorker().postMessage({type:"clearInterval",id:e.data.id}):this._getTimerWorker().postMessage({type:"clearTimeout",id:e.data.id}),this._deleteTimerFromMap(e.data.turnaround)):t.workerTimerId=e.data.id);break;case"timerFired":t&&(t.callback(),"timeout"===t.type&&this._deleteTimerFromMap(e.data.turnaround))}}}destroy(){var e;this._rejectsToCall.forEach(e=>e((0,h.createAbortError)())),null===(e=this._timerWorker)||void 0===e||e.terminate(),this._timerWorker=null,this._timersMap.clear()}setTimeout(e,t){return this._setTimeoutImpl(e,t,"timeout")}clearTimeout(e){const t=this._timersMap.get(e);t&&(t.workerTimerId?(this._getTimerWorker().postMessage({type:"clearTimeout",id:t.workerTimerId}),this._deleteTimerFromMap(e)):t.scheduledForRemoving=!0)}setInterval(e,t){const i=this._nextTimerId();return this._timersMap.set(i,{callback:e,type:"interval"}),this._getTimerWorker().postMessage({type:"setInterval",delay:t,turnaround:i}),i}clearInterval(e){const t=this._timersMap.get(e);t&&(t.workerTimerId?(this._getTimerWorker().postMessage({type:"clearInterval",id:t.workerTimerId}),this._deleteTimerFromMap(e)):t.scheduledForRemoving=!0)}async createTimeout(e,t){let i;return new Promise((r,s)=>{var n;i=s,this._rejectsToCall.add(i);const o=this.setTimeout(r,e);null===(n=null==t?void 0:t.signal)||void 0===n||n.addEventListener("abort",()=>{
this.clearTimeout(o),s((0,h.createAbortError)())})}).finally(()=>{this._rejectsToCall.delete(i)})}async*createInterval(e,t){let i=()=>{},r=e=>{};const s=this.setInterval(()=>{i()},e);t.signal.addEventListener("abort",()=>{this.clearInterval(s),r((0,h.createAbortError)())});try{for(;;)await new Promise((e,t)=>{i=e,this._rejectsToCall.delete(r),r=t,this._rejectsToCall.add(r)}),yield}catch(e){if(!(0,h.isAbortError)(e))throw e}}_getTimerWorker(){return null===this._timerWorker&&(this._timerWorker=new p,this._timerWorker.onmessage=this._processMessage),this._timerWorker}_setTimeoutImpl(e,t,i){const r=this._nextTimerId();return this._timersMap.set(r,{callback:e,type:i}),this._getTimerWorker().postMessage({type:"setTimeout",delay:t,turnaround:r}),r}_deleteTimerFromMap(e){if(this._timersMap.delete(e),0===this._timersMap.size){const e=this._setTimeoutImpl(()=>{var t;1===this._timersMap.size&&this._timersMap.has(e)&&(this._timersMap.delete(e),null===(t=this._timerWorker)||void 0===t||t.terminate(),this._timerWorker=null)},6e4,"terminal_timer")}}_nextTimerId(){return this._timerIdCounter++}};var m=i(96276),f=i.n(m),g=i(68724);function v(){const e=document.querySelector('link[rel~="chart-storage-notifications"]');return(null==e?void 0:e.href)?new URL(e.href):null}function S(e,t){return Boolean(e.metaInfo.uid.value())&&!t.containsData&&!t.onWidget&&(0,n.isFeatureEnabled)("subscribe_line_tool_notifications")&&!g.CheckMobile.Android()&&null!==v()}const y=(0,s.getLogger)("ChartStorageChangesSubscription");class b extends c{constructor(e){super(e=>this._onMessage(e)),this._destroyed=!1,this._onChangeVisibilityBound=this._onChangeVisibility.bind(this),this._hibernateTimerId=null,this._beforeUnhibernating=new(f()),this._chartWidgetsCollection=e,this._layoutVisibility=e.resizerBridge().visible.spawn(),this._layoutVisibility.subscribe(this._onChangeVisibilityBound,{callWithLast:!0}),this.connect()}destroy(){var e;null===(e=this._layoutVisibility)||void 0===e||e.destroy(),this.disconnect(),this._destroyed=!0}beforeUnhibernating(){return this._beforeUnhibernating}async _prepareParamsForConnection(e){const t=this._chartWidgetsCollection.metaInfo.uid.value();if(this._destroyed)return Promise.reject("Subscription is being destroyed");const i=await(0,u.getToken)(t,e),s=(0,r.ensureNotNull)(v());s.searchParams.delete("jwt"),s.searchParams.append("jwt",i),this._url=s.toString()}_onMessage(e){if("string"!=typeof e)throw new Error("Wrong message type, expected string");const t=JSON.parse(e);Object.entries(t).forEach(e=>{const t=(0,d.parseLineToolsAndGroupsDTO)(e[1],"");this._chartWidgetsCollection.applyLineToolUpdateNotification(e[0],t)})}_onChangeVisibility(){const e=(0,r.ensureDefined)(this._layoutVisibility).value();e&&this.connectionStatus().value()===o.ConnectionStatus.Closed?(this.connect(),this._beforeUnhibernating.fire(),y.logNormal("Connect due to becoming visible")):e||(null!==this._hibernateTimerId&&_.clearTimeout(this._hibernateTimerId),this._hibernateTimerId=_.setTimeout(()=>this._disconnectIfInvisible(),6e4))}_disconnectIfInvisible(){
!(0,r.ensureDefined)(this._layoutVisibility).value()&&(0,n.isFeatureEnabled)("hibernate_line_tool_notifications")&&(y.logNormal("Disconnect due to becoming invisible"),this.disconnect())}}},50137:(e,t,i)=>{"use strict";i.d(t,{getChartStorage:()=>n});var r=i(71276);let s=null;function n(){return null===s&&(s=new r.ChartStorageHttp),s}},71276:(e,t,i)=>{"use strict";i.d(t,{parseLineToolsAndGroupsDTO:()=>a,ChartStorageHttp:()=>l});var r=i(85864),s=i(5013),n=i(44431);function o(){const e=document.querySelector('link[rel~="chart-storage"]'),t=new URL((null==e?void 0:e.href)||"/charts-storage/",location.href);return t.pathname.endsWith("/")||(t.pathname+="/"),t}function a(e,t){const i={sources:new Map,groups:new Map};for(const t in e.sources||{}){const r=e.sources[t];i.sources.set(t,r)}for(const t in e.drawing_groups||{}){const r=e.drawing_groups[t];i.groups.set(t,r)}return null!==t&&(i.serverRequestId=t),i.clientId=e.clientId,i}class l{constructor(){this._lastSaveRequest=Promise.resolve(),this._requestsCounter=0}async saveLineToolsAndGroups(e,t,i){if(""===e||void 0===e)return Promise.reject("Unnamed chart cannot be saved");const a=`${e}.${t}.${this._requestsCounter++}`,l="ChartStorage.Save.TotallyProcessing."+a,c=(0,s.perfMeasureOperation)(l,()=>this._lastSaveRequest.then(async()=>{const l="ChartStorage.Save.GettingToken."+a,c=await(0,s.perfMeasureOperation)(l,()=>(0,n.getToken)(e)),u=new URL(`layout/${e}/sources`,o());u.searchParams.append("chart_id",t),u.searchParams.append("jwt",c);const d=function(e){const t={sources:{}};return e.sources.forEach((e,i)=>{t.sources[i]=e}),t.drawing_groups={},e.groups.forEach((e,i)=>{t.drawing_groups[i]=e}),t.clientId=e.clientId,JSON.stringify(t)}(i),h="ChartStorage.Save.GettingResponse."+a;return(0,s.perfMeasureOperation)(h,()=>(0,r.fetch)(u.toString(),{method:"PUT",headers:{"Content-Type":"application/json","X-BUILD-TIME":window.BUILD_TIME},credentials:"include",body:d}).then(e=>{if(!e.ok)throw new Error("Response status is not success");return e.json()}).then(r=>({content:r,savedDto:i,layoutId:e,chartId:t})))}));return this._lastSaveRequest=c.catch(()=>{}),c}async loadLineToolsAndGroups(e,t,i){if(""===e||void 0===e)return{sources:new Map,groups:new Map};const l=`${e}.${t}.${i.requestType}.${this._requestsCounter++}`,c="ChartStorage.Load.GettingToken."+l,u=await(0,s.perfMeasureOperation)(c,()=>(0,n.getToken)(e)),d=new URL(`layout/${e}/sources`,o());switch(d.searchParams.append("chart_id",t),d.searchParams.append("jwt",u),i.requestType){case"mainSeriesLineTools":d.searchParams.append("symbol",i.symbol),d.searchParams.append("includeOwnerSource",i.seriesSourceId),d.searchParams.append("brokerName",i.brokerName);break;case"studiesLineTools":d.searchParams.append("excludeOwnerSource",i.seriesSourceId);break;case"lineToolsWithoutSymbol":d.searchParams.append("symbol",""),d.searchParams.append("includeOwnerSource",i.seriesSourceId)}const h="ChartStorage.Load.GettingResponse."+l;return(0,s.perfMeasureOperation)(h,()=>(0,r.fetch)(d.toString(),{method:"GET",credentials:"include"}).then(e=>{
if(!e.ok)throw new Error("Response status is not success");const t=e.headers.get("X-Request-Id");return e.json().then(e=>{if(null===e)throw new Error("Body is null");if(!e.success)throw new Error("Response is not success");return a(e.payload||{},t)})}))}async removeLineTools(e,t,i){if(""===e||void 0===e)return!1;const a=`${e}.${t}.${this._requestsCounter++}`,l="ChartStorage.Remove.GettingToken."+a,c=await(0,s.perfMeasureOperation)(l,()=>(0,n.getToken)(e)),u=new URL(`layout/${e}/sources`,o());u.searchParams.append("chart_id",t),u.searchParams.append("jwt",c),void 0!==i&&u.searchParams.append("symbol",i);const d="ChartStorage.Remove.GettingResponse."+a;return(0,s.perfMeasureOperation)(d,()=>(0,r.fetch)(u.toString(),{method:"DELETE",credentials:"include"}).then(e=>{if(!e.ok)throw new Error("Response status is not success");return e.json().then(e=>{if(null===e)throw new Error("Body is null");if(!e.success)throw new Error("Response is not success");return!0})}))}async getLayoutDrawingsSizeInfo(e,t){if(""===e||void 0===e)return{charts:new Map,countSourcesTotal:0,limitBytesTotal:0,sizeBytesTotal:0};const i=`${e}.${t}.${this._requestsCounter++}`,a="ChartStorage.GetSizes.GettingToken."+i,l=await(0,s.perfMeasureOperation)(a,()=>(0,n.getToken)(e)),c=new URL(`layout/${e}/sizes`,o());c.searchParams.append("jwt",l);const u="ChartStorage.GetSizes.GettingResponse."+i;return(0,s.perfMeasureOperation)(u,()=>(0,r.fetch)(c.toString(),{method:"GET",credentials:"include"}).then(e=>{if(!e.ok)throw new Error("Response status is not success");return e.json().then(e=>{if(null===e)throw new Error("Body is null");if(!e.success)throw new Error("Response is not success");return function(e){const t=new Map;for(const i in e.charts||{}){const r=e.charts[i].symbols,s=new Map;for(const e in r||{}){const t=r[e],i={countSources:t.countSources,sizeBytes:t.sizeBytes,ids:t.ids};s.set(e,i)}t.set(i,s)}return{charts:t,countSourcesTotal:e.countSourcesTotal,limitBytesTotal:e.limitBytesTotal,sizeBytesTotal:e.sizeBytesTotal}}(e.payload||{})})}))}}},44431:(e,t,i)=>{"use strict";i.d(t,{getToken:()=>s});var r=i(98388);async function s(e,t){const i=new URL("/chart-token/",location.href);i.searchParams.append("image_url",e);const s=window.user.id||-1;i.searchParams.append("user_id",""+s);const n=await fetch(i.toString(),{signal:t});if(!n.ok)throw new Error(`Http response is not ok: ${n.status}}`);const o=await n.json();if(null==t?void 0:t.aborted)throw(0,r.createAbortError)();return o.token}},3426:(e,t,i)=>{"use strict";function r(e){return s(e,null)}function s(e,t){const i=e.files&&e.files.length>0;if(!i&&t&&t.eventPhase>0)return n(t,e),Promise.resolve();if(!i){let t=!1;const i=i=>{i.stopImmediatePropagation(),n(i,e),t=!0};try{document.addEventListener("copy",i,!0),document.execCommand("copy")}finally{document.removeEventListener("copy",i,!0)}if(t)return Promise.resolve()}return async function(e){if(!navigator.clipboard||!navigator.clipboard.write||!window.ClipboardItem)throw new DOMException("ClipboardApi is not supported","NotSupportedError");const t={}
;for(const i of e.files||[])t[i.type]=i;e.text&&(t["text/plain"]=e.text);e.html&&(t["text/html"]=e.html);return navigator.clipboard.write([new window.ClipboardItem(t)])}(e)}function n(e,t){e.preventDefault();const i=e.clipboardData;t.text&&i.setData("text/plain",t.text),t.html&&i.setData("text/html",t.html)}async function o(e,t){if("text/plain"===t&&!navigator.clipboard.write){const t=await e;return navigator.clipboard.writeText(await t.text())}if(!navigator.clipboard||!navigator.clipboard.write||!window.ClipboardItem)throw new DOMException("ClipboardApi is not supported","NotSupportedError");let i=null;try{i=new window.ClipboardItem({[t]:e})}catch(r){i=new window.ClipboardItem({[t]:await e})}if(i)return navigator.clipboard.write([i]);throw new Error("ClipboardApi is not supported")}i.d(t,{copyToClipboard:()=>r,writeImpl:()=>s,writePromiseUsingApi:()=>o})},2441:(e,t,i)=>{"use strict";i.d(t,{isCountryCode:()=>a,toCountryCode:()=>l,getIsoCountryCodeFromLocale:()=>c});var r=i(87380),s=i(10334);const n=(0,r.getLogger)("Lib.CountryCode"),o=/^[A-Z]{2}$/;function a(e){return o.test(e)}function l(e){if(a(e))return e;throw new Error("Invalid country code")}function c(e){var t,i;try{return l(null===(i=null===(t=s[e])||void 0===t?void 0:t.geoip_code)||void 0===i?void 0:i.toUpperCase())}catch(t){return n.logError(`Get ISO country code from locale "${e}" failed: ${t.message}`),l(s.en.geoip_code.toUpperCase())}}},26357:(e,t,i)=>{"use strict";function r(){const e=document.querySelector("script[nonce]");if(null!==e)return e.getAttribute("nonce")||e.nonce}i.d(t,{getCspNonce:()=>r})},24754:(e,t,i)=>{"use strict";function r(e){if(void 0===e)return null;const t=e.match(/(delayed_streaming)_([\d]{1,4})/);return null===t?null:{mode:t[1],interval:parseInt(t[2])}}i.d(t,{parseUpdateMode:()=>r})},57014:(e,t,i)=>{"use strict";var r,s;i.r(t),i.d(t,{WeekDays:()=>r,Months:()=>s}),function(e){e[e.SUNDAY=1]="SUNDAY",e[e.MONDAY=2]="MONDAY",e[e.TUESDAY=3]="TUESDAY",e[e.WEDNESDAY=4]="WEDNESDAY",e[e.THURSDAY=5]="THURSDAY",e[e.FRIDAY=6]="FRIDAY",e[e.SATURDAY=7]="SATURDAY"}(r||(r={})),function(e){e[e.JANUARY=0]="JANUARY",e[e.FEBRUARY=1]="FEBRUARY",e[e.MARCH=2]="MARCH",e[e.APRIL=3]="APRIL",e[e.MAY=4]="MAY",e[e.JUNE=5]="JUNE",e[e.JULY=6]="JULY",e[e.AUGUST=7]="AUGUST",e[e.SEPTEMBER=8]="SEPTEMBER",e[e.OCTOBER=9]="OCTOBER",e[e.NOVEMBER=10]="NOVEMBER",e[e.DECEMBER=11]="DECEMBER"}(s||(s={}))},80697:(e,t,i)=>{"use strict";i.r(t),i.d(t,{monthsFullNames:()=>n,monthsShortNames:()=>o,weekDaysFullNames:()=>a,weekDaysShortNames:()=>l,weekDaysMiniNames:()=>c});var r=i(20220),s=i(57014);const n={[s.Months.JANUARY]:(0,r.t)("January"),[s.Months.FEBRUARY]:(0,r.t)("February"),[s.Months.MARCH]:(0,r.t)("March"),[s.Months.APRIL]:(0,r.t)("April"),[s.Months.MAY]:(0,r.t)("May"),[s.Months.JUNE]:(0,r.t)("June"),[s.Months.JULY]:(0,r.t)("July"),[s.Months.AUGUST]:(0,r.t)("August"),[s.Months.SEPTEMBER]:(0,r.t)("September"),[s.Months.OCTOBER]:(0,r.t)("October"),[s.Months.NOVEMBER]:(0,r.t)("November"),[s.Months.DECEMBER]:(0,r.t)("December")},o={[s.Months.JANUARY]:(0,r.t)("Jan"),
[s.Months.FEBRUARY]:(0,r.t)("Feb"),[s.Months.MARCH]:(0,r.t)("Mar"),[s.Months.APRIL]:(0,r.t)("Apr"),[s.Months.MAY]:(0,r.t)("May",{context:"short"}),[s.Months.JUNE]:(0,r.t)("Jun"),[s.Months.JULY]:(0,r.t)("Jul"),[s.Months.AUGUST]:(0,r.t)("Aug"),[s.Months.SEPTEMBER]:(0,r.t)("Sep"),[s.Months.OCTOBER]:(0,r.t)("Oct"),[s.Months.NOVEMBER]:(0,r.t)("Nov"),[s.Months.DECEMBER]:(0,r.t)("Dec")},a={[s.WeekDays.SUNDAY]:(0,r.t)("Sunday"),[s.WeekDays.MONDAY]:(0,r.t)("Monday"),[s.WeekDays.TUESDAY]:(0,r.t)("Tuesday"),[s.WeekDays.WEDNESDAY]:(0,r.t)("Wednesday"),[s.WeekDays.THURSDAY]:(0,r.t)("Thursday"),[s.WeekDays.FRIDAY]:(0,r.t)("Friday"),[s.WeekDays.SATURDAY]:(0,r.t)("Saturday")},l={[s.WeekDays.SUNDAY]:(0,r.t)("Sun"),[s.WeekDays.MONDAY]:(0,r.t)("Mon"),[s.WeekDays.TUESDAY]:(0,r.t)("Tue"),[s.WeekDays.WEDNESDAY]:(0,r.t)("Wed"),[s.WeekDays.THURSDAY]:(0,r.t)("Thu"),[s.WeekDays.FRIDAY]:(0,r.t)("Fri"),[s.WeekDays.SATURDAY]:(0,r.t)("Sat")},c={[s.WeekDays.SUNDAY]:(0,r.t)("Su",{context:"day_of_week"}),[s.WeekDays.MONDAY]:(0,r.t)("Mo",{context:"day_of_week"}),[s.WeekDays.TUESDAY]:(0,r.t)("Tu",{context:"day_of_week"}),[s.WeekDays.WEDNESDAY]:(0,r.t)("We",{context:"day_of_week"}),[s.WeekDays.THURSDAY]:(0,r.t)("Th",{context:"day_of_week"}),[s.WeekDays.FRIDAY]:(0,r.t)("Fr",{context:"day_of_week"}),[s.WeekDays.SATURDAY]:(0,r.t)("Sa",{context:"day_of_week"})}},57137:(e,t,i)=>{"use strict";function r(){let e,t;return{promise:new Promise((i,r)=>{e=i,t=r}),reject:t,resolve:e}}i.d(t,{createDeferredPromise:()=>r})},74174:(e,t,i)=>{"use strict";var r,s;i.d(t,{ParentEvents:()=>r,IFrameEvents:()=>s}),function(e){let t;!function(e){e.SetSymbol="set-symbol",e.SetInterval="set-interval"}(t=e.Names||(e.Names={}))}(r||(r={})),function(e){let t;!function(e){e.SymbolClick="tv-widget-symbol-click",e.WidgetLoad="tv-widget-load",e.ResizeIframe="tv-widget-resize-iframe",e.NoData="tv-widget-no-data"}(t=e.Names||(e.Names={}))}(s||(s={}))},75657:(e,t,i)=>{"use strict";function r(e,t,i){const r={name:e,frameElementId:t,data:i};window.parent.postMessage(r,"*")}function s(e,t){function i(i){i.data&&i.data.name&&i.data.name===e&&t(i.data.data)}return window.addEventListener("message",i,!1),()=>{window.removeEventListener("message",i,!1)}}i.d(t,{dispatchEventToParent:()=>r,listenEventFromParent:()=>s})},11767:(e,t,i)=>{"use strict";function r(e=location.host){return-1!==["i18n.tradingview.com","partial.tradingview.com","www.tradingview.com","wwwcn.tradingview.com"].indexOf(e)||-1!==["d33t3vvu2t2yu5.cloudfront.net","dwq4do82y8xi7.cloudfront.net","s.tradingview.com","s3.tradingview.com"].indexOf(e)||e.match(/^[a-z]{2}\.tradingview\.com/)||e.match(/prod-[^.]+.tradingview.com/)?"battle":e.includes("tradingview.com")||e.includes("staging")?"staging":e.match(/webcharts/)?"staging_local":(e.match(/^localhost(:\d+)?$/),"local")}function s(){return"local"===r()}function n(){return"battle"===r()}function o(){return!n()}i.r(t),i.d(t,{environment:()=>r,isLocal:()=>s,isProd:()=>n,isDebug:()=>o})},93207:(e,t,i)=>{"use strict";i.d(t,{preventDefault:()=>s,wrapHandlerWithPreventEvent:()=>n,
preventScrollByWheelClick:()=>o});var r=i(68724);function s(e){e.cancelable&&e.preventDefault()}function n(e){return t=>{s(t),e()}}function o(e){r.isChrome&&e.addEventListener("mousedown",e=>{if(1===e.button)return e.preventDefault(),!1})}},65255:(e,t,i)=>{"use strict";i.d(t,{exchanges:()=>s});i(20220);var r=i(18152);const s=r},3851:(e,t,i)=>{"use strict";i.d(t,{enabled:()=>l,getConfig:()=>c})
;const r=JSON.parse('{"free":{"CHART_STORAGE":{"limit":1},"MULTIPLE_CHARTS":{"limit":1},"INDICATORS_ON_CHART":{"limit":3},"HISTORICAL_BARS":{"limit":5},"STUDY_ON_STUDY":{"limit":270,"child_limit":1},"SERVER_SIDE_ALERTS":{"limit":1},"SCREENER_ALERTS":{"limit":1},"SCREENER_INTERVALS":{"interval":["1D","1W","1M"]},"STUDY_TEMPLATES":{"limit":1},"SIMULTANEOUS_CONNECTIONS":{"limit":1},"IDEA_SOCIAL_LINKS":{"socials":["Twitter","Youtube"]}},"__legacy_pro":{"CHART_STORAGE":{"limit":99999},"MULTIPLE_CHARTS":{"limit":8},"CUSTOM_INTERVALS":{},"MULTIPLE_WATCHLISTS":{},"IMPORT_WATCHLISTS":{},"EXPORT_WATCHLISTS":{},"INDICATORS_ON_CHART":{"limit":99999},"HISTORICAL_BARS":{"limit":10},"TV_VOLUMEBYPRICE":{"study_packages":["tv-volumebyprice"]},"STUDY_ON_STUDY":{"limit":270,"child_limit":99999},"TICK_BY_TICK_PUSH_DATA":{},"SERVER_SIDE_ALERTS":{"limit":20},"SCREENER_ALERTS":{"limit":99999},"SCREENER_AUTO_REFRESH":{},"SCREENER_EXPORT_DATA":{},"DEEP_HISTORY_BACKTEST":{},"SCREENER_INTERVALS":{"interval":["1m","5m","15m","30m","1h","2h","4h","1D","1W","1M"]},"NO_SPONSORED_ADS":{},"STUDY_TEMPLATES":{"limit":99999},"SIMULTANEOUS_CONNECTIONS":{"limit":1},"IDC_AVAILABLE_DELAY":{},"STATUS":{"disable_on_trial":true},"MULTIFLAGGED_SYMBOLS_LISTS":{},"BAR_REPLAY_INTRADAY":{},"SHOWS":{"disable_on_trial":true},"ALERTS_WEBHOOK":{},"DEEP_FUNDAMENTALS_HISTORY":{},"IDEA_SOCIAL_LINKS":{"socials":["Twitter","Youtube"]},"EXTENDED_SOCIAL_LINKS":{"socials":["Facebook","Instagram"],"disable_on_trial":true},"MULTI_MONITOR":{},"PUBLISH_PROTECTED_SCRIPTS":{"disable_on_trial":true}},"__legacy_pro_realtime":{"extends":"__legacy_pro","TV_PROSTUDIES":{"study_packages":["tv-prostudies"]},"SERVER_SIDE_ALERTS":{"limit":1000},"CAN_EDIT_PUBLIC_CHATS":{"disable_on_trial":true},"EXPORT_CHART_DATA":{},"CUSTOM_FORMULAS":{},"INTRADAY_EXOTIC_CHARTS":{}},"__legacy_pro_premium":{"extends":"__legacy_pro_realtime","ALERTS_TRUE_SMS":{"disable_on_trial":true},"HISTORICAL_BARS":{"limit":20},"IDEA_SIGNATURE":{"disable_on_trial":true},"PROFILE_WEBSITE_FIELD":{"disable_on_trial":true},"ALERTS_NO_EXPIRATION":{},"PUBLISH_INVITE_ONLY_SCRIPTS":{"disable_on_trial":true},"EXPORT_CHART_DATA":{},"ALERTS_ON_SECONDS":{},"PERMANENT_STREAM_RECORDS":{},"EXTENDED_SOCIAL_LINKS":{"socials":["Facebook","Instagram","Website"],"disable_on_trial":true},"SECONDS_INTERVALS":{}},"pro":{"CHART_STORAGE":{"limit":5},"MULTIPLE_CHARTS":{"limit":2},"CUSTOM_INTERVALS":{},"MULTIPLE_WATCHLISTS":{},"IMPORT_WATCHLISTS":{},"EXPORT_WATCHLISTS":{},"INDICATORS_ON_CHART":{"limit":5},"HISTORICAL_BARS":{"limit":10},"TV_VOLUMEBYPRICE":{"study_packages":["tv-volumebyprice"]},"STUDY_ON_STUDY":{"limit":270,"child_limit":1},"TICK_BY_TICK_PUSH_DATA":{},"SERVER_SIDE_ALERTS":{"limit":20},"SCREENER_ALERTS":{"limit":99999},"SCREENER_AUTO_REFRESH":{},"SCREENER_EXPORT_DATA":{},"DEEP_HISTORY_BACKTEST":{},"SCREENER_INTERVALS":{"interval":["1m","5m","15m","30m","1h","2h","4h","1D","1W","1M"]},"NO_SPONSORED_ADS":{},"STUDY_TEMPLATES":{"limit":99999},"SIMULTANEOUS_CONNECTIONS":{"limit":1},"IDC_AVAILABLE_DELAY":{},"STATUS":{"disable_on_trial":true},"BAR_REPLAY_INTRADAY":{},"MULTIFLAGGED_SYMBOLS_LISTS":{},"SHOWS":{"disable_on_trial":true},"ALERTS_WEBHOOK":{},"DEEP_FUNDAMENTALS_HISTORY":{},"PUBLISH_PROTECTED_SCRIPTS":{"disable_on_trial":true},"IDEA_SOCIAL_LINKS":{"socials":["Twitter","Youtube"]},"EXTENDED_SOCIAL_LINKS":{"socials":["Facebook","Instagram"],"disable_on_trial":true},"MULTI_MONITOR":{}},"pro_realtime":{"extends":"pro","CHART_STORAGE":{"limit":10},"MULTIPLE_CHARTS":{"limit":4},"INDICATORS_ON_CHART":{"limit":10},"TV_PROSTUDIES":{"study_packages":["tv-prostudies"]},"STUDY_ON_STUDY":{"limit":270,"child_limit":9},"SERVER_SIDE_ALERTS":{"limit":100},"CAN_EDIT_PUBLIC_CHATS":{"disable_on_trial":true},"SIMULTANEOUS_CONNECTIONS":{"limit":2},"EXPORT_CHART_DATA":{},"CUSTOM_FORMULAS":{},"INTRADAY_EXOTIC_CHARTS":{}},"pro_premium":{"extends":"pro_realtime","CHART_STORAGE":{"limit":99999},"MULTIPLE_CHARTS":{"limit":8},"INDICATORS_ON_CHART":{"limit":25},"HISTORICAL_BARS":{"limit":20},"STUDY_ON_STUDY":{"limit":270,"child_limit":24},"SERVER_SIDE_ALERTS":{"limit":400},"SIMULTANEOUS_CONNECTIONS":{"limit":5},"ALERTS_TRUE_SMS":{"disable_on_trial":true},"IDEA_SIGNATURE":{"disable_on_trial":true},"PROFILE_WEBSITE_FIELD":{"disable_on_trial":true},"ALERTS_NO_EXPIRATION":{},"PUBLISH_INVITE_ONLY_SCRIPTS":{"disable_on_trial":true},"EXPORT_CHART_DATA":{},"ALERTS_ON_SECONDS":{},"PERMANENT_STREAM_RECORDS":{},"EXTENDED_SOCIAL_LINKS":{"socials":["Facebook","Instagram","Website"],"disable_on_trial":true},"SECONDS_INTERVALS":{}},"pro_mini_alerts":{"extends":"free","SERVER_SIDE_ALERTS":{"limit":30},"SCREENER_ALERTS":{"limit":99999},"SHOWS":{"disable_on_trial":true},"IDC_AVAILABLE_DELAY":{},"DEEP_FUNDAMENTALS_HISTORY":{}},"pro_mini_ads":{"extends":"free","NO_SPONSORED_ADS":{},"SHOWS":{"disable_on_trial":true},"IDC_AVAILABLE_DELAY":{},"DEEP_FUNDAMENTALS_HISTORY":{}},"pro_mini_layouts":{"extends":"free","MULTIPLE_CHARTS":{"limit":8},"SHOWS":{"disable_on_trial":true},"IDC_AVAILABLE_DELAY":{},"DEEP_FUNDAMENTALS_HISTORY":{}},"pro_edu":{"extends":"free","CHART_STORAGE":{"limit":3},"MULTIPLE_CHARTS":{"limit":2},"MULTIPLE_WATCHLISTS":{},"IMPORT_WATCHLISTS":{},"EXPORT_WATCHLISTS":{},"TICK_BY_TICK_PUSH_DATA":{},"SERVER_SIDE_ALERTS":{"limit":5},"SCREENER_ALERTS":{"limit":99999},"SHOWS":{"disable_on_trial":true},"IDC_AVAILABLE_DELAY":{},"DEEP_FUNDAMENTALS_HISTORY":{}}}'),s=JSON.parse('{"cme":{"INDICATORS_ON_CHART":{"limit":99999}},"bovespa":{"INDICATORS_ON_CHART":{"limit":99999}},"qecomqa":{"INDICATORS_ON_CHART":{"limit":99999}}}')
;var n=i(5803),o=i(8276),a=i(88015);function l(e,t,i){let r=window.user;i&&(r=i);const s=c(e,t,r);return!!s&&!(s[n.ProductFeatures.DISABLE_ON_TRIAL]&&(!r||r.is_trial))}function c(e,t,i){var n;let l=function e(t){const i=r[t];return i?i.extends?Object.assign({},e(i.extends),i):i:null}(t||function(e){let t=window.user;e&&(t=e);let i=(null==t?void 0:t.pro_plan)||o.ProPlans.Free;const r=i!==o.ProPlans.Free&&!(0,a.isTrialProduct)(i);return r||(i=(0,a.getProductForTrial)(i)),r&&t&&!t.is_pro_limited&&!t.new_pro_product_line&&(i="__legacy_"+i),i}(i));if(!l)return null;const c=null===(n=window.TradingView)||void 0===n?void 0:n.widgetCustomer;return c&&s[c]&&(l=Object.assign({},l,s[c])),l&&l[e]||null}},5803:(e,t,i)=>{"use strict";var r;i.d(t,{ProductFeatures:()=>r}),function(e){e.DISABLE_ON_TRIAL="disable_on_trial",e.CUSTOM_INTERVALS="CUSTOM_INTERVALS",e.CHART_STORAGE="CHART_STORAGE",e.MULTIPLE_CHARTS="MULTIPLE_CHARTS",e.MULTIPLE_WATCHLISTS="MULTIPLE_WATCHLISTS",e.IMPORT_WATCHLISTS="IMPORT_WATCHLISTS",e.EXPORT_WATCHLISTS="EXPORT_WATCHLISTS",e.INDICATORS_ON_CHART="INDICATORS_ON_CHART",e.STUDY_ON_STUDY="STUDY_ON_STUDY",e.TICK_BY_TICK_PUSH_DATA="TICK_BY_TICK_PUSH_DATA",e.SERVER_SIDE_ALERTS="SERVER_SIDE_ALERTS",e.ALERTS_TRUE_SMS="ALERTS_TRUE_SMS",e.PUBLISH_INVITE_ONLY_SCRIPTS="PUBLISH_INVITE_ONLY_SCRIPTS",e.PUBLISH_PROTECTED_SCRIPTS="PUBLISH_PROTECTED_SCRIPTS",e.SCREENER_ALERTS="SCREENER_ALERTS",e.SCREENER_AUTO_REFRESH="SCREENER_AUTO_REFRESH",e.SCREENER_EXPORT_DATA="SCREENER_EXPORT_DATA",e.SCREENER_INTERVALS="SCREENER_INTERVALS",e.SIMULTANEOUS_CONNECTIONS="SIMULTANEOUS_CONNECTIONS",e.STUDY_TEMPLATES="STUDY_TEMPLATES",e.CAN_EDIT_PUBLIC_CHATS="CAN_EDIT_PUBLIC_CHATS",e.NO_SPONSORED_ADS="NO_SPONSORED_ADS",e.IDC_AVAILABLE_DELAY="IDC_AVAILABLE_DELAY",e.STATUS="STATUS",e.ALERTS_NO_EXPIRATION="ALERTS_NO_EXPIRATION",e.MULTIFLAGGED_SYMBOLS_LISTS="MULTIFLAGGED_SYMBOLS_LISTS",e.BAR_REPLAY_INTRADAY="BAR_REPLAY_INTRADAY",e.TV_VOLUMEBYPRICE="TV_VOLUMEBYPRICE",e.ALERTS_WEBHOOK="ALERTS_WEBHOOK",e.DEEP_FUNDAMENTALS_HISTORY="DEEP_FUNDAMENTALS_HISTORY",e.EXPORT_CHART_DATA="EXPORT_CHART_DATA",e.ALERTS_ON_SECONDS="ALERTS_ON_SECONDS",e.PERMANENT_STREAM_RECORDS="PERMANENT_STREAM_RECORDS",e.IDEA_SOCIAL_LINKS="IDEA_SOCIAL_LINKS",e.EXTENDED_SOCIAL_LINKS="EXTENDED_SOCIAL_LINKS",e.DEEP_HISTORY_BACKTEST="DEEP_HISTORY_BACKTEST"}(r||(r={}))},79200:(e,t,i)=>{"use strict";i.d(t,{reloginOrGoPro:()=>h,runOrGoPro:()=>d,runOrGoProWithoutSync:()=>u});var r=i(44439),s=i(23946),n=i(3851),o=i(5803);function a(e,t,i){return t.value||(0,n.enabled)(e,i)}function l(e,t,i){switch(e){case o.ProductFeatures.SCREENER_INTERVALS:return function(e,t){const i=(0,n.getConfig)(o.ProductFeatures.SCREENER_INTERVALS,t);return!(!i||!i.interval)&&i.interval.includes(e.interval)}(t,i);case o.ProductFeatures.SCREENER_AUTO_REFRESH:return a(o.ProductFeatures.SCREENER_AUTO_REFRESH,t,i);case o.ProductFeatures.ALERTS_NO_EXPIRATION:return a(o.ProductFeatures.ALERTS_NO_EXPIRATION,t,i);default:return(0,n.enabled)(e,i)}}var c=i(71141);function u(e,t,i,r){l(t,r)?e():(0,s.createGoProDialog)(i)}
async function d(e,t,i,s={}){const n=window.is_authenticated;window.is_authenticated&&window.user.is_pro&&await(0,r.syncUserData)("gopro"),n===window.is_authenticated?u(e,t,i,s):(0,c.showSignModal)({source:i.goproSource,feature:i.feature,signinSuccess:e})}async function h(e){const t=window.is_authenticated;window.is_authenticated&&window.user.is_pro&&await(0,r.syncUserData)("gopro"),t===window.is_authenticated?(0,s.createGoProDialog)(e):(0,c.showSignModal)({source:e.goproSource,feature:e.feature})}},98006:(e,t,i)=>{"use strict";var r=i(55119).TVLocalStorage,s=i(96276),n=i(53363);i(68724);var o=new s;TradingView.FeatureToggle={force_prefix:"forcefeaturetoggle.",onChanged:new s,enableFeature:function(e){r.setItem(this.force_prefix+e,"true"),o.fire(e)},disableFeature:function(e){r.setItem(this.force_prefix+e,"false"),o.fire(e)},resetFeature:function(e){r.removeItem(this.force_prefix+e),o.fire(e)},onFeaturesStateChanged:function(){return o}},TradingView.isFeatureEnabled=function(e){function t(e){try{var t=n(e+function(){if(window.user&&window.user.id)return window.user.id;var e=r.getItem("featuretoggle_seed");return null!==e||(e=Math.floor(1e6*Math.random()),r.setItem("featuretoggle_seed",e)),e}());return new DataView(t).getUint32(0,!0)/4294967296}catch(e){return.5}}function s(i){return!("local"!==window.environment||!function(e){var t=new RegExp("broker_[A-Z]+[a-zA-Z0-9_]+_dev","g"),i=new RegExp("hide_[A-Z]+[a-zA-Z0-9_]+_on_ios","g"),r=new RegExp("hide_[A-Z]+[a-zA-Z0-9_]+_on_android","g"),s=new RegExp("hide_[A-Z]+[a-zA-Z0-9_]+_on_mobile_web","g")
;return-1===["broker_FXCM_token_v2","broker_TRADESTATION_V3","broker_TRADOVATE_dev","black_friday_mainpage","black_friday_popup","datawindow","trading-fast-renew-oauth-token","switching_trial_year_to_month_disabled","switching_year_to_month_disabled","default_year_billing_cycle_switcher","marketing-analytics","google-ads","visible_address_fields_by_default","slow-support-warning","hide-trading-floating-toolbar","tvcoins_donations","save-short-streams","details_disable_bid_ask","vat_disabled","pro_plan_upgrades_disabled","pro_plan_downgrades_disabled","unit_conversion","disable_recaptcha_on_signup","braintree-order-one-click-dropdown","braintree-trial-implementation","braintree-gopro-in-order-dialog","braintree-apple-pay","braintree-google-pay","braintree-apple-pay-trial","braintree-google-pay-trial","hide_gopro_popup_upgrade_button","yandex_metric_enabled","broker_id_session","remove_line_tools_from_content","chart_storage_with_broker_name","autosave_line_tools_immediately","log_removing_line_tools_group","oanda-european-accounts-warning","mobile_show_bottom_panel","disable_save_settings","enable_non_unique_watch_sections","desktop_version_notification_enabled","paperrest_2fa","paperrest_preview","favorites-in-broker-dropdown","streams_stats_profile","hide_ecomonic_events","aggregating_page_pings","mobile_trading_web","mobile_trading_ios","mobile_trading_android","hide_real_brokers_on_mobile","percentage_values_for_percentage_scale","hide_ranges_label_colors","disable_user_specific_encryption","remove_scale_settings_from_menu","enable_deep_history_backtesting","show_checkbox_of_house_rules_to_idea_and_script"].indexOf(e)&&-1===e.indexOf("-maintenance")&&!1===t.test(e)&&!1===i.test(e)&&!1===r.test(e)&&!1===s.test(e)}(i))||(!e[i]||-1!==e[i])&&(!!("true"===r.getItem(TradingView.FeatureToggle.force_prefix+i)||window.is_authenticated&&"undefined"!=typeof user&&user.settings&&"true"===user.settings[TradingView.FeatureToggle.force_prefix+i])||!("false"===r.getItem(TradingView.FeatureToggle.force_prefix+i)||window.is_authenticated&&"undefined"!=typeof user&&user.settings&&"false"===user.settings[TradingView.FeatureToggle.force_prefix+i])&&(!!e[i]&&(1===e[i]||t(i)<=e[i])))}return TradingView.onWidget()||Promise.all([i.e(4516),i.e(61959),i.e(34604)]).then(i.t.bind(i,4516,23)).then(t=>{t.on("featuretoggle",(function(t){var i=s(t.name);e[t.name]=t.state,i!==s(t.name)&&o.fire(t.name)}))}),s}(window.featureToggleState||{}),t.FeatureToggle=TradingView.FeatureToggle,t.isFeatureEnabled=TradingView.isFeatureEnabled,t.onFeaturesStateChanged=TradingView.FeatureToggle.onFeaturesStateChanged.bind(TradingView.FeatureToggle)},67448:(e,t,i)=>{"use strict";i.d(t,{generateChartUrl:()=>s});var r=i(40142);function s(e){const t=e.chartId?`/chart/${e.chartId}/`:"/chart/",i=new URL(t,location.href);return e.symbol&&i.searchParams.append("symbol",e.symbol),e.interval&&i.searchParams.append("interval",e.interval),e.style&&i.searchParams.append("style",e.style),(0,r.urlWithMobileAppParams)(i.href)}},28846:(e,t,i)=>{"use strict";function r(e){
if(e instanceof Error)return e.stack||e.message;try{return e.outerHTML.slice(0,1024)}catch(e){}try{if(void 0!==e)return JSON.stringify(e).slice(0,1024)}catch(e){}return String(e)}function s(){window.__tv_js_errors||(window.__tv_js_errors=[]),window.addEventListener("error",e=>{const t=(new Date).toISOString();window.__tv_js_errors.push(`${t} ${e.message||"JS error"}. ${e.filename||"<unknown url>"}, line ${e.lineno}, col ${e.colno}.\nError: `+r(e.error))},!1),window.addEventListener("unhandledrejection",e=>{const t=(new Date).toISOString();window.__tv_js_errors.push(t+" Unhandled rejection.\nReason: "+r(e.reason))},!1),document.addEventListener("securitypolicyviolation",e=>{var t,i;const s=(new Date).toISOString(),n="report"===e.disposition?"CSP report-only":"CSP violation";window.__tv_js_errors.push(`${s} ${n}: ${e.violatedDirective||e.effectiveDirective}. ${e.sourceFile||"<unknown url>"}, line ${null!==(t=e.lineno)&&void 0!==t?t:e.lineNumber}, col ${null!==(i=e.colno)&&void 0!==i?i:e.columnNumber}.\nBlocked URI: ${e.blockedURL||e.blockedURI}\nSample: ${e.sample}\nTarget: `+r(e.target))},!1)}i.d(t,{install:()=>s})},88001:(e,t,i)=>{"use strict";i.r(t),i.d(t,{unsubscribe:()=>l,on:()=>c,subscribe:()=>u,subscribeToAll:()=>d,emit:()=>h,emitOnce:()=>p});var r=i(96276),s=i.n(r);const n={},o=[],a={};function l(e,t,i){n[e].unsubscribe(i,t)}function c(e,t,i){u(e,t,i)}function u(e,t,i,r){n.hasOwnProperty(e)||(n[e]=new(s())),a[e]?t.call(i):n[e].subscribe(i,t,r)}function d(e){o.push(e)}function h(e,...t){const i=[e].concat(t);o.forEach(e=>{e.apply(null,i)}),n.hasOwnProperty(e)&&n[e].fire.apply(n[e],t)}function p(e){a[e]&&console.warn(`Something went wrong: emitOnce called multiple times with same event (${e})`),a[e]=!0,h.apply(null,arguments)}},26083:(e,t,i)=>{"use strict";i.r(t),i.d(t,{Modifiers:()=>r.Modifiers,createGroup:()=>h,pressedKeys:()=>d,registerWindow:()=>p,unregisterWindow:()=>_});var r=i(11877),s=i(20887),n=i(65066),o=i.n(n);var a=i(29098);class l{constructor(e,t){this._group=e,this.hotkey=t.hotkey,this.handler=t.handler,this.desc=t.desc,this.element=t.element||null,t.isDisabled?"function"==typeof t.isDisabled?this.isDisabled=t.isDisabled:this.isDisabled=()=>!0:this.isDisabled=()=>!1}destroy(){this._group&&(this._group.remove(this),this._group=null)}}class c{constructor(e,t){this._actions=[],this._manager=e,this.modal=!(!t||!t.modal),t&&(this.desc=t.desc),t&&t.isDisabled?"function"==typeof t.isDisabled?this.isDisabled=t.isDisabled:this.isDisabled=()=>!0:this.isDisabled=()=>!1,this._manager.registerGroup(this)}add(e){const t=new l(this,e);return this._actions.push(t),t}remove(e){for(let t=this._actions.length;t-- >0;)this._actions[t]===e&&this._actions.splice(t,1)}handleHotkey(e,t){for(let i=this._actions.length;i-- >0;){const s=this._actions[i];if(s.hotkey===e&&((!s.element||t.target&&s.element.contains(t.target))&&!s.isDisabled()))return s.handler(t),t.preventDefault(),(0,a.trackEvent)("Keyboard Shortcuts",(0,r.humanReadableHash)(e)),!0}return!1}promote(){this._manager.promoteGroup(this)}destroy(){
this._actions.length=0,this._manager.unregisterGroup(this)}}const u=new class{constructor(){this._groups=[],this._pressedKeys=new(o())(0),this._keyDownListener=e=>{if(e.defaultPrevented)return;const t=(0,r.hashFromEvent)(e);if(this._pressedKeys.setValue(t),!(0,s.isNativeUIInteraction)(t,e.target))for(let i=this._groups.length;i-- >0;){const r=this._groups[i];if(!r.isDisabled()){if(r.handleHotkey(t,e))return;if(r.modal)return}}},this._keyUpListener=e=>{const t=(0,r.hashFromEvent)(e);this._pressedKeys.setValue(t)},this._blurEvent=()=>{this._pressedKeys.setValue(0)},this._mouseEvent=e=>{const t=(0,r.modifiersFromEvent)(e),i=255&this._pressedKeys.value();this._pressedKeys.setValue(t|i)}}listen(e){e.addEventListener("keydown",this._keyDownListener),e.addEventListener("keyup",this._keyUpListener),e.addEventListener("blur",this._blurEvent),e.addEventListener("mousemove",this._mouseEvent)}unlisten(e){e.removeEventListener("keydown",this._keyDownListener),e.removeEventListener("keyup",this._keyUpListener),e.removeEventListener("blur",this._blurEvent),e.removeEventListener("mousemove",this._mouseEvent)}registerGroup(e){this._groups.push(e)}unregisterGroup(e){for(let t=this._groups.length;t--;)this._groups[t]===e&&this._groups.splice(t,1)}promoteGroup(e){let t=this._groups.length-1;for(let i=this._groups.length;i--;){if(this._groups[i]===e)return void(i!==t&&(this._groups.splice(i,1),this._groups.splice(t,0,e)));this._groups[i].modal&&(t=i-1)}}pressedKeys(){return this._pressedKeys}},d=u.pressedKeys();function h(e){return new c(u,e)}function p(e){u.listen(e)}function _(e){u.unlisten(e)}p(window)},11877:(e,t,i)=>{"use strict";i.r(t),i.d(t,{isMacKeyboard:()=>s,Modifiers:()=>n,modifiersFromEvent:()=>o,hashFromEvent:()=>a,humanReadableModifiers:()=>l,humanReadableHash:()=>u});var r=i(68724);const s=(0,r.isMac)()||r.CheckMobile.iOS();var n;function o(e){let t=0;return e.shiftKey&&(t+=1024),e.altKey&&(t+=512),e.ctrlKey&&(t+=256),e.metaKey&&(t+=2048),t}function a(e){return o(e)|e.keyCode}function l(e,t=!s){let i="";return 256&e&&(i+=s?"^":"Ctrl",t&&(i+=" + ")),512&e&&(i+=s?"⌥":"Alt",t&&(i+=" + ")),1024&e&&(i+=s?"⇧":"Shift",t&&(i+=" + ")),2048&e&&(i+=s?"⌘":"Win",t&&(i+=" + ")),i}!function(e){e[e.None=0]="None",e[e.Alt=512]="Alt",e[e.Shift=1024]="Shift",e[e.Mod=s?2048:256]="Mod",e[e.Control=256]="Control",e[e.Meta=2048]="Meta"}(n||(n={}));const c={9:"⇥",13:"↵",27:"Esc",8:s?"⌫":"Backspace",32:"Space",35:"End",36:"Home",37:"←",38:"↑",39:"→",40:"↓",45:"Ins",46:"Del",188:",",191:"/"};for(let e=1;e<=16;e++)c[e+111]="F"+e;function u(e){let t=l(e);const i=255&e;return t+=i in c?c[i]:String.fromCharCode(i),t}},20887:(e,t,i)=>{"use strict";i.d(t,{isTextEditingField:()=>s,isNativeUIInteraction:()=>n});var r=i(11877);function s(e){if("INPUT"===e.tagName){const t=e.type;return"text"===t||"email"===t||"number"===t||"password"===t||"search"===t||"tel"===t||"url"===t}return"TEXTAREA"===e.tagName||e.isContentEditable}function n(e,t){if(!t)return!1;const i=255&e;if(27===i||i>>>4==7)return!1;switch(e^i){case r.Modifiers.Alt:
return(38===i||40===i)&&"SELECT"===t.tagName||s(t);case r.Modifiers.Alt+r.Modifiers.Shift:return s(t);case r.Modifiers.Mod:if(67===i||!r.isMacKeyboard&&45===i){const e=t.ownerDocument&&t.ownerDocument.getSelection();if(e&&!e.isCollapsed)return!0}return s(t);case r.Modifiers.Mod+r.Modifiers.Shift:return i>=33&&i<=40&&s(t);case r.Modifiers.Shift:case 0:return!!(9!==i||t.ownerDocument&&t!==t.ownerDocument.body&&t!==t.ownerDocument.documentElement)&&((13===i||32===i||!function(e){if("BUTTON"===e.tagName)return!0;if("INPUT"===e.tagName){const t=e.type;if("submit"===t||"button"===t||"reset"===t||"checkbox"===t||"radio"===t)return!0}return!1}(t))&&("form"in t||t.isContentEditable))}return!1}},4346:(e,t,i)=>{"use strict";i.r(t),i.d(t,{updateInitData:()=>o,getInitData:()=>a,getFreshInitData:()=>l,deleteField:()=>c});var r=i(16282);const s=(0,i(87380).getLogger)("Common.InitData"),n=window.initData||{};function o(){window.initData&&window.initData!==n&&(Object.assign(n,window.initData),window.initData=n);const e=document.querySelectorAll('script[type="application/prs.init-data+json"]');for(let t=0;t<e.length;t++){const i=e[t];try{const e=JSON.parse((0,r.ensureNotNull)(i.textContent));Object.assign(n,e)}catch(e){s.logWarn("Failed to parse initData element. "+e)}finally{(0,r.ensureNotNull)(i.parentNode).removeChild(i)}}}function a(){return n}function l(){return o(),n}function c(e){delete n[e]}},52946:(e,t,i)=>{"use strict";i.r(t),i.d(t,{Linking:()=>m,linking:()=>f});var r=i(99479),s=i(65066),n=i.n(s),o=i(22842),a=i(20554),l=i(87380),c=i(42098),u=i(4346),d=i(71073),h=i(5417);const p=(0,l.getLogger)("Linking");var _;!function(e){e[e.NotBound=0]="NotBound",e[e.BoundToWidget=1]="BoundToWidget",e[e.BoundToModel=2]="BoundToModel"}(_||(_={}));class m{constructor(){this._watchedSymbol=new(n()),this._seriesShortSymbol=new(n()),this._proSymbol=new(n()),this._watchedInterval=new(n()),this._watchedIntraday=new(n()),this._watchedSeconds=new(n()),this._watchedTicks=new(n()),this._watchedRange=new(n()),this._watchedSupportedResolutions=new(n()),this._watchedSupportedChartStyles=new(n())([]),this._symbolNamesList=new(n()),this._chartWidgetBindingState=_.NotBound,this._activeChartWidget=null,this._watchedSymbolListenerBound=this._watchedSymbolListener.bind(this),this._watchedIntervalListenerBound=this._watchedIntervalListener.bind(this),this._onSymbolLinkBound=this._onSymbolLink.bind(this),this._searchCharts=null,this._searchChartsLoadDebounced=null,this._selfEmit=!1,this._preventFeedBySymbol=!1,this._feedBySymbolDebounceCounter=0}get symbol(){return this._watchedSymbol}get proSymbol(){return this._proSymbol}get symbolNamesList(){return this._symbolNamesList}get seriesShortSymbol(){return this._seriesShortSymbol.readonly()}get interval(){return this._watchedInterval}get intraday(){return this._watchedIntraday.readonly()}get seconds(){return this._watchedSeconds.readonly()}get ticks(){return this._watchedTicks.readonly()}get range(){return this._watchedRange.readonly()}get supportedResolutions(){return this._watchedSupportedResolutions.readonly()
}get supportedChartStyles(){return this._watchedSupportedChartStyles.readonly()}get preventFeedBySymbol(){return this._preventFeedBySymbol}bindToChartWidget(e){if(this.unbindFromChartWidget(),this._activeChartWidget=e,e.hasModel())return void this._onChartModelCreated(e.model());e.modelCreated().subscribe(this,this._onChartModelCreated),this._chartWidgetBindingState=_.BoundToWidget;const t=e.properties().childs().mainSeriesProperties.childs();this._watchedSymbol.setValue(t.symbol.value()),this._watchedInterval.setValue(t.interval.value())}unbindFromChartWidget(){switch(this._chartWidgetBindingState){case _.BoundToWidget:if(!this._activeChartWidget)throw new Error("ChartWidget is undefined");this._activeChartWidget.modelCreated().unsubscribe(this,this._onChartModelCreated);break;case _.BoundToModel:this._symbolProperty().unsubscribe(this,this._onSymbolPropertyChange),this._watchedSymbol.unsubscribe(this._watchedSymbolListenerBound),this._mainSeries().dataEvents().symbolResolved().unsubscribe(this,this._updateSeriesSymbolInfo),this._mainSeries().dataEvents().symbolError().unsubscribe(this,this._updateSeriesSymbolInfo),this._intervalProperty().unsubscribe(this,this._onIntervalPropertyChange),this._watchedInterval.unsubscribe(this._watchedIntervalListenerBound),delete this._watchedSymbol.hook,delete this._watchedSymbol.writeLock}this._activeChartWidget=null,this._chartWidgetBindingState=_.NotBound}getChartWidget(){return this._activeChartWidget}bindToChartWidgetCollection(e){this._chartWidgetCollection=e,this.unbindFromChartWidget(),e.activeChartWidget.subscribe(e=>{this.unbindFromChartWidget(),this.bindToChartWidget(e)},{callWithLast:!0})}bindToSearchCharts(e){this.unbindFromSearchCharts(),this._searchCharts=e,e.onSearchBySymbol.subscribe(this,this._onSearchBySymbol),e.loadingSymbol.subscribe(e=>{!1===e&&(this._feedBySymbolDebounceCounter=0)}),this._watchedSymbol.subscribe(this._onSymbolLinkBound)}unbindFromSearchCharts(){this._searchCharts&&(this._searchCharts.onSearchBySymbol.unsubscribe(this,this._onSearchBySymbol),this._watchedSymbol.unsubscribe(this._onSymbolLinkBound),this._searchCharts=null)}setPreventFeedBySymbol(e){this._preventFeedBySymbol=e}_onSearchBySymbol(e){if(!e.resolved_symbol)throw new Error("no resolved_symbol");this._selfEmit=!0,this._watchedSymbol.setValue(e.resolved_symbol),this._selfEmit=!1}_onSymbolLink(e){if(!this._selfEmit){if(!this._searchCharts){const e="No search charts defined";throw p.logError(e),new Error(e)}this._preventFeedBySymbol||this._loadSearchCharts(e)}}_loadSearchCharts(e){if(!this._searchCharts){const e="No search charts defined";throw p.logError(e),new Error(e)}if(this._searchChartsLoadDebounced)return void(this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced(e)));const t=e=>this._searchCharts?(!0===this._searchCharts.loadingSymbol.value()?this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced=(0,r.default)(t,2e3),
this._searchChartsLoadDebounced(e)):this._searchChartsLoadDebounced=null,this._searchCharts.feedBySymbol.call(this._searchCharts,e)):()=>{};!0===this._searchCharts.loadingSymbol.value()?this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced=(0,r.default)(t,2e3),this._searchChartsLoadDebounced(e)):this._searchCharts.feedBySymbol(e)}_mainSeries(){if(!this._activeChartWidget)throw new Error("ChartWidget is undefined");return this._activeChartWidget.model().mainSeries()}_properties(){return this._mainSeries().properties()}_symbolProperty(){return this._properties().symbol}_intervalProperty(){return this._properties().interval}_watchedSymbolListener(e){this._symbolProperty().value()!==e&&(this._chartWidgetCollection.setSymbol(e),this._sendSnowplowAnalytics())}_sendSnowplowAnalytics(){if(window.user.do_not_track)return;const e=this._mainSeries(),t=()=>{e.dataEvents().symbolResolved().unsubscribe(this,i)},i=i=>{(0,d.getTracker)().then(e=>{if(null===e)return;const t=this._chartWidgetCollection.layout.value(),r=this._chartWidgetCollection.metaInfo.uid.value()||"";e.trackChartSymbols(i.pro_name,i.type,t,r)}),e.dataEvents().symbolError().unsubscribe(this,t)};e.dataEvents().symbolResolved().subscribe(this,i,!0),e.dataEvents().symbolError().subscribe(this,t,!0)}_onSymbolPropertyChange(){const e=this._symbolProperty().value()!==this._watchedSymbol.value();this._watchedSymbol.setValue(this._symbolProperty().value()),e&&this._chartWidgetCollection.setSymbol(this._symbolProperty().value())}_onSymbolResolved(e){const t=this._mainSeries().symbolInfo();t&&this._applyValuesFromSymbolInfo(t)}_applyValuesFromSymbolInfo(e){const t=e.pro_name||o.enabled("trading_terminal")&&(e.full_name||e.name)||"";this._proSymbol.setValue(t),e.aliases&&this._symbolNamesList.setValue(e.aliases)}_updateSeriesSymbolInfo(){this._seriesShortSymbol.setValue(this._properties().shortName.value());const e=this._mainSeries().symbolInfo();if(e){this._applyValuesFromSymbolInfo(e);let t=(0,h.allChartStyles)();(0,a.isCloseBasedSymbol)(e)&&(t=t.filter(e=>(0,a.isSingleValueBasedStyle)(e))),this._watchedSupportedChartStyles.setValue(t),this._watchedIntraday.setValue(!!e.has_intraday),this._watchedSeconds.setValue(!!e.has_seconds),this._watchedTicks.setValue(!(0,a.isCloseBasedSymbol)(e)&&!!e.has_ticks),this._watchedRange.setValue(!(0,a.isCloseBasedSymbol)(e))}else this._watchedIntraday.deleteValue(),this._watchedSeconds.deleteValue(),this._watchedTicks.deleteValue(),this._watchedRange.deleteValue(),this._proSymbol.deleteValue()}_watchedIntervalListener(e){this._intervalProperty().value()!==e&&this._chartWidgetCollection.setResolution(e)}_onIntervalPropertyChange(){const e=this._intervalProperty().value()!==this._watchedInterval.value();this._watchedInterval.setValue(this._intervalProperty().value()),e&&this._chartWidgetCollection.setResolution(this._intervalProperty().value())}_onChartModelCreated(e){if(!this._activeChartWidget)throw new Error("ChartWidget is undefined");this._chartWidgetBindingState=_.BoundToModel,
this._activeChartWidget.modelCreated().unsubscribe(this,this._onChartModelCreated);const t=this._symbolProperty();t.subscribe(this,this._onSymbolPropertyChange),this._watchedSymbol.setValue(t.value()),this._watchedSymbol.subscribe(this._watchedSymbolListenerBound);const i=this._mainSeries();i.dataEvents().symbolResolved().subscribe(this,this._onSymbolResolved),this._watchedSymbol.hook=e=>(i.symbolSameAsCurrent(e)&&(e=i.symbol()),e),i.dataEvents().symbolResolved().subscribe(this,this._updateSeriesSymbolInfo),i.dataEvents().symbolError().subscribe(this,this._updateSeriesSymbolInfo),i.dataEvents().symbolNotPermitted().subscribe(this,this._updateSeriesSymbolInfo),i.dataEvents().symbolGroupNotPermitted().subscribe(this,this._updateSeriesSymbolInfo),this._updateSeriesSymbolInfo();const r=this._intervalProperty();r.subscribe(this,this._onIntervalPropertyChange),this._watchedInterval.setValue(r.value()),this._watchedInterval.subscribe(this._watchedIntervalListenerBound),this._activeChartWidget.readOnly()&&(this._watchedSymbol.writeLock=!0)}}const f=new m;{const e=(0,u.getFreshInitData)().symbolInfo,t=e?e.pro_symbol:c.getValue("editchart.model.symbol",window.DEFAULT_SYMBOL);f.symbol.setValue(t)}window.TradingViewApi||(window.TradingViewApi={linking:f})},55119:(e,t,i)=>{"use strict";const{getLogger:r}=i(87380),s=r("TVLocalStorage");var n=function(){try{this.isAvailable=!0,this.localStorage=window.localStorage,this.localStorage.setItem("tvlocalstorage.available","true")}catch(e){delete this.isAvailable,delete this.localStorage}this._updateLength();try{this._report()}catch(e){}};n.prototype._report=function(){if(this.isAvailable){const e=10,t=[];for(let e=0;e<this.localStorage.length;e++){const i=this.key(e);t.push({key:i,length:String(this.getItem(i)).length})}t.sort((e,t)=>t.length-e.length);const i=t.slice(0,e);t.sort((e,t)=>t.key.length-e.key.length);const r=t.slice(0,e);s.logNormal("Total amount of keys in Local Storage: "+this.length),s.logNormal(`Top ${e} keys with longest values: ${JSON.stringify(i)}`),s.logNormal(`Top ${e} longest key names: ${JSON.stringify(r)}`);try{navigator.storage.estimate().then(e=>{s.logNormal("Storage estimate: "+JSON.stringify(e))})}catch(e){}}},n.prototype.length=0,n.prototype.isAvailable=!1,n.prototype.localStorage={"tvlocalstorage.available":"false"},n.prototype._updateLength=function(){if(this.isAvailable)this.length=this.localStorage.length;else{var e,t=0;for(e in this.localStorage)this.localStorage.hasOwnProperty(e)&&t++;this.length=t}},n.prototype.key=function(e){return this.isAvailable?this.localStorage.key(e):Object.keys(this.localStorage)[e]},n.prototype.getItem=function(e){return this.isAvailable?this.localStorage.getItem(e):void 0===this.localStorage[e]?null:this.localStorage[e]},n.prototype.setItem=function(e,t){this.isAvailable?this.localStorage.setItem(e,t):this.localStorage[e]=t,this._updateLength()},n.prototype.removeItem=function(e){this.isAvailable?this.localStorage.removeItem(e):delete this.localStorage[e],this._updateLength()},n.prototype.clear=function(){
this.isAvailable?this.localStorage.clear():this.localStorage={},this._updateLength()};var o=function(e){this.storage=e};o.prototype.getItem=function(e){return Promise.resolve(this.storage.getItem(e))},o.prototype.setItem=function(e,t){return Promise.resolve(this.storage.setItem(e,t))},window.TVLocalStorage=new n,window.TVLocalStorageAsync=new o(window.TVLocalStorage),e.exports={TVLocalStorage:window.TVLocalStorage,TVLocalStorageAsync:window.TVLocalStorageAsync}},72777:(e,t,i)=>{"use strict";i.d(t,{LogoSize:()=>r,getLogoUrlResolver:()=>l});var r,s=i(16282),n=i(4346);!function(e){e[e.Medium=0]="Medium",e[e.Large=1]="Large"}(r||(r={}));class o{constructor(e){(0,s.assert)(""!==e,"S3 base url must be a non-empty string"),this._baseUrl=e}getSymbolLogoUrl(e,t){switch((0,s.assert)(""!==e,"logo id must be a non-empty string"),t){case r.Medium:return this._baseUrl+(e+".svg");case r.Large:return this._baseUrl+(e+"--big.svg")}}getCountryFlagUrl(e,t){return this.getSymbolLogoUrl("country/"+e,t)}getCryptoLogoUrl(e,t){return this.getSymbolLogoUrl("crypto/"+e,t)}getProviderLogoUrl(e,t){return this.getSymbolLogoUrl("provider/"+e,t)}}let a;function l(){if(!a){const e=(0,n.getInitData)(),t=e.settings?e.settings.S3_LOGO_SERVICE_BASE_URL:"";a=new o(t)}return a}},58988:(e,t,i)=>{"use strict";i.d(t,{breakpoints:()=>r,mobileFirstBreakpoints:()=>s,mobileFirstLegacyBreakpoints:()=>n});const r={desktop:1/0,desktopHd:1919,phone:767,"phone-vertical":479,tablet:1019},s={base:0,"media-mf-phone-vertical":320,"media-mf-phone-landscape":568,"media-mf-tablet-vertical":768,"media-mf-tablet-landscape":1024,"media-mf-laptop":1280,"media-mf-desktop-medium":1440,"media-mf-desktop-large":1920,"media-mf-desktop-extra-large":2560},n={"media-mf-legacy-phone-vertical":330,"media-mf-legacy-phone":480,"media-mf-legacy-notebook":1020,"media-mf-legacy-desktop-medium":1480,"media-mf-legacy-desktop":1531}},51193:(e,t,i)=>{"use strict";i.d(t,{getScrollbarWidth:()=>r,matchMediaMinMax:()=>s,getContentWidth:()=>n,setStyle:()=>o,getCSSProperty:()=>a,getCSSPropertyNumericValue:()=>l});const r=(()=>{let e;return()=>{var t;if(void 0===e){const i=document.createElement("div"),r=i.style;r.visibility="hidden",r.width="100px",r.msOverflowStyle="scrollbar",document.body.appendChild(i);const s=i.offsetWidth;i.style.overflow="scroll";const n=document.createElement("div");n.style.width="100%",i.appendChild(n);const o=n.offsetWidth;null===(t=i.parentNode)||void 0===t||t.removeChild(i),e=s-o}return e}})();function s(e,t){return t===1/0?window.matchMedia(`(min-width: ${e}px)`):window.matchMedia(`(min-width: ${e}px) and (max-width: ${t}px)`)}function n(e){if(null===e)return;return l(e,"width")-l(e,"padding-left")-l(e,"padding-right")}function o(e,t,i){null!==e&&e.style.setProperty(t,i)}function a(e,t){return getComputedStyle(e,null).getPropertyValue(t)}function l(e,t){return parseInt(a(e,t))}},44020:(e,t,i)=>{"use strict";i.d(t,{mediaState:()=>c});var r=i(94795),s=i.n(r),n=i(95498),o=i(58988),a=i(51193);class l extends(s()){constructor(){super(),this.width=0,this.height=0,
this.device=null,this.breakpoints=o.breakpoints,this._checkDevice(),window.addEventListener("resize",this._checkDevice),Object.entries(o.breakpoints).sort(([e,t],[i,r])=>t-r).forEach(([e,t],i,r)=>{let s;if(0!==i){const[,e]=r[i-1];s=e+1}else s=0;const n=(0,a.matchMediaMinMax)(s,t);n.matches&&this._setNewDevice(e),n.addListener(t=>{t.matches&&(this._checkDevice(),this._setNewDevice(e))})}),(0,n.whenDocumentReady)(this._checkDevice.bind(this)),this.isPhoneSizeDevice.bind(this)}isPhoneSizeDevice(){return"phone"===this.device||"phone-vertical"===this.device}_checkDevice(){this.width=window.innerWidth,this.height=window.innerHeight}_setNewDevice(e){const t=this.device;this.device=e,this.trigger("changeDevice",[e,t])}}const c=new l},40142:(e,t,i)=>{"use strict";i.d(t,{isOnMobileAppPage:()=>s,urlWithMobileAppParams:()=>n});var r=i(32010);function s(e,t=!1){const{searchParams:i}=new URL(String(location)),s=r.get("tv_app")||"";let n="true"===i.get("mobileapp_new"),o="true"===i.get("mobileapp");return t||(n||(n=["android","android_nps"].includes(s)),o||(o="ios"===s)),!("new"!==e&&"any"!==e||!n)||!("new"===e||!o)}function n(e){if(s("new")){const t=new URL(e,location.href);t.searchParams.set("mobileapp_new","true"),e=t.toString()}if(s("old")){const t=new URL(e,location.href);t.searchParams.set("mobileapp","true"),e=t.toString()}return e}},5013:(e,t,i)=>{"use strict";i.d(t,{addPerfMark:()=>c,perfMeasureOperation:()=>u});var r=i(75443);function s(){}const n=console.timeStamp?console.timeStamp.bind(console):s,o=window.performance&&performance.mark?performance.mark.bind(performance):s,a=window.performance&&performance.measure?performance.measure.bind(performance):s,l=window.performance&&performance.clearMarks?performance.clearMarks.bind(performance):s;function c(e){n(e),o(e)}async function u(e,t){const i=`measure-${e}-${(0,r.randomHash)()}`;o(i);try{return await t()}finally{a(e,i),l(i)}}},11490:(e,t,i)=>{"use strict";function r(e){return e===s(e)}function s(e){const t=e.indexOf("$"),i=e.indexOf("@");return t<0&&i>=0?null:e.substring(Math.max(t+1,0),i>=0?i:e.length)}function n(e){return e.startsWith("PUB;")}function o(e){return e.startsWith("USER;")}function a(e){return e.startsWith("STD;")}function l(e){return e.includes("Candlestick%1Pattern%1")}function c(e){return e.startsWith("EDGR_")}i.d(t,{isPineIdString:()=>r,extractPineId:()=>s,isPublishedPineId:()=>n,isCustomPineId:()=>o,isStandardPineId:()=>a,isCandleStickId:()=>l,isEdgrPineId:()=>c})},26265:(e,t,i)=>{"use strict";function r(e){return"scriptTitle"in e&&"modified"in e}function s(e){return"userId"in e&&"scriptAccess"in e}function n(e){return"strategy"===e.kind}function o(e){return"library"===e.kind}i.d(t,{isSavedPineInfo:()=>r,isPubPineInfo:()=>s,isScriptStrategy:()=>n,isScriptLibrary:()=>o})},51762:(e,t,i)=>{"use strict";var r=i(22842);window.TradingView=window.TradingView||{};var s,n,o,a,l,c,u=TradingView.postMessageWrapper=(n={},o={},a={},l=0,c=0,window.addEventListener&&window.addEventListener("message",(function(e){var t;try{t=JSON.parse(e.data),
r.enabled("charting_library_debug_mode")&&console.log("PostMessage: incoming message: "+JSON.stringify(t))}catch(e){return}if(t&&t.provider&&"TradingView"===t.provider)if("get"===t.type){if(!o[t.name])return;o[t.name].forEach((function(e){"function"==typeof e&&e.call(t,t.data,(function(e){var i={id:t.id,type:"on",name:t.name,client_id:t.client_id,data:e,provider:"TradingView"};s.postMessage(JSON.stringify(i),"*")}))}))}else if("on"===t.type)n[t.client_id]&&n[t.client_id][t.id]&&(n[t.client_id][t.id].call(t,t.data),delete n[t.client_id][t.id]);else if("post"===t.type){if(!o[t.name])return;o[t.name].forEach((function(e){"function"==typeof e&&e.call(t,t.data,(function(){}))}))}})),function(e,t){n[t]={},a[t]=e,s=e;var i="";return{on:function(e,t,i){o[e]&&i||(o[e]=[]),o[e].push(t)},get:function(e,i,r){var s={id:l++,type:"get",name:e,client_id:t,data:i,provider:"TradingView"};n[t][s.id]=r,a[t].postMessage(JSON.stringify(s),"*")},post:function(e,t,r){var s={id:c++,type:"post",name:t,client_id:i,data:r,provider:"TradingView"};e&&"function"==typeof e.postMessage&&e.postMessage(JSON.stringify(s),"*")},setClientId:function(e){i=e}}});e.exports=u},56138:(e,t,i)=>{"use strict";i.d(t,{retries:()=>n,retriesWithDelays:()=>o});var r=i(98388);async function s(e,t,i){let r;for(let s=0;s<t;++s)try{return await e(r)}catch(e){r=e,await i(s)}throw r}async function n(e,t){return s(e,t,()=>Promise.resolve())}async function o(e,t){return s(e,t.length+1,e=>e<t.length?(0,r.delay)(null,t[e]):Promise.resolve())}},4516:(e,t,i)=>{"use strict";var r=i(75443),s=i(41962).TVXWindowEvents,n=i(29098).trackEvent,o=i(55119).TVLocalStorage,a=i(5709).PushStream,l=i(5958).ConnectionStatus,c=i(10164).telemetry,u=i(87380),d=u.getLogger,h=u.getRawLogHistory,p=d("PushStreamMultiplexer"),_=function(){var e,t=null,i=null,u={},d={},_=[],m=null,f="multiplexer-bc-",g="pushStreamMultiplexerState.",v=l.Closed,S=l.Closed,y=!1,b={_codeParams:function(e){return(e=Array.prototype.slice.call(e)).push((new Date).getTime()),JSON.stringify(e)},_decodeParams:function(e){var t=JSON.parse(e);return t.pop(),t},guid:r.guid(),_init:function(){if(this._needInstantiating())this._instantiatePushStream();else{var e=this._decodeConnectionStatus(o.getItem(this._connectionStatusKey));v=e[0],S=e[1]}setTimeout((function(){b.isConnected()||(p.logNormal("Not connected for a while after init..."),n("pushstream","not connected after init",navigator.userAgent))}),b._activityTimeout)},_instantiatePushStream:function(e){this._setMark(),t&&(n("PushstreamDoublePublic",window.user&&window.user.username||"Guest",navigator.userAgent),t.disconnect()),(t=new a(this._dispatchMessage.bind(this),{url:window.PUSHSTREAM_URL,urlPath:"message-pipe-ws"})).connectionStatus().subscribe(function(e){this._dispatchStatusChange(e,S)}.bind(this)),i&&(n("PushstreamDoublePrivate",window.user&&window.user.username||"Guest",navigator.userAgent),i.disconnect()),(i=new a(this._dispatchMessage.bind(this),{url:window.PUSHSTREAM_URL,urlPath:"message-pipe-ws"})).connectionStatus().subscribe(function(e){
this._dispatchStatusChange(v,e)}.bind(this)),this.on("pushstream_set_user_channel",function(e){this._setUserChannel(e)}.bind(this)),this._connectChannels(e)},_destructPushStream:function(){var e=t;t=null,e.disconnect(),e=i,i=null,e.disconnect(),this._dispatchStatusChangeFromOther(o.getItem(this._connectionStatusKey))},_activityTimeout:5e3,_delayTimeout:2e4,_pulseActivity:function(){this.ownPushStream()?this._lostOwn()?(p.logNormal("Lost own pushstream connection"),c.sendReport("site","pushstream_lost_own"),this._destructPushStream()):this._setMark():this._needInstantiating()&&!y&&(p.logNormal("Creating pushstream connection, because other tab lost it"),c.sendReport("site","pushstream_pick_up"),this._instantiatePushStream(this.getChannels()))},_markName:g+"mark",_lostOwn:function(){var e=o.getItem(this._markName);return!!e&&(e=this._decodeParams(e))[0]!==this.guid},_getMark:function(){return this._decodeParams(o.getItem(this._markName))},_setMark:function(){o.setItem(this._markName,this._codeParams([this.guid,(new Date).getTime()]))},_unsetMark:function(){o.setItem(this._markName,"")},_needInstantiating:function(){var e=o.getItem(this._markName);if(e){var t=(e=this._decodeParams(e))[1];return(new Date).getTime()-t>this._delayTimeout}return!0},_onRequestRecreate:function(e){if(!this.ownPushStream()&&this._needInstantiating()){var t=this._decodeParams(e)[0];p.logNormal("Creating pushstream connection after recreate request"),this._instantiatePushStream(t)}},_onUnload:function(){this.ownPushStream()&&(this._unsetMark(),this._sendRecreateRequest())},_getChannels:function(){return t.getChannels().concat(i.getChannels())},_channelsName:g+"channels",_getChannelsFromStorage:function(){var e=o.getItem(this._channelsName);return e?JSON.parse(e):[]},getChannels:function(){return this.ownPushStream()?this._getChannels():this._getChannelsFromStorage()},_storeChannels:function(){o.setItem(this._channelsName,JSON.stringify(this._getChannels()))},_sendRecreateRequest:function(){var e=this._getChannels();s.emit(this._xEventRecreate,this._codeParams([e]))},ownPushStream:function(){return!!t||!!i},pushStream:function(){if(!this.ownPushStream())throw new Error("Not own PushStream");return t},isConnected:function(){return v>0},status:function(){return v||l.Closed},statusPrivate:function(){return S||l.Closed},_userChannel:function(e){return"private_"+e},userChannel:function(){if(!m)throw new Error("No user channel");return this._userChannel(m)},_xEventRecreate:f+"recreate",_xEventSend:f+"send",_xEventChannelAdd:f+"channelAdd",_xEventChannelRemove:f+"channelRemove",_xEventRequiredChannels:f+"requirech",_xEventConnectionStatus:f+"connectionStatus",_xEventReconnectCommand:f+"reconnectCommand",_xEventRequestLogs:f+"requestLogs",_xEventShareLogs:f+"shareLogs",_shareLogsKey:g+"shareLogs",_connectionStatusKey:g+"connectionStatus",_addChannel:function(e){var r=e.startsWith("private_")?i:t;r.hasChannel(e)||(r.addChannel(e),this._storeChannels())},addChannel:function(e){
this.ownPushStream()?this._addChannel(e):s.emit(this._xEventChannelAdd,this._codeParams([e]))},_addChannelFromOther:function(e){var t=this._decodeParams(e)[0];this.ownPushStream()&&this._addChannel(t)},_removeChannel:function(e){var r=e.startsWith("private_")?i:t;r.hasChannel(e)&&(r.removeChannel(e),this._storeChannels())},removeChannel:function(e){this.ownPushStream()?this._removeChannel(e):s.emit(this._xEventChannelRemove,this._codeParams([e]))},_removeChannelFromOther:function(e){var t=this._decodeParams(e)[0];this.ownPushStream()&&this._removeChannel(t)},_connectChannels:function(e){t.addChannel("public"),void 0!==e&&e.length>0&&e.forEach((function(e){e.startsWith("private_")||t.hasChannel(e)||t.addChannel(e)})),"is_authenticated"in window?this._connectUserChannelInitial(!0):window.loginStateChange&&loginStateChange.subscribe(this,this._connectUserChannelInitial),t.connect()},_connectUserChannelInitial:function(e){e&&(is_authenticated?(m=user.private_channel,i.addChannel(this.userChannel()),i.connect()):m=null)},_changeLoginState:function(e){e||(is_authenticated?(m=user.private_channel,this.ownPushStream()&&(this._addChannel(this.userChannel()),i.connect())):(this.ownPushStream()&&(this._removeChannel(this.userChannel()),i.disconnect()),m=null))},_setUserChannel:function(e){p.logNormal("Set user channel "+e),e!==m&&(this.ownPushStream()&&m&&this._removeChannel(this.userChannel()),m=e,this.ownPushStream()&&m&&this._addChannel(this.userChannel()))},_dispatchStatusChange:function(e,t){this._dispatchStatusChangeToOthers(e,t),this._dispatchStatusChangeToSelf(e,t)},_dispatchStatusChangeToSelf:function(e,t){e!==v&&(v=e,this._callStatusHandlers(e,!1)),t!==S&&(S=t,this._callStatusHandlers(t,!0))},_callStatusHandlers:function(e,t){p.logNormal("Connection status change: "+e+", private "+t),c.sendReport("site","pushstream_status_change"),_.forEach((function(i){i.isPrivate===t&&i.handler(e)}))},_decodeConnectionStatus:function(e){var t=parseInt(e,10);return isNaN(t)?this._decodeParams(e):[t,t]},_dispatchStatusChangeFromOther:function(e){var t=this._decodeConnectionStatus(e),i=t[0],r=t[1];this.ownPushStream()||this._dispatchStatusChangeToSelf(i,r)},_dispatchStatusChangeToOthers:function(e,t){if(this.ownPushStream()){var i=this._codeParams([e,t]);o.setItem(this._connectionStatusKey,i),s.emit(this._xEventConnectionStatus,i)}},_dispatchMessage:function(e,t,i){this._dispatchMessageToOthers(e,t,i),this._dispatchMessageToSelf(e,t,i,!1)},_dispatchMessageToSelf:function(e,t,i,r){i=e.channel,e=e.content,this._emit(e,t,i,r)},_dispatchMessageToOthers:function(e,t,i){var r=[e,t,i,(new Date).getTime()];s.emit(this._xEventSend,this._codeParams(r))},_dispatchMessageFromOther:function(e){if(!this.ownPushStream()){var t=this._decodeParams(e),i=t[0],r=t[1],s=t[2];this._dispatchMessageToSelf(i,r,s,!0)}},_isSpecialChannel:function(e){return/\*/.test(e)},_emit:function(e,t,i,r){function s(s){s.call(this,e,t,i,r)}for(var n in u[i]&&u[i].forEach(s,this),d){var o="^"+n.replace(/\*/g,".*?")+"$";new RegExp(o).test(i)&&d[n].forEach(s,this)}},
on:function(e,t){var i=this._isSpecialChannel(e)?d:u;i[e]||(i[e]=[]),i[e].push(t)},off:function(e,t){var i=this._isSpecialChannel(e)?d:u;switch(arguments.length){case 0:u={},d={};break;case 1:i[e]&&delete i[e];break;default:if(i[e]){var r=i[e].indexOf(t);~r&&i[e].splice(r,1)}}},onStatus:function(e){_.push({handler:e,isPrivate:!1}),setTimeout((function(){e(v)}),0)},onPrivateStatus:function(e){_.push({handler:e,isPrivate:!0}),setTimeout((function(){e(S)}),0)},offStatus:function(e){_=_.filter((function(t){return t.handler!==e}))},forceConnect:function(){y=!1,p.logNormal("Creating pushstream connection after force connect"),this.ownPushStream()?(t.disconnect(),i.disconnect(),this._instantiatePushStream(this.getChannels())):this._needInstantiating()?this._instantiatePushStream():s.emit(this._xEventReconnectCommand,{})},disconnect:function(){this.ownPushStream()&&(this._destructPushStream(),this._unsetMark(),y=!0)},_dispatchReconnectCommandFromOther:function(){this.ownPushStream()&&this.forceConnect()},_getOwnLogs:function(e){if(this.ownPushStream()){var t=h(e,"PushStreamMultiplexer"),i=this.pushStream().getLogs();return[].concat(t,i)}return[]},_onRequestLogs:function(e){if(this.ownPushStream()){var t=this._getOwnLogs(e),i=JSON.stringify(t);o.setItem(this._shareLogsKey,i),s.emit(this._xEventShareLogs,i)}},getLogs:function(e){return new Promise(function(t){var i=setTimeout(function(){var e=o.getItem(this._shareLogsKey);t(null!==e?JSON.parse(e):[])}.bind(this),1e3),r=function(e){var n;s.off(this._xEventShareLogs,r),s.emit(this._xEventShareLogs,""),clearTimeout(i);try{n=JSON.parse(e)}catch(e){n=[],p.logError("Failed to parse logs received from master tab")}t(n)}.bind(this);this.ownPushStream()?t(this._getOwnLogs(e)):(s.on(this._xEventShareLogs,r),s.emit(this._xEventRequestLogs))}.bind(this))}};return b._init(),window.addEventListener("unload",b._onUnload.bind(b)),s.on(b._xEventRecreate,b._onRequestRecreate.bind(b)),s.on(b._xEventSend,b._dispatchMessageFromOther.bind(b)),s.on(b._xEventChannelAdd,b._addChannelFromOther.bind(b)),s.on(b._xEventChannelRemove,b._removeChannelFromOther.bind(b)),s.on(b._xEventConnectionStatus,b._dispatchStatusChangeFromOther.bind(b)),s.on(b._xEventReconnectCommand,b._dispatchReconnectCommandFromOther.bind(b)),s.on(b._xEventRequestLogs,b._onRequestLogs.bind(b)),e=function(){window.loginStateChange&&loginStateChange.subscribe(b,b._changeLoginState)},"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e),setInterval(b._pulseActivity.bind(b),b._activityTimeout),b._pulseActivity(),b}();e.exports=_},5709:(e,t,i)=>{"use strict";i.d(t,{PushStream:()=>u});var r=i(16282),s=i(87380),n=i(5958),o=i(4950);const a=(0,s.getLogger)("PersistentWebsocketTransport");class l extends o.PersistentTransport{constructor(e){super(e,a)}sendMessage(e){this._connectionStatus.value()===n.ConnectionStatus.Open?this._socket?this._socket.send(e):a.logError("Something went wrong - code 0x3"):a.logWarn("Attempt to send message but connection is not opened")}_createNativeTransport(e){
const t=new WebSocket(e);return t.binaryType="arraybuffer",t.addEventListener("error",this._socketErrorHandler),t.addEventListener("close",this._socketCloseHandler),t.addEventListener("open",this._socketOpenHandler),t.addEventListener("message",this._socketMessageHandler),t}_disconnectTransport(){if(null===this._socket)return;this._socket.removeEventListener("error",this._socketErrorHandler),this._socket.removeEventListener("close",this._socketCloseHandler),this._socket.removeEventListener("open",this._socketOpenHandler),this._socket.removeEventListener("message",this._socketMessageHandler),this._removeOnOfflineListener();const e=this._socket;this._socket=null,this._connectionStatus.setValue(n.ConnectionStatus.Closed),e.readyState!==WebSocket.CLOSED&&e.close()}}const c=(0,s.getLogger)("PushStream");class u{constructor(e,t){this._channels=[],this._transport=new l(this._onPushStreamMessage.bind(this)),this._settings=t,this._messageHandler=e}addChannel(e){(0,r.assert)(!this.hasChannel(e),"Channel already subscribed"),c.logNormal("Adding channel "+e),this._channels.push(e),this._transport.setUrl(this._generateUrl())}removeChannel(e){const t=this._channels.indexOf(e);(0,r.assert)(-1!==t,"There is no that channel"),c.logNormal("Removing channel "+e),this._channels.splice(t,1),this._transport.setUrl(this._generateUrl())}getChannels(){return this._channels}hasChannel(e){return-1!==this._channels.indexOf(e)}connectionStatus(){return this._transport.connectionStatus()}connect(){(0,r.assert)(0!==this._channels.length,"There is no channels"),this._transport.connect()}disconnect(){this._transport.disconnect()}sendMessage(e){this._transport.sendMessage(e)}getLogs(e){return(0,s.getRawLogHistory)(e,"PushStream")}_onPushStreamMessage(e){if("string"!=typeof e)throw new Error("Wrong message type, expected string");const t=JSON.parse(e),i=t.id,r=t.channel;-2===i?c.logWarn("Received unexpected message: about removed the channel"):i>0&&(c.logDebug(`Received message: id="${i}" channel="${r}"`),this._messageHandler(t.text,i,r))}_generateUrl(){const e=this._channels.join("/");return`${this._settings.url}/${this._settings.urlPath}/${e}`}}},65194:(e,t,i)=>{"use strict";i.r(t),i.d(t,{qaGlobals:()=>r});const r=new class{constructor(e,t){this._test=e[t]={}}provide(e,t){this._test[e]=t}}(window,"qaGlobals")},60531:(e,t,i)=>{"use strict";i.d(t,{registerService:()=>o,unregisterService:()=>a,hasService:()=>l,service:()=>c,waitServiceRegistered:()=>u});var r=i(57137);const s={},n=new Map;function o(e,t){if(l(e))throw new Error("Service already registered");s[e.id]=t;const i=n.get(e.id);void 0!==i&&(n.delete(e.id),i.resolve(t))}function a(e){if(!l(e))throw new Error("Service not found");s[e.id]=void 0}function l(e){return void 0!==s[e.id]}function c(e){const t=s[e.id];if(void 0===t)throw new Error("ServiceLocator: Service "+e.id+" not found");return t}function u(e){if(l(e))return Promise.resolve(c(e));let t=n.get(e.id);return void 0===t&&(t=(0,r.createDeferredPromise)(),n.set(e.id,t)),t.promise}},42098:(e,t,i)=>{"use strict";e=i.nmd(e),i(68724)
;var r=i(85864).fetch,s=i(29412).regExpEscape,n=i(41962).TVXWindowEvents,o=i(55119).TVLocalStorage,a=i(96276),l=i(22842),c=i(98006).isFeatureEnabled,u=i(87380).getLogger("Lib.TVSettings"),d=["s.tradingview.com","betacdn.tradingview.com"],h=(l.enabled("use_localstorage_for_settings"),window.TVSettings=function(){var e=!1,t=null,i=!1;function p(){return!(t||window.is_authenticated)}try{e=!TradingView.onWidget()&&parent&&parent!==window&&!!parent.IS_DEMO_PAGE}catch(e){}if(e){var _={"widgetbar.layout-settings":{widgets:{},settings:{minimized:!0}},notShowMainWizard:!0},m=function(e,t,i){var r=_[e];return null==r?t:r},f=function(){};return{loaded:!1,loadedModel:!1,getValue:m,getJSON:m,getBool:m,getFloat:m,getInt:m,setValue:f,setJSON:f,remove:f,keys:function(){return Object.keys(_)},keysMask:function(){return[]},sync:f,onSync:{subscribe:function(){}}}}var g=12e4;"local"===window.environment&&(g=5e3);var v,S,y,b=TradingView.onWidget()?"tradingview-widget":"tradingview",w=b+".",P={},C=[],T=[/^widgetbar\.widget\.watchlist.+/,/.+quicks$/,/^widgetbar\.layout-settings$/,/^ChartSideToolbarWidget\.visible$/,/^onwidget\.watchlist$/,/^domepanel.visible$/,/^orderpanel.visible$/,/^chart\.favoriteDrawings$/,/^chart\.favoriteDrawingsPosition$/,/^loadChartDialog.favorites$/,/^ChartFavoriteDrawingToolbarWidget\.visible/,/^trading\.chart\.proterty$/,/^trading_floating_toolbar\.position$/,/^trading\.orderWidgetMode\./,/^symbolWatermark$/,/^pinereference\.size$/,/^pinereference\.position$/,/^hint\.+/,/^ChartDrawingToolbarWidget\.visible/];const x=["current_theme.name"];function I(e){return w+e}function L(e){return e.substring(w.length)}function M(e,t){var i=P[e];return null==i?t:i}function E(e,t,i){i=i||{};var r=""+t;return P[e]!==r&&(P[e]=r,D(e)),i.forceFlush&&!S&&(S=setTimeout((function(){S=void 0,R()}),10)),h}function A(e,t){return t=t||{},null!=P[e]&&(delete P[e],D(e)),t.forceFlush&&R(),h}function k(){v=void 0,C.length&&R()}function D(e){if(t)null==P[e]?t.removeValue(e):t.setValue(e,P[e]);else if(p())try{null==P[e]?o.removeItem(I(e)):o.setItem(I(e),P[e])}catch(e){}else C.push(e),v||(v=setTimeout(k,g));n.emit("settings",JSON.stringify({key:e,value:P[e]}))}function R(e){if(!i&&!y)if(c("disable_save_settings"))u.logWarn("Settings flashing has been skipped because of disable_save_settings featuretoggle");else if(!l.enabled("widget")&&!p()&&0!==C.length){var t=C;C=[];for(var s={},n=t.length;n--;){var o=t[n],a=P[o];void 0===a&&(a=null),s[o]=a}var d=new FormData;d.append("delta",JSON.stringify(s)),e&&navigator.sendBeacon?navigator.sendBeacon("/savesettings/",d):r("/savesettings/",{method:"POST",credentials:"include",body:d}).then((function(i){if(i.ok||(C=C.concat(t)),[429,503].includes(i.status)){var r=1e3*+i.headers.get("retry-after")||3e5;y=setTimeout(()=>{y=void 0,R(e)},r)}})).catch((function(){C=C.concat(t)}))}}function N(){return Object.keys(P)}function O(e){for(var t=0;t<T.length;++t)if(T[t].exec(e))return!0;return!1}function V(e){return e.substring(0,w.length)===w}function B(e){P={};const t=0===Object.keys(e).length;t||function(e){
Object.keys(e).forEach((function(t){P[t]=e[t]+""}))}(e),function(e){for(var t=o.length;t--;){var i=o.key(t);i&&V(i)&&((e||x.includes(L(i)))&&E(L(i),o.getItem(i)),o.removeItem(i))}}(t)}n.on("settings",(function(e){var t=JSON.parse(e);null==t.value?delete P[t.key]:P[t.key]=t.value}));var F=new a;return document.addEventListener("visibilitychange",(function(){"hidden"!==document.visibilityState&&!0!==document.hidden||R()})),window.addEventListener("beforeunload",(function(){R(!0)})),{loaded:!1,loadedModel:!1,getValue:M,getJSON:function(e,t){var i=M(e,void 0);if(null==i)return t;try{return JSON.parse(i)}catch(i){return A(e),t}},getBool:function(e,t){var i=M(e);return null==i?t:!(!i||"false"===i||0==+i)},getFloat:function(e,t,i){var r=M(e,void 0);if(null==r)return t;var s=parseFloat(r);if(!isFinite(s))throw new TypeError('"'+r+'" is not float (key: "'+e+'")');return s},getInt:function(e,t,i){var r=M(e,void 0);if(null==r)return t;var s=parseInt(r,10);if(!isFinite(s))throw new TypeError('"'+r+'" is not int (key: "'+e+'")');return s},setValue:E,setJSON:function(e,t,i){return E(e,JSON.stringify(t),i),h},remove:A,keys:N,keysMask:function(e,t){for(var i=N(),r=[],n=(e=new RegExp("^"+s(e).replace(/\\\*\\\*/gi,".+").replace(/\\\*/gi,"[^.]+")+"$","gi"),i.length-1);n>=0;n--)e.test(i[n])&&r.push(i[n]),e.lastIndex=0;return r},sync:function(e){null!==e?(t?B(t.initialSettings||{}):p()?(function(){if(TradingView.onWidget()&&d.includes(window.location.host))for(var e=o.length;e--;){var t=o.key(e);if(0===t.indexOf("tradingview.")){var i=t.replace("tradingview.",b+".");o.setItem(i,o.getItem(t)),o.removeItem(t)}}}(),function(){for(const e of x)P[e]&&!o.getItem(I(e))&&o.setItem(I(e),P[e])}(),function(){P={};for(var e=!l.enabled("save_chart_properties_to_local_storage"),t=o.length;t--;){var i=o.key(t);if(i&&V(i)){var r=i.substring(w.length);e&&!O(r)||(P[r]=o.getItem(i))}}}()):B(e||{}),F.fire()):i=!0},onSync:F,setSettingsAdapter:function(e){t=e}}}());setTimeout((function(){i.e(30362).then(i.bind(i,98376)).then(e=>{e.clearOldSettings()})}),3e4),e&&e.exports&&(e.exports=h)},29755:(e,t,i)=>{"use strict";i.d(t,{isSfQuoteData:()=>n});const r={sf_dly:0,sf_rt:0};function s(e){return r.hasOwnProperty(e)}function n(e){return!!e&&(!(void 0===e.symbolname||!s(e.symbolname))||Boolean("permission_denied"===e.status&&e.values&&void 0!==e.values.alternative&&s(e.values.alternative)))}},71073:(e,t,i)=>{"use strict";async function r(){if(!window.user||window.user.do_not_track)return null;{const e=(await Promise.all([i.e(46797),i.e(24081)]).then(i.bind(i,80686))).getTrackerInstance();return e||null}}i.d(t,{getTracker:()=>r})},65009:(e,t,i)=>{"use strict";i.d(t,{trackActionFollow:()=>s});var r=i(71073);function s(e,t,i){const s=i.authorId?i.authorId.toString():"",n=i.symbol?i.symbol:"",o=i.symbolType?i.symbolType:"";(0,r.getTracker)().then(i=>{i&&i.trackFollow(e,t,s,n,o)})}},2001:(e,t,i)=>{"use strict";i.d(t,{trackStudies:()=>o});var r=i(71073),s=i(84234),n=i.n(s);function o(e,t){
const i=e.metaInfo(),s=!e.isPine()||e.isStandardPine()?i.description:i.scriptIdPart,o=i.productId,a=n().isScriptStrategy(i),l=window.user&&window.user.pro_plan||"";(0,r.getTracker)().then(e=>{e&&e.trackStudiesAnalytics(s,o,t,a,l)})}},44439:(e,t,i)=>{"use strict";i.d(t,{syncUserData:()=>c,syncUserConversionData:()=>u});var r=i(87380),s=i(29098),n=i(85864);const o=(0,r.getLogger)("User.Sync");function a(e){return`${e}_${window.user&&window.user.username||""}`}function l(e,t,i){i!==window.user.pro_plan&&(window.user.pro_plan=i,window.user.is_pro=Boolean(i),(0,s.trackEvent)("Sync User Data","Different Pro Plan",a(e))),t!==window.is_authenticated&&(window.is_authenticated=t,window.loginStateChange.fire(),(0,s.trackEvent)("Sync User Data","Different Auth",a(e)))}async function c(e){try{const t=await i.e(90254).then(i.bind(i,27358));l(e,!0,(await t.getMe()).pro_plan)}catch(t){!function(e,t){"not_authenticated"===t.type?l(e,!1,void 0):o.logError(t.message)}(e,t)}}async function u(e){const t=await(0,n.fetch)("/gopro"),i=await t.json();return l(e,i.is_authenticated,i.user.pro_plan),i}},10164:(e,t,i)=>{"use strict";i.d(t,{telemetry:()=>d});var r=i(96276),s=i.n(r),n=i(85864),o=i(68724),a=i(40142);i(65194);const l=(0,i(87380).getLogger)("Common.Telemetry"),c={default:15e3,site:3e5},u=["before_websocket_connection_time_frame","websocket_connection_time_frame","first_series_full_time_frame","page_full_load_time_frame","page_load_time_frame"];const d=new class{constructor(){this.reportSent=new(s()),this.timeCounters={series:{marks:[]},study:{},pine:{}},this._timeoutIds={},this._commonAdditionalData={cluster:null,userId:"0"},this._reportStash={}}setSessionInfo(e){const t=this._parseCluster(e);null!==t&&(this._commonAdditionalData.cluster=t)}sendReport(e,t,i){var r;if(!this._isAbleToSendReport(t))return;const s=this._getSubserviceType(e),n=this._getHost(e,s);if(null!==n){if(i=void 0===i?{count:1}:i,this._addReportToStash(i,t,n),!this._timeoutIds[e]){const t=null!==(r=c[e])&&void 0!==r?r:c.default;this._timeoutIds[e]=setTimeout(this._sendTelemetryToService.bind(this,e,n),t)}}else l.logError(`Unable to get host for counter: ${t}, metric type: ${e}, serivce type: ${s}`)}sendChartReport(e,t,i=!0){this._updateUserInfo(),t=void 0===t?{count:1}:t,i&&(t=this._appendCommonAdditionalInfo(t,["cluster","userId"])),this.sendReport("charts",e,t)}_updateUserInfo(){const e="user"in window&&"id"in window.user?window.user.id:"0";this._commonAdditionalData.userId=String(e)}_isAbleToSendReport(e){const t=window.TELEMETRY_HOSTS,i=u.includes(e),r=Boolean(window.TradingView.onChartPage||(0,o.onWidget)());return t&&(!i||r)}_sendTelemetryToService(e,t){if(this._reportStash.hasOwnProperty(t)){const e=this._cropParams(this._reportStash[t]),i=this._renameAllParams(e),r={event:"report_stash",params:this._cleanAllParams(i)};l.logDebug(`Report to host: ${t}; stash: ${JSON.stringify(this._reportStash[t])}`),this.reportSent.fire(this._reportStash[t]),delete this._reportStash[t],(0,n.fetch)(t+"/report",{method:"POST",body:JSON.stringify(r)})}this._timeoutIds[e]=null}
_getHost(e,t){const i=window.TELEMETRY_HOSTS,r=i[e]&&i[e][t];return Boolean(r)?r:null}_getSubserviceType(e){if(!["charts","site"].includes(e))return"all";let t="free";const i=window.user.is_pro;return"charts"===e&&(0,a.isOnMobileAppPage)("old")?t=i?"ios_pro":"ios_free":"charts"===e&&(0,a.isOnMobileAppPage)("new")?t=i?"android_pro":"android_free":(0,o.onWidget)()?t="widget":i&&(t="pro"),t}_parseCluster(e){let t;try{t=JSON.parse(e).session_id}catch(e){return l.logError("Could not parse cluster id (session id)"),null}const i=/(.*@)(.*)/gi.exec(t);return null!==i&&i.length>=3?i[2]:null}_appendCommonAdditionalInfo(e,t){return t.forEach(t=>{t in this._commonAdditionalData&&(e.additional=e.additional||{},e.additional[t]=this._commonAdditionalData[t])}),e}_cropParams(e){var t;for(const i in e)e.hasOwnProperty(i)&&e[i].length>1e3&&(e.too_much_metrics_frame=null!==(t=e.too_much_metrics_frame)&&void 0!==t?t:[],e.too_much_metrics_frame.push({value:e[i].length,additional:{event:i}}),delete e[i]);return e}_renameAllParams(e){const t={};for(const i in e)e.hasOwnProperty(i)&&(t[i]=[],e[i].forEach(e=>{t[i].push(this._renameEntryParams(e))}));return t}_renameEntryParams(e){const t={count:"c",value:"v",text:"t",additional:"a"};return Object.keys(e).reduce((i,r)=>(i[t[r]]=e[r],i),{})}_cleanAllParams(e){const t={};for(const i in e)if(e.hasOwnProperty(i)){t[i]=[];const r={c:0};e[i].forEach(e=>{const s=this._cleanEntryParams(e),n=Object.keys(s).length;1===n&&void 0!==s.c?r.c+=s.c:n>0&&t[i].push(s)}),r.c>0&&t[i].push(r),0===t[i].length&&delete t[i]}return t}_cleanEntryParams(e){const t=Object.keys(e).reduce((t,i)=>"c"!==i&&"t"!==i||e[i]?(t[i]=e[i],t):t,{});return"c"in t||"v"in t||"t"in t?t:{}}_addReportToStash(e,t,i){i in this._reportStash||(this._reportStash[i]={}),t in this._reportStash[i]||(this._reportStash[i][t]=[]),Object.keys(e).length>0&&this._reportStash[i][t].push(e)}}},59943:(e,t,i)=>{"use strict";function r(e,t=window){const i="theme-"+e,r=t.document.documentElement.classList;for(const e of Array.from(r))e.startsWith("theme-")&&e!==i&&r.remove(e);r.add(i)}i.r(t),i.d(t,{applyTheme:()=>r})},80380:(e,t,i)=>{"use strict";i.d(t,{DEFAULT_THEME:()=>r});const r="light"},19903:(e,t,i)=>{"use strict";i.d(t,{themes:()=>l});var r=i(64853),s=i(20220)
;const n=JSON.parse('{"color-bg-primary":"color-cold-gray-850","color-bg-primary-hover":"color-cold-gray-800","color-bg-secondary":"color-cold-gray-900","color-bg-highlight":"color-cold-gray-900","color-bg-scroll-buttons":"color-cold-gray-800","color-legacy-bg-scroll-buttons":"color-cold-gray-550","color-legacy-bg-widget":"color-cold-gray-900","color-text-primary":"color-cold-gray-200","color-text-secondary":"color-cold-gray-500","color-text-tertiary":"color-cold-gray-400","color-text-disabled":"color-cold-gray-650","color-accent-content":"color-white","color-divider":"color-cold-gray-700","color-divider-hover":"color-cold-gray-800","color-divider-secondary":"color-cold-gray-800","color-box-shadow":"color-cold-gray-900","color-active-hover-text":"color-cold-gray-300","color-alert-text":"color-cold-gray-200","color-border":"color-cold-gray-750","color-border-chat-fields":"color-cold-gray-750","color-border-hover":"color-cold-gray-650","color-border-table":"color-cold-gray-800","color-brand":"color-tv-blue-500","color-brand-hover":"color-tv-blue-600","color-brand-active":"color-tv-blue-700","color-button-hover-bg":"color-cold-gray-850","color-chart-page-bg":"color-cold-gray-800","color-common-tooltip-bg":"color-cold-gray-750","color-danger":"color-ripe-red-600","color-danger-hover":"color-ripe-red-500","color-danger-active":"color-ripe-red-400","color-depthrenderer-fill-style":"color-cold-gray-150","color-depthrenderer-stroke-style":"color-cold-gray-650","color-disabled-border-and-color":"color-cold-gray-800","color-disabled-input":"color-cold-gray-750","color-empty-container-message":"color-cold-gray-500","color-highlight-new":"color-tv-blue-a800","color-icons":"color-cold-gray-500","color-input-bg":"color-cold-gray-800","color-input-textarea-readonly":"color-cold-gray-650","color-input-placeholder-text":"color-cold-gray-700","color-input-publish-bg":"color-cold-gray-900","color-item-active-blue":"color-tv-blue-a800","color-item-hover-active-bg":"color-cold-gray-800","color-item-hover-bg":"color-cold-gray-800","color-item-hover-blue":"color-tv-blue-a800","color-item-selected-blue":"color-tv-blue-a800","color-item-active-text":"color-cold-gray-200","color-item-active-bg":"color-tv-blue-500","color-link":"color-tv-blue-500","color-link-hover":"color-tv-blue-600","color-link-active":"color-tv-blue-700","color-list-item":"color-cold-gray-500","color-list-nth-child-bg":"color-cold-gray-850","color-news-highlight":"color-cold-gray-800","color-pane-bg":"color-cold-gray-900","color-pane-secondary-bg":"color-cold-gray-850","color-placeholder":"color-cold-gray-650","color-popup-menu-item-hover-bg":"color-cold-gray-800","color-popup-menu-separator":"color-cold-gray-700","color-row-hover-active-bg":"color-cold-gray-800","color-sb-scrollbar-body-bg":"color-cold-gray-650","color-screener-description":"color-cold-gray-200","color-section-separator-border":"color-cold-gray-750","color-search-button-hover":"color-cold-gray-700","color-separator-table-chat":"color-cold-gray-750","color-success":"color-minty-green-700","color-success-hover":"color-minty-green-600","color-success-active":"color-minty-green-500","color-tag-active-bg":"color-cold-gray-750","color-tag-hover-bg":"color-cold-gray-800","color-text-regular":"color-cold-gray-200","color-toolbar-button-text":"color-cold-gray-300","color-toolbar-button-text-hover":"color-cold-gray-300","color-toolbar-button-text-active":"color-tv-blue-500","color-toolbar-button-text-active-hover":"color-tv-blue-600","color-toolbar-button-background-hover":"color-cold-gray-800","color-toolbar-button-background-secondary-hover":"color-cold-gray-750","color-toolbar-toggle-button-background-active":"color-tv-blue-500","color-toolbar-toggle-button-background-active-hover":"color-tv-blue-600","color-toolbar-interactive-element-text-normal":"color-cold-gray-300","color-toolbar-interactive-element-text-hover":"color-cold-gray-250","color-toolbar-opened-element-bg":"color-cold-gray-800","color-tooltip-bg":"color-cold-gray-750","color-tv-button-checked":"color-cold-gray-500","color-tv-dialog-caption":"color-cold-gray-50","color-tv-dropdown-item-hover-bg":"color-cold-gray-800","color-underlined-text":"color-cold-gray-300","color-widget-pages-bg":"color-cold-gray-900","color-warning":"color-tan-orange-700","color-forex-icon":"color-white","color-list-item-active-bg":"color-tv-blue-500","color-list-item-hover-bg":"color-cold-gray-800","color-list-item-text":"color-cold-gray-200","color-price-axis-label-back":"color-cold-gray-800","color-price-axis-label-text":"color-cold-gray-500","color-price-axis-gear":"color-cold-gray-500","color-price-axis-gear-hover":"color-cold-gray-400","color-price-axis-highlight":"color-cold-gray-800","color-bid":"color-tv-blue-500","color-scroll-bg":"color-cold-gray-750","color-scroll-border":"color-cold-gray-850","color-widget-border":"color-cold-gray-800","color-scroll-buttons-arrow":"color-white","color-control-intent-default":"color-cold-gray-650","color-control-intent-success":"color-minty-green-600","color-control-intent-primary":"color-tv-blue-500","color-control-intent-warning":"color-tan-orange-500","color-control-intent-danger":"color-ripe-red-700","color-growing":"color-minty-green-600","color-falling":"color-ripe-red-600","color-pre-market":"color-tan-orange-600","color-pre-market-bg":"color-tan-orange-400","color-post-market":"color-tv-blue-500","color-post-market-bg":"color-tv-blue-400","color-market-open":"color-minty-green-500","color-market-open-bg":"color-minty-green-400","color-market-closed":"color-cold-gray-400","color-market-holiday":"color-cold-gray-400","color-invalid-symbol":"color-ripe-red-400","color-invalid-symbol-hover":"color-ripe-red-500","color-replay-mode":"color-tv-blue-500","color-replay-mode-icon":"color-tv-blue-50","color-replay-mode-hover":"color-tv-blue-600","color-notaccurate-mode":"color-berry-pink-700","color-notaccurate-mode-bg":"color-berry-pink-400","color-delay-mode":"color-tan-orange-700","color-delay-mode-bg":"color-tan-orange-400","color-eod-mode":"color-grapes-purple-700","color-eod-mode-bg":"color-grapes-purple-400","color-data-problem":"color-ripe-red-600","color-data-problem-bg":"color-ripe-red-400","color-data-problem-hover":"color-ripe-red-500","color-list-item-bg-highlighted":"color-tv-blue-a900","color-list-item-bg-selected":"color-tv-blue-a800","color-list-item-bg-highlighted-hover":"color-tv-blue-a800","color-list-item-bg-selected-hover":"color-tv-blue-a700","color-screener-header-bg":"color-cold-gray-850","color-screener-header-bg-hover":"color-cold-gray-800","color-overlay":"color-cold-gray-950","color-card-border":"color-cold-gray-700","color-card-border-hover":"color-cold-gray-600","color-background-special-primary":"color-black","color-stroke-special-primary":"color-cold-gray-800","color-selection-bg":"color-tv-blue-a700"}'),o=JSON.parse('{"color-toolbar-button-text-active":"color-seeking-alpha-brand"}')
;var a=i(93669);const l={[r.StdTheme.Light]:{name:r.StdTheme.Light,label:()=>(0,s.t)("Light",{context:"colorThemeName"}),order:2,getThemedColor:e=>(0,a.getHexColorByName)(e)},[r.StdTheme.Dark]:{name:r.StdTheme.Dark,label:()=>(0,s.t)("Dark",{context:"colorThemeName"}),order:1,getThemedColor:e=>{const t=n[e]||e;return(0,a.getHexColorByName)(t)}}};l.sa={isPrivate:!0,noChartTheme:!0,name:"sa",getThemedColor:e=>{const t=o[e]||e;return(0,a.getHexColorByName)(t)}}},64853:(e,t,i)=>{"use strict";i.r(t),i.d(t,{StdTheme:()=>a.StdTheme,getStdChartTheme:()=>u,getStdThemeNames:()=>c,getThemeNameIfStdTheme:()=>p,isStdTheme:()=>h,translateThemeName:()=>d});var r=i(20220),s=i(14563)
;const n=JSON.parse('{"content":{"chartProperties":{"scalesProperties":{"textColor":"#131722","lineColor":"rgba(42, 46, 57, 0.14)","backgroundColor":"#ffffff"},"paneProperties":{"vertGridProperties":{"color":"rgba(42, 46, 57, 0.06)"},"horzGridProperties":{"color":"rgba(42, 46, 57, 0.06)"},"crossHairProperties":{"color":"#9598A1"},"background":"#ffffff","backgroundGradientStartColor":"#ffffff","backgroundGradientEndColor":"#ffffff"}},"sessions":{"graphics":{"backgrounds":{"outOfSession":{"color":"#2962FF","transparency":92},"preMarket":{"color":"#FF9800","transparency":92},"postMarket":{"color":"#2962FF","transparency":92}},"vertlines":{"sessBreaks":{"color":"#4985e7","style":2,"width":1}}}},"mainSourceProperties":{"baseLineColor":"#B2B5BE","candleStyle":{"borderColor":"#378658","upColor":"#26a69a","wickColor":"#737375","wickUpColor":"#26a69a","wickDownColor":"#ef5350","downColor":"#ef5350","borderUpColor":"#26a69a","borderDownColor":"#ef5350"},"haStyle":{"borderColor":"#378658","upColor":"#26a69a","wickColor":"#737375","wickUpColor":"#26a69a","wickDownColor":"#ef5350","downColor":"#ef5350","borderUpColor":"#26a69a","borderDownColor":"#ef5350"},"barStyle":{"downColor":"#ef5350","upColor":"#26a69a"},"pnfStyle":{"downColor":"#ef5350","upColor":"#26a69a","upColorProjection":"#a9dcc3","downColorProjection":"#f5a6ae"},"baselineStyle":{"baselineColor":"rgba( 117, 134, 150, 1)","topFillColor1":"rgba( 38, 166, 154, 0.28)","topFillColor2":"rgba( 38, 166, 154, 0.05)","bottomFillColor1":"rgba( 239, 83, 80, 0.05)","bottomFillColor2":"rgba( 239, 83, 80, 0.28)","topLineColor":"rgba( 38, 166, 154, 1)","bottomLineColor":"rgba( 239, 83, 80, 1)"},"areaStyle":{"transparency":100,"color1":"rgba(41, 98, 255, 0.28)","color2":"#2962FF","linecolor":"#2962FF","linewidth":2,"linestyle":0},"renkoStyle":{"upColor":"#26a69a","downColor":"#ef5350","borderUpColor":"#26a69a","borderDownColor":"#ef5350","upColorProjection":"#a9dcc3","downColorProjection":"#f5a6ae","borderUpColorProjection":"#a9dcc3","borderDownColorProjection":"#f5a6ae","wickUpColor":"#26a69a","wickDownColor":"#ef5350"},"lineStyle":{"color":"#2962FF","linewidth":2,"linestyle":0},"kagiStyle":{"downColor":"#ef5350","upColor":"#26a69a","upColorProjection":"#a9dcc3","downColorProjection":"#f5a6ae"},"pbStyle":{"upColor":"#26a69a","downColor":"#ef5350","borderUpColor":"#26a69a","borderDownColor":"#ef5350","upColorProjection":"#a9dcc3","downColorProjection":"#f5a6ae","borderUpColorProjection":"#a9dcc3","borderDownColorProjection":"#f5a6ae"},"rangeStyle":{"upColor":"#26a69a","downColor":"#ef5350","upColorProjection":"#a9dcc3","downColorProjection":"#f5a6ae"}}}}'),o=JSON.parse('{"content":{"chartProperties":{"scalesProperties":{"textColor":"#B2B5BE","lineColor":"rgba(240, 243, 250, 0.12)","backgroundColor":"#ffffff"},"paneProperties":{"vertGridProperties":{"color":"rgba(240, 243, 250, 0.06)"},"horzGridProperties":{"color":"rgba(240, 243, 250, 0.06)"},"crossHairProperties":{"color":"#9598A1"},"background":"#131722","backgroundGradientStartColor":"#181C27","backgroundGradientEndColor":"#131722","backgroundType":"gradient"}},"sessions":{"graphics":{"backgrounds":{"outOfSession":{"color":"#2962FF","transparency":92},"preMarket":{"color":"#FF9800","transparency":92},"postMarket":{"color":"#2962FF","transparency":92}},"vertlines":{"sessBreaks":{"color":"#4985e7","style":2,"width":1}}}},"mainSourceProperties":{"baseLineColor":"#5d606b","candleStyle":{"borderColor":"#378658","upColor":"#26a69a","wickColor":"#B5B5B8","wickUpColor":"#26a69a","wickDownColor":"#ef5350","downColor":"#ef5350","borderUpColor":"#26a69a","borderDownColor":"#ef5350"},"haStyle":{"borderColor":"#378658","upColor":"#26a69a","wickColor":"#B5B5B8","wickUpColor":"#26a69a","wickDownColor":"#ef5350","downColor":"#ef5350","borderUpColor":"#26a69a","borderDownColor":"#ef5350"},"barStyle":{"downColor":"#ef5350","upColor":"#26a69a"},"pnfStyle":{"downColor":"#ef5350","upColor":"#26a69a","upColorProjection":"#336854","downColorProjection":"#7f323f"},"baselineStyle":{"baselineColor":"rgba( 117, 134, 150, 1)","topFillColor1":"rgba( 38, 166, 154, 0.28)","topFillColor2":"rgba( 38, 166, 154, 0.05)","bottomFillColor1":"rgba( 239, 83, 80, 0.05)","bottomFillColor2":"rgba( 239, 83, 80, 0.28)","topLineColor":"rgba( 38, 166, 154, 1)","bottomLineColor":"rgba( 239, 83, 80, 1)"},"areaStyle":{"transparency":100,"color1":"rgba(41, 98, 255, 0.28)","color2":"#2962FF","linecolor":"#2962FF","linewidth":2,"linestyle":0},"renkoStyle":{"upColor":"#26a69a","downColor":"#ef5350","borderUpColor":"#26a69a","borderDownColor":"#ef5350","upColorProjection":"#336854","downColorProjection":"#7f323f","borderUpColorProjection":"#336854","borderDownColorProjection":"#7f323f","wickUpColor":"#26a69a","wickDownColor":"#ef5350"},"lineStyle":{"color":"#2962FF","linewidth":2,"linestyle":0},"kagiStyle":{"downColor":"#ef5350","upColor":"#26a69a","upColorProjection":"#336854","downColorProjection":"#7f323f"},"pbStyle":{"upColor":"#26a69a","downColor":"#ef5350","borderUpColor":"#26a69a","borderDownColor":"#ef5350","upColorProjection":"#336854","downColorProjection":"#7f323f","borderUpColorProjection":"#336854","borderDownColorProjection":"#7f323f"},"rangeStyle":{"upColor":"#26a69a","downColor":"#ef5350","upColorProjection":"#336854","downColorProjection":"#7f323f"}}}}')
;var a=i(53321);function l(){return{[a.StdTheme.Light]:JSON.parse(JSON.stringify(n)),[a.StdTheme.Dark]:JSON.parse(JSON.stringify(o))}}function c(){return[a.StdTheme.Light,a.StdTheme.Dark]}function u(e){return l()[e]}function d(e){return{[a.StdTheme.Light]:r.t("Light",{context:"colorThemeName"}),[a.StdTheme.Dark]:r.t("Dark",{context:"colorThemeName"})}[e]||e}function h(e){const t=l();return c().some(i=>_(t[i],e))}function p(e){const t=l(),i=c();for(const r of i)if(_(t[r],e))return r;return null}function _(e,t){let i=e.content===t.content;return function(e={},t){try{!function e(t,i,r){for(const s in t)if(t.hasOwnProperty(s)){const n=i.concat(s);if("object"==typeof t[s])e(t[s],n,r);else if(r(n,t[s]))throw new Error("exit")}}(e,[],t)}catch(e){return}}(e.content,(e,r)=>{const n=function(e,t={}){let i=t;for(let t=0;t<e.length;t++){if(!i||"object"!=typeof i)return;i=i[e[t]]}if("string"==typeof i||"number"==typeof i)return i;return}(e,t.content);return i=function(e,t){if("string"==typeof e&&"string"==typeof t)try{return(0,s.areEqualRgb)((0,s.parseRgb)(e),(0,s.parseRgb)(t))}catch(i){return e===t}return e===t}(r,n),!i}),i}},53321:(e,t,i)=>{"use strict";var r;i.d(t,{StdTheme:()=>r}),function(e){e.Light="light",e.Dark="dark"}(r||(r={}))},97483:(e,t,i)=>{"use strict";i.d(t,{getThemeFromUserSettings:()=>s,saveThemeInUserSettings:()=>n});var r=i(42098);function s(){return(0,r.getValue)("current_theme.name")||null}function n(e){(0,r.setValue)("current_theme.name",e,{forceFlush:!0})}},34698:(e,t,i)=>{"use strict";i.r(t),i.d(t,{DEFAULT_THEME:()=>h.DEFAULT_THEME,extractThemeFromModel:()=>D,getCurrentTheme:()=>m,getStdTheme:()=>T,getStdThemeNames:()=>P,getStdThemedValue:()=>x,getTheme:()=>b,getThemeNames:()=>w,getThemedColor:()=>f,isPublicTheme:()=>_,isStdTheme:()=>k,isStdThemeName:()=>C,isStdThemedDefaultValue:()=>I,isThemeExist:()=>E,loadTheme:()=>g,removeTheme:()=>M,restoreTheme:()=>v,saveTheme:()=>L,savedThemeName:()=>S,syncTheme:()=>y,themes:()=>p.themes,translateStdThemeName:()=>A});var r=i(14563),s=i(68981),n=i(97483),o=i(85864);const a=(0,i(87380).getLogger)("Themes.Provider");let l=null;function c(e){return(0,o.fetch)("/theme/?themeName="+encodeURIComponent(e),{credentials:"include",method:"GET"}).then(e=>e.json()).then(e=>{const t={};return e.content&&(t.content=JSON.parse(e.content)),t})}var u=i(64853),d=i(87479),h=i(80380),p=i(19903);function _(e){return!e.isPrivate}function m(){return p.themes[d.watchedTheme.value()]||p.themes[h.DEFAULT_THEME]}function f(e){return m().getThemedColor(e)}async function g(e,t,i,r,n=!0,o=!1,a=!1){const l=await(t?Promise.resolve(T(e)):b(e));if(void 0!==l.content){const u=!t;a&&(void 0!==(c=l.content).chartProperties&&(0,s.applyDefaultsOverrides)(c.chartProperties),void 0!==c.mainSourceProperties&&(0,s.applyDefaultsOverrides)(c.mainSourceProperties,void 0,!0,"mainSeriesProperties")),await r.applyTheme(l.content,u,i,e,t,n,o)}var c;return l}function v(){(0,d.setTheme)((0,n.getThemeFromUserSettings)()||h.DEFAULT_THEME)}function S(){return(0,n.getThemeFromUserSettings)()}function y(){(0,
n.saveThemeInUserSettings)(m().name)}function b(e){return c(e)}function w(){return l||(0,o.fetch)("/themes/",{credentials:"include",method:"GET"}).then(e=>(l=e.json(),l))}function P(){return u.getStdThemeNames()}function C(e){return P().includes(e)}function T(e){return u.getStdChartTheme(e)||{content:void 0}}function x(e,t){const i=t||m().name,r=u.getStdChartTheme(i),s=0!==e.length&&e.split(".");return r&&r.content&&s?s.reduce((e,t)=>e[t],r.content):null}function I(e,t,i){const s=x(e,i);return null!==s&&(0,r.areEqualRgba)((0,r.parseRgba)(s),(0,r.parseRgba)(String(t)))}function L(e,t){return function(e,t){const i=new FormData;return i.append("content",JSON.stringify(t)),i.append("name",e),l=null,(0,o.fetch)("/save-theme/",{credentials:"include",method:"POST",body:i}).then(e=>e.json(),e=>a.logError(e))}(e,t)}function M(e){return function(e){const t=new FormData;return t.append("name",e),l=null,(0,o.fetch)("/remove-theme/",{credentials:"include",method:"POST",body:t}).then(e=>e.json(),e=>a.logError(e))}(e)}function E(e){return function(e){return c(e).then(e=>Boolean(e.content))}(e)}function A(e){return u.translateThemeName(e)}function k(e){return u.isStdTheme(e)}function D(e){return{content:{chartProperties:{paneProperties:e.model().properties().paneProperties.state(),scalesProperties:e.model().properties().scalesProperties.state()},sessions:e.model().sessions().properties().state(),mainSourceProperties:e.model().mainSeries().properties().state()}}}},87479:(e,t,i)=>{"use strict";i.r(t),i.d(t,{watchedTheme:()=>o,setTheme:()=>a});var r=i(65066),s=i.n(r),n=i(59943);const o=new(s());function a(e){o.setValue(e)}o.subscribe(e=>{(0,n.applyTheme)(e,window)})},29098:(e,t,i)=>{"use strict";i.d(t,{trackEvent:()=>l});var r=i(88001),s=i(22842);const n=(0,i(87380).getLogger)("Common.TrackEvent"),o=[/Study_(Drawing)_(.*)/,/(Study)_(.*)@tv-basicstudies/,/(Study)_(.*)/,/(Chart Style) (.*)/];let a=!1;const l=(e,t,i)=>{if(a)return;if(s.enabled("charting_library_base"))return void((e,t,i)=>{t=t||e||i||"";let s="";for(let e=0;e<o.length;e++){const i=t.match(o[e]);if(i&&3===i.length){t=i[1],s=i[2];break}}(0,r.emit)(t.toLowerCase().replace(" ","_"),{category:e,label:i,value:s})})(e,t,i);let l=(e?e+":":"")+t;i&&(l+=" "+i),n.logNormal(l),s.enabled("widget")||!window._UNIT_TESTS&&window.gtag&&window.gtag("event",t,{event_category:e,event_label:i})};"undefined"!=typeof window&&(window.TradingView=window.TradingView||{},window.TradingView.trackEvent=l)},12943:(e,t,i)=>{"use strict";i.d(t,{default:()=>n});var r=i(29098);const s={filterNamesMap:{script_type:"Indicators and Strategies","script_type-indicators":"Indicators","script_type-strategies":"Strategies",stream:"All Markets","stream-stocks":"Stocks","stream-indices":"Indices","stream-commodities":"Commodities","stream-currencies":"Currencies","stream-bitcoin":"Bitcoin","interval-all":"All Intervals","interval-m":"Short Term","interval-h":"Medium Term","interval-dwm":"Long Term","sort-unmoderated":"Unmoderated","sort-trending":"Trending","sort-discussed":"Most Discussed",
"sort-viewed":"Most Viewed","sort-agreed":"Most Agreed","sort-suggested":"Suggested","sort-recent":"All Ideas","time-day":"Today","time-week":"This Week","time-month":"This Month","time-all":"All Time","by-everyone":"Everyone","by-following":"Following","by-me":"My Ideas"},goProFeaturesMap:{customIntervals:"Add Custom Interval",intradaySpread:"Inraday Spread",kagiRenko:"Japanese Intraday Chart",alerts:{prefix:"New Alerts Limit",widget:"Widget",chart:"Chart Header"},multipleCharts:"Multiple Charts Layout",savedChartsLimit:"Save Chart Limit",studyLimit:"Studies Limit",multipleWatchLists:{prefix:"Watchlists",new:"Create New List",rename:"Rename List",saveAs:"Save List As"},importWatchlist:"Watchlists Import Watchlist",exportWatchlist:"Watchlists Export Watchlist",BATSExchangePopup:"BATS Exchange Popup",DataQualityPopup:"Data Quality Popup",FreeDelayPopup:"Free Delay Popup",proRTProduct:"Volume Profile",studyOnStudy:"Unlimited Study on Study"},trackFeature:{savedChartsLimit:!0,BATSExchangePopup:!0,FreeDelayPopup:!0,DataQualityPopup:!0,intradaySpread:!0,studyOnStudy:!0},trackGoPro:function(e,t,i){i&&!t&&(t=i,i=null);var n=s.goProFeaturesMap[t];if(n){if(i){if("string"==typeof n)return;n="{0} {1}".format(n.prefix,n[i])}(0,r.trackEvent)(e,n)}}},n=s},82655:(e,t,i)=>{"use strict";i.r(t),i.d(t,{trackGoProFeature:()=>s});var r=i(12943);function s(e,t){r.default.trackGoPro("Gopro Features",e,t)}},41962:(e,t,i)=>{"use strict";i.d(t,{TVXWindowEvents:()=>o});i(68421);var r=i(87380),s=i(55119);const n=(0,r.getLogger)("XWindowEvents");var o;!function(e){const t="tvxwevents.",i={};let r;window.BroadcastChannel?(r=new BroadcastChannel("tvxwevents"),r.addEventListener("message",(function(e){const{data:{event:t,value:r}}=e;i[t]&&i[t].forEach(e=>{e(r)})})),function(){const e=[],i=performance.now();for(let i=0;i<s.TVLocalStorage.length;i++){const r=s.TVLocalStorage.key(i);r.startsWith(t)&&e.push(r)}const r=s.TVLocalStorage.length;for(const t of e)s.TVLocalStorage.removeItem(t);const o=performance.now()-i;n.logNormal("Total keys amount in local storage on operation start: "+r),n.logNormal("Keys amount in local storage to be deleted: "+e.length),n.logNormal("Keys to be deleted from local storage: "+JSON.stringify(e)),n.logNormal(`Removing keys from local storage took ${o} ms`)}()):window.addEventListener("storage",(function(e){const{newValue:r,key:n}=e;if(null===r||!n||!n.startsWith(t))return;const o=n.substr(t.length);i[o]&&i[o].forEach(t=>{t(e.newValue)});s.TVLocalStorage.removeItem(n)})),e.on=function(e,t){i[e]||(i[e]=[]),i[e].push(t)},e.off=function(e,t){if(!i[e])return;const r=i[e].indexOf(t);-1!==r&&(1===i[e].length?delete i[e]:i[e].splice(r,1))},e.emit=function(e,i=Date.now()){try{r?r.postMessage({event:e,value:i}):s.TVLocalStorage.setItem(t+e,i.toString())}catch(e){n.logError(e.message)}}}(o||(o={}))},10786:(e,t,i)=>{"use strict";i.d(t,{isMobile:()=>o,isPlatformMobile:()=>a,canShowNewSymbolSearch:()=>l});var r=i(40142),s=i(22842),n=i(68724);function o(){const e=window.matchMedia("(min-width: 602px) and (min-height: 445px)").matches
;return n.CheckMobile.any()&&!e}function a(){return!(0,r.isOnMobileAppPage)("any")&&o()}function l(){return!s.enabled("widget")&&!(0,r.isOnMobileAppPage)("any")}},70955:(e,t,i)=>{"use strict";i.r(t),i.d(t,{activateKeyPressHandler:()=>h,showDialog:()=>p});var r=i(44385),s=i(63951),n=i(22842),o=i(21331),a=i(44937),l=i(60780),c=i(29098);let u=null;function d(e){if(!(0,s.globalKeypressMatches)(e))return!1;e.preventDefault();const t=String.fromCharCode(e.charCode);return n.enabled("show_interval_dialog_on_key_press")&&function(e){return/[1-9]/.test(e)}(t)?(0,o.showChangeIntervalDialogAsync)({initVal:t}):n.enabled("symbol_search_hot_key")&&(p({defaultValue:t,selectSearchOnInit:!1,source:"keyboard"}),(0,c.trackEvent)("GUI","SS","hotkey")),!0}function h(){(0,a.loadChangeIntervalDialog)(),r.pushBackListener("symbolEdit",d)}function p(e){const t=u=(0,l.loadNewSymbolSearch)().then(i=>{t===u&&i.showDefaultSearchDialog(e)});return t}},70677:(e,t,i)=>{"use strict";i.d(t,{hasMoreFinancialsButton:()=>a});const r=new Set(["stock","dr","right","warrant","structured","bond"]),s=new Set(["mutual","unit","trust","reit","etn","closedend"]),n=new Set(["convertible","corporate"]),o=new Set(["cfd"]);function a(e,t){return"fund"===e&&(null==t?void 0:t.length)?t.filter(e=>s.has(e)).length>0:"bond"===e&&(null==t?void 0:t.length)?t.filter(e=>n.has(e)).length>0:"stock"===e&&(null==t?void 0:t.length)?0===t.filter(e=>o.has(e)).length:Boolean(e&&r.has(e))}},84199:(e,t,i)=>{"use strict";i.d(t,{CompareDialogRenderer:()=>s});var r=i(63628);class s extends r.DialogRenderer{constructor(e){super(),this._dialog=null,this._subscribe=e=>{this._setVisibility(e)},this._chartWidgetCollection=e}show(){this._load().then(e=>{var t,i;null===(t=this._dialog)||void 0===t||t.hide(),null===(i=this._dialog)||void 0===i||i.visible().unsubscribe(this._subscribe),this._dialog=e,e.visible().subscribe(this._subscribe),e.show()})}hide(){var e;null===(e=this._dialog)||void 0===e||e.hide()}_load(){return Promise.all([Promise.all([i.e(45080),i.e(57271)]).then(i.bind(i,65773)),Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(29448),i.e(88278),i.e(32795),i.e(52802),i.e(43894),i.e(33996),i.e(94595),i.e(94269),i.e(87936),i.e(55442),i.e(26992),i.e(96271),i.e(93228),i.e(57373),i.e(25913),i.e(97757),i.e(14303),i.e(38136),i.e(73935),i.e(43424),i.e(1529),i.e(36982),i.e(27420),i.e(9881),i.e(45080),i.e(9622),i.e(27274),i.e(9394),i.e(12503),i.e(20356),i.e(5131),i.e(20153),i.e(30731)]).then(i.bind(i,50408))]).then(([e,t])=>{const i=new e.CompareModel(this._chartWidgetCollection);return t.getCompareDialogRenderer(i)})}}},99219:(e,t,i)=>{"use strict";i.d(t,{showDetailsDialog:()=>o});var r=i(63628);let s;class n extends r.DialogRenderer{constructor(){super(...arguments),this._dialog=null,this._promise=null,this._subscribe=e=>{this._setVisibility(e)}}show(e){
const t=this._promise=Promise.all([i.e(23876),i.e(26822),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(52802),i.e(43894),i.e(33996),i.e(94595),i.e(94269),i.e(13940),i.e(19843),i.e(51219),i.e(53684),i.e(68491),i.e(64810),i.e(62602),i.e(69993),i.e(36224),i.e(3191),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(36982),i.e(27420),i.e(40953),i.e(45080),i.e(27274),i.e(38464),i.e(4033),i.e(45856),i.e(71062),i.e(23790),i.e(96663),i.e(95999),i.e(53513),i.e(26720)]).then(i.bind(i,15296)).then(i=>{this._promise===t&&(this._dialog&&(this._dialog.hide(),this._dialog.visible().unsubscribe(this._subscribe)),this._dialog=new i.DetailsDialogRenderer,this._dialog.visible().subscribe(this._subscribe),this._dialog.show(e))})}hide(){var e,t;null===(e=this._dialog)||void 0===e||e.hide(),null===(t=this._dialog)||void 0===t||t.visible().unsubscribe(this._subscribe)}static getInstance(){return s||(s=new n),s}}function o(e){n.getInstance().show(e)}},66661:(e,t,i)=>{"use strict";i.d(t,{IndicatorsPreloader:()=>o});var r=i(57746),s=i(85242),n=i(95033);class o{constructor(e){this._chartWidgetCollection=e}getIndicatorPromises(){var e,t,i,o,a,l,c,u;const d=(null===(e=this._initIndicatorsPromises)||void 0===e?void 0:e.javaStudiesPromise)||(0,s.requestBuiltInJavaStudies)(this._chartWidgetCollection),h=(null===(t=this._initIndicatorsPromises)||void 0===t?void 0:t.standardScriptsPromise)||(0,r.requestBuiltinScripts)(),p=(null===(i=this._initIndicatorsPromises)||void 0===i?void 0:i.candlestickScriptsPromise)||(0,r.requestCandlestickScripts)(),_=(null===(o=this._initIndicatorsPromises)||void 0===o?void 0:o.publicPineStudiesPromise)||(0,s.fetchPublicPineStudies)((0,s.createPublicStudiesRequestParams)("top")),m=(null===(a=this._initIndicatorsPromises)||void 0===a?void 0:a.trendingStudiesPromise)||(0,s.fetchPublicPineStudies)((0,s.createPublicStudiesRequestParams)("trending")),f=(null===(l=this._initIndicatorsPromises)||void 0===l?void 0:l.editorsPicksStudiesPromise)||(0,s.fetchEditorsPicksStudies)(),g=(null===(c=this._initIndicatorsPromises)||void 0===c?void 0:c.addonsPromise)||(0,s.requestAddons)(),v=(null===(u=this._initIndicatorsPromises)||void 0===u?void 0:u.pinePermissionsPromise)||n.PinePerm.listScripts(),S=(0,r.requestUserScripts)();return this._initIndicatorsPromises={javaStudiesPromise:d,userScriptsPromise:S,standardScriptsPromise:h,candlestickScriptsPromise:p,publicPineStudiesPromise:_,trendingStudiesPromise:m,addonsPromise:g,pinePermissionsPromise:v,editorsPicksStudiesPromise:f},this._initIndicatorsPromises}}},85242:(e,t,i)=>{"use strict";i.d(t,{fetchPublicPineStudies:()=>n,fetchEditorsPicksStudies:()=>o,fetchLoadMorePublicStudies:()=>a,createPublicStudiesRequestParams:()=>l,requestAddons:()=>c,requestBuiltInJavaStudies:()=>u});var r=i(85864),s=i(57746);async function n(e){return(await(0,r.fetch)("/pubscripts-library/?"+e)).json()}async function o(){return(await(0,r.fetch)("/pubscripts-library/editors-picks/")).json()}async function a(e){return(await(0,r.fetch)(e)).json()}function l(e){const t={offset:0,count:20,type:0,sort:e}
;return new URLSearchParams(Object.entries(t)).toString()}function c(e){if(!window.pro)return;const t=[];return Object.entries(window.pro.getStudies()).forEach(([i,r])=>{var n;if((null===(n=window.pro)||void 0===n?void 0:n.hasPackage(i))&&r.subproduct_ids&&r.subproduct_ids[0]){const n=r.subproduct_ids[0].split("$")[1];e&&e(i),t.push((0,s.requestPineAddons)(n))}}),Promise.all(t)}function u(e){return e.activeChartWidget.value().metaInfoRepository().findAllJavaStudies()}},79407:(e,t,i)=>{"use strict";async function r(e,t){const r=await Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(88278),i.e(63193),i.e(61212),i.e(85597),i.e(60700),i.e(24261),i.e(81594),i.e(73935),i.e(43424),i.e(19894),i.e(39351),i.e(38890)]).then(i.bind(i,41994));return r.showSimpleDialog(e,r.renameModule,t)}async function s(e,t){const r=await Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(88278),i.e(63193),i.e(61212),i.e(85597),i.e(60700),i.e(24261),i.e(81594),i.e(73935),i.e(43424),i.e(19894),i.e(39351),i.e(38890)]).then(i.bind(i,41994));return r.showSimpleDialog(e,r.confirmModule,t)}async function n(e,t){const r=await Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(88278),i.e(63193),i.e(61212),i.e(85597),i.e(60700),i.e(24261),i.e(81594),i.e(73935),i.e(43424),i.e(19894),i.e(39351),i.e(38890)]).then(i.bind(i,41994));return r.showSimpleDialog(e,r.warningModule,t)}i.r(t),i.d(t,{showRename:()=>r,showConfirm:()=>s,showWarning:()=>n})},70541:(e,t,i)=>{"use strict";i.d(t,{showFinancialsDialog:()=>o});var r=i(63628);let s;class n extends r.DialogRenderer{constructor(){super(...arguments),this._dialog=null,this._subscribe=e=>{this._setVisibility(e)}}show(e){this._load(e).then(e=>e.show())}hide(){var e;null===(e=this._dialog)||void 0===e||e.hide()}static getInstance(){return s||(s=new n),s}_load(e){return Promise.all([i.e(23876),i.e(26822),i.e(69756),i.e(88278),i.e(52802),i.e(94595),i.e(60700),i.e(94269),i.e(40587),i.e(13940),i.e(96271),i.e(93228),i.e(45564),i.e(68491),i.e(62602),i.e(38345),i.e(56020),i.e(73935),i.e(43424),i.e(1529),i.e(36982),i.e(27420),i.e(91050),i.e(40953),i.e(45856),i.e(71062),i.e(96663),i.e(24878)]).then(i.bind(i,10323)).then(t=>{var i,r;return null===(i=this._dialog)||void 0===i||i.hide(),null===(r=this._dialog)||void 0===r||r.visible().unsubscribe(this._subscribe),this._dialog=new t.FinancialsDialogRenderer(e),this._dialog.visible().subscribe(this._subscribe),this._dialog})}}function o(e){n.getInstance().show(e)}},42335:(e,t,i)=>{"use strict";i.d(t,{showConfirmInputsDialog:()=>l});var r=i(20220),s=i(16282),n=i(31565),o=i(27937),a=i.n(o);async function l(e,t,o,l,c="default"){let u,d=!1,h=!1,p=null;const _=e.model().model(),m=(0,n.clone)((0,s.ensureDefined)(t.defaults.inputs)),f=new(a())({inputs:m}),g=function(e,t){return"symbol"===t?e.inputs.filter(t=>t.id===e.symbolInputId()):e.inputs.filter(e=>e.confirm)}(t,c),v=()=>{u&&_.removeCustomSource(u)},S=()=>{v(),l()},y=e=>{o({inputs:e,parentSource:p}),v()};try{
const r=await Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(32795),i.e(63193),i.e(52802),i.e(61212),i.e(85597),i.e(45266),i.e(33996),i.e(94595),i.e(94269),i.e(87936),i.e(99305),i.e(90901),i.e(38968),i.e(55442),i.e(26992),i.e(96271),i.e(93228),i.e(52951),i.e(81542),i.e(98755),i.e(57373),i.e(25913),i.e(69602),i.e(76548),i.e(13410),i.e(29082),i.e(82321),i.e(33793),i.e(85551),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(36982),i.e(19894),i.e(27420),i.e(53011),i.e(9881),i.e(52616),i.e(45080),i.e(9622),i.e(27274),i.e(9394),i.e(91712),i.e(62348),i.e(12503),i.e(20356),i.e(5131),i.e(15382),i.e(18629),i.e(15623),i.e(32235),i.e(62183),i.e(53030)]).then(i.bind(i,36654)),s=await r.selectInputValuesOnChart(e,g,f,t.shortDescription);d=s.allInputsResolved,u=s.customSourceId,p=s.destPane?s.destPane.mainDataSource():null}catch(e){h=!0}h?S():d?y(f.state().inputs||{}):Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(32795),i.e(63193),i.e(52802),i.e(61212),i.e(85597),i.e(45266),i.e(33996),i.e(94595),i.e(94269),i.e(87936),i.e(99305),i.e(90901),i.e(38968),i.e(55442),i.e(26992),i.e(96271),i.e(93228),i.e(52951),i.e(81542),i.e(98755),i.e(57373),i.e(25913),i.e(69602),i.e(76548),i.e(13410),i.e(29082),i.e(82321),i.e(33793),i.e(85551),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(36982),i.e(19894),i.e(27420),i.e(53011),i.e(9881),i.e(52616),i.e(45080),i.e(9622),i.e(27274),i.e(9394),i.e(91712),i.e(62348),i.e(12503),i.e(20356),i.e(5131),i.e(15382),i.e(18629),i.e(15623),i.e(32235),i.e(62183),i.e(53030)]).then(i.bind(i,32112)).then(t=>{const i=new t.ConfirmInputsDialogRenderer(function(e){if("symbol"===e)return(0,r.t)("Add Symbol");return(0,r.t)("Confirm Inputs")}(c),g,f,c,e.model(),y,S);return i.show(),i})}},97205:(e,t,i)=>{"use strict";i.d(t,{GeneralChartPropertiesRenderer:()=>s});var r=i(63628);class s extends r.DialogRenderer{constructor(e){super(),this._dialog=null,this._subscribe=e=>{this._setVisibility(e)},this._chartWidgetCollection=e}show(){const e=this._chartWidgetCollection,t=e.activeChartWidget.value();return t.generalPropertiesDefinitions().then(r=>Promise.all([i.e(23876),i.e(26822),i.e(99459),i.e(69756),i.e(29448),i.e(88278),i.e(37610),i.e(32795),i.e(63193),i.e(52802),i.e(61212),i.e(76473),i.e(85597),i.e(43894),i.e(45266),i.e(33996),i.e(94595),i.e(94269),i.e(87936),i.e(99305),i.e(90901),i.e(38968),i.e(55442),i.e(68604),i.e(26992),i.e(96271),i.e(93228),i.e(81542),i.e(57373),i.e(25913),i.e(69602),i.e(76548),i.e(13410),i.e(15518),i.e(38954),i.e(94414),i.e(73935),i.e(43424),i.e(45867),i.e(1529),i.e(36982),i.e(19894),i.e(27420),i.e(53011),i.e(9881),i.e(52616),i.e(45080),i.e(9622),i.e(27274),i.e(9394),i.e(12503),i.e(20356),i.e(60006),i.e(5131),i.e(15382),i.e(23600),i.e(18629),i.e(20197),i.e(37078)]).then(i.bind(i,37577)).then(i=>{var s,n;const o=new i.GeneralChartPropertiesDialogRenderer({chartWidgetCollection:e,propertyPages:r,activePageId:this._activePageId,model:t.model()});return null===(s=this._dialog)||void 0===s||s.hide(),
null===(n=this._dialog)||void 0===n||n.visible().unsubscribe(this._subscribe),this._dialog=o,o.visible().subscribe(this._subscribe),o.show(),this._activePageId=void 0,o}))}hide(){var e;null===(e=this._dialog)||void 0===e||e.hide()}isVisible(){return this.visible().value()}focusOnText(){}setActivePage(e){this._activePageId=e}}},55928:(e,t,i)=>{"use strict";i.d(t,{registerSettingsSymbolListBackend:()=>v});var r=i(20220),s=i(75443),n=i(42098),o=i(1171),a=i(60531),l=i(96276),c=i.n(l);const u=new(c()),d=new(c()),h=new(c()),p=new(c()),_=new(c());var m=i(22842),f=i.n(m);class g{constructor(e=[],t=n){if(this._lists={},this._activeListSettingsKey="widgetbar.widget.watchlist",f().enabled("trading_terminal")&&(this._activeListSettingsKey+="terminal"),this._settings=t,this._settings.onSync.subscribe(this,this._updateLists),this._updateLists(),0===Object.keys(this._lists).length){const t=this._createList({title:this._pickTitle(),symbols:[...e]});this.setActive(t.id)}}destroy(){this._settings.onSync.unsubscribeAll(this)}getCustomWatchLists(){this._updateLists();const e=[];return Object.keys(this._lists).forEach(t=>{const i=this._getList(t);i&&e.push(this._toSymbolList(i))}),Promise.resolve(e)}createWatchList(e){const t=this._createList({id:e.id,title:e.name||this._pickTitle(),symbols:e.symbols||[]});return h.fire(t.id,[...t.symbols]),Promise.resolve(this._toSymbolList(t))}putWatchList(e){this._updateLists();const t=this._getList(e.id),i=null==t?void 0:t.title,r=e.name;return this.saveList({id:e.id,symbols:e.symbols,title:e.name}),void 0!==i&&i!==r&&_.fire(e.id,i,r),null!==t?u.fire(e.id):h.fire(e.id,e.symbols),Promise.resolve(e)}removeWatchList(e){const{id:t}=e;return this._settings.remove("savedwatch."+t,{forceFlush:!0}),delete this._lists[t],p.fire(t),Promise.resolve()}renameWatchList(e,t){this._updateLists();const{name:i}=e;return e.name=t,this.saveList({id:e.id,symbols:e.symbols,title:t}),_.fire(e.id,i,t),Promise.resolve(t)}replaceSymbols(e,t){const i=this._getList(e.id);return null===i||(i.symbols=[...t],this.saveList(i),u.fire(e.id)),Promise.resolve()}addSymbols(e,t){const i=this._getList(e.id);return null===i?Promise.resolve([]):(i.symbols.push(...t),this.saveList(i),u.fire(e.id),Promise.resolve([...i.symbols]))}removeSymbols(e,t){const i=this._getList(e.id);return null===i?Promise.resolve([]):(i.symbols=i.symbols.filter(e=>!t.includes(e)),this.saveList(i),u.fire(e.id),Promise.resolve([...i.symbols]))}setActive(e){return this._settings.setValue(this._activeListSettingsKey,e),d.fire(),Promise.resolve()}getActive(){const e=this._getActive();return Promise.resolve(this._toSymbolList(e))}saveList(e){const t={symbols:e.symbols,title:String(e.title)};this._settings.setJSON("savedwatch."+e.id,t,{forceFlush:!0}),this._lists[e.id]=t}_createList(e){var t;const i={id:null!==(t=e.id)&&void 0!==t?t:(0,s.randomHash)(),symbols:e.symbols,title:e.title};return this.saveList(i),i}_getList(e){if(this._updateLists(),this._lists.hasOwnProperty(e)){const t=this._lists[e];return{id:e,symbols:t.symbols.slice(),title:t.title}}return null}
_toSymbolList(e){return{type:"custom",id:e.id,name:e.title,symbols:e.symbols,shared:!1}}_updateLists(){this._lists={};this._settings.keys().forEach(e=>{const t=/^savedwatch\.(.*)$/.exec(e);if(!t)return;const i=t[1],r=this._settings.getJSON(e,null);r&&(r.symbols||(r.symbols=[]),this._lists[i]=r)})}_getActive(){const e=this._settings.getValue(this._activeListSettingsKey),[t,i]=Object.entries(this._lists)[0],r={id:t,...i};return void 0!==e&&this._getList(e)||r}_pickTitle(){this._updateLists();const e=Object.keys(this._lists).map(e=>this._lists[e].title);for(let t=1;;t++){const i=(0,r.t)("Watchlist")+(t>1?` (${t})`:"");if(-1===e.indexOf(i))return i}}}function v(e){const t=new g(e);return(0,a.registerService)(o.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE,t),()=>{(0,a.unregisterService)(o.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE)}}},62134:(e,t,i)=>{"use strict";i.d(t,{SingleSymbolList:()=>o,registerSingleSymbolListBackend:()=>a});var r=i(20220),s=i(1171),n=i(60531);class o{constructor(e=[]){this._list={id:"DEFAULT_SINGLE_WATCHLIST",type:"custom",name:(0,r.t)("Watchlist"),symbols:[...e],shared:!1}}getCustomWatchLists(){return Promise.resolve([this._list])}getSymbols(e){return Promise.resolve(this._list.symbols)}createWatchList(e){throw new Error("not implemented")}putWatchList(e){throw new Error("not implemented")}removeWatchList(e){throw new Error("not implemented")}renameWatchList(e,t){return Promise.resolve(t)}replaceSymbols(e,t){return this._list.symbols=[...t],Promise.resolve(this._list)}addSymbols(e,t){return this._list.symbols.push(...t),Promise.resolve(this._list.symbols)}removeSymbols(e,t){return this._list.symbols=this._list.symbols.filter(e=>!t.includes(e)),Promise.resolve(this._list.symbols)}setActive(e){return Promise.resolve(this._list)}getActive(){return Promise.resolve(this._list)}}function a(e){const t=new o(e);return(0,n.registerService)(s.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE,t),()=>{(0,n.unregisterService)(s.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE)}}},1171:(e,t,i)=>{"use strict";i.d(t,{SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE:()=>r});const r={id:"SymbolListRepositoryBackend"}},7434:(e,t,i)=>{"use strict";i.d(t,{initSymbolListService:()=>n});var r=i(60531);const s={id:"SymbolListService"};function n(){return Promise.all([Promise.all([i.e(45080),i.e(38676),i.e(59963),i.e(52146),i.e(807),i.e(80208),i.e(39998),i.e(38611),i.e(1026)]).then(i.bind(i,10545)),Promise.all([i.e(45080),i.e(38676),i.e(59963),i.e(52146),i.e(807),i.e(80208),i.e(39998),i.e(38611),i.e(1026)]).then(i.bind(i,94176)),Promise.all([i.e(45080),i.e(38676),i.e(59963),i.e(52146),i.e(807),i.e(80208),i.e(39998),i.e(38611),i.e(1026)]).then(i.bind(i,54820)),Promise.all([i.e(45080),i.e(38676),i.e(59963),i.e(52146),i.e(807),i.e(80208),i.e(39998),i.e(38611),i.e(1026)]).then(i.bind(i,40383))]).then(([e,t,i,n])=>{if((0,r.hasService)(s))return(0,r.service)(s);const{store:o,runner:a}=e.configureStore(),l=a.run(t.symbolListRepositorySaga);return(0,r.registerService)(s,{store:o,runner:a,actions:{addSymbols:n.addSymbolsThunk,initWidget:i.initWidget,
saveListAs:n.saveListAsThunk,createNewWatchList:n.userCreateWatchlistThunk},task:l}),(0,r.service)(s)})}},88028:(e,t,i)=>{"use strict";i.d(t,{WATCHLIST_WIDGET_ID:()=>r});const r="watchlist-widget"},54917:(e,t,i)=>{"use strict";i.d(t,{resolveLogoUrls:()=>n,getLogoUrlsHook:()=>o,removeUsdFromCryptoPairLogos:()=>a});var r=i(72777);const s=(0,r.getLogoUrlResolver)();function n(e,t=r.LogoSize.Medium){const i=e.logoid,n=e["base-currency-logoid"],o=e["currency-logoid"],a=i&&s.getSymbolLogoUrl(i,t);if(a)return[a];const l=n&&s.getSymbolLogoUrl(n,t),c=o&&s.getSymbolLogoUrl(o,t);return l&&c?[l,c]:l?[l]:c?[c]:[]}function o(e,t){let i=!1;return(r,s,o)=>{const l=r["currency-logoid"]&&r["base-currency-logoid"];if(!i&&(r.logoid||l||o)){i=!0;const s={logoid:r.logoid,"base-currency-logoid":r["base-currency-logoid"],"currency-logoid":r["currency-logoid"]},o=a({type:r.type,currency_code:r.currency_code},n(s,t));e(o)}}}function a(e,t){return"crypto"===e.type&&"USD"===e.currency_code&&2===t.length?[t[0]]:t}},27393:(e,t,i)=>{"use strict";var r;i.d(t,{ToolboxType:()=>r}),function(e){e[e.Delete=0]="Delete"}(r||(r={}))},87553:(e,t,i)=>{"use strict";i.d(t,{globalCloseDelegate:()=>s,globalCloseMenu:()=>n});var r=i(96276);const s=new(i.n(r)());function n(){s.fire()}},72408:(e,t,i)=>{"use strict";var r=i(27418),s=60103,n=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var o=60109,a=60110,l=60112;t.Suspense=60113;var c=60115,u=60116;if("function"==typeof Symbol&&Symbol.for){var d=Symbol.for;s=d("react.element"),n=d("react.portal"),t.Fragment=d("react.fragment"),t.StrictMode=d("react.strict_mode"),t.Profiler=d("react.profiler"),o=d("react.provider"),a=d("react.context"),l=d("react.forward_ref"),t.Suspense=d("react.suspense"),c=d("react.memo"),u=d("react.lazy")}var h="function"==typeof Symbol&&Symbol.iterator;function p(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function f(e,t,i){this.props=e,this.context=t,this.refs=m,this.updater=i||_}function g(){}function v(e,t,i){this.props=e,this.context=t,this.refs=m,this.updater=i||_}f.prototype.isReactComponent={},f.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(p(85));this.updater.enqueueSetState(this,e,t,"setState")},f.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=f.prototype;var S=v.prototype=new g;S.constructor=v,r(S,f.prototype),S.isPureReactComponent=!0;var y={current:null},b=Object.prototype.hasOwnProperty,w={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,i){var r,n={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),
t)b.call(t,r)&&!w.hasOwnProperty(r)&&(n[r]=t[r]);var l=arguments.length-2;if(1===l)n.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];n.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===n[r]&&(n[r]=l[r]);return{$$typeof:s,type:e,key:o,ref:a,props:n,_owner:y.current}}function C(e){return"object"==typeof e&&null!==e&&e.$$typeof===s}var T=/\/+/g;function x(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,i,r,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case s:case n:l=!0}}if(l)return o=o(l=e),e=""===r?"."+x(l,0):r,Array.isArray(o)?(i="",null!=e&&(i=e.replace(T,"$&/")+"/"),I(o,t,i,"",(function(e){return e}))):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:s,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(T,"$&/")+"/")+e)),t.push(o)),1;if(l=0,r=""===r?".":r+":",Array.isArray(e))for(var c=0;c<e.length;c++){var u=r+x(a=e[c],c);l+=I(a,t,i,u,o)}else if("function"==typeof(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e)))for(e=u.call(e),c=0;!(a=e.next()).done;)l+=I(a=a.value,t,i,u=r+x(a,c++),o);else if("object"===a)throw t=""+e,Error(p(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return l}function L(e,t,i){if(null==e)return e;var r=[],s=0;return I(e,r,"","",(function(e){return t.call(i,e,s++)})),r}function M(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var E={current:null};function A(){var e=E.current;if(null===e)throw Error(p(321));return e}var k={ReactCurrentDispatcher:E,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:y,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:L,forEach:function(e,t,i){L(e,(function(){t.apply(this,arguments)}),i)},count:function(e){var t=0;return L(e,(function(){t++})),t},toArray:function(e){return L(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error(p(143));return e}},t.Component=f,t.PureComponent=v,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k,t.cloneElement=function(e,t,i){if(null==e)throw Error(p(267,e));var n=r({},e.props),o=e.key,a=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,l=y.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)b.call(t,u)&&!w.hasOwnProperty(u)&&(n[u]=void 0===t[u]&&void 0!==c?c[u]:t[u])}var u=arguments.length-2;if(1===u)n.children=i;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];n.children=c}return{$$typeof:s,type:e.type,key:o,ref:a,props:n,_owner:l}},t.createContext=function(e,t){
return void 0===t&&(t=null),(e={$$typeof:a,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=P,t.createFactory=function(e){var t=P.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return A().useCallback(e,t)},t.useContext=function(e,t){return A().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return A().useEffect(e,t)},t.useImperativeHandle=function(e,t,i){return A().useImperativeHandle(e,t,i)},t.useLayoutEffect=function(e,t){return A().useLayoutEffect(e,t)},t.useMemo=function(e,t){return A().useMemo(e,t)},t.useReducer=function(e,t,i){return A().useReducer(e,t,i)},t.useRef=function(e){return A().useRef(e)},t.useState=function(e){return A().useState(e)},t.version="17.0.2"},67294:(e,t,i)=>{"use strict";e.exports=i(72408)},68277:e=>{"use strict";const t=[776,2359,2359,2367,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520];function i(e){if("string"!=typeof e)throw new Error("string cannot be undefined or null");const t=[];let i=0,s=0;for(;i<e.length;)s+=r(i+s,e),a(e[i+s])&&s++,n(e[i+s])&&s++,o(e[i+s])&&s++,l(e[i+s])?s++:(t.push(e.substring(i,i+s)),i+=s,s=0);return t}function r(e,t){const i=t[e];if(!function(e){return e&&u(e[0].charCodeAt(0),55296,56319)}(i)||e===t.length-1)return 1;const r=i+t[e+1];let n=t.substring(e+2,e+5);return s(r)&&s(n)||function(e){return u(c(e),127995,127999)}(n)?4:2}function s(e){return u(c(e),127462,127487)}function n(e){return"string"==typeof e&&u(e.charCodeAt(0),65024,65039)}function o(e){return"string"==typeof e&&u(e.charCodeAt(0),8400,8447)}function a(e){return"string"==typeof e&&-1!==t.indexOf(e.charCodeAt(0))}function l(e){return"string"==typeof e&&8205===e.charCodeAt(0)}function c(e){return(e.charCodeAt(0)-55296<<10)+(e.charCodeAt(1)-56320)+65536}function u(e,t,i){return e>=t&&e<=i}e.exports=i,e.exports.substr=function(e,t,r){const s=i(e);if(void 0===t)return e;if(t>=s.length)return"";const n=s.length-t;let o=t+(void 0===r?n:r);return o>t+n&&(o=void 0),s.slice(t,o).join("")}},80276:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd"><path stroke="currentColor" d="M13 22.5H5.5a2 2 0 0 1-2-2v-14a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2V14"/><path stroke="currentColor" stroke-linecap="square" d="M18.5 15.5v8m-4-4h8"/><path fill="currentColor" d="M7 8h11v1H7zm0 4h11v1H7zm0 4h5v1H7z"/></g></svg>'},35961:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor"><path d="M13.111 18.5H10.5a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1h11a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1h-8.389z"/><path d="M18.5 20v1.5a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1H8"/></g></svg>'
},12673:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path fill="currentcolor" d="m13.5 5a1 1 0 0 0 0 19 1 1 0 0 0 0-19m0 1a1 1 0 0 1 0 17 1 1 0 0 1 0-17zm2.31-.6A9.5 9.5 0 0 0 9 14.5a9.5 9.5 0 0 0 6.81 9.1l.99-.78A8.5 8.5 0 0 1 10 14.5a8.5 8.5 0 0 1 6.8-8.32"/></svg>'},5195:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7 5" width="7" height="5" fill="none"><path stroke="currentColor" stroke-width="1.2" d="M1 1.5l2.5 2 2.5-2"/></svg>'},47595:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" width="25" height="25"><circle fill="none" stroke="currentColor" stroke-width="1.5" cx="12.5" cy="12.5" r="11.75"/><path fill="currentColor" d="M11.16 18H8.78V7.28c1.52-.06 2.47-.08 2.86-.08a5 5 0 0 1 3.72 1.37 4.9 4.9 0 0 1 1.37 3.64c0 3.86-1.85 5.79-5.57 5.79zm-.48-9.06v7.32c.31.03.64.05 1 .05a2.7 2.7 0 0 0 2.26-1.05c.54-.7.82-1.67.82-2.93 0-2.3-1.07-3.44-3.2-3.44-.21 0-.5.02-.88.05z"/></svg>'},29393:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><rect width="21.5" height="21.5" fill="none" stroke="currentColor" stroke-width="1.5" rx="1.25" x=".75" y=".75"/><path fill="currentColor" d="M10.23 7.96v2.51h3.55v1.62h-3.55v3.22h4.87V17H8.33V6.27h6.85v1.7h-4.95z"/></svg>'},86350:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 25" width="24" height="25"><path fill="none" stroke="currentColor" stroke-width="1.5" d="M10.85 23.72c.4.25.9.25 1.3 0l9.5-5.82c.37-.22.6-.63.6-1.06V2c0-.69-.56-1.25-1.25-1.25H2C1.31.75.75 1.31.75 2v14.84c0 .43.23.84.6 1.06l9.5 5.82z"/><path fill="currentColor" d="M10.23 7.96v2.51h3.55v1.62h-3.55v3.22h4.87V17H8.33V6.27h6.85v1.7h-4.95z"/></svg>'},57115:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 25" width="24" height="25"><path fill="none" stroke="currentColor" stroke-width="1.5" d="M10.87 1.23c.39-.22.87-.22 1.26 0l9.5 5.52c.38.23.62.64.62 1.08V23c0 .69-.56 1.25-1.25 1.25H2c-.69 0-1.25-.56-1.25-1.25V7.83c0-.44.24-.85.62-1.08l9.5-5.52z"/><path fill="currentColor" d="M10.23 9.96v2.51h3.55v1.62h-3.55v3.22h4.87V19H8.33V8.27h6.85v1.7h-4.95z"/></svg>'},4402:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" width="25" height="25"><circle fill="none" stroke="currentColor" stroke-width="1.5" cx="12.5" cy="12.5" r="11.75"/><path fill="currentColor" d="M9.25 17.4l.7-1.7c.75.53 1.5.8 2.22.8 1.12 0 1.68-.4 1.68-1.18 0-.37-.13-.72-.4-1.05-.26-.33-.8-.7-1.63-1.11a8.18 8.18 0 0 1-1.66-1.02 2.82 2.82 0 0 1-.89-2.17c0-.83.3-1.52.9-2.06.62-.55 1.4-.82 2.35-.82 1.24 0 2.15.23 2.73.7l-.57 1.63a3.58 3.58 0 0 0-2.12-.71c-.44 0-.78.11-1.03.35a1.2 1.2 0 0 0-.36.9c0 .61.69 1.25 2.05 1.92.72.35 1.23.67 1.55.97.32.3.56.64.73 1.03.16.4.24.83.24 1.31 0 .87-.34 1.59-1.03 2.15a4.2 4.2 0 0 1-2.75.84c-1 0-1.9-.26-2.71-.77z"/></svg>'},70707:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M17.5 7H17v6h-3v-3H9v6H5v6h17V7h-4.5zm.5 14h3V8h-3v13zm-1 0v-7h-3v7h3zm-4-7.5V21h-3V11h3v2.5zM9 21v-4H6v4h3z"/></svg>'},51264:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" transform="translate(4 5)"><circle stroke="currentColor" cx="9.5" cy="9.5" r="9"/><path stroke="currentColor" d="M7 14.5h2.5v-5H7"/><path stroke="currentColor" stroke-linecap="square" d="M9.5 14.5h2"/><path fill="currentColor" d="M9.5 7a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"/></g></svg>'},4821:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor" transform="translate(6 3)"><rect width="15" height="12" rx="2" x=".5" y="8.5"/><path stroke-linecap="round" stroke-width="2" d="M8 15v2"/><path d="M11.5 4a3.5 3.5 0 0 0-7 0v4.5"/></g></svg>'},8835:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="none"><path d="M3.00004 7.50008C3.00004 6.25729 3.50318 5.13298 4.31807 4.31809L3.61097 3.61098C2.6162 4.60574 2.00004 5.98143 2.00004 7.50008H3.00004ZM4.31807 4.31809C5.13296 3.50321 6.25727 3.00008 7.50004 3.00008V2.00008C5.98141 2.00008 4.60572 2.61623 3.61097 3.61098L4.31807 4.31809ZM4.31808 3.61098L2.55033 1.84323L1.84322 2.55033L3.61097 4.31809L4.31808 3.61098ZM7.50004 3.00008C8.74283 3.00008 9.86715 3.50321 10.682 4.31811L11.3891 3.611C10.3944 2.61624 9.01869 2.00008 7.50004 2.00008V3.00008ZM10.682 4.31811C11.4969 5.13299 12 6.2573 12 7.50008H13C13 5.98144 12.3839 4.60576 11.3891 3.611L10.682 4.31811ZM11.3891 4.31811L13.1569 2.55033L12.4498 1.84322L10.682 3.611L11.3891 4.31811ZM12 7.50008C12 8.74285 11.4969 9.86716 10.682 10.682L11.3891 11.3892C12.3839 10.3944 13 9.01872 13 7.50008H12ZM10.682 10.682C9.86715 11.4969 8.74283 12.0001 7.50004 12.0001V13.0001C9.01869 13.0001 10.3944 12.3839 11.3891 11.3892L10.682 10.682ZM10.682 11.3892L12.4498 13.1569L13.1569 12.4498L11.3891 10.682L10.682 11.3892ZM7.50004 12.0001C6.25727 12.0001 5.13296 11.497 4.31807 10.6821L3.61097 11.3892C4.60572 12.3839 5.98141 13.0001 7.50004 13.0001V12.0001ZM4.31807 10.6821C3.50318 9.86718 3.00004 8.74286 3.00004 7.50008H2.00004C2.00004 9.01873 2.6162 10.3944 3.61097 11.3892L4.31807 10.6821ZM2.55033 13.1569L4.31808 11.3892L3.61097 10.6821L1.84322 12.4498L2.55033 13.1569ZM8.00004 2.50007L8 -8.77353e-06L7 8.77353e-06L7.00004 2.50009L8.00004 2.50007ZM12.5001 8.00008L15 8L15 7L12.5 7.00008L12.5001 8.00008ZM2.50006 7.00008L1.564e-05 7L-1.564e-05 8L2.50003 8.00008L2.50006 7.00008ZM7.00004 12.5001L7 15L8 15L8.00004 12.5001L7.00004 12.5001Z"/></svg>'},77624:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor"><path d="M6.5 15A8.5 8.5 0 1 0 15 6.5H8.5"/><path d="M12 10L8.5 6.5 12 3"/></g></svg>'},6162:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor" transform="translate(3 6)"><path d="M.964 8C3 4 6.679.5 11 .5 15.32.5 19 4 21.036 8 19 12 15.32 15.5 11 15.5 6.679 15.5 3 12 .964 8z"/><circle cx="11" cy="8" r="3.5"/></g></svg>'},75394:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><rect width="10" height="4" fill="currentColor" rx="2" x="4" y="7"/></svg>'},9658:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><circle fill="currentColor" cx="9" cy="9" r="5"/></svg>'},5161:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" fill="none"><circle fill="currentColor" cx="9" cy="9" r="4"/></svg>'},98822:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M9.3 9l.9-4.53a1.23 1.23 0 1 0-2.4 0L8.7 9l-.9 4.53a1.23 1.23 0 1 0 2.4 0L9.3 9z"/><path fill="currentColor" d="M9.15 9.26l4.38-1.48a1.23 1.23 0 1 0-1.21-2.09L8.85 8.74l-4.38 1.48a1.23 1.23 0 1 0 1.21 2.09l3.47-3.05z"/><path fill="currentColor" d="M9.15 8.74L5.68 5.69a1.23 1.23 0 1 0-1.2 2.09l4.37 1.48 3.47 3.05a1.23 1.23 0 1 0 1.2-2.09L9.16 8.74z"/></svg>'},54276:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M13.29 4.8h-.09a4.2 4.2 0 1 0 .09 8.4 6 6 0 1 1 0-8.4z"/></svg>'},34632:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M12.57 5.5h-.07a3.5 3.5 0 1 0 .07 7A4.98 4.98 0 0 1 4 9a5 5 0 0 1 8.57-3.5z"/></svg>'},19406:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M12.58 12.1A3.86 3.86 0 0 0 9 6.75a3.87 3.87 0 0 0-3.58 5.33 7.74 7.74 0 0 1 7.16 0zM3.64 9.93l-2.3-.62.37-1.38 2.3.62-.37 1.38zM6.1 6.07L5.07 3.92l1.3-.6 1 2.15-1.29.6zM10.62 5.47l1-2.16 1.3.6-1.01 2.16-1.3-.6zM13.99 8.55l2.3-.62.36 1.38-2.3.62L14 8.55z"/></svg>'},80910:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M12.22 11.78A3.47 3.47 0 0 0 9 6.98a3.48 3.48 0 0 0-3.22 4.8 6.97 6.97 0 0 1 6.44 0zM4.18 9.83L2.1 9.28l.33-1.24 2.07.55-.33 1.24zM6.38 6.36l-.9-1.94 1.16-.54.9 1.94-1.16.54zM10.46 5.82l.9-1.94 1.16.54-.9 1.94-1.16-.54zM13.49 8.6l2.07-.56.33 1.24-2.07.55-.33-1.24z"/></svg>'},18301:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor"><path stroke-linecap="square" d="M21.5 14.5a8 8 0 1 0-8 8m6-6v8m-4-4h8"/><path d="M10 14.5h3.5V9m-3.277-1.76a3 3 0 1 0-3.993 3.979m14.565-.012a3 3 0 1 0-4.019-3.966"/></g></svg>'},61084:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor"><path stroke-linecap="square" d="M11.5 21.5v-7m3 7v-5m3 5v-3m-9 3v-5"/><path d="M5.5 22v-3"/><path stroke-linecap="square" d="M5.5 13.5l4.297-4.297a2.406 2.406 0 0 1 3.406 0l2.594 2.594c.94.94 2.463.943 3.406 0L23.5 7.5M22.5 12.5v6m-3-3h6"/></g></svg>'},66679:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor" transform="translate(3 4)"><circle cx="10.5" cy="10.5" r="8"/><path d="M7 10.5h3.5V5M7.223 3.24A3 3 0 1 0 3.23 7.218m14.565-.011a3 3 0 1 0-4.019-3.966"/></g></svg>'},8916:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="square" d="M6.145 11.968L14 5.5l7.855 6.468a.3.3 0 0 1-.191.532H6.336a.3.3 0 0 1-.19-.532zm0 4.064L14 22.5l7.855-6.468a.3.3 0 0 0-.191-.532H6.336a.3.3 0 0 0-.19.532z"/></svg>'},74553:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" transform="translate(4 5)"><path fill="currentColor" d="M3 1h1v13.5H3z"/><circle stroke="currentColor" cx="3.5" cy="16.5" r="2"/><path fill="currentColor" d="M5.5 16H18v1H5.5z"/><path stroke="currentColor" d="M0 4L3.5.5 7 4m8 9l3.5 3.5L15 20"/></g></svg>'},99673:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor" transform="translate(4 4)"><path d="M.5 10.992c0 .287.226.508.505.508H2.65c.19.93.55 1.82 1.09 2.63L2.577 15.3a.5.5 0 0 0-.007.71l1.42 1.42a.5.5 0 0 0 .71-.007l1.17-1.163c.81.54 1.71.9 2.63 1.09v1.645c0 .284.227.505.508.505h1.984c.28 0 .508-.221.508-.505V17.35a7.46 7.46 0 0 0 2.63-1.09l1.17 1.163a.5.5 0 0 0 .71.007l1.42-1.42a.5.5 0 0 0-.007-.71l-1.163-1.17c.54-.81.9-1.7 1.09-2.63h1.645a.502.502 0 0 0 .505-.508V9.008a.503.503 0 0 0-.505-.508H17.35c-.19-.93-.55-1.82-1.09-2.63l1.163-1.17a.5.5 0 0 0 .007-.71l-1.42-1.42a.5.5 0 0 0-.71.007L14.13 3.74a7.46 7.46 0 0 0-2.63-1.09V1.005A.504.504 0 0 0 10.992.5H9.008a.504.504 0 0 0-.508.505V2.65c-.92.19-1.82.55-2.63 1.09L4.7 2.577a.5.5 0 0 0-.71-.007L2.57 3.99a.5.5 0 0 0 .007.71L3.74 5.87c-.54.81-.9 1.7-1.09 2.63H1.005a.503.503 0 0 0-.505.508v1.984z"/><circle cx="10" cy="10" r="2.5"/></g></svg>'},76468:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M4 15h8.5v-1h-8.5zM16.5 15h8.5v-1h-8.5z"/><path d="M14.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"/></g></svg>'},54500:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M11.5 6a.5.5 0 0 0-.5.5V8h6V6.5a.5.5 0 0 0-.5-.5h-5zM18 8V6.5c0-.83-.67-1.5-1.5-1.5h-5c-.83 0-1.5.67-1.5 1.5V8H5.5a.5.5 0 0 0 0 1H7v12.5A2.5 2.5 0 0 0 9.5 24h9a2.5 2.5 0 0 0 2.5-2.5V9h1.5a.5.5 0 0 0 0-1H18zm2 1H8v12.5c0 .83.67 1.5 1.5 1.5h9c.83 0 1.5-.67 1.5-1.5V9zm-8.5 3c.28 0 .5.22.5.5v7a.5.5 0 0 1-1 0v-7c0-.28.22-.5.5-.5zm5.5.5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z"/></svg>'},96136:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path fill="currentColor" d="M18.15 7.02A9.05 9.05 0 0014 6c-3.45 0-6.08 2-7.8 3.92a18.18 18.18 0 00-2.64 3.84v.02h-.01L4 14l-.45-.21-.1.21.1.21L4 14l-.45.21.01.03a5.85 5.85 0 00.16.32c.11.2.28.51.5.87a18.18 18.18 0 002.4 3.12l.71-.71A17.18 17.18 0 014.56 14a10.05 10.05 0 01.52-.91c.41-.69 1.04-1.6 1.85-2.5C8.58 8.75 10.95 7 14 7a8 8 0 013.4.77l.75-.75zm-3.11 3.12a4 4 0 00-4.9 4.9l.86-.87V14a3 3 0 013.17-3l.87-.86zm1.96 3.7l.86-.88a4 4 0 01-4.9 4.9l.87-.86A3 3 0 0017 13.83zm-6.4 6.4A8 8 0 0014 21c3.05 0 5.42-1.76 7.07-3.58A17.18 17.18 0 0023.44 14a9.47 9.47 0 00-.52-.91 17.18 17.18 0 00-2.25-2.93l.7-.7a18.18 18.18 0 013.06 4.3l.02.02L24 14l.45.21-.01.03a7.03 7.03 0 01-.16.32c-.11.2-.28.51-.5.87-.44.72-1.1 1.69-1.97 2.65C20.08 20.01 17.45 22 14 22c-1.55 0-2.94-.4-4.15-1.02l.75-.75zM24 14l.45-.21.1.21-.1.21L24 14zM22.2 6.5L6.5 22.2l-.7-.7L21.5 5.8l.7.7z"/></svg>'},51146:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor" transform="translate(6 4)"><rect width="15" height="12" rx="2" x=".5" y="7.5"/><path stroke-linecap="round" stroke-width="2" d="M8 14v2"/><path d="M11.5 7.5V4a3.5 3.5 0 0 0-7 0v3.5"/></g></svg>'},63679:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M13.39 3.84a1 1 0 0 1 1.22 0l8.19 6.37a1 1 0 0 1 0 1.58l-8.19 6.37a1 1 0 0 1-1.22 0L5.2 11.79a1 1 0 0 1 0-1.58l8.19-6.37zm.61.8L5.81 11 14 17.37 22.19 11 14 4.63zM5.3 13.6l8.7 6.76 8.7-6.76.6.78-8.69 6.77a1 1 0 0 1-1.22 0l-8.7-6.77.62-.78zm8.09 10.55l-8.7-6.77.62-.78L14 23.37l8.7-6.76.6.78-8.69 6.77a1 1 0 0 1-1.22 0z"/></svg>'},5243:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 28" width="36" height="28"><path fill="currentColor" d="M14 22H7V11H0V4h14v18zM28 22h-8l7.5-18h8L28 22z"/><circle fill="currentColor" cx="20" cy="8" r="4"/></svg>'},35447:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M13.5 24a9.5 9.5 0 1 0 0-19 9.5 9.5 0 0 0 0 19zm0 1a10.5 10.5 0 1 0 0-21 10.5 10.5 0 0 0 0 21zM11 10h1v9h-1v-9zm5 0h-1v9h1v-9z"/></svg>'},66715:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M23 14.5a9.5 9.5 0 1 1-19 0 9.5 9.5 0 0 1 19 0zm1 0a10.5 10.5 0 1 1-21 0 10.5 10.5 0 0 1 21 0zM11.3 9.6l-.8-.6v11l.8-.6 6-4.5.53-.4-.53-.4-6-4.5zm4.87 4.9L11.5 18v-7l4.67 3.5z"/></svg>'},18972:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none"><path stroke="currentColor" d="M5.5 16.5c1 3 7 7 11 7 2-4 2-8.5 2-8.5s-1-3.5-2-4-4.5.5-4.5.5-3 3.5-6.5 5z"/><path stroke="currentColor" d="M15.5 11l3-6s.5-1 1.5-.5.5 1.5.5 1.5l-3 6M12 11.5l6.5 3.5M7.5 19c2-.5 4-2.5 4-2.5m0 5.5c2-1 3-3.5 3-3.5"/></svg>'},45630:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><rect width="18" height="18" fill="#EC407A" rx="9" opacity=".15"/><path fill="#C2185B" d="M13.4 5.9c-.41 1.62-1.16 2.43-2.25 2.43-.52 0-1.25-.15-2.2-.45-.93-.3-1.58-.45-1.96-.45-.55 0-.98.3-1.27.9H4.66c.1-.67.36-1.24.76-1.71.4-.48.86-.72 1.4-.72.56 0 1.31.16 2.27.46.95.3 1.62.45 2.01.45.64 0 1.06-.3 1.27-.9h1.03zm0 3.87c-.41 1.62-1.16 2.43-2.25 2.43-.52 0-1.25-.15-2.2-.45-.93-.3-1.58-.46-1.96-.46-.55 0-.98.3-1.27.9H4.66c.1-.67.36-1.24.76-1.7.4-.48.86-.72 1.4-.72.56 0 1.31.15 2.27.46.95.3 1.62.44 2.01.44.64 0 1.06-.3 1.27-.9h1.03z"/></svg>'},36053:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 108 108" width="108" height="108"><path fill="#2962FF" stroke="#2962FF" stroke-linejoin="round" stroke-width="2" d="m57.29 54a15.43 15.43 0 1 1 0-30.86 15.43 15.43 0 0 1 0 30.86zm5.06 10.3C66.2 64.3 83 69.74 83 85.5v3.47H31.57V85.9a21.6 21.6 0 0 1 21.6-21.6l9.18.02z"/><path fill="#4a4a4a" d="m48.71 50.86a17.43 17.43 0 1 1 0-34.86 17.43 17.43 0 0 1 0 34.86zm0-4a13.43 13.43 0 1 0 0-26.86 13.43 13.43 0 0 0 0 26.86zM25 81.83v-1.09a19.6 19.6 0 0 1 19.6-19.6 5627.07 5627.07 0 0 1 9.09.02 2 2 0 0 0 .17-4l-4.67-.01H44.6A23.6 23.6 0 0 0 21 80.74v3.08c0 1.1.9 2 2 2h51.43a2 2 0 1 0 0-4H25zM64.14 70h20.57a2 2 0 1 0 0-4H64.14a2 2 0 1 0 0 4z"/></svg>'},61697:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 11" width="22" height="11"><path fill="#2962FF" d="M5 0H0v4h5v7h4V0H5zm7 4a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm5 7h-5l4.5-11h4.99L17 11z"/></svg>'},45623:(e,t,i)=>{"use strict";i.d(t,{default:()=>r});const r=function(){var e={base:"https://twemoji.maxcdn.com/v/13.0.1/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:function(e){var t="string"==typeof e?parseInt(e,16):e;if(t<65536)return a(t);return a(55296+((t-=65536)>>10),56320+(1023&t))},toCodePoint:f},onerror:function(){this.parentNode&&this.parentNode.replaceChild(l(this.alt,!1),this)},parse:function(t,i){i&&"function"!=typeof i||(i={callback:i});return("string"==typeof t?h:d)(t,{callback:i.callback||c,attributes:"function"==typeof i.attributes?i.attributes:_,base:"string"==typeof i.base?i.base:e.base,ext:i.ext||e.ext,size:i.folder||(r=i.size||e.size,"number"==typeof r?r+"x"+r:r),className:i.className||e.className,onerror:i.onerror||e.onerror});var r},replace:m,
test:function(e){i.lastIndex=0;var t=i.test(e);return i.lastIndex=0,t}},t={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"
},i=/(?:\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[©®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udeeb\udeec\udef4-\udefc\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78\udd7a-\uddb4\uddb7\uddba\uddbc-\uddcb\uddd0\uddde-\uddff\ude70-\ude74\ude78-\ude7a\ude80-\ude86\ude90-\udea8\udeb0-\udeb6\udec0-\udec2\uded0-\uded6]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,r=/\uFE0F/g,s=String.fromCharCode(8205),n=/[&<>'"]/g,o=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,a=String.fromCharCode
;return e;function l(e,t){return document.createTextNode(t?e.replace(r,""):e)}function c(e,t){return"".concat(t.base,t.size,"/",e,t.ext)}function u(e){return f(e.indexOf(s)<0?e.replace(r,""):e)}function d(e,t){for(var r,s,n,a,c,d,h,p,_,m,f,g,v,S=function e(t,i){for(var r,s,n=t.childNodes,a=n.length;a--;)3===(s=(r=n[a]).nodeType)?i.push(r):1!==s||"ownerSVGElement"in r||o.test(r.nodeName.toLowerCase())||e(r,i);return i}(e,[]),y=S.length;y--;){for(n=!1,a=document.createDocumentFragment(),d=(c=S[y]).nodeValue,p=0;h=i.exec(d);){if((_=h.index)!==p&&a.appendChild(l(d.slice(p,_),!0)),g=u(f=h[0]),p=_+f.length,v=t.callback(g,t),g&&v){for(s in(m=new Image).onerror=t.onerror,m.setAttribute("draggable","false"),r=t.attributes(f,g))r.hasOwnProperty(s)&&0!==s.indexOf("on")&&!m.hasAttribute(s)&&m.setAttribute(s,r[s]);m.className=t.className,m.alt=f,m.src=v,n=!0,a.appendChild(m)}m||a.appendChild(l(f,!1)),m=null}n&&(p<d.length&&a.appendChild(l(d.slice(p),!0)),c.parentNode.replaceChild(a,c))}return e}function h(e,t){return m(e,(function(e){var i,r,s=e,o=u(e),a=t.callback(o,t);if(o&&a){for(r in s="<img ".concat('class="',t.className,'" ','draggable="false" ','alt="',e,'"',' src="',a,'"'),i=t.attributes(e,o))i.hasOwnProperty(r)&&0!==r.indexOf("on")&&-1===s.indexOf(" "+r+"=")&&(s=s.concat(" ",r,'="',i[r].replace(n,p),'"'));s=s.concat("/>")}return s}))}function p(e){return t[e]}function _(){return null}function m(e,t){return String(e).replace(i,t)}function f(e,t){for(var i=[],r=0,s=0,n=0;n<e.length;)r=e.charCodeAt(n++),s?(i.push((65536+(s-55296<<10)+(r-56320)).toString(16)),s=0):55296<=r&&r<=56319?s=r:i.push(r.toString(16));return i.join(t||"-")}}()},13469:function(e,t){var i;(function(){var r=this,s=r._,n=Array.prototype,o=Object.prototype,a=Function.prototype,l=n.push,c=n.slice,u=o.toString,d=o.hasOwnProperty,h=Array.isArray,p=Object.keys,_=a.bind,m=Object.create,f=function(){},g=function(e){return e instanceof g?e:this instanceof g?void(this._wrapped=e):new g(e)};e.exports&&(t=e.exports=g),t._=g,g.VERSION="1.8.3";var v=function(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,r){return e.call(t,i,r)};case 3:return function(i,r,s){return e.call(t,i,r,s)};case 4:return function(i,r,s,n){return e.call(t,i,r,s,n)}}return function(){return e.apply(t,arguments)}},S=function(e,t,i){return null==e?g.identity:g.isFunction(e)?v(e,t,i):g.isObject(e)?g.matcher(e):g.property(e)};g.iteratee=function(e,t){return S(e,t,1/0)};var y=function(e,t){return function(i){var r=arguments.length;if(r<2||null==i)return i;for(var s=1;s<r;s++)for(var n=arguments[s],o=e(n),a=o.length,l=0;l<a;l++){var c=o[l];t&&void 0!==i[c]||(i[c]=n[c])}return i}},b=function(e){if(!g.isObject(e))return{};if(m)return m(e);f.prototype=e;var t=new f;return f.prototype=null,t},w=function(e){return function(t){return null==t?void 0:t[e]}},P=Math.pow(2,53)-1,C=w("length"),T=function(e){var t=C(e);return"number"==typeof t&&t>=0&&t<=P};function x(e){function t(t,i,r,s,n,o){for(;n>=0&&n<o;n+=e){var a=s?s[n]:n
;r=i(r,t[a],a,t)}return r}return function(i,r,s,n){r=v(r,n,4);var o=!T(i)&&g.keys(i),a=(o||i).length,l=e>0?0:a-1;return arguments.length<3&&(s=i[o?o[l]:l],l+=e),t(i,r,s,o,l,a)}}g.each=g.forEach=function(e,t,i){var r,s;if(t=v(t,i),T(e))for(r=0,s=e.length;r<s;r++)t(e[r],r,e);else{var n=g.keys(e);for(r=0,s=n.length;r<s;r++)t(e[n[r]],n[r],e)}return e},g.map=g.collect=function(e,t,i){t=S(t,i);for(var r=!T(e)&&g.keys(e),s=(r||e).length,n=Array(s),o=0;o<s;o++){var a=r?r[o]:o;n[o]=t(e[a],a,e)}return n},g.reduce=g.foldl=g.inject=x(1),g.reduceRight=g.foldr=x(-1),g.find=g.detect=function(e,t,i){var r;if(void 0!==(r=T(e)?g.findIndex(e,t,i):g.findKey(e,t,i))&&-1!==r)return e[r]},g.filter=g.select=function(e,t,i){var r=[];return t=S(t,i),g.each(e,(function(e,i,s){t(e,i,s)&&r.push(e)})),r},g.reject=function(e,t,i){return g.filter(e,g.negate(S(t)),i)},g.every=g.all=function(e,t,i){t=S(t,i);for(var r=!T(e)&&g.keys(e),s=(r||e).length,n=0;n<s;n++){var o=r?r[n]:n;if(!t(e[o],o,e))return!1}return!0},g.some=g.any=function(e,t,i){t=S(t,i);for(var r=!T(e)&&g.keys(e),s=(r||e).length,n=0;n<s;n++){var o=r?r[n]:n;if(t(e[o],o,e))return!0}return!1},g.contains=g.includes=g.include=function(e,t,i,r){return T(e)||(e=g.values(e)),("number"!=typeof i||r)&&(i=0),g.indexOf(e,t,i)>=0},g.invoke=function(e,t){var i=c.call(arguments,2),r=g.isFunction(t);return g.map(e,(function(e){var s=r?t:e[t];return null==s?s:s.apply(e,i)}))},g.pluck=function(e,t){return g.map(e,g.property(t))},g.where=function(e,t){return g.filter(e,g.matcher(t))},g.findWhere=function(e,t){return g.find(e,g.matcher(t))},g.max=function(e,t,i){var r,s,n=-1/0,o=-1/0;if(null==t&&null!=e)for(var a=0,l=(e=T(e)?e:g.values(e)).length;a<l;a++)(r=e[a])>n&&(n=r);else t=S(t,i),g.each(e,(function(e,i,r){((s=t(e,i,r))>o||s===-1/0&&n===-1/0)&&(n=e,o=s)}));return n},g.min=function(e,t,i){var r,s,n=1/0,o=1/0;if(null==t&&null!=e)for(var a=0,l=(e=T(e)?e:g.values(e)).length;a<l;a++)(r=e[a])<n&&(n=r);else t=S(t,i),g.each(e,(function(e,i,r){((s=t(e,i,r))<o||s===1/0&&n===1/0)&&(n=e,o=s)}));return n},g.shuffle=function(e){for(var t,i=T(e)?e:g.values(e),r=i.length,s=Array(r),n=0;n<r;n++)(t=g.random(0,n))!==n&&(s[n]=s[t]),s[t]=i[n];return s},g.sample=function(e,t,i){return null==t||i?(T(e)||(e=g.values(e)),e[g.random(e.length-1)]):g.shuffle(e).slice(0,Math.max(0,t))},g.sortBy=function(e,t,i){return t=S(t,i),g.pluck(g.map(e,(function(e,i,r){return{value:e,index:i,criteria:t(e,i,r)}})).sort((function(e,t){var i=e.criteria,r=t.criteria;if(i!==r){if(i>r||void 0===i)return 1;if(i<r||void 0===r)return-1}return e.index-t.index})),"value")};var I=function(e){return function(t,i,r){var s={};return i=S(i,r),g.each(t,(function(r,n){var o=i(r,n,t);e(s,r,o)})),s}};g.groupBy=I((function(e,t,i){g.has(e,i)?e[i].push(t):e[i]=[t]})),g.indexBy=I((function(e,t,i){e[i]=t})),g.countBy=I((function(e,t,i){g.has(e,i)?e[i]++:e[i]=1})),g.toArray=function(e){return e?g.isArray(e)?c.call(e):T(e)?g.map(e,g.identity):g.values(e):[]},g.size=function(e){return null==e?0:T(e)?e.length:g.keys(e).length},g.partition=function(e,t,i){t=S(t,i)
;var r=[],s=[];return g.each(e,(function(e,i,n){(t(e,i,n)?r:s).push(e)})),[r,s]},g.first=g.head=g.take=function(e,t,i){if(null!=e)return null==t||i?e[0]:g.initial(e,e.length-t)},g.initial=function(e,t,i){return c.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))},g.last=function(e,t,i){if(null!=e)return null==t||i?e[e.length-1]:g.rest(e,Math.max(0,e.length-t))},g.rest=g.tail=g.drop=function(e,t,i){return c.call(e,null==t||i?1:t)},g.compact=function(e){return g.filter(e,g.identity)};var L=function(e,t,i,r){for(var s=[],n=0,o=r||0,a=C(e);o<a;o++){var l=e[o];if(T(l)&&(g.isArray(l)||g.isArguments(l))){t||(l=L(l,t,i));var c=0,u=l.length;for(s.length+=u;c<u;)s[n++]=l[c++]}else i||(s[n++]=l)}return s};function M(e){return function(t,i,r){i=S(i,r);for(var s=C(t),n=e>0?0:s-1;n>=0&&n<s;n+=e)if(i(t[n],n,t))return n;return-1}}function E(e,t,i){return function(r,s,n){var o=0,a=C(r);if("number"==typeof n)e>0?o=n>=0?n:Math.max(n+a,o):a=n>=0?Math.min(n+1,a):n+a+1;else if(i&&n&&a)return r[n=i(r,s)]===s?n:-1;if(s!=s)return(n=t(c.call(r,o,a),g.isNaN))>=0?n+o:-1;for(n=e>0?o:a-1;n>=0&&n<a;n+=e)if(r[n]===s)return n;return-1}}g.flatten=function(e,t){return L(e,t,!1)},g.without=function(e){return g.difference(e,c.call(arguments,1))},g.uniq=g.unique=function(e,t,i,r){g.isBoolean(t)||(r=i,i=t,t=!1),null!=i&&(i=S(i,r));for(var s=[],n=[],o=0,a=C(e);o<a;o++){var l=e[o],c=i?i(l,o,e):l;t?(o&&n===c||s.push(l),n=c):i?g.contains(n,c)||(n.push(c),s.push(l)):g.contains(s,l)||s.push(l)}return s},g.union=function(){return g.uniq(L(arguments,!0,!0))},g.intersection=function(e){for(var t=[],i=arguments.length,r=0,s=C(e);r<s;r++){var n=e[r];if(!g.contains(t,n)){for(var o=1;o<i&&g.contains(arguments[o],n);o++);o===i&&t.push(n)}}return t},g.difference=function(e){var t=L(arguments,!0,!0,1);return g.filter(e,(function(e){return!g.contains(t,e)}))},g.zip=function(){return g.unzip(arguments)},g.unzip=function(e){for(var t=e&&g.max(e,C).length||0,i=Array(t),r=0;r<t;r++)i[r]=g.pluck(e,r);return i},g.object=function(e,t){for(var i={},r=0,s=C(e);r<s;r++)t?i[e[r]]=t[r]:i[e[r][0]]=e[r][1];return i},g.findIndex=M(1),g.findLastIndex=M(-1),g.sortedIndex=function(e,t,i,r){for(var s=(i=S(i,r,1))(t),n=0,o=C(e);n<o;){var a=Math.floor((n+o)/2);i(e[a])<s?n=a+1:o=a}return n},g.indexOf=E(1,g.findIndex,g.sortedIndex),g.lastIndexOf=E(-1,g.findLastIndex),g.range=function(e,t,i){null==t&&(t=e||0,e=0),i=i||1;for(var r=Math.max(Math.ceil((t-e)/i),0),s=Array(r),n=0;n<r;n++,e+=i)s[n]=e;return s};var A=function(e,t,i,r,s){if(!(r instanceof t))return e.apply(i,s);var n=b(e.prototype),o=e.apply(n,s);return g.isObject(o)?o:n};g.bind=function(e,t){if(_&&e.bind===_)return _.apply(e,c.call(arguments,1));if(!g.isFunction(e))throw new TypeError("Bind must be called on a function");var i=c.call(arguments,2),r=function(){return A(e,r,t,this,i.concat(c.call(arguments)))};return r},g.partial=function(e){var t=c.call(arguments,1),i=function(){for(var r=0,s=t.length,n=Array(s),o=0;o<s;o++)n[o]=t[o]===g?arguments[r++]:t[o];for(;r<arguments.length;)n.push(arguments[r++]);return A(e,i,this,this,n)}
;return i},g.bindAll=function(e){var t,i,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(t=1;t<r;t++)e[i=arguments[t]]=g.bind(e[i],e);return e},g.memoize=function(e,t){var i=function(r){var s=i.cache,n=""+(t?t.apply(this,arguments):r);return g.has(s,n)||(s[n]=e.apply(this,arguments)),s[n]};return i.cache={},i},g.delay=function(e,t){var i=c.call(arguments,2);return setTimeout((function(){return e.apply(null,i)}),t)},g.defer=g.partial(g.delay,g,1),g.throttle=function(e,t,i){var r,s,n,o=null,a=0;i||(i={});var l=function(){a=!1===i.leading?0:g.now(),o=null,n=e.apply(r,s),o||(r=s=null)};return function(){var c=g.now();a||!1!==i.leading||(a=c);var u=t-(c-a);return r=this,s=arguments,u<=0||u>t?(o&&(clearTimeout(o),o=null),a=c,n=e.apply(r,s),o||(r=s=null)):o||!1===i.trailing||(o=setTimeout(l,u)),n}},g.debounce=function(e,t,i){var r,s,n,o,a,l=function(){var c=g.now()-o;c<t&&c>=0?r=setTimeout(l,t-c):(r=null,i||(a=e.apply(n,s),r||(n=s=null)))};return function(){n=this,s=arguments,o=g.now();var c=i&&!r;return r||(r=setTimeout(l,t)),c&&(a=e.apply(n,s),n=s=null),a}},g.wrap=function(e,t){return g.partial(t,e)},g.negate=function(e){return function(){return!e.apply(this,arguments)}},g.compose=function(){var e=arguments,t=e.length-1;return function(){for(var i=t,r=e[t].apply(this,arguments);i--;)r=e[i].call(this,r);return r}},g.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},g.before=function(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=null),i}},g.once=g.partial(g.before,2);var k=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function R(e,t){var i=D.length,r=e.constructor,s=g.isFunction(r)&&r.prototype||o,n="constructor";for(g.has(e,n)&&!g.contains(t,n)&&t.push(n);i--;)(n=D[i])in e&&e[n]!==s[n]&&!g.contains(t,n)&&t.push(n)}g.keys=function(e){if(!g.isObject(e))return[];if(p)return p(e);var t=[];for(var i in e)g.has(e,i)&&t.push(i);return k&&R(e,t),t},g.allKeys=function(e){if(!g.isObject(e))return[];var t=[];for(var i in e)t.push(i);return k&&R(e,t),t},g.values=function(e){for(var t=g.keys(e),i=t.length,r=Array(i),s=0;s<i;s++)r[s]=e[t[s]];return r},g.mapObject=function(e,t,i){t=S(t,i);for(var r,s=g.keys(e),n=s.length,o={},a=0;a<n;a++)o[r=s[a]]=t(e[r],r,e);return o},g.pairs=function(e){for(var t=g.keys(e),i=t.length,r=Array(i),s=0;s<i;s++)r[s]=[t[s],e[t[s]]];return r},g.invert=function(e){for(var t={},i=g.keys(e),r=0,s=i.length;r<s;r++)t[e[i[r]]]=i[r];return t},g.functions=g.methods=function(e){var t=[];for(var i in e)g.isFunction(e[i])&&t.push(i);return t.sort()},g.extend=y(g.allKeys),g.extendOwn=g.assign=y(g.keys),g.findKey=function(e,t,i){t=S(t,i);for(var r,s=g.keys(e),n=0,o=s.length;n<o;n++)if(t(e[r=s[n]],r,e))return r},g.pick=function(e,t,i){var r,s,n={},o=e;if(null==o)return n;g.isFunction(t)?(s=g.allKeys(o),r=v(t,i)):(s=L(arguments,!1,!1,1),r=function(e,t,i){return t in i},o=Object(o));for(var a=0,l=s.length;a<l;a++){
var c=s[a],u=o[c];r(u,c,o)&&(n[c]=u)}return n},g.omit=function(e,t,i){if(g.isFunction(t))t=g.negate(t);else{var r=g.map(L(arguments,!1,!1,1),String);t=function(e,t){return!g.contains(r,t)}}return g.pick(e,t,i)},g.defaults=y(g.allKeys,!0),g.create=function(e,t){var i=b(e);return t&&g.extendOwn(i,t),i},g.clone=function(e){return g.isObject(e)?g.isArray(e)?e.slice():g.extend({},e):e},g.tap=function(e,t){return t(e),e},g.isMatch=function(e,t){var i=g.keys(t),r=i.length;if(null==e)return!r;for(var s=Object(e),n=0;n<r;n++){var o=i[n];if(t[o]!==s[o]||!(o in s))return!1}return!0};var N=function(e,t,i,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof g&&(e=e._wrapped),t instanceof g&&(t=t._wrapped);var s=u.call(e);if(s!==u.call(t))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}var n="[object Array]"===s;if(!n){if("object"!=typeof e||"object"!=typeof t)return!1;var o=e.constructor,a=t.constructor;if(o!==a&&!(g.isFunction(o)&&o instanceof o&&g.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}r=r||[];for(var l=(i=i||[]).length;l--;)if(i[l]===e)return r[l]===t;if(i.push(e),r.push(t),n){if((l=e.length)!==t.length)return!1;for(;l--;)if(!N(e[l],t[l],i,r))return!1}else{var c,d=g.keys(e);if(l=d.length,g.keys(t).length!==l)return!1;for(;l--;)if(c=d[l],!g.has(t,c)||!N(e[c],t[c],i,r))return!1}return i.pop(),r.pop(),!0};g.isEqual=function(e,t){return N(e,t)},g.isEmpty=function(e){return null==e||(T(e)&&(g.isArray(e)||g.isString(e)||g.isArguments(e))?0===e.length:0===g.keys(e).length)},g.isElement=function(e){return!(!e||1!==e.nodeType)},g.isArray=h||function(e){return"[object Array]"===u.call(e)},g.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},g.each(["Arguments","Function","String","Number","Date","RegExp","Error"],(function(e){g["is"+e]=function(t){return u.call(t)==="[object "+e+"]"}})),g.isArguments(arguments)||(g.isArguments=function(e){return g.has(e,"callee")}),"object"!=typeof Int8Array&&(g.isFunction=function(e){return"function"==typeof e||!1}),g.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},g.isNaN=function(e){return g.isNumber(e)&&e!==+e},g.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===u.call(e)},g.isNull=function(e){return null===e},g.isUndefined=function(e){return void 0===e},g.has=function(e,t){return null!=e&&d.call(e,t)},g.noConflict=function(){return r._=s,this},g.identity=function(e){return e},g.constant=function(e){return function(){return e}},g.noop=function(){},g.property=w,g.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},g.matcher=g.matches=function(e){return e=g.extendOwn({},e),function(t){return g.isMatch(t,e)}},g.times=function(e,t,i){var r=Array(Math.max(0,e));t=v(t,i,1);for(var s=0;s<e;s++)r[s]=t(s);return r},g.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},
g.now=Date.now||function(){return(new Date).getTime()};var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},V=g.invert(O),B=function(e){var t=function(t){return e[t]},i="(?:"+g.keys(e).join("|")+")",r=RegExp(i),s=RegExp(i,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(s,t):e}};g.escape=B(O),g.unescape=B(V),g.result=function(e,t,i){var r=null==e?void 0:e[t];return void 0===r&&(r=i),g.isFunction(r)?r.call(e):r};var F=0;g.uniqueId=function(e){var t=++F+"";return e?e+t:t},g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var W=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},H=/\\|'|\r|\n|\u2028|\u2029/g,z=function(e){return"\\"+U[e]};g.template=function(e,t,i){!t&&i&&(t=i),t=g.defaults({},t,g.templateSettings);var r=RegExp([(t.escape||W).source,(t.interpolate||W).source,(t.evaluate||W).source].join("|")+"|$","g"),s=0,n="__p+='";e.replace(r,(function(t,i,r,o,a){return n+=e.slice(s,a).replace(H,z),s=a+t.length,i?n+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":r?n+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(n+="';\n"+o+"\n__p+='"),t})),n+="';\n",t.variable||(n="with(obj||{}){\n"+n+"}\n"),n="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+n+"return __p;\n";try{var o=new Function(t.variable||"obj","_",n)}catch(e){throw e.source=n,e}var a=function(e){return o.call(this,e,g)},l=t.variable||"obj";return a.source="function("+l+"){\n"+n+"}",a},g.chain=function(e){var t=g(e);return t._chain=!0,t};var j=function(e,t){return e._chain?g(t).chain():t};g.mixin=function(e){g.each(g.functions(e),(function(t){var i=g[t]=e[t];g.prototype[t]=function(){var e=[this._wrapped];return l.apply(e,arguments),j(this,i.apply(g,e))}}))},g.mixin(g),g.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=n[e];g.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0],j(this,i)}})),g.each(["concat","join","slice"],(function(e){var t=n[e];g.prototype[e]=function(){return j(this,t.apply(this._wrapped,arguments))}})),g.prototype.value=function(){return this._wrapped},g.prototype.valueOf=g.prototype.toJSON=g.prototype.value,g.prototype.toString=function(){return""+this._wrapped},void 0===(i=function(){return g}.apply(t,[]))||(e.exports=i)}).call(this)},57147:function(){!function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,i="Symbol"in e&&"iterator"in Symbol,r="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in e,n="ArrayBuffer"in e;if(n)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},l=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1}
;_.prototype.append=function(e,t){e=d(e),t=h(t);var i=this.map[e];i||(i=[],this.map[e]=i),i.push(t)},_.prototype.delete=function(e){delete this.map[d(e)]},_.prototype.get=function(e){var t=this.map[d(e)];return t?t[0]:null},_.prototype.getAll=function(e){return this.map[d(e)]||[]},_.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},_.prototype.set=function(e,t){this.map[d(e)]=[h(t)]},_.prototype.forEach=function(e,t){Object.getOwnPropertyNames(this.map).forEach((function(i){this.map[i].forEach((function(r){e.call(t,r,i,this)}),this)}),this)},_.prototype.keys=function(){var e=[];return this.forEach((function(t,i){e.push(i)})),p(e)},_.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},_.prototype.entries=function(){var e=[];return this.forEach((function(t,i){e.push([i,t])})),p(e)},i&&(_.prototype[Symbol.iterator]=_.prototype.entries);var c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},S.call(y.prototype),S.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new _(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e};var u=[301,302,303,307,308];w.redirect=function(e,t){if(-1===u.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},e.Headers=_,e.Request=y,e.Response=w,e.fetch=function(e,t){return new Promise((function(i,s){var n=new y(e,t),o=new XMLHttpRequest;o.onload=function(){var e,t,r={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new _,e.split("\r\n").forEach((function(e){var i=e.split(":"),r=i.shift().trim();if(r){var s=i.join(":").trim();t.append(r,s)}})),t)};r.url="responseURL"in o?o.responseURL:r.headers.get("X-Request-URL");var s="response"in o?o.response:o.responseText;i(new w(s,r))},o.onerror=function(){s(new TypeError("Network request failed"))},o.ontimeout=function(){s(new TypeError("Network request failed"))},o.open(n.method,n.url,!0),"include"===n.credentials&&(o.withCredentials=!0),"responseType"in o&&r&&(o.responseType="blob"),n.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),o.send(void 0===n._bodyInit?null:n._bodyInit)}))},e.fetch.polyfill=!0}function d(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function h(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function _(e){this.map={},e instanceof _?e.forEach((function(e,t){this.append(t,e)}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function m(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function f(e){return new Promise((function(t,i){e.onload=function(){
t(e.result)},e.onerror=function(){i(e.error)}}))}function g(e){var t=new FileReader,i=f(t);return t.readAsArrayBuffer(e),i}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function S(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(r&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(s&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(n&&r&&a(e))this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!n||!ArrayBuffer.prototype.isPrototypeOf(e)&&!l(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=v(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var e=m(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?m(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e,t,i,r=m(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,i=f(t),t.readAsText(e),i;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),i=new Array(t.length),r=0;r<t.length;r++)i[r]=String.fromCharCode(t[r]);return i.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}function y(e,t){var i,r,s=(t=t||{}).body;if("string"==typeof e)this.url=e;else{if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new _(e.headers)),this.method=e.method,this.mode=e.mode,s||null==e._bodyInit||(s=e._bodyInit,e.bodyUsed=!0)}if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new _(t.headers)),this.method=(i=t.method||this.method||"GET",r=i.toUpperCase(),c.indexOf(r)>-1?r:i),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(s)}function b(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var i=e.split("="),r=i.shift().replace(/\+/g," "),s=i.join("=").replace(/\+/g," ")
;t.append(decodeURIComponent(r),decodeURIComponent(s))}})),t}function w(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new _(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},94795:function(e,t,i){var r;!function(t){"use strict";function s(){}var n=s.prototype,o=t.EventEmitter;function a(e,t){for(var i=e.length;i--;)if(e[i].listener===t)return i;return-1}function l(e){return function(){return this[e].apply(this,arguments)}}n.getListeners=function(e){var t,i,r=this._getEvents();if(e instanceof RegExp)for(i in t={},r)r.hasOwnProperty(i)&&e.test(i)&&(t[i]=r[i]);else t=r[e]||(r[e]=[]);return t},n.flattenListeners=function(e){var t,i=[];for(t=0;t<e.length;t+=1)i.push(e[t].listener);return i},n.getListenersAsObject=function(e){var t,i=this.getListeners(e);return i instanceof Array&&((t={})[e]=i),t||i},n.addListener=function(e,t){if(!function e(t){return"function"==typeof t||t instanceof RegExp||!(!t||"object"!=typeof t)&&e(t.listener)}(t))throw new TypeError("listener must be a function");var i,r=this.getListenersAsObject(e),s="object"==typeof t;for(i in r)r.hasOwnProperty(i)&&-1===a(r[i],t)&&r[i].push(s?t:{listener:t,once:!1});return this},n.on=l("addListener"),n.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},n.once=l("addOnceListener"),n.defineEvent=function(e){return this.getListeners(e),this},n.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},n.removeListener=function(e,t){var i,r,s=this.getListenersAsObject(e);for(r in s)s.hasOwnProperty(r)&&-1!==(i=a(s[r],t))&&s[r].splice(i,1);return this},n.off=l("removeListener"),n.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},n.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},n.manipulateListeners=function(e,t,i){var r,s,n=e?this.removeListener:this.addListener,o=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=i.length;r--;)n.call(this,t,i[r]);else for(r in t)t.hasOwnProperty(r)&&(s=t[r])&&("function"==typeof s?n.call(this,r,s):o.call(this,r,s));return this},n.removeEvent=function(e){var t,i=typeof e,r=this._getEvents();if("string"===i)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},n.removeAllListeners=l("removeEvent"),n.emitEvent=function(e,t){var i,r,s,n,o=this.getListenersAsObject(e);for(n in o)if(o.hasOwnProperty(n))for(i=o[n].slice(0),s=0;s<i.length;s++)!0===(r=i[s]).once&&this.removeListener(e,r.listener),r.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},n.trigger=l("emitEvent"),n.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},n.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},n._getOnceReturnValue=function(){
return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},n._getEvents=function(){return this._events||(this._events={})},s.noConflict=function(){return t.EventEmitter=o,s},void 0===(r=function(){return s}.call(t,i,t,e))||(e.exports=r)}(this||{})},32183:(e,t,i)=>{e.exports=function(){return new Worker(i.p+"30137133a5f39b43447b.worker.js")}},19992:(e,t,i)=>{e.exports=function(){return new Worker(i.p+"40b2c1dec3db8522818e.worker.js")}},79704:e=>{"use strict"
;e.exports=JSON.parse('{"14851":{},"custom_items_in_context_menu":{},"websocket_connection":{},"countdown":{},"symbol_search_parser_mixin":{},"show_pro_features":{},"daily_timeframe_suffix":{},"symbollist_context_menu":{},"pay_attention_to_ticker_not_symbol":{},"graying_disabled_tools_enabled":{},"update_study_formatter_on_symbol_resolve":{},"constraint_dialogs_movement":{},"phone_verification":{},"show_trading_notifications_history":{},"show_interval_dialog_on_key_press":{},"header_interval_dialog_button":{"subsets":["show_interval_dialog_on_key_press"]},"header_fullscreen_button":{},"header_symbol_search":{},"symbol_search_hot_key":{},"header_resolutions":{"subsets":["header_interval_dialog_button"]},"header_chart_type":{},"header_settings":{},"header_indicators":{},"header_compare":{},"header_undo_redo":{},"header_screenshot":{},"header_saveload":{},"study_on_study":{},"scales_date_format":{},"header_widget":{"subsets":["header_widget_dom_node","header_symbol_search","header_resolutions","header_chart_type","header_settings","header_indicators","header_compare","header_undo_redo","header_fullscreen_button","compare_symbol","header_screenshot"]},"legend_widget":{},"compare_symbol":{"subsets":["header_compare"]},"property_pages":{"subsets":["show_chart_property_page","chart_property_page"]},"show_chart_property_page":{},"chart_property_page":{"subsets":["chart_property_page_scales","chart_property_page_trading","chart_property_page_right_margin_editor"]},"disable_userlink_popup":{},"left_toolbar":{},"hide_left_toolbar_by_default":{},"control_bar":{},"widget_logo":{},"timeframes_toolbar":{},"edit_buttons_in_legend":{"subsets":["show_hide_button_in_legend","format_button_in_legend","study_buttons_in_legend","delete_button_in_legend"]},"hide_legend_by_default":{},"show_hide_button_in_legend":{},"object_tree_legend_mode":{},"format_button_in_legend":{},"study_buttons_in_legend":{},"delete_button_in_legend":{},"broker_button":{},"buy_sell_buttons":{"subsets":["broker_button"]},"pane_context_menu":{},"scales_context_menu":{},"legend_context_menu":{},"no_layout_top_offset":{},"context_menus":{"subsets":["pane_context_menu","scales_context_menu","legend_context_menu","objects_tree_context_menu"]},"items_favoriting":{},"save_chart_properties_to_local_storage":{},"use_localstorage_for_settings":{"subsets":["items_favoriting","save_chart_properties_to_local_storage"]},"handle_scale":{"subsets":["mouse_wheel_scale","pinch_scale","axis_pressed_mouse_move_scale"]},"handle_scroll":{"subsets":["mouse_wheel_scroll","pressed_mouse_move_scroll","horz_touch_drag_scroll","vert_touch_drag_scroll"]},"plain_studymarket":{},"trading_watch_positions":{},"disable_resolution_rebuild":{},"border_around_the_chart":{},"charting_library_debug_mode":{},"log_data_request_time":{},"saveload_requires_authentication":{},"saveload_storage_customization":{},"new_chart_creation_available":{},"volume_force_overlay":{},"create_volume_indicator_by_default":{},"create_volume_indicator_by_default_once":{},"saved_charts_count_restriction":{},"lean_chart_load":{},"stop_study_on_restart":{},"star_some_intervals_by_default":{},"predefined_items_only_may_be_starred":{},"move_logo_to_main_pane":{},"show_animated_logo":{},"link_to_tradingview":{},"logo_without_link":{},"right_bar_stays_on_scroll":{},"chart_content_overrides_by_defaults":{},"snapshot_trading_drawings":{},"allow_supported_resolutions_set_only":{},"study_market_minimized":{},"widgetbar_tabs":{"subsets":["right_toolbar"]},"show_object_tree":{"subsets":["right_toolbar"]},"dome_widget":{"subsets":["right_toolbar","showdom_button"]},"collapsible_header":{},"study_templates":{},"side_toolbar_in_fullscreen_mode":{},"header_in_fullscreen_mode":{},"remove_library_container_border":{},"whotrades_auth_only":{},"support_multicharts":{},"display_market_status":{},"display_data_mode":{},"show_chart_warn_message":{},"datasource_copypaste":{},"drawing_templates":{"subsets":["linetoolpropertieswidget_template_button"]},"expand_symbolsearch_items":{},"symbol_search_three_columns_exchanges":{},"symbol_search_flags":{},"symbol_search_limited_exchanges":{},"bugreport_button":{"subsets":["right_toolbar"]},"footer_publish_idea_button":{},"showdom_button":{"subsets":["right_toolbar"]},"text_notes":{},"show_source_code":{},"symbol_info":{},"no_bars_status":{},"clear_bars_on_series_error":{},"hide_loading_screen_on_series_error":{},"seconds_resolution":{},"dont_show_boolean_study_arguments":{},"hide_last_na_study_output":{},"price_scale_always_last_bar_value":{},"study_dialog_search_control":{},"study_dialog_fundamentals_economy_addons":{},"uppercase_instrument_names":{},"cqg_trading_confirm_risks":{},"trading_notifications":{},"chart_crosshair_menu":{},"japanese_chart_styles":{},"hide_series_legend_item":{},"hide_study_overlay_legend_item":{},"hide_study_compare_legend_item":{},"linetoolpropertieswidget_template_button":{},"use_overrides_for_overlay":{},"timezone_menu":{},"main_series_scale_menu":{},"show_login_dialog":{},"remove_img_from_rss":{},"bars_marks":{},"chart_scroll":{},"chart_zoom":{},"source_selection_markers":{},"low_density_bars":{},"end_of_period_timescale_marks":{},"open_account_manager":{},"show_order_panel_on_start":{},"order_panel":{"subsets":["order_panel_close_button","order_panel_undock","right_toolbar","order_info"]},"multiple_watchlists":{},"study_overlay_compare_legend_option":{},"custom_resolutions":{},"referral_program_for_widget_owners":{},"mobile_app_hide_toolbars":{},"mobile_app_hide_layout_buttons_on_chart_toolbar":{},"mobile_app_hide_series_control_bar":{},"mobile_trading":{},"no_min_chart_width":{},"lock_visible_time_range_on_resize":{},"pricescale_currency":{},"referral_program_policy_aggressive":{"subsets":["referral_program_policy_passive","referral_program_policy_normal"]},"referral_program_policy_normal":{"subsets":["referral_program_policy_passive","header_fake_features_buttons","custom_resolutions"]},"cropped_tick_marks":{},"trading_account_manager":{},"disable_sameinterval_aligning":{},"tv_production":{"subsets":["auto_enable_symbol_labels","show_pro_features","symbol_search_parser_mixin","symbollist_context_menu","websocket_connection","header_fullscreen_button","header_widget","dont_show_boolean_study_arguments","left_toolbar","buy_sell_buttons","control_bar","symbol_search_hot_key","context_menus","edit_buttons_in_legend","object_tree_legend_mode","uppercase_instrument_names","use_localstorage_for_settings","saveload_requires_authentication","volume_force_overlay","new_chart_creation_available","saved_charts_count_restriction","create_volume_indicator_by_default","create_volume_indicator_by_default_once","charts_auto_save","save_old_chart_before_save_as","chart_content_overrides_by_defaults","alerts","header_saveload","header_layouttoggle","datasource_copypaste","show_saved_watchlists","watchlists_from_to_file","add_to_watchlist","property_pages","support_multicharts","display_market_status","display_data_mode","show_chart_warn_message","support_manage_drawings","widgetbar_tabs","study_templates","collapsible_header","drawing_templates","footer_publish_idea_button","text_notes","show_source_code","trading_watch_positions","symbol_info","linetoolpropertieswidget_template_button","cqg_trading_confirm_risks","trading_notifications","symbol_search_three_columns_exchanges","symbol_search_flags","symbol_search_limited_exchanges","phone_verification","chart_events","custom_resolutions","compare_symbol","study_on_study","japanese_chart_styles","show_login_dialog","dome_widget","bars_marks","chart_scroll","chart_zoom","show_trading_notifications_history","source_selection_markers","study_dialog_fundamentals_economy_addons","multiple_watchlists","marked_symbols","order_panel","pricescale_currency","show_animated_logo","pricescale_currency","show_object_tree","scales_date_format","popup_hints","show_right_widgets_panel_by_default","compare_recent_symbols_enabled"]},"widget":{"subsets":["auto_enable_symbol_labels","show_pro_features","symbol_search_parser_mixin","symbollist_context_menu","websocket_connection","uppercase_instrument_names","left_toolbar","control_bar","symbol_search_hot_key","context_menus","edit_buttons_in_legend","object_tree_legend_mode","use_localstorage_for_settings","saveload_requires_authentication","volume_force_overlay","create_volume_indicator_by_default","create_volume_indicator_by_default_once","dont_show_boolean_study_arguments","header_widget_dom_node","header_symbol_search","header_resolutions","header_chart_type","header_compare","header_indicators","star_some_intervals_by_default","display_market_status","display_data_mode","show_chart_warn_message","symbol_info","linetoolpropertieswidget_template_button","symbol_search_three_columns_exchanges","symbol_search_flags","symbol_search_limited_exchanges","widgetbar_tabs","compare_symbol","show_login_dialog","plain_studymarket","japanese_chart_styles","bars_marks","chart_scroll","chart_zoom","source_selection_markers","property_pages","show_right_widgets_panel_by_default"]},"bovespa_widget":{"subsets":["widget","header_settings","linetoolpropertieswidget_template_button","compare_recent_symbols_enabled"]},"charting_library_base":{"subsets":["14851","allow_supported_resolutions_set_only","auto_enable_symbol_labels","border_around_the_chart","collapsible_header","constraint_dialogs_movement","context_menus","control_bar","create_volume_indicator_by_default","custom_items_in_context_menu","datasource_copypaste","daily_timeframe_suffix","uppercase_instrument_names","display_market_status","edit_buttons_in_legend","object_tree_legend_mode","graying_disabled_tools_enabled","header_widget","legend_widget","header_saveload","dont_show_boolean_study_arguments","lean_chart_load","left_toolbar","trading_watch_positions","link_to_tradingview","pay_attention_to_ticker_not_symbol","plain_studymarket","predefined_items_only_may_be_starred","refresh_saved_charts_list_on_dialog_show","right_bar_stays_on_scroll","saveload_storage_customization","stop_study_on_restart","timeframes_toolbar","symbol_search_hot_key","update_study_formatter_on_symbol_resolve","update_timeframes_set_on_symbol_resolve","use_localstorage_for_settings","volume_force_overlay","widget_logo","countdown","use_overrides_for_overlay","trading_notifications","compare_symbol","symbol_info","timezone_menu","main_series_scale_menu","study_dialog_search_control","create_volume_indicator_by_default_once","bars_marks","chart_scroll","chart_zoom","source_selection_markers","property_pages","go_to_date","adaptive_logo","show_animated_logo","handle_scale","handle_scroll","shift_visible_range_on_new_bar","chart_content_overrides_by_defaults","cropped_tick_marks","scales_date_format","popup_hints","save_shortcut","show_right_widgets_panel_by_default","show_object_tree","insert_indicator_dialog_shortcut","compare_recent_symbols_enabled"]},"charting_library":{"subsets":["charting_library_base"]},"static_charts_service":{"subsets":["charting_library","disable_resolution_rebuild","log_data_request_time"]},"trading_terminal":{"subsets":["charting_library_base","showdom_button","support_multicharts","header_layouttoggle","japanese_chart_styles","chart_property_page_trading","add_to_watchlist","open_account_manager","show_dom_first_time","order_panel","buy_sell_buttons","multiple_watchlists","show_trading_notifications_history","always_pass_called_order_to_modify","show_object_tree","drawing_templates","trading_account_manager","chart_crosshair_menu","compare_recent_symbols_enabled"]}}')
},91023:e=>{"use strict";e.exports=JSON.parse('{"4":["v",["h",0,2],["h",1,3]],"6":["v",["h",0,2,4],["h",1,3,5]],"8":["v",["h",0,2,4,6],["h",1,3,5,7]],"2h":["h",0,1],"2v":["v",0,1],"2-1":["v",["h",0,2],1],"3s":["h",0,["v",1,2]],"3h":["h",0,1,2],"3v":["v",0,1,2],"1-2":["v",0,["h",1,2]],"3r":["h",["v",0,1],2],"4h":["h",0,1,2,3],"4v":["v",0,1,2,3],"4s":["h",0,["v",1,2,3]],"1-3":["v",0,["h",1,2,3]],"2-2":["v",["h",0,1],["v",2,3]],"1-4":["v",0,["h",1,2,3,4]],"5s":["h",0,["v",1,2,3,4]],"6c":["v",["h",0,1],["h",2,3],["h",4,5]],"8c":["v",["h",0,1],["h",2,3],["h",4,5],["h",6,7]],"s":0}')},62972:e=>{"use strict";e.exports=JSON.parse('{"abrilcombr":"widget_user_token-abrilcombr","agencialbmcombr":"widget_user_token-agencialbmcombr","ambito":"widget_user_token-ambito","atlcapital":"widget_user_token-atlcapital","bankirosru":"widget_user_token-bankirosru","bbvach":"widget_user_token-bbvach","belugagroupru":"widget_user_token-belugagroupru","bovespa":"widget_user_token-bmfbovespacombr","bpmoneycombr":"widget_user_token-bpmoneycombr","cincodias":"widget_user_token-cincodias","easynvestcombr":"widget_user_token-easynvestcombr","elespanolcom":"widget_user_token-elespanolcom","elobreroes":"widget_user_token-elobreroes","elpaisfinanciero":"widget_user_token-elpaisfinanciero","euqueroinvestir":"widget_user_token-euqueroinvestircom","eurofins":"widget_user_token-eurofins","europapresses":"widget_user_token-europapresses","finixio":"widget_user_token-finixio","forbescombr":"widget_user_token-forbescombr","healthitalia":"widget_user_token-healthitalia","hegnarno":"widget_user_token-hegnarno","hipotecariocomar":"widget_user_token-hipotecariocomar","investopedia":"widget_user_token-investopedia","ivsgroup":"widget_user_token-ivsgroup","lainformacioncom":"widget_user_token-lainformacioncom","marcopolocombr":"widget_user_token-marcopolocombr","mercadoem1minutocombr":"widget_user_token-mercadoem1minutocombr","mercadofinancierocom":"widget_user_token-mercadofinancierocom","moex":"widget_user_token-moex","moneytimescombr":"widget_user_token-moneytimescombr","negocios":"widget_user_token-negocios","novafutura":"widget_user_token-novafutura","okdiario":"widget_user_token-okdiario","pse":"widget_user_token-pse","qecomqa":"widget_user_token-qecomqa","recrusulcombr":"widget_user_token-recrusulcombr","seekingalpha":"widget_user_token-seekingalpha","seudinheiro":"widget_user_token-seudinheiro","sgcompanyit":"widget_user_token-sgcompanyit","sharejunction":"widget_user_token-sharejunction","smartlab-custom":"widget_user_token-smartlab","smartlab":"widget_user_token-smartlab","spacemoneycombr":"widget_user_token-spacemoneycombr","theo3combr":"widget_user_token-theo3combr","thetradersnet":"widget_user_token-thetradersnet","toroinvestimentoscombr":"widget_user_token-toroinvestimentoscombr","vocesaabrilcombr":"widget_user_token-vocesaabrilcombr","xpicombr":"widget_user_token-xpicombr"}')},10334:e=>{"use strict"
;e.exports=JSON.parse('{"ar_AE":{"language":"ar","language_name":"العربية","flag":"ae","geoip_code":"ae","countries_with_this_language":["ae","bh","dj","dz","eg","er","iq","jo","km","kw","lb","ly","ma","mr","om","qa","sa","sd","so","sy","td","tn","ye"],"priority":500,"is_site_locale":true,"dir":"rtl","iso":"ar","iso_639_3":"arb","show_on_widgets":true,"name_on_widgets":"العَرَبِيَّة‎‎","global_name":"Arabic"},"br":{"language":"pt","language_name":"Português","flag":"br","geoip_code":"br","priority":650,"is_site_locale":true,"iso":"pt","iso_639_3":"por","show_on_widgets":true,"name_on_widgets":"Português","global_name":"Portuguese"},"cs":{"language":"cs","language_name":"Czech","flag":"cz","geoip_code":"cz","priority":718,"is_site_locale":true,"iso":"cs","iso_639_3":"ces","show_on_widgets":true,"name_on_widgets":"Česky","global_name":"Czech","is_in_european_union":true,"isBattle":true},"de_DE":{"language":"de","language_name":"Deutsch","flag":"de","geoip_code":"de","countries_with_this_language":["at","ch"],"priority":756,"is_site_locale":true,"iso":"de","iso_639_3":"de","show_on_widgets":true,"name_on_widgets":"Deutsch","global_name":"German","is_in_european_union":true},"en":{"language":"en","language_name":"English","flag":"us","geoip_code":"us","priority":1000,"is_site_locale":true,"iso":"en","iso_639_3":"eng","show_on_widgets":true,"name_on_widgets":"English","global_name":"English","is_only_recommended_tw_autorepost":true},"es":{"language":"es","language_name":"Español","flag":"es","geoip_code":"es","countries_with_this_language":["mx","ar","ve","cl","co","pe","uy","py","cr","gt","c","bo","pa","pr"],"priority":744,"is_site_locale":true,"iso":"es","iso_639_3":"spa","show_on_widgets":true,"name_on_widgets":"Español","global_name":"Spanish","is_in_european_union":true},"fa_IR":{"language":"fa","language_name":"فارسى","flag":"ir","geoip_code":"ir","priority":480,"is_site_locale":true,"dir":"rtl","iso":"fa","iso_639_3":"fas","show_on_widgets":true,"name_on_widgets":"فارسی","global_name":"Iranian"},"fr":{"language":"fr","language_name":"Français","flag":"fr","geoip_code":"fr","priority":750,"is_site_locale":true,"iso":"fr","iso_639_3":"fra","show_on_widgets":true,"name_on_widgets":"French","global_name":"French","is_in_european_union":true},"he_IL":{"language":"he_IL","language_name":"עברית","flag":"il","geoip_code":"il","priority":490,"is_site_locale":true,"dir":"rtl","iso":"he","iso_639_3":"heb","show_on_widgets":true,"name_on_widgets":"‏עברית‏","global_name":"Israeli"},"hu_HU":{"language":"hu_HU","language_name":"Magyar","flag":"hu","geoip_code":"hu","priority":724,"is_site_locale":true,"iso":"hu","iso_639_3":"hun","show_on_widgets":true,"name_on_widgets":"Magyar","global_name":"Hungarian","is_in_european_union":true},"id":{"language":"id_ID","language_name":"Bahasa Indonesia","flag":"id","geoip_code":"id","priority":648,"is_site_locale":true,"iso":"id","iso_639_3":"ind","show_on_widgets":true,"name_on_widgets":"Indonesia","global_name":"Indonesian"},"in":{"language":"en","language_name":"English (India)","flag":"in","geoip_code":"in","priority":800,"is_site_locale":true,"iso":"en","iso_639_3":"eng","show_on_widgets":true,"name_on_widgets":"India","global_name":"Indian"},"it":{"language":"it","language_name":"Italiano","flag":"it","geoip_code":"it","priority":737,"is_site_locale":true,"iso":"it","iso_639_3":"ita","show_on_widgets":true,"name_on_widgets":"Italiano","global_name":"Italian","is_in_european_union":true},"ja":{"language":"ja","language_name":"日本語","flag":"jp","geoip_code":"jp","priority":600,"is_site_locale":true,"iso":"ja","iso_639_3":"jpn","show_on_widgets":true,"name_on_widgets":"日本語","global_name":"Japanese"},"kr":{"language":"ko","language_name":"한국어","flag":"kr","geoip_code":"kr","priority":550,"is_site_locale":true,"iso":"ko","iso_639_3":"kor","show_on_widgets":true,"name_on_widgets":"한국어","global_name":"Korean"},"ms_MY":{"language":"ms_MY","language_name":"Bahasa Melayu","flag":"my","geoip_code":"my","priority":647,"is_site_locale":true,"iso":"ms","iso_639_3":"zlm","show_on_widgets":true,"name_on_widgets":"Malay [Malaysia]","global_name":"Malaysian"},"pl":{"language":"pl","language_name":"Polski","flag":"pl","geoip_code":"pl","priority":725,"is_site_locale":true,"iso":"pl","iso_639_3":"pol","show_on_widgets":true,"name_on_widgets":"Polski","global_name":"Polish","is_in_european_union":true},"ru":{"language":"ru","language_name":"Русский","flag":"ru","geoip_code":"ru","countries_with_this_language":["am","by","kg","kz","md","tj","tm","uz"],"priority":700,"is_site_locale":true,"iso":"ru","iso_639_3":"rus","show_on_widgets":true,"name_on_widgets":"Русский","global_name":"Russian","is_only_recommended_tw_autorepost":true},"sv_SE":{"language":"sv","language_name":"Svenska","flag":"se","geoip_code":"se","priority":723,"is_site_locale":true,"iso":"sv","iso_639_3":"swe","show_on_widgets":true,"name_on_widgets":"Swedish","global_name":"Swedish","is_in_european_union":true},"th_TH":{"language":"th","language_name":"ภาษาไทย","flag":"th","geoip_code":"th","priority":646,"is_site_locale":true,"iso":"th","iso_639_3":"tha","show_on_widgets":true,"name_on_widgets":"ภาษาไทย","global_name":"Thai"},"tr":{"language":"tr","language_name":"Türkçe","flag":"tr","geoip_code":"tr","priority":713,"is_site_locale":true,"iso":"tr","iso_639_3":"tur","show_on_widgets":true,"name_on_widgets":"Türkçe","global_name":"Turkish","is_only_recommended_tw_autorepost":true},"vi_VN":{"language":"vi","language_name":"Tiếng Việt","flag":"vn","geoip_code":"vn","priority":645,"is_site_locale":true,"iso":"vi","iso_639_3":"vie","show_on_widgets":true,"name_on_widgets":"Tiếng Việt","global_name":"Vietnamese"},"zh_CN":{"language":"zh","language_name":"简体中文","flag":"cn","geoip_code":"cn","countries_with_this_language":["zh"],"priority":537,"is_site_locale":true,"iso":"zh-Hans","iso_639_3":"cmn","show_on_widgets":true,"name_on_widgets":"简体中文","global_name":"Chinese"},"zh_TW":{"language":"zh_TW","language_name":"繁體中文","flag":"tw","geoip_code":"tw","countries_with_this_language":["hk"],"priority":536,"is_site_locale":true,"iso":"zh-Hant","iso_639_3":"cmn","show_on_widgets":true,"name_on_widgets":"繁體中文","global_name":"Taiwanese"},"el":{"language":"el","language_name":"Greek","flag":"gr","geoip_code":"gr","priority":625,"is_site_locale":true,"iso":"el","iso_639_3":"ell","global_name":"Greek","is_in_european_union":true,"isBattle":true},"nl_NL":{"language":"nl_NL","language_name":"Dutch","flag":"nl","geoip_code":"nl","priority":731,"is_site_locale":true,"iso":"nl","iso_639_3":"nld","global_name":"Dutch","is_in_european_union":true,"isBattle":true},"ro":{"language":"ro","language_name":"Romanian","flag":"ro","geoip_code":"ro","priority":707,"is_site_locale":true,"iso":"ro","iso_639_3":"nld","global_name":"Romanian","is_in_european_union":true,"isBattle":true}}')
},93175:e=>{"use strict"
;e.exports=JSON.parse('{"ar_AE":["TADAWUL:TASI","TADAWUL:MT30","TVC:SPX","TVC:NDX","NSE:NIFTY","###الأسهم","TADAWUL:2222","TADAWUL:1120","TADAWUL:1150","NASDAQ:AAPL","NASDAQ:TSLA","###الفوركس","FX:EURUSD","FX:GBPUSD","FX:USDJPY","###العقود الآجلة","TVC:USOIL","TVC:UKOIL","TVC:GOLD","###العملات الرقمية","BITSTAMP:BTCUSD","BINANCE:BTCUSDT","BITSTAMP:ETHUSD"],"br":["BMFBOVESPA:IBOV","BMFBOVESPA:SMLL","TVC:SPX","TVC:DXY","TVC:DJI","###Ações (Stocks)","BMFBOVESPA:PETR4","BMFBOVESPA:VVAR3","BMFBOVESPA:ITSA4","BMFBOVESPA:MGLU3","###Cripto","BITSTAMP:BTCUSD","BINANCE:BTCBRL","BINANCE:ETHUSDT","###Futuros (Futures)","BMFBOVESPA:WIN1!","BMFBOVESPA:WDO1!","TVC:UKOIL","TVC:GOLD","BMFBOVESPA:CCM1!","###Moedas (Forex)","FX_IDC:USDBRL","FX:EURUSD","FX:USDJPY"],"de_DE":["TVC:DEU30","TVC:SPX","TVC:NDX","TVC:SX5E","TVC:UKX","###Aktien","XETR:SAP","XETR:BAYN","XETR:ADS","NASDAQ:AAPL","NASDAQ:TSLA","###Forex","FX:EURUSD","FX:GBPUSD","FX:USDJPY","###Krypto","BITSTAMP:BTCUSD","BITSTAMP:BTCEUR","BITSTAMP:ETHUSD","###Futures","EUREX:FDAX1!","TVC:GOLD","TVC:USOIL","TVC:UKOIL"],"default":["SP:SPX","TVC:NDX","TVC:DJI","CBOE:VIX","TVC:DXY","###Stocks","NASDAQ:AAPL","NASDAQ:TSLA","NASDAQ:NFLX","###Futures","TVC:USOIL","TVC:GOLD","TVC:SILVER","###Forex","FX:EURUSD","FX:GBPUSD","FX:USDJPY","###Crypto","BITSTAMP:BTCUSD","BINANCE:BTCUSDT","BITSTAMP:ETHUSD"],"es":["TVC:SPX","TVC:IBEX35","TVC:DXY","TVC:VIX","###Acciones","NASDAQ:AAPL","BME:SAN","BCBA:GGAL","BMV:CEMEX/CPO","###Forex","FX:EURUSD","FX:USDJPY","FX:GBPUSD","###Futuros","TVC:USOIL","TVC:GOLD","TVC:SILVER","###Cripto","BITSTAMP:BTCUSD","BINANCE:BTCUSDT","BITSTAMP:ETHUSD"],"fr":["TVC:CAC40","TVC:DEU30","TVC:NDX","TVC:SPX","###Actions","EURONEXT:FP","EURONEXT:GLE","EURONEXT:ORA","###Futures","TVC:UKOIL","TVC:USOIL","TVC:GOLD","###Forex","FX:EURUSD","FX:GBPUSD","FX:USDJPY","FX:EURGBP","###Crypto","BITSTAMP:BTCUSD","BITSTAMP:ETHUSD","BINANCE:BTCUSDT","BITSTAMP:BTCEUR"],"he_IL":["TASE:TA35","TVC:NDX","TVC:SPX","TVC:DJI","TVC:DXY","###מניות","TASE:TEVA","TASE:OPK","TASE:INTL","NASDAQ:AAPL","NASDAQ:TSLA","###חוזים עתידיים","TVC:USOIL","TVC:GOLD","TVC:SILVER","###מט\\"ח","FX:EURUSD","FX:GBPUSD","FX:USDJPY","FX_IDC:USDILS","###קריפטו","BITSTAMP:BTCUSD","BINANCE:BTCUSDT","BITSTAMP:ETHUSD"],"id":["IDX:COMPOSITE","IDX:IDX30","IDX:IDXBUMN20","TVC:SPX","TVC:DXY","###Saham (Stock)","IDX:ANTM","IDX:BBRI","IDX:TLKM","###Forex","FX:EURUSD","FX:GBPUSD","FX:USDJPY","###Kontrak berjangka (Futures)","TVC:USOIL","TVC:UKOIL","TVC:GOLD","###Crypto","BITSTAMP:BTCUSD","BINANCE:BTCUSDT","BITSTAMP:ETHUSD"],"in":["NSE:NIFTY","NSE:BANKNIFTY","BSE:SENSEX","NSE:CNXIT","TVC:SPX","###Stocks","NSE:RELIANCE","NSE:AXISBANK","NSE:HDFCBANK","NSE:ICICIBANK","NSE:BAJFINANCE","###Futures","NSE:NIFTY1!","NSE:BANKNIFTY1!","NSE:RELIANCE1!","NSE:INFY1!","###Forex","FX_IDC:USDINR","FX:EURUSD","FX:GBPUSD","FX:USDJPY","###Crypto","BITSTAMP:BTCUSD","BITSTAMP:ETHUSD","BITSTAMP:XRPUSD","BITSTAMP:LTCUSD"],"it":["TVC:FTMIB","TVC:SPX","TVC:DXY","TVC:UKX","TVC:DAX","###Forex","FX:EURUSD","FX:EURGBP","FX:USDJPY","FX:GBPUSD","###Azioni","MIL:ENI","MIL:ISP","NASDAQ:TSLA","NASDAQ:AAPL","###Futures","TVC:GOLD","TVC:USOIL","###Cripto","BITSTAMP:BTCUSD","BITSTAMP:ETHUSD","BITSTAMP:BTCEUR"],"ja":["TVC:NI225","TVC:DJI","TVC:SPX","TVC:DXY","TVC:VIX","###株式","TSE:9984","TSE:8306","TSE:6758","###先物","TVC:GOLD","TVC:USOIL","OSE:NK2251!","TVC:US10Y","###FX","FX:USDJPY","FX:EURUSD","FX:GBPJPY","###仮想通貨","BITSTAMP:BTCUSD","BITFLYER:BTCJPY","BITMEX:XBTUSD"],"kr":["KRX:KOSPI","KRX:KOSPI200","KRX:KOSDAQ","TVC:SPX","TVC:NDX","TVC:NI225","###가상화페","BITMEX:XBTUSD","BITHUMB:BTCKRW","BINANCE:BTCUSDT","###외환","FX_IDC:USDKRW","FX:EURUSD","FX:USDJPY","###국내주식","KRX:005930","KRX:035420","KRX:005380","KRX:068270","KRX:035720","###해외선물","CBOT_MINI:YM1!","CME_MINI:NQ1!","CME_MINI:ES1!","NYMEX:CL1!","CBOE:VX1!"],"ms_MY":["FTSEMYX:FBMKLCI","FX_IDC:USDMYR","MYX:FCPO1!","TVC:SPX","TVC:VIX","###Saham","MYX:TOPGLOV","MYX:SUPERMX","MYX:CAREPLS","NASDAQ:AAPL","NASDAQ:TSLA","###Forex","FX:EURUSD","FX:GBPUSD","FX:USDJPY","###Hadapan","TVC:USOIL","TVC:UKOIL","TVC:GOLD","###Kripto","BITSTAMP:BTCUSD","BITSTAMP:ETHUSD","BITFINEX:BTCMYR"],"pl":["GPW:WIG20","TVC:SX5E","TVC:DAX","TVC:SPX","###Akcje Giełdowe","GPW:PKO","GPW:JSW","GPW:PKN","NASDAQ:AAPL","NASDAQ:TSLA","###Kontrakty Terminowe","TVC:USOIL","TVC:GOLD","TVC:SILVER","###Forex","FX_IDC:USDPLN","FX_IDC:EURPLN","FX:EURUSD","FX:USDJPY","FX:GBPUSD","###Krypto","BITSTAMP:BTCUSD","BITSTAMP:ETHUSD"],"ru":["MOEX:IMOEX","MOEX:RTSI","TVC:SPX","TVC:NDX","###Акции","MOEX:SBER","MOEX:GAZP","MOEX:LKOH","MOEX:VTBR","###Фьючерсы","MOEX:BR1!","MOEX:RI1!","MOEX:GD1!","###Валюты","MOEX:USDRUB_TOM","MOEX:EURRUB_TOM","FX:EURUSD","FX:GBPUSD","###Криптовалюты","BITSTAMP:BTCUSD","BITSTAMP:ETHUSD","BITSTAMP:XRPUSD","BITSTAMP:LTCUSD"],"sv_SE":["OMXSTO:OMXSPI","TVC:SPX","TVC:NDX","CURRENCYCOM:UK100","TVC:VIX","###Aktier","OMXSTO:VOLV_A","OMXSTO:ATCO_A","OMXSTO:INVE_A","NASDAQ:AAPL","NASDAQ:TSLA","###Terminer","TVC:USOIL","TVC:UKOIL","TVC:GOLD","###Valutor","FX:USDSEK","FX:EURSEK","FX:EURUSD","FX:USDJPY","###Krypto","BITSTAMP:BTCUSD","BITSTAMP:BTCEUR","BITSTAMP:ETHUSD"],"th_TH":["SET:SET","SET:SET50","TVC:SPX","TVC:NDX","TVC:VIX","###หุ้น","SET:AOT","SET:CPALL","SET:PTT","NASDAQ:AAPL","NASDAQ:TSLA","###ฟิวเจอร์","TVC:USOIL","TVC:GOLD","TVC:SILVER","###Forex","FX:EURUSD","FX:GBPUSD","FX:USDJPY","###คริปโต","BITKUB:BTCTHB","BITSTAMP:BTCUSD","BINANCE:ETHUSDT"],"tr":["BIST:XU100","TVC:SPX","TVC:DAX","FX_IDC:XAUTRY","TVC:VIX","###Hisse Senetleri","BIST:THYAO","BIST:ASELS","BIST:TUPRS","NASDAQ:AAPL","NASDAQ:TSLA","###Vadeliler","TVC:USOIL","TVC:GOLD","TVC:SILVER","###Döviz","FX:USDTRY","FX:EURTRY","FX:EURUSD","FX:GBPUSD","FX:USDJPY","###Kripto","BITFINEX:BTCTRY","BITSTAMP:BTCUSD","BITSTAMP:ETHUSD","BITSTAMP:XRPUSD"],"uk":["TVC:UKX","TVC:SPX","TVC:NDX","CBOE:VIX","TVC:DXY","###Stocks","LSE:LLOY","LSE:BARC","LSE:BP.","NASDAQ:AAPL","NASDAQ:TSLA","###Futures","OANDA:XAUUSD","TVC:USOIL","CURRENCYCOM:US30","###Forex","FX:GBPUSD","FX:EURUSD","FX:GBPJPY","###Crypto","BITSTAMP:BTCUSD","BITSTAMP:BTCGBP","BITSTAMP:ETHUSD","BITSTAMP:XRPUSD"],"vi_VN":["HOSE:VNINDEX","HNX:HNXINDEX","TVC:SPX","TVC:NDX","TVC:VIX","###Tiền điện tử","BITSTAMP:BTCUSD","BINANCE:BTCUSDT","BITSTAMP:ETHUSD","###Cổ phiếu","HOSE:HPG","HOSE:VCB","HOSE:FPT","NASDAQ:AAPL","NASDAQ:TSLA","###Ngoại hối","FX:EURUSD","FX:GBPUSD","FX:USDJPY","###Hợp đồng Tương lai","TVC:USOIL","TVC:UKOIL","TVC:GOLD"],"zh_CN":["TVC:SHCOMP","SZSE:399106","TVC:HSI","TVC:SPX","TVC:DXY","###股票","HKEX:700","HKEX:9988","SSE:600519","NASDAQ:AAPL","NASDAQ:TSLA","###期货","TVC:GOLD","TVC:SILVER","TVC:USOIL","TVC:UKOIL","###外汇","FX:EURUSD","FX:GBPUSD","FX:USDJPY","FX_IDC:USDCNY","###加密货币","BITSTAMP:BTCUSD","BINANCE:BTCUSDT","BITSTAMP:ETHUSD"],"zh_TW":["TWSE:TAIEX","TVC:HSI","TVC:SPX","TVC:NDX","TVC:VIX","###股票","TWSE:2330","TWSE:0050","HKEX:700","NASDAQ:AAPL","NASDAQ:TSLA","###期貨","TVC:USOIL","TVC:GOLD","HKEX:HSI1!","###外匯","FX:EURUSD","FX:GBPUSD","FX:USDJPY","###加密貨幣","BITSTAMP:BTCUSD","BINANCE:BTCUSDT","BITSTAMP:ETHUSD"]}')
}},e=>{"use strict";e.O(0,[13523],()=>{return t=50688,e(e.s=t);var t});e.O()}]);